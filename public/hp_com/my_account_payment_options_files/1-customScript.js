!function($){const langArray=$('html').attr('lang').toUpperCase().split('-');const lang=langArray[0];const country=langArray[1];const isProd=_insideGraph.current.account==='IN-1011008';const operatorMapping={"231":"753103","233":"772099","235":"772084","236":"772100","237":"753438","238":"753421","239":"753418","240":"753396","241":"753102","243":"753355","244":"753117","288":"753425","289":"753370","290":"753376","291":"753392","292":"753395","293":"753389","294":"753377","295":"753407","296":"753393","297":"753422","298":"753344","300":"753387","301":"753378","302":"753440","305":"753426","307":"753401","309":"753374","310":"753379","313":"753405","314":"753345","315":"753443","317":"753428","319":"753388","320":"753382","324":"753442","326":"753436","327":"753412","328":"753432","330":"753398","331":"753343","332":"753423","333":"753391","337":"753410","341":"753411","342":"753433","343":"753380","344":"753419","348":"753371","349":"753430","350":"753416","352":"753390","356":"753439","357":"753402","358":"753434","359":"753347","362":"753409","363":"753413","365":"753424","366":"753381","367":"753342","370":"753435","371":"753408","373":"753404","375":"753359","378":"753356","379":"753372","380":"753364","381":"753363","382":"753365","383":"753361","384":"753360","386":"753373","387":"753431","388":"753362","389":"753420","394":"740312","396":"740307","398":"740268","421":"753384","422":"753417","423":"753414"};let operatorId,postChatShowing=false;function translate(string){const label={'Thank you for the chat! How was it?':{'en':'Thank you for the chat! How was it?','es':'¡AGRADECEMOS TU CONTACTO!  ¿CÓMO FUE TU EXPERIENCIA? ','pt':'AGRADECEMOS O SEU CONTATO!  COMO FOI SUA EXPERIÊNCIA?'},'Leave your feedback here':{'en':'Leave your feedback here','es':'POR FAVOR DÉJANOS TUS COMENTARIOS AQUÍ','pt':'POR FAVOR DEIXE SEU COMENTARIO AQUI! '},'Please take a few minutes to complete our short survey. Your responses will be kept confidential and used to improve our service.':{'en':'Please take a few minutes to complete our short survey. Your responses will be kept confidential and used to improve our service.','es':'La respuesta a esta encuesta te tomará pocos minutos. La información brindada será confidencial y será usada para mejorar nuestro servicio.','pt':'Responder essa pesquisa tomará poucos minutos.<br>A informação é confidencial e será usada para melhorar nosso serviço.'}};return label[string][lang.toLowerCase()];}
function showPostChat(currentChatId){let queryString='';if(country==='CA'&&lang==='EN'){queryString='HPSTORECACHAT';}else if(country==='US'||country==='MX'||country==='CL'||country==='CO'||country==='PE'||country==='BR'){queryString='HPCOMCHAT-'+country;}
if(queryString===''){return;}
let queueID=insideFrontInterface.chat.data.department;let operatorCustomId=operatorMapping[operatorId]||'0';let surveyLink=`https://survey.medallia.com/?${queryString}&lang=${lang.toLowerCase()}&AgentID=${operatorCustomId}&ChatSessionID=${currentChatId}&QueueID=${queueID}`;let previousLink=_insideGraph.getCookie('insideSurveyLink');if(previousLink==surveyLink){return;}
_insideGraph.setCookie('insideSurveyLink',surveyLink);let html=`<div aria-live="polite" tabindex="2" class="surveyQuestionContainer customSurvey" qid="0">
      <div class="box">
        <span tabindex="2" class="icon-close" aria-label="close" role="button"></span>
        <label class="heading">${translate('Thank you for the chat! How was it?')}</label>
        
        <a class="surveyNextButton insideSubmitButton" tabindex="2" href="${surveyLink}" target="_blank">
          ${translate('Leave your feedback here')}
        </a>
        <p class="inside_label">${translate('Please take a few minutes to complete our short survey. Your responses will be kept confidential and used to improve our service.')}</p>
      </div>
    </div>`;let inside_holder=$(insideChatPane.frame.contentDocument).find('#inside_holder');inside_holder.find('#inside_prechatForm').remove();inside_holder.append(html);let surveyQuestionContainer=inside_holder.find('.surveyQuestionContainer');setTimeout(function(){surveyQuestionContainer.addClass('opened');},10);surveyQuestionContainer.find(".icon-close").click(function(e){surveyQuestionContainer.removeClass('opened');setTimeout(function(){surveyQuestionContainer.remove();},300);});surveyQuestionContainer.find(".surveyNextButton").click(function(e){surveyQuestionContainer.find(".icon-close").click();});}
_insideGraph.bind("chatended",function(){operatorId=insideFrontInterface.getLastMessageOperatorId();let currentChatId=_insideGraph.getCookie('insideCurrentChatId');let chatIdAvailable=(!currentChatId||currentChatId==0||isNaN(currentChatId))===false;let taskIsActive=typeof insideChatPane!=='undefined'&&insideChatPane.getCurrentWorkflow()&&insideChatPane.getCurrentWorkflow().isActive;if(operatorId&&chatIdAvailable&&insideChatPane.activeChat&&!taskIsActive){postChatShowing=true;showPostChat(currentChatId);}});$.inside.bind("chat",function(messages){_insideGraph.setCookie('insideCurrentChatId',messages[0].chatid);});_insideGraph.defer(function(){if($.inside.front.settingsData.chats&&$.inside.front.settingsData.chats.length){let prevChat=$.inside.front.settingsData.chats;for(let i=0;i<prevChat.length;i++){if(prevChat[i].fromid.indexOf("assistant")>-1){operatorId=prevChat[i].fromid.split(":")[2];}}}
let chatPaneClose=insideChatPane.close;insideChatPane.close=function(fromUser){chatPaneClose(fromUser);if(postChatShowing){postChatShowing=false;if(insideChatPane.getChatEndedByCustomer())insideChatPane.open();}}},function(){return typeof insideChatPane!='undefined'&&insideChatPane.chatPane;});_insideGraph.defer(function(){if(visualViewport.scale<1){const insideHolder=document.getElementById('inside_holder');insideHolder.classList.add('scaleUp');insideHolder.style.setProperty('--inside-scale',1/visualViewport.scale);}},function(){return document.getElementById('inside_holder');;});insideFrontInterface.setDepartment=function(deparment){insideFrontInterface.chat.data.department=deparment;}}(_insideGraph.jQuery)