"use strict";(self.heliuxModules=self.heliuxModules||[]).push([[6819],{460:(e,t,s)=>{var r=s(54705),i=s(58480),a=s(90302),n=s(31080),o=s(73355),c=s(12595),h=s(51553);const u={minSearchTermLength:3,maxHistoryLength:6,searchBoxType:{topNav:"SearchboxExpandable"},selectors:{wrapperTop:"wrapperTop",wrapperMid:"wrapperMid",searchForm:".searchbox__form",searchInputField:".searchbox__input",btnClear:".search__btnClear",btnSearch:".search__btnSearch",btnClose:".search__btnClose",flyoutWrapper:".searchbox__flyoutWrapper",flyoutItem:".searchbox__flyoutItem",searchHistoryHeader:".searchbox__historyHeader",searchHistoryList:".searchbox__historyList",searchHistoryButtonClear:".search__btnClearHistory",searchResults:".searchresults"},elements:{wrapperTop:".searchbox__flyoutInnerWrapper--top",wrapperMid:".searchbox__flyoutInnerWrapper--mid",wrapperBottom:".searchbox__flyoutInnerWrapper--bottom",searchHistoryList:".searchbox__historyList",suggestionItemLink:".searchbox__flyoutItemLink",suggestionItemText:".searchbox__flyoutItemSuggestedTerm"},classes:{flyoutHidden:"searchbox__flyoutWrapper--hidden",btnHidden:"search__btn--hidden",searchShadow:"searchbox__base--shadow",searchHistoryHeaderHidden:"searchbox__historyHeader--hidden",searchFlyoutOpen:"searchFlyoutOpen"},subscriptions:{populateSearchHistory:"searchresults::populateSearchHistory",resultsRendered:"searchResults::rendered",getResults:"searchbutton::clicked",updatePagination:"searchresults::pagination"},publishes:{getResults:"searchbutton::clicked"},trackingEvents:{searchClick:"searchresults::clicked"},facets:[],siteId:"",language:"",apiKeyHeader:"",tabConfigsType:{pageType:"PAGE_TYPE",productDocument:"PRODUCT_DOCUMENT",damDocument:"DAM_DOCUMENT"}};var l=s(55765);const d=({errorMessage:e})=>`<div class="searchbox__flyoutItem"><p>${(0,l.JD)(e)}</p></div>`,g=({item:e,searchTerm:t,config:s,index:r})=>null!=e&&e.isProduct?(({item:e,index:t,searchTerm:s,fallbackImage:r})=>`<li class="searchbox__flyoutItem">\n        <a class="searchbox__flyoutItemLink"  tabindex="0" href="#" data-search-term="${e.suggestedTerm}" data-result-index="${t}">\n          <img class="searchbox__flyoutItemProductImage" alt="${e.imageAlt||""}" src="${e.image||r}?wid=224&hei=224&amp;qlt=100&amp;fit=vfit&amp;fmt=webp"></img>\n          <div class="searchbox__flyoutItemLinkText">\n              <span class="searchbox__flyoutItemSuggestedTerm" hidden>${(0,a.cv)(e.suggestedTerm,(0,l.Zn)(s))}</span>\n              <div class="searchbox__flyoutItemProductTitle">${(0,a.cv)(e.title,(0,l.Zn)(s))}</div>\n              <div class="searchbox__flyoutItemProductCategory">${e.category}</div>\n          </div>\n        </a>\n  </li>`)({item:e,index:r,searchTerm:t,fallbackImage:s.productSuggestionImageFallbackImage}):(({item:e,searchTerm:t})=>`<li class="searchbox__flyoutItem">\n        <a class="searchbox__flyoutItemLink"  tabindex="0" href="#" data-search-term="${e.suggestedTerm}">\n          <heliux-icon><svg viewBox="0 0 24 24"><use xlink:href="#iconSprite_magnifying-glass"></use></svg></heliux-icon>\n          <span class="searchbox__flyoutItemSuggestedTerm">${(0,a.cv)(e.suggestedTerm,(0,l.Zn)(t))}</span>\n        </a>\n  </li>`)({item:e,searchTerm:t}),p=({item:e})=>`<li class="searchbox__flyoutItem">\n        <a class="searchbox__flyoutItemLink" tabindex="0" href="#">\n          <heliux-icon><svg viewBox="0 0 24 24"><use xlink:href="#iconSprite_history"></use></svg></heliux-icon>\n          <span class="searchbox__flyoutItemSuggestedTerm">${(0,l.Zn)(e)}</span>\n        </a>\n  </li>`;var m=s(73963);function b(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function y(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?b(Object(s),!0).forEach((function(t){(0,r.A)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):b(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}class f{constructor(e){this.config=Object.keys(e).filter((e=>["elements","subscriptions","isInsideFlyOut"].includes(e))).reduce(((t,s)=>(t[s]=e[s],t)),{})}storeTrackingData(e,t,s,r){(0,n.KA)(m.mp)[e]=this.buildSearchBoxTrackingDataObject(t,s,r)}buildSearchBoxTrackingDataObject(e,t,s){const{elements:r,isInsideFlyOut:i}=this.config;return{isInsideFlyOut:i,isSearchHistory:!!e.target.closest(r.searchHistoryList),isAutocomplete:!!e.target.closest(r.wrapperMid),searchText:t||m.cB,valueBeforeAutocomplete:s}}publishTracking(e,t,s,r){const{subscriptions:a}=this.config,n=y(y({},this.buildSearchBoxTrackingDataObject(e,t,s)),{},{number:r.total,numberPerPage:r.show});(0,i.publish)(m.z$,n),(0,i.unsubscribe)(a.updateTracking,this.publishTracking.bind(this,e,t))}fireEventFromSubscription(e,t,s){const{subscriptions:r}=this.config;(0,i.subscribe)(r.updateTracking,this.publishTracking.bind(this,e,t,s))}}function S(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}class v extends i.ComponentBase{init(){this.config=(0,c.$N)({},u,this.config),this.config.apiUrl&&(this.getElements(),this.setQueryParams(),this.currentSearchTerm=this.getSearchTerm(),this.searchHistoryList=this.el.querySelector(this.config.selectors.searchHistoryList),this.wrapperMid=this.el.querySelector(this.config.elements.wrapperMid),this.subscriptions=this.config.subscriptions,this.initTracking(),this.setStore(),this.offset=0,this.valueBeforeAutocomplete="",this.listeners())}get searchTermChanged(){return this.getSearchTerm()!==this.currentSearchTerm}initTracking(){const{adobeTrackingEnabled:e}=this.config;e&&(this.searchBoxTracking=new f(this.config))}setQueryParams(){const e=new URL(window.location.href),t=new URLSearchParams(e.search),s=t.has("searchTerm")?t.get("searchTerm").trim():"";s&&(this.searchInputField.value=s,this.showButtonClear())}getSearchTerm(){return this.searchInputField.value.trim()}setStore(){this.searchHistory=(0,n.KA)("searchHistory"),this.searchHistory.subscribe((e=>this.updateSearchHistory(e)))}listeners(){const{autocomplete:e,subscriptions:t}=this.config;if(e){const e=(0,i.debounce)((e=>this.getAutoSuggestions(e)),300,!1);this.searchInputField.addEventListener("keyup",e.bind(this))}else{const e=(0,i.debounce)((e=>this.hideFlyout(e)),300,!1);this.searchInputField.addEventListener("keyup",e.bind(this))}this.currentPageIsSearch||this.searchInputField.addEventListener("keyup",this.redirectOnEnterWhenTermIsEmpty.bind(this)),this.searchInputField.addEventListener("focus",this.showHistorySuggestions.bind(this)),this.searchInputField.addEventListener("focusout",this.hideSuggestions.bind(this)),this.flyoutWrapper.addEventListener("focusout",this.hideSuggestions.bind(this)),this.searchForm.addEventListener("submit",this.submitSearch.bind(this)),this.btnSearch.addEventListener("click",this.getSearchResults.bind(this)),this.btnClear.addEventListener("click",this.clearSearchText.bind(this)),this.flyoutWrapper.addEventListener("click",this.hideFlyout.bind(this)),this.searchHistoryButtonClear.addEventListener("click",this.clearHistory.bind(this)),(0,i.subscribe)(t.resultsRendered,this.hideFlyout.bind(this)),(0,i.subscribe)(t.populateSearchHistory,this.populateSearchHistory.bind(this)),(0,i.subscribe)(t.getResults,this.syncMultipleSearchBoxes.bind(this))}syncMultipleSearchBoxes({searchTerm:e}){e!==this.getSearchTerm()&&(this.searchInputField.value=e,this.showButtonClear())}updateSearchHistory(e){this.searchHistory=e}showHistoryHeader(){const{classes:e}=this.config;this.searchHistoryHeader.classList.remove(e.searchHistoryHeaderHidden)}hideHistoryHeader(){const{classes:e}=this.config;this.searchHistoryHeader.classList.add(e.searchHistoryHeaderHidden)}selectSuggestion(e){const{elements:t}=this.config;this.valueBeforeAutocomplete=this.searchInputField.value;const s=e.target.closest(t.suggestionItemLink)||e.target;this.searchInputField.value=s.querySelector(t.suggestionItemText).textContent.trim(),this.submitSearch(e,s)}bindEventsToSuggestions(e){e.forEach((e=>e.addEventListener("click",(t=>this.selectSuggestion(t,e)))))}async requestData(){const{autocompleteItems:e,language:t,tdsConfig:s,context:i}=this.config;this.searchData=this.searchData||new h.L(function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?S(Object(s),!0).forEach((function(t){(0,r.A)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):S(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({},this.config)),this.suggestionsQuery=this.suggestionsQuery||function(e,t,s){const r=null==s?void 0:s.assetOrder;return"raqnwebTdsAutocomplete"===e?"query RaqnwebTdsAutocomplete($term: String!,\n    $countries: [String!],\n    $countryLogic: RaqnwebFilterBehaviour,\n    $language: String!,\n    $size: Int) {\n  raqnwebTdsAutocomplete(term: $term, countries: $countries, countryLogic: $countryLogic, language: $language, size: $size) {\n    terms\n  }\n}":((e,t)=>`query RaqnwebAutocomplete($term: String!, $size: Int, $site:RaqnwebSite!${t?", $context: SearchContext":""}) {\n  raqnwebAutocomplete(term: $term, size: $size, site: $site${t?", context: $context":""}) {\n    results {\n      suggestedTerm\n      ${e?"...on ProductAutocompleteResult {\n    url\n    title\n    productMainImage\n    productMainImageAltText\n    productFields {\n      productType\n      productSku\n      sortedProductCategories\n      variantSubstitutes\n      variants {\n        variantIdh\n        variantSubstitutes\n        variantName\n        variantMainImage\n        variantMainImageAlt\n      }\n    }\n  }":""}\n      __typename\n    }\n  }\n}`)(t,r)}(this.config.autocompleteQueryName,this.productPageRedirectEnabled,i);const a=this.getSearchTerm();this.requestController&&this.requestController.abort(),this.requestController=new AbortController,this.signal=this.requestController.signal;const n={searchTerm:a,countries:s.tdsCountries,countryLogic:s.isGlobal?"BLACKLIST":"WHITELIST",language:t,count:e,tabConfigs:this.tabConfigs,context:i};return this.searchData.getData(this.suggestionsQuery,n,!1,{signal:this.signal}).then(this.checkResultsForError.bind(this)).finally((()=>{this.requestController=void 0}))}redirectOnEnterWhenTermIsEmpty(e){if(e.keyCode===i.keyMap.ENTER&&""===this.getSearchTerm()){const{searchPagePath:e}=this.config,t=new URL(window.location.origin);t.pathname=e,window.location.search.includes("wcmmode=disabled")&&t.searchParams.set("wcmmode","disabled"),window.location.href=t.href}}getAutoSuggestions(e){const{minSearchTermLength:t}=this.config,s=this.getSearchTerm().length;e.keyCode!==i.keyMap.ENTER&&(this.showButtonClear(),0===s&&(this.hideButtonClear(),this.searchHistory=(0,n.KA)("searchHistory"),this.showHistorySuggestions()),s>=t&&(this.hideHistoryHeader(),(0,a.ut)(this.searchHistoryList,""),this.requestData().then((e=>(this.recentResults=null==e?void 0:e.results,e))).then(this.renderSuggestionsOrNoSuggestions.bind(this)).catch((e=>{var t;null!==(t=this.signal)&&void 0!==t&&t.aborted||(this.renderSuggestionsOrNoSuggestions({results:[]}),this.onRequestResultsError(e))}))))}mapProductItems(e){const{productSuggestionCategoryLevel:t}=this.config;return e.map((e=>{if("ProductAutocompleteResult"===(null==e?void 0:e.__typename)&&e.productFields){var s;const r=e.productFields.variants.find((({variantIdh:e})=>e===this.getSearchTerm()));return{isProduct:!0,suggestedTerm:e.suggestedTerm,image:r?r.variantMainImage:e.productMainImage,imageAlt:r?r.variantMainImageAlt:e.productMainImageAlt,title:r?r.variantName:e.title,category:(null===(s=e.productFields)||void 0===s?void 0:s.sortedProductCategories[t-1])||""}}return e}))}renderSuggestionsOrNoSuggestions({terms:e,results:t}={terms:void 0,results:void 0}){const{txtNoSuggestionsFound:s,selectors:r,classes:i}=this.config,n=this.getSearchTerm(),c=e||this.mapProductItems((0,o.K)(t));(0,a.ut)(this.wrapperMid,""),(0,a.As)({items:c,template:g,errorTemplate:d,errorMessage:s,target:this.wrapperMid,searchTerm:n,config:this.config}),this.bindEventsToSuggestions(this.wrapperMid.querySelectorAll(r.flyoutItem)),this.flyoutWrapper.classList.contains(i.flyoutHidden)&&this.showFlyout(),c&&0===c.length&&setTimeout((()=>this.hideFlyout()),3e3)}get tabConfigs(){const{tabConfigs:e,tabConfigsType:t}=this.config;return e.map((({label:e,pageTypes:s,productDocuments:r,damDocuments:i})=>{const a={name:e,types:[]};return s&&s.length&&a.types.push({type:t.pageType,values:s}),r&&r.length&&a.types.push({type:t.productDocument,values:r}),i&&i.length&&a.types.push({type:t.damDocument,values:i}),a}))}clearSearchText(){this.searchInputField.value="",this.hideButtonClear(),this.hideFlyout()}showFlyout(){const{selectors:e,classes:t}=this.config;this.searchResults=document.querySelector(e.searchResults),this.searchResults&&(this.searchResultsSection=this.searchResults.parentNode.parentNode,this.searchResultsSection.classList.add(t.searchFlyoutOpen)),this.flyoutWrapper.classList.remove(t.flyoutHidden),this.el.classList.add(t.searchShadow)}hideFlyout(){const{selectors:e,classes:t}=this.config;this.searchResults=document.querySelector(e.searchResults),this.searchResults&&(this.searchResultsSection=this.searchResults.parentNode.parentNode,this.searchResultsSection.classList.remove(t.searchFlyoutOpen)),this.flyoutWrapper.classList.add(t.flyoutHidden),this.el.classList.remove(t.searchShadow)}showButtonClear(){const{classes:e}=this.config;this.getSearchTerm().length>0&&this.btnClear.classList.contains(e.btnHidden)&&(this.btnClear.classList.remove(e.btnHidden),this.btnClear.setAttribute("aria-hidden","false"))}hideButtonClear(){const{classes:e}=this.config;this.btnClear.classList.add(e.btnHidden),this.btnClear.setAttribute("aria-hidden","true")}get productPageRedirectEnabled(){const{baseProductIdEnabled:e,productVariantEnabled:t}=this.config.productPageRedirect;return e||t}get currentPageIsSearch(){const{searchPagePath:e}=this.config,t=e.split(".")[0],s=window.location.pathname.split(".")[0];return e&&t===s}getSearchResults(e){if(e.preventDefault(),this.currentPageIsSearch&&!this.searchTermChanged)return;const t=this.getSearchTerm();this.currentSearchTerm=t,this.hideFlyout(),""!==t&&this.showButtonClear();const{publishes:s,searchPagePath:r}=this.config,a=this.findPredefinedFilteredUrl(t),n=a||new URL(window.location.origin);if(n.pathname=r,window.location.search.includes("wcmmode=disabled")&&n.searchParams.set("wcmmode","disabled"),this.currentPageIsSearch){if(t||(n.searchParams.delete("searchTerm"),window.history.replaceState({},"",n)),this.searchBoxTracking){const s=(new Date).getTime();n.searchParams.set(m.Ww,s),this.searchBoxTracking.storeTrackingData(s,e,t,this.valueBeforeAutocomplete),this.searchBoxTracking.fireEventFromSubscription(e,t,this.valueBeforeAutocomplete)}(this.searchBoxTracking||a)&&(n.searchParams.set("searchTerm",t),window.history.pushState(null,"",n.toString())),(0,i.publish)(s.getResults,{searchTerm:t,predefinedUrl:a})}else{if(n.searchParams.set("searchTerm",t),this.searchBoxTracking){const s=(new Date).getTime();n.searchParams.set(m.Ww,s),this.searchBoxTracking.storeTrackingData(s,e,t,this.valueBeforeAutocomplete)}window.location.href=n.href}}findPredefinedFilteredUrl(e){const{keywordsConfig:t}=this.config;if(t){const s=t,r=e.toLowerCase(),i=Object.entries(s).find((([,e])=>e.some((e=>null!==r.match(new RegExp(`\\b${e}\\b`))))));if(i)return new URL(i[0])}return!1}async submitSearch(e,t){if(e.preventDefault(),this.searchTermChanged)if(this.productPageRedirectEnabled){var s;let r;const i=null==t||null===(s=t.dataset)||void 0===s?void 0:s.resultIndex;if(i){const e=this.recentResults[Number(i)];r=this.findProductRedirectUrl([e||{}]),r||(r=null==e?void 0:e.url)}else t||(r=await this.requestData().then((({results:e})=>this.findProductRedirectUrl(e))).catch((e=>{this.onRequestResultsError(e)})));r?window.location.href=r:this.getSearchResults(e)}else this.getSearchResults(e)}findProductRedirectUrl(e){const t=this.getSearchTerm(),{baseProductIdEnabled:s,productVariantEnabled:r,substitutionEnabled:i}=this.config.productPageRedirect;let a;return!a&&r&&(a=r&&this.findSuggestedVariantRedirectUrl(e,t)),!a&&s&&(a=this.findSuggestedBaseProductRedirectUrl(e,t)),!a&&i&&(a=this.findVariantSubstituteRedirectUrl(e,t),a||(a=this.findProductVariantSubstituteRedirectUrl(e,t))),a}findSuggestedVariantRedirectUrl(e,t){let s;const r=e.filter((e=>e.productFields)).find((e=>e.productFields.variants.some((e=>e.variantIdh.toLowerCase()===t.toLowerCase()&&(s=e.variantIdh,!0)))));return s?`${r.url}?variantId=${s}`:""}findSuggestedBaseProductRedirectUrl(e,t){const s=e.filter((e=>e.productFields)).find((e=>e.productFields.productSku.toLowerCase()===t.toLowerCase()));return s?s.url:""}findVariantSubstituteRedirectUrl(e,t){let s;const r=e.filter((e=>e.productFields)).find((e=>e.productFields.variants.some((e=>{const{variantSubstitutes:r}=e;return!!(r&&r.length&&r.includes(t))&&(s=e.variantIdh,!0)}))));return s?`${r.url}?variantId=${s}&substitutes=${t}`:""}findProductVariantSubstituteRedirectUrl(e,t){const s=e.filter((e=>e.productFields&&"VARIANT_PRODUCT"===e.productFields.productType&&e.productFields.variantSubstitutes)).find((e=>e.productFields.variantSubstitutes.includes(t)));return s?`${s.url}?substitutes=${t}`:""}showHistorySuggestions(){const{selectors:e}=this.config,t=[...this.searchHistory.searchTexts||[]].reverse();t.length>0&&0===this.getSearchTerm().length?(this.showHistoryHeader(),(0,a.ut)(this.wrapperMid,""),(0,a.ut)(this.searchHistoryList,""),(0,a.As)({items:t,template:p,target:this.el.querySelector(e.searchHistoryList)}),this.bindEventsToSuggestions(this.searchHistoryList.querySelectorAll(e.flyoutItem)),this.showFlyout()):this.hideSuggestions(),this.showButtonClear()}hideSuggestions(){setTimeout((()=>{this.flyoutWrapper.contains(document.activeElement)||this.searchInputField.contains(document.activeElement)||this.hideFlyout()}),500)}clearHistory(){(0,n.bC)("searchHistory"),this.searchHistory=(0,n.KA)("searchHistory",{searchTexts:[]})}populateSearchHistory({searchTerm:e}){const{maxHistoryLength:t}=this.config;if(""!==e){const s=this.searchHistory.searchTexts||[],r=s.indexOf(e);r>-1&&s.splice(r,1),s.length===t&&s.shift(),s.push(e),(0,n.bC)("searchHistory"),this.searchHistory=(0,n.KA)("searchHistory",{searchTexts:s})}}checkResultsForError(e){var t;if(e.error||null!==(t=this.signal)&&void 0!==t&&t.aborted)throw new Error(e.error);return e}onRequestResultsError(e){var t;null!=e&&null!==(t=e.message)&&void 0!==t&&t.includes("AbortError")||console.error(e)}}(0,i.register)({Searchbox:v},0)}},e=>{e.O(0,[750,7694,2656,9626],(()=>(460,e(e.s=460)))),e.O()}]);