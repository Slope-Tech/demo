"use strict";(self.heliuxModules=self.heliuxModules||[]).push([[4407],{69599:(r,e,t)=>{var i=t(54705),o=t(58480),s=t(24036),c=t(47533);const a={triggers:[],doiError:[],triggerFromCAConfig:[],errorQueryParams:"errorCode",ssoJSONParam:"errorCode"};function n(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),t.push.apply(t,i)}return t}function h(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?n(Object(t),!0).forEach((function(e){(0,i.A)(r,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):n(Object(t)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))}))}return r}class g extends o.ComponentBase{init(){this.config=h(h({},a),this.config),this.searchParams=new URLSearchParams(window.location.search),this.userData={},this.userService={},this.checkUrlParams(),(0,o.subscribe)(s.v.events.onError,this.onError.bind(this)),(0,c.ws)().then((({storeData:r,service:e})=>{this.userData=r,this.userService=e})).then((()=>this.checkRedirect())).catch((r=>this.onError(r)))}checkUrlParams(){const r=new URLSearchParams(window.location.search);this.config.doiError.forEach((e=>{const t=e.paramName||this.config.errorQueryParams,i=r.get(t),o=(i?this.getParamFromJson(i):null)||i;o&&this.checkErrorCode(e,o)}))}getParamFromJson(r){let e;try{e=JSON.parse(r)}catch(r){return}if("object"==typeof e)return e[this.config.ssoJSONParam]}onError(r){this.config.doiError.forEach((e=>{e.paramName&&e.paramName!==this.config.errorQueryParams||this.checkErrorCode(e,r.errorCode)})),this.checkRedirect()}errorCodeStringsAreEqual(r,e){return`${r}`==`${e}`}checkErrorCode(r,e){const{errorCode:t,redirect:i,redirectToLastURL:o}=r;this.errorCodeStringsAreEqual(t,e)&&this.redirect(i,o)}checkRedirect(){return this.config.triggers.length>0?this.config.triggers.map((r=>this.checkProperty(r))):this.config.triggerFromCAConfig.length>0&&this.config.triggerFromCAConfig.map((r=>this.checkProperty(r))),!1}checkProperty(r){const{value:e,propName:t,redirectUrl:i,redirectToLastURL:s}=r,c=(0,o.flattenProperties)(this.userData);if(c&&void 0!==c[t]){const r=0===e.indexOf("!");r||c[t].toString()!==e||this.redirect(i,s),r&&c[t].toString()!==e.split("!").join("")&&this.redirect(i,s)}}redirect(r,e=!1){let t=r;e&&this.userData.savedUrl&&(t=this.userData.savedUrl,this.userData.savedUrl=!1),t&&this.redirectToUrl(t)}redirectToUrl(r){this.userService.checkUserState?this.userService.checkUserState((()=>{window.location=r})):window.location=r}}(0,o.register)({RedirectFlow:g},0)}},r=>{r.O(0,[750],(()=>(69599,r(r.s=69599)))),r.O()}]);