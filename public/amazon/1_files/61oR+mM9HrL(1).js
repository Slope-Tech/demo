(function(h){var w=window.AmazonUIPageJS||window.P,r=w._namespace||w.attributeErrors,e=r?r("CheckoutWebappAssets",""):w;e.guardFatal?e.guardFatal(h)(e,window):e.execute(function(){h(e,window)})})(function(h,w,r){"use strict";h.when("A","jQuery","utils/createClass").register("components/Component",function(e,b,g){var d=g({$el:null,props:{},defaultProps:{},init:function(c){this.$el=b(c.$el);if(1<this.$el.length)throw Error("Component must be attached with only one DOM element");if(!this.$el.length)return this;
this.bindAll();this.props=b.extend({},this.defaultProps,c);this.onInit(this.props)},onInit:b.noop,find:function(b){return this.$el.find(b)},bindAll:function(){for(var c in this)"function"===typeof this[c]&&(this[c]=b.proxy(this[c],this))},data:function(){return this.$el.data.apply(this.$el,arguments)}});d.create=function(c){var a=this;return c.$el.length?e.map(c.$el,function(f){return new a(e.extend({},c,{$el:b(f)}))}):[]};d.extend=function(){function b(f){f=a.call(this,f);f.extend=b;f.create=d.create;
return f}var a=d.extend;return b}();return d});"use strict";h.when("A","a-button","client-side-metrics","a-alert","page-detector").register("checkout-continue-button",function(e,b,g,d,c){function a(){c.isMobile()&&d(".checkout-continue-alert-message").hide();b(".continue-button").disable()}var f=e.$;e.declarative("checkout-continue-button-action",["click","touchend"],function(a){a.$event.preventDefault();b(".continue-button").isEnabled()&&(c.isMobile()&&f(".continue-button").prop("disabled")?d(".checkout-continue-alert-message").show():
0<f("#main-continue-form").length?f("#main-continue-form").submit():g.increaseCount("checkout:continueForm:formNotFound",1))});e.on("checkout:continueButton:enable",function(){c.isMobile()&&(d(".checkout-continue-alert-message").hide(),f(".continue-button").prop("disabled",!1));b(".continue-button").enable()});e.on("checkout:continueButton:disable",a);e.on("checkout:continueButton:disableWithMessage",function(b){c.isMobile()?(d(".checkout-continue-alert-message").text(b),d(".checkout-continue-alert-message").hide(),
f(".continue-button").prop("disabled",!0)):a()})});"use strict";h.when("jQuery","components/Component","weblab-helper").register("components/Checkbox",function(e,b,g){return b.extend({checkbox:null,$el:null,defaultProps:{onChange:e.noop},onInit:function(){if(g.isPyoClientSideInitiationEnabled()){if(!this.$el.length||!this.$el.is(":checkbox"))throw Error("[Checkbox] No checkbox input is found");this.$el.bind("change",this.handleChange)}else{if(!this.$el.hasClass("a-checkbox"))throw Error("[Checkbox] Checkbox component must instantiate with an `a-checkbox` element");
this.$input=this.find(":checkbox");if(!this.$input.length)throw Error("[Checkbox] No checkbox input is found");this.$input.bind("change",this.handleChange)}},handleChange:function(b){this.props.onChange(this.isChecked(),this,b)},isChecked:function(){return g.isPyoClientSideInitiationEnabled()?this.$el.is(":checked"):this.$input.is(":checked")},data:function(b,c){return this.$el.data(b,c)}})});"use strict";h.when("A","jQuery","components/Component","components/Checkbox","weblab-helper").register("components/PrimaryActionBlockerCheckbox",
function(e,b,g,d,c){function a(){var a=e.reduce(f,function(a,b){var f="";if(a.blocking)return a;c.isPyoClientSideInitiationEnabled()?(a=b.shouldBlock())&&(f=b.getBlockerMessage()):(a=!b.isChecked())&&(f=b.data("blocker-message"));return{blocking:a,message:f}},{blocking:null,message:""});e.equals(a,n)||(n=a,e.trigger(m.blockingStateChanged,a))}var f=[],n={blocking:null,message:""},m={blockingStateChanged:"checkbox:primaryActionBlocker:blockingStateChanged"};g=g.extend({onInit:function(b){c.isPyoClientSideInitiationEnabled()?
(this.checkbox=new d({$el:this.$el,onChange:a}),this.blockerMessage=b.blockerMessage,f.push(this)):(this.checkbox=new d({$el:this.$el,onChange:a}),f.push(this.checkbox));a()},shouldBlock:function(){return!this.$el.is(":checked")},getBlockerMessage:function(){return this.blockerMessage}});g.events=m;g.tryChangingBlockingState=a;g.getState=function(){return f.length?b.extend({},n):null};var k=c.isPyoClientSideInitiationEnabled()?"checkout:unload":"checkout:beforeReload";e.on(k,function(){f=[];n={blocking:null,
message:""}});return g});"use strict";h.register("configurations/keys",function(){var e={VIEW_TYPE:"VIEW_TYPE",CONTAINER_SELECTOR:"CONTAINER_SELECTOR",PURCHASE_ID_SELECTOR:"PURCHASE_ID_SELECTOR",validate:function(b){if("string"!==typeof b||!e[b])throw Error('The key "'+b+'" is not defined within "configurations/keys".');}};return e});"use strict";h.when("configurations/keys").register("configurations/newCheckoutExperienceConfig",function(e){var b={};b[e.VIEW_TYPE]="newCheckoutExperience";b[e.CONTAINER_SELECTOR]=
"#checkout-experience-container";b[e.PURCHASE_ID_SELECTOR]='input[name\x3d"purchaseId"]';return{getConfiguration:function(g){return g in b?b[g]:null}}});h.when("A").register("utils/createClass",function(e){function b(){}if(e.createClass)return e.createClass;var g=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;b.extend=function(d){var c=this.prototype,a=Object.create?Object.create(c):function(a){function b(){}b.prototype=a;return new b}(c),f;for(f in d)a[f]="function"===typeof d[f]&&"function"===typeof c[f]&&
g.test(d[f])?function(a,b){return function(){var f=this._super;this._super=c[a];var d=b.apply(this,arguments);this._super=f;return d}}(f,d[f]):d[f];d="function"===typeof a.init?a.hasOwnProperty("init")?a.init:function(){c.init.apply(this,arguments)}:function(){};d.prototype=a;a.constructor=d;d.extend=b.extend;return d};return function(d){return b.extend(d)}});"use strict";h.when("A","client-side-metrics").register("utils/redirectionUtils",function(e,b){function g(a,b,c){d(a,b,c||{},!1)}function d(a,
f,d,g){a&&0<a.length?(b.setCountValue("checkout:"+f+":startRedirection",1),w.open(c(a,d),g?"_blank":"_self")):b.setCountValue("checkout:"+f+":emptyUrl",1)}function c(a,b){var c=Object.keys(b).map(function(a){return a+"\x3d"+b[a]});return 0<c.length?a+(-1<a.indexOf("?")?"\x26":"?")+c:a}return{redirectInCurrentTab:g,redirectWithReason:function(a,b,c){var d={};d.redirectReason=c;g(a,b,d)},openInNewTab:function(a,b,c){d(a,b,c||{},!0)}}});"use strict";h.register("utils/smsMessageValidator",function(){var e=
/^[\n\r !-Z[\]\\^_a-~¡£¤¥§¿ÄÅÆÇÉÑÓÖØÜßàäåæçèéìñòóöøùüĄąĆćĘęĞğİıŁłŃńŚśŞşŹ-żΓΔΘΛΞΠΣΦΨΩ€]*$/;return{isValid:function(b){return e.test(b)}}});"use strict";h.register("utils/urlConstants",function(){return{GURUPA_URL:"/gp/buy/shared/handlers/dispatch.html",SHOPPING_PORTAL_ROUTED_WEBAPP_LOCATION_PURCHASES:"/checkout/p/"}});"use strict";h.when("utils/urlConstants").register("utils/urlUtils",function(e){function b(b,d){return e.SHOPPING_PORTAL_ROUTED_WEBAPP_LOCATION_PURCHASES+b+d}return{buildShoppingPortalRoutedWebappUrl:b,
buildShoppingPortalRoutedWebappUrlWithParams:function(g,d,c){g=b(g,d);if(!c)return g;d=Object.keys(c).map(function(a){return a+"\x3d"+c[a]});for(var a=0;a<d.length;a++)g=g+(-1<g.indexOf("?")?"\x26":"?")+d[a];return g},isChewbaccaRequest:function(b){return/^\/checkout\//.test(b||w.window.location.pathname)}}});h.when("A","client-side-metrics").register("utils/auiComponentHelper",function(e,b){return{getRadioButtonData:function(g){var d=g.closest(".a-radio");g=g.attr("name");if(d.length)return d.data();
b.logError("AUI_ELEMENT_NOT_FOUND","[a-radio is not found for the radio input"+(g?" with name "+g:"")+"]","[utils/auiComponentHelper] getRadioWrapper","FATAL")},showDropDownList:function(g){var d=e.$("#"+g+" [data-action\x3da-dropdown-button]");if(d.length)return d.click();b.logError("AUI_ELEMENT_NOT_FOUND","[a-dropdown-button is not found in AUI dropdown component with id "+g+"]","[utils/auiComponentHelper] showDropDownList","FATAL")}}});"use strict";h.when("utils/urlUtils").execute("hooks/spinner",
function(e){e.isChewbaccaRequest()&&(addEventListener("beforeunload",function(){h.when("page-spinner-controller").execute(function(b){b.show()})}),addEventListener("unload",function(){h.when("page-spinner-controller").execute(function(b){b.hide()})}))});"use strict";h.when("A","jQuery","page-transition-controller","page-conductor","widgets/ageVerification/ageVerificationCommon","client-side-metrics").register("widgets/ageVerification/removeLineItems",function(e,b,g,d,c,a){e.declarative("age-restriction-remove-restricted-items",
"click",function(f){a.increaseCount("checkout:ageverification:removeRestrictedItemsClick",1);f=f.data;var g=(new Date).getTime(),e=d.setAjaxTransitionHeader({"x-amz-checkout-page":"agelimitation"});c.startPageTransition(f.loadingText);b.ajax({type:"POST",url:f.url+"\x26cachebuster\x3d"+g,data:b.param(f.param,!0),dataType:"text",headers:e,error:d.ajaxRedirect,success:d.ajaxUpdatePage})})});"use strict";h.when("A","jQuery").register("widgets/ageVerification/switchIdForm",function(e,b){e.declarative("age-verification-change-id-dropdown",
"change",function(g){g=".age-verification-id-"+g.$target.find(":selected").val().toLowerCase().replace(/_/g,"-");var d=b("[name\x3d'age_verification_form']");d.find(".age-verification-id").addClass("aok-hidden");d.find(g).removeClass("aok-hidden")})});"use strict";h.when("A","jQuery","page-transition-controller","page-conductor","widgets/ageVerification/ageVerificationCommon").register("widgets/ageVerification/ageVerification",function(e,b,g,d,c){function a(a){var c=!0;a.find(".a-button-error, .a-form-error").removeClass("a-button-error").removeClass("a-form-error").end().find(".calendar-dropdown select, .age-verification-id:visible select, :text:visible, [type\x3ddate]:visible, [type\x3dnumber]:visible").each(function(a,
f){a=b(f);a.val()||(c=!1,"INPUT"===a.prop("tagName")?a.addClass("a-form-error"):a.siblings(".a-button-dropdown").addClass("a-button-error"))});return c?!0:(a.find("#missing-fields-error-message").removeClass("aok-hidden"),!1)}function f(a){a=c.buildFormData(a);var f=d.setAjaxTransitionHeader({"x-amz-checkout-page":"agelimitation"});return b.ajax({type:"POST",url:"/gp/buy/agelimitation/handlers/dob-uploader.html",data:a,dataType:"text",headers:f,success:p,error:d.ajaxRedirect})}function n(a){var f=
a.data("profile");a=c.buildFormData(a);return b.ajax({type:"POST",url:"/ap/cvf/request/identity?sif_profile\x3d"+f,data:a,dataType:"json",success:m,error:d.ajaxRedirect})}function m(a,c){var f=b('[name\x3d"age_verification_form"]');c=f.find('input[name\x3d"ageLimitation"]').val();f=f.find('input[name\x3d"ivvDomain"]').val();a={claimToken:a.token,ageLimit:c,ivvDomain:f};c=d.setAjaxTransitionHeader({"x-amz-checkout-page":"agelimitation"});return b.ajax({type:"POST",url:"/gp/buy/agelimitation/handlers/decode.html",
data:a,dataType:"text",headers:c,success:k,error:d.ajaxRedirect})}function k(a,f,g){var k=a.trim(),e;-1!==k.indexOf("newRequestToken\x3d")&&(e=k.split("\x3d")[1]);e?(c.stopPageTransition(),a=b('[name\x3d"age_verification_form"]'),a.find("#id-error-message").removeClass("aok-hidden"),a.find('input[name\x3d"requestToken"]').val(e)):d.ajaxUpdatePage(a,f,g)}function p(a,f,g){var k=a.trim();null!==g&&null===g.getResponseHeader("x-amz-checkout-agelimitation-embu-write-failed")&&-1===k.indexOf("embuWriteFailed")?
d.ajaxUpdatePage(a,f,g):(c.stopPageTransition(),b('[name\x3d"age_verification_form"]').find("#upload-error-message").removeClass("aok-hidden"))}b(document.documentElement).delegate('[name\x3d"age_verification_form"]',"submit",function(d){d.preventDefault();d=b(d.target);d.find("#dob-error-message").addClass("aok-hidden");d.find("#id-error-message").addClass("aok-hidden");d.find("#missing-fields-error-message").addClass("aok-hidden");a(d)&&c.validateDateOfBirth()&&(c.startPageTransition(d.data("loadingtext")),
"true"===d.find('input[name\x3d"isDateOfBirthOnlyEnabled"]').val()?f(d):n(d))});return{validateDateOfBirth:c.validateDateOfBirth,validateForm:a,callCVF:n,submitDateOfBirthForm:f,decodeClaimToken:m,verifyServiceResult:k,verifyDateOfBirthUploadResult:p}});"use strict";h.when("A","jQuery","page-transition-controller","page-conductor").register("widgets/ageVerification/ageVerificationCommon",function(e,b,g,d){function c(a){a=a.split(/\D/);return new Date(a[0],a[1]-1,a[2])}function a(a){var b=a.find('input[name\x3d"dob_input"]');
b.length?f(b,"dob-error-message"):(n(a.find('[name\x3d"month"]'),"dob-error-message"),n(a.find('[name\x3d"day"]'),"dob-error-message"),n(a.find('[name\x3d"year"]'),"dob-error-message"))}function f(a,b){var c=a.parent(".a-input-text-wrapper");(c.length?c:a).addClass("a-form-error");m(a,b)}function n(a,b){a=a.siblings("span.a-button-dropdown");a.addClass("a-button-error");m(a,b)}function m(a,c){a.attr("aria-invalid",!0);a.attr("aria-errormessage",c);b("#"+c).removeClass("aok-hidden")}return{validateDateOfBirth:function(){var f=
b('[name\x3d"age_verification_form"]'),d=f.find('input[name\x3d"dob_input"]');if(d.length)d=c(d.val());else{var g=f.find('[name\x3d"year"]').val(),e=f.find('[name\x3d"month"]').val(),m=f.find('[name\x3d"day"]').val(),d=c(g+"-"+e+"-"+m);if(d.getFullYear()!==Number(g)||d.getMonth()!==Number(e)-1||d.getDate()!==Number(m))return a(f),!1}g=f.find('input[name\x3d"ageLimitation"]').val();e=new Date;if(e.getFullYear()-d.getFullYear()>Number(g)||e.getFullYear()-d.getFullYear()===Number(g)&&0<=e.getMonth()-
d.getMonth()&&0<=e.getDate()-d.getDate())return!0;a(f);return!1},buildFormData:function(a){var b=a.serialize();if(!a.find('input[name\x3d"dob_input"]').length){var c=a.find('[name\x3d"year"]').val(),f=a.find('[name\x3d"month"]').val();a=a.find('[name\x3d"day"]').val();c=c+"-"+("0"+f).slice(-2)+"-"+("0"+a).slice(-2);b+="\x26dob_input\x3d"+c}return b},stopPageTransition:function(){if(d.isSPP()){var a=b("#agelimitation");a.removeClass("spp-panel.collapsed");a.addClass("spp-panel.expanded");var c=a.find(".panel-content");
a.find(".shrink-placeholder").hide();c.show();g.unblockAllActions()}else g.hide()},startPageTransition:function(a){if(d.isSPP()){g.blockAllActions();var c=b("#agelimitation");g.shrinkPanel(c,!0,a)}else g.show()},addSelectError:n,addInputError:f}});"use strict";h.when("A").register("widgets/ageVerification/formPreprocessor/formPreprocessor",function(){function e(b){return/\d/.test(b)}return{preprocessForm:function(b){var g=b.clone();0===b.find('[name\x3d"dob_input"]').length&&(g.find('[name\x3d"day"]').val(b.find('[name\x3d"day"]').val()),
g.find('[name\x3d"month"]').val(b.find('[name\x3d"month"]').val()),g.find('[name\x3d"year"]').val(b.find('[name\x3d"year"]').val()));b=g.find('[name\x3d"door-number"]');var d=b.val(),d=d.replace(/(?![A-Za-z0-9])[-¿]/g," ");d=e(d)?d.split(" ").filter(e).join(" "):d;d=d.replace(/\s\s+/g," ").trim();b.val(d);return g}}});"use strict";h.when("A","jQuery","client-side-metrics","configurations/keys","configurations/newCheckoutExperienceConfig","utils/redirectionUtils").register("widgets/deliveryAddress/newCheckoutExperience/deliveryAddress",
function(e,b,g,d,c,a){var f=c.getConfiguration(d.VIEW_TYPE);e.declarative("add-delivery-instructions-action","click",function(b){g.setCountValue("checkout:newCheckoutExperience:addDeliveryInstruction",1);a.redirectWithReason(b.data.redirectionUrl,f,"AddDeliveryInstruction")})});"use strict";h.when("A","jQuery","weblab-helper","gift-utility","a-checkbox","page-transition-controller","a-truncate","a-popover-base","email-validation","gift-contact-picker","utils/smsMessageValidator","client-side-metrics").register("widgets/giftOptions/giftOptions",
function(e,b,g,d,c,a,f,n,m,k,p,q){function v(a){this._domElement=a}function u(a){this._domElement=a}function T(a){this._domElement=a;this.isInputValid=function(){return L()?M(this._domElement.val())||m(this._domElement.val()):m(this._domElement.val())};this.toggleValidationError=function(a){var b=L()?"#gcx-egift-warning-no-contact-details-":"#egift-recipient-email-warning-";F(l.find(b+this.getLineItemIndex()),a);G(this._domElement,a,"")}}function ka(a){this._domElement=a;this.isInputValid=function(){if(!L()||
!M(this._domElement.val()))return!0;var a=la(this._domElement.val());return a.isValid?!0:"gcx-egift-warning-not-valid-mobile-"!==a.warningKey};this.toggleValidationError=function(a){F(l.find("#gcx-egift-warning-not-valid-mobile-"+this.getLineItemIndex()),a);G(this._domElement,a,"-phone")}}function U(a){this._domElement=a;this.isInputValid=function(){if(!L()||!M(this._domElement.val()))return!0;var a=la(this._domElement.val());return a.isValid?!0:"gcx-egift-warning-not-supported-mobile-"!==a.warningKey};
this.toggleValidationError=function(a){F(l.find("#gcx-egift-warning-not-supported-mobile-"+this.getLineItemIndex()),a);G(this._domElement,a,"-region")}}function ma(a){this._domElement=a;this.isInputValid=function(){return ba(this.getLineItemIndex()).senderNameIsOptional||b.trim(this._domElement.val())};this.toggleValidationError=function(a){F(l.find("#sender-name-empty-warning-"+this.getLineItemIndex()),a);G(this._domElement,a,"-empty")}}function N(a){this._domElement=a;this.isInputValid=function(){return!d.valueContainsUrl(b.trim(this._domElement.val()))}}
function na(a){N.call(this,a);this.toggleValidationError=function(a){F(l.find("#sender-name-url-warning-"+this.getLineItemIndex()),a);G(this._domElement,a,"-url")}}function oa(a){N.call(this,a);this.toggleValidationError=function(a){F(l.find("#message-url-warning-"+this.getLineItemIndex()),a);G(this._domElement,a,"-url")}}function pa(a){this._domElement=a;var b=this.getLineItemIndex();this.isInputValid=function(){var a=!1;if(p&&0<l.find('[id^\x3d"message-invalid-chars-warning-"]').length)var a=B(b).val(),
K=H(b).val(),a=a+ca(K),a=M(I(b).val())&&!p.isValid(a);return!a};this.toggleValidationError=function(a){F(l.find("#message-invalid-chars-warning-"+b),a);G(this._domElement,a,"-chars")}}function qa(a){this._domElement=a;this.isInputValid=function(){var a=this.getLineItemIndex(),b=ba(a),K=B(a).val(),a=H(a).val(),K=K+ca(a),a=d.getLineCount(K,b.maxLineLength),c=K.length;if(b=a<=b.maxLines&&c<=b.maxChars)b=!(512<w.unescape(encodeURIComponent(K)).length);return b};this.toggleValidationError=function(a){var b=
this.getLineItemIndex();F(l.find("#message-length-warning-"+b),a);G(this._domElement,a,"-length");G(l.find("#gift-message-sender-input-"+b),a,"-length");a=!a;l.find("#message-counter-"+b).find(".counter-text").toggleClass("a-color-error",!a)}}function ra(a){this._domElement=a;O()?this.isInputValid=function(){var a=this._domElement.val();return""===a||m(a)}:this.isInputValid=function(){return m(this._domElement.val())};this.toggleValidationError=function(a){var b=this.getLineItemIndex();F(l.find("#recipient-not-email-warning-"+
b),a);G(this._domElement,a,"")}}function B(a){return l.find("#message-area-"+a)}function V(a){return c("#gift-wrap-checkbox-"+a,l)}function J(a){return c("#digital-gift-message-checkbox-"+a,l)}function sa(a){return l.find("#digital-gift-message-input-wrapper-"+a)}function C(a){return l.find("#digital-gift-message-text-input-"+a)}function ta(){l.find('[id^\x3d"digital-gift-message-text-input"]').filter(function(){return!this.value}).prop("disabled",!0)}function I(a){return l.find("#egift-recipient-text-input-"+
a)}function H(a){return l.find("#gift-message-sender-input-"+a)}function da(a){return c("#toggle-gift-item-checkbox-"+a,l)}function W(a){return l.find("#gift-wrap-selection-"+a)}function X(){return l.find("#delivery-option-physical")}function Y(){return l.find("#delivery-option-sbm")}function ua(){return l.find("#egift-preview-message")}function va(){return l.find("#egift-gift-option-message")}function wa(){return l.find("#delivery-options-on-gift-options").get(0)}function D(a){a.addClass("aok-hidden")}
function z(a){a.removeClass("aok-hidden")}function F(a,b){b?z(a):D(a)}function E(a){a.prop("disabled",!0);a.removeClass("a-form-normal").addClass("a-form-disabled")}function A(a){a.prop("disabled",!1);a.removeClass("a-form-disabled").addClass("a-form-normal")}function xa(a){D(a.find(".gift-options-summary-header"));z(a.find(".gift-options-expanded-header"))}function P(a){return 0!==J(a).size()}function ba(a){return B(a).closest("[data-message-validation-options]").data("messageValidationOptions")}
function M(a){return/^\+?[()\s.0-9-]*$/.test(a)&&9<a.length&&19>a.length}function la(a){var b=String(a);if(!b)return{isValid:!1,warningKey:"gcx-egift-warning-not-valid-mobile-"};a="+"===b[0]?b:"+1"+b;if(11!==(a.match(/\d/g)||[]).length||!/^(\+[1-9][\s.-]?)?(\(\d{3}\)|\d{3})[\s.-]?\d{3}[\s.-]?\d{4}$/.test(b))return{isValid:!1,warningKey:"gcx-egift-warning-not-valid-mobile-"};if("1"!==a[1])return{isValid:!1,warningKey:"gcx-egift-warning-not-supported-mobile-"};a=a.slice(2).replace(/[()\s-.]/g,"");return/(?:2(?:0[1-35-9]|1[02-9]|2[03-589]|3[149]|4[08]|5[1-46]|6[0279]|7[0269]|8[13])|3(?:0[1-57-9]|1[02-9]|2[01356]|3[0-24679]|4[167]|5[12]|6[014]|8[056])|4(?:0[124-9]|1[02-579]|2[3-5]|3[0245]|4[023578]|58|6[39]|7[0589]|8[04])|5(?:0[1-47-9]|1[0235-8]|20|3[0149]|4[01]|5[19]|6[1-47]|7[0-5]|8[056])|6(?:0[1-35-9]|1[024-9]|2[03689]|[34][016]|5[0179]|6[0-279]|78|8[0-29])|7(?:0[1-46-8]|1[2-9]|2[04-7]|3[1247]|4[037]|5[47]|6[02359]|7[0-59]|8[156])|8(?:0[1-6]|1[02-8]|2[08]|3[0-289]|4[03578]|5[046-9]|6[02-5]|7[028])|9(?:0[134689]|1[02-9]|2[0589]|3[0146-8]|4[01579]|5[12469]|7[0-389]|8[04-69]))[2-9]\d{6}$/.test(a)?
{isValid:!0,warningKey:r}:{isValid:!1,warningKey:"gcx-egift-warning-not-supported-mobile-"}}function ea(){var a=wa();return a&&a.dataset&&"sbmOnGoPageEnabled"===a.dataset.sbm}function O(){var a=l.find('[id^\x3d"digital-gift-message-input-wrapper"]').get(0);a||(a=l.find('[id^\x3d"digital-gift-message-text-input"]').get(0));return a&&a.dataset&&"simplified"===a.dataset.dgm}function L(){return document.getElementById("gcx-egift-warning-no-contact-details-0")}function ya(a,b,c){var f=l.find("#message-counter-"+
a).find("."+b+"-counter");a=f.find(".count");b=f.find(".message");var d=Math.abs(c),f=f.data("messageData");c=0<c?"remaining":"over";var g=1===d?"single":"multiple";a.text(d);b.text(f[c][g])}function ca(a){return a?"\n"+Array(za+1).join("X")+a:""}function x(a,b){var c=!0;Array.isArray(a)&&a.forEach(function(a){a.validate(b)||(c=!1)});return c}function Ea(a){var b=[];Array.isArray(a)&&a.forEach(function(a){a.validate(!1)||b.push(a)});return b}function fa(a){if(0<B(a).size()){var b=ba(a),c=B(a).val(),
f=H(a).val(),c=c+ca(f),f=d.getLineCount(c,b.maxLineLength);ya(a,"lines",b.maxLines-f);ya(a,"chars",b.maxChars-c.length)}}function Q(a){var b=l.find("#notification-preview-"+a);if(b){var c=B(a).val(),f=H(a).val(),d=I(a).val();a=l.find("#notification-preview-wrap-image-"+a);L()&&M(d)?(D(a),c.length>t.maxGiftMessageLengthForSMS&&(c=c.substr(0,t.maxGiftMessageLengthForSMS)+"..."),f.length>t.maxSenderNameLengthForSMS&&(f=f.substr(0,t.maxSenderNameLengthForSMS)+"..."),c=t.sentByStringSMS.replace(t.placeholderChar,
f)+"\n"+t.exampleURL+"\n"+c+"\n"+t.acceptByStringSMS.replace(t.placeholderChar,t.expireDateSMS)):(z(a),c=c+"\n"+Aa.replace(t.placeholderChar,f)+"\n"+t.acceptByStringEmail.replace(t.placeholderChar,t.expireDateEmail));b.text(c)}}function G(a,b,c){a.toggleClass("gift-input-error"+c,b)}function ga(a){var c=a.val();c!==b.trim(c)&&a.val(b.trim(c))}function Ba(a,c){if(l&&0!==b("#item-"+c.itemId).length){var f=a.parent().find(".selected");Ca(f);a=a.find(".gw-card");Da(a);l.find('input[name\x3d"wrap.'+c.itemId+
'"]').val(c.wrapNo)}}function Da(a){a.addClass("selected");a.attr("aria-pressed","true")}function Ca(a){a.removeClass("selected");a.attr("aria-pressed","false")}function Fa(){var a=document.querySelectorAll(".gw-card");0!==a.length&&(h.when("a-carousel-framework").execute(function(a){a.createAll();a.initializeAll()}),w.NodeList&&!NodeList.prototype.forEach&&(a=Array.prototype.slice.call(a)),a.forEach(function(a){function c(){f.classList.remove("active");f.style.removeProperty("background-position")}
a.addEventListener("keydown",function(a){if("keydown"===a.type){var c=a.which||a.keyCode;if(32===c||13===c)a.preventDefault(),c=a.target.dataset,Ba(b(a.target).parents("li"),{itemId:c.itemId,wrapNo:c.wrapId})}});a=a.querySelector(".gw-card-header");var f=a.querySelector(".gw-hover-zoom");a.addEventListener("mousemove",function(a){var b=a.currentTarget.offsetWidth,c=a.currentTarget.offsetHeight;f.classList.add("active");c=a.offsetY/c*100;f.style.setProperty("background-position","".concat(a.offsetX/
b*100,"% ").concat(c,"%"))});a.addEventListener("pointerup",c);a.addEventListener("pointerleave",c);a.addEventListener("pointercancel",c)}))}function ha(a){var b=a.val(),c=b.replace(/[\u2018\u2019\u0060\u00B4]/g,"'").replace(/[\u201C\u201D]/g,'"');c!==b&&a.val(c)}function ia(){return document.getElementById("gcx-egift-warning-no-contact-details-0")}var l,za=5,Aa="",t={localizedFromString:"",acceptByStringEmail:"",acceptByStringSMS:"",sentByStringSMS:"",exampleURL:"",expireDateEmail:"",expireDateSMS:"",
maxGiftMessageLengthForSMS:168,maxSenderNameLengthForSMS:20,placeholderChar:"@"};v.prototype.getLineItemIndex=function(){var a=this._domElement.attr("id").split("-");if(2>a.length)throw Error("Expected DOM element id to be suffixed with -lineItemIndex");return a[a.length-1]};v.prototype.validate=function(a){a=this._domElement.prop("disabled")||this.isInputValid();this.toggleValidationError(!a);return a};u.prototype=new v;u.prototype.validate=function(a){var b=this._domElement.prop("disabled")||this.isInputValid();
a&&!b||this.toggleValidationError(!b);return b};T.prototype=new u;ka.prototype=new u;U.prototype=new u;ma.prototype=new u;N.prototype=new v;na.prototype=new N;oa.prototype=new N;pa.prototype=new v;qa.prototype=new v;ra.prototype=new u;var y=[],Z={},aa={},R={},S={},ja=function(a){l=b(a||"#giftOptions-contains");y=[];l.find(".a-truncate").each(function(){f.get(this).update()});l.find(".toggle-gift-checkbox").trigger("change");l.find(".gift-message-textarea textarea").trigger("change");l.find(".digital-gift-message-checkbox").trigger("change");
(a=e.state("giftPageState"))&&a.localizedFromStringLength&&(za=a.localizedFromStringLength);a&&a.notificationPreviewAcceptByStringSMS&&(t.acceptByStringEmail=a.notificationPreviewAcceptByStringEmail,t.acceptByStringSMS=a.notificationPreviewAcceptByStringSMS,t.sentByStringSMS=a.notificationPreviewSentByStringSMS,t.exampleURL=a.notificationPreviewExampleURL,t.expireDateEmail=a.notificationPreviewExpireDateEmail,t.expireDateSMS=a.notificationPreviewExpireDateSMS,t.maxGiftMessageLengthForSMS=a.notificationPreviewMaxGiftMessageSMS,
t.maxSenderNameLengthForSMS=a.notificationPreviewMaxSenderNameSMS,t.placeholderChar=a.placeholderChar,Aa=a.localizedFromString);l.find(".recipient-contact-details-input").bind("paste",function(){var a=this;w.setTimeout(function(){b(a).parent().trigger("change")},0)});Fa();g.isEGiftOptionsActive()&&k.isEnabled()&&h.when("mash").execute(function(){z(l.find(".chewbacca-gift-options-contact-picker-button"))});b(l.find(".recipient-contact-details-input")).each(function(){var a=b(this);a.is("input")||(a=
a.find("input"));if(a.attr("id").match("^egift")){var c=new T(a),f=new ka(a),a=new U(a);aa[c.getLineItemIndex()]=[c,f,a];y.push(c);y.push(f);y.push(a)}else c=new ra(a),f=c.getLineItemIndex(),R[f]=[c],y.push(c)});b(l.find(".sender-name-text-input")).each(function(){var a=b(this);a.is("input")||(a=a.find("input"));var c=new ma(a),a=new na(a),f=a.getLineItemIndex();Z[f]=[c,a];y.push(c);y.push(a)});b(l.find(".gift-message-textarea").find("textarea")).each(function(){var a=b(this),c=new oa(a),f=new qa(a),
a=new pa(a),d=f.getLineItemIndex();S[d]=[c,f,a];y.push(c);y.push(f);y.push(a)});l.find('.chewbacca-enabled-save-gift-options-button input[type\x3d"submit"]').bind("click touchend",function(a){x(y,!1)?O()&&ta():(a.preventDefault(),a.stopImmediatePropagation())});ea()&&wa()&&q.increaseCount("checkout:giftOptions:deliveryOptionsRendered",1)};e.declarative("chewbacca-toggle-gift-item","change",function(a){a=a.data.lineItemIndex;if(da(a).isChecked()){A(B(a));var b=H(a);b&&A(b);O()&&0!==C(a).size()&&A(C(a));
P(a)&&(J(a).enable(),J(a).isChecked()&&A(C(a)));0!==V(a).size()&&V(a).enable();b=l.find('input[name\x3d"wrap.'+a+'"]');0!==b.size()&&b.prop("disabled",!1);0!==W(a).size()&&W(a).prop("disabled",!1);ea()&&(X().prop("disabled",!1),b=Y(),b.prop("disabled",!1),b.is(":checked")&&A(I(a)),z(l.find("#egift-options-box-"+a)));z(l.find("#gift-options-box-"+a))}else{E(B(a));(b=H(a))&&E(b);O()&&0!==C(a).size()&&E(C(a));P(a)&&(b=J(a),b.uncheck(),b.disable(),E(C(a)));0!==V(a).size()&&(b=V(a),b.uncheck(),b.disable());
b=l.find('input[name\x3d"wrap.'+a+'"]');0!==b.size()&&(l.find("#gift-wrap-radio-"+a+"-none").click(),b.prop("disabled",!0));if(0!==W(a).size()){var c=l.find("#gift-wrap-carousel-"+a);if(0!==c.length){var f=c.find(".selected");Ca(f);f=c.find(".gw-none").parent();Da(f);l.find('input[name\x3d"wrap.'+a+'"]').val("");c=c.find(".a-carousel-restart");0<c.length&&c.click()}c=W(a);b.prop("disabled",!0);c.prop("disabled",!0)}ea()&&(X().prop("disabled",!0),Y().prop("disabled",!0),E(I(a)),D(l.find("#egift-options-box-"+
a)));D(l.find("#gift-options-box-"+a))}b=B(a);c=H(a);f=J(a);(g.isEGiftOptionsActive()&&0<I(a).size()?0:0<da(a).size()&&!da(a).isChecked())?(E(b),E(c),f.disable()):(A(b),A(c),f.enable());x(R[a],!1);x(Z[a],!1);x(S[a],!1)});e.declarative("chewbacca-gift-message-textarea","change keyup click focus",function(a){if("textarea"===a.targetTag&&l){a=a.data.lineItemIndex;if(ia()){var b=B(a);ha(b)}Q(a);fa(a);x(S[a],!0)}});e.declarative("chewbacca-sender-name-input","change blur focusout",function(a){a=a.data.lineItemIndex;
if(ia()){var b=H(a);ha(b)}Q(a);fa(a);x(Z[a],!1);x(S[a],!1)});e.declarative("chewbacca-sender-name-input","keyup",function(a){a=a.data.lineItemIndex;if(ia()){var b=H(a);ha(b)}Q(a);fa(a);x(Z[a],!0);x(S[a],!0)});e.declarative("chewbacca-digital-gift-message-checkbox","change",function(a){a=a.data.lineItemIndex;P(a)&&J(a).isChecked()?(A(C(a)),A(sa(a))):(E(C(a)),E(sa(a)));x(R[a],!0)});e.declarative("chewbacca-recipient-contact-details","change blur focusout",function(a){a=a.data.lineItemIndex;ga(C(a));
x(R[a],!1)});e.declarative("chewbacca-recipient-contact-details","keyup",function(a){x(R[a.data.lineItemIndex],!0)});g.isEGiftOptionsActive()&&e.declarative("chewbacca-egift-recipient-contact-details","change blur focusout",function(a){var b=a.data.lineItemIndex;"change"===a.type&&(ga(I(b)),Q(b));x(aa[b],!1)});g.isEGiftOptionsActive()&&k.isEnabled()&&e.declarative("chewbacca-gift-options-contact-picker","click",function(a){var b=a.data.lineItemIndex;a=["emails"];L()&&a.push("phoneNumbers");k.selectContact({contactFields:a,
onSuccess:function(a){var c=I(b);c.val(a.value);ga(c);Q(b);x(aa[b],!1)}})});e.declarative("chewbacca-egift-recipient-contact-details","keyup",function(a){x(aa[a.data.lineItemIndex],!0)});e.declarative("chewbacca-gift-options-submit","submit",function(b){if(x(y,!1))O()&&ta(),a.showPageTransition();else{b.$event.preventDefault();var c=[];Ea(y).forEach(function(a){var b=a._domElement.closest(".a-expander-container"),f=b.find(".a-expander-section-header");b.find(".gift-options-expanded-header").hasClass("aok-hidden")&&
!c.includes(a.getLineItemIndex())&&(f.click(),c.push(a.getLineItemIndex()))})}});e.declarative("chewbacca-gift-options-popover-submit","submit",function(a){a=a.$target.closest(".a-popover").data("a-popover-id");n.hide(a)});e.on("a:expander:chewbacca-gift-options-expander:toggle:collapse",function(a){a=a.expander.$expander;var b=a.data("lineitemindex"),c;c=B(b).val();c=!c||10>=c.length?c||"":c.substring(0,10)+"...";var f=0<c.length,b=l.find('input[name\x3d"wrap.'+b+'"]:checked').val()||"";f||b?(z(a.find(".gift-options-summary-header")),
D(a.find(".gift-options-expanded-header")),F(a.find(".gift-message-summary"),f),a.find(".gift-message-preview").text(c),D(a.find(".gift-wrap-summary")),z(a.find(".gift-wrap-summary-"+b.replace(/#/g,"\\#")))):xa(a)});e.on("a:expander:chewbacca-gift-options-expander:toggle:expand",function(a){xa(a.expander.$expander)});e.on("checkout:reload:giftselect",function(){ja()});e.on("checkout:reload:spp-giftoptions",function(){ja()});h.when("giftOptionsPopoverData").execute(function(a){for(var b=0;b<a.lineItemCount;++b)(function(a){e.on("a:popover:show:changeGiftOptionsPopover"+
a,function(){ja("#giftOptions-contains"+a)})})(b)});e.declarative("gift-wrap-selected","click",function(a){Ba(a.$target.parents("li"),{itemId:a.data.itemId,wrapNo:a.data.wrapId})});b("#eShipping-how-it-works-link").click(function(a){q.increaseCount("checkout:giftOptions:howItWorksLinkClicked",1)});e.declarative("select-physical-delivery","click touchend",function(a){a=a.data.lineItemIndex;q.increaseCount("checkout:giftOptions:physicalAddressSelected",1);Y().prop("checked",!1);X().prop("checked",!0);
var b=l.find("#egift-input-widget");E(I(a));D(b);b=ua();D(b);b=va();D(b);b=l.find("#dgm-option");P(a)&&(J(a).enable(),J(a).isChecked()&&A(C(a)));z(b)});e.declarative("select-ship-by-message","click touchend",function(a){if("a"!==a.targetTag){a=a.data.lineItemIndex;q.increaseCount("checkout:giftOptions:shipByMessageSelected",1);Y().prop("checked",!0);X().prop("checked",!1);var b=l.find("#egift-input-widget");A(l.find("#egift-recipient-input-wrapper-"+a));A(I(a));z(b);b=ua();z(b);b=va();z(b);b=l.find("#dgm-option");
D(b);P(a)&&(J(a).disable(),E(C(a)))}})});h.when("A").register("gift-contact-picker",function(e){function b(a){return a&&0<=e.indexOfArray(m,a)}function g(b,c,f,d){b.permissions.requireForFeature({featureID:"eshipping",requestID:"eshipping_contacts_permission"}).onPermissionGranted(function(){a(b,c,f,d)}).onPermissionDenied(d)}function d(a,b){var c=[];e.each(b,function(b){e.each(a[b]||[],function(a){c.push(a.value)})});return c}function c(a){function b(){e.delay(function(){f.remove()},100)}if(e.capabilities.android){var c=
e.$,f=c('\x3cscript id\x3d"stop-mash-reappear" type\x3d"application/x-amzn-empty" /\x3e');c(document.body).append(f);e.delay(function(){a(b)})}else a(k)}function a(a,b,g,e){c(function(c){a.showContactPicker({fields:b,successCallback:function(k){c();k=d(k,b);0===k.length?e():1===k.length?g({value:k[0]}):f(a,k,g,e)},failCallback:function(){c();e()}})})}function f(a,b,c,f){a.showChooser({buttonTitles:b,successCallback:function(a){a<b.length&&0<=a?c({value:b[a]}):f()},failCallback:f})}function n(){return e.capabilities.isAmazonApp}
var m="phoneNumbers emails ims photos categories urls".split(" "),k=function(){};return{selectContact:function(c){var f=c.onSuccess,d=c.onError||k,m=e.filter(c.contactFields||[],b);n()&&f&&0!==m.length?h.now("mash").execute(function(b){b?b.permissions&&b.permissions.available?g(b,m,f,d):a(b,m,f,d):d()}):d()},isEnabled:n}});"use strict";h.when("A","a-sheet","client-side-metrics").execute(function(e,b,g){e.declarative("gift-wrap-bottom-sheet","click",function(d){var c=d.data.giftWrapId;d="gift-image-zoom-"+
d.data.lineItemIndex;c&&(d=d+"-"+c);c=b.create({name:d,preloadDomId:d,closeType:"icon"});c._autoHeight=!0;b.showSheet(c);g.increaseCount("checkout:giftOptions:giftWrapImageZoomMobile",1)})});h.when("A","client-side-metrics").execute(function(e,b){e.declarative("gift-wrap-zoom-desktop","click",function(g){null!=g.$target[0].closest(".chewbacca-gift-popover-container")?g.$event.stopPropagation():b.increaseCount("checkout:giftOptions:giftWrapImageZoomDesktop",1)});e.on("a:popover:show",function(b){(b=
b.popover)&&b.name&&b.name.includes("changeGiftOptionsPopover")&&(b=b.$popover[0].querySelector(".gift-wrap-image-hover"),null!=b&&(b.style.cursor="auto"))})});"use strict";h.when("A","jQuery","components/PrimaryActionBlockerCheckbox","weblab-helper","client-side-metrics").register("widgets/purchaseLevelMessages/blockingConfirmationMessages",function(e,b,g,d,c){function a(){d.isPyoClientSideInitiationEnabled()||g.create({$el:b('#purchase-level-messages [data-client-component\x3d"PrimaryActionBlockerCheckbox"]')})}
e.each(["checkout:reload:spc","checkout:reload:spclite","checkout:reload:spp-revieworder","checkout:reload:spp-collapsed"],function(b){e.on(b,a)})});h.when("A","jQuery","components/Component","components/PrimaryActionBlockerCheckbox","verification-checkbox-controller").register("widgets/pyoButton/PyoButton",function(e,b,g,d,c){return g.extend({onInit:function(){var a=d.getState();this.block(a);e.on(d.events.blockingStateChanged,this.block)},block:function(a){a&&c.updatePyo(a)}})});"use strict";h.when("A",
"jQuery","client-side-metrics").register("/widgets/pyoButton/newCheckoutExperience/pyoButton",function(e,b,g){e.declarative("checkout-place-your-order-action",["click"],function(b){g.setCountValue("checkout:newCheckoutExperience:clickPlaceYourOrderButton",1)})});"use strict";h.when("A","jQuery","widgets/subscribeAndSave/snsCommon","weblab-helper").register("widgets/subscribeAndSave/setSnSOptions",function(e,b,g,d){function c(b,c,f,d,e){var v=g.getSnSItemData(b);b={asin:v.asin,encodedLineItemId:v.lineItemId,
encryptedMerchantId:v.encryptedMerchantId,merchantSku:v.merchantSku,couponId:a(b),redeemCoupon:g.convertToPerlBoolean(d),optedIn:g.convertToPerlBoolean(c),customerSelectedRecurrencePeriod:f};g.updatePurchase([b],r,e)}function a(a){return b("#sns-item-discount-"+a).data("couponId")}function f(b){var c=b.data.index,f=g.isCustomerOptedIn("#sns-item-checkbox-",c);b=b.data.callbackUrl;var d=g.getSnSItemData(c),c={asin:d.asin,encodedLineItemId:d.lineItemId,encryptedMerchantId:d.encryptedMerchantId,merchantSku:d.merchantSku,
couponId:a(c),redeemCoupon:g.convertToPerlBoolean(!1),optedIn:g.convertToPerlBoolean(f),changeOrderType:g.convertToPerlBoolean(!0),customerSelectedRecurrencePeriod:r};g.updatePurchase([c],r,b)}e.declarative("sns-item-checkbox","change",function(a){var b=a.data.index,f=g.isCustomerOptedIn("#sns-item-checkbox-",b),d=g.getActiveSubscriptionRecurrencePeriod("#sns-recurrence-period-selector-",b);c(b,f,d,!0,a.data.callbackUrl)});d.isSnsChangeOrderTypeEnabled()&&e.declarative("sns-change-order-type","click",
f);e.on("a:accordion:sns-recurrence-period-accordion:select",function(a){a=a.selectedRow.$row.data();var b=a.index,f=g.isCustomerOptedIn("#sns-item-checkbox-",b);f?c(b,f,a.recurrencePeriod,!1,a.callbackUrl):g.setActiveSubscriptionRecurrencePeriod("#sns-recurrence-period-selector-",a)})});"use strict";h.when("jQuery","page-transition-controller","page-conductor","client-side-metrics").register("widgets/subscribeAndSave/snsCommon",function(e,b,g,d){function c(a){a||(d.increaseCount("checkout:sns:updatePurchaseInvokedWithoutUrl",
1),a="/gp/buy/spc/handlers/set-subscribe-and-save-options.html?ref_\x3dchk_spc_set_sns_options");return a}return{convertToPerlBoolean:function(a){return a?1:0},getSnSItemData:function(a){return document.getElementById("sns-item-"+a).dataset},isCustomerOptedIn:function(a,b){return e(a+b).is(":checked")},updatePurchase:function(a,f,d){var m=g.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});b.show();e.ajax({type:"POST",url:c(d),contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",
data:{subscriptionParameters:JSON.stringify(a)},dataType:"text",cache:!1,async:!0,headers:m,success:function(a,c,d){"function"===typeof f&&(f(),b.hide());g.ajaxUpdatePage(a,c,d)},error:function(a,b,c){g.ajaxRedirect(a,b,c)}})},setActiveSubscriptionRecurrencePeriod:function(a,b){e(a+b.index).text(b.recurrencePeriodText).data("activeRecurrencePeriod",b.recurrencePeriod)},getActiveSubscriptionRecurrencePeriod:function(a,b){return e(a+b).data("activeRecurrencePeriod")}}});"use strict";h.when("A","client-side-metrics").execute("widgets/takeBack/redirectRecyclePage",
function(e,b){e.declarative("widget-takeback-redirect-recycle-page","click",function(e){var d=e&&e.data&&e.data.url||"";e=e&&e.data&&e.data.viewType||"";d?(w.open(d,"_blank","width\x3d850,height\x3d750,scrollbars\x3d1"),b.increaseCount("checkout:"+e+":takeBack:redirect",1)):b.logError("TAKE_BACK_REDIRECT_URL_EMPTY","unexpected empty takeBack url","widget/takeBack/redirectRecyclePage","ERROR")})});"use strict";h.when("A","page-spinner-controller").execute(function(e,b){e.declarative("ingress-internal-launch-opt-out",
"click",function(e){e=function(a,b,c,d){a=[a+"\x3d"+b];c&&(b=new Date,b.setTime(b.getTime()+864E5*c),a.push("expires\x3d"+b.toGMTString()));a.push("path\x3d/");d&&a.push("domain\x3d"+d);document.cookie=a.join("; ")};var d=function(){var a=/:\/\/([^:/]+)/.exec(w.location.href)[1].split("."),b=a.length-2;"co"!==a[b]&&"com"!==a[b]||b--;for(var c=[];b<a.length;b++)c.push(a[b]);return c.join(".")}(),c=function(a){return(a=(new RegExp(a+"\x3d([^;]+)")).exec(document.cookie))?a[1]:""}("checkout-dyn-config").split("\x26");
c[c.length]="escapeingress:1";e("checkout-dyn-config","",-1,d);e("checkout-dyn-config",c.join("\x26"),365,d);b.show();location.reload()})});"use strict";h.when("A","jQuery","widgets/installmentsModal/state","installments-service").register("widgets/installmentsModal",function(e,b,g,d){e.on("a:popover:dismiss:installmentsModal",function(b){d.sendReftag("installments_bundle_modal_cancelled_asin_"+g.asin+"_bundle_asin_"+g.bundleAsin)});e.on("a:popover:hide:installmentsModal",function(b){g.$target.prop("checked",
!g.isChecked)});e.declarative("installments-confirm","click",function(b){d.sendReftag("installments_bundle_modal_confirm_removal_asin_"+g.asin+"_bundle_asin_"+g.bundleAsin);d.call(g.itemId,g.programId,g.handlerData);b.$target.closest(".a-popover").find(".a-icon-close").click()});e.declarative("installments-cancel","click",function(b){d.sendReftag("installments_bundle_modal_cancelled_asin_"+g.asin+"_bundle_asin_"+g.bundleAsin);b.$target.closest(".a-popover").find(".a-icon-close").click()})});"use strict";
h.register("widgets/installmentsModal/state",function(){return{asin:"",bundleAsin:"",itemId:"",program:"",handler:null,$target:"",isChecked:""}});"use strict";h.when("A","page-transition-controller","page-conductor","utils/createClass","ready").register("retail-installments-contract-base-controller",function(e,b,g,d){var c=e.$;return d({config:null,ricPageWrapper:null,hasConsentedToAtLeastOneRic:!1,hasMultipleRics:!1,FROM_CURRENT_CONFIG:"current",FROM_DEFAULT_CONFIG:"default",REFTAG_URL:"/hctp/log/refMarker?ref_\x3d",
REFTAG_MOBILE_BACK:"back",REFTAG_MOBILE_CANCEL:"cancel",REFTAG_ESIGN_Y:"esign_y",REFTAG_ESIGN_N:"esign_n",REFTAG_ESIGN_LINK:"esign_link",REFTAG_ESIGN_PDF:"esign_pdf",REFTAG_RIC_CHANGE:"ric_change",REFTAG_RIC_CHANGE_OPEN:"ric_change_open",REFTAG_RIC_CHANGE_OPEN_SECONDARY:"ric_change_open_secondary",REFTAG_RIC_Y:"ric_y",REFTAG_RIC_N:"ric_n",REFTAG_RIC_LINK:"ric_link",REFTAG_RIC_REMOVE:"ric_remove",REFTAG_RIC_CONSENT:"ric_consent",init:function(){this.config=c.extend(e.state("ricPageState"),e.state("ricCustomerInfoState"));
this.hasMultipleRics=2<this.config.ricWidgetViews.length;this.getElements();this.bindEvents()},bindEvents:function(){c("body").delegate(".customerInfoUpdateBtn","click",c.proxy(this.handleCustomerInfoUpdate,this));c("body").delegate(".useBillingInfo","click",c.proxy(function(a){a.preventDefault();this.resetCustomerInfoUpdateForm(this.FROM_DEFAULT_CONFIG)},this))},declineAll:function(){var a="";c.each(this.config.installmentsAgreementsList,function(b,c){a+=btoa(c.lineItemId)+","});var b={token:this.ricPageWrapper.find('input[name\x3d"csrfToken"]').val(),
unsetLineItemIds:a.slice(0,-1)};this.doSubmit(b)},doReftag:function(a){a&&c.get(this.REFTAG_URL+this.REFTAG_BASE_PREFIX+a)},doSubmit:function(a){b.show();var f=c("#gurupaRicCSRFToken").val();a.gurupaRicCSRFToken=f;c.ajax({type:"POST",url:this.config.gurupaRicSubmitUrl,data:a,async:!0,cache:!1,headers:g.setAjaxTransitionHeader(),success:function(a){g.redirect(a)},error:function(a){g.redirect(a)}})},getRicByLineItemId:function(a){var b=null;a=a.replace(/(\.|#)/g,"");c.each(this.config.installmentsAgreementsList,
function(c,d){(c=d.lineItemId===a)||(c=d.lineItemId,c=-1!==c.indexOf(a,c.length-a.length));if(c)return b=d,!1});return b},handleCustomerInfoUpdate:function(a){a.preventDefault();var b=c(a.currentTarget).closest("form");a=b.serializeArray();var d=!1;c.each(a,c.proxy(function(a,e){if(""===c.trim(e.value)&&"customerPhoneNumber"!==e.name)return b.find('input[name\x3d"'+e.name+'"]').addClass("a-form-error"),b.find("#"+e.name+"Alert").removeClass("aok-hidden"),d=!0,!1;a=c("\x3cdiv\x3e").text(e.value).html();
this.config[e.name]=a},this));d||(c("body").find(".ricCustomerName").html(this.config.customerName),c("body").find(".ricCustomerPhone").html(this.config.customerPhoneNumber),c("body").find(".ricCustomerAddress").html(this.config.customerAddress),this.closeCustomerInfoUpdateView(),this.handleCustomerInfoUpdateFormClose(),this.doReftag(this.REFTAG_RIC_CHANGE))},handleFormAlertToggle:function(a){a=c(a.currentTarget);var b=a.closest("form");a.hasClass("a-form-error")&&(a.removeClass("a-form-error"),b.find("#"+
a.attr("name")+"Alert").addClass("aok-hidden"))},prepareCustomerAgreementsAndSubmit:function(){var a="",b="";c.each(this.config.installmentsAgreementsList,function(d,e){-1!==e.customerAgreementsList.indexOf(!1)&&(a+=btoa(e.lineItemId)+",");b+=btoa(e.lineItemId)+":";c.each(e.customerAgreementsList,function(a,c){b+=c?"1":"0";b+=","});b=b.slice(0,-1);b+="~"});var d={token:this.ricPageWrapper.find('input[name\x3d"csrfToken"]').val(),customerAddress:this.config.customerAddress,customerName:this.config.customerName,
customerPhoneNumber:this.config.customerPhoneNumber,eSignConsentAgreement:this.config.eSignConsentAgreement?"1":"0",installmentsAgreementsList:b.slice(0,-1),unsetLineItemIds:a.slice(0,-1)};this.doReftag(this.REFTAG_RIC_CONSENT);this.doSubmit(d)},resetCustomerInfoUpdateForm:function(a){var b=e.state("ricCustomerInfoState"),d=c(".customerInfoUpdateForm");d.find(".updateInfoBrief").each(function(a,b){c(b).addClass("aok-hidden")});var g="",g=this.hasMultipleRics?this.hasConsentedToAtLeastOneRic?".multipleHasConsent":
".multiplePendingConsent":this.hasConsentedToAtLeastOneRic?".singleHasConsent":".singlePendingConsent";c(g).removeClass("aok-hidden");d.find(".a-alert-inline").each(function(a,b){c(b).addClass("aok-hidden")});d.find("input").each(function(a,b){c(b).removeClass("a-form-error")});a=a===this.FROM_DEFAULT_CONFIG?b:this.config;d.find('input[name\x3d"customerAddress"]').val(a.customerAddress);d.find('input[name\x3d"customerName"]').val(a.customerName);d.find('input[name\x3d"customerPhoneNumber"]').val(a.customerPhoneNumber)},
validateInstallmentsAgreements:function(){var a=!0;c.each(this.config.installmentsAgreementsList,c.proxy(function(b,c){if(!this.validateCustomerAgreements(c))return a=!1},this));return a&&this.config.eSignConsentAgreement},validateCustomerAgreements:function(a){var b=!0;c.each(a.customerAgreementsList,function(a,c){if(!c)return b=!1});return b}})});"use strict";h.when("A","a-modal","a-popover-base","retail-installments-contract-base-controller","ready").register("retail-installments-contract-controller",
function(e,b,g,d){var c=e.$;return d.extend({continueButton:null,continueButtonWithToolTip:null,currentCardIndex:0,indexOfFirstPaymentTerms:null,REFTAG_BASE_PREFIX:"co_lti_",ESIGN_CARD_INDEX:0,init:function(a,b){this.initArrays();this.indexOfFirstPaymentTerms=b?1:0;this._super()},initArrays:function(){this.cardHeaders=[];this.cardBodies=[];this.cardCompletedHeaders=[];this.cardDeclinedHeaders=[];this.consentButtons=[];this.declineButtons=[];this.declinedCardIndices=[];this.cardIndicesAwaitingResponse=
[]},getElements:function(){this.ricPageWrapper=c(".ricPageWrapper");var a=this.ricPageWrapper.find("[class*\x3dagreement-header]");c.each(a,c.proxy(function(b){this.cardHeaders.push(c(a[b]));this.cardBodies.push(this.ricPageWrapper.find(".agreement-body-"+b));this.cardCompletedHeaders.push(this.ricPageWrapper.find(".agreement-complete-"+b));this.cardDeclinedHeaders.push(this.ricPageWrapper.find(".agreement-declined-"+b));this.consentButtons.push(this.ricPageWrapper.find(".consent-button-"+b));this.declineButtons.push(this.ricPageWrapper.find(".decline-button-"+
b));this.cardIndicesAwaitingResponse.push(b)},this))},bindEvents:function(){0!==this.indexOfFirstPaymentTerms?(this.consentButtons[this.ESIGN_CARD_INDEX].click(c.proxy(this.handleEConsentYes,this)),this.declineButtons[this.ESIGN_CARD_INDEX].click(c.proxy(this.handleEConsentNo,this))):this.config.eSignConsentAgreement=!0;c.each(this.cardHeaders,c.proxy(function(a,b){b.click(c.proxy(this.toggleCard,this,a))},this));c.each(this.consentButtons.slice(this.indexOfFirstPaymentTerms),c.proxy(function(a,b){b.click(c.proxy(this.handleMonthlyPaymentsConsentEvent,
this,a+this.indexOfFirstPaymentTerms,!0))},this));c.each(this.declineButtons.slice(this.indexOfFirstPaymentTerms),c.proxy(function(a,b){b.click(c.proxy(this.handleMonthlyPaymentsConsentEvent,this,a+this.indexOfFirstPaymentTerms,!1))},this));c(".esignModal").click(c.proxy(function(){this.doReftag(this.REFTAG_ESIGN_LINK)},this));c("body").delegate(".a-popover-modal .downloadPdf a","click",c.proxy(function(){this.doReftag(this.REFTAG_ESIGN_PDF)},this));c(".ricWrapper .customerInfoUpdateLink").click(c.proxy(function(){this.doReftag(this.REFTAG_RIC_CHANGE_OPEN)},
this));c("body").delegate(".a-popover-modal .customerInfoUpdateLink","click",c.proxy(function(){this.doReftag(this.REFTAG_RIC_CHANGE_OPEN_SECONDARY)},this));c(".mpaConsentWrapper a").click(c.proxy(function(){this.doReftag(this.REFTAG_RIC_LINK)},this));c("body").delegate("input.ricInput","focus",c.proxy(this.handleFormAlertToggle,this));c("body").delegate(".closeModalButton","click",c.proxy(this.closeAllModals,this));e.on("a:popover:beforeShow:customerInfoInputModal",c.proxy(function(){this.resetCustomerInfoUpdateForm(this.FROM_CURRENT_CONFIG)},
this));this._super()},declineAll:function(){this.doReftag(this.REFTAG_RIC_REMOVE);this._super()},handleCustomerInfoUpdateFormClose:function(){this.resetRICCards();c.each(this.config.installmentsAgreementsList,function(a,b){c.each(b.customerAgreementsList,function(a){b.customerAgreementsList[a]=!1})});e.delay(c.proxy(function(){this.openCard(this.indexOfFirstPaymentTerms)},this),500)},handleEConsentNo:function(){this.doReftag(this.REFTAG_ESIGN_N);this.declineAll()},handleEConsentYes:function(){this.doReftag(this.REFTAG_ESIGN_Y);
this.config.eSignConsentAgreement=!0;this.cardIndicesAwaitingResponse[0]===this.ESIGN_CARD_INDEX&&this.cardIndicesAwaitingResponse.shift();this.updateCardStatus(this.ESIGN_CARD_INDEX,!0);this.openCard(this.indexOfFirstPaymentTerms);this.ricPageWrapper.find(".mpaConsentWrapperShroud").hide()},handleMonthlyPaymentsConsentEvent:function(a,b,d){var e=c(d.currentTarget);d=b?this.REFTAG_RIC_Y:this.REFTAG_RIC_N;var e=e.closest(".mpaConsentWrapper").attr("id").split("_"),g=this.getRicByLineItemId(e[0]);this.doReftag(d);
g.customerAgreementsList[e[1]]=b;this.hasConsentedToAtLeastOneRic=this.hasConsentedToAtLeastOneAgreement();this.updateCardStatus(a,b);a=this.cardIndicesAwaitingResponse.indexOf(a);-1!==a&&this.cardIndicesAwaitingResponse.splice(a,1);0<this.cardIndicesAwaitingResponse.length?this.openCard(this.cardIndicesAwaitingResponse[0]):!0===this.config.eSignConsentAgreement&&0===this.cardIndicesAwaitingResponse.length&&this.prepareCustomerAgreementsAndSubmit()},hasConsentedToAtLeastOneAgreement:function(){var a=
null;c.each(this.config.installmentsAgreementsList,function(b,d){c.each(d.customerAgreementsList,function(b,c){if(c)return a=!0,!1});if(null!==a)return!1});return null!==a},toggleContinueButtons:function(a){a?(this.continueButtonWithToolTip.addClass("aok-hidden"),this.continueButton.removeClass("aok-hidden")):(this.continueButtonWithToolTip.hasClass("aok-hidden")&&this.continueButtonWithToolTip.removeClass("aok-hidden"),this.continueButton.hasClass("aok-hidden")||this.continueButton.addClass("aok-hidden"));
e.trigger("orderSummary:primaryActionButton:mirrorPanelBtnState")},closeCustomerInfoUpdateView:function(){this.closeAllModals()},closeAllModals:function(){c(".a-popover-modal .a-button-close").each(function(){c(this).click()})},closeCard:function(a){this.cardBodies[a].addClass("aok-hidden");this.currentCardIndex=null},openCard:function(a){null!=this.currentCardIndex&&this.closeCard(this.currentCardIndex);this.cardBodies[a].removeClass("aok-hidden");this.currentCardIndex=a},toggleCard:function(a){a in
this.declinedCardIndices||(this.currentCardIndex===a?this.closeCard(a):this.openCard(a))},updateCardStatus:function(a,b){!0===b?!0===this.cardCompletedHeaders[a].hasClass("aok-hidden")&&this.cardCompletedHeaders[a].removeClass("aok-hidden"):(!1===this.cardCompletedHeaders[a].hasClass("aok-hidden")&&this.cardCompletedHeaders[a].addClass("aok-hidden"),this.cardDeclinedHeaders[a].removeClass("aok-hidden"),this.declinedCardIndices[a]=!0)},resetRICCards:function(){this.cardIndicesAwaitingResponse=[];c.each(this.cardHeaders.slice(this.indexOfFirstPaymentTerms),
c.proxy(function(a){a+=this.indexOfFirstPaymentTerms;this.cardIndicesAwaitingResponse.push(a);!1===this.cardCompletedHeaders[a].hasClass("aok-hidden")&&this.cardCompletedHeaders[a].addClass("aok-hidden");!1===this.cardDeclinedHeaders[a].hasClass("aok-hidden")&&this.cardDeclinedHeaders[a].addClass("aok-hidden")},this));this.declinedCardIndices=[]}})});"use strict";h.when("A","a-sheet","utils/auiComponentHelper","widgets/relatedItems/newCheckoutExperience/deleteTogetherPopoverHelper","weblab-helper").register("widgets/itemBlocks/newCheckoutExperience/itemBlocks",
function(e,b,g,d,c){c.isDeleteTogetherPopoverEnabled()&&e.declarative("item-block-change-quantity-form-submit","change",function(a){var b=a.data,c=b.currentQuantity,g=b.showDeleteTogetherPopover,b=b.deleteTogetherBottomSheetData,k=a.$target,p=k.find(":selected").val();g&&"0"===p.toString()?(d.showSheet(b),a="a:sheet:afterHide:".concat(b.name),e.off(a),e.on(a,function(){k.val(c).change()})):p.toString()!==c.toString()&&e.trigger("a:declarative:checkout-page-form-submit:change",a)});e.declarative("item-block-change-quantity",
"click",function(a){g.showDropDownList(a.data.dropDownId)})});"use strict";h.when("A","jQuery","client-side-metrics","configurations/keys","configurations/newCheckoutExperienceConfig","page-conductor","utils/auiComponentHelper").register("widgets/itemBlocks/newCheckoutExperience/shipOptions",function(e,b,g,d,c,a,f){function h(b,c,d,e){d=b.isselected;e=b.postdata;b=b.setactionurl;d||(g.setCountValue(c,1),a.ajaxUpdate(b,e))}e.declarative("checkout-extra-scheduled-slot-expander-action","click",function(a){g.setCountValue("checkout:newCheckoutExperience:extraScheduledDeliverySlotsExpander:clicked",
1);var c=a.data,d=b("#"+c.widgetId).find(".rcx-checkout-extra-scheduled-slots.rcx-checkout-extra-scheduled-slots-hidden.dynamic-class");b("#checkout-extra-scheduled-slots-expander-link-"+c.widgetId).addClass("rcx-checkout-extra-scheduled-slots-hidden");d.each(function(){b(this).removeClass("rcx-checkout-extra-scheduled-slots-hidden");b(this).addClass("rcx-checkout-extra-scheduled-slots-shown")});a.$event.preventDefault();a.$event.stopPropagation()});e.declarative("checkout-select-ship-option-delivery-slot",
"click",function(b){var c=b.data,d=c.setActionUrl,e=c.postData;b.$event.preventDefault();b.$event.stopPropagation();c.isSelected||(g.setCountValue("checkout:newCheckoutExperience:selectScheduledDeliveryOption:attempted",1),a.ajaxUpdate(d,e))});e.on("checkout-select-delivery-slots",function(a){a&&h(a,"checkout:newCheckoutExperience:selectDeliverySlots:attempted","checkout:newCheckoutExperience:selectDeliverySlots:failed","SelectDeliverySlots:Failed")});e.declarative("checkout-select-ship-option-radio",
"change",function(a){var b=a.$target;0!==b.length&&(b=f.getRadioButtonData(b))&&(a.$event.preventDefault(),h(b,"checkout:newCheckoutExperience:selectShipOption:attempted","checkout:newCheckoutExperience:selectShipOption:failed","SelectShipOption:Failed"))})});"use strict";h.when("A","ready").register("widgets/itemBlocks/newCheckoutExperience/fastTrackCountdown",function(e){function b(){g();var a=k("#checkout-item-block-panel");0!==a.length&&(a=a.find(".checkout-fast-track-text"),0!==a.length&&(d(),
a.each(function(){var a=k(this),b=a.attr("id"),d=a.attr("data-expiration-time"),e=a.attr("data-suppress-cutoff-timer");b!==r&&d!==r&&(d=parseInt(d,10),isNaN(d)||("true"!==e&&a.find(".checkout-fast-track-available").show(),c(a,b,d)))})))}function g(){for(var a in q)clearTimeout(q[a]);q={}}function d(){p.days={plural:k("#checkout-fast-track-days").html(),singular:k("#checkout-fast-track-day").html()};p.hours={plural:k("#checkout-fast-track-hours").html(),singular:k("#checkout-fast-track-hour").html()};
p.minutes={plural:k("#checkout-fast-track-minutes").html(),singular:k("#checkout-fast-track-minute").html()};p.seconds={plural:k("#checkout-fast-track-seconds").html(),singular:k("#checkout-fast-track-second").html()};p.and=k("#checkout-fast-track-and").html()}function c(b,d,f){var g=Math.round(e.now()/1E3),g=f-g;if(0>=g)b.find(".checkout-fast-track-available").hide(),b.find(".checkout-fast-track-expired").show(),delete q[d];else{var k=g,p=Math.floor(k/86400),k=k-86400*p,h=Math.floor(k/3600),k=k-
3600*h,n=Math.floor(k/60),k=k-60*n,r=a(p,h,n,k);b.find('span[data-countdown\x3d"fastTrackCountdown"]').html(r);g=m(g,p,h,n,k);q[d]=setTimeout(function(){c(b,d,f)},g)}}function a(a,b,c,d){return 0<a?2<=a?h(a,"days"):f(a,"days",b,"hours"):0<b?f(b,"hours",c,"minutes"):0<c?5<=c?h(c,"minutes"):f(c,"minutes",d,"seconds"):h(d,"seconds")}function f(a,b,c,d){a=h(a,b);0<c&&(a+=" ",0<p.and.length&&(a+=p.and+" "),a+=h(c,d));return a}function h(a,b){return a.toString()+" "+(1<a?p[b].plural:p[b].singular)}function m(a,
b,c,d,e){var f=1;0<b?f=2<=b?f+(a-86400*b):f+(60*d+e):0<c?f+=e:0<d&&5<=d&&(f+=e);return 1E3*f}var k=e.$,p={},q={};e.on("checkout:reload:spc",b);b();return{setTimeUnitStrings:d,getFastTrackCountdownDisplayText:a,getDelayForCountdownChangeInMilliseconds:m}});"use strict";h.when("jQuery","a-sheet").register("widgets/relatedItems/newCheckoutExperience/deleteTogetherPopoverHelper",function(e,b){return{showSheet:function(g){var d=b.get(g.name);if(!d){d=e("#".concat(g.name));d.addClass("aok-offscreen").removeClass("aok-hidden");
var c=d.outerWidth(!0)-d.innerWidth();d.width(w.innerWidth-c);c=d.outerHeight(!0);d.addClass("aok-hidden").removeClass("aok-offscreen").addClass("delete-together-popover-content");d.children("#".concat(g.name,"-items")).addClass("delete-together-popover-items-list");g.height=c;d=b.create(g)}b.showSheet(d)}}});"use strict";h.when("A","jQuery","client-side-metrics","ready").register("widgets/paymentMethods/deferred-payment-method",function(e,b,g){e.declarative("show-deferredpayment-alert-action","click",
function(){b("#deferredpayment-alert").removeClass("aok-hidden");g.increaseCount("checkout:deferredPaymentExperience:changePaymentMethod:click",1);if(e.state("deferred-payment-state")){var d=e.state("deferred-payment-state");d.CustomerJourney="CustomerJourney";d.producerId="payments";d.schemaId="Payments.CustomerJourney.3";d.timestamp=(new Date).toISOString();d.metricName="checkout:deferredPaymentExperience:customerEngagement";d.weblabName="";d.weblabTreatment="";d.clientReference="";"undefined"!==
typeof w.ue&&"undefined"!==typeof w.ue.event&&w.ue.event(d,d.producerId,d.schemaId)}})});"use strict";h.when("A","jQuery","client-side-metrics","widgets/pointsRedemption/pointsRedemptionCommon","load").register("widgets/pointsRedemption/pointsRedemption",function(e,b,g,d){function c(){b("#partial-redemption-points-input").bind("keydown",f);b("#partial-redemption-points-input").bind("input",d.inputPointsOnInput)}function a(){if(d.isInputPointsValid("desktop",h))d.onSubmitClick(Number(d.getPartialRedemptionInputValue()),
"desktop")}function f(b){if("Enter"===b.key||13===b.keyCode)return a(),b.preventDefault(),!1}var h=/^\d+(\.\d{0,2})?$/;d.emitWidgetLoadMetric("desktop");e.declarative("submit-points-for-redemption-action","click",a);e.on("checkout:reload:spc",c);c()});"use strict";h.when("A","jQuery","page-transition-controller","page-conductor","client-side-metrics","ajax-utility","load").register("widgets/pointsRedemption/pointsRedemptionCommon",function(e,b,g,d,c,a){function f(a){a.addClass("aok-hidden")}function h(a){a.removeClass("aok-hidden")}
function m(a){return a.find(".offscreen-points-redemption-error")}function k(){return b("#partial-redemption-points-input").val()}function p(a,b){q();h(a);"mobile"===b&&v("error");b=a.find(".visible-points-redemption-error").text();m(a).text(b)}function q(a){var c=b("#input-points-exceeds-redeemable-error");f(c);m(c).empty();c=b("#input-points-invalid-error");f(c);m(c).empty();"mobile"===a&&v("normal")}function v(a){var c=b("#partial-redemption-points-input").parent(".a-input-text-wrapper");c&&0<
c.length&&("error"===a?c.addClass("a-form-error"):"normal"===a&&c.removeClass("a-form-error"))}function u(e,f){return{url:b("#redemption-option-update-handler-url").val(),headers:{"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"},data:{redeemedAmount:e,pointsPaymentInstrumentId:b("#points-instrument-id").val(),targetCurrencyCode:b("#currency-code").val(),maxRedeemableAmount:b("#redeemable-points-amount").val(),isClientTimeBased:b("input[name\x3duseCtb]").val(),hasWorkingJavascript:1},
beforeRequest:function(){g.show()},onSuccess:function(b,e,g){c.increaseCount("checkout:pointsRedemption:"+f+":purchaseDocUpdateSuccess",1);d.redirect(a.jsonify(b))},onFailure:function(a,b,e){c.increaseCount("checkout:pointsRedemption:"+f+":purchaseDocUpdateFailure",1);d.ajaxRedirect(a,b,e)}}}function T(e,f){return{url:b("#redemption-option-update-handler-url").val(),headers:{"x-amz-checkout-page":"spc"},data:{jpPointsCustomerRequestedAmount:e,jpPointsPaymentInstrumentId:b("#points-instrument-id").val(),
jpPointsTargetCurrencyCode:b("#currency-code").val(),jpPointsAvailablePoints:b("#redeemable-points-amount").val(),isClientTimeBased:b("input[name\x3duseCtb]").val(),hasWorkingJavascript:1},beforeRequest:function(){g.show()},onSuccess:function(b,e,g){c.increaseCount("checkout:pointsRedemption:"+f+":purchaseDocUpdateSuccess",1);c.increaseCount("checkout:pointsRedemption:"+f+":redirectOnSuccess",1);d.redirect(a.jsonify(b))},onFailure:function(a,b,e){c.increaseCount("checkout:pointsRedemption:"+f+":purchaseDocUpdateFailure",
1);d.ajaxRedirect(a,b,e)}}}return{hideAllErrors:q,hideFormElement:f,showFormElement:h,getOffscreenErrorMessage:m,isInputPointsValid:function(a,d){var e=k();if(!d.test(e))return c.increaseCount("checkout:pointsRedemption:"+a+":inputPointsInvalidError",1),p(b("#input-points-invalid-error"),a),!1;if(Number(e)>Number(b("#redeemable-points-amount").val()))return c.increaseCount("checkout:pointsRedemption:"+a+":inputPointsExceedsRedeemableError",1),p(b("#input-points-exceeds-redeemable-error"),a),!1;q(a);
return!0},getPartialRedemptionInputValue:k,inputPointsOnInput:function(){q("desktop");f(b("#input-points-apply-success"));h(b("#submit-points-for-redemption"))},emitWidgetLoadMetric:function(a){c.increaseCount("checkout:pointsRedemption:"+a+":spcWidgetLoad",1)},onSubmitClick:function(a,c){a="true"===b("#is-points-redemption-setter-migration-enabled").val()?u(a,c):T(a,c);a.beforeRequest();b.ajax({type:"POST",url:a.url,headers:a.headers,async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
dataType:"text",data:b.param(a.data,!0),success:a.onSuccess,error:a.onFailure})}}});"use strict";h.when("A","jQuery","a-modal","client-side-metrics").register("widgets/productInformation/quicklookEventHandler",function(e,b,g,d){e.declarative("a-modal","click",function(c){if(c.$target.hasClass("cpx-quicklook-open-link")){d.increaseCount("checkout:quicklook:universal:modalLinkClick",1);c=c.data;if(!c)throw d.increaseCount("checkout:quicklook:universal:eventDataUndefined",1),Error("[Modal] Event data is undefined");
c=c.lineItemIndex;if(!c)throw d.increaseCount("checkout:quicklook:universal:lineItemIndexMissing",1),Error("[Modal] LineItemIndex is missing from event data");e.loadImageManually(b("#quicklook-modal-manual-image-"+c))}})});"use strict";h.when("A","page-transition-controller","page-conductor","client-side-metrics").register("checkout-vas-notification-preferences",function(e,b,g,d){function c(){m(".notification-preferences-widget :checkbox").change(a)}function a(){this.checked?d.increaseCount(k.CHECKBOX.SELECTED,
1):d.increaseCount(k.CHECKBOX.DESELECTED,1);f(m(this),this.checked)}function f(a,c){var e=g.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"}),f=h(a,c);m.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/notification-preferences.html",headers:e,async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",data:m.param(f,!0),beforeSend:function(){b.show()},success:function(a,c,e){d.increaseCount(k.PURCHASE_UPDATE.SUCCESS);b.hide()},error:function(e,f,g){d.increaseCount(k.PURCHASE_UPDATE.FAIL);
d.logError(g,"notification preference AJAX update call failed","checkout-vas-notification-preferences","ERROR");a.prop("checked",!c);b.hide()}})}function h(a,b){var c={};c[a.closest(".a-checkbox").attr("data-name")]=b?1:0;a.closest(".notification-preferences-widget").find("input:hidden").each(function(){var a=m(this);c[a.attr("data-name")]=a.val()});return c}var m=e.$,k={CHECKBOX:{SELECTED:"checkout:np:checkbox:selected",DESELECTED:"checkout:np:checkbox:deselected"},PURCHASE_UPDATE:{SUCCESS:"checkout:np:purchaseUpdate:success",
FAIL:"checkout:np:purchaseUpdate:fail"}};e.each(["checkout:reload:spc","checkout:reload:spp-revieworder"],function(a){e.off(a,c);e.on(a,c)})});h.when("A","ready").register("widgets/invoiceAddress/invoiceAddressSelect",function(){});h.when("A","jQuery","a-checkbox","client-side-metrics","ready").register("widgets/invoiceAddress/invoiceAddressSelectCommon",function(e,b,g,d){return{handleSelectInvoiceAddressFormSubmit:function(c){var a=b('[name\x3d"select_invoice_address"]'),e=g("#purchaseLevelSetInvoiceAddress").isChecked();
d.increaseCount("checkout:selectinvoiceaddress:purchaselevel","true"===e?1:0);if(null!==e||""!==e||"undefined"!==e)e=b("\x3cinput\x3e").attr("type","hidden").attr("name","isPurchaseLevelSetInvoiceAddressSelected").val(e),a.append(e);null!==c||""!==c||"undefined"!==c?(c=b("\x3cinput\x3e").attr("type","hidden").attr("name","encryptedTaxId").val(c),a.append(c)):d.increaseCount("checkout:selectinvoiceaddress:taxidnotfound",1)},getEncryptedTaxId:function(b){var a=e.state("selectInvoiceAddressParams");
if(a===r)return d.increaseCount("checkout:selectinvoiceaddress:getEncryptedTaxId:emptyinvoiceaddressparams",1),"";a=a.taxRegistrations;b=b.stateOrRegion;if(null!==b&&""!==b&&"undefined"!==b)return b=a[b.toUpperCase()],b===r?(d.increaseCount("checkout:selectinvoiceaddress:getEncryptedTaxId:taxidnotfoundforstate",1),""):b;d.increaseCount("checkout:selectinvoiceaddress:getEncryptedTaxId:statenotfound",1);return""}}});"use strict";h.when("A","jQuery","page-transition-controller","ajax-utility","page-conductor",
"page-detector","client-side-metrics","weblab-helper").register("widgets/financialOfferCheckbox/financingCheckboxCommon",function(e,b,g,d,c,a,f,h){return{clickFinancingCheckbox:function(a){a.preventDefault();c.isSPP()?(g.blockAllActions(),g.showTransitionInContainer(b("#payment"))):g.show();a={paymentMethodId:b("#payment-method-id").val(),paymentMethodType:b("#payment-method-type").val(),rewardAccountId:b("#reward-account-id").val(),rewardAccountAmount:b("#reward-account-amount").val(),rewardAccountRate:b("#reward-account-rate").val(),
useGCBalance:b("#use-gc-balance").val(),financialOfferId:b("#financial-offer-id").val(),returnFullHTML:1,returnjson:1,hasWorkingJavascript:1,isClientTimeBased:b("input[name\x3duseCtb]").val()};if(h.isChewbaccaAffordUpsellCheckboxMigrationEnabledUsingAjaxUpdate()){var e=b("#set-financial-offer-url").val();c.ajaxUpdate(e,a).done(function(){f.increaseCount("checkout:financingCheckbox:purchaseDocUpdateSuccess",1)}).fail(function(){f.increaseCount("checkout:financingCheckbox:purchaseDocUpdateFailure",
1)})}else e={"x-amz-checkout-page":"spc"},e=c.setAjaxTransitionHeader(e),b.ajax({type:"POST",url:"/gp/buy/payselect/handlers/continue.html",data:b.param(a,!0),dataType:"text",async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",headers:e,success:function(a,b,e){f.increaseCount("checkout:financingCheckbox:purchaseDocUpdateSuccess",1);e.getResponseHeader("x-amz-checkout-page")?c.ajaxUpdatePage(a,b,e):(a=d.jsonify(a),c.redirect(a))},error:function(a,b,d){f.increaseCount("checkout:financingCheckbox:purchaseDocUpdateFailure",
1);c.ajaxRedirect(a,b,d)}})}}});"use strict";h.when("A","jQuery","client-side-metrics","widgets/financialOfferCheckbox/financingCheckboxCommon").execute("widgets/financialOfferCheckbox/financingCheckbox",function(e,b,g,d){e.declarative("click-financing-checkbox","click",function(b){var a=b.data.click;a&&null!==a&&(g.increaseCount("checkout:spp-payment:clickFinancingCheckbox",1),d.clickFinancingCheckbox(b.$event))})});"use strict";h.when("A","jQuery","page-transition-controller","page-conductor","client-side-metrics").register("widgets/devicePreregistration/devicePreregistration",
function(e,b,g,d,c){function a(a,e,h){g.show();b.ajax({type:"POST",url:"/gp/buy/devices/preregistration/handlers/set-item-preregistration.html",data:{csrfToken:a,lineItemId:e,isChecked:h},dataType:"text",async:!0,cache:!1,headers:d.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"}),success:function(a,b,e){c.increaseCount("checkout:devicePreregistration:ajaxSuccess",1);d.ajaxUpdatePage(a,b,e,{pushNewFrame:"false"})},error:function(a,b,e){c.increaseCount("checkout:devicePreregistration:ajaxError",
1);d.ajaxRedirect(a,b,e)}})}e.declarative("mako-rcx-prereg-declarative","change",function(d){var e=b("[name\x3dcsrfToken]").val(),g=null==d.data?r:d.data.lineItemId;(d=d.$target.is(":checked"))?c.increaseCount("checkout:devicePreregistration:checked",1):c.increaseCount("checkout:devicePreregistration:unchecked",1);a(e,g,d)})});"use strict";h.when("A","jQuery","a-sheet","a-checkbox","page-conductor","page-spinner-controller","client-side-metrics","ready").register("widgets/devicePreregistration/devicePreregistrationBottomsheet",
function(e,b,g,d,c,a,f){function h(d,e,g){var q=g?"SELECTED":"UNSELECTED";d+="\x26lineItemId\x3d"+e+"\x26checkboxState\x3d"+q;a.show();b.ajax({type:"POST",url:d,dataType:"text",headers:{"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"},success:function(b,d,e){a.hide();f.increaseCount("checkout:mobile:devicePreregistrationPanel:ajaxSuccess:"+q,1);c.ajaxUpdatePage(b,d,e,{pushNewFrame:"false",mixedContentFallback:"reload"})},error:function(b,d,e){a.hide();f.increaseCount("checkout:mobile:devicePreregistrationPanel:ajaxError",
1);c.ajaxRedirect(b,d,e)}})}e.on("a:sheet:beforeShow",function(a){if(a.sheet&&a.sheet._preloadDomId&&0===a.sheet._preloadDomId.indexOf("device-preregistration")){var c="#"+a.sheet._preloadDomId;b(c).data().isdevicepreregistrationbottomsheet&&(a="#"+b(c).data().checkboxidentifier,c=b(c).data().isstateselectedinorderdoc,a=d(a),c?a.check():a.uncheck())}});e.declarative("dms-rcx-prereg-bottomsheet-continue","click",function(a){var b=d("#"+a.data.checkBoxIdentifier),c=g.get(a.data.bottomSheetName),e=a.data.isStateSelectedInOrderDoc,
e=b.isChecked()!==e,f=a.data.url;a=a.data.lineItemId;e&&h(f,a,b.isChecked());g.hideSheet(c)})});"use strict";h.when("A","jQuery","client-side-metrics","ready").register("widgets/devicePreregistration/reftagHelper",function(e,b,g){function d(a){a&&b.get("/hctp/log/refMarker?ref_\x3d"+a)}function c(){Object.keys(a).forEach(function(b){b="PREREGISTRATION_"+b+"_C_PC_"+a[b];g.increaseCount("checkout:device:preregistration:registerState:success",1);d(b)})}var a={};return{registerState:function(e,h,m,k){null!=
e&&null!=h&&null!=m&&null!=k?(h="E_"+(h?"CHECKED":"UNCHECKED"),m&&(h="D_"+(k?"GIFTED":"OTHER")),m=h,a[e]!==m&&(a[e]=m,d("PREREGISTRATION_"+e+"_C_"+a[e])),b('input[name\x3d"placeYourOrder1"]').unbind("click",c).bind("click",c),g.increaseCount("checkout:device:preregistration:registerState:success",1)):g.increaseCount("checkout:device:preregistration:registerState:failed",1)}}});h.when("A","client-side-metrics").execute("updp-fallback-auto-click",function(e,b){function g(){var d=e.$("#prime-updp-fallback-button");
d.length&&e.delay(function(){b.increaseCount("checkout:updp:fallback:clickedContinue",1);d.click()},100)}e.on("load",g);e.on("checkout:afterReload",g)});"use strict";h.when("A","jQuery").register("widgets/customizationDetails/customizationDetails",function(e,b){e.declarative("additional-customization-details-action","click",function(b){b.$currentTarget.closest(".sc-customization-details-list").find(".sc-customization-details-additional").removeClass("aok-hidden");b.$currentTarget.closest(".sc-customization-details-see-more").hide();
b.$event.preventDefault()})});"use strict";h.when("A","ready").register("widgets/progressIndicator/progressIndicator",function(){});"use strict";h.when("A","jQuery","page-transition-controller","loading-spinner-controller","ajax-utility","page-conductor","client-side-metrics").register("widgets/concealment/concealmentPopover",function(e,b,g,d,c,a,f){function h(){b("#spc-orders").find(".concealment-widgets-desktop").removeClass("no-js-hide");e.defer(function(){b("spc-orders").find(".concealment-popover-link").each(function(){b(this).data("action")&&
b(this).removeAttr("href").attr("tabindex",0)})})}function m(a){a.keyup(function(a){13===a.which&&b(a.target).trigger("click")})}function k(a){return a.is("input")?a:a.find("input")}function p(d){var e=d.data.popover.$popover,h="";d&&d.data&&d.data.lineItemId&&(h+="lineItemId\x3d"+d.data.lineItemId+"\x26");var p=k(e.find(".conceal-item-checkbox")).is(":checked"),h=p?h+"concealmentOption\x3dCONCEALED\x26":h+"concealmentOption\x3dNOT_CONCEALED\x26";d=k(e.find(".concealment-setter-url")).val();p?f.increaseCount("CPEX.Checkout.Select.Concealment",
1):f.increaseCount("CPEX.Checkout.Cancel.Concealment",1);a.isSPP()&&(e.find(".a-button-close").trigger("click"),e=b("#setOrderingPrefsCheckbox"),e.length&&e.is(":checked")&&(h+="\x26saveAsDefaultsSelected\x3d1"));g.show();b.ajax({type:"POST",url:d,data:h,dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"},contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(b,d,e){f.increaseCount("CPEX.Checkout.Concealment.ConcealmentEntity.Success",
1);e.getResponseHeader("x-amz-checkout-page")&&a.isSPP()?a.ajaxUpdatePage(b,d,e):(b=c.jsonify(b),a.redirect(b))},error:function(b,c,d){f.increaseCount("CPEX.Checkout.Concealment.ConcealmentEntity.Fatal",1);a.ajaxRedirect(b,c,d)}})}var q,v;b(document).delegate(".concealment-popover-link, .concealment-options-button","click",function(){f.increaseCount("CPEX.Checkout.ConcealmentOption.Button.click",1)});e.on("a:popover:hide",function(b){b.popover&&b.popover.name&&0===b.popover.name.indexOf("concealmentPopover-")&&
(a.isSPP()&&f.increaseCount("checkout:spp-revieworder:concealment_pop_cancel_sec",1),k(q.find(".conceal-item-checkbox")).removeAttr("checked"))});e.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("concealmentPopover-")){q=a.popover.$popover;v=a.popover;d.showSpinner(q.find(".popover-content-main"),!1,v);q.find(".content-container").css("visibility","hidden");var b=v.data.lineItemId,c=q.find(".set-concealment-options-button input");c.unbind("click").bind("click",
{lineItemId:b,popover:a.popover},p);m(c);q.find(".content-container").css("visibility","visible");d.hideSpinner(q.find(".popover-content-main"))}});e.on("checkout:reload:spc",h);e.on("checkout:reload:spp-revieworder",h)});"use strict";h.when("A","jQuery","page-transition-controller","ajax-utility","page-conductor","client-side-metrics").register("widgets/concealment/concealmentDropdown",function(e,b,g,d,c,a){function f(e){var f=e.data.name;m(f,"purchase-id").val();var h=m(f,"line-item-id").val(),
v=m(f,"gift-message").val(),u=m(f,"quantity").val();e="CONCEALED"===e.$target.find(":selected").val();var n="",u=""+("entityId.0\x3d"+h+"\x26")+("quantity.0\x3d"+u+"\x26")+"_from\x3dcheetah\x26",n=n+("lineItemId\x3d"+h+"\x26");e?(u+="isAFN.0\x3d1\x26",u+="includeReceipt.0\x3d1\x26",u+="includeMessage.0\x3d1\x26",u+="message.0\x3d"+encodeURIComponent(v)+"\x26",u+="hidePrices.0\x3d0\x26",u+="saveOnly\x3d1",u+="ref\x3dpkg_ckout_conceal_save_mpp\x26",n+="concealmentOption\x3dCONCEALED\x26"):(u+="ref\x3dpkg_ckout_conceal_cncl_mpp\x26",
n+="concealmentOption\x3dNOT_CONCEALED\x26");h="/gp/buy/gift/handlers/save-all.html/ref\x3d";e?(h+="pkg_ckout_conceal_save_mpp",a.increaseCount("CPEX.Checkout.Select.Concealment",1)):(h+="pkg_ckout_conceal_cncl_mpp",a.increaseCount("CPEX.Checkout.Cancel.Concealment",1));var r=m(f,"concealment-setter-url").val();g.show();b.ajax({type:"POST",url:h,data:u,dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"},contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
success:function(e,f,h){b.ajax({type:"POST",url:r,data:n,dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"},contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(){a.increaseCount("CPEX.Checkout.Concealment.ConcealmentEntity.Success",1);g.hide()},error:function(){a.increaseCount("CPEX.Checkout.Concealment.ConcealmentEntity.Error",1);var b=e;h.getResponseHeader("x-amz-checkout-page")?c.ajaxUpdatePage(b,f,h):(b=d.jsonify(b),
c.redirect(b))}})},error:function(b,d,e){a.increaseCount("CPEX.Checkout.Concealment.GiftEntity.Fatal",1);c.ajaxRedirect(b,d,e)}})}function h(d){var e=d.data.name,f=m(e,"line-item-id").val();d="CONCEALED"===d.$target.find(":selected").val();f=""+("lineItemId\x3d"+f+"\x26");d?(f+="concealmentOption\x3dCONCEALED\x26",a.increaseCount("CPEX.Checkout.Select.Concealment",1)):(f+="concealmentOption\x3dNOT_CONCEALED\x26",a.increaseCount("CPEX.Checkout.Cancel.Concealment",1));e=m(e,"concealment-setter-url").val();
g.show();b.ajax({type:"POST",url:e,data:f,dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"},contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(){a.increaseCount("CPEX.Checkout.Concealment.ConcealmentEntity.Success",1);g.hide()},error:function(b,d,e){a.increaseCount("CPEX.Checkout.Concealment.ConcealmentEntity.Fatal",1);c.ajaxRedirect(b,d,e)}})}function m(a,c){return b("[name\x3d"+a+"-"+c+"]")}e.declarative("click-concealment-dropdown",
"change",function(a){a.data.weblabInT2?h(a):f(a)})});"use strict";h.when("A","jQuery","client-side-metrics").execute(function(e,b,g){b(".rush-ispu-view-details-link.checkout-chewbacca-pickup-ship-option").live("click",function(){var d=b(this).data("url"),c=b(this).data("locationtype"),a=b(this).data("bottomsheetid");d!==r&&a!==r&&b.ajax({url:d,method:"get",contentType:"application/x-www-form-urlencoded;charset\x3dUTF-8",success:function(d){b(".a-sheet-content-container #"+a).html(d);g.setCountValue("checkout:inStorePickup:"+
c+":bottomSheetRenderSuccess",1)},error:function(d){b(".a-sheet-content-container #"+a).html(d.responseText);g.setCountValue("checkout:inStorePickup:"+c+":bottomSheetRenderSuccess",0)},traditional:!0})})});"use strict";h.when("A","jQuery","client-side-metrics").execute(function(e,b,g){b(".mfn-ispu-view-details-link.checkout-chewbacca-pickup-ship-option").live("click",function(){var d=b(this).data("url"),c=b(this).data("locationtype"),a=b(this).data("bottomsheetid");d!==r&&a!==r&&b.ajax({url:d,method:"get",
contentType:"application/x-www-form-urlencoded;charset\x3dUTF-8",success:function(d){b(".a-sheet-content-container #"+a).html(d);g.setCountValue("checkout:mfnInStorePickup:"+c+":bottomSheetRenderSuccess",1)},error:function(d){b(".a-sheet-content-container #"+a).html(d.responseText);g.setCountValue("checkout:mfnInStorePickup:"+c+":bottomSheetRenderSuccess",0)},traditional:!0})})});"use strict";h.when("A","jQuery","a-sheet","page-spinner-controller","page-conductor","client-side-metrics","configurations/keys",
"configurations/newCheckoutExperienceConfig").register("widgets/concealment/concealmentBottomsheet",function(e,b,g,d,c,a,f,h){var m=h.getConfiguration(f.CONTAINER_SELECTOR);e.declarative("click-concealment-radiogroup","change",function(e){var f=e.data.name,h=b("[name\x3d"+f+"-line-item-id]").val(),m=b("[name\x3d"+f+"-concealment-setter-url]").val(),n="CONCEALED"===e.$target[0].value;e="";var r=g.get(f),w=b("[id\x3d"+f+"-concelment-can-overwrap-concealed-text]"),U=b("[id\x3d"+f+"-concelment-can-overwrap-text]");
e+="lineItemId\x3d"+h+"\x26";n?(e+="concealmentOption\x3dCONCEALED\x26",a.setCountValue("CPEX.NewCheckoutExp.Select.Concealment",1)):(e+="concealmentOption\x3dNOT_CONCEALED\x26",a.setCountValue("CPEX.NewCheckoutExp.Cancel.Concealment",1));d.show();b.ajax({type:"POST",url:m,data:e,dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"},contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(){a.setCountValue("CPEX.NewCheckoutExp.Concealment.ConcealmentEntity.Success",
1);g.hideSheet(r);w.toggleClass("aok-hidden",!n);U.toggleClass("aok-hidden",n);d.hide()},error:function(b,d,e){a.setCountValue("CPEX.NewCheckoutExp.Concealment.ConcealmentEntity.Fatal",1);g.hideSheet(r);c.ajaxRedirect(b,d,e)}})});e.on("a:sheet:beforeShow",function(a){if(a.sheet&&a.sheet._name&&0===a.sheet._name.indexOf("concealmentbottomsheet-")){var c=a.sheet.getContentContainer();a="#"+a.sheet._name+"-concealment-bottom-sheet-content";var c=c.find(a),d=e.$(m).find(a).html();d!==r&&null!==d&&(c.empty(),
c.html(d),b(a).remove())}})});"use strict";h.when("A","jQuery","page-conductor","client-side-metrics").register("widgets/concealment/concealmentDropdownNewExp",function(e,b,g,d){e.declarative("click-concealment-dropdown-newexp","change",function(c){var a=c.data.name,e=b("[name\x3d"+a+"-line-item-id]").val(),a=b("[name\x3d"+a+"-concealment-setter-url]").val();c="CONCEALED"===c.$target.find(":selected").val();e=""+("lineItemId\x3d"+e+"\x26");c?(e+="concealmentOption\x3dCONCEALED\x26",d.setCountValue("CPEX.NewCheckoutExp.Select.Concealment",
1)):(e+="concealmentOption\x3dNOT_CONCEALED\x26",d.setCountValue("CPEX.NewCheckoutExp.Cancel.Concealment",1));g.ajaxUpdate(a,e).done(function(){d.setCountValue("CPEX.NewCheckoutExp.Concealment.ConcealmentEntity.Success",1)}).fail(function(){d.setCountValue("CPEX.NewCheckoutExp.Concealment.ConcealmentEntity.Fatal",1)})})});"use strict";h.when("A","jQuery","client-side-metrics","ready").register("widgets/taxRegistration/taxRegistration",function(e,b,g){function d(){var a=b(k.taxRegistrationNumberInput).val();
b(k.taxRegistrationNumberInput).val(a.replace(m,""))}function c(){var a=b(k.businessLegalNameInput).val();b(k.businessLegalNameInput).val(a.trim())}function a(a){return!a||0===a.toString().length}function f(){var c;c=b(k.taxRegistrationNumberInput).val();var d=b(k.businessLegalNameInput).val().trim();if(a(c)&&a(d))c=!0;else{var e=b(k.taxAddressRadio).length?b(k.taxAddressRadio+":checked").val():b(k.taxAddressSelection).val();c=a(c)||!h.test(c)||a(d)||a(e)?!1:!0}c?b(k.continueButton).removeClass("a-button-disabled").find('input[type\x3d"submit"]').removeAttr("disabled"):
b(k.continueButton).addClass("a-button-disabled").find('input[type\x3d"submit"]').attr("disabled","disabled")}var h=/^\d{11}$/,m=/\s+/g,k={taxAddressForm:"#taxAddressFormId",taxRegistrationNumberInput:"#tax-registration-number-field-tr",businessLegalNameInput:"#business-legal-name-tr",taxAddressRadio:'input:radio[name\x3d"taxaddressid"]',taxAddressSelection:"#taxaddressid",continueButton:"span.#continue-submit-span"};e.declarative("tax-registration-number-input","click keyup",function(a){d();c();
f()});e.declarative("tax-registration-legal-name-input","click keyup",function(a){d();f()});e.declarative("tax-registration-form","submit",function(d){a(b(k.taxRegistrationNumberInput).val())&&a(b(k.businessLegalNameInput).val())&&(d=b(k.taxAddressForm).attr("action"),b(k.taxAddressForm).attr("action",d.split("?")[0]),g.increaseCount("checkout:taxRegistrationForm:emptyValues",1));c()})})});