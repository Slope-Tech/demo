(function(c){var g=window.AmazonUIPageJS||window.P,h=g._namespace||g.attributeErrors,a=h?h("WidgetStreamer",""):g;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,g,h){c.when("jQuery","widget-streamer-action-ws-append","widget-streamer-action-ws-prepend","widget-streamer-action-ws-update","widget-streamer-action-ws-event").register("widget-streamer-actions",function(a,d,f,b,e){var c={"ws-append":d,"ws-prepend":f,"ws-update":b,"ws-event":e},k={execute:a.noop};
return{create:function(e){var b=k;if(a.isArray(e)&&e.length&&e[0]){b=e[0];var f=c[b];var d="widget-streamer-action-"+b;if("function"!==typeof f)throw Error("Action: "+b+" is not supported. Register component "+d+" to handle this action");b=f(e)}return b}}});"use strict";c.register("widget-streamer-jquery-action",function(){return function(a,d,f){if(!a||3>a.length)throw Error("Can not create update action, insufficient data in chunk: "+JSON.stringify(a));var b=a[1];var e=a[2];return{execute:function(a){var c=
a._$target.find(b).add(a._$target.filter(b));a._isTargetUpdated?f(c,e):d(c.get(0),e)}}}});"use strict";c.when("widget-streamer-jquery-action").register("widget-streamer-action-ws-update",function(a){return function(d){return a(d,function(a,b){a.innerHTML=b},function(a,b){a.html(b)})}});"use strict";c.when("widget-streamer-jquery-action").register("widget-streamer-action-ws-append",function(a){return function(d){return a(d,function(a,b){a.innerHTML+=b},function(a,b){a.append(b)})}});"use strict";c.when("widget-streamer-jquery-action").register("widget-streamer-action-ws-prepend",
function(a){return function(d){return a(d,function(a,b){a.innerHTML=b+a.innerHTML},function(a,b){a.prepend(b)})}});c.register("widget-streamer-action-ws-event",function(){return function(a){var d=a[1];try{var c=JSON.parse(a[2])}catch(b){c=null}return{execute:function(a){a._emitEvent(d,c)}}}});"use strict";c.register("widget-streamer-utils",function(){return{isStreamingAjax:function(a){if(a&&"function"===typeof a.getResponseHeader)a=a.getResponseHeader("Content-Type");else if(a&&a.http&&"function"===
typeof a.http.getResponseHeader)a=a.http.getResponseHeader("Content-Type");else throw Error("Unable to retrive headers for the given xhr object: "+a);return"application/json-amazonui-streaming"===a}}});"use strict";c.when("A","jQuery","widget-streamer-actions").register("widget-streamer",function(a,c,f){function b(a){a=a||{};this._$originalTarget=a.$target;this._$target=a.$target.clone();this._actions=[];this._isExecutable="undefined"===typeof a.immediateExecution||a.immediateExecution;this._onUpdate=
a.onUpdate||c.noop;this._hasExecutionStarted=!1;this._events=a.events||{};this._isTargetUpdated=!1;this._updateTriggerEvent=a.updateTriggerEvent;this.chunkHandler=c.proxy(this.chunkHandler,this)}b.prototype.chunkHandler=function(a){a=f.create(a);this._actions.push(a);this.executeActions()};b.prototype.enableExecution=function(){this._isExecutable=!0;this.executeActions()};b.prototype.executeActions=function(){var a;if(this._isExecutable&&this._actions.length)for(this._hasExecutionStarted||(this._hasExecutionStarted=
!0,this._updateTriggerEvent||this._updateTarget()),a=this._actions.shift();a;)a.execute(this),a=this._actions.shift()};b.prototype._emitEvent=function(a,b){var d=(this._events||{})[a]||c.noop;a===this._updateTriggerEvent&&this._updateTarget(b);d.call(this,b)};b.prototype._updateTarget=function(){this._onUpdate.apply(this,arguments);this._$originalTarget.html(this._$target.html());this._$target=this._$originalTarget;this._isTargetUpdated=!0};return function(a){return new b(a)}})});
/* ******** */
(function(q){var r=window.AmazonUIPageJS||window.P,G=r._namespace||r.attributeErrors,va=G?G("CheckoutCommonAsset",""):r;va.guardFatal?va.guardFatal(q)(va,window):va.execute(function(){q(va,window)})})(function(q,r,G){q.register("polyfill-indexof",function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(a,l){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),e=n.length>>>0;if(0===e)return-1;l=+l||0;Infinity===Math.abs(l)&&(l=0);if(l>=e)return-1;for(l=
Math.max(0<=l?l:e-Math.abs(l),0);l<e;){if(l in n&&n[l]===a)return l;l++}return-1})});"use strict";q.register("polyfill-filter",function(){Array.prototype.filter||(Array.prototype.filter=function(a){if(void 0===this||null===this)throw new TypeError;var l=Object(this),n=l.length>>>0;if("function"!==typeof a)throw new TypeError;for(var e=[],k=2<=arguments.length?arguments[1]:void 0,m=0;m<n;m++)if(m in l){var g=l[m];a.call(k,g,m,l)&&e.push(g)}return e})});"use strict";q.register("polyfill-json-stringify",
function(){"object"!==typeof JSON&&(JSON={});(function(){function a(a){return 10>a?"0"+a:a}function l(){return this.valueOf()}function n(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=v[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function e(a,b){var d=c,f=b[a];f&&"object"===typeof f&&"function"===typeof f.toJSON&&(f=f.toJSON(a));"function"===typeof y&&(f=y.call(b,a,f));switch(typeof f){case "string":return n(f);case "number":return isFinite(f)?
String(f):"null";case "boolean":case "null":return String(f);case "object":if(!f)return"null";c+=h;var g=[];if("[object Array]"===Object.prototype.toString.apply(f)){var k=f.length;for(a=0;a<k;a+=1)g[a]=e(a,f)||"null";b=0===g.length?"[]":c?"[\n"+c+g.join(",\n"+c)+"\n"+d+"]":"["+g.join(",")+"]";c=d;return b}if(y&&"object"===typeof y)for(k=y.length,a=0;a<k;a+=1){if("string"===typeof y[a]){var t=y[a];(b=e(t,f))&&g.push(n(t)+(c?": ":":")+b)}}else for(t in f)Object.prototype.hasOwnProperty.call(f,t)&&
(b=e(t,f))&&g.push(n(t)+(c?": ":":")+b);b=0===g.length?"{}":c?"{\n"+c+g.join(",\n"+c)+"\n"+d+"}":"{"+g.join(",")+"}";c=d;return b}}var k=/^[\],:{}\s]*$/,m=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,g=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,b=/(?:^|:|,)(?:\s*\[)+/g,d=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=l,Number.prototype.toJSON=l,String.prototype.toJSON=l);var c,h,y;if("function"!==typeof JSON.stringify){var v={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};JSON.stringify=
function(a,b,d){var f;h=c="";if("number"===typeof d)for(f=0;f<d;f+=1)h+=" ";else"string"===typeof d&&(h=d);if((y=b)&&"function"!==typeof b&&("object"!==typeof b||"number"!==typeof b.length))throw Error("JSON.stringify");return e("",{"":a})}}"function"!==typeof JSON.parse&&(JSON.parse=function(a,d){function e(a,b){var c,f=a[b];if(f&&"object"===typeof f)for(c in f)if(Object.prototype.hasOwnProperty.call(f,c)){var h=e(f,c);h!==G?f[c]=h:delete f[c]}return d.call(a,b,f)}a=String(a);f.lastIndex=0;f.test(a)&&
(a=a.replace(f,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(k.test(a.replace(m,"@").replace(g,"]").replace(b,"")))return a=eval("("+a+")"),"function"===typeof d?e({"":a},""):a;throw new SyntaxError("JSON.parse");})})()});"use strict";q.when("A","jQuery","client-side-metrics","weblab-helper","polyfill-filter","polyfill-json-stringify").register("ajax-wrapper",function(a,l,n,e){function k(a,b){function d(a,b){for(var d=0;d<a._options.length;d++){var c=a._options[d];
if(c=b.call(a,c,"object"===typeof c?c.name:c))return c}}this._options=a instanceof k&&b&&b.length?a._options.concat(b):a instanceof k?a._options:a&&a.length?a:[];this.filter=function(a){var b={};d(this,function(d,c){c in a&&(b[c]=a[c])});return b};this.getOption=function(a){return d(this,function(b,d){if(d===a)return b})};return this}function m(a){this._options=a.allowedOptions;this._messageForViolation=a.messageForViolation;this._messageForViolationWithValue=a.messageForViolationWithValue;this._optionName=
a.optionName;this._valueName=a.valueName;this.validate=function(a){for(var b in a)if(a.hasOwnProperty(b)){var d=this._options.getOption(b);if(!d)throw d=this._messageForViolation.replace(this._optionName,b),Error(d);if("object"===typeof d&&!d.validate(a[b]))throw d=this._messageForViolationWithValue.replace(this._optionName,b),d=d.replace(this._valueName,a[b]),Error(d);}};return this}function g(a){try{J.validate(a)}catch(M){console.error(M)}var d=u.filter(a);d=l.extend(d,b(a));return l.ajax(d)}function b(a){if(a.params){if(a.data&&
a.params)throw Error("The option data can not be present with the emulated params option. Merge both and use just one.");return{data:a.params}}}function d(b){try{N.validate(b)}catch(R){console.error(R)}var d={url:G,options:B.filter(b)},g=new l.Deferred;d.url=b.url;if(b.data){if(b.data&&b.params)throw Error("Unsupported options. 'params' and 'data' options are both specified. Remove one of them.");if("object"===typeof b.data)d.options.params=b.data;else if("string"===typeof b.data)e.isSetParamsFormatAsStirngWeblabOn()?
"GET"===b.type?d.url+="?"+b.data:(d.options.params=b.data,d.options.paramsFormat="string"):d.url+="?"+b.data;else throw Error("Unsupported type provided in the 'data' attribute of an AJAX call");}if(b.type){if(b.type&&b.method)throw Error("Unsupported options. 'type' and 'method' options are both specified. Remove one of them.");d.options.method=b.type}if("crossDomain"in b){if("crossDomain"in b&&"withCredentials"in b)throw Error("Unsupported options. 'crossDomain' and 'withCredentials' options are both specified. Remove one of them.");
d.options.withCredentials=b.crossDomain}d=c(d,b,g);d=f(d,b,g);d=y(d,b,g);d=h(d,b,g);d=v(d,b,g);b.beforeSend&&b.beforeSend(d.options);d=w(d,b,g);b=a.ajax(d.url,d.options);return b=g.promise(b)}function f(a,b,d){var c=a.options.success;a.options.success=function(a,b,e){c&&c(a,b,e);d.resolve(a,b,e)};var e=a.options.error;a.options.error=function(a,b,c){e&&e(a,b,c);d.reject(a,b,c)};var f=a.options.abort;a.options.abort=function(a){f&&f(a);d.reject(a,"abort")};return a}function c(a,b){if(!b.complete)return a;
var d=a.options.success;a.options.success=function(a,c,e){d&&d(a,c,e);b.complete(e,"success")};var c=a.options.error;a.options.error=function(a,d,e){c&&c(a,d,e);b.complete(a,"error")};var e=a.options.abort;a.options.abort=function(a){e&&e(a);b.complete(a,"abort")};return a}function h(a,b){var d=a.options.success;a.options.success=function(a,c,e){d&&("text"===b.dataType&&"object"===typeof a&&(a=JSON.stringify(a)),d(a,c,e))};return a}function y(a,b){if(!b.useXMLHttp)return a;var d=a.options.success;
a.options.success=function(a,b,c){c&&(c=c.http);d(a,b,c)};var c=a.options.error;a.options.error=function(a,b,d){a&&(a=a.http);c(a,b,d)};var e=a.options.abort;a.options.abort=function(a){a&&(a=a.http);e(a)};return a}function v(a,b){var d=a.options.success;a.options.success=function(a,b,c){c&&304===c.http.status?d(a,"notmodified",c):d(a,"success",c)};var c=a.options.error;a.options.error=function(a,b,e){a&&a.http.readyState<p.DONE?c(a,"timeout",e):a&&200<=a.http.status&&300>a.http.status&&a.http.readyState===
p.DONE?d(a.http.responseText,"success",a):a&&0==a.http.status?c(a,"abort",e):c(a,"error",e)};return a}function w(a,b){var d=a.options.success;a.options.success=function(a,b,c){x(c,"success");d(a,b,c)};var c=a.options.error;a.options.error=function(a,b,d){x(a,"error");c(a,b,d)};return a}function x(a,b){a?(n.increaseCount("AUI:Ajax:"+b+":xhr:defined"),a.http?n.increaseCount("AUI:Ajax:"+b+":xhr:http:defined"):a.http===G?n.increaseCount("AUI:Ajax:"+b+":xhr:http:undefined"):null===a.http&&n.increaseCount("AUI:Ajax:"+
b+":xhr:http:null")):a===G?n.increaseCount("AUI:Ajax:"+b+":xhr:undefined"):null===a&&n.increaseCount("AUI:Ajax:"+b+":xhr:null")}var p={UNSET:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},u=new k("accepts async beforeSend cache complete contents contentType context converters crossDomain data dataFilter dataType error global headers ifModified isLocal jsonp jsonpCallback method mimeType password processData scriptCharset statusCode success timeout traditional type url username xhr xhrFields".split(" ")),
B=new k("abort accepts cache chunk contentType error headers indicator method params success timeout withCredentials".split(" ")),A=new k(B,[{name:"async",validate:function(a){return a}},"useXMLHttp","beforeSend","complete","crossDomain","dataType","data","type","url"]),t=new k(u,["params"]),N=new m({allowedOptions:A,messageForViolation:"The option %O is not supported in AUI ajax calls and default ajax. Consider using jQuery ajax.",messageForViolationWithValue:"The option %O with value %V is not supported in AUI ajax calls and default ajax. Consider using jQuery ajax.",
optionName:"%O",valueName:"%V"}),J=new m({allowedOptions:t,messageForViolation:"The option %O is not supported in jQuery ajax calls and default ajax. Consider using AUI ajax.",messageForViolationWithValue:"The option %O with value %V is not supported in jQuery ajax calls and default ajax. Consider using AUI ajax.",optionName:"%O",valueName:"%V"}),Q=l("meta[name\x3ddefaultAJAX]").attr("content");"jQuery"!==Q&&"AUI"!==Q&&(Q="jQuery");return{default:function(a){try{N.validate(a),J.validate(a)}catch(F){console.error(F)}if("jQuery"===
Q)g(a);else if("AUI"===Q)d(a);else throw Error("Unknown AJAX method: "+Q);},jQuery:g,aui:d,READY_STATE:p}});"use strict";q.when("jQuery").register("weblab-helper",function(a){return{isAJAXWeblabOn:function(){return"1"===a("meta[name\x3dPAGE_CONDUCTOR_AUI_AJAX]").attr("content")},isAjaxStreamingEnabled:function(){return"1"===a("meta[name\x3dENABLE_AJAX_STREAMING]").attr("content")},isNavCFWeblabOn:function(){return"1"===a("meta[name\x3dEMIT_NAV_CF]").attr("content")},isRemoveOrderSummaryPrimaryActionBtnTextWeblabOff:function(){return"1"!==
a("#is-remove-os-pabt").val()},isSetParamsFormatAsStirngWeblabOn:function(){return"1"===a("meta[name\x3dSET_PARAMS_FORMAT_AS_STRING]").attr("content")},disablePrefetchForScheduledDeliveryWeblabOn:function(){return"1"===a("meta[name\x3dDISABLE_PREFETCH_FOR_SCHEDULED_DELIVERY]").attr("content")},isRemoveAddressFormOnDeleteAddressWeblabOn:function(){return"1"===a("meta[name\x3dREMOVE_ADDRESS_FORM_ON_DELETE_ADDRESS]").attr("content")},isSOSPExclusiveJSHandlerWeblabOn:function(){return"1"===a("meta[name\x3dSOSP_EXCLUSIVE_JS]").attr("content")},
sospPartialAvailabilityWeblabOn:function(){return"1"===a("meta[name\x3dSOSP_PARTIAL_UNAVAILABILITY]").attr("content")},refactorExtractURL:function(){return"1"===a("meta[name\x3dREFACTOR_EXTRACT_URL]").attr("content")},showGiftTextAreaOnWarning:function(){return"1"===a("meta[name\x3dSHOW_GIFT_TEXT_AREA_ON_WARNING]").attr("content")},isInterceptionAddressFormWidthFixEnabled:function(){return"1"===a("meta[name\x3dFIX_FIELD_WIDTH_IN_CHECKOUT_INTERCEPTION_FIX_ENABLED]").attr("content")},removesGiftOptionOnRush:function(){return"1"===
a("meta[name\x3dREMOVE_GIFT_OPTION_RUSH]").attr("content")},isSPCMobileDisplayMoreShipOptionsEnabled:function(){return"1"===a("meta[name\x3dSPC_MOBILE_DISPLAY_MORE_SHIP_OPTIONS]").attr("content")},isMCBMultiTenderWeblabEnabled:function(){return"1"===a("meta[name\x3dMCB_MULTI_TENDER_ENABLED]").attr("content")},isCreateAddressLinkForTaxAddressFormWeblabOn:function(){return"1"===a("meta[name\x3dCREATE_ADDRESS_IN_TAX_COLLECTION_ENABLED]").attr("content")},isMfaPSD2DeviceDescriptionCollectionEnabled:function(){return"1"===
a("meta[name\x3dMFA_PSD2_DEVICE_DESCRIPTION_COLLECTION_ENABLED]").attr("content")},isSospCalendarFixEnabled:function(){return"1"===a("meta[name\x3dSOSP_CALENDAR_FIX]").attr("content")},isUpdateMobileNumberEnabled:function(){return"1"===a("meta[name\x3dUPDATE_MOBILE_NUMBER]").attr("content")},isGILCreditCardEnabled:function(){return"1"===a("meta[name\x3dGIL_CREDIT_CARD_PAYMENT_METHOD]").attr("content")},isPyoClientSideInitiationEnabled:function(){return"1"===a("meta[name\x3dPYO_CLIENT_SIDE_INITIATION]").attr("content")},
isTFXCurrencyToggleOnTabletFixed:function(){return"1"===a("meta[name\x3dTFX_CURRENCY_TOGGLE_ON_TABLET_FIXED]").attr("content")},isTFXGuaranteedExchangeFeeEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_TFX_GUARANTEED_EXCHANGE_FEE]").attr("content")},isCSMErrorLoggingEnabled:function(){return"1"===a("meta[name\x3dENABLE_CSM_ERROR_LOGGING]").attr("content")},isLogAFFNFallbackEnabled:function(){return"1"===a("meta[name\x3dENABLE_AF_FN_FALLBACK]").attr("content")},isExecutionIdInQueryStringEnabled:function(){return"1"===
a("meta[name\x3dADD_EXECUTION_ID_TO_QUERY_STRING]").attr("content")},isDigitalAsinIndexingFixedOnSOSPEnabled:function(){return"1"===a("meta[name\x3dDIGITAL_ASIN_INDEXING_FIXED_ON_SOSP]").attr("content")},isCvfOldAmazonUiFixesEnabled:function(){return"1"===a("meta[name\x3dCVF_OLD_AUI_FIXES]").attr("content")},isHeadersCleaned:function(){return"1"===a("meta[name\x3dCLEAN_UP_HEADERS]").attr("content")},isItemAssociationDeleteConfirmationPopoverForWirelessPlansEnabled:function(){return"1"===a("#is-item-assoc-delete-confirmation-popover-for-wireless-plans").val()},
isSsdMdwEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_SSD_MDW]").attr("content")},isExcludeMdwFromGoldenCXWidgetRenamingWeblabEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_GOLDEN_CX_WIDGET_RENAMING_EXCLUDE_MDW]").attr("content")},isRemoveDigitalFlagForScheduledDeliveryShipmentEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_SD_NOT_DIGITAL]").attr("content")},isEGiftOptionsActive:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_EGIFT_OPTIONS_MOBILE]").attr("content")},
isPipelineDispatchSendHeaderEnabled:function(){return"1"===a("meta[name\x3dSEND_HEADER_FOR_PIPELINE_REQUEST]").attr("content")},isIngressEnabled:function(){return"1"===a("meta[name\x3dINGRESS_ENABLED]").attr("content")},isISPUMasterEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_ISPU_MASTER]").attr("content")},isRushISPUMasterEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_RENDER_RUSH_ISPU_MASTER]").attr("content")},isProgressiveOrderReviewCardAnchorEnabled:function(){return 1===
a("#progressive-order-review-card-anchor").length},isTaxExemptionMessagingFixed:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_TAX_EXEMPTION_MSGING]").attr("content")},isProgressiveOrderReviewScrollingFixEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_PROGRESSIVE_SCROLLING_FIX]").attr("content")},isVasTrueSPCEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_VAS_TRUESPC]").attr("content")},isSecureUnifiedDeliveryEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_SECURE_UNIFIED_DELIVERY]").attr("content")},
isChooseSDOButtonMultiClickFixEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_TSPC_CHOOSE_SDO_BUTTON_MULTI_CLICK_FIX]").attr("content")},isPageConductorConvergenceEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_PAGE_CONDUCTOR_TANGO_INGRESS_CONVERGENCE]").attr("content")},isSkipZeroShippingSpeedShipmentEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_SKIP_ZERO_SHIPPING_SPEED_SHIPMENT]").attr("content")},isScheduleDeliveryHiddenInputIdFixEnabled:function(){return"1"===
a("meta[name\x3dRCX_CHECKOUT_SCHEDULE_DELIVERY_HIDDEN_INPUT_ID_FIX_ENABLED]").attr("content")},isIngressEDGSetterResponseHandlerEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_INGRESS_EDG_SETTER_RESPONSE_HANDLER_ENABLED]").attr("content")},isProgressiveIndicatorScrollingFixEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_PROGRESS_INDICATOR_SCROLLING_FIX]").attr("content")},isOrderSummaryUpsellWidgetUpdateEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_PAGE_CONDUCTOR_OSU_WIDGET_UPDATE_ENABLED]").attr("content")},
isSnsChangeOrderTypeEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_SNS_CHANGE_ORDER_TYPE_ENABLED]").attr("content")},isBRMarketplaceCurrencyFormatEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_BR_MARKETPLACE_CURRENCY_FORMAT]").attr("content")},isProgressIndicatorPaySelectFixEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_PROGRESS_INDICATOR_PSP_FIX_ENABLED]").attr("content")},isAmazonDayDatePickerClickSkipShipOptionChangeEnabled:function(){return"1"===a("meta[name\x3dAMAZON_DAY_DATE_PICKER_CALENDAR_CLICK_SKIP_SHIP_OPTION_CHANGE]").attr("content")},
isAmazonDayIncentiveDetailsLinkRedirectionEnabledOnStripeMsg:function(){return"1"===a("meta[name\x3dIS_AMAZON_DAY_INCENTIVE_DETAILS_LINK_REDIRECTION_ENABLED_ON_STRIPE_MSG]").attr("content")},isDeleteTogetherPopoverEnabled:function(){return"1"===a("meta[name\x3dRCX_DELETE_TOGETHER_POPOVER_ENABLED]").attr("content")},isChewbaccaAffordUpsellCheckboxMigrationEnabledUsingAjaxUpdate:function(){return"1"===a("meta[name\x3dIS_CHEWBACCA_AFFORD_UPSELL_CHECKBOX_MIGRATION_ENABLED_USING_AJAX_UPDATE]").attr("content")},
isInstallmentsInvalidateRicSetterEnabled:function(){return"1"===a("meta[name\x3dIS_INSTALLMENTS_INVALIDATE_RIC_SETTER_ENABLED]").attr("content")}}});"use strict";q.when("A","client-side-metrics").register("weekend-availability-expander-helper",function(a,l){function n(a){return(a=g[a])?m("#weekend-availability-expander-header-text-"+a).text():m("#weekend-availability-default").text()}function e(){return 1==m("input[name\x3d'isBusinessDefaultWeekendDeliveryEnabled']").attr("value")?!0:!1}function k(a,
d){return a&&d?"BOTH":a?"SAT":d?"SUN":"NONE"}var m=a.$,g={BOTH:"both",SAT:"sat",SUN:"sun",NONE:"none"};return{isBusinessDefaultWeekendDeliveryViewActive:e,logExpanderState:function(a,d,e,c){l.increaseCount("checkout:delivery-preferences:"+a+":expander:"+d+":"+(e&&c?"neverExpanded":c?"collapsed":"expanded"),1)},stateToCheckboxes:function(a){var b=!1,f=!1;if(e()){if("BOTH"===a||"SAT"===a)b=!0;if("BOTH"===a||"SUN"===a)f=!0}else{if("BOTH"===a||"OTH"===a||"SAT"===a)b=!0;if("BOTH"===a||"OTH"===a||"SUN"===
a)f=!0}return{isSaturdayChecked:b,isSundayChecked:f}},updateAllOptOutMessages:function(a){1==m("input[name\x3d'isSundayDeliveryPreferenceSuppressed']").attr("value")?a.isSaturdayChecked?m(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!0):(m(".weekend-availability-opt-out-message").text(m("#weekend-availability-opt-out-sat-text").text()),m(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1)):a.isSaturdayChecked||a.isSundayChecked?a.isSaturdayChecked?a.isSundayChecked?
m(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!0):(m(".weekend-availability-opt-out-message").text(m("#weekend-availability-opt-out-sun-text").text()),m(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1)):(m(".weekend-availability-opt-out-message").text(m("#weekend-availability-opt-out-sat-text").text()),m(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1)):(m(".weekend-availability-opt-out-message").text(m("#weekend-availability-opt-out-both-text").text()),
m(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1))},updateAllTitles:function(a){a=k(a.isSaturdayChecked,a.isSundayChecked);m(".sat-sun-expander-heading-text").text(n(a))},updateAllWeekendAvailabilityStates:function(a){a=k(a.isSaturdayChecked,a.isSundayChecked);m("input[name\x3d'BusinessHours']").attr("value",a)}}});"use strict";q.when("A","loading-spinner-controller","page-transition-controller","page-conductor","checkout-general-utils","address-utilities","page-detector-current-page",
"client-side-metrics","weblab-helper").register("address-popovers",function(a,l,n,e,k,m,g,b,d){function f(a){(d.isHeadersCleaned()?a.popoverValid:a.getResponseHeader("x-amz-checkout-popover-valid"))||e.redirect({conductoraction:{url:"/gp/cart/view.html",type:"redirect"}})}function c(c,h,p){k.protectAgainstDoubleAction("show-add-address-popover",200)||(N=c.popover,!t('input[name\x3d"preloadAddressPopover"]').length||h.is(":empty")?(h.empty(),h.css("min-height",397),N.updatePosition(!0),l.showSpinner(h,
!1,N),c=(new Date).getTime(),p=g.getCurrentPage(),b.increaseCount("checkout:address-popover-pagetype:".curPage,1),p="itemselect"===p||"spp-itemselect"===p?1:0,d.isHeadersCleaned()?t.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/display.html?cachebuster\x3d"+c,data:{isBilling:P,isMultiAddress:p},dataType:"json",async:!0,cache:!1,headers:{"x-amz-checkout-page":"itemselect"},success:function(a,b,d){f(a);h.css("min-height",0);u(h,a.popoverContent)},error:e.ajaxRedirect}):t.ajax({type:"POST",
url:"/gp/buy/addressselect/handlers/popover/display.html?cachebuster\x3d"+c,data:{isBilling:P,isMultiAddress:p},async:!0,cache:!1,headers:{"x-amz-checkout-page":"itemselect"},success:function(a,b,d){f(d);h.css("min-height",0);u(h,a)},error:e.ajaxRedirect})):(m.customizeFormFromIdentity(h),m.countrySpecificPopoverOptimizationCheck(t("html")),p&&a.trigger("identity-assets")))}function h(a,c){if(!k.protectAgainstDoubleAction("add-new-address",200)){b.resetMetrics();var h=!1;t(".identity-protect-from-errant").each(function(){var a=
t(this);a=a.is("input")?a:a.find("input:first");-1!==a.val().search(/(\d[ -]?){13}/)&&(h=!0)});if(h){var g=t(".address-form-security-error:first");g.length?alert(g.text()):alert("Please check that the address you have entered is correct.")}else{c.$event.preventDefault();l.showSpinner(a,!1,N);var p=t("#domestic-address-popover-form, #international-address-popover-form, #address-popover-suggestions-form").filter(":visible");g=p.serialize();var m=(new Date).getTime();c=c.$currentTarget.find('input[type\x3d"submit"]').attr("name");
"useSelectedAddress"===c?g+="\x26fromSuggestionPage\x3d1":"fromAddressEditToContinue"===c&&(g+="\x26fromAddressEditToContinue\x3d1");t("#addAddressOnly").length&&(g+="\x26addOnly\x3d1");P&&(g+="\x26isBilling\x3d1");var n="/gp/buy/addressselect/handlers/popover/new.html";if(N){if("domestic-address-popover-form"===p.attr("id")&&(p.find(".enterAddressFormField").blur(),p="#"+a.attr("id")+" div[id^\x3donblur-character-validation-error-]",0<t(p).size())){l.hideSpinner(a);return}n+="/ref\x3dchk_addr_editPopoverSubmit";
e.isSPP()&&(N.lock(11),setTimeout(function(){N.unlock(12)},2E3))}var A=null!==J&&J!==G&&null!==Q&&Q!==G;"useSelectedAddress"===c&&!P&&A&&(g+="\x26fromSTMAPopover\x3d1");t("#international-address-popover-form").filter(":visible").length&&(g+="\x26showSecondaryForm\x3d1");B()&&F?y(a,m,g):d.isHeadersCleaned()?t.ajax({type:"POST",url:n+"?cachebuster\x3d"+m,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",data:g,dataType:"json",async:!0,cache:!1,error:e.ajaxRedirect,success:function(b,
d,c){e.isSPP()&&N.unlock(12);f(b);b.newPopoverType?v(b,d,b):b.reloadPopover?u(a,b.popoverContent):A?w(b):x("added",b.popoverContent)}}):t.ajax({type:"POST",url:n+"?cachebuster\x3d"+m,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",data:g,async:!0,cache:!1,error:e.ajaxRedirect,success:function(b,d,c){e.isSPP()&&N.unlock(12);f(c);c.getResponseHeader("x-amz-checkout-open-new-popover")?v(b,d,c):c.getResponseHeader("x-amz-checkout-reload-popover")?u(a,b):A?w(c):x("added",c)}})}}}function y(a,
b,c){var h=F.getNewTaxAddressPopoverURL();d.isHeadersCleaned()?t.ajax({type:"POST",url:h+"?cachebuster\x3d"+b,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",data:c,dataType:"json",async:!0,cache:!1,error:e.ajaxRedirect,success:function(b,d,c){e.isSPP()&&N.unlock(12);f(b);b.reloadPopover?u(a,b.popoverContent):b.newAddressId&&(t(".a-button-close").trigger("click"),k.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"),F.submitTaxAddressFormWithNewAddressId(b.newAddressId))}}):
t.ajax({type:"POST",url:h+"?cachebuster\x3d"+b,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",data:c,async:!0,cache:!1,error:e.ajaxRedirect,success:function(b,d,c){e.isSPP()&&N.unlock(12);f(c);c.getResponseHeader("x-amz-checkout-reload-popover")?u(a,b):c.getResponseHeader("x-amz-checkout-new-address-id")&&(t(".a-button-close").trigger("click"),k.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"),b=c.getResponseHeader("x-amz-checkout-new-address-id"),F.submitTaxAddressFormWithNewAddressId(b))}})}
function v(b,c,e){t('input[name\x3d"preloadAddressPopover"]').remove();d.isHeadersCleaned()?(c=e.newPopoverType,"suggestions"===c?(t("#address-suggestions-popover").empty().append(e.popoverContent),t("#address-suggestions-popover-link").trigger("click")):"edit"===c&&(c=t("#edit-address-popover"),c.empty().append(e.popoverContent),t("#edit-address-popover-link").trigger("click"),u(c,e.popoverContent))):(c=e.getResponseHeader("x-amz-checkout-open-new-popover"),"suggestions"===c?(t("#address-suggestions-popover").empty().append(b),
t("#address-suggestions-popover-link").trigger("click")):"edit"===c&&(c=t("#edit-address-popover"),c.empty().append(b),t("#edit-address-popover-link").trigger("click"),u(c,b)));a.trigger("identity-assets")}function w(a){a=d.isHeadersCleaned()?a.newAddressId:a.getResponseHeader("x-amz-checkout-new-address-id");var b=(new Date).getTime();t.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html?cachebuster\x3d"+b,data:{action:"update-address",lineitems:J,quantities:Q,addresses:a+".home..",
returnHTML:0},async:!0,cache:!1,error:e.ajaxRedirect,success:function(a,b,c){x("applied",c)}})}function x(b,c){var d=(new Date).getTime();t('input[name\x3d"shipToAddress"]').length?(b=function(){e.isSPP()?(n.blockAllActions(),n.shrinkPanel(t(".spp-panel.expanded"),!0)):n.show()},e.isNonBlockingAnimationEnabled()?a.delay(b,0):b(),b=g.getCurrentPage(),e.loadPage(b,"",G,{refTag:"chk_addr_editPopoverSubmit"},G,c)):(c=e.setAjaxTransitionHeader(),t.ajax({type:"POST",headers:c,url:"/gp/buy/shared/handlers/pipeline-dispatch.html?cachebuster\x3d"+
d,data:{useCase:"multiAddress",showAddressAdded:b,page:"itemselect"},dataType:"text",async:!0,cache:!1,error:e.ajaxRedirect,success:function(a,b,c){e.ajaxUpdatePage(a,b,c);t(".a-button-close").trigger("click");k.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")}}))}function p(a){a=t("#"+a);a.length&&a.empty()}function u(b,c){b.html(c);m.customizeFormFromIdentity(b);N.updatePosition(!0);a.trigger("identity-assets");m.countrySpecificPopoverOptimizationCheck(t("html"))}function B(){return d.isCreateAddressLinkForTaxAddressFormWeblabOn()&&
0<t("#isTaxAddress").length}function A(){P=t("#isBilling").length?1:0;if(d.isInterceptionAddressFormWidthFixEnabled()){var a=t(".enter-address-form");m.customizeFormFromIdentity(a)}}var t=a.$,N,J,Q,P=0,F=null;if(!t("html").hasClass("a-ie6"))return a.on("a:popover:show:add-address",function(a){p("edit-address-popover");p("add-billing-address-popover");P=0;c(a,t("#add-address-popover"),!1)}),a.on("a:popover:show:add-billing-address",function(a){p("edit-address-popover");p("add-address-popover");c(a,
t("#add-billing-address-popover"),!0)}),a.on("a:popover:show:address-suggestions",function(a){N=a.popover}),a.on("a:expander:delivery-expander:toggle:expand",function(a){a=t(".a-expander-content");m.fixOverflow(a)}),a.declarative("close-delete-popover",["click","touchend"],function(a){q.when("a-popover-base").execute(function(b){(b=b.get(a.data.popoverName))&&b.hide()})}),a.declarative("rm-address-action",["click","touchend"],function(a){q.when("a-popover-base").execute(function(b){(b=b.get(a.data.popoverName))&&
b.hide()});d.isRemoveAddressFormOnDeleteAddressWeblabOn()&&(p("edit-address-popover"),p("add-address-popover"),p("add-billing-address-popover"));q.when("page-conductor").execute(function(b){b.continueClicked(null,a.$target)})}),t(document).delegate("a.prevent-default-marker","click",function(a){a.preventDefault()}),a.declarative("select-billing-address-in-popover",["click","touchend"],function(a){a.$event.preventDefault();t("#address-list").submit();q.when("a-popover-base").execute(function(a){a.get("select-billing-address")&&
a.remove("select-billing-address")})}),a.declarative("trigger-popover-from-link",["click","touchend"],function(a){k.protectAgainstDoubleAction("trigger-popover-from-link",200)||(Q=J=null,t("#add-address-popover-link").trigger("click"))}),a.declarative("add-address-popover-submit",["click","touchend"],function(a){h(t("#add-address-popover"),a)}),a.declarative("add-billing-address-popover-submit",["click","touchend"],function(a){h(t("#add-billing-address-popover"),a)}),a.declarative("edit-address-popover-submit",
["click","touchend"],function(a){h(t("#edit-address-popover"),a)}),a.declarative("address-suggestions-submit",["click","touchend"],function(a){h(t("#address-suggestions-popover"),a)}),a.declarative("delete-address-popover-submit",["click","touchend"],function(a){a=t("#delete-address-button");0<a.length&&a.click()}),a.declarative("edit-address-suggestions",["click","touchend"],function(a){if(!k.protectAgainstDoubleAction("show-edit-address-popover",200)){var b=t("#address-suggestions-popover");a.$event.preventDefault();
l.showSpinner(b,!1,N);a=t("#address-popover-suggestions-form");var c=a.serialize();a.find('input[type\x3d"radio"]').each(function(){var a=t(this);a.attr("checked")&&(c+="\x26edit_"+a.val()+"\x3d1")});P&&(c+="\x26isBilling\x3d1");N&&e.isSPP()&&(N.lock(11),setTimeout(function(){N.unlock(12)},2E3));a=(new Date).getTime();d.isHeadersCleaned()?t.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/edit.html?cachebuster\x3d"+a,data:c,dataType:"json",async:!0,cache:!1,error:e.ajaxRedirect,success:function(a,
b,c){e.isSPP()&&N.unlock(12);f(a);v(a,b,a)}}):t.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/edit.html?cachebuster\x3d"+a,data:c,async:!0,cache:!1,error:e.ajaxRedirect,success:function(a,b,c){e.isSPP()&&N.unlock(12);f(c);v(a,b,c)}})}}),a.declarative("add-address-popover-edit",["click","touchend"],function(a){if(!k.protectAgainstDoubleAction("add-address-popover-edit",200)){a.$event.preventDefault();var b=t("#add-address-popover");l.showSpinner(b,!1,N);a=t("#address-popover-suggestions-form").serialize()+
"\x26"+a.$currentTarget.find('input[type\x3d"submit"]').attr("name")+"\x3d1";var c=(new Date).getTime();d.isHeadersCleaned()?t.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/edit.html?cachebuster\x3d"+c,data:a,dataType:"json",async:!0,cache:!1,error:e.ajaxRedirect,success:function(a,c,d){f(a);u(b,a.popoverContent)}}):t.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/edit.html?cachebuster\x3d"+c,data:a,async:!0,cache:!1,error:e.ajaxRedirect,success:function(a,c,d){f(d);
u(b,a)}})}}),a.declarative("add-address-popover-toggle",["click","touchend"],function(a){k.protectAgainstDoubleAction("add-address-popover-toggle",200)||(a.$event.preventDefault(),a=a.$currentTarget.closest(".enter-address-form"),m.toggleAddressForm(a,a.siblings(".enter-address-form")))}),a.declarative("select-radio-option",["click","touchend"],function(a){a=a.$currentTarget.find(".radio-option");a.find('input[type\x3d"radio"]').attr("checked","checked");a.closest(".radio-option-list").find(".radio-option").removeClass("radio-option-selected");
a.addClass("radio-option-selected")}),a.declarative("trigger-address-popover",["click","touchend"],function(a){k.protectAgainstDoubleAction("trigger-address-popover",200)||t("#add-address-popover-link").trigger("click")}),a.on("checkout:reload:spp-shipaddress",A),a.on("checkout:reload:spp-billing-address",A),a.on("checkout:reload:itemselect",A),a.on("checkout:reload:spp-itemselect",A),{actionTriggerPopoverFromDropdown:function(a){a=a.$currentTarget.closest(".lineitem");J=a.find('input[name^\x3d"lineItemEntityID."]').val();
Q=a.find('input[name^\x3d"quantity."]').val();a=t("#add-address-popover-link");a.length?a.trigger("click"):t("#add-new-address-popover").trigger("click")},actionRegisterTaxAddressController:function(a){B()&&!F&&a&&(F=a)}}});"use strict";q.when("A").register("address-book-controller",function(a){function l(){n("div.address-book").unbind("recalculate-address-height").bind("recalculate-address-height",function(){var a,k=n(),m=0,g=n("div.address-book .js-same-height"),b=g.length;g.css({height:"auto"}).each(function(d){var e=
n(this);a=a||e.offset().top;a!==e.offset().top&&(k.height(m),k=n(),m=0,a=e.offset().top);var c=e.height();k=k.add(e);c>m&&(m=c);d===b-1&&0<m&&k.height(m)})}).trigger("recalculate-address-height");n(r).unbind("resize.checkout-as").bind("resize.checkout-as",function(){n("div.address-book").trigger("recalculate-address-height")})}var n=a.$;a.on("checkout:reload:spp-shipaddress",l);a.on("checkout:reload:shipaddressselect",l);a.on("checkout:reload:billingaddressselect",l);a.on("checkout:reload:spp-billing-address",
l)});"use strict";q.when("A","client-side-metrics","weblab-helper").register("address-utilities",function(a,l,n){function e(a){a.find("input").each(function(){var a=b(this),c=a.outerWidth(!0),d=a.parent().outerWidth(!0);c>d&&a.attr("size")&&(document.getElementById(a.attr("id")).removeAttribute("size"),a.width("100%"))})}function k(a){if(b('input[name\x3d"useLiveAUI"]').length)q.when("p-detect").execute(function(c){c.capabilities.inputPlaceholder&&a.find(".field-description").each(function(){var a=
b(this),c=a.text(),d=a.closest(".a-col-right").find(":not(.address-form-skip-js-tweaks):not(.address-form-skip-js-tweaks *) input");d.attr("maxlength")<c.length&&d.attr("size",c.length);d.attr("placeholder",a.text())})}),a.find("input").each(function(){b(this).outerWidth()}),a.find("input[type\x3d'text'], select").each(function(){var a=b(this).closest(".full-width-config"),c=b(this);0===a.find(".a-popover-trigger").length&&(n.isInterceptionAddressFormWidthFixEnabled()?c.addClass("addressform-textfield-width"):
c.width("96%"))});else{q.when("p-detect").execute(function(c){c.capabilities.inputPlaceholder?a.find(".field-description").each(function(){var a=b(this),c=a.text(),d=a.closest(".a-column").find(":not(.address-form-skip-js-tweaks):not(.address-form-skip-js-tweaks *) input");d.attr("maxlength")<c.length&&d.attr("size",c.length);d.attr("placeholder",a.text())}):a.find(".field-description").each(function(){var a=b(this);a.find("br").remove();a.show()})});a.find(".popover-field-label").each(function(){var a=
b(this);a.find("b").each(function(){var a=b(this);a.text(b.trim(a.text()))});a.find("font").each(function(){var a=b(this);"-2"===a.attr("size")&&a.remove()})});var d=b(".enter-address-form");e(d);var c=0;d=a.find(".one-new-address-form-field").first();d.length&&d.find(".a-column").each(function(){c+=b(this).outerWidth()});a.width(0<c?c:"")}}function m(b){function d(){n=e.val();(p=m[n])&&g.find(".learn-more a").text(p.popOverLinkText)}var c=r.P&&r.P.AUI_BUILD_DATE,e=b.find("#enterAddressCountryCode"),
g=b.find(".country-specific-form-input");if(c){var k=g.find("input");var m=b.find(".country-specific-config").data("popovercountryconfig")}else l.increaseCount("removeauijs2"),k=g.find("#"+g.data("inputid")),m=g.find(".country-specific-config").data("popovercountryconfig");if(e.length&&g.length&&k.length&&m){var n=e.val(),p=m[n];e.unbind("change.countryChangeConfigUpdate").bind("change.countryChangeConfigUpdate",d);d();var u=c?"show":"beforeShow";a.on("a:popover:"+u+":checkout-"+g.data("inputid")+
"Name",function(a){"beforeShow"===u&&l.increaseCount("removeauijs3");p&&(a.popover.$popover.find(".a-popover-header h4").html(p.popOverTitle),a.popover.$popover.find(".a-popover-inner").html(p.popOverText),a.popover.updatePosition())})}}function g(a){function d(){var a=e.val();(a=m[a])?(a=(a=a.label)||"",k.attr("placeholder",b("\x3cdiv /\x3e").html(a).text().replace(":","")),g.show()):g.hide()}var c=r.P&&r.P.AUI_BUILD_DATE,e=a.find("#enterAddressCountryCode"),g=a.find(".country-specific-form-input-mobile");
if(c){var k=g.find("input");var m=a.find(".country-specific-config").data("labelcountryconfig")}else l.increaseCount("removeauijs3"),k=g.find("#"+g.data("inputid")),m=g.find(".country-specific-config").data("labelcountryconfig");e.length&&g.length&&k.length&&m&&(e.unbind("change.countryChangeLabelUpdate").bind("change.countryChangeLabelUpdate",function(){g.hasClass("initial-edit-value")?g.removeClass("initial-edit-value"):k.val("");d()}),d())}var b=a.$;q.when("a-checkbox").execute(function(b){a.declarative("delivery-preferences-weekend-availability-checkbox-triggered",
"click",function(a){if("undefined"!==typeof a.$target){var c=a.$target.val();a.$target.is(":checked")&&("NONE"===c?(b("#delivery-preferences-weekend-availability-sat").uncheck(),b("#delivery-preferences-weekend-availability-sun").uncheck()):"SAT"!==c&&"SUN"!==c||b("#delivery-preferences-weekend-availability-none").uncheck())}})});a.declarative("wdp-redesign-addresstype-radio-clicked","click",function(a){var d=a.$target.context.id;a=b(".com-businesshours-text");var c=b("#delivery-preferences-weekend-availability-sat").is(":checked"),
e=b("#delivery-preferences-weekend-availability-sun").is(":checked");"devyPrefs_AddressType_COM"===d?(l.increaseCount("WDPTotalCOMClick"),b(".wdp-res").removeClass("a-color-base-background").addClass("a-color-alternate-background"),b(".wdp-com").removeClass("a-color-alternate-background").addClass("a-color-base-background"),b(".wdp-BusinessHours").removeClass("aok-hidden")):"devyPrefs_AddressType_RES"===d?(l.increaseCount("WDPTotalRESClick"),b(".wdp-com").removeClass("a-color-base-background").addClass("a-color-alternate-background"),
b(".wdp-res").removeClass("a-color-alternate-background").addClass("a-color-base-background"),b(".wdp-BusinessHours").addClass("aok-hidden")):"delivery-preferences-weekend-availability-sat"===d?(l.increaseCount("WDPTotalSATClick"),d=c?e?"BOTH":"SAT":e?"SUN":"OTH",a.addClass("aok-hidden"),b(".com-businesshours-"+d).removeClass("aok-hidden")):"delivery-preferences-weekend-availability-sun"===d&&(l.increaseCount("WDPTotalSUNClick"),d=e?c?"BOTH":"SUN":c?"SAT":"OTH",a.addClass("aok-hidden"),b(".com-businesshours-"+
d).removeClass("aok-hidden"))});return{toggleAddressForm:function(a,g){a.hide();g.find("div.a-alert-error:not(.js-originally-shown-imb)").hide();a.find("input[type\x3d'text'], select, input[type\x3d'radio']:checked, input[type\x3d'hidden']").each(function(){var a=b(this),d=a.attr("name")||a.data("copyto")||a.attr("id");if(!a.is(":disabled")&&!a.find(":selected").is(".js-not-a-value")){var e=g.find("input[name\x3d'"+d+"']");"enterAddressLandmark"===d&&(e=g.find("input[name\x3d'Landmark']"));"Landmark"!==
d||e.length||(e=g.find("input[name\x3d'enterAddressLandmark']"));1<e.length&&a.is("input[type\x3d'radio']")?e.filter("[value\x3d'"+a.val()+"']").attr("checked",!0):e.is("select")?e.find("option[value\x3d'"+a.val()+"']").attr("selected",!0):a.is("input[type\x3d'hidden']")||e.is("input[type\x3d'hidden']")||e.val(a.val())}});g.show();e(g);k(g)},customizeFormFromIdentity:k,fixOverflow:e,countrySpecificLabelOptimizationCheck:function(a){var b=a.find(".enter-address-form");1===b.data("taxidOpt")?setTimeout(function(){g(b)},
100):g(b)},countrySpecificPopoverOptimizationCheck:function(a){var b=a.find(".enter-address-form");1===b.data("taxidOpt")?setTimeout(function(){m(b)},100):m(b)}}});"use strict";q.when("A","page-conductor","page-transition-controller","client-side-metrics","page-detector-current-page","checkout-general-utils").register("address-form-helper",function(a,l,n,e,k,m){function g(a,b,c){h(".a-button-close").trigger("click");h('\x3cinput name\x3d"addressID"/\x3e').val(a).appendTo(c);h('\x3cinput name\x3d"purchaseId"/\x3e').val(b).appendTo(c);
l.continueClicked(null,c)}function b(a,b){b||(b=h("#address-ui-checkout-form"));f(b);var e=(new Date).getTime();h.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html?cachebuster\x3d"+e,data:{action:"update-address",lineitems:y,quantities:v,addresses:a,returnHTML:0},async:!0,cache:!1,error:function(){c(b);l.ajaxRedirect},success:function(a,c,e){d("applied",b)}})}function d(a,b){var d=(new Date).getTime(),e=l.setAjaxTransitionHeader();h.ajax({type:"POST",headers:e,url:"/gp/buy/shared/handlers/pipeline-dispatch.html?cachebuster\x3d"+
d,data:{useCase:"multiAddress",showAddressAdded:a,page:"itemselect"},dataType:"text",async:!0,cache:!1,error:function(){c(b);l.ajaxRedirect},success:function(a,d,e){c(b);l.ajaxUpdatePage(a,d,e);h(".a-button-close").trigger("click");m.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")}})}function f(a){l.isSPP()?(n.blockAllActions(),n.showTransitionInContainer(a)):n.show()}function c(a){l.isSPP()?(n.unblockAllActions(),h(a).find("div.section-overwrap").remove()):n.hide()}var h=a.$,y,v;
a.on("a:popover:afterUpdatePosition:edit-address",function(b){b.popover&&b.popover.isVisible()&&a.trigger("checkout:popoverContentLoaded:edit-address",b.popover)});a.on("a:popover:afterUpdatePosition:add-address",function(b){b.popover&&b.popover.isVisible()&&a.trigger("checkout:popoverContentLoaded:add-address",b.popover)});a.on("a:popover:visible:add-address",function(b){b.popover&&b.popover.isVisible()&&a.trigger("checkout:popoverContentLoaded:add-address",b.popover)});a.on("a:popover:beforeShow:add-address",
function(){a.trigger("checkout:popover-beforeShow:add-address")});a.on("a:popover:beforeShow:edit-address",function(){a.trigger("checkout:popover-beforeShow:edit-address")});a.on("a:popover:invisible:add-address",function(){a.trigger("checkout:popover-hide:add-address")});a.on("a:popover:invisible:edit-address",function(){a.trigger("checkout:popover-hide:edit-address")});a.on("checkout:reload:spp-shipaddress",function(){a.trigger("checkout:reload:address-page")});a.declarative("itemselect-update-address",
["change"],function(a){a=a.$currentTarget.closest(".lineitem");y=a.find('input[name^\x3d"lineItemEntityID."]').val();v=a.find('input[name^\x3d"quantity."]').val()});return{setDestination:function(a,c){a||(e.increaseCount("checkout:addressForm:setDestination:noRequest",1),a={});var d=a.addressId;d||e.increaseCount("checkout:addressForm:setDestination:noAddressId",1);var f=a.purchaseId||h("input[name\x3d'purchaseId']").val();f||e.increaseCount("checkout:addressForm:setDestination:noPurchaseId",1);a=
a.ref||"ox_shipaddress_add_new_addr";var m=k.getCurrentPage();if("itemselect"===m||"spp-itemselect"===m)return b(d,c);h('[name\x3d"isBilling"]')&&1==h('[name\x3d"isBilling"]').val()?(a="ox_billing_continue",(c=h("input[name\x3d'paymentInstrumentId']").val())||e.increaseCount("checkout:addressForm:setDestination:noPaymentInstrumentId",1),(m=h("input[name\x3d'paymentMethodCode']").val())||e.increaseCount("checkout:addressForm:setDestination:noPaymentMethodCode",1),a=h("\x3cform/\x3e").attr("action",
"/gp/buy/billingaddressselect/handlers/continue.html/ref\x3d"+a),h('\x3cinput name\x3d"paymentInstrumentId"/\x3e').val(c).appendTo(a),h('\x3cinput name\x3d"paymentMethodCode"/\x3e').val(m).appendTo(a),h('\x3cinput name\x3d"action" value\x3d"select-billing"/\x3e').appendTo(a),h('\x3cinput name\x3d"isAUIWSAddressCreationWorkflow" value\x3d"1"/\x3e').appendTo(a),g(d,f,a)):(a=h("\x3cform/\x3e").attr("action","/gp/buy/addressselect/handlers/continue.html/ref\x3d"+a),h('\x3cinput name\x3d"action" value\x3d"select-shipping"/\x3e').appendTo(a),
g(d,f,a))},onPageTransitionStart:f,onPageTransitionComplete:c}});"use strict";q.when("A","client-side-metrics","weblab-helper").register("action-logger",function(a,l){var n=a.$;a.declarative("ue-count",["click","touchend"],function(a){l.increaseCount(a.data.countFlag,a.data.countValue)});return{logUsedPrefetch:function(a,k,m,g){g||(l.increaseCount("Checkout:action-log:MissingRefMarker"),g="");n.ajax({type:"GET",url:"/gp/buy/shared/handlers/log-used-prefetch.html"+g,data:"pageType\x3d"+a+"\x26subPageType\x3d"+
k+"\x26relatedRequestId\x3d"+m,dataType:"text",cache:!1})}}});"use strict";q.when("A","weblab-helper").register("ajax-utility",function(a,l){return{jsonify:function(n){var e;if(e=l.isAJAXWeblabOn()){e=n instanceof Function;var k=n instanceof Array,m=n instanceof String;e=n instanceof Object&&!k&&!e&&!m}if(e)return n;try{n=a.$.parseJSON(n)}catch(g){n=null}return n}}});"use strict";q.when("A","page-conductor","client-side-metrics","weblab-helper").register("button-blocker",function(a,l,n,e){function k(a,
b,c,d){l.isSPP()?b.closest("span.a-declarative").data("blockerText",c):b.find("input.a-button-text").data("blockerText",c);m(d);h?(a.addClass("aok-hidden"),b.removeClass("aok-hidden"),g("#hasTVNavigation").length&&q.when("a-tv").execute(function(b){b.remove(a)})):(n.increaseCount("removeauijs10"),a.hide(),b.show(),b.hasClass("aok-hidden")&&b.removeClass("aok-hidden"))}function m(a){var b=g(".continue-button-blocker-text");b.length&&(a?(b.html(a),b.removeClass("aok-hidden")):(b.addClass("aok-hidden"),
b.empty()))}var g=a.$,b={},d=[],f,c,h=r.P&&r.P.AUI_BUILD_DATE,y=!1;e=e.isPyoClientSideInitiationEnabled()?"checkout:unload":"checkout:beforeReload";a.on(e,function(){d=[];b={};f=""});return{show:function(a,c,e){if(!y){var h=g(".continue-button");if(h.length)if(c){var m=g(".continue-button-blocker");if(m.length){e=e||"";var B=b[a]!==G&&b[a].tooltipText!==c,l=b[a]!==G&&b[a].buttonInlineText!==e;if(0===d.length||!b[a]||B||l)k(h,m,c,e),f=a;b[a]===G&&d.push(a);b[a]={tooltipText:c,buttonInlineText:e}}}else r.console&&
r.console.error&&console.error("showBlockerOnContinue should not be called with an empty tooltip."),n.increaseCount("Checkout:ButtonBlocker:EmptyTooltip")}},hide:function(a){if(!y){if(b[a]!==G){delete b[a];var c=g.inArray(a,d);d.splice(c,1)}var e=g(".continue-button");e.length&&(c=g(".continue-button-blocker"),c.length&&(0===d.length?(m(),h?(c.addClass("aok-hidden"),e.removeClass("aok-hidden"),g("#hasTVNavigation").length&&q.when("a-tv").execute(function(a){a.add(e)})):(n.increaseCount("removeauijs11"),
c.hide(),e.show(),e.hasClass("aok-hidden")&&e.removeClass("aok-hidden"))):f===a&&(f=d[0],k(e,c,b[f].tooltipText,b[f].buttonInlineText))))}},lock:function(){y=!0},unlock:function(){y=!1},getButtonBlocker:function(){c||(c=g(".continue-button-blocker"));return c}}});"use strict";q.when("A","button-blocker","client-side-metrics").register("button-blocker-controller",function(a,l,n){function e(a,b){g[a]!==G&&g[a].state!==b&&(g[a].state=b,k())}function k(){var a=!0,c;m.each(g,function(e,g){c=g.owner;if(g.state===
d.DISABLE_CONTINUE)return a=!1,l.show(c,g.toolTipMessage,g.buttonInlineMessage),b||(n.increaseCount("removeauijs12"),m(".continue-button-blocker").css("display","inline-block")),!1});a&&l.hide(c)}var m=a.$,g={},b=r.P&&r.P.AUI_BUILD_DATE,d={ENABLE_CONTINUE:"enableContinue",DISABLE_CONTINUE:"disableContinue"};a.on("checkout:beforeReload",function(){g={}});return{disableContinue:function(a,b,h,m){m=m||"";g[b]===G&&(h?(g[b]!==G||(g[b]={state:d.ENABLE_CONTINUE,owner:a,toolTipMessage:h,buttonInlineMessage:m}),
k()):r.console&&r.console.error&&console.error("_registerElement should not be called with an empty tooltip."));e(b,d.DISABLE_CONTINUE)},enableContinue:function(a){g[a]!==G&&e(a,d.ENABLE_CONTINUE)}}});"use strict";q.when("jQuery").register("cache-page-data-controller",function(a){var l={};return{clearCache:function(){l={}},setCachedPageData:function(n,e,k,m,g){var b=[],d=!0;a(".cacheable-spp-panel").each(function(){var c=a(this);var e=!c||c.find(".is-scheduled-delivery").length?!1:!0;if(!e)return d=
!1;c.find(".expand-panel-button").removeClass("a-button-focus");b.push({id:c.attr("id"),content:c[0].outerHTML})});if(d){var f={panels:b};a(".cacheable-spp-section").each(function(){var b=a(this);f[b.attr("id")]=b[0].outerHTML});l[n+"-"+e]={curPageData:f,state:r.history?history.state:k,page:n,title:document.title||m,url:r.location.href||g}}},getCachedPageData:function(a,e){return l[a+"-"+e]}}});"use strict";q.when("A").register("checkout-general-utils",function(a){function l(a,b,d,f){var c=k.getAssocParamValuesFromUrl(a);
!d&&f?delete c[b]:c[b]=d;b=0<=a.indexOf("?")?a.substring(0,a.indexOf("?")):a;b=b+"?"+e.param(c,1);(a=k.getFragmentFromUrl(a))&&(b+="#"+a);return b}function n(a){a=a||document.location.pathname;e.each(m,function(d,e){if((d=e.validator)&&d.test(a))return b=e,!1});if(!b)var b=m.UNKNOWN;return b.type}var e=a.$,k={moveToNextInput:function(a){a=a.nextAll(":visible").find("input").get(0);a!==[]&&a.focus()},hide:function(a){a.hide()},show:function(a){r.P&&r.P.AUI_BUILD_DATE&&a.hasClass("aok-hidden")&&a.removeClass("aok-hidden");
a.show()},getAssocParamValuesFromUrl:function(a){var b={};if("string"!==typeof a||-1===a.indexOf("?"))return b;a=a.slice(a.indexOf("?")+1);if(!a)return b;-1!=a.indexOf("#")&&(a=a.substring(a,a.indexOf("#")));a=a.split("\x26");for(var d=0;d<a.length;d++){var e=a[d].split("\x3d");b[e[0]]=e[1]}return b},addQueryStringParameter:function(a,b,d){return l(a,b,d,!1)},addQueryStringParameterOrDeleteIfEmpty:function(a,b,d){return l(a,b,d,!0)},getQueryStringParameter:function(a,b){a=k.getAssocParamValuesFromUrl(a);
return b in a?a[b]:G},getFragmentFromUrl:function(a){var b=a.indexOf("#");return-1==b?G:a.substring(b+1)},extractURLParts:function(a){if(!a||"string"!==typeof a)return{};a=/(.*html)(\/ref[^?\n]*)?[?]?(.*)/g.exec(a);var b={};a&&(a[1]&&(b.normalizedUrl=a[1]),a[2]&&(b.refMarker=a[2]),a[3]&&(b.query=a[3]));return b},buildFilteredQueryString:function(a,b){var d="?";if(null==a||null==b)return"";b.forEach(function(b){var c=k.getQueryStringParameter(a,b);c&&(d=k.addQueryStringParameterOrDeleteIfEmpty(d,b,
c))});return"?"===d?"":d},redirectWithJavascript:function(a){r.location=k.addQueryStringParameter(a,"hasWorkingJavascript","1")},bindActionEnterKeyOnButton:function(a){a.keyup(function(a){13===a.which&&e(a.target).trigger("click")})},toggleExpanderContent:function(a){a=a.$target.closest(".a-box");a.hasClass("a-single")?a.removeClass("a-single").addClass("a-first"):a.addClass("a-single").removeClass("a-first")},validateNumber:function(a,b,d){e.trim(a);return/^\d+$/.test(a)&&a>=b&&a<=d}};k.protectAgainstDoubleAction=
function(){var a={};return function(b,d){if(!b)return r.console&&r.console.error&&console.error("Function is not used properly, use a unique owner to identify the caller."),!1;if(a.hasOwnProperty(b))return!0;a[b]=1;setTimeout(function(){delete a[b]},d||100);return!1}}();k.logErrorOnLevel=function(a,b){(r.ueLogError||e.noop)({message:a,logLevel:b});if(r.console){var d={FATAL:r.console.error,"default":r.console.warn};b=d[b]||d["default"]}else b=e.noop;b.call(r,a)};k.logError=function(a){k.logErrorOnLevel(a,
"FATAL")};k.updateCartByMash=function(a){q.when("safe-mash").execute(function(b){null!==a&&a!==G&&"1"===e("#updateCartByMash").attr("content")&&b&&b.cart&&b.cart.didUpdate&&b.cart.didUpdate({newCartQuantity:a})})};k.getPosition=function(a,b,d){for(var e=0,c=a.length,h=0;h<c;h++)if(a.charAt(h)===b&&(e++,e===d))return h;return-1};k.limitInputToNumbers=function(a){var b=a.$event.keyCode;-1!==e.inArray(b,[46,8,9,37,39])||-1!==e.inArray(b,[65,67,86])&&!0===a.ctrlKey||(a.$event.shiftKey||(48>b||57<b)&&
(96>b||105<b))&&a.$event.preventDefault()};k.nukeDropdowns=function(a){q.when("a-popover-base").execute(function(b){e.each(e(a),function(){b.remove(this.name)})})};var m={GURUPA:{type:"gurupa",validator:/.*\/gp\/buy\/.*/},CHEWBACCA:{type:"chewbacca",validator:/.*\/checkout\/p\/.*/},UNKNOWN:{type:"unknown"}};"function"===typeof Object.freeze&&Object.freeze(m);k.getUrlType=n;k.isChewbaccaUrl=function(a){return n(a)===m.CHEWBACCA.type};a.on("checkout:reload",function(){e('input[name\x3d"useLiveAUI"]').length||
a.defer(function(){e(".a-declarative, .a-button").filter("[data-action]").unbind("keypress.checkout-page").bind("keypress.checkout-page",function(a){13===a.which&&e(this).trigger("click")})})});a.on("checkout:beforeLoadPage",function(){e("div.a-popover").find(".a-declarative:first:[data-action\x3dcustom-popover-close|a-popover-close]").click()});return k});"use strict";q.when("A","weblab-helper").register("client-side-metrics",function(a,l){var n=a.$,e=null,k=null,m=0,g,b=a.capabilities&&a.capabilities.isAmazonApp||
r.amazon&&r.amazon.mash;a=function(){};var d=r.uet||a,f=r.uex||a,c=!1,h=!1,y=function(a){r.ue&&r.ue.t&&(r.uet(a,e),t("checkout:client-side-metrics:uet:marker:"+a,1,1),null===e&&null===k&&r.ue.isl&&(t("checkout:client-side-metrics:mark:at",1,1),r.uex("at")));"af"===a?c=!0:"fn"===a&&(h=!0)},v=function(a){r.ue&&r.uex&&(r.uex(a,e),t("checkout:client-side-metrics:uex:marker:"+a,1,1))},w=function(a){r.ue&&r.ues&&r.ues("id",e,a)},x=function(){r.ue&&r.ues&&r.ues("ctb",e,"1")},p=function(){r.ue&&r.ues&&(b&&
y("mts",e),r.ues("t0",e,(new Date).getTime()),y("ue"),y("bb"))},u=function(a){a?k="ctbajax"+m++:e="ajax"+m++};a=function(a){e=a};var B=function(){return e},A=function(){return k},t=function(a,b,c){"undefined"!==typeof r.ue&&"undefined"!==typeof r.ue.count&&(b=b?b:1,c?r.ue.count(a,(r.ue.count(a)||0)+1):r.ue.count(a,b))},N=function(a){if(a&&a.length){var b=e;e=k;w(a);e=b}},J=function(){g===G&&(g=0<n("#transitionLogging").length);return g},Q=function(a,b,c,d){r.ueLogError&&r.ueLogError(a,{message:b,
attribution:c,logLevel:d})};return{getscope:B,getasyncscope:A,setmarker:y,sendue:v,setrid:w,setctb:x,resetue:p,createscope:u,setscope:a,getScope:B,getAsyncScope:A,setMarker:y,sendUe:v,setRid:w,setCtb:x,resetUe:p,createScope:u,setScope:a,increaseCount:t,resetMetrics:function(){e=k;x();p()},setAsyncRequestId:N,sendUEPageLoadStats:function(){!l.isCSMErrorLoggingEnabled()||c&&h||Q({message:"Logged ld without both af and fn logged first af:"+c+" fn:"+h},"","checkout-client-side-metrics","WARN");l.isLogAFFNFallbackEnabled()&&
(!0===c&&t("checkout:client-side-metrics:page-load-stats:earlyaf",1),t("checkout:client-side-metrics:page-load-stats:af",1),y("af"));l.isLogAFFNFallbackEnabled()&&(!0===h&&t("checkout:client-side-metrics:page-load-stats:earlyfn",1),t("checkout:client-side-metrics:page-load-stats:fn",1),y("fn"));v("ld");u(1);h=c=!1},isTransitionLoggingEnabled:J,logPageTransition:function(a,b,c,d){if(J()){var e=(new Date).getTime();n.ajax({type:"POST",url:"/gp/buy/shared/handlers/log-page-transition.html?cachebuster\x3d"+
e,data:{fromPage:a,toPage:b},async:!0,cache:!1,timeout:1E3,success:function(a,b,d){var e=d.getResponseHeader("x-amz-checkout-requestid");N(e);c&&c.call(this,a,b,d)},complete:function(a,b){d&&d.call(this,a,b)}})}},logError:Q,startWidgetTiming:function(a){d("bb",a,{wb:1})},finishWidgetTiming:function(a){f("ld",a,{wb:1})},setMarkerForWidget:function(a,b){d(a,b,{wb:1})},emitNexusMetrics:function(a,b,c){"undefined"!==typeof r.ue&&"undefined"!==typeof r.ue.event&&r.ue.event(a,b,c)},setCountValue:function(a,
b){t(a,b,!1)}}});"use strict";q.register("currency-formatter",function(){function a(l,n){isNaN(n)||(l=Number(l).toFixed(n));l=l.toString();n=0<=l.lastIndexOf(".")?l.lastIndexOf("."):l.length;return 3>=n?l:a(l.substring(0,n-3),0)+","+l.substring(n-3)}return{getNumberWithSeparators:a}});"use strict";q.when("A","client-side-metrics","page-conductor","page-detector").register("delivery-preferences-csm-helper",function(a,l,n,e){function k(a){var b=n.isSPP()?"spp":"mpp",f="desktop";e.isMobile()?f="mobile":
e.isTablet()&&(f="tablet");l.increaseCount("checkout:delivery-preferences:"+f+":"+b+":"+a,1)}function m(a){return 0===a.length?"NoValueSet":a}var g=a.$;return{recordCSM:k,recordCSMWithCurrentFieldValues:function(a,d,e){d=g("input[name\x3d"+d+"]:checked");d.length&&(d=d.val(),k(a+":preference:"+m(d)));e=g("input[name\x3d"+e+"]");e.length&&k(a+":set-as-default:"+(e.is(":checked")?"yes":"no"))},recordCSMForEligiblePages:function(a){a=a||"";k(a+"eligible-page-displayed");var b=g("input[name\x3ddelivery-preferences-preference-set]");
b.length&&k(a+"summary-displayed:preference:"+m(b.val()))}}});"use strict";q.when("A").register("error-feature-detection",function(a){function l(a){r.errorFeatureDetection&&r.errorFeatureDetection.safelyLogError?r.errorFeatureDetection.safelyLogError(a):(r.ueLogError&&r.ueLogError(a),r.console&&r.console.error&&console.error(a))}try{a.on("page-detector:page-changed",function(){q.now("page-detector-current-page").execute(function(a){if((a=a.getCurrentPage())&&"spc"===a)try{r.errorFeatureDetection&&
r.errorFeatureDetection.enableErrorHandling&&r.errorFeatureDetection.enableErrorHandling()}catch(e){l(e)}else try{r.errorFeatureDetection&&r.errorFeatureDetection.disableErrorHandling&&r.errorFeatureDetection.disableErrorHandling()}catch(e){l(e)}})})}catch(n){l(n)}return{registerFeature:function(a,e){try{r.errorFeatureDetection&&r.errorFeatureDetection.registerFeature&&r.errorFeatureDetection.registerFeature(a,e)}catch(k){l(k)}},markFeatureAvailable:function(a){try{r.errorFeatureDetection&&r.errorFeatureDetection.markFeatureAvailable&&
r.errorFeatureDetection.markFeatureAvailable(a)}catch(e){l(e)}},markFeatureUnavailable:function(a){try{r.errorFeatureDetection&&r.errorFeatureDetection.markFeatureUnavailable&&r.errorFeatureDetection.markFeatureUnavailable(a)}catch(e){l(e)}}}});q.when("error-feature-detection").execute(function(a){a.registerFeature("continue-action",0);a.markFeatureAvailable("javascript-detection");a.markFeatureAvailable("continue-action")});"use strict";q.when("A","page-transition-controller").execute(function(a,
l){a=a.$;"1"===a("#showSpinnerOnProceedToCheckout").attr("content")&&(l.show(),q.when("ready").execute(function(){l.hide()}))});"use strict";q.when("A","loading-spinner-controller","ajax-utility","currency-formatter","page-conductor","page-transition-controller").register("inline-points-register-controller",function(a,l,n,e,k,m){function g(a){var b=new RegExp(String.fromCharCode(65340),"g"),c=new RegExp(String.fromCharCode(92,92,92,92),"g");a=a.replace(b,String.fromCharCode(92),"g");a=a.replace(c,
String.fromCharCode(92));a=a.replace(/\\1/g,String.fromCharCode(34));return a=a.replace(/\\2/g,String.fromCharCode(10))}function b(a){var b=v.$popover.find(".rewards-registration");l.hideSpinner(b);b.children("div").hide();b=b.find(".rewards-registration-error");a&&a.error?(a=b.find("[data-error\x3d'"+a.error+"']"),a.length?a.show():b.find("[data-error\x3d'rewards_SystemUnavailable']").show()):b.find("[data-error\x3d'rewards_SystemUnavailable']").show();b.fadeIn(300)}function d(a){v=a.popover;var c=
v.$popover.find(".rewards-registration");l.showSpinner(c,!1,v);a=c.data("issuer-id");var d=c.data("program-id"),e=c.data("cc-issuer"),h=c.data("cc-brand");c=c.data("parent-payment-method-id");var f="/gp/buy/payselect/handlers/get-rewards-configuration.html?cachebuster\x3d"+(new Date).getTime();y.ajax({type:"POST",url:f,data:"programid\x3d"+d+"\x26partner\x3d"+a+"\x26ccpaymentinstrumentid\x3d"+c+"\x26issuer\x3d"+e+"\x26brand\x3d"+h+"\x26hasWorkingJavascript\x3d1",dataType:"text",async:!0,cache:!1,
dataFilter:function(a){return n.jsonify(a)},success:function(a,b,c){b=v.$popover.find(".rewards-registration");l.hideSpinner(b);c=a.fields||{};for(var d in c)if(c.hasOwnProperty(d)){var e=c[d],h=b.find("[data-field\x3d'"+e.type+"']");e.value&&h.filter("input").attr("value",e.value);h.parents(".rewardsfield").show()}a.termshtml&&b.find(".rewardstermstext").html(g(a.termshtml));a.billingzip&&b.find("[data-field\x3dBILLING_POSTAL_CODE]").attr("value",a.billingzip);if(a.displaydata){d=b.find("[data-field]");
for(var f in a.displaydata)a.displaydata.hasOwnProperty(f)&&d.filter("[data-field\x3d"+f+"]").html(a.displaydata[f])}a.marketinglink&&b.find("[data-field\x3d'rewards_marketing_link']").html(a.marketinglink);b.find("#rewards-registration-image").show();b.find(".rewards-registration-main").fadeIn(300);v.updatePosition(!0)},error:function(a){b(a)}})}function f(){if(v){var a=v.$popover.find(".rewards-registration");l.hideSpinner(a);a.find(".rewards-registration-success").hide();a=a.find(".rewards-registration-error");
a.hide();a.find("h4").hide();w&&(m.show(),k.isSPP()?k.reloadPage():y("div.pay").length?k.loadPage("payselect","payselect"):y("div.spc").length&&k.loadPage("spc","spc"))}}function c(a){return a.is("input")?a:a.find("input")}function h(){if(v){var a=v.$popover.find(".rewards-registration");a.find(".rewards-registration-main").hide();a.find("#rewards-registration-image").hide();l.showSpinner(a,!1,v);var d=(new Date).getTime(),h="programid\x3d"+encodeURIComponent(a.data("programId"));h+="\x26paymentinstrumentid\x3d"+
encodeURIComponent(a.data("parent-payment-method-id"))+"\x26hasWorkingJavascript\x3d1\x26returnjson\x3d1\x26cachebuster\x3d"+d;var f=a.find("[data-field]");f.each(function(){var a=y(this).attr("data-field");if("CVV2"===a)h+="\x26registerRewardsCreditCardVerificationNumber\x3d"+encodeURIComponent(y(this).val());else if(y(this).data("entryindex")){if(1===y(this).data("entryindex")){var b=f.filter("[data-field\x3d"+a+"]").sort(function(a,b){return Number(y(a).data("entryindex"))-Number(y(b).data("entryindex"))});
h+="\x26"+a+"\x3d";b.each(function(){h+=encodeURIComponent(y(this).val())})}}else"TERMS_AND_CONDITIONS"===a?c(y(this)).is(":checked")&&(h+="\x26"+a+"\x3dtrue"):h+="\x26"+a+"\x3d"+encodeURIComponent(y(this).val())});d="ox_pay_page_swp_reg_popover_submit";a.data("programId")&&(d+="_"+a.data("programId"));a="/gp/buy/payselect/handlers/register-rewards-account.html/ref\x3d"+d+"?cachebuster\x3d"+(new Date).getTime();y.ajax({type:"POST",url:a,data:h,dataType:"text",async:!0,cache:!1,dataFilter:function(a){return n.jsonify(a)},
success:function(a,c,d){a?a&&0===a.success?b(a):v&&(c=v.$popover.find(".rewards-registration-success"),c.find(".customername").text(a.customername),a.dollarbalancedisplay&&a.pointsbalance&&(c.find("[data-field\x3d'rewardsamount']").html(a.dollarbalancedisplay),c.find("[data-field\x3d'pointsamount']").html(e.getNumberWithSeparators(a.pointsbalance,a.rewardsdecimalplaces)),c.find(".rewardsuccessbalance").show()),a.showwarnmessage&&c.find(".warnmessage").show(),w=!0,c.fadeIn(300),l.hideSpinner(v.$popover.find(".rewards-registration"))):
b()},error:function(a){b(a)}})}}var y=a.$,v,w=!1;a.on("a:popover:show:rewards-registration",d);a.on("a:popover:hide:rewards-registration",f);a.declarative("close-rewards",["click"],function(a){a.$event.preventDefault();a.$target.closest(".a-popover").find(".a-button-close").trigger("click")});a.declarative("rewards-signup",["click"],function(a){a.$event.preventDefault();h(a)});a.declarative("toggle-reward-signup-button","change",function(a){a=a.$target;var b=v.$popover.find(".rewards-registration");
a&&a.is(":checked")?(b.find("#reward-signup-button").removeClass("aok-hidden"),b.find("#disabled-reward-signup-button").addClass("aok-hidden")):(b.find("#reward-signup-button").addClass("aok-hidden"),b.find("#disabled-reward-signup-button").removeClass("aok-hidden"))});a.on("a:popover:beforeShow:cvv2helpcontent",function(a){a.popover.$popover.find(".a-popover-inner").html(y(".cvv2helpcontent").text());a.popover.updatePosition()});return{displayRewardsRegister:d,hideRewardsRegister:f}});"use strict";
q.when("A","error-feature-detection","safe-mash","ready").register("shared-kitchensink",function(a,l,n){var e=a.$;a.on("checkout:reload",function(){(e("body.a-touch").length||e("div.a-touch:first").length)&&e("html").addClass("a-touch");e("form").each(function(){var a=e(this).find('input[name\x3d"hasWorkingJavascript"]');a&&0<a.length?a.val("1"):e(this).append('\x3cinput type\x3d"hidden" name\x3d"hasWorkingJavascript" value\x3d"1" /\x3e')});n&&(e("div.checkout-tablet a[target\x3d'AmazonHelp']").each(function(){var a=
e(this).attr("href");a+=0<=a.indexOf("?")?"\x26app-nav-type\x3dmodal":"?app-nav-type\x3dmodal";a=a.replace("#","");e(this).attr("href",a);e(this).removeAttr("data-action");e(this).removeAttr("data-help-popup");e(this).removeAttr("onclick")}),e("div.checkout.mobile a[target\x3d'AmazonHelp']").each(function(){var a=e(this).attr("href");a=a.replace("#","");e(this).attr("href",a);e(this).removeAttr("data-help-popup");e(this).removeAttr("onclick");e(this).addClass("a-declarative help-popup");e(this).attr("data-action",
"help-popup")}));if(0<e("div.checkout-tablet").length)for(var a=document.getElementsByTagName("a"),m=0;m<a.length;m++)a[m].href||(a[m].href="#")});e(document).bind("jsdetection",function(){l.markFeatureAvailable("javascript-detection")})});q.when("A","safe-mash","ready").execute(function(a,l){var n=a.$;a.declarative("mash-navigate",["click"],function(a){a=a.$currentTarget.attr("href");l&&l.navigate?l.navigate({url:a}):r.location.href=a});a.declarative("expander-scroll-there",["click"],function(a){if("false"!==
a.$currentTarget.closest(".a-expander-container").find(".a-expander-content").attr("aria-expanded")){var e=n(r),m=n(document),g=a.$currentTarget.offset().top,b=0,d=0,f=function(){r.setTimeout(function(){e.scrollTop(g);b===m.height()?d++:(d=0,b=m.height());10>d&&f()},10)};f()}})});r.amz_js_PopWin=function(a,l,n){(a=r.open(a,l,n))&&a.focus&&a.focus();return!1};var va=!1;r.confirmPurchase_onSubmit||(r.confirmPurchase_onSubmit=function(){return va?!1:va=!0});"use strict";q.when("A","error-feature-detection",
"loading-spinner-spp-controller","loading-spinner-aui-controller").register("loading-spinner-controller",function(a,l,n,e){function k(){return b("#checkout-spinner").length}function m(a){if(d&&f){if(y&&x){a=y.getContent();var e=a.innerHeight();var h=a.innerWidth();var p=a.offset()}else e=a.height(),h=a.width(),p=a.offset();a=f.width();var k=f.height();if(c)p="1"===b("input[name\x3dfromAnywhere]").val()?b(document).height():b(r).height(),d.width(b(document).width()).height(p).css("left","0px").css("z-index",
2E3),f.css("left",h/2-a/2+"px").css("top",e/2-k/2+"px").css("z-index",4E3).show();else{var m=b(r),g=x?m.scrollLeft():0;d.css("position","fixed").width(h).height(e).css("z-index",3E3).css("left",p.left-g).css("top",p.top-m.scrollTop());v?f.css("position","fixed").css("left",p.left-g+(h/2-a/2)+"px").css("top",p.top-m.scrollTop()+(e/2-k/2)+"px").css("z-index",4E3).show():f.css("left",h/2-a/4+"px").css("top",e/2-k/4+"px").css("z-index",4E3).show()}}}function g(){var a="https://images-na.ssl-images-amazon.com/images/G/01/amazonui/loading/loading-4x._V391853216_.gif",
c=b("#first-pipeline-load-page-spinner-img");c.length&&(a=b.trim(c.attr("src")));1>b("#loading-spinner-blocker-doc").length&&(a=b(['\x3cdiv class\x3d"template loading-spinner" style\x3d"display:none"\x3e\x3cdiv class\x3d"loading-spinner-blocker"\x3e\x3c/div\x3e\x3cdiv class\x3d"loading-spinner-inner"\x3e','\x3cimg id\x3d"loading-spinner-img" class\x3d"loading-spinner-img" src\x3d"'+a+'"/\x3e','\x3c/div\x3e\x3c/div\x3e\x3cdiv id\x3d"loading-spinner-blocker-doc" class\x3d"loading-spinner-blocker" style\x3d"display:none;"\x3e\x3c/div\x3e\x3cdiv id\x3d"spinner-anchor" class\x3d"spinner-anchor" style\x3d"display:none"\x3e\x3c/div\x3e'].join("")),
f=d=h=null,"1"===b("#showSpinnerWithoutBox").attr("content")&&a.find(".loading-spinner-inner").addClass("loading-spinner-inner-no-box"),b("body").prepend(a));b("input[name\x3duseModifiedSpinnerResizeFn]").length&&(v=!0);b("#useRelativeSpinner").length&&(w=!0);b("#modifiedBlockerDivSize").length&&(x=!0)}var b=a.$,d,f,c,h,y,v=!1,w=!1,x=!1,p=!1;a.on("a:popover:positionUpdated",function(a){if(x&&y&&y.name===a.popover.name&&d&&f){var c=y.getContent();a=c.innerHeight();var e=c.innerWidth();c=c.offset();
var h=b(r);d.width(e).height(a).css("left",c.left-h.scrollLeft()).css("top",c.top-h.scrollTop());f.css("left",c.left-h.scrollLeft()+(e/2-f.width()/2)+"px").css("top",c.top-h.scrollTop()+(a/2-f.height()/2)+"px")}});g();a.on("checkout:reload",g);return{showSpinner:function(a,g,A){if(w&&!g&&x&&v&&A)return p=!0,n.showSpinner(a,A);k()?e.showSpinner():(p=!1,0!==a.length&&(y=(c=g)?G:A,h||(h=b(".loading-spinner.template").clone().removeClass("template"),h.show()),a.append(h),c?(d=b("#loading-spinner-blocker-doc"),
a.find(".loading-spinner-blocker").hide()):d=a.find(".loading-spinner-blocker"),d.show(),c&&l.markFeatureUnavailable("continue-action"),f=a.find(".loading-spinner-inner"),m(a)))},hideSpinner:function(a,b){if(k())return e.hideSpinner();if(p)return p=!1,n.hideSpinner(a,b);p=!1;d&&(c&&(d.hide(),l.markFeatureAvailable("continue-action")),h.detach());b&&a.hide()},adjustSize:function(a){return k()?e.adjustSize():p?n.adjustSize():m(a)}}});"use strict";q.when("A","error-feature-detection").register("loading-spinner-spp-controller",
function(a,l){function n(){if(k&&m){var a=b.innerHeight(),c=b.innerWidth();k.width(c).height(a);m.css("left",c/2-m.width()/2+"px").css("top",a/2-m.height()/2+"px")}}var e=a.$,k,m,g,b,d;a.on("a:popover:positionUpdated",function(a){d&&d.name===a.popover.name&&n()});a.on("checkout:reload",function(){var a="https://images-na.ssl-images-amazon.com/images/G/01/amazonui/loading/loading-4x._V391853216_.gif",b=e("#first-pipeline-load-page-spinner-img");b.length&&(a=e.trim(b.attr("src")));1>e(".loading-spinner-spp").length&&
(a=e(['\x3cdiv class\x3d"template loading-spinner-spp" style\x3d"display:none"\x3e\x3cdiv class\x3d"loading-spinner-spp-blocker"\x3e\x3c/div\x3e\x3cdiv class\x3d"loading-spinner-spp-inner"\x3e','\x3cimg class\x3d"loading-spinner-spp-img" src\x3d"'+a+'"/\x3e',"\x3c/div\x3e\x3c/div\x3e"].join("")),m=k=g=null,"1"===e("#showSpinnerWithoutBox").attr("content")&&a.find(".loading-spinner-inner").addClass("loading-spinner-inner-no-box"),e("body").prepend(a))});return{showSpinner:function(a,c){0!==a.length&&
(d=c,b=a,g||(g=e(".loading-spinner-spp.template").clone().removeClass("template"),g.show()),c.getContent().before(g),b.prepend(g),k=b.find(".loading-spinner-spp-blocker"),k.show(),m=b.find(".loading-spinner-spp-inner"),n())},hideSpinner:function(a,b){k&&g.detach();b&&a.hide()},adjustSize:n}});"use strict";q.when("A","error-feature-detection").register("loading-spinner-aui-controller",function(a,l){function n(){return e("#checkoutDisplayPage").outerHeight()}var e=a.$;return{showSpinner:function(){l.markFeatureUnavailable("continue-action");
var k=e("#checkout-spinner");a.show(e("#checkout-spinner-overwrap").height(n()));k.attr("aria-busy","true");a.show(k)},hideSpinner:function(){l.markFeatureAvailable("continue-action");var k=e("#checkout-spinner");a.hide(e("#checkout-spinner-overwrap"));k.attr("aria-busy","false");a.hide(k)},adjustSize:function(){var k=e("#checkout-spinner-overwrap");k.is(":visible")&&a.show(k.height(n()))}}});"use strict";q.when("A","page-transition-controller","ajax-utility","page-detector-current-page","checkout-general-utils",
"client-side-metrics","safe-mash","cache-page-data-controller","ajax-wrapper","widget-streamer","widget-streamer-utils","weblab-helper","payment-marketplace-helper","pipeline-dispatch-endpoint").register("page-conductor",function(a,l,n,e,k,m,g,b,d,f,c,h,y,v){function w(a){r.ueLogError&&r.ueLogError({message:a},{logLevel:"WARN",attribution:"CheckoutCommonAsset-PageConductor"})}function x(a){la&&(a?(a["x-amz-checkout-transition"]||(a["x-amz-checkout-transition"]="ajax"),a["x-amz-checkout-type"]||(a["x-amz-checkout-type"]=
"spp")):a={"x-amz-checkout-transition":"ajax","x-amz-checkout-type":"spp"});h.isPipelineDispatchSendHeaderEnabled()&&(a?a["x-amz-checkout-transition"]||(a["x-amz-checkout-transition"]="ajax"):a={"x-amz-checkout-transition":"ajax"});return a}function p(){ia=!1;da=null;O=0;ta=!1;ja=wa=xa=null}function u(a){var b=parseInt(L("#checkoutDisplayPage").data("delaySetTitle"),10)||0;b?r.setTimeout(function(){document.title=a},b):document.title=a}function B(b){"function"===typeof a.state.parse&&a.state.parse();
a.trigger("checkout:beforeReload");a.trigger("checkout:reload");b&&("spp-revieworder"===b?a.trigger("checkout:reload:spc"):a.trigger("checkout:reload:"+b));a.trigger("checkout:afterReload")}function A(a){l.show();var b="/gp/buy/addtocart/handlers/display.html";a&&(b+="?errorType\x3d"+a);r.location=b}function t(b){(b=L("#pageTypeRedirectedTo").text())&&a.trigger("checkout:reload:"+b)}function N(b,c){if(c.getResponseHeader("x-amz-force-full-page-update"))J(b);else{if(c.getResponseHeader("x-amz-checkout-redirect-addtocart")){(c=
n.jsonify(b))?A(c.errorCode):A();return}var d=Ea(b)}b=L("#pipelinedPageTitle").text();u(b);var e=c.getResponseHeader("x-amz-checkout-page");la?a.delay(function(){B(e)},d):B(e)}function J(a){var b=document.open("text/html","replace");b.write(a);b.close()}function Q(a,b,c){try{if(b.getResponseHeader("x-amz-force-full-page-update"))J(a);else{if(!za)throw Error("Member _updateDisplayPageContent not set in page-conductor. Make sure 'initFunc' is called.");za(a,c)}}catch(ma){a="Error while replacing page content.",
ma.message&&(a+="  Error message: "+ma.message),q.error(a,"page-conductor","replaceDisplayPage",ma)}a=L("#pipelinedPageTitle").text();u(a);b=b.getResponseHeader("x-amz-checkout-page");B(b)}function P(a){var b=parseInt(L("#showPageTransition").attr("content"),10);(b=isNaN(b)?1:b)||l.hide();b="/gp/buy/shared/handlers/dispatch.html";a&&(a.conductoraction&&a.conductoraction.url?b=a.conductoraction.url:a.pipedata&&a.pipedata.conductoraction&&a.pipedata.conductoraction.url&&(b=a.pipedata.conductoraction.url));
b=0<b.indexOf("?")?b+"\x26":b+"?";L("input[name\x3dfromAnywhere][value\x3d1]").length&&(b+="fromAnywhere\x3d1");b=ea(b);g&&L("html").hasClass("a-tablet")&&-1<b.indexOf("/gp/cart/view.html")&&(b="/gp/aw/c?app-action\x3dcart");r.location=b}function F(a,c,d,e,h){e=e||{};e.pushNewFrame=e.pushNewFrame||"true";e.anchor=e.anchor||G;p();"true"===e.pushNewFrame&&g&&g.navigate&&L("#checkoutDisplayPage").data("useMashNavigateForTransitions")?g.navigate({url:null,transitionEffect:"slide",successCallback:function(){U(a,
c,d,e,h)},failCallback:function(a){}}):U(a,c,d,e,h);e.keepCachedPagesData||b.clearCache()}function M(){var a=L("input#isPipelinedPage");return k.isChewbaccaUrl()||0<a.length&&"1"===a.val()}function R(a){return h.isExecutionIdInQueryStringEnabled()?a?a.getResponseHeader("x-amz-checkout-executionid"):k.getQueryStringParameter(r.location.href,"executionId"):L("input#executionId").val()}function U(b,d,f,p,g){function l(a){var b=f.getResponseHeader(a);null==b&&(m.increaseCount("Checkout:PageConductor:Ajax:Update:MissingHeader"),
m.increaseCount("Checkout:PageConductor:Ajax:Update:MissingHeader:"+a),w("performUpdatePageFromResponse is missing required header "+a));return b}function u(a){var b=/^\s*<(?:!doctype|html)/;if("string"===typeof a&&a.match(b)){b=(new DOMParser).parseFromString(a,"text/html");var c=L(b).find("#checkoutDisplayPage");if(0<c.length)return m.increaseCount("Checkout:PageConductor:Ajax:Update:CenterContentExtracted"),c[0].outerHTML;b=L(b).find("body");if(0<b.length)return m.increaseCount("Checkout:PageConductor:Ajax:Update:BodyExtracted"),
b[0].outerHTML}return a}p=p||{};p.pushNewFrame=p.pushNewFrame||"true";p.anchor=p.anchor||G;p.mixedContentFallback=p.mixedContentFallback||"fallback";var y=l("x-amz-checkout-page"),J=l("x-amz-checkout-requestid"),ta=e.getCurrentPage();e.setCurrentPage(y);if(p.freshLoad)p.freshLoad=!1,q.when("first-load-dependencies").execute(function(a){U(b,d,f,p)});else if(y){L("head .aui-page-asset").removeAttr("disabled");L("head .old-pipeline-asset").removeAttr("disabled");m.setAsyncRequestId(J);var ka=f.getResponseHeader("x-amz-checkout-redirect");
if(ka)P({conductoraction:{url:ka,type:"redirect"}});else{if(h.isPageConductorConvergenceEnabled()){if(k.isChewbaccaUrl(document.location.pathname)&&"reload"==p.mixedContentFallback){m.increaseCount("Checkout:PageConductor:mixedContentFallback:"+p.mixedContentFallback);location.reload();return}}else ha(b)&&ra(p);h.isIngressEnabled()&&(b=u(b));if(h.isAJAXWeblabOn()&&c.isStreamingAjax(f))h.isAjaxStreamingEnabled()?B(y):(t(f),V(b,y));else if(a.trigger("checkout:unload"),0<L("#checkoutDisplayPage").length?
Q(b,f,y!==ta):N(b,f),h.isAjaxStreamingEnabled()&&M()){ta=L("#pipelinedPageTitle").text();ka=l("x-amz-checkout-url");var A=f.getResponseHeader("x-amz-checkout-additional-page-args");T(y,ta,ka,R(f),A,p.anchor,p.pushNewFrame)}!h.isAjaxStreamingEnabled()&&M()&&(ta=L("#pipelinedPageTitle").text(),ka=l("x-amz-checkout-url"),A=f.getResponseHeader("x-amz-checkout-additional-page-args"),T(y,ta,ka,R(f),A,p.anchor,p.pushNewFrame));la||I(y);p.anchor&&(y=L(p.anchor),0===y.length&&(y=p.anchor.replace("#",""),y=
L(document.getElementsByName(y))),y.length&&L(document).scrollTop(y.offset().top));p.logUsedPrefetch&&q.when("action-logger").execute(function(a){a.logUsedPrefetch(l("x-amz-checkout-page-type"),l("x-amz-checkout-sub-page-type"),J,g)})}}else{if(r.getOldAjaxSuccessCallback)return r.getOldAjaxSuccessCallback("ajaxConductor","generalErrorHandling","generalErrorHandling")(b,d,f);b=n.jsonify(b);P(b)}}function T(a,b,c,d,e,p,f){b&&c&&r.history&&r.history.pushState&&(h.isExecutionIdInQueryStringEnabled()?
"true"!==f||history.state&&history.state.page===a||(c=ea(c),p&&(c+=p),d&&(c=k.addQueryStringParameterOrDeleteIfEmpty(c,"executionId",d)),history.pushState({page:a,additionalURLArgs:e},b,c)):(c=ea(c),p&&(c+=p),d&&(c=k.addQueryStringParameter(c,"executionId",d)),"true"===f&&history.state&&history.state.page!==a&&history.pushState({page:a,additionalURLArgs:e},b,c)))}function I(a){var b=L("#checkoutDisplayPage");if(b.length){var c=0<=document.location.search.indexOf("pipelineType\x3dChewbacca")?"multi-page-pipeline-chewbacca":
la?"single-page":"multi-page";b.attr({"data-checkout-pipeline":c,"data-checkout-page":a||""})}}function V(a,b){a.executeActions();a=L("#pipelinedPageTitle").text();u(a);B(b)}function S(){r.location=Wa?"/gp/buy/addtocart/handlers/display.html":"/gp/buy/payselect/handlers/error.html"}function W(b,e,p,f,m,g){f=f||{};f.refTag=f.refTag||"";f.pushNewFrame=f.pushNewFrame||"true";f.anchor=f.anchor||G;f.refTag&&0!==f.refTag.indexOf("/ref\x3d")&&(f.refTag="/ref\x3d"+f.refTag);var n="";h.isPageConductorConvergenceEnabled()&&
m&&k.isChewbaccaUrl(m)||(n="fromPage\x3d"+b+"\x26page\x3d"+e);(b=R(g))&&(n+="\x26executionId\x3d"+b);p&&(n+="\x26"+p);e=v.get(m||"/gp/buy/shared/handlers/pipeline-dispatch.html",{nextPage:e});h.isPageConductorConvergenceEnabled()&&k.isChewbaccaUrl(e)||(e+=f.refTag);p=function(){};m=function(){};"function"===typeof f.resultscallback?(b=function(a,b,c){f.resultscallback(a,b,c)},g=function(a,b,c){f.resultscallback(G,b,a)}):(p=function(b){a.trigger("checkout:beforeLoadPage");sa&&sa.abort();sa=b},b=function(a,
b,d){h.isAJAXWeblabOn()&&c.isStreamingAjax(d)||f.callbackBeforePageUpdate&&f.callbackBeforePageUpdate();F(a,b,d,f);f.callbackAfterPageUpdate&&f.callbackAfterPageUpdate()},g=function(a,b,c){"abort"!==b&&("error"===b&&a.readyState===d.READY_STATE.UNSET?q.when("a-tv","mash").execute(function(a,b){r.cordova.exec(null,null,"MASHDisplayErrorPlugin","execute",{})}):(Z(a,b),S()))},m=function(a){sa=null});n={type:"GET",url:e,data:n,dataType:"text",async:!0,beforeSend:p,success:b,error:g,complete:m,cache:!1};
if(la||h.isPipelineDispatchSendHeaderEnabled())n.headers=x({"x-amz-checkout-transition":"ajax"});C(n);return h.isAJAXWeblabOn()?(n.useXMLHttp=!0,n=h.isAjaxStreamingEnabled()?ba(n,f.callbackBeforePageUpdate,f.anchor,f.pushNewFrame):ba(n,f.callbackBeforePageUpdate),d.aui(n)):L.ajax(n)}function ba(b,d,p,m){b.timeout=5E4;b.data=ca(b.data,"acceptsStreaming\x3d1");var k=b.data.match(/.*isAsync=1.*/)?!0:!1;ya=f({$target:L("#checkoutDisplayPage"),updateTriggerEvent:"pageReady",immediateExecution:!k,updateTarget:L("#checkoutDisplayPage"),
onUpdate:function(b){"function"===typeof d&&d();a.trigger("checkout:unload");u(b.title);T(b.page,b.title,b.url,b.executionId,b.additionalURLArgs,p,m||"true");e.setCurrentPage(b.page)}});b.chunk=ya.chunkHandler;if(!h.isAjaxStreamingEnabled()){var g=b.success;b.success=function(a,b,d){g&&c.isStreamingAjax(d)?g(ya,b,d):g&&g(a,b,d)}}return b}function ca(a,b){return a?a+"\x26"+b:b}function C(a){if(a.data.match(/.*isAsync=1.*/))return a.headers?a.headers["x-amzn-tiertwo"]="yes":a.headers={"x-amzn-tiertwo":"yes"},
m.increaseCount("Checkout:PageConductor:Prefetch:Tagging:T"),!0;m.increaseCount("Checkout:PageConductor:Prefetch:Tagging:C");return!1}function Z(a,b){m.increaseCount("Checkout:PageConductor:Ajax:Error");h.isAJAXWeblabOn()?(a?(m.increaseCount("Checkout:AUI:Ajax:jqXHR:defined"),w("jqXHR defined throw CheckoutErrorAW under AJAX Weblab, textStatus:"+b+" stateCode:"+a.state+" readyState:"+a.readyState)):a===G?(m.increaseCount("Checkout:AUI:Ajax:jqXHR:undefined"),w("jqXHR undefined throw CheckoutErrorAW under AJAX Weblab")):
null===a&&(m.increaseCount("Checkout:AUI:Ajax:jqXHR:null"),w("jqXHR null throw CheckoutErrorAW under AJAX Weblab")),m.increaseCount("Checkout:AUI:Ajax:Error:textStatus:"+b),m.increaseCount("Checkout:AUI:Ajax:Error:statusCode:"+a.status),m.increaseCount("Checkout:AUI:Ajax:Error:readyState:"+a.readyState)):(a?(m.increaseCount("Checkout:jQuery:Ajax:jqXHR:defined"),w("jqXHR defined throw CheckoutErrorAW using jQuery, textStatus:"+b+" stateCode:"+a.state+" readyState:"+a.readyState)):a===G?(m.increaseCount("Checkout:jQuery:Ajax:jqXHR:undefined"),
w("jqXHR undefined throw CheckoutErrorAW using jQuery")):null===a&&(m.increaseCount("Checkout:jQuery:Ajax:jqXHR:null"),w("jqXHR null throw CheckoutErrorAW using jQuery")),m.increaseCount("Checkout:jQuery:Ajax:Error:textStatus:"+b),m.increaseCount("Checkout:jQuery:Ajax:Error:statusCode:"+a.status),m.increaseCount("Checkout:jQuery:Ajax:Error:readyState:"+a.readyState))}function X(a,b,c,e){var f=a;b=ca(b,"isClientTimeBased\x3d1");if(h.refactorExtractURL()){var p=k.extractURLParts(a);a=p.normalizedUrl;
if(!a)return m.increaseCount("Checkout:PageConductor:submitAjax:url:missingHtml:T1"),w("Unable to normalize url ["+f+"]. Ajax request aborted."),!1;var g=a.indexOf("/gp/buy/");0<g?(a=a.substring(g),m.increaseCount("Checkout:PageConductor:submitAjax:url:removedGpBuy:T1")):m.increaseCount("Checkout:PageConductor:submitAjax:url:missingGpBuy:T1");p.query?(b+="\x26"+p.query,m.increaseCount("Checkout:PageConductor:submitAjax:url:hasQueryPart:T1")):m.increaseCount("Checkout:PageConductor:submitAjax:url:missingQueryPart:T1");
p=p.refMarker;p||(m.increaseCount("Checkout:PageConductor:submitAjax:url:missingRefMarker:T1"),p="");p&&-1===p.indexOf("ref\x3d")&&(m.increaseCount("Checkout:PageConductor:submitAjax:url:refMarkerMalformed:T1"),p="")}else{var n=a.indexOf("?");0<n?(g=a,b+="\x26"+a.substring(n+1),a=a.substring(0,n),n=k.buildFilteredQueryString(g,Ja),""===n?m.increaseCount("Checkout:PageConductor:submitAjax:url:hasNoAllowlistedQueryParameter"):m.increaseCount("Checkout:PageConductor:submitAjax:url:hasAllowlistedQueryParameter"),
a+=n,m.increaseCount("Checkout:PageConductor:submitAjax:url:hasQueryPart:C")):m.increaseCount("Checkout:PageConductor:submitAjax:url:missingQueryPart:C");g=a.indexOf("/gp/buy/");0<g?(a=a.substring(g),m.increaseCount("Checkout:PageConductor:submitAjax:url:removedGpBuy:C")):m.increaseCount("Checkout:PageConductor:submitAjax:url:missingGpBuy:C");if(n=k.isChewbaccaUrl(a))a=a.slice(a.indexOf("/checkout/p/p-")),m.increaseCount("Checkout:PageConductor:submitAjax:url:chewbacca:C");else{if(-1===a.indexOf(".html"))return m.increaseCount("Checkout:PageConductor:submitAjax:url:missingHtml:C"),
w("url ["+f+"] is missing html extension and not a chewbacca call. Ajax request aborted."),!1;f=a.indexOf(".html");p=a.substring(f+5);a=a.substring(0,f+5)}p||m.increaseCount("Checkout:PageConductor:submitAjax:url:missingRefMarker:C");p&&-1===p.indexOf("ref\x3d")&&(m.increaseCount("Checkout:PageConductor:submitAjax:url:refMarkerMalformed:C"),p="")}b+="\x26handler\x3d"+a;f="";f=v.get(n?a:"/gp/buy/shared/handlers/async-continue.html"+p);a={type:"POST",url:f,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
headers:x({"x-amz-checkout-transition":"ajax"}),data:b,dataType:"text",async:!0,success:c,error:function(a,b,c){"abort"!==b&&("error"===b&&a.readyState===d.READY_STATE.UNSET?q.when("a-tv","mash").execute(function(a,b){r.cordova.exec(null,null,"MASHDisplayErrorPlugin","execute",{})}):"function"===typeof e&&(Z(a,b),e()))},cache:!1};C(a);return h.isAJAXWeblabOn()?(a.useXMLHttp=!0,ba(a),d.aui(a)):L.ajax(a)}function z(a,b,c,d,e){e=e&&e.action?e.action:a.attr("action");a=a.serialize();d&&(a+="\x26isAsync\x3d1");
return X(e,a,b,c)}function Y(a,b,c,d){a=ea(a.attr("href"));d&&(a+="\x26isAsync\x3d1");return X(a,"",b,c)}function aa(a){a=a||{};a.logUsedPrefetch=1;F(da.data,da.status,da.response,a,da.refMarker)}function ea(a){-1===a.toLowerCase().indexOf("hasworkingjavascript")&&(a+=(0<=a.indexOf("?")?"\x26":"?")+"hasWorkingJavascript\x3d1");return a}function ka(a){ta=!1;var b=e.getCurrentPage(),c=ja-wa,d=O,f=a.data("pushNewFrame"),p=function(a,b,c){"boolean"===typeof f&&!1===f?F(a,b,c,{pushNewFrame:"false"}):F(a,
b,c)};ua&&clearTimeout(ua);if(a.is("form"))D(a)?(aa(),m.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+d+":Success"),m.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+d+":TimeSaved",c)):(h.isPageConductorConvergenceEnabled()?z(a,p,S):z(a,F,S),m.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+d+":Failure:Invalid"));else if(a.is("a"))if(na(a)){var g;1===parseInt(a.data("keepCachedPagesData"),10)&&(g={keepCachedPagesData:1});aa(g);m.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+
d+":Success");m.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+d+":TimeSaved",c)}else h.isPageConductorConvergenceEnabled()?Y(a,p,S):Y(a,F,S),m.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+d+":Failure:Invalid");else m.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+d+":Failure:NoTrigger"),q.error("function called without a trigger","page-conductor","handleContinueAction")}function D(a){return a.is("form")&&null!==da&&da.serializedValue===a.serialize()}function na(a){return a.is("a")&&
null!==da&&ea(da.serializedValue)===ea(a.attr("href"))}function ra(a){"reload"==a.mixedContentFallback?(m.increaseCount("Checkout:PageConductor:mixedContentFallback:"+a.mixedContentFallback),location.reload()):"fallback"==a.mixedContentFallback?(m.increaseCount("Checkout:PageConductor:mixedContentFallback:"+a.mixedContentFallback),P({conductoraction:{url:"/gp/buy/spc/handlers/display.html?_from\x3dcheetah",type:"redirect"}})):(m.increaseCount("Checkout:PageConductor:mixedContentFallback:Invalid"),
q.log("mixedContentFallback is invalid. mixedContentFallback should be reload or fallback","ERROR","mixedContentFallback"))}function H(a){return Ba&&(a.is("form")&&Ba!==a.serialize()||a.is("a")&&ea(Ba)!==ea(a.attr("href")))}function pa(a,b,d,f,p){function g(e,g,k){var y=!0;if("success"===g){if(!h.isAJAXWeblabOn()||!c.isStreamingAjax(k)){var J=n.jsonify(e);null!==J&&J&&J.result&&"noPrefetch"===J.result&&(da=null,y=!1)}y&&(da={},da.serializedValue=B,da.data=e,da.status=g,da.response=k,da.refMarker=
u,null==ja&&(ja=(new Date).getTime()))}else da=null,m.increaseCount("Checkout:"+l+":PageConductor:Prefetch:"+O+":Failure:Response");ia=!1;la&&q.when("spp-button-blocker").execute(function(a){a.hideDefaultContinueBtnBlocker()});if(ta)return ka(xa),!0;if(y){var A=function(){f?pa(a,b,d,!0,p):oa(a)};if(null===da||"form"===t&&da.serializedValue!==a.serialize())return A(),!0;b&&(0===b?m.increaseCount("checkoutPrefetchTimeoutSetToZero",1):ua=setTimeout(function(){da=null;A()},1E3*b))}return!0}if(!M()||0===
a.length)return!1;var t=a.get(0).tagName.toLowerCase();if("form"!==t&&"a"!==t||"function"===typeof p&&!p(t))return!1;b=b||0;d=d||0;f=f||!1;if(ia||O>=d)return!1;ia=!0;q.when("link-prefetch").execute(function(a){a.isClearCacheEnabled()&&a.clearCache()});la&&q.when("spp-button-blocker").execute(function(a){a.showDefaultContinueBtnBlocker()});O++;var l=e.getCurrentPage();wa=(new Date).getTime();ja=null;m.increaseCount("Checkout:"+l+":PageConductor:Prefetch:"+O+":Attempted");ua&&clearTimeout(ua);var u=
k.extractURLParts("form"===t?a.attr("action"):a.attr("href")).refMarker,B=null;if("form"===t){B=a.serialize();var y=h.isAJAXWeblabOn()?z(a,g,g,!0):z(a,null,null,!0)}else"a"===t&&(B=ea(a.attr("href")),y=h.isAJAXWeblabOn()?Y(a,g,g,!0):Y(a,null,null,!0));h.isAjaxStreamingEnabled()&&B&&(Ba=B);"object"!==typeof y||"function"!==typeof y.always||h.isAJAXWeblabOn()||y.always(g)}function oa(a){var b=parseInt(a.data("prefetchTimeout"),10),c=parseInt(a.data("maxPrefetches"),10);return pa(a,b,c,!1,function(b){if(a.find("input:checked").hasClass("no-prefetch"))return!1;
if(h.disablePrefetchForScheduledDeliveryWeblabOn()){var c=a.find("div.one-shipment:not(:hidden)").find("input:checked");if(c.parents('[data-a-input-name\x3d"'+c.attr("name")+'"]').hasClass("no-prefetch"))return!1}return"1"===L("input#block-prefetch").val()||"1"===L("input#block-all-prefetch").val()||"form"===b&&!a.data("checkoutFormReady")?!1:!0})}function ha(a,b){return/.*\/checkout\/p\/.*\/spc/.test(b||r.window.location.pathname)&&/data-checkout-page/.test(a)}function qa(b,c){ia&&null==ja&&(ja=
(new Date).getTime());b&&b.preventDefault();var d=b?L(b.currentTarget):c;b=function(){if(la){l.blockAllActions();var a=d.data("shrink-panel"),b=d.data("loading-text");(a=L("#"+a))&&a.length?a.hasClass("expanded")||l.shrinkPanel(L(".spp-panel.expanded"),!1):a=L(".spp-panel.expanded");l.shrinkPanel(a,!0,b)}else l.show()};m.resetMetrics();!Ca||D(d)||na(d)?b():a.delay(b,0);try{ta=!0,xa=d,h.isAjaxStreamingEnabled()&&ya&&!H(d)&&ya.enableExecution(),ia||ka(d)}catch(ma){b="An error occured while click on the continue button.",
ma.message&&(b+="  Error message: "+ma.message),q.error(b,"page-conductor","continueClicked",ma)}}function fa(){L("#checkout-btf-spinner").addClass("aok-hidden")}var L=a.$,ia,wa,ja,sa,da,O,ta,xa,ua,Fa,za,Ba,Ea=function(a){if(!Fa)throw Error("Member _updatePageContent not set in page-conductor. Make sure 'initFunc' is called.");return Fa(a)},la=!1,Wa=!1,Ga=!1,Ca=!1,Da=!1,ya,Ja=["sif_profile"];p();a.declarative("page-transit-no-update-action","click",function(c){if(!Ga){c.$event.preventDefault();m.resetMetrics();
var d=c.data.targetDeclarativeActionId;if(d&&(d=L("#"+d),d.length)){d.trigger("click");return}var f=c.data.toPage;d=c.data.fromPage||e.getCurrentPage();var g=c.data.refTag||"chk_"+d+"_cancel_pri",k=c.data.args,n=c.$currentTarget.find("a.checkout-pipeline-pref-link"),t=la&&"function"===typeof y.isIN&&y.isIN();la&&(!t||"spp-payment"!==d&&"spp-rxselect"!==d?b.setCachedPageData(d,f):("spp-payment"==d&&m.increaseCount("checkout:trueSPC:disableCachingPSP:"+f,1),"spp-rxselect"==d&&m.increaseCount("checkout:trueSPC:disableCachingRxSelect:"+
f,1)));if(b.getCachedPageData(f,d)){m.increaseCount("checkout:"+d+":cancelpri",1);g=b.getCachedPageData(f,d);p();e.setCurrentPage(g.page);var u=h.isAJAXWeblabOn()?Ea(g.curPageData):Ea(JSON.stringify(g.curPageData));if(la)if(m.isTransitionLoggingEnabled()){var J=(new Date).getTime();m.logPageTransition(d+"-cached",f,G,function(b){b=(new Date).getTime()-J;b<u?a.delay(function(){B(f)},u-b):B(f)})}else a.delay(function(){B(f)},u);else B(f);g.title&&g.url&&r.history&&r.history.pushState&&history.state&&
history.state.page!==g.page&&history.pushState(g.state,g.title,g.url)}else n.length?qa(null,n):(m.increaseCount("checkoutSPPCancelNoCachedData",1),t&&"spp-payment"===f&&m.increaseCount("checkout:trueSPC:emptyPSPCacheFrom:"+d,1),n=function(){if(la)if(l.blockAllActions(),c.data.noShrink)l.show();else{var a=c.data.loadingText,b=L("#"+c.data.shrinkPanel);b.length||(b=c.$currentTarget.closest("div.spp-panel"));l.shrinkPanel(b,!0,a)}else l.show()},Ca?a.delay(n,0):n(),W(d,f,k,{refTag:g,keepCachedPagesData:1}))}});
h.isAjaxStreamingEnabled()&&(a.on("checkout:page:atf",function(){l.hide();L("#checkout-btf-spinner").removeClass("aok-hidden")}),a.on("checkout:page:end",function(){fa()}));a.on("ready",function(){Ca=0<L("#executeNonBlockingAnimations").length;Da=0<L("#prefetchFromAddressEnabled").length});a.on("checkout:afterReload",function(){l.hide();h.isAjaxStreamingEnabled()&&fa();a.delay(m.sendUEPageLoadStats);if(M()){var c=L("form.checkout-page-form:not(:disabled):first"),d=L("a.checkout-continue-link:not(:disabled):first");
L("#useFirstActivePrefetch").length&&(d=L("a.checkout-continue-link:not(:disabled)").filter(function(){return 0<(parseInt(L(this).data("maxPrefetches"),10)||0)}).first());var e=!1;c.length&&(e=oa(c));!e&&d.length&&(e=oa(d));!e&&la&&(c=L("a.checkout-pipeline-pref-link:not(:disabled):first"),c.length&&(d=c.data("fromPage"),e=c.data("toPage"),b.getCachedPageData(e,d)||(e=oa(c))))}});return{ajaxUpdatePage:F,ajaxRedirect:P,ajaxSorryPage:S,isPageLoadRequestInProgress:function(){return sa?1:0},submitFormAjax:z,
reloadPage:function(){var a=e.getCurrentPage();W(a,a)},loadPage:W,usePrefetch:aa,makePrefetch:oa,makePrefetchWithParams:pa,isPrefetchValidFor:function(a,b){if(null!==da){var c=da.response.getResponseHeader("x-amz-checkout-page");if(h.isPageConductorConvergenceEnabled()&&b){var d=da.response.getResponseHeader("x-amz-checkout-url");d=k.getUrlType(d);b=k.getUrlType(b);return a===c&&d===b}return a===c}return!1},redirect:P,continueClicked:qa,initFunc:function(a,b){Fa=a;za=b},overrideIsSPP:function(a){la=
a},isSPP:function(){return la},overrideAddToCart:function(a){Wa=a},isAnimating:function(){return Ga},overrideIsAnimating:function(a){Ga=a},setAjaxTransitionHeader:x,isPipeliningOn:M,disablePageNoUpdateTransition:function(){Da&&q.when("a-button").execute(function(a){var b=L(".spp-panel.expanded").data("stepIndex");L(".expand-collapsed-panel-trigger").each(function(){var c=L(this),d=c.parents(".spp-panel").data("stepIndex");if(!b||!d||d>b)c.filter(".clickable-heading").removeClass("clickable-heading").addClass("off-clickable-heading"),
a(c.filter(".expand-panel-button")).disable(),c.filter("a.expand-panel-button").addClass("disabled-link"),c.parents(".a-declarative").addClass("off-declarative").removeClass("a-declarative")});L(".panel-cancel-row").hide()})},enablePageNoUpdateTransition:function(){Da&&q.when("a-button").execute(function(a){L(".off-clickable-heading").addClass("clickable-heading").removeClass("off-clickable-heading");a(".expand-collapsed-panel-trigger.expand-panel-button").enable();L(".off-declarative").addClass("a-declarative").removeClass("off-declarative")})},
isNonBlockingAnimationEnabled:function(){return Ca},isPrefetchFromAddressEnabled:function(){return Da},getExecutionId:R,isPrefetchRequestInProgress:function(){return ia},isRequestMixedContent:ha,ajaxUpdate:function(b,c,d){d=d||{};"undefined"===typeof d.pushNewFrame&&(d.pushNewFrame=!1);"boolean"===typeof d.pushNewFrame&&(d.pushNewFrame=d.pushNewFrame.toString());var e="";c&&"object"===typeof c?e=a.map(c,function(a,b){return b+"\x3d"+a}).join("\x26"):"string"===typeof c&&(e=c);ua&&clearTimeout(ua);
m.resetMetrics();l.show();return X(b,e,function(a,b,c){F(a,b,c,d)},S)}}});q.when("A","jQuery","page-transition-controller","ajax-utility","page-detector-current-page","checkout-general-utils","page-conductor","cache-page-data-controller","client-side-metrics","weblab-helper","ready").execute(function(a,l,n,e,k,m,g,b,d,f){if(g.isPipeliningOn()){r.history&&l(r).bind("popstate",function(){var a=this.history.state,b=k.getCurrentPage();if(a&&a.page&&b&&(a.page!==b||g.isPageLoadRequestInProgress())){n.show();
b=l("#checkoutDisplayPage");b.data("wipeOnPipelineBackTransition")&&b.empty();d.resetMetrics();b=l("#useFastBackButton").length;if(f.isPageConductorConvergenceEnabled()){if(b&&g.isPrefetchValidFor(a.page,document.location.pathname)){g.usePrefetch({pushNewFrame:!1});return}}else if(b&&g.isPrefetchValidFor(a.page)){g.usePrefetch({pushNewFrame:!1});return}b="spc"===a.page?"":a.page;if(f.isPageConductorConvergenceEnabled()){var c="";if(m.isChewbaccaUrl(document.location.pathname)){var e=document.location.href.indexOf("/checkout/p/p-");
0<=e&&(c=document.location.href.substring(e))}g.loadPage(k.getCurrentPage(),b,a.additionalURLArgs,{refTag:"pipelinedBackButton",pushNewFrame:"false"},c)}else g.loadPage(k.getCurrentPage(),b,a.additionalURLArgs,{refTag:"pipelinedBackButton",pushNewFrame:"false"})}});l(document).delegate("form.checkout-page-form","change",function(a){l(a.target).parent().hasClass("no-prefetch-on-change")||(a=l(a.currentTarget),g.makePrefetch(a))});l(document).delegate("form.checkout-page-form","submit",function(a){g.continueClicked(a)});
l(document).delegate("a.checkout-continue-link","click",function(a){g.continueClicked(a)});a.declarative("checkout-page-form-submit","change",function(a){a=a.$target.closest("form.checkout-page-form");var b=a.attr("data-push-new-frame");"undefined"!==typeof b&&""!==b||a.attr("data-push-new-frame","false");a.submit()});l(document).delegate("form.checkout-page-form .submit-button-with-name","click",function(a){a=l(a.currentTarget);l("\x3cinput\x3e").attr({type:"hidden",name:a.attr("name"),value:a.val()}).appendTo(a.closest("form.checkout-page-form"))});
var c=!1;l(document).delegate("a.pipeline-link, div.pipeline-link, span.pipeline-link a","touchmove",function(a){c=!0});l(document).delegate("a.pipeline-link, div.pipeline-link, span.pipeline-link a","click keypress touchend",function(a){if(c)c=!1,a.preventDefault();else if(m.protectAgainstDoubleAction("pipeline-link"))a.preventDefault();else if("keypress"!==a.type||13===a.which){var e=l(a.currentTarget),h=e.data("pipelineLinkFromPage"),k=e.data("pipelineLinkToPage"),x=e.data("pipelineLinkAnchor"),
p=e.data("pipelineLinkRef");p||((p=m.extractURLParts(e.attr("href")).refMarker)?d.increaseCount("Checkout:PageConductor:LoadPage:AddedRefMarker"):d.increaseCount("Checkout:PageConductor:LoadPage:NoRefMarkerInUrl"));var u=e.data("pipelineLinkArgs");k&&(d.resetMetrics(),a.preventDefault(),g.isSPP()&&b.setCachedPageData(h,k),n.show(),a={refTag:p,anchor:x},g.isSPP()&&(a.keepCachedPagesData=1),x="",e=e.attr("href"),f.isPageConductorConvergenceEnabled()&&e&&m.isChewbaccaUrl(e)&&(x=e.substring(e.indexOf("/checkout/p/p-")),
u=""),g.loadPage(h,k,u,a,x))}});l(document).delegate("a.spclite-dispatch-link","click keypress touchend",function(a){if("keypress"!==a.type||13===a.which){var b=l(a.currentTarget),c=b.data("spcliteLinkFromPage"),d=b.data("spcliteLinkToPage");b.data("spcliteLinkAnchor");var e=b.data("spcliteLinkRef");b=b.data("spcliteLinkArgs");var f=l("input#executionId").val();b=b?b+("\x26executionId\x3d"+f):"executionId\x3d"+f;d&&(a.preventDefault(),n.show(),g.loadPage(c,d,b,{refTag:e},"/gp/buy/shared/handlers/spclite-dispatch.html"))}})}l(document).delegate("input.submit",
"click touchend",function(){d.resetMetrics()});l(document).delegate("form","submit",function(){d.resetMetrics()});l(document).delegate(".panel-cancel-row a, .clickable-heading","click",function(){d.isTransitionLoggingEnabled()&&d.resetMetrics()});f.isExecutionIdInQueryStringEnabled()&&(l.ajaxSetup({beforeSend:function(a,b){b.url&&(a=m.getQueryStringParameter(r.location.href,"executionId"),b.url=m.addQueryStringParameterOrDeleteIfEmpty(decodeURIComponent(b.url),"executionId",a));return!0}}),l(document).ajaxSuccess(function(a,
b,c){if(c&&c.url&&c.url.match(/\/async-continue|\/set-|\/update-|\/new/i)&&(a=b.getResponseHeader("x-amz-checkout-sub-page-type")||"Unknown",!a.match(/^p-/))){c=g.getExecutionId(b);if(r.history&&r.history.replaceState){var e=m.addQueryStringParameterOrDeleteIfEmpty(r.location.href,"executionId",c,!0);r.history.replaceState(r.history.state,"",e)}else d.increaseCount("Checkout:PageConductor:NoReplaceState");c||(b=b.getResponseHeader("x-amz-checkout-page-type")||"Unknown",d.increaseCount("Checkout:PageConductor:"+
(null===c?"ExecutionIdIsNotSet":"ExecutionIdIsEmpty")+":"+b+":"+a,1))}}))});"use strict";q.when("A","a-popover-base","a-popover-util").register("checkout-modal-popover",function(a,l,n){function e(b){return b.disableHide?function(){}:function(){var c=this;c.animating=!0;a.fadeOut(this.$popover,250);b.secondaryPopover||d("#a-popover-modal").hide();a.delay(function(){c.animating=!1},250)}}function k(a,b){var c=e(b);a=a.$event.triggerPositioningElement?a.$event.triggerPositioningElement:a.$declarativeParent;
(f=l.show({$trigger:a,name:b.name,skin:h(b.header,b.closeButton,b.closeTextOverride),content:b.content,url:b.url,data:b.data,update:v,alone:b.alone?"true"===b.alone:!0,position:b.position||"triggerVertical",hide:c}))&&f.$trigger!==a&&(f.$trigger=a,f.updatePosition())}function m(a,b){b.disableHide=!0;var f=e(b);c=!1;(b=l.show({$trigger:a.$declarativeParent,skin:y(b.header,b.footer,b.closeButton,b.contentClass),name:b.name,requestURL:b.url,position:"windowCenter",update:v,data:b.data,updatePosition:b.allowScrollOnPage?
w:x,modal:!0,alone:b.alone?"true"===b.alone:!0,show:function(){this.animating=!0;this.$popover.show();d("#a-popover-modal").show();this.animating=!1},hide:f}))&&b.$trigger!==a.$declarativeParent&&(b.$trigger=a.$declarativeParent,b.updatePosition())}function g(c){var d=c.$declarativeParent;a.delay(function(){b(c,d)},250)}function b(c,d){f&&(n.eventOccursWithin(c,d)||n.eventOccursWithin(c,f.$popover))?a.delay(function(){b(c,d)},250):l.hide(d)}var d=a.$,f,c=!1,h=function(a,b,c){return function(e){var f=
c;c===G&&(f=d("input#closeButtonText").val()||"");var p="";f&&(p='\x3ca href\x3d"#" data-action\x3d"custom-popover-close" class\x3d"a-declarative popover-close-link"\x3e'+f+"\x3c/a\x3e\x26nbsp;");f="false"===b?"":['\x3cdiv class\x3d"popover-close-section"\x3e',p,'\x3c/div\x3e\x3cbutton data-action\x3d"custom-popover-close" class\x3d"a-button-close a-declarative" role\x3d"button"\x3e\x3ci class\x3d"a-icon a-icon-close"\x3e\x3c/i\x3e\x3c/button\x3e'].join("");return['\x3cdiv class\x3d"a-popover"\x3e\x3cdiv class\x3d"a-popover-wrapper"\x3e',
a||f?['\x3cdiv class\x3d"a-popover-header"\x3e\x3ch4\x3e',a,"\x3c/h4\x3e",f,"\x3c/div\x3e"].join(""):"",'\x3cdiv class\x3d"a-popover-inner"\x3e',e,'\x3c/div\x3e\x3cdiv class\x3d"a-arrow-border"\x3e\x3cdiv class\x3d"a-arrow"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'].join("")}},y=function(a,b,c,e){return function(f){var p=d("input#closeButtonText").val()||"",g="";p&&(g='\x3ca href\x3d"#" data-action\x3d"custom-popover-close" class\x3d"a-declarative popover-close-link"\x3e'+p+"\x3c/a\x3e\x26nbsp;");
p="false"===c?"":['\x3cdiv class\x3d"popover-close-section"\x3e',g,'\x3c/div\x3e\x3cbutton data-action\x3d"custom-popover-close" class\x3d"a-button-close a-declarative" role\x3d"button"\x3e\x3ci class\x3d"a-icon a-icon-close"\x3e\x3c/i\x3e\x3c/button\x3e'].join("");p=a||p?['\x3cdiv class\x3d"a-popover-header huawei-device-header-fix"\x3e\x3ch4\x3e',a,"\x3c/h4\x3e",p,"\x3c/div\x3e"].join(""):"";g="";if(b){var h=d("#a-popover-footer-"+b);0<h.length&&(g=['\x3cdiv class\x3d"a-popover-footer"\x3e',h.html(),
"\x3c/div\x3e"].join(""))}return['\x3cdiv class\x3d"a-popover a-popover-modal"\x3e\x3cdiv class\x3d"a-popover-wrapper"\x3e',p,'\x3cdiv class\x3d"a-popover-inner ',e,'"\x3e',f,"\x3c/div\x3e",g,'\x3cdiv class\x3d"a-arrow-border"\x3e\x3cdiv class\x3d"a-arrow"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'].join("")}};a.declarative("custom-popover-close",["click","touchend"],function(b){b.$event.preventDefault();var c=b.$target;d("html").hasClass("a-ie6")||d("html").hasClass("a-ie7")||d("html").hasClass("a-ie8")?
c.closest(".a-popover").hide():a.fadeOut(c.closest(".a-popover"),250);d("#a-popover-modal").hide();a.trigger("a:declarative:a-popover-close:click",{$target:c,$event:b.$event,$currentTarget:b.$currentTarget})});a.on("a:popover:positionUpdated",function(a){a=a.popover.$popover;0>a.offset().left&&a.offset({left:0});0>a.offset().top&&a.offset({top:0})});a.on("a:popover:show",function(a){if(a.popover&&a.popover.$trigger){var b=a.popover.$trigger.data("aCheckoutModalPopover");b&&b.allowScrollOnPage&&a.popover.$popover.css("position",
"absolute")}});var v=function(a){d(".a-popover-inner",this.$popover).html(a)},w=function(a){if(!c||a)x.call(this,!0),c=!0},x=function(a){var b=d(r),c=b.height()/2,e=b.width()/2,f=this.$popover.height()/2,g=this.$popover.width()/2;c-=f;if(a||"fixed"!==this.$popover.css("position"))c+=b.scrollTop();a=Math.max(0,e-g);c=Math.max(0,c);this.$popover.css({top:c,left:a})};a.declarative("a-checkout-popover",["click","mouseenter","mouseleave","keyup","touchend"],function(a){a.data.showOnHover&&"touchend"!==
a.type?"mouseenter"===a.type||"click"===a.type?k(a,a.data):"mouseleave"===a.type&&g(a):("click"===a.type||"touchend"===a.type||"keyup"===a.type&&a.$event.manualTrigger)&&k(a,a.data)});a.declarative("a-checkout-modal-popover",["click","keyup","touchend"],function(a){("click"===a.type||"touchend"===a.type||"keyup"===a.type&&a.$event.manualTrigger)&&m(a,a.data)});a.on("checkout:reload",function(){a.defer(function(){0===d("#a-popover-modal").length&&d("body").append('\x3cdiv id\x3d"a-popover-modal" /\x3e')})});
return{hideById:function(a){l.hide(a)},createModal:m}});"use strict";(function(){var a=!1;q.when("A").register("page-detector",function(l){function n(){return e("checkout-as")}function e(a){d||(d={});d.hasOwnProperty(a)||(d[a]=0<b("div."+a).length);return d[a]}function k(){return e("checkout.pay")}function m(){return e("checkout.spc")||-1<r.location.href.search(/\/checkout\/p\/p[-\d]+\/spc.*/)?!0:!1}function g(){return l.capabilities.mobile}var b=l.$,d;l.on("checkout:reload",function(){d={};a||q.when("page-detector-current-initializer").execute(function(a){a.initializeDetectorWithCurrentPage(null)})});
return{isAddressSelect:n,isAddressTranslation:function(){return e("translate-address-form")},isDesktopPayment:function(){return k()&&e("pay-desktop")},isDesktopSpc:function(){return m()&&e("spc-desktop")},isMobileAddressSelect:function(){return n()&&e("checkout-as-mobile")},isMobilePayment:function(){return k()&&e("pay-mobile")},isMobileSpc:function(){return m()&&g()},isTabletAddressSelect:function(){return n()&&e("checkout-as-tablet")},isTabletPayment:function(){return k()&&e("pay-tablet")},isTabletSpc:function(){return m()&&
e("spc-tablet")},isSpcLite:function(){return m()&&e("spclite")},isPayment:k,isSosp:function(){return e("checkout.sosp")},isSpc:m,isMobile:g,isTablet:function(){return l.capabilities.tablet}}});q.register("page-detector-current-initializer",function(){return{initializeDetectorWithCurrentPage:function(l){if(!a){var n=l;q.register("page-detector-current-page",function(){return{getCurrentPage:function(){return n},setCurrentPage:function(a){var e=n;n=a;q.when("A").execute(function(k){k.trigger("page-detector:page-changed",
e,a)})}}});a=!0}}}})})();"use strict";q.when("jQuery","loading-spinner-controller").register("page-spinner-controller",function(a,l){function n(){"function"===typeof w.blockAllActions&&w.blockAllActions()}function e(){"function"===typeof w.unblockAllActions&&w.unblockAllActions()}function k(a){"function"===typeof w.showTransitionInContainer&&w.showTransitionInContainer(a)}function m(){var b=a(r).width(),c=a(r).height(),d=a(r),e=0;null!==v&&(e=v.outerHeight()-a(r).scrollTop(),0>e&&(e=0));h.css("top",
d.scrollTop()+e+"px").css("left",d.scrollLeft()+"px").width(b).height(c);"1"!==a("input[name\x3dfromAnywhere]").val()&&a("#loading-spinner-blocker-doc").css("top",d.scrollTop()+e+"px").css("left",d.scrollLeft()+"px").width(b).height(c)}function g(){var b=document.activeElement?a(document.activeElement):a(":focus:first");b.is("button, a, input:enabled")&&b.blur()}function b(){if(x){n();q.when("spp-button-blocker").execute(function(a){a.hideContinueBtnBlocker()});var b=a(".spp-panel.expanded");if(0<
b.length&&b.is(":visible")){k(b,1);return}}if(y)return h.length&&h.find(".loading-spinner-inner").show(),!1;y=!0;g();h=a("#spinner-anchor");h.find(".loading-spinner-inner").show();a("#unblockHeader").length&&(v=a("#header"));f=h.css("z-index");a(r).unbind("scroll.checkout-page-spinner").bind("scroll.checkout-page-spinner",function(a){c&&r.clearTimeout(c);c=setTimeout(function(){m();c=null},50)});a(r).unbind("resize.checkout-page-spinner").bind("resize.checkout-page-spinner",function(){m();l.adjustSize(h)});
a(r).unbind("orientationchange.checkout-page-spinner").bind("orientationchange.checkout-page-spinner",function(){m();l.adjustSize(h)});m();h.show();h.css("z-index",2E3);l.showSpinner(h,!0);return!0}function d(){if(x)e(),"function"===typeof w.hideSpinner&&w.hideSpinner();else{a("#first-pipeline-load-page-spinner").remove();if(!y)return!1;y=!1;h.length&&h.find(".loading-spinner-inner").show();h&&(a(r).unbind(".checkout-page-spinner"),h.hide(),h.css("z-index",f),l.hideSpinner(h));return!0}}var f,c=null,
h,y=!1,v=null,w={},x=!1;return{show:b,showPageTransition:function(){return"0"===a("#showPageTransition").attr("content")?!1:b()},hide:d,hidePageTransition:function(){"0"===a("#showPageTransition").attr("content")&&d();return!0},hideAnimatedSpinnerImage:function(){h.length&&h.find(".loading-spinner-inner").hide()},initFunc:function(a){null!==a&&(w=a,x=!0)},blockAllActions:n,unblockAllActions:e,showTransitionInContainer:k,shrinkPanel:function(a,b,c){"function"===typeof w.shrinkPanel&&w.shrinkPanel(a,
b,c)},clearFocus:g}});"use strict";q.when("A").execute(function(a){a=a.$;var l="";l="mash-transitions"===a("input[name\x3dpageTransitionType]").val()?"page-mash-transition-controller":"page-spinner-controller";q.when(l).register("page-transition-controller",function(a){q.when("A").execute(function(e){e.declarative("page-spinner-show",["click"],{allowLinkDefault:!0},function(e){e=e.$target;e.hasClass("a-button-disabled")||e.closest(".a-button-disabled").length||a.showPageTransition()})});q.when("A").execute(function(e){e.declarative("page-spinner-show-on-submit",
["submit"],{allowLinkDefault:!0},function(e){a.showPageTransition()})});return{show:a.show,hide:a.hide,showPageTransition:a.showPageTransition,hidePageTransition:a.hidePageTransition,blockAllActions:a.blockAllActions,unblockAllActions:a.unblockAllActions,showTransitionInContainer:a.showTransitionInContainer,shrinkPanel:a.shrinkPanel}})});"use strict";q.when("A","page-conductor","client-side-metrics","page-detector-current-page","a-popover","ready").execute(function(a,l,n,e){function k(a,d,e){l.isSPP()&&
n.setmarker&&n.setmarker("af");n.sendUEPageLoadStats()}var m=a.$,g=!1;a.on("a:popover:afterHide",function(a){a.popover&&(g=!1)});a.on("a:popover:beforeShow",function(a){var b=a.popover;b&&(g=!0,b.$trigger.find(".modal-parameters").each(function(){m.each(m(this).data(),function(a,c){b.attrs(a,c)})}))});a.on("a:popover:dismiss",function(a){a=a.popover;if(n.isTransitionLoggingEnabled()&&a&&g){g=!1;if("prime-acquisition-spc-popover"===a.name){var b="prime-acquisition";var f=e.getCurrentPage()}b||f||!a.attrs||
(b=a.attrs("returnfrom"),f=a.attrs("returnto"));b&&f&&(n.resetMetrics(),n.logPageTransition(b,f,k))}})});"use strict";q.when("A","page-detector-current-page","checkout-general-utils","client-side-metrics").register("first-load-dependencies-base",function(a,l,n,e){function k(){"function"===typeof r.uet&&"function"===typeof r.uex&&(r.uet("cf","first-load-dependencies-ready",{wb:1}),r.uex("ld","first-load-dependencies-ready",{wb:1}));e.startWidgetTiming("first-load-dependencies:checkout:beforeReload");
a.trigger("checkout:beforeReload");e.finishWidgetTiming("first-load-dependencies:checkout:beforeReload");e.startWidgetTiming("first-load-dependencies:checkout:reload");a.trigger("checkout:reload");e.finishWidgetTiming("first-load-dependencies:checkout:reload");var b;g&&(b="spp-revieworder"===g?"spc":g);b&&(e.finishWidgetTiming("first-load-dependencies:checkout:reload:"+b),a.trigger("checkout:reload:"+b),e.finishWidgetTiming("first-load-dependencies:checkout:reload:"+b));e.startWidgetTiming("first-load-dependencies:checkout:afterReload");
a.trigger("checkout:afterReload");e.finishWidgetTiming("first-load-dependencies:checkout:afterReload");setTimeout(function(){var a=m("#first-pipeline-load-page-spinner");a.is(":visible")&&(a.remove(),e.increaseCount("checkout:pageload:timeout"),n.logError("The page has taken more than 90 seconds to load, or there was a JS error preventing it from loading, hiding page spinner."))},9E4)}var m=a.$,g=l.getCurrentPage();"function"===typeof r.uet&&r.uet("bb","first-load-dependencies-ready",{wb:1});return{allDependenciesCheck:function(a){if(a&&
a.length){var b=!1,f={};m.each(a,function(a,b){e.startWidgetTiming("checkout:dependency:"+b+":ready");f[b]=1;q.when(b).execute(function(){e.finishWidgetTiming("checkout:dependency:"+b+":ready");delete f[b]})});var c=function(a){a="Page ("+g+") is missing dependencies ["+a.join(", ")+"] after 5 secs.";e.increaseCount("checkout:dependency:missed:regular-page:error");n.logErrorOnLevel(a,"ERROR")},h=setTimeout(function(){if(!b){var a=[];m.each(f,function(b){e.increaseCount("checkout:dependency:"+b+":missed");
a.push(b)});e.increaseCount("checkout:dependency:missed");0<m("#assets-prefetch").length?e.increaseCount("checkout:dependency:missed:assets-prefetch"):(e.increaseCount("checkout:dependency:missed:regular-page"),c(a));k()}},5E3);q.when.apply(q,a).execute(function(){b=!0;r.clearTimeout&&h&&r.clearTimeout(h);k()})}else k()}}});"use strict";q.when("A","page-detector","client-side-metrics").register("gift-utility",function(a,l,n){var e=a.$,k=/[^\s\u0020-\u007E\u00A0-\u00FF]/g,m=r.P&&r.P.AUI_BUILD_DATE,
g=/((?:file|https?|ftps?|sip):\/\/)/im,b=/((?:\b|[\s!@#$%^&*()_=+[\]{}\|;:'",.<>\?])www\.(?:(?:[^\s!@#$%^&*()_=+[\]{}\|;:'",.<>\?]+\.[^\s!@#$%^&*()_=+[\]{}\|;:'",.<>\?]+))+)(?:[\s!@#$%^&*()_=+[\]{}\|;:'",<>\?]|$|\b)/im,d=/([^\s!@#$%^&*()_=+[\]{}\|;:'",.<>\?\/]+\.(?:[a-z][a-z]|aero|arpa|asia|biz|cat|com|coop|edu|gov|info|int|jobs|mil|mobi|museum|name|net|org|om|pro|qa|tel|travel|xxx)(?:\b|$))/im,f=/^\S+\@\S+\.\S+$/im;return{getInput:function(a){return a.is("input")?a:a.find("input")},getCharCount:function(a,
b){return b?r.unescape(encodeURIComponent(a)).length:a.length},getLineCount:function(a,b){var c=a.split("\n").length;b=Math.floor(b);a=a.split("\n");for(var d=0;d<a.length;d++)a[d].length>b&&(c+=Math.floor(a[d].length/b),0===a[d].length%b&&c--);return c},getNameWithNoTitle:function(a){var b=!1;a=a.split(" ");/^(?:Dr|Mr|Mrs|Ms|Mme|Lt|Attn|Attn:|Prof|Pt|The)\.?$/i.test(a[0])&&(b=!0);b&&a.shift();return a.join(" ")},getFirstName:function(a){var b=!1;a=a.split(" ");/^(?:Dr|Mr|Mrs|Ms|Mme|Lt|Attn|Attn:|Prof|Pt|The)\.?$/i.test(a[0])&&
(b=!0);b&&a.shift();return a.shift()},toggleGiftMessageWarning:function(a,b){var c=b.find(".gift-message-warning");if(k.test(a.val())){var d=b.find(".gift-message-preview-trigger"),f=a.val().replace(k,"?");m?q.when("a-popover").execute(function(a){var b=a.get(d);b?b.update({content:f}):a.create(d,{inlineContent:f,position:"triggerVertical",closeButton:"false"})}):(n.increaseCount("removeauijs13"),d.unbind("click.preview").bind("click.preview",function(a){q.when("a-popover-base").execute(function(b){var c=
e(a.target);c.data("popoverid")&&(b=b.get(c.data("popoverid")))&&(b.update(f),b.updatePosition())})}));a.addClass("a-form-error");c.show()}else a.removeClass("a-form-error"),c.hide()},valueContainsUrl:function(a){return g.test(a)||b.test(a)||d.test(a)},isValidEmail:function(a){return f.test(""+a)}}});"use strict";q.when("A","page-detector","safe-mash","client-side-metrics").register("help-popup",function(a,l,n,e){function k(){if(m("div#help-popover").length){m(r).unbind("resize.checkout-help-popover");
var a=m("#help-popover-frame")[0];m(a.contentWindow?a.contentWindow:a.contentDocument.defaultView).undelegate("a","click");m("div#help-popover").remove()}}var m=a.$;l=l.isMobile();e=m("input#isPipelinedPage");e=0<e.length&&"1"===e.val();var g=l&&e&&n&&n.navigate;a.declarative("help-popup",["click"],function(a){if(!m(".a-touch").length||g){a.$event.preventDefault();a.data&&"1"===a.data.stopPropagation&&a.$event.stopPropagation();var b=a.$target.closest("a").attr("href");a=a.data;g?n.navigate({url:b,
transitionEffect:"slide"}):(a.width||(a.width="340"),a.height||(a.height="340"),r.open(b,"AmazonHelp","width\x3d"+a.width+",height\x3d"+a.height+",left\x3d10,top\x3d10,resizable\x3dyes,scrollbars\x3dyes,menubar\x3dno,toolbar\x3dyes,location\x3dno,directories\x3dno,status\x3dyes"))}else r.open(a.$target.closest("a").attr("href"),"AmazonHelp")});if(g)a.on("checkout:reload",k)});"use strict";q.execute("persistent-order-controller",function(){return{}});"use strict";q.when("jQuery","page-conductor").register("quantity-service",
function(a,l){function n(e,k){k=k||{};if(k.additionalData)var m=k.additionalData;var g="/gp/buy/pipeline/handlers/update-quantity.html",b={returnFullHTML:1,cachebuster:(new Date).getTime(),isClientTimeBased:0,hasWorkingJavascript:1};m&&m.deletePrimeMembership&&m.primeMembershipASIN&&(b.deletePrimeMembershipItemIn=m.deletePrimeMembership,b.deletedPrimeMembershipASINIn=m.primeMembershipASIN);k.ref&&(g+="/ref\x3d"+k.ref,delete k.ref);m=k.success;delete k.success;var d=l.ajaxRedirect;k.error&&(d=k.error,
delete k.error);a.extend(b,k);k=[];for(var f in e)e[f]!==G&&(k.push(f),b[f]=e[f]);b.entityids=k;e=l.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"});a.ajax({type:"POST",url:g,data:a.param(b,!0),dataType:"text",async:!0,cache:!1,headers:e,success:m,error:d})}return{callBatch:function(a,k){n(a,k)},call:function(a,k,m){var e={};e[a]=k;n(e,m)}}});"use strict";q.when("jQuery").register("scroll-controller",function(a){return{scrollToTop:function(){a(r).scrollTop(0)},
toggleScrollOn:function(){a(document).unbind("touchmove")},toggleScrollOff:function(){a(document).bind("touchmove",function(a){a.preventDefault()})}}});"use strict";q.when("A","checkout-general-utils","ready").execute(function(a,l){var n=a.capabilities&&a.capabilities.isAmazonApp,e=r.amazon&&r.amazon.mash;a=a.$("#checkout-mash-will-load").length;n||e||a?q.when("mash").execute(function(a){if("object"===typeof a)var e=a;else r.amazon&&r.amazon.mash&&(e=r.amazon.mash);"object"!==typeof e?l.logError("MASH is expected but can't be found!"):
(q.register("safe-mash",function(){return e}),r.ue&&r.ue.tag&&r.ue.tag("safe-mash:mash"))}):(q.register("safe-mash",function(){}),r.ue&&r.ue.tag&&r.ue.tag("safe-mash:no-mash"));r.ue&&r.ue.tag&&(n&&r.ue.tag("safe-mash:A.capabilities.isAmazonApp"),e&&r.ue.tag("safe-mash:window.amazon.mash"),a&&r.ue.tag("safe-mash:checkout-mash-will-load"),!n&&e&&r.ue.tag("safe-mash:fallback:window.amazon.mash"),n||e||!a||r.ue.tag("safe-mash:fallback:checkout-mash-will-load"))});"use strict";q.when("A","scheduled-delivery-external-interface",
"shipping-speed-selection-controller","page-detector","ready").register("scheduled-delivery-controller",function(a,l,n,e){var k=a.$,m={};n=function(){m={};k("div.fake-label input[type\x3d'radio']:checked").each(function(){var a=k(this),b=a.closest("div.fake-label");(b=l.getSdWidgetRootId(b))&&(m[a.attr("name")]=b)})};a.on("checkout:reload:shipoptionselect",n);a.on("checkout:reload:spp-revieworder",n);e.isSosp()&&n();k(document).delegate("div.fake-label","click",function(){if(e.isSosp()){var g=k(this),
b=g.find("input[type\x3d'radio']");b.attr("disabled")||(b=b.attr("name"),g=l.getSdWidgetRootId(g),a.trigger("scheduled-delivery:ship-option-changed",{current:g,previous:m[b]}),m[b]=g)}});k(document).delegate(".ship-option.is-scheduled-delivery","click",function(){if(e.isSpc()){var g=k(this);g.find("input[type\x3d'radio']").attr("disabled")||(g=l.getSdWidgetRootId(g))&&a.trigger("scheduled-delivery:ship-option-changed",{current:g,previous:null})}});a.on("scheduled-delivery:unblock-continue",function(){q.when("button-blocker").execute(function(a){a.hide("scheduled-delivery")})});
a.on("scheduled-delivery:block-continue",function(a){q.when("button-blocker").execute(function(b){b.show("scheduled-delivery",a)})});a.on("scheduled-delivery:disable-ship-option",function(a,b){a=k("#"+a);if(0!==a.length){if(e.isSpc())a=a.closest(".shipping-speed");else if(e.isSosp())a=a.closest("div.fake-label.a-box");else return;var d=a.find("input[type\x3d'radio']");d.attr("disabled",!0);d.is(":checked")&&b&&(b=k("input[name\x3d"+d.attr("name")+"]:radio:not(:disabled):first"),b.prop("checked",!0),
b.trigger("change"));a.addClass("sd-disabled")}});a.on("scheduled-delivery:enable-ship-option",function(a){a=k("#"+a);if(0!==a.length){if(e.isSpc())a=a.closest(".shipping-speed");else if(e.isSosp())a=a.closest("div.fake-label.a-box");else return;a.find("input[type\x3d'radio']").removeAttr("disabled");a.removeClass("sd-disabled")}})});"use strict";q.when("A","ready").register("mobile-nav-bar-back-controller",function(a){a.capabilities.history&&(a=a.$,a=a("#mobile-top-bar-navigation-back"),1<=a.length&&
a.click(function(a){a.preventDefault();r.history.back()}))});"use strict";q.when("A","page-spinner-controller","page-detector","page-conductor","weblab-helper","ready").execute(function(a,l,n,e,k){function m(a,b){var c=[];a.addressId||c.push("addressId");a.slotKey||c.push("slotKey");a.shippingOfferingId||c.push("shippingOfferingId");a.conflictItems&&!h.isArray(a.conflictItems)&&c.push("conflictItems");if(0<c.length){a="Error calling fresh widget callback on "+b+": Bad or Missing Input: "+c[0];for(b=
1;b<c.length;b++)a+=", "+c[b];console.error(a);return 0}return 1}function g(){h("#freshSlotKey").val("");h("#freshAddressId").val("");h("#freshReservationToCancel").val("");h("#freshConflictingItems").val("");h("#freshShipOfferingId").val("")}function b(a){var b="",c=k.sospPartialAvailabilityWeblabOn();if(a&&h.isArray(a)&&0<a.length){b=a[0].asin+":"+a[0].merchantId+(c?"|"+a[0].maxQtyAvailable:"");for(var d=1;d<a.length;d++)b+="-"+a[d].asin+":"+a[d].merchantId+(c?"|"+a[d].maxQtyAvailable:"")}return b}
function d(a){var c="page\x3dspc\x26returnFullHTML\x3d1\x26callSetters\x3d1\x26freshSlotKey\x3d"+a.addressId;c+="\x26freshAddressId\x3d"+a.slotKey;a.reservationToCancel&&(c+="\x26freshReservationToCancel\x3d"+a.reservationToCancel);(a=b(a.conflictItems))&&(c+="\x26freshConflictingItems\x3d"+a);a=e.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});l.show();h.ajax({type:"POST",url:"/gp/buy/shared/handlers/handle-fresh-widget-results.html/ref\x3dset-fresh-information",data:c,dataType:"text",async:!0,
cache:!1,headers:a,success:function(a,b,c){return c.getResponseHeader("x-amz-checkout-page")?e.ajaxUpdatePage(a,b,c):e.redirect(a)},error:function(a,b,c){e.ajaxRedirect(a,b,c)}})}function f(){h(".sosp-continue-button").removeClass("js-hide").removeClass("aok-hidden");h(".continue-button-blocker").addClass("aok-hidden")}function c(){h(".sosp-continue-button").addClass("aok-hidden");h(".continue-button-blocker").removeClass("aok-hidden")}var h=a.$;a.on("handle-fresh-results",function(a){if(h("#isfresh").val())if(a)if(n.isSosp())if(m(a,
"sosp")){h("#freshSlotKey").val(a.slotKey);h("#freshAddressId").val(a.addressId);h("#freshReservationToCancel").val(a.reservationToCancel);var k=b(a.conflictItems);h("#freshConflictingItems").val(k);h("#freshShipOfferingId").val(a.shippingOfferingId);k&&0<k.length?h("input#block-prefetch").val(1):h("input#block-prefetch").val(0);k=h("#shippingOptionFormId");a.conflictItems&&0<a.conflictItems.length||e.makePrefetch(k);f()}else g(),c();else n.isSpc()?m(a,"spc")&&d(a):console.error("remote fresh widget JS callback called on unsupported page.");
else console.error("remote fresh widget JS callback called with empty data.");else console.error("remote fresh widget JS callback called without isfresh flag on page")});a.on("block-continue",function(a){h("#isfresh").val()?a?"undefined"===typeof a.blockContinue?console.error("block continue callback - missing blockContinue"):n.isSosp()?1===a.blockContinue?(c(),g()):0===a.blockContinue?f():console.error("block continue callback - invalid value"):console.error("block continue callback called on unsupported page."):
console.error("block continue callback called with no argument"):console.error("block continue callback called without isfresh flag on page")});a.on("confirm-and-continue",function(){h("div.sosp-fresh #shippingOptionFormId").submit()});a.on("redirect-to-spc",function(){e.redirect({conductoraction:{url:'/gp/buy/spc/handlers/display.html/ref\x3d"cancel-fresh-address-select"',type:"redirect"}})})});"use strict";q.when("A","ready").execute(function(a){function l(){(0<n(".change-preference-block").length||
0<n(".mobile-change-preference-block").length)&&!1===e&&(q.register("loadVasRcxCheckoutAsset",function(){}),e=!0)}var n=a.$,e=!1;l();a.on("checkout:reload:spc",l);a.on("checkout:reload:shipoptionselect",l);a.on("checkout:reload:spp-revieworder",l);a.on("checkout:reload:spp-special-delivery-options",l)});"use strict";q.register("time-left-formatter",function(){function a(a,e,k,m,g){return 0>=e?a:a+e+" "+(1===e?g.HOUR:g.HOURS)+(!m&&0<k?" "+g.AND+" ":"")}function l(a,e,k,m,g){return 0>=e?a:a+e+" "+(1===
e?g.MINUTE:g.MINUTES)+(!m&&1>k?" "+g.AND+" ":"")+(1===m&&1>k?" ":"")}return{getTimeLeftFormatted:function(n,e,k){var m="",g=86400<n?(n-n%86400)/86400:0,b=3600<n?(n-n%3600)/3600:0;n-=3600*b;var d=60<n?(n-n%60)/60:0;n-=60*d;if(e&&0<g)return m+g+" "+(1===g?k.DAY:k.DAYS);if(e&&0<b)return a(m,b,d,e,k);if(e&&5<=d)return l(m,d,b,e,k);m=a(m,b,d,e,k);m=l(m,d,b,e,k);1<=b||(m=m+n+" "+(1===n?k.SECOND:k.SECONDS));return m}}});"use strict";q.register("email-validation",function(){function a(a){if(1!==a.length)throw Error("Invalid length for character");
return a}var l={isISOControl:function(n){"string"===typeof n&&(a(n),n=n.charCodeAt(0));return 31>=n||127===n},isWhitespace:function(n){n=a(n);return null!==n.match(/\s/g)},isLetterOrDigit:function(n){n=a(n);return null!==n.match(/[A-Za-z0-9]/g)}};return function(a){var e;if(!a||64<a.length)return!1;for(e=0;e<a.length;e++)if(127<a.charCodeAt(e))return!1;e=a.indexOf("@");if(e!==a.lastIndexOf("@")||1>e||e===a.length-1)return!1;var k=a.substring(0,e),m=a.substring(e+1);if("."===m.charAt(0)||"."===m.charAt(m.length-
1)||m.match(/[a-zA-Z\d\-.]+/)[0]!==m)return!1;for(e=0;e<m.length;e++)if(a=m.charAt(e),e<m.length-1&&"."===a&&"."===m.charAt(e+1))return!1;if(-1===m.indexOf("."))return!1;var g=m=!1;for(e=0;e<k.length;e++)if(a=k.charAt(e),m){switch(a){case "\\":g=!g;break;case '"':g||(m=!1);break;default:if(g&&!l.isLetterOrDigit(a))return!1;g=!1;if(l.isISOControl(a))return!1}if(!m&&('"'===k.charAt(e-1)||k.length-1!==e&&"."!==k.charAt(e+1)))return!1}else switch(a){case '"':if(0!==e&&"."!==k.charAt(e-1))return!1;m=!0;
break;case ".":if(0===e)return!1;break;case "(":case ")":case "\x3c":case "\x3e":case "[":case "]":case "\\":case ":":case ";":case ",":return!1;default:if(l.isISOControl(a)||l.isWhitespace(a))return!1}return!0}});"use strict";q.when("A","page-transition-controller","checkout-general-utils","page-detector","page-detector-current-page","safe-mash","loading-spinner-controller","weblab-helper").register("shipoptionselect-controller",function(a,l,n,e,k,m,g,b){function d(a){var b=x(".delivery-window-groups .more-window");
g.showSpinner(b,!1);a=a.$currentTarget.closest(".delivery-window-groups").data("orderid");b=x("input[name\x3dlineItemEntityIds_"+a+"]").attr("value");x.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/long-calendar-content.html",data:"lineitemids\x3d"+b+"\x26orderid\x3d"+a+"\x26isMobile\x3d1\x26fromPage\x3dsosp",dataType:"json",async:!0,cache:!1,headers:{"x-amz-checkout-page":"sosp"},success:function(a){g.hideSpinner();if(a&&a.deliveryWindowGroups){var b=x(".delivery-window-groups .a-box-group");
b.empty();x.each(a.deliveryWindowGroups,function(a,c){b.append(c)});a=x(".delivery-window-groups .selected-group");a.length&&a.trigger("click")}}})}function f(a,b){var c=x("div.one-shipment:visible");a=t?x("div.one-shipment").slice(parseInt(a,10),parseInt(b,10)+1):x("div.one-shipment#"+a);u&&0!==a.size()&&c.last().attr("id")!==a.last().attr("id")&&(c.hide(),a.show(),x(r).scrollTop(0),c=x(document.activeElement),c.is("button, a, input:enabled")&&c.blur())}function c(){if(u){var a=(location.hash?location.hash.replace("#",
""):"0-"+A).split("-");2===a.length&&f(a[0],a[1])}}function h(){function d(a,b){x.ajax({type:"POST",url:"/gp/buy/gift/handlers/remove-gift-option.html",data:b,dataType:"json",async:!0,cache:!1,headers:{"x-amz-checkout-page":"sosp"},success:a,error:function(a,b,c){l.hide()}})}function h(a){var b=a.closest("div."+n);a.is(":checked")?(b.siblings("div."+n+".selected").removeClass("selected").find(".a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive"),
b.addClass("selected").find(".a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active")):b.removeClass("selected").find(".a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");v("triggerChangeEvent",[a])}0<x(".prime-calendar-container").length&&x(".prime-calendar-container").contents().each(function(a,b){8===b.nodeType&&x(b).replaceWith(b.nodeValue)});var g=x(".delivery-window-groups .selected-group");
g.length&&g.trigger("click");p=x(".sosp-continue-button");u="1"===x("#isClientSidePagingEnabled").val()?1:0;A=b.isDigitalAsinIndexingFixedOnSOSPEnabled()?(x("div.shipment-with-ship-options:visible").length-1).toString():(x("div.one-shipment:visible").length-1).toString();B="1"===x("#useMashNavigateForClientSidePaging").val()?1:0;t="1"===x("#collapseDigitalShipmentsEnabled").val()?1:0;var n=(g=r.P&&r.P.AUI_BUILD_DATE)?"selectable-box":"fake-label";u&&(x(".one-shipment:gt("+A+")").hide(),c());p.bind("click",
function(c){function d(a,b){var c=k.getCurrentPage();if(r.history&&r.history.pushState){var d=location.href;0<d.indexOf("#")&&(d=d.substring(0,d.indexOf("#")));d+="#"+a.attr("id")+"-"+b.attr("id");history.pushState({page:c,id:a.attr("id")},x("title"),d)}}var h=x("div.one-shipment:visible input[id\x3d'fresh-block-continue']");if(h){if("1"===h.val())return a.trigger("f3:fresh-sosp-continue:blocked"),c.preventDefault(),!1;"0"===h.val()&&a.trigger("f3:fresh-sosp-continue:allowed")}var g=!1;x("div.one-shipment:visible input[type\x3d'radio'][checked]").each(function(){if(x(this).data("blockingOn"))return alert(x(this).data("blockingOn")),
c.preventDefault(),g=!0,!1});if(g)return!1;if(b.removesGiftOptionOnRush()&&e.isMobile()&&null!=N){h=x("div.one-shipment:visible");var p=h.find("input[type\x3d'radio']:checked").closest(".shipping-option");if("1"===h.find("input[type\x3dhidden][name\x3disGiftWrapped]").attr("value")&&1===p.data("nosupportforgiftoption"))return N.show(),!1}y();h=x("div.one-shipment:visible");p=h.nextAll("div.one-shipment:hidden");if(0<p.length){c.preventDefault();var n=p.first(),l=n;t&&(l=p.filter(".shipment-with-ship-options"),
l=1<l.length?l.eq(1).prev():p.last());B&&m&&m.navigate?m.navigate({url:null,transitionEffect:"slide",successCallback:function(){d(n,l)},failCallback:function(a){}}):d(n,l);f(n.attr("id"),l.attr("id"));a.trigger("active-shipment-changed")}w("logInlineCalMetrics",[h])});x(".gift-option-removal-cancel-button").bind("click",function(a){N.hide()});x(".gift-option-removal-confirm-button").bind("click",function(a){l.show();N.hide();a="lineItemsToRemoveGiftOptionFrom\x3d"+x("div.one-shipment:visible").find("input[name^\x3dlineItemEntityIds_]").attr("value");
var b=x("div.one-shipment:visible"),c=b.nextAll("div.one-shipment:hidden");d(function(a,d,e){b.find("input[type\x3dhidden][name\x3disGiftWrapped]").each(function(){x(this).remove()});0<c.length?(p.click(),l.hide()):x(".checkout-page-form").submit()},a)});x(r).bind("popstate",function(a){e.isSosp()&&c()});x(document).delegate("div."+n,"click",function(a){a=x(this);a.find("input[type\x3d'radio']").trigger("change",["setActive"]);a.parent().hasClass("timeslot-picker")&&(a=a.find(".a-button-selected").length,
p&&p.length&&(a?p.removeClass("a-button-disabled").addClass("a-button-primary").find("input").prop("disabled",!1):p.removeClass("a-button-primary").addClass("a-button-disabled").find("input").prop("disabled",!0)))});var q;a.declarative("faster-than-same-day-sosp-save",["click","submit"],function(){var b="lineItemsToRemoveGiftOptionFrom\x3d"+q.closest(".one-shipment").find("input[name^\x3dlineItemEntityIds_]").attr("value");a.$("div.a-popover button.a-button-close").trigger("click");l.show();d(function(a,
b,c){q.closest(".one-shipment").find(".isGiftWrapped").each(function(){x(this).remove()});q.attr("checked",!0);h(q);l.hide()},b)});x(document).delegate("div."+n+" input[type\x3d'radio']","change",function(a,c){a=x(this);if("setActive"===c&&!a.attr("disabled")&&b.removesGiftOptionOnRush()&&0<a.closest(".one-shipment").find(".isGiftWrapped").length&&1==a.data("nosupportforgiftoption"))q=a,a.is(":checked")&&(c=a.closest("div."+n).siblings("div."+n+".selected").find('input[type\x3d"radio"]'),q.attr("checked",
!1),c.attr("checked",!0)),setTimeout(function(){x("#faster-than-same-day-sosp-popover").trigger("click")},10);else{if("setActive"===c){if(a.attr("disabled"))return;a.attr("checked",!0)}if("disabling"===c)if(a.attr("disabled",!0),a.is(":checked"))a.removeAttr("checked");else return;h(a)}});x("div."+n+" input[type\x3d'radio']:checked").change();x("h3").children().removeAttr("style");0===x("div."+n+".scheduled-delivery").length&&x("form.checkout-page-form").data("checkoutFormReady",!0).change();g&&x(document).delegate(".a-touch-radio a",
"click",function(a){if(!b.isSOSPExclusiveJSHandlerWeblabOn()||e.isSosp()){var c=x(a.target).attr("href");!c||c.startsWith("#")||c.toLowerCase().startsWith("javascript:")||(m&&m.navigate?m.navigate({url:c,transition:"slide"}):a.preventDefault=!1)}})}function y(){if(1===x("div.store-upsell-ship-options").length){var a="/gp/buy/shared/handlers/store-upsell-async.html",b="ox_store_upsell_continue_",c=x("div.ship-speed, div.store-upsell-ship-options").find("input.shipping-option, input.store-upsell-ship-option"),
d=[],e;x.each(c,function(a,c){a=x(c);c=a.attr("value");d.push(c.toLowerCase());a.is(":checked")&&(e=a.attr("value"),b=a.hasClass("store-upsell-ship-option")?b+"success":b+"failure")});a=n.addQueryStringParameter(a,"ref",b);x.ajax({url:a,type:"POST",async:!0,data:{shown:d.toString(),clicked:e}})}}function v(a,b){q.when("checkout-federation-wrapper","shipspeed-provider").execute(function(c,d){c.wrap(function(){d&&!x.isEmptyObject(d)&&"function"===typeof d[a]&&d[a].apply(this,b)},"VasCheckoutShipSpeedProvider")})}
function w(a,b){q.when("checkout-federation-wrapper","sd-methods").execute(function(c,d){c.wrap(function(){d&&!x.isEmptyObject(d)&&"function"===typeof d[a]&&d[a].apply(this,b)},"CricketInlineCalendarHeavyBulkyIN")})}var x=a.$,p,u,B,A,t=0,N;a.declarative("sosp-change-quantity-link",["click"],function(a){var b=a.$currentTarget,c=x("\x3cinput type\x3d'hidden' /\x3e").attr("name","change-quantities-or-delete").val("1");b.hasClass("pipeline-link")?(a.$event.preventDefault(),b.closest("form").removeClass("checkout-page-form").append(c).find(".sosp-continue-button:first").trigger("click")):
b.closest("form").removeClass("checkout-page-form").append(c).find(".sosp-continue-button:first").trigger("click").end().trigger("submit")});q.when("A","a-sheet").register("shipoptionselect-gift-removal-controller-mobile",function(a,b){N=b.create({name:"gift-removal-popover",height:220,preloadDomId:"gift-option-removal-message",closeType:"icon",sheetType:"web"})});a.declarative("sosp-extender-toggle",["click","touchend"],function(a){if(!n.protectAgainstDoubleAction("sosp-extender-toggle")){var b=
a.$target.closest("a"),c=x(".delivery-window-groups .a-box-group").find(".lazy-loaded");if(b.hasClass("aui-extender"))c.length?c.remove():d(a);else{var e=b.find("i");b=b.closest("div.extender-section");e.hasClass("a-icon-extender-expand")?(b.find(".collapsed").hide(),b.find(".expanded").slideDown("fast"),e.removeClass("a-icon-extender-expand").addClass("a-icon-extender-collapse"),d(a)):(b.find(".collapsed").show(),b.find(".expanded").slideUp("fast"),e.removeClass("a-icon-extender-collapse").addClass("a-icon-extender-expand"),
c.length&&c.remove())}}});a.declarative("sosp-select-prime-slot",["click","touchend"],function(a){if(!n.protectAgainstDoubleAction("sosp-select-prime-slot")){a=a.$currentTarget;var b=a.closest(".valid-slot");if(b.closest(".prime-calendar").hasClass("long-calendar")){var c=b.closest(".prime-calendar").data("orderid"),d=x("#calendar-"+c);c=x("#calendar-delivery-message-"+c);var e=a.closest(".long-calendar");e.find(".selected-slot").removeClass("selected-slot");0<b.length&&b.addClass("selected-slot");
x(".a-button-close").trigger("click");b=a.data("slotid");b=d.find(".slot-"+b);if(0<b.length)d.show(),c.parent().hide(),b.closest(".prime-calendar").find(".selected-slot").removeClass("selected-slot"),b.closest(".valid-slot").addClass("selected-slot");else{var f=a.parent()[0],h=a.parent().parent().find(".rhead")[0];b=h.innerText;b||(b=h.textContent);f=f.cellIndex;e=e.find("th")[f];f=e.innerText;f||(f=e.textContent);c.text(f+" "+b);d.hide();c.parent().show()}}else c=b.closest(".prime-calendar-container").data("orderid"),
d=x("#calendar-"+c).find(".selected-slot"),0<d.length&&(d.removeClass("selected-slot"),0<b.length&&b.addClass("selected-slot"));d=a.closest(".prime-calendar-container").data("orderid");a.data("key")&&x("#order_"+d+"_ShippingSpeed").val(a.data("key"));a.data("isscheduleddeliveryslot")&&x("#sdData"+d).val(a.data("sddatastring"))}});a.declarative("sosp-select-delivery-window",["click","touchend"],function(a){if(!n.protectAgainstDoubleAction("sosp-select-delivery-window")){a=a.$currentTarget;a.length&&
!a.hasClass("dwg-button")&&(a=a.find(".dwg-button"));x(".dwg-button").removeClass("selected-dwg-button");a.addClass("selected-dwg-button");var b=a.closest(".delivery-window-groups").data("orderid"),c=a.data("key");!c&&a.find("button").length&&(c=a.find("button").data("key"));c&&x("#order_"+b+"_ShippingSpeed").val(c);c=a.data("isscheduleddeliveryslot");!c&&a.find("button").length&&(c=a.find("button").data("isscheduleddeliveryslot"));c&&(c=a.data("sddatastring"),!c&&a.find("button").length&&(c=a.find("button").data("sddatastring")),
x("#sdData"+b).val(c))}});a.on("checkout:reload:shipoptionselect",h);a.on("checkout:reload:spp-shipoption",h);a.on("checkout:reload:spp-f3-sosp",h);if(b.isVasTrueSPCEnabled())a.on("checkout:reload:spp-special-delivery-options",h)});q.when("jQuery","page-detector").register("deliv-prefs-sosp",function(a,l){function n(){a(".sosp .order-delivery-time-preference").each(function(){var e=a(this);e.bind("selectionChanged",function(){0===e.find(".delivery-time-preference-group").length?e.hide():(e.show(),
0===e.find("input:checked").length&&e.find("input:first").trigger("change",["setActive"]))}).bind("empty",function(){e.find(".delivery-time-preference-group").detach()});var k=e.closest(".one-shipment").find("input.shipping-option");e.find(".delivery-time-preference-group").each(function(){var k=a(this),g=k.data("shippingoptionid");g=a("#"+g);k.is(".template")&&k.detach().removeClass("template");g.change(function(){e.trigger("empty");k.appendTo(e);e.trigger("selectionChanged")}).addClass("hasDeliveryTimePreference")});
k.not(".hasDeliveryTimePreference").change(function(k,g){"disabling"===g||a(this).is(":disabled")||(e.trigger("empty"),e.trigger("selectionChanged"))});e.trigger("selectionChanged")})}q.when("A").execute(function(a){a.on("checkout:reload:shipoptionselect",n)})});q.when("A","shipoptionselect-controller").execute(function(a){var l=a.$,n={},e={};a.on("checkout:reload:shipoptionselect",function(){var a=l("#shippingOptionFormId"),m=a.find("input[name\x3dtrialKey]");if(1===m.length){for(var g in n)n.hasOwnProperty(g)&&
(n[g].abort(),delete n[g]);n={};e={};var b=function(a){return a.join("::").replace(/\s+/g,"_")},d=function(){return l.map(a.find("input[type\x3dradio]:checked"),function(a){return a.name})},f=function(){return l.map(a.find("input[type\x3dradio]:checked"),function(a){return a.value})},c=function(a,b){if(n.hasOwnProperty(a)||e.hasOwnProperty(a))return!1;console.debug('initiating ajax call for trial key "'+a+'"');b=l.ajax({type:"POST",url:"/gp/buy/shipoptionselect/handlers/launch-delivery-trial.html",
contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",headers:{"x-amz-checkout-transition":"ajax"},data:b,dataType:"json",async:!0,success:function(b){b?console.debug('trial "'+a+'" success'):console.debug('trial "'+a+'" failed');e[a]=b;delete n[a]},error:function(b,c,d){delete n[a];"abort"!==d&&(console.debug("trial "+a+" error"),q.error("issue with set-delivery-options trial: "+c,d))},cache:!1});n[a]=b;return!0},h=function(){var a=f();a=b(a);for(var c=Object.keys(n),d=0;d<c.length;++d){var e=
c[d];e!==a&&(console.debug('removing ajax call for trial key "'+e+'"'),n[e].abort(),delete n[e])}};l(document).delegate("#shippingOptionFormId","change",function(e){e=f();if(b(e)!==m.val())a:{h(),e=d();var g=f(),k=b(g);m.val(k);var n=c(k,a.serialize());k=0;n&&++k;for(var p=0;p<e.length;++p)for(var u=a.find('input[type\x3dradio][name\x3d"'+e[p]+'"][value!\x3d"'+g[p]+'"]'),B=0;B<u.length;++B){var A=u[B];n=g.slice(0);n[p]=A.value;n=b(n);var t=A.name;A=A.value;for(var y=a.serializeArray(),J=0;J<y.length;++J)y[J].name===
t&&(y[J].value=A),"trialKey"===y[J].name&&(y[J].value=n);t=l.param(y);if((n=c(n,t))&&5===++k)break a}}});l(document).delegate("#shippingOptionFormId","submit",function(a){h()})}})});q.when("A","button-blocker","page-detector").register("scheduled-delivery-readiness-checker",function(a,l,n){function e(){n.isMobile()&&n.isSosp()&&g("div.scheduled-delivery").length&&(g(document).delegate("div."+d+":visible input[type\x3d'radio'].shipping-option","change",function(){m(g(this).closest("div."+d))}),a.on("active-shipment-changed",
m))}function k(a){b||(a.hasClass("scheduled-delivery-loading")?b=a.find(".loading-tooltip").text():a.hasClass("scheduled-delivery-picking")&&(b=a.find(".picking-tooltip").text()))}function m(a){b=null;a?k(a):g("div.one-shipment:visible div."+d+".scheduled-delivery").each(function(){var a=g(this);a.find("input").is(":checked")&&k(a)});b?l.show("scheduled-delivery",b):l.hide("scheduled-delivery")}var g=a.$,b,d=r.P&&r.P.AUI_BUILD_DATE?"selectable-box":"fake-label";if(n.isMobile())a.on("checkout:reload:shipoptionselect",
e);return{check:m}});"use strict";q.when("A","quantity-service","page-conductor","page-detector","ajax-utility","page-transition-controller","gift-utility","client-side-metrics").register("gift-form-base-controller",function(a,l,n,e,k,m,g,b){function d(a){a.is(":checked")||(Y?a.is(":checked")||a.closest("label").click():(b.increaseCount("removeauijs4"),a.attr("checked",!0).trigger("change")))}function f(a){a.attr("disabled","disabled");Y&&a.closest("div").bind("click.disable",function(a){a.stopPropagation()})}
function c(a){a.removeAttr("disabled");Y&&a.closest("div").unbind("click.disable")}function h(){q.when("a-dropdown").execute(function(a){var b=z(".select-recipient");b.empty();for(var c=0;c<C.length;c++){var d=z("\x3coption/\x3e").attr({value:C[c].value}).text(C[c].text);b.append(d)}b.each(function(){var b=z(this).closest(".gift-connection-section"),c=b.find(".include-gift-connection-checkbox").is(":checked"),d=b.find(".item-id").val(),e=b.find(".item-giftlist-type-id").val(),f;!e||"0"!==e&&"1"!==
e&&"2"!==e?e&&"3"===e&&(f=b.find(".item-giftlist-id").val()):f=e;!f&&c&&(c=b.find(".item-registry-id").val())&&X&&X[c]&&(f=X[c]);f&&(a.setValue(z(this).attr("id"),f),(e&&"1"===e||"2"===e)&&b.find(".gift-connection-recipient-extra").removeClass("aok-hidden").show(),A(d))})})}function y(){z(".gift-connection-recipient-section").unbind("click").bind("click",function(){if(!Z)return z(this).find(".select-recipient-spinner").removeClass("aok-hidden").show(),!1});z(".select-recipient").each(function(){z(this).unbind("change").bind("change",
function(){var a=z(this),b=a.next().find(".a-dropdown-prompt"),c=z("\x3cdiv/\x3e").html(a.find(":selected").text()).clone().html();setTimeout(function(){b.html(c)},0)})});q.when("a-dropdown").execute(function(a){z(".gift-connection-section").each(function(){var b=z(this),c=b.find(".item-id").val(),d=b.find(".item-giftlist-type-id").val();b.find(".item-giftlist-id").val();var e=b.find(".item-occasion-id").val(),f=b.find(".item-occasion-month").val(),h=b.find(".item-occasion-day").val(),g=b.find(".item-age").val();
b.find("#input-recipient-first-name-"+c).unbind("keyup").keyup(function(){A(c)});b.find("#input-recipient-last-name-"+c).unbind("keyup").keyup(function(){A(c)});if("1"===d||"2"===d)a.setValue(b.find(".select-recipient").attr("id"),d),b.find(".gift-connection-recipient-extra").removeClass("aok-hidden").show();a.setValue(b.find(".select-occasion").attr("id"),e);a.setValue(b.find(".select-occasion-month").attr("id"),f);a.setValue(b.find(".select-occasion-day").attr("id"),h);a.setValue(b.find(".select-occasion-age").attr("id"),
g);if("1"===e||"2"===e)b.find(".gift-connection-occasion-extra").removeClass("aok-hidden").show(),"2"===d&&b.find(".select-occasion-age-row").removeClass("aok-hidden").show();"1"!==e&&"2"!==e&&"3"!==e&&A(c)})});var a="/gp/buy/pipeline/handlers/list-of-giftlists.html",b=z(".item-registry-id").map(function(){if(z(this).val())return z(this).val()}).get().join();b&&(a+="?fromRegistryIds\x3d"+b);C?(h(),z(".select-recipient-spinner").hide(),Z=!0):(Z=!1,z.ajax({type:"POST",url:a,dataType:"json",async:!0,
cache:!1,timeout:5E3,success:function(a){!C&&a.options&&0<a.options.length&&(C=a.options);a.registryIdMapping&&(X=a.registryIdMapping);C&&h();z(".select-recipient-spinner").hide();Z=!0},error:function(a,b,c){z(".select-recipient-spinner").hide();Z=!0}}))}function v(){ba=[];a.state("giftNotificationEmailConstraints",[]);a.state("giftDeliveryDateConstraints",[]);z('[data-action\x3d"gift-form-element"]').each(function(){var a=z(this);a.is("span")?a.find("input, textarea, select:first").trigger({type:"change",
isInit:!0}):a.trigger({type:"change",isInit:!0})});z("textarea").unbind("keyup.gift-textarea click.gift-textarea").bind("keyup.gift-textarea click.gift-textarea",function(){z(this).trigger("change")});0<z(".enable-gift-connections").length&&y()}function w(a,b){var c=31;if("1"===b)c=0===a%4&&0!==a%100||0===a%400?29:28;else if("3"===b||"5"===b||"8"===b||"10"===b)c=30;return c}function x(a,b,c){a=k.jsonify(a);n.redirect(a)}function p(a){q.when("a-dropdown").execute(function(b){z(".gift-connection-recipient-extra-"+
a).hide();b.setValue("select-recipient-"+a,"0");z("#input-recipient-first-name-"+a).val("");z("#input-recipient-last-name-"+a).val("")})}function u(a){q.when("a-dropdown").execute(function(b){z(".gift-connection-occasion-extra-"+a).hide();b.setValue("select-occasion-"+a,"0");b.setValue("select-occasion-month-"+a,"0");b.setValue("select-occasion-day-"+a,"0");b.setValue("select-occasion-age-"+a,"-1");z("#occasion-has-reminder-checkbox-"+a).attr("checked",!0)})}function B(a,b){q.when("a-dropdown").execute(function(c){for(var d=
0;d<C.length;d++)b&&b===C[d].value&&C[d].bMonth&&C[d].bDay&&(c.setValue("select-occasion-month-"+a,C[d].bMonth),c.setValue("select-occasion-day-"+a,C[d].bDay))})}function A(a){q.when("a-dropdown").execute(function(b){var c=z("#select-recipient-"+a).find(":selected").val();"0"!==c&&("1"!==c&&"2"!==c||z("#input-recipient-first-name-"+a).val()||z("#input-recipient-last-name-"+a).val())?b.updateSelect("select-occasion-"+a,{status:"enabled"}):(u(a),b.updateSelect("select-occasion-"+a,{status:"disabled"}))})}
function t(a,b,c){"1"===b&&"2"===c?z("#select-occasion-age-row-"+a).removeClass("aok-hidden").show():z("#select-occasion-age-row-"+a).hide()}function N(){var a=z("#hidePricesCheckbox"),c=z("#kindle-reg-radio-your-account");Y?c.is(":checked")?z("#kindle-reg-radio-another-account").closest("label").click():a.is(":checked")||a.closest("label").click():(b.increaseCount("removeauijs6"),a.is(":checked")||a.attr("checked","checked").trigger("change"),c.is(":checked")&&(c.removeAttr("checked").trigger("change"),
z("#kindle-reg-radio-another-account").attr("checked","checked").trigger("change")))}function J(){var a=z("#hidePricesCheckbox"),c=z("#kindle-reg-radio-another-account");Y?c.is(":checked")?z("#kindle-reg-radio-your-account").closest("label").click():a.is(":checked")&&a.closest("label").click():(b.increaseCount("removeauijs7"),a.is(":checked")&&a.removeAttr("checked").trigger("change"),c.is(":checked")&&(c.removeAttr("checked").trigger("change"),z("#kindle-reg-radio-your-account").attr("checked","checked").trigger("change")))}
function Q(){z("#hidePricesCheckboxLabel").hide();var a=z("#hidePricesCheckbox");Y&&(a.is(":checked")||a.closest("label").click());a.attr("disabled",!0).hide().trigger("change");z("#kindle-reg-radio-another-account").attr("disabled",!0).trigger("change");z("#kindle-reg-radio-your-account").attr("disabled",!0).trigger("change");z("#hidePricesDisabledMessage").show();z("#hidePricesDisabledMessage").removeClass("aok-hidden");Y&&(z("label.a-touch-checkbox.hide-prices-checkbox").addClass("a-touch-selector-disabled").bind("click.disable",
function(a){a.stopPropagation()}),z("label.a-touch-radio.kindle-reg-option").addClass("a-touch-selector-disabled").bind("click.disable",function(a){a.stopPropagation()}))}function P(a){var b=!1;z(".afn-wrap-checkbox").each(function(){var a=z(this);a=a.is("input")?a:a.find("input");if(a.is(":checked"))return b=!0,!1});z(".mfn-no-wrap-radio").each(function(){var a=z(this);a=a.is("input")?a:a.find("input");if(!a.is(":checked"))return b=!0,!1});if(b)N(),Q();else if(z("#hidePricesCheckbox").is(":disabled"))z("#hidePricesCheckboxLabel").show(),
z("#hidePricesCheckbox").removeAttr("disabled").show().trigger("change"),z("#kindle-reg-radio-another-account").removeAttr("disabled").trigger("change"),z("#kindle-reg-radio-your-account").removeAttr("disabled").trigger("change"),z("#hidePricesDisabledMessage").hide(),Y&&(z("label.a-touch-checkbox.hide-prices-checkbox").removeClass("a-touch-selector-disabled").unbind("click.disable"),z("label.a-touch-radio.kindle-reg-option").removeClass("a-touch-selector-disabled").unbind("click.disable"));else if(a.is("input")||
(a=a.find("input")),"hidePricesCheckbox"===a.attr("id"))a.is(":checked")?N():J();else if("kindle-reg-radio-another-account"===a.attr("id")||"kindle-reg-radio-your-account"===a.attr("id"))z("#kindle-reg-radio-your-account").is(":checked")?J():N()}function F(a){var b=z("#giftwrap-carousel-wrap-pane-"+a+" ul li").size();b&&(z("#giftwrap-carousel-wrap-holder-"+a).css("width",90*b),z("#giftwrap-carousel-wrap-pane-"+a).css("width",90*ca));M(a)}function M(a){z("#giftwrap-carousel-wrap-holder-"+a).find("ul li, ol li").each(function(b,
c){b=z(c);b.find("input").is(":checked")&&R(b,{itemId:a})})}function R(a,b){a.parent().find(".selected-giftwrap-image").removeClass("selected-giftwrap-image");a.find(".giftwrap-carousel-item-image").addClass("selected-giftwrap-image");a.parent().find(".wrap.a-button-selected").removeClass("a-button-selected");a.addClass("a-button-selected");var c=b.itemId;b=b.wrapNo;var d=n.isSPP(),e=a.find("input[type\x3dradio]");e.attr("checked",!0);d||(d=a.data("giftwrap-id"),e.val(d).change());e=a.data("wrap-no");
d=z("#giftwrap-option-preview-imagearea-default-"+c);var f=z("#giftwrap-option-preview-imagearea-image-"+c),h=z(".selectedWrapLargeLink","#item-"+c);c=z(".wrapNo-"+c+"-"+b);a.hasClass("none-wrap")?(d.removeClass("aok-hidden"),f.addClass("aok-hidden"),h.length&&(h.addClass("aok-hidden"),h.removeClass("selectedWrapLargeLink"))):(a=a.find("img").attr("src"),f.find("img").attr("src",a),d.addClass("aok-hidden"),f.removeClass("aok-hidden"),h.length&&(h.addClass("aok-hidden"),h.removeClass("selectedWrapLargeLink")),
c.length&&(c.addClass("selectedWrapLargeLink"),c.removeClass("aok-hidden")));a=z(".selectedWrapLargeLink");c=z(".larger-image-link-carousel-"+e);a.removeClass("selectedWrapLargeLink").addClass("aok-hidden");c.removeClass("aok-hidden").addClass("selectedWrapLargeLink")}function U(a,b){var c=b.itemId;b=z("#giftwrap-option-preview-imagearea-default-"+c);c=z("#giftwrap-option-preview-imagearea-image-"+c);a.hasClass("none-wrap")?(b.removeClass("aok-hidden"),c.addClass("aok-hidden")):(a=a.find("img").attr("src"),
c.find("img").attr("src",a),b.addClass("aok-hidden"),c.removeClass("aok-hidden"))}function G(a,b){var c=b.itemId;b=z("#giftwrap-option-preview-imagearea-default-"+c);c=z("#giftwrap-option-preview-imagearea-image-"+c);if(a.parent().find(".selected-giftwrap-image").parents("li").hasClass("none-wrap"))b.removeClass("aok-hidden"),c.addClass("aok-hidden");else{var d=".selected-giftwrap-image img";n.isSPP()&&(d="img.selected-giftwrap-image");a=a.parent().find(d).attr("src");c.find("img").attr("src",a);
b.addClass("aok-hidden");c.removeClass("aok-hidden")}}function I(a,b){var c=a.find(".empty-message-warning"),d=a.find(".no-receipt-warning"),e=a.find("textarea");a=a.find(".message-counter");b&&!d.is(":visible")?(a.hide(),c.show(),e.addClass("gift-warning")):(c.hide(),e.removeClass("gift-warning"),a.show())}function V(a){var b=z("#"+a.id),c=g.getCharCount(b.val(),a.useByteSize);b=g.getLineCount(b.val(),a.maxChars/a.maxLines);return{length:c,charDelta:a.maxChars-c,lineDelta:a.maxLines-b}}function S(a,
b){b=z("#item-"+b.itemId);var c=a.is(":checked")&&!a.hasClass("mfn-no-wrap-radio");n.isSPP()&&z("#carouselGiftWrap").length&&(c=!a.hasClass("mfn-no-wrap-radio"));c?(b.find(".gift-message-pslip").hide(),b.find(".gift-message-card").show()):(b.find(".gift-message-card").hide(),b.find(".gift-message-pslip").show())}function W(b,c){var d=c.itemId;c=n.isSPP()?c.currentTab:b.data("current-tab");var e=z("#afn-gift-options-wrapper-"+d).data("active-tab");c!==e&&(b.parent().find(".selected-giftwrap-tab").removeClass("selected-giftwrap-tab"),
b.addClass("selected-giftwrap-tab"),z("#afn-gift-options-wrapper-"+d).data("active-tab",c),b="#item-"+d,e=n.isSPP()?z("#giftwrap-carousel-wrap-holder-"+d,b):b,e.length&&a.trigger("checkout:gift:changeCarouselWrapOptions",e,c,d),c=z(".none-wrap",z(b)).find("input"),c.prop("checked",!0),c.val("").change(),n.isSPP()?(c=z("#afn-gift-options-wrapper-"+d),c.length&&(c=c.data("active-tab"),a.trigger("checkout:gift:adaptCarouselGiftPanel",d,c))):a.trigger("checkout:gift:adaptCarousel",d),z("#giftwrap-carousel-wrap-holder-"+
d).removeClass("a-button-selected").find(".selected-giftwrap-image").removeClass("selected-giftwrap-image"),z("#giftwrap-carousel-item-image-"+d).addClass("selected-giftwrap-image").parents(".wrap").addClass("a-button-selected"),z("#giftwrap-option-preview-imagearea-default-"+d).removeClass("aok-hidden"),z("#giftwrap-option-preview-imagearea-image-"+d).addClass("aok-hidden"),c=z(".selectedWrapLargeLink"),c.length&&(c.addClass("aok-hidden"),c.removeClass("selectedWrapLargeLink")),c=n.isSPP(),b="#item-"+
d,z("#gift-message-noshi-warning-"+d).addClass("aok-hidden"),z("#includeMessageCheckbox-"+d).removeAttr("disabled"),c?z("#afn-message-span-"+d,z(b)).removeClass("aok-hidden"):(z("#afn-message-span",z(b)).removeClass("disable-message-area").addClass("enable-message-area"),z("#gift-message-heading-"+d).removeClass("disable-message-area").addClass("enable-message-area"),z("#message-area-"+d).removeAttr("disabled")))}var ba,ca=4,C,Z=!1,X,z=a.$,Y=r.P&&r.P.AUI_BUILD_DATE&&e.isMobile(),aa=g.getInput;a.declarative("save-gift-for-later",
["click"],function(a){m.show();a=a.$currentTarget.data("entityId")||a.data.entityId;l.call(a,0,{success:x})});q.register("gift-base/init-carousel",function(){return F});q.register("gift-base/set-carousel-size",function(){return function(a){ca=a}});var ea={toggleGiftDataAndDeliveryOptions:function(a){a=a.closest(".gift-options-wrapper");var b=aa(a.find(".includeMessageCheckbox"));b&&b.is(":checked")?(a.find(".gift-delivery-option").show(),a.find(".item-wrap-span").show(),a.find(".item-wrap-row").show(),
a.find(".item-gift-message-span").show()):(a.find(".gift-delivery-option").hide(),a.find(".item-wrap-span").hide(),a.find(".item-wrap-row").hide(),a.find(".item-gift-message-span").hide())},toggleGiftDeliveryOptions:function(a){var b=a.closest(".gift-options-wrapper");a.is("input[type\x3dcheckbox]")?a.is(":checked")?b.find(".gift-notification-email").removeClass("a-form-disabled"):b.find(".gift-notification-email").addClass("a-form-disabled"):(b.find(".gift-notification-email").removeClass("a-form-disabled"),
a=b.find(".includeMessageCheckbox"),d(a.find("input[type\x3dcheckbox]")),Y&&(a=a.find("i.a-icon"),a.length&&(a.removeClass("a-icon-checkbox-inactive"),a.removeClass("a-icon-touch-checkbox-inactive"),a.addClass("a-icon-checkbox-active"),a.addClass("a-icon-touch-checkbox-active"))))},initGiftNotificationEmail:function(b){var c=a.state("giftNotificationEmailConstraints");c.push({id:b.attr("id")});a.state("giftNotificationEmailConstraints",c)},initGiftDeliveryDate:function(b){var c=a.state("giftDeliveryDateConstraints");
b.hasClass("year-select")||(b=b.parents("div.del-opt-date-section").find("select.year-select:first"));c.push({id:b.attr("id")});a.state("giftDeliveryDateConstraints",c)},updateDateDropdown:function(a){var b=a.closest(".gift-options-wrapper");a=b.find(".month-select").val();var c=b.find(".day-select");c.val();b=b.find(".year-select").val();var d=w(b,a);if(c.hasClass("a-native-dropdown"))q.when("a-dropdown").execute(function(a){a=a.getSelect(c);if(a.getOptions().size()>d)for(var b=a.getOptions().size()-
1;b>=d;b--)a.removeOption(b);else for(b=a.getOptions().size();b<d;b++)a.addOption({text:b+1,value:b+1},b)});else{if(c.find("option").length>d)c.find("option:gt("+(d-1)+")").remove();else for(a=c.find("option").length+1;a<=d;a++)c.append(z("\x3coption\x3e",{value:a}).text(a));c.trigger("change")}},initSelectedTabAndWrapHolderWidth:F,initGiftMessage:function(a,b){Y&&!a.is("textarea")&&(a=a.find("textarea"));ba.push({id:a.attr("id"),maxChars:parseInt(b.maxChars,10),maxLines:parseInt(b.maxLines,10),useByteSize:b.useByteSize});
aa(a.closest(".gift-options-wrapper").find(".includeMessageCheckbox")).is(":checked")||a.addClass("a-form-disabled");"1"===z("#multipleAFNGiftWrapOption").val()&&(a=a.attr("id").substring(a.attr("id").lastIndexOf("-")+1,a.attr("id").size),F(a))},enforceSelectorParity:P,enforceGiftReceiptParity:function(a,b){a=z("#item-"+b.itemId);if(0!==a.length){b=a.find(".item-receipt-row label");var e=aa(a.find(".includeReceiptCheckbox")),h=a.find(".mfn-hide-price-row label"),g=aa(a.find(".mfnHidePriceCheckbox")),
k=a.find(".item-message-row label"),m=aa(a.find(".includeMessageCheckbox")).is(":checked"),p=!1;0<a.find(".afn-wrap-checkbox").length?aa(a.find(".afn-wrap-checkbox")).is(":checked")&&(p=!0):0<a.find(".mfn-no-wrap-radio").length&&(aa(a.find(".mfn-no-wrap-radio")).is(":checked")||(p=!0));if(p||m)d(e),d(g);p||m&&k.is(":visible")?(f(e),b.addClass("checkout-gift-option-disabled"),f(g),h.addClass("checkout-gift-option-disabled")):(c(e),c(g),b.removeClass("checkout-gift-option-disabled"),h.removeClass("checkout-gift-option-disabled"))}},
enforceHidePriceParity:function(a){var b=!1;z(".includeReceiptCheckbox").each(function(){if(aa(z(this)).is(":checked"))return b=!0,!1});var c=!1;z(".mfnHidePriceCheckbox").each(function(){if(aa(z(this)).is(":checked"))return c=!0,!1});b||c?(N(),z(".kindle-reg-msg-your-account").hide(),z(".kindle-reg-msg-another-account").show()):(J(),z(".kindle-reg-msg-another-account").hide(),z(".kindle-reg-msg-your-account").show())},toggleNoReceiptWarning:function(a){var c=aa(a).is(":checked"),e=a.closest(".gift-options-wrapper");
a=e.find(".no-receipt-warning");var f=e.find(".empty-message-warning");e=e.find(".item-message-row").find(".includeMessageCheckbox");var h=aa(e);c?(a.hide(),e.is(":visible")||d(h)):(f.hide(),a.show(),h.is(":checked")&&(Y?h.is(":checked")&&h.closest("label").click():(b.increaseCount("removeauijs5"),h.removeAttr("checked").trigger("change"))))},toggleMessageArea:function(a){var b=a.closest(".gift-options-wrapper");if(a.is("textarea"))b=aa(b.find(".includeMessageCheckbox")),d(b);else{a=aa(b.find(".includeMessageCheckbox")).is(":checked");
var c=b.find(".item-message-row label").is(":visible"),e=0<b.find(".empty-message-warning").length,f=b.find("textarea"),h=f.data("default-text"),g=0<f.val().length;a?(b.find(".gift-message-edit").show(),b.find(".gift-message-label").removeClass("a-color-secondary"),f.removeClass("a-form-disabled"),h&&f.val(h)):(c&&b.find(".gift-message-edit").hide(),b.find(".gift-message-label").addClass("a-color-secondary"),f.addClass("a-form-disabled"),h&&f.val(""));e&&(a&&g?I(b,!1):I(b,!0))}},toggleMessageLocationText:S,
toggleMessageBoxDisplay:function(b,e){var h=z("#item-"+e.itemId);if(0!==h.length){var g=h.find(".item-message-row");e=h.find(".item-receipt-row");var k=h.find(".gift-message-on-card"),m=h.find(".gift-message-on-receipt"),p=g.find("label");g=aa(g.find(".includeMessageCheckbox"));var n=a.trim(h.find(".gift-message-default-placeholder").text()),l=a.trim(h.find(".gift-message-with-wrap-placeholder").text());h=h.find("textarea");var t=b.hasClass("mfn-no-wrap-radio")||b.closest("div").hasClass("mfn-no-wrap-radio");
aa(b).is(":checked")&&!t?(m.hide(),k.show(),h.attr("placeholder",l),e.is(":visible")&&(d(g),p.is(":visible")&&(f(g),p.addClass("checkout-gift-option-disabled")))):(k.hide(),m.show(),h.attr("placeholder",n),c(g),p.removeClass("checkout-gift-option-disabled"))}},updateContinueButtons:function(){for(var b=!0,c,d=0;d<ba.length;d++)if(c=z("#"+ba[d].id),c.closest(".gift-options-wrapper").find(".includeMessageCheckbox").find('input[type\x3d"checkbox"]').is(":checked")&&(c=V(ba[d]),0>c.charDelta||0>c.lineDelta))b=
!1;b?(z(".save-gift-button-box span.a-button-primary:not(.a-button-disabled)").show(),z(".save-gift-button-box span.a-button-disabled").hide()):(z(".save-gift-button-box span.a-button-primary:not(.a-button-disabled)").hide(),b=z(".save-gift-button-box span.a-button-disabled"),b.removeClass("aok-hidden"),b.show());a.trigger("orderSummary:primaryActionButton:mirrorPanelBtnState")},updateMessageCounter:function(a){Y&&!a.is("textarea")&&(a=a.find("textarea"));for(var b,c=0;c<ba.length;c++)a.attr("id")===
ba[c].id&&(b=V(ba[c]));if(b){a=a.closest(".gift-options-wrapper");c=a.find(".message-counter");c.find(".remaining-count").hide();if(0<a.find(".empty-message-warning").length){if(0===b.length){I(a,!0);return}I(a,!1)}(-1>b.charDelta?c.find(".remaining-char-over-multiple").show():0>b.charDelta?c.find(".remaining-char-over-single").show():1===b.charDelta?c.find(".remaining-char-single").show():c.find(".remaining-char-multiple").show()).find(".chars-remaining").html(Math.abs(b.charDelta));(-1>b.lineDelta?
c.find(".remaining-line-over-multiple").show():0>b.lineDelta?c.find(".remaining-line-over-single").show():1===b.lineDelta?c.find(".remaining-line-single").show():c.find(".remaining-line-multiple").show()).find(".lines-remaining").html(Math.abs(b.lineDelta));c.show()}},updateSelectedGiftWrap:R,clearGiftConnection:function(a,b){z("#include-gift-connection-checkbox-"+b.itemId).is(":checked")||(p(b.itemId),A(b.itemId))},toggleGiftConnectionAgeDropdown:t,toggleGiftConnectionRecipientArea:function(a,b){a=
z("#select-recipient-"+b.itemId).find(":selected").val();var c=z("#select-occasion-"+b.itemId).find(":selected").val();!a||"1"!==a&&"2"!==a?(z(".gift-connection-recipient-extra-"+b.itemId).hide(),"1"===c&&a&&B(b.itemId,a)):z(".gift-connection-recipient-extra-"+b.itemId).removeClass("aok-hidden").show();t(b.itemId,c,a);A(b.itemId)},toggleGiftConnectionOccasionArea:function(a,b){a=z("#select-occasion-"+b.itemId).find(":selected").val();var c=z("#select-recipient-"+b.itemId).find(":selected").val();
!a||"1"!==a&&"2"!==a?z(".gift-connection-occasion-extra-"+b.itemId).hide():("1"===a&&c&&"1"!==c&&"2"!==c&&B(b.itemId,c),z(".gift-connection-occasion-extra-"+b.itemId).removeClass("aok-hidden").show());t(b.itemId,a,c)},includeGiftConnection:function(a,b){(a=z("#select-recipient-"+b.itemId).find(":selected").val())&&"0"===a||z("#include-gift-connection-checkbox-"+b.itemId).attr("checked",!0)},updateGiftOptionsTabSelection:W,updatePreviewImageOnMouseEnter:U,updatePreviewImageOnMouseLeave:G,toggleGiftMessageWarning:function(a){var b=
z("#"+a.attr("id"));g.toggleGiftMessageWarning(b,a.closest(".item-gift-message-span"))}};a.declarative("gift-form-element",["change"],function(a){var b=a.$event.isInit?a.data.onInit||[]:a.data.onChange||[];for(var c=0;c<b.length;c++)if(ea[b[c]])ea[b[c]](a.$target,a.data)});a.declarative("gift-form-element","click mouseenter mouseleave",function(a){var b;if(b=a.data[{click:"onClick",mouseenter:"mouseEnter",mouseleave:"mouseLeave"}[a.type]])for(var c=0;c<b.length;c++)if(ea[b[c]])ea[b[c]](a.$currentTarget,
a.data,a)});a.declarative("select-gift-wrap","click",function(a){R(a.$target.parents("li"),{itemId:a.data.itemId,wrapNo:a.data.wrapNo});P(a.$target);var b=a.$target.parents("li").find(".gift-hidden-radio");S(b,{itemId:a.data.itemId})});a.declarative("select-gift-wrap","mouseenter",function(a){U(a.$target.parents("li"),a.data)});a.declarative("select-gift-wrap","mouseleave",function(a){G(a.$target.parents("li"),a.data)});a.declarative("update-gift-options-tab-selection",["click"],function(a){var b=
a.$target.parents("li");b.attr("data",a.data);W(b,a.data)});a.on("checkout:reload:giftselect",v);a.on("checkout:reload:spp-giftoptions",v);return{extendFunctions:function(a){z.extend(ea,a)}}});"use strict";q.when("A","page-transition-controller","page-conductor").register("gift-form-del-opt-controller",function(a,l,n){function e(a){var b=a.closest(".expando-box");b&&(b=b.find(".a-expander-header"),a.closest(".expando-content").is(":hidden")&&b.click())}function k(a){var b=a.closest(".gift-options-wrapper"),
c=b.find(".includeMessageCheckbox").find('input[type\x3d"checkbox"]');if(c&&!c.is(":checked"))return!0;c=b.find(".email-error-selector");b.find(".gift-notification-email-error").hide();c.removeClass("a-form-error");if(64<r.unescape(encodeURIComponent(a.val())).length)return c.addClass("a-form-error"),b.find(".gift-notification-email-length-exceeded-error").removeClass("aok-hidden").show(),!1;if(/^\S+[@]\S+[.]\S+$/.test(a.val()))return!0;c.addClass("a-form-error");b.find(".gift-notification-invalid-email-error").removeClass("aok-hidden").show();
return!1}function m(){b("#giftForm").find(".save-gift-button-box span.a-button-primary:not(.a-button-disabled)").unbind("click").bind("click",function(a){a.preventDefault();g(a)});b(".checkout-gift-image-preview-trigger \x3e a").show();b("#gift-kindle-imb").show()}function g(d){d=b("#giftForm");var f=d.find('input[name\x3d"hidePrices"]'),c=f.is(":disabled");c&&f.removeAttr("disabled");for(var h=!0,g=a.state("giftNotificationEmailConstraints"),m=a.state("giftDeliveryDateConstraints"),w=0;w<g.length;w++){var x=
b("#"+g[w].id);k(x)||(h=!1,e(x))}for(g=0;g<m.length;g++){w=b("#"+m[g].id);x=w.closest(".gift-options-wrapper");var p=x.find(".includeMessageCheckbox").find('input[type\x3d"checkbox"]');if(p&&!p.is(":checked"))x=!0;else{var u=x.find(".month-select").val(),B=x.find(".day-select").val();p=x.find(".year-select");var A=p.val(),t=x.find("#current-date").val().split("-");u=new Date(A,u,B);t=new Date(t[0],t[1]-1,t[2]);B=new Date(t.getTime());B.setMonth(B.getMonth()+12);x.find(".gift-delivery-date-error").hide();
A=x.find(".date-error-selector");p=p.hasClass("a-native-dropdown")?"error-border a-form-error":"a-form-error";A.removeClass(p);u>=B||u<t?(x.find(".gift-delivery-date-error").removeClass("aok-hidden").show(),A.addClass(p),x=!1):x=!0}x||(h=!1,e(w))}a.state("continueAction",{enable:h});if(a.state("continueAction").enable)n.isSPP()||l.showPageTransition(),d.submit();else return b("html, body").animate({scrollTop:b(".a-form-error").closest("div").offset().top},500),!1;c&&f.attr("disabled",!0)}var b=a.$;
a.declarative("submit-gift-options","click",function(a){g(a)});a.declarative("discard-gift-options","click",function(a){b('#giftForm input[type\x3d"checkbox"]').prop("checked",!1);b("#giftForm textarea").addClass("a-form-disabled");g(a)});a.on("checkout:reload:giftselect",m);a.on("checkout:reload:spp-giftoptions",m)});"use strict";q.when("A").register("teen-message-controller",function(a){var l=a.$;a.declarative("teen-message-form-element","click keyup",function(a){a=a.data.maxChars;var e=l("#teen-message-box").val(),
k=e.match(/(\r\n|\n|\r)/g),m=0;k&&(m=k.length);e=e.length+m;l(".remaining-char").text(Math.max(a-e,0))});l("#aui-teen-message-box").length&&l(".remaining-char").length&&q.when("A").execute(function(a){function e(a){a=a.val();var b=(a.match(/(\r\n|\n|\r|\n\r)/g)||{}).length||0;return a.length+b}a=a.$;var k=a("#aui-teen-message-box");k.bind("change keypress",function(a){return e(k)>=g?(a.preventDefault(),!1):!0});k.bind("paste",function(a){if(a&&a.originalEvent&&a.originalEvent.clipboardData&&a.originalEvent.clipboardData.getData("Text")){var b=
a.originalEvent.clipboardData.getData("Text"),f=e(k);if(f+b.length>=g)return b=b.substring(0,g-f),b=k.val()+b,k.attr("value",b),a.preventDefault(),!1}return!0});k.bind("click keyup",function(){var a=Math.max(g-e(k),0);m.text(a)});var m=a(".remaining-char");var g=k.parent().data("maxchars")})});"use strict";q.when("A","page-transition-controller","page-conductor","loading-spinner-controller","client-side-metrics").register("concealment-form-del-opt-controller",function(a,l,n,e,k){function m(a){var d=
b("#concealmentForm");d.find("input:checked").length?(a=a.data.saveConcealmentRefTag,k.increaseCount("CPEX.Checkout.Select.Concealment",1)):(a=a.data.cancelConcealmentRefTag,k.increaseCount("CPEX.Checkout.Cancel.Concealment",1));d.find("input[name\x3dref]").val(a);d.attr("action",d.attr("action")+"/ref\x3d"+a)}function g(a){a=b("#concealmentForm");n.isSPP()||l.showPageTransition();a.submit()}var b=a.$;a.declarative("submit-concealment-options","click",function(a){m(a);g(a)});a.declarative("discard-concealment-options",
"click",function(a){b('#concealmentForm input[type\x3d"checkbox"]').prop("checked",!1);m(a);g(a)});a.declarative("submit-concealment-form","click",function(a){m(a);a.$target.closest(".a-button").addClass("a-button-disabled");e.showSpinner(a.$target.closest("form"))})});"use strict";q.when("A","page-transition-controller","page-conductor","address-popovers","checkout-general-utils","a-popover","client-side-metrics","weblab-helper","ajax-utility").register("itemselect-address-controller",function(a,
l,n,e,k,m,g,b,d){function f(){v(".lineitem").each(function(a,b){a=v(b);a.find(".no-js-address-dropdown").remove();a.find(".no-js-address-select").remove();a.find(".js-address-dropdown").prop("disabled",!1);a.find(".address-dropdown").removeClass("a-button-disabled")});v("#suppressAddAddressPopover").val()&&v('select[name^\x3d"addressID."]').find("option").each(function(){var a=v(this);"New"===a.val()&&a.closest("optgroup").remove()})}function c(a){var c=(new Date).getTime(),e=n.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});
b.isHeadersCleaned()?v.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-address\x26cachebuster\x3d"+c,data:a,dataType:"text",headers:e,error:n.ajaxRedirect,success:function(a,b,c){var e=c.getResponseHeader("x-amz-checkout-fatal-error");if(null!==e&&e!==G)r.location=e;else if(h(a)){a=d.jsonify(a);y(a,c);c=u.find('input[name^\x3d"previousAddress."]');if(null!==c||c!==G)var f=x||c.val();var g=u.find('select[name^\x3d"addressID."]');null===g&&g===G||q.when("a-dropdown").execute(function(a){a.setValue(g.attr("id").replace(/\./g,
"\\."),f);g.find("option").removeAttr("selected");g.find('option[value\x3d"'+f+'"]').attr("selected","selected")});l.hide()}else n.ajaxUpdatePage(a,b,c),k.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")}}):v.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-address\x26cachebuster\x3d"+c,data:a,dataType:"text",headers:e,error:n.ajaxRedirect,success:function(a,b,c){var d=c.getResponseHeader("x-amz-checkout-fatal-error");if(null!==d&&d!==G)r.location=
d;else if(h(c)){y(a,c);a=u.find('input[name^\x3d"previousAddress."]');if(null!==a||a!==G)var e=x||a.val();var f=u.find('select[name^\x3d"addressID."]');null===f&&f===G||q.when("a-dropdown").execute(function(a){a.setValue(f.attr("id").replace(/\./g,"\\."),e);f.find("option").removeAttr("selected");f.find('option[value\x3d"'+e+'"]').attr("selected","selected")});l.hide()}else n.ajaxUpdatePage(a,b,c),k.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")}})}function h(a){if(b.isHeadersCleaned()){if(a=
d.jsonify(a))var c=a.showAddonWarning}else c=a.getResponseHeader("x-amz-checkout-show-addon-warning");return null!==c&&c!==G}function y(a,c){b.isHeadersCleaned()?(c=a.showAddonWarning,a=a.asins):c=c.getResponseHeader("x-amz-checkout-show-addon-warning");v(".item-list").hide();a.trim().split(",").forEach(function(a){v('[data-asin\x3d"'+a+'"]').show()});a=v("#addon-warning-"+c+"-launcher");a.length&&(v(".delete-title").hide(),v(".reduce-title").hide(),v(".select-address-title").show(),v("input[name\x3duseLiveAUI]").length?
m.get(a).attrs({$trigger:p,position:"triggerHorizontal"}).show():(c=v.Event("keyup",{triggerPositioningElement:p,manualTrigger:!0}),a.trigger(c)))}var v=a.$,w,x,p,u;a.declarative("itemselect-get-address",["click","touchend"],function(a){k.protectAgainstDoubleAction("itemselect-get-address",200)||(x=a.$currentTarget.find(".js-address-dropdown").val())});a.declarative("itemselect-update-address",["change"],function(a){if(!k.protectAgainstDoubleAction("itemselect-update-address",200)){g.resetMetrics();
var b=a.$currentTarget.is("select")?a.$currentTarget:a.$currentTarget.find("select");w=b.val();if("New"===w)e.actionTriggerPopoverFromDropdown(a),q.when("a-dropdown").execute(function(a){a.setValue(b.attr("id").replace(/\./g,"\\."),x)});else{l.show();u=b.closest(".lineitem");var d,f;if(u){var h=u.find('input[name^\x3d"lineItemEntityID."]');h&&(d=h.val());(h=u.find('input[name^\x3d"quantity."]'))&&(f=h.val());(h=u.find(".js-address-dropdown"))&&(w=h.val())}p=a.$currentTarget.is("select")?a.$currentTarget.closest(".address-dropdown"):
a.$currentTarget;a=0;h=v("#addon-indicator");h.length&&"true"===h.attr("data-has-addon-items")&&(a=1);c({lineitems:d,addresses:w,quantities:f,isTrial:a})}}});a.declarative("itemselect-update-pantry-address",["change"],function(a){if(!k.protectAgainstDoubleAction("itemselect-update-pantry-address",200)){w=a.$currentTarget.val();l.show();var b="";a=a.$currentTarget.closest(".pantry-row");v(a).find(".pantry-item").each(function(a,c){a=v(c);b+="lineitems\x3d"+a.find('input[name^\x3d"lineItemEntityID."]').val()+
"\x26";b+="addresses\x3d"+w+"\x26";b+="quantities\x3d"+a.find('input[name^\x3d"quantity."]').val()+"\x26"});c(b)}});a.declarative("addon-delete-items",["click","touchend"],function(a){if(p!==G&&null!==p&&!k.protectAgainstDoubleAction("itemselect-delete-addons",200)){v(".a-button-close").trigger("click");l.show();a=(new Date).getTime();var b=v("#useCase").val(),c=n.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"}),d=u.find('input[name^\x3d"lineItemEntityID."]').val(),e=u.find('input[name^\x3d"quantity."]').val();
v.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-address\x26cachebuster\x3d"+a,data:{lineitems:d,addresses:w,quantities:e,isTrial:0,deleteAddons:1,returnHTML:1,useCase:b},headers:c,error:n.ajaxRedirect,success:function(a,b,c){var d=c.getResponseHeader("x-amz-checkout-redirect-to-cart");null!==d&&d!==G?r.location=d:(d=c.getResponseHeader("x-amz-checkout-fatal-error"),null!==d&&d!==G?r.location=d:(n.ajaxUpdatePage(a,b,c),k.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")))}})}});
a.on("checkout:reload:itemselect",f);a.on("checkout:reload:spp-itemselect",f)});"use strict";q.when("A","page-transition-controller","page-conductor","checkout-general-utils","a-popover","client-side-metrics","weblab-helper","ajax-utility").register("itemselect-delete-controller",function(a,l,n,e,k,m,g,b){function d(a,b){f(a,null===b||b===G?a.$currentTarget.closest(".lineitem"):b)}function f(a,b){a.$event.preventDefault();if(!e.protectAgainstDoubleAction("itemselect-delete-single-item",200)){m.resetMetrics();
l.show();x=b;u=a.$currentTarget.is("select")?a.$currentTarget.closest(".quantity-dropdown"):a.$currentTarget;a=x.find('input[name^\x3d"lineItemEntityID."]').val();b=0;(new Date).getTime();var c=w("#addon-indicator");c.length&&"true"===c.attr("data-has-addon-items")&&(b=1);h({lineitems:a,isTrial:b})}}function c(a,b){a.$event.preventDefault();if(!e.protectAgainstDoubleAction("itemselect-delete-multiple-items",200)){l.show();p=b;u=a.$currentTarget;var c="";a=0;b=w("#addon-indicator");b.length&&"true"===
b.attr("data-has-addon-items")&&(a=1);b=p.hasClass("pantry-row")?!0:!1;p.find(b?".pantry-item":".lineitem").each(function(a,b){c+="lineitems\x3d"+w(b).find('input[name^\x3d"lineItemEntityID."]').val()+"\x26"});h(c+"isTrial\x3d"+a)}}function h(a){var b=(new Date).getTime(),c=w('input[name\x3d"useCase"]').val(),d=n.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});w.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3ddelete\x26useCase\x3d"+c+"\x26cachebuster\x3d"+
b,data:a,dataType:"text",headers:d,error:n.ajaxRedirect,success:y})}function y(a,c,d){var f=d.getResponseHeader("x-amz-checkout-redirect-to-cart");null!==f&&f!==G?(r.location=f,f=!0):f=!1;if(!f)if(f=d.getResponseHeader("x-amz-checkout-fatal-error"),null!==f&&f!==G)r.location=f;else{if(g.isHeadersCleaned()){if(f=b.jsonify(a))var h=f.showAddonWarning}else h=d.getResponseHeader("x-amz-checkout-show-addon-warning");h=null!==h&&h!==G?!0:!1;h?(v(a,d),l.hide()):(n.ajaxUpdatePage(a,c,d),e.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"))}}
function v(a,c){g.isHeadersCleaned()?(a=b.jsonify(a),c=a.showAddonWarning,a=a.asins):c=c.getResponseHeader("x-amz-checkout-show-addon-warning");w(".item-list").hide();a.trim().split(",").forEach(function(a){w('[data-asin\x3d"'+a+'"]').show()});a=w("#addon-warning-"+c+"-launcher");a.length&&(w(".delete-title").show(),w(".reduce-title").hide(),w(".select-address-title").hide(),w("input[name\x3duseLiveAUI]").length?k.get(a).attrs({$trigger:u,position:"triggerHorizontal"}).show():(c=w.Event("keyup",{triggerPositioningElement:u,
manualTrigger:!0}),a.trigger(c)))}var w=a.$,x,p,u;a.declarative("itemselect-delete-item",["click","touchend"],d);a.declarative("itemselect-delete-item-row",["click","touchend"],function(a){c(a,a.$currentTarget.closest(".item-row"))});a.declarative("addon-delete-items",["click","touchend"],function(a){if(u!==G&&!e.protectAgainstDoubleAction("itemselect-delete-addons",200)){w(".a-button-close").trigger("click");l.show();var b="";null!==p&&p!==G?(a=p.hasClass("pantry-row")?p.find(".pantry-item"):p.find(".lineitem"),
w(a).each(function(a,c){b+="lineitems\x3d"+w(c).find('input[name^\x3d"lineItemEntityID."]').val()+"\x26"})):null!==x&&x!==G&&(b+="lineitems\x3d"+x.find('input[name^\x3d"lineItemEntityID."]').val()+"\x26");h(b+"isTrial\x3d0\x26deleteAddons\x3d1")}});a.declarative("itemselect-delete-pantry-item",["click","touchend"],function(a){f(a,a.$currentTarget.closest(".pantry-item"))});a.declarative("itemselect-delete-pantry",["click","touchend"],function(a){c(a,a.$currentTarget.closest(".pantry-row"))});a.declarative("itemselect-delete-popover-item",
["click","touchend"],function(a){var b=a.$currentTarget.data("entityidtodelete");c(a,w('a[data-entityid\x3d"'+b+'"]').closest(".item-row"))});return{actionDeleteItem:d}});"use strict";q.when("A","page-transition-controller","page-conductor","itemselect-delete-controller","checkout-general-utils","a-popover","client-side-metrics","weblab-helper","ajax-utility").register("itemselect-quantity-controller",function(a,l,n,e,k,m,g,b,d){function f(){p(".lineitem, .pantry-item").each(function(a,b){a=p(b);
a.find(".no-js-quantity").remove();b=a.find(".quantity-dropdown");b.is(":visible")?(a.find(".js-select").prop("disabled",!1),b.removeClass("a-button-disabled")):(a=a.find(".quantity-input"),a.prop("disabled",!1),a.removeClass("a-form-disabled"))})}function c(a){a.find(".quantity-input").val(a.find('input[name^\x3d"previousQuantity."]').val())}function h(a){var b=a.$currentTarget.closest(".quantity-text-field").find(".update-quantity-link"),d=a.$currentTarget.is("input")?a.$currentTarget.val():a.$currentTarget.find("input").val();
var e="itemselect-show-update-pantry-button"===a.action?".pantry-item":".lineitem";0===parseInt(d,10)||""===d?("change"===a.type&&c(a.$currentTarget.closest(e)),b.hide()):(a=a.$currentTarget.closest(e).find('input[name^\x3d"previousQuantity."]').val(),d!==a?b.show():b.hide())}function y(a){a.$event.preventDefault();if(!k.protectAgainstDoubleAction("itemselect-update-quantity",200)){g.resetMetrics();A=a.$currentTarget.closest("itemselect-update-pantry-quantity"===a.action||"itemselect-update-pantry-quantity-text-field"===
a.action?".pantry-item":".lineitem");var f=A.find(".js-address-dropdown").val(),h=a.$currentTarget.find("select"),m=h.length?h:a.$currentTarget;u=m.is("select")?m.val():A.find(".quantity-input").val();if(0===parseInt(u,10)||""===u)c(A);else if("Delete"===u)q.when("a-dropdown").execute(function(a){a.setValue(m.attr("id").replace(/\./g,"\\."),B)}),e.actionDeleteItem(a,A);else{l.show();a=A.find('input[name^\x3d"lineItemEntityID."]').val();h=0;var y=(new Date).getTime(),N=p("#useCase").val(),R=p("#addon-indicator");
t=m.is("select")?m.parent():A.find(".quantity-input");R.length&&"true"===R.attr("data-has-addon-items")&&(h=1);R=n.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});b.isHeadersCleaned()?p.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-quantity\x26cachebuster\x3d"+y,data:{lineitems:a,quantities:u,address:f,isTrial:h,returnHTML:1,useCase:N},dataType:"text",headers:R,error:n.ajaxRedirect,success:function(a,b,c){var e=c.getResponseHeader("x-amz-checkout-fatal-error");
null!==e&&e!==G?r.location=e:w(a)?(a=d.jsonify(a),x(a,c),v(B===G?A.find('input[name^\x3d"previousQuantity."]').val():B,c),l.hide()):(n.ajaxUpdatePage(a,b,c),k.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"))}}):p.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-quantity\x26cachebuster\x3d"+y,data:{lineitems:a,quantities:u,address:f,isTrial:h,returnHTML:1,useCase:N},dataType:"text",headers:R,error:n.ajaxRedirect,success:function(a,b,c){var d=c.getResponseHeader("x-amz-checkout-fatal-error");
null!==d&&d!==G?r.location=d:w(c)?(x(a,c),v(B===G?A.find('input[name^\x3d"previousQuantity."]').val():B,c),l.hide()):(n.ajaxUpdatePage(a,b,c),k.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"))}})}}}function v(a,b){10>a?(q.when("a-dropdown").execute(function(b){var c=A.find('select[name^\x3d"quantity."]');b.setValue(c.attr("id").replace(/\./g,"\\."),a);c.find("option").removeAttr("selected");c.find('option[value\x3d"'+a+'"]').attr("selected","selected")}),A.find(".quantity-dropdown").show(),
A.find(".quantity-text-field").hide(),A.find(".js-select").prop("disabled",!1),A.find(".quantity-input").prop("disabled",!0)):(A.find(".quantity-dropdown").hide(),A.find(".quantity-text-field").show(),A.find(".update-quantity-link").hide(),A.find(".js-select").prop("disabled",!0),A.find(".quantity-input").prop("disabled",!1));A.find(".quantity-input").val(a);A.find('input[name^\x3d"previousQuantity."]').val(a)}function w(a){if(b.isHeadersCleaned()){if(a=d.jsonify(a))var c=a.showAddonWarning}else c=
a.getResponseHeader("x-amz-checkout-show-addon-warning");return null!==c&&c!==G?!0:!1}function x(a,c){b.isHeadersCleaned()?(c=a.showAddonWarning,a=a.asins):c=c.getResponseHeader("x-amz-checkout-show-addon-warning");p(".item-list").hide();a.trim().split(",").forEach(function(a){p('[data-asin\x3d"'+a+'"]').show()});a=p("#addon-warning-"+c+"-launcher");a.length&&0<a.length&&(p(".reduce-title").show(),p(".delete-title").hide(),p(".select-address-title").hide(),p("input[name\x3duseLiveAUI]").length?m.get(a).attrs({$trigger:t}).show():
(c=p.Event("keyup",{triggerPositioningElement:t,manualTrigger:!0}),a.trigger(c)))}var p=a.$,u,B,A,t;a.declarative("itemselect-get-quantity",["click","touchend"],function(a){k.protectAgainstDoubleAction("itemselect-get-quantity",200)||a.$currentTarget.find("select").length&&(B=a.$currentTarget.find("select").val())});a.declarative("itemselect-update-quantity",["change"],y);a.declarative("itemselect-update-pantry-quantity",["change"],y);a.declarative("addon-delete-items",["click","touchend"],function(a){if(t!==
G&&!k.protectAgainstDoubleAction("itemselect-delete-addons",200)){p(".a-button-close").trigger("click");l.show();a=A.find('input[name^\x3d"lineItemEntityID."]').val();var b=(new Date).getTime(),c=p("#useCase").val(),d=n.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});p.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-quantity\x26cachebuster\x3d"+b,data:{lineitems:a,quantities:u,isTrial:0,deleteAddons:1,returnHTML:1,useCase:c},headers:d,error:n.ajaxRedirect,
success:function(a,b,c){var d=c.getResponseHeader("x-amz-checkout-redirect-to-cart");null!==d&&d!==G?r.location=d:(d=c.getResponseHeader("x-amz-checkout-fatal-error"),null!==d&&d!==G?r.location=d:(n.ajaxUpdatePage(a,b,c),k.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")))}})}});a.declarative("itemselect-sanitize-input",["keydown"],function(a){k.limitInputToNumbers(a)});a.declarative("itemselect-update-quantity-text-field",["click","touchend"],y);a.declarative("itemselect-update-pantry-quantity-text-field",
["click","touchend"],y);a.declarative("itemselect-show-update-button",["change","keyup"],h);a.declarative("itemselect-show-update-pantry-button",["change","keyup"],h);a.on("checkout:reload:itemselect",f);a.on("checkout:reload:spp-itemselect",f)});"use strict";q.when("A","page-transition-controller","page-conductor","checkout-general-utils","client-side-metrics").register("itemselect-ship-to-multiple-controller",function(a,l,n,e,k){var m=a.$;a.declarative("itemselect-ship-to-multiple",["click","touchend"],
function(a){a.$event.preventDefault();k.resetMetrics();if(!e.protectAgainstDoubleAction("itemselect-ship-to-multiple",200)){l.show();var b=null,d=null,f=null;a.$currentTarget.closest(".item-row").find(".lineitem").each(function(a,c){a=m(c);c=a.find('select[name^\x3d"quantity."]');var e=a.find('input[type\x3d"number"]');if(a.find(".quantity-dropdown").is(":visible")&&1<c.val())return b=a.find('input[name^\x3d"lineItemEntityID."]').val(),d=c.val(),f=a.find(".js-address-dropdown").val(),!1;if(a.find(".quantity-text-field").is(":visible")&&
1<e.val())return b=a.find('input[name^\x3d"lineItemEntityID."]').val(),d=e.val(),f=a.find(".js-address-dropdown").val(),!1});if(null!==b){a=(new Date).getTime();var c=n.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});m.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dship-to-multiple\x26cachebuster\x3d"+a,data:{lineitem:b,quantity:d,address:f},headers:c,dataType:"text",error:n.ajaxRedirect,success:function(a,b,c){var d=c.getResponseHeader("x-amz-checkout-fatal-error");
null!==d&&d!==G?r.location=d:(n.ajaxUpdatePage(a,b,c),e.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"))}})}}})});"use strict";q.when("A").register("safe-apx-helper",function(a){var l={},n=a.$;return{get:function(a){return l[a]},set:function(){1===arguments.length?l=n.extend(l,arguments[0]):2===arguments.length?l[arguments[0]]=arguments[1]:r.console&&r.console.error&&r.console.error("Unexpected number of arguments: %d. Expected 1 or 2.",arguments.length)}}});"use strict";q.when("A",
"weblab-helper").register("mobile-carrier-billing-util",function(a,l){var n=!1;return{determineIsMCBEnabled:function(a){n=0<a.paymentRows.find('input[type\x3d"radio"][name\x3dpaymentMethod]').filter("[value^\x3dMCB]").size()},toggleGCForMCB:function(a,k){if(!l.isMCBMultiTenderWeblabEnabled()&&n&&(a=a.find('input[type\x3d"radio"][name\x3dpaymentMethod]'),a.length)){var e=k.paymentRows.find('input[type\x3d"checkbox"][name\x3duseAvailableBalance]');e=k.existingBalance||e;var g=0<k.paymentRows.find('input[type\x3d"hidden"][name\x3d"gcBalance"]').length,
b="paymentsForm"in k&&0<k.paymentsForm.find('input[type\x3d"hidden"][name\x3d"gcBalance"]').length;g=g||b;0<a.filter("[value^\x3dMCB]").size()&&g?(e.length&&(e.prop("checked",!1),e.prop("disabled",!0)),k.mcbBalanceWarning&&k.mcbBalanceWarning.show()):(e.length&&e.prop("disabled",!1),k.mcbBalanceWarning&&k.mcbBalanceWarning.hide())}},showMCBWarningMessageForPoints:function(a){n&&a.mcbPointsWarning&&a.mcbPointsWarning.show()},hideMCBWarningMessageForPoints:function(a){n&&a.mcbPointsWarning&&a.mcbPointsWarning.hide()}}});
"use strict";q.when("A").register("emi-utils",function(a){return{}});"use strict";q.when("A").register("emi-helper",function(a){return{}});"use strict";q.when().register("instant-bank-discount-helper",function(){return{showInstantBankDiscountAmazonPayDeselected:function(){},showInstantBankDiscountAmazonPaySelected:function(){}}});"use strict";q.when("A","page-detector","checkout-general-utils").register("pay-common-lib",function(a,l,n){function e(a,b){b.attr("name")&&(a[b.attr("name")]=b.val());b.attr("id")&&
(a[b.attr("id")]=b.val())}function k(a,b){if(!b)return a;for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function m(a,b,d){g.each(b,function(b,c){a[b]=d?d.find(c):g(c)})}var g=a.$,b="checkbox hidden password radio text number tel month".split(" "),d={};a.declarative("move-to-next-field",["keypress"],function(a){13===a.$event.charCode&&(n.moveToNextInput(a.$declarativeParent),a.$event.preventDefault())});a.declarative("scroll-to-input",["keypress"],function(a){13===a.$event.charCode&&(g(r).scrollTop(a.$declarativeParent.offset().top),
a.$event.preventDefault())});return{getAttributeData:function(a,b){if(a)return a.attr(b)||a.attr("data-"+b)||a.data(b)},getElements:function(a,b){var c={};m(c,a,b);return c},getInputValues:function(a){var c=a.find(".data-row").data()||{};a.find("input").each(function(){var a=g(this),d=a.attr("type");("radio"!==d&&"checkbox"!==d||a.is(":checked"))&&-1<g.inArray(d,b)&&e(c,a)});a.find("select").each(function(){e(c,g(this))});return c},isDesktopCX:l.isDesktopPayment,isMobileCX:l.isMobilePayment,isPayPage:l.isPayment,
isTouchCX:l.isTabletPayment,mergeFrom:function(a,b){b=k({},b);return k(b,a)},prop:function(a,b,e){if(a){if(1<arguments.length)return b===G?delete d[a]:d[a]={isOneTime:e?1:0,value:b},b;var c=d[a];if(c)return c.isOneTime&&delete d[a],c.value}},refreshElements:m,scrollTopTo:function(a){a&&a.length&&g("html,body").animate({scrollTop:a.offset().top-20},"fast")},selectDefaultPaymentMethodIfNotSelected:function(){var a=g("#existing-payment-methods .payment-row").find('input[type\x3d"radio"][name\x3d"paymentMethod"]'),
b=a.closest("div.payment-selected");b&&0<b.length||(a=a.closest("div.default-payment-marker"))&&a.length&&(a.addClass("payment-selected"),a.find("[name\x3dpaymentMethod]").attr("checked",!0))},processSubmissionParameters:function(a){for(var b={},d=0;d<a.length;d++)b[a[d].name]=a[d].value;return b}}});"use strict";q.when("A","pay-common-lib","a-popover-base","ajax-utility","loading-spinner-controller","page-conductor","page-transition-controller").register("pay-desktop-util",function(a,l,n,e,k,m,g){function b(a){a.$event.preventDefault();
a.$target.closest(".a-popover").hide();a.$target.siblings("span.error-message").hide()}function d(a){a.preventDefault();var b=B(a.currentTarget),c=b.closest("div.expando-section");a=c.find("div.expando-content");c=c.find("div.expando-reverse-content");var d=a.is(":visible"),e=function(){var a=b.find("i");a.hasClass("a-icon-collapse")||a.hasClass("a-icon-expand")?d?(a.removeClass("a-icon-collapse").addClass("a-icon-expand"),b.find("div.expando-toggle-text-show").show(),b.find("div.expando-toggle-text-hide").hide()):
(a.removeClass("a-icon-expand").addClass("a-icon-collapse"),b.find("div.expando-toggle-text-show").hide(),b.find("div.expando-toggle-text-hide").show()):d?(a.removeClass("a-icon-section-collapse").addClass("a-icon-section-expand"),b.find("div.expando-toggle-text-show").show(),b.find("div.expando-toggle-text-hide").hide()):(a.removeClass("a-icon-section-expand").addClass("a-icon-section-collapse"),b.find("div.expando-toggle-text-show").hide(),b.find("div.expando-toggle-text-hide").show())};d?(c.slideDown("fast"),
a.slideUp("fast",e)):(c.slideUp("fast"),a.slideDown("fast",e))}function f(a){var b=a.$target.closest("a");a=b.closest("div.extender-section");b=b.find("i");b.hasClass("a-icon-extender-expand")?(a.find(".collapsed").hide(),a.find(".expanded").slideDown("fast"),b.removeClass("a-icon-extender-expand").addClass("a-icon-extender-collapse")):(a.find(".collapsed").show(),a.find(".expanded").slideUp("fast"),b.removeClass("a-icon-extender-collapse").addClass("a-icon-extender-expand"))}function c(a){Q.msgPopovers.filter(":visible").hide();
a.$event.preventDefault();a.$event.stopPropagation();a=a.$target.parent().find(".a-popover");a.is(":visible")||a.show()}function h(a,b,c){var d=a||{},e="string"===typeof a;c=c&&c.useSif?B('input[type\x3d"hidden"][name\x3d"isAmazonApp"]').val():0;e?(d+="\x26ajaxResponse\x3d1\x26returnjson\x3d1",c&&(d+="\x26isAmazonApp\x3d1")):(d.ajaxResponse=1,d.returnjson=1,c&&(d.isAmazonApp=1));for(c=0;c<J.length;c++){var f=J[c],h=B("input[name\x3d"+f+"]").val();e?-1===b.search(f)&&-1===a.search(f)&&(d=d+"\x26"+
f+"\x3d"+h):d[f]=h}return d}function y(a,b){if(0>a)return 0;isNaN(b)||(a=Number(a).toFixed(b));a=a.toString();b=0<=a.lastIndexOf(".")?a.lastIndexOf("."):a.length;return 3>=b?a:y(a.substring(0,b-3),0)+","+a.substring(b-3)}function v(a,b,c,d){a="timeout"===b?"pay-ajax-timeout":"abort"===b?"pay-ajax-abort":"abort-for-cleanup"===b?"pay-ajax-abort-for-cleanup":"parsererror"===b?"pay-ajax-parsererror":500===a.status?"pay-ajax-500":"pay-ajax-error";if(c){a=c=-1===c.lastIndexOf(".html?")?c+("?ref\x3d"+a):
c+("\x26ref\x3d"+a);Q.pageContainer.find("#tempForm").remove();c=B('\x3cform id\x3d"#tempForm" method\x3d"post"\x3e\x3c/form\x3e');c.attr("action",a);if("string"===typeof d){a={};b=d.split("\x26");for(var e=0;e<b.length;e++){var f=b[e].split("\x3d");2===f.length&&(a[f[0]]=f[1])}}else a=d;for(var h in a)"ajaxResponse"!==h&&"returnjson"!==h&&(a=B('\x3cinput type\x3d"hidden"/\x3e').attr("name",h).val(d[h]),c.append(a));Q.pageContainer.append(c);c.submit()}}function w(a,b,c,d){var f=m.setAjaxTransitionHeader({"x-amz-checkout-page":"payselect"});
f={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:h(b,a,d),dataType:"text",headers:f,timeout:t,type:"POST",url:a,beforeSend:function(a,b){c&&c.beforeHandler&&c.beforeHandler(a,b)},complete:function(a,b){c&&c.completeHandler&&c.completeHandler(a,b)},error:function(d,e){c&&c.errorHandler?c.errorHandler(d,e):v(d,e,a,b)},success:function(a,b,d){var f=d.getResponseHeader("x-amz-checkout-page");if("payselect"!==f&&"spp-payment"!==f)return a=e.jsonify(a),m.redirect(a);c&&c.successHandler?
c.successHandler(a,b,d):m.ajaxUpdatePage(a,b,d)}};B.extend(f,d);r.push(B.ajax(f))}function x(a,b,c,d){var e=m.setAjaxTransitionHeader({"x-amz-checkout-page":"payselect"});e={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:h(b,a,d),dataType:"text",headers:e,timeout:t,type:"POST",url:a,error:function(d,e){c&&c.errorHandler?c.errorHandler(d,e):v(d,e,a,b)},success:function(a,b,d){var e=d.getResponseHeader("x-amz-checkout-page");"payselect"!==e&&"spp-payment"!==e&&c&&c.pageUpdater?
c.pageUpdater(a):m.ajaxUpdatePage(a,b,d)}};B.extend(e,d);r.push(B.ajax(e))}function p(){t=parseInt(B("input[type\x3d'hidden'][name\x3d'paypageTimeoutValue']").val(),10);t=isNaN(t)?1E4:t;l.isMobileCX()?A&&(A=!1):(Q=l.getElements(q),A&&(a.declarative("close-popover",["click"],b),a.declarative("toggle-msg-popover",["click"],c),a.declarative("a-extender-toggle",["click"],f),A=!1),Q.pageContainer.undelegate(".expando-link","click").delegate(".expando-link","click",d),Q.pageContainer.find("form select.a-touch-select-input").unbind("change",
u).bind("change",u),B(".a-dropdown-container").each(function(){n.remove(B(this).find("select").attr("name"))}),B(document).bind("click",function(a){a.isPropagationStopped()||0===B(a.target).closest(".pay-popover-msg").length&&Q.msgPopovers.filter(":visible").hide()}))}function u(a){var b=B(a.currentTarget);a=b.siblings("a.a-placeholder");b=b.find(":selected").text();a.html(b);return!1}var B=a.$,A=!0,t,r=[],J=["forceResponsive","fromAnywhere","hasWorkingJavascript"],Q={},q={msgPopovers:"div.pay-popover-msg",
pageContainer:"div.a-container"};a.on("checkout:reload:payselect",p);a.on("checkout:reload:spp-payment",p);return l.mergeFrom({decodeJSONResponse:function(a){var b=new RegExp(String.fromCharCode(65340),"g"),c=new RegExp(String.fromCharCode(92,92,92,92),"g");a=a.replace(b,String.fromCharCode(92),"g");a=a.replace(c,String.fromCharCode(92));a=a.replace(/\\1/g,String.fromCharCode(34));return a=a.replace(/\\2/g,String.fromCharCode(10))},elements:Q,getNumberWithSeparators:y,handleForm:function(a,b,c){a.$event.preventDefault();
var d=a.$declarativeParent;d.is("span")&&(d=d.find("form"));d=d.serializeArray();d=l.processSubmissionParameters(d);w(a.data.action,d,b,c)},makeAjaxCall:w,handleAjaxError:v,handlePaymentsPortalForm:function(a,b,c,d){a=l.processSubmissionParameters(a.submissionParameters);w(b,a,c,d)},handlePaymentsPortalRedeemClaimCodeTransition:function(a,b,c,d){a=l.processSubmissionParameters(a.submissionParameters);a.embedOnlyData=1;x(b,a,c,d)}},l)});"use strict";q.when("A","pay-common-lib","page-transition-controller").register("pay-mobile-util",
function(a,l,n){function e(a,b,c){a=a||{};var d=w.fromAnywhereField.val(),e=c&&c.useSif?h('input[type\x3d"hidden"][name\x3d"isAmazonApp"]').val():0,f=g();"string"===typeof a?(a=a+"\x26ajaxResponse\x3d1\x26currentPage\x3d"+f,-1===b.search("fromAnywhere")&&-1===a.search("fromAnywhere")&&(a=a+"\x26fromAnywhere\x3d"+d),e&&(a+="\x26isAmazonApp\x3d1")):(a.ajaxResponse=1,a.currentPage=f,-1===b.search("fromAnywhere")&&(a.fromAnywhere=d),e&&(a.isAmazonApp=1),c&&c.isAddCardAndContinueEnabled&&(a.isHideSpinnerDisabled=
!0));return a}function k(){y&&y.abort("abort-for-cleanup");y=null}function m(a,b,c,d){a=a&&a.status;b="timeout"===b?"pay-ajax-timeout":"abort"===b?"pay-ajax-abort":"abort-for-cleanup"===b?"pay-ajax-abort-for-cleanup":"parsererror"===b?"pay-ajax-parsererror":500===a?"pay-ajax-500":"unknown"===a?"pay-unknown-page":"pay-ajax-error";c&&(c=-1===c.lastIndexOf(".html?")?c+("?ref\x3d"+b):c+("\x26ref\x3d"+b),f(c,d))}function g(){var a;h.each(v,function(b,c){if(c.pageId&&h(c.pageId).is(":visible"))return a=
b,!1});return a}function b(a){(a=v[a]&&v[a].componentId)&&q.when(a).execute(function(a){a.init&&a.init()})}function d(a,c,d,f,g){g&&g.suppressSpinner||n.show();g={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:e(c,a,f),dataType:"text",timeout:u,type:"POST",url:a,beforeSend:function(a,b){d&&d.beforeHandler&&d.beforeHandler(a,b)},complete:function(a,b){d&&d.completeHandler&&d.completeHandler(a,b);c&&c.isHideSpinnerDisabled||n.hide()},error:function(b,e){d&&d.errorHandler?d.errorHandler(b,
e):m(b,e,a,c)},success:function(e,f,h){var g=h.getResponseHeader("x-amz-checkout-pay-page-name");if(g){var k=h.getResponseHeader("x-amz-checkout-pay-page-title");k&&w.pageTitle.text(decodeURIComponent(k));d&&d.successHandler?d.successHandler(e,f,h):w.pageContainer.html(e);b(g)}else m(null,"unknown",a,c)}};h.extend(g,f);y=h.ajax(g)}function f(a,b,c){var d=h("#tempForm",w.pageContainer);0<d.length&&d.remove();d=h('\x3cform method\x3d"post"\x3e\x3c/form\x3e');d.attr("action",a);c&&c.target&&d.attr("target",
c.target);if("string"===typeof b)for(a=b.split("\x26"),b=0;b<a.length;b++)c=a[b].split("\x3d"),2===c.length&&"ajaxResponse"!==c[0]&&(c=h('\x3cinput type\x3d"hidden"/\x3e').attr("name",c[0]).val(c[1]),d.append(c));else for(var e in b)"ajaxResponse"!==e&&d.append(h('\x3cinput type\x3d"hidden"/\x3e').attr("name",e).val(b[e]));w.pageContainer.append(d);d.submit()}function c(a,c,d,f,g){g&&g.suppressSpinner||n.show();g={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:e(c,a,f),dataType:"text",
timeout:u,type:"POST",url:a,complete:function(a,b){d&&d.completeHandler&&d.completeHandler(a,b);n.hide()},error:function(b,e){d&&d.errorHandler?d.errorHandler(b,e):m(b,e,a,c)},success:function(a,c,e){var f=e.getResponseHeader("x-amz-checkout-pay-page-name");if(!f&&d&&d.pageUpdater)d.pageUpdater(a);else{var h=e.getResponseHeader("x-amz-checkout-pay-page-title");h&&w.pageTitle.text(decodeURIComponent(h));d&&d.successHandler?d.successHandler(a,c,e):w.pageContainer.html(a);b(f)}}};h.extend(g,f);y=h.ajax(g)}
var h=a.$,y=null,v={main:{componentId:"page-main",pageId:"#select-payments-view"},"credit-card-rewards":{componentId:"page-rewards",pageId:"#select-payment-rewards-view"},"financial-offer":{componentId:"page-financial-offer",pageId:"#select-payment-financial-offer-view"},"new-payment-methods":{pageId:"#new-payments-view"},"gil-estimates":{pageId:"#gil-estimates-subpage"}},w={},x={cvvHelper:"div#cvv-help-popover",fromAnywhereField:"input[name\x3dfromAnywhere]",jppoints:"div#jppoints",pageContainer:"div#page-container",
pageTitle:"head title"},p=!0,u;return l.mergeFrom({decodeJSonResponse:function(a){var b=new RegExp(String.fromCharCode(65340),"g"),c=new RegExp(String.fromCharCode(92,92,92,92),"g");a=a.replace(b,String.fromCharCode(92),"g");a=a.replace(c,String.fromCharCode(92));a=a.replace(/\\1/g,String.fromCharCode(34));return a=a.replace(/\\2/g,String.fromCharCode(10))},elements:w,getCurrentPage:function(){return w.pageContainer.children("div.page").filter(":visible")},getCurrentPageName:g,getPageId:function(a){a=
a.getResponseHeader("x-amz-checkout-pay-page-name");return v[a]&&v[a].pageId},handleForm:function(a,b,c){a.$event.preventDefault();d(a.data.action,a.$target.serialize(),{successHandler:function(a,c,d){b(a,c,d)}},c)},submitFormRequest:f,init:function(){l.isMobileCX()&&(r.onbeforeunload=k,l.refreshElements(w,x),u=parseInt(h("input[type\x3d'hidden'][name\x3d'paypageTimeoutValue']").val(),10),u=isNaN(u)?1E4:u,p&&(p=!1,h("div.pay-mobile").bind("keypress",function(a){l.prop("activeGoElement",13===a.keyCode?
document.activeElement:null,!0)})))},makeAjaxCall:d,handleAjaxError:m,pages:v,handlePaymentsPortalForm:function(a,b,c,e){a=l.processSubmissionParameters(a.submissionParameters);d(b,a,c,e)},handlePaymentsPortalRedeemClaimCodeTransition:function(a,b,d,e){a=l.processSubmissionParameters(a.submissionParameters);a.embedOnlyData=1;c(b,a,d,e)}},l)});"use strict";q.when("page-detector","pay-desktop-util","pay-mobile-util").register("pay-common-util",function(a,l,n){return a.isMobile()?n:l});"use strict";
q.when("A","pay-common-util","pay-rewards-currency","checkout-federation-wrapper","safe-apx-helper","weblab-helper").register("pay-validator",function(a,l,n,e,k,m){function g(){function a(a,b,c,d){Z.push({identifier:a,priority:c||100,target:b,isPincodeError:d})}function h(a){if(!a)return null;var b=new RegExp(String.fromCharCode(32),"g"),c=new RegExp(String.fromCharCode(45),"g");return a.replace(b,"").replace(c,"")}function g(){return 0<Z.length}function v(a){if(!a||0===a.length)return!1;for(var b=
0,c=!1,d=a.length-1;0<=d;--d){var e=a.charAt(d);c&&(e*=2,9<e&&(e-=9));b+=parseInt(e,10);c=!c}return 0===b%10}function w(a,b){return a&&a.match(/^[0-9]+$/)&&a.length===b}function x(a,b,c){return a&&a.match(/^[0-9A-Za-z]+$/)&&a.length>=b&&a.length<=c}function p(a,b){if(!a||!b)return!1;a=parseInt(a,10);b=parseInt(b,10);return u(a,b)}function u(a,b){var c=new Date,d=c.getFullYear();return b>d||b===d&&a>=c.getMonth()+1}function B(a){a=a.val();return!a||0===a.length}function A(){var c=b("#pm_pay_by_check").is(":checked"),
d=b("#existing-balance [paymentmethodid\x3d'availablebalance'] input").is(":checked");c&&d&&a("continue_BadCombinationCheckExistingBalance")}function t(c){if(b("#jppoints").length){var d=!1;if(1===c.length&&"jppoints"===c.attr("id")){var e=c;d=!0}else e=c.filter("#jppoints");if(e&&e.find("#redeemPoints").is(":checked")){c=e.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val();c=parseInt(c,10);b('input[type\x3d"checkbox"][name\x3d"useAvailableBalance"]').is(":checked")&&(c-=parseInt(e.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]').val(),
10));var f=parseInt(e.find("#redeemableAmount").text(),10),h=e.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]');e.find("#jpPointsMax").is(":checked")?e=f:(e=parseInt(h.val(),10))||(e=0);e>f?a("continue_jpPointsExceedsRedeemableAmount",h):d&&e<c?a("continue_notEnoughJPPoints"):e>c&&a("continue_jpPointsExceedsTotalPurchase")}}}function r(b){b&&(b=b.find(".pci-blocking-cvv"),b.length&&b.is(":visible")&&a("PCI_Block_CVV"))}function J(b){var c=b.find(".currency-list");c.length&&c.is(":visible")&&
(b=c.find("[type\x3dradio]:checked").val(),c=c.find("#cardCurrencyDropDown option:selected").val(),b&&("Other"!==b||"-1"!==c&&"-2"!==c)||a("continue_SelectCardCurrency"))}function Q(b){var c=b.find("#existingCvvNum");if(0!==c.length){var e=c.val();b=d?b.data("validcvvlength"):b.attr("validcvvlength");w(e,parseInt(b,10))||a("continue_BadSecurityCode",c)}}function P(b){var c=b.find('input[name\x3d"paymentMethod"]').val();/^creditCard/.test(c)&&b.find("#savedCardSuppressed").length&&a("continue_BankTemporarilyNotAvailable")}
function F(b){b=b.find("#existingPincodeNum");if(0!==b.length){var c=b.val();c?x(c,4,8)||a("existingCreditCard_PincodeInvalid",b,null,!l.isMobileCX()):a("continue_EmptyPincode",b)}}function M(c){if(c&&c.length)for(var d=0;d<c.length;d++){var e=b(c[d]);r(e.parent());Q(e);F(e);"netBanking"===e.find('input[name\x3d"paymentMethod"]').val()&&(b("#netBanking_select").val(),b("#net-banking-list").find("option:selected").data("isdisabled")&&a("continue_BankTemporarilyNotAvailable"));P(e);var f=e;f.find('input[name\x3d"paymentMethod"]').val();
f.find("#vdcBanksSelect").val();b("#vdcBanksSelect").find("option:selected").data("isdisabled")&&a("continue_BankTemporarilyNotAvailable");C(e);e=e.siblings("#upi-acceptance-input").find("#vpaCollect");if(!e||e.length)(f=e.val())&&f.match(/.+@.+/)||a("continue_BadVpaForUpi",e)}}function R(b){var c=b.find("#newMonth"),d=b.find("#newYear");b=b.find("#newExpDate");!(c=c.length&&!p(c.val(),d.val()))&&(c=b.length)&&((b=b.val())?(c=b.split("-"),b=parseInt(c[0],10),c=parseInt(c[1],10),b=u(c,b)):b=!1,c=!b);
c&&a("continue_BadExpiration")}function U(b){"domesticCards"===b.find('input[name\x3d"paymentMethod"]').val()&&((b=b.find("select").val())&&b.match(/^[0-9]*$/)||a("continue_BlankSlate"))}function T(c){var d=b("#existing-balance input[name\x3duseFlexiblePayments]").is(":checked");c=l.getAttributeData(c,"paymentmethodtype");d&&"creditCard"!==c&&a("continue_FlexiblePaymentsNeedsCreditCard")}function I(b){"thirdPartyAccounts"===b.find('input[name\x3d"paymentMethod"]').val()&&((b=b.find("select").val())&&
0!==b.length||a("continue_BlankSlate"))}function V(b){var c=b.find(".rewards-list");if(c.length&&c.find('input[type\x3d"radio"][value\x3d"rewardscustom"]').is(":checked")){b=c.find("input.custom-rewards-input");var d=b.val();if(c.hasClass("show-currency-input-widget-new")){c=b.data("country-code");var e=n.getCurrencyFormatByCountryCode(c);c=b.data("min");d=n.getAmount(d,e.decimalPlace);d<c&&a("continue_BadRewardsMin")}else/^\s*$/.test(d)||isNaN(d)?a("continue_BadRewardsValue"):(d=parseFloat(b.val()),
c=b.data("min"),0>=d||d<c?a("continue_BadRewardsMin"):d>b.data().max&&a("continue_BadRewardsMax"))}}function S(c){var d=c.find('input[name\x3d"paymentMethod"]').val();"verifiedCreditCard"===d?a("continue_BlankSlate"):"verifiedDebitCard"===d&&(d=c.find("#vdcBanksSelect").val(),(""===d||"OtherBanks"===d||"1"===b("#save_citi_card").val()&&"CIT"===d)&&a("continue_BlankSlate"),c.find("option:selected").prop("disabled")&&a("continue_BankTemporarilyNotAvailable"))}function W(b){"cashOnDeliveryCash"===b.find('input[name\x3d"paymentMethod"]').val()&&
b.find(".phonenumberNotVerified").length&&a("continue_OTPforCOD")}function ba(b){if("netBanking"===b.find('input[name\x3d"paymentMethod"]').val()){var c=b.find("#net-banking-select-list").val();b=b.find("option:selected").prop("disabled");""===c&&a("continue_BlankSlate");b&&a("continue_BankTemporarilyNotAvailable")}}function ca(b){"morePaymentMethod"===b.find('input[name\x3d"paymentMethod"]').val()&&""===b.find("#more-payment-methods-select-list").val()&&a("continue_BlankSlate")}function C(c){var d=
c.find('input[name\x3d"paymentMethod"]').val();if("StandaloneInstallment"===d||"StandaloneCreditCardInstallment"===d||"StandaloneReusableCreditLineInstallment"===d)c.find('input[name\x3d"gilShowContinueBlocker"]').val()&&("StandaloneCreditCardInstallment"===d?a("continue_GilCCContinueError"):"StandaloneReusableCreditLineInstallment"===d?a("continue_GilRCLContinueError"):a("continue_GilContinueError")),c.find('input[name\x3d"showIneligibleItemSubpage"]').val()&&("StandaloneCreditCardInstallment"===
d?a("continue_GilCCContinueErrorIneligibleItems"):"StandaloneReusableCreditLineInstallment"===d?a("continue_GilRCLContinueErrorIneligibleItems"):a("continue_GilContinueErrorIneligibleItems")),c.find('input[name\x3d"gilShowContinueBlockerIfPromotions"]').val()&&0<b("#existing-balance input[name\x3duseAvailableBalance]:checked").length&&("StandaloneCreditCardInstallment"===d?a("continue_GilCCContinueErrorPromotions"):"StandaloneReusableCreditLineInstallment"===d?a("continue_GilRCLContinueErrorPromotions"):
a("continue_GilContinueErrorPromotions"))}var Z=[],X=null,z=null,Y=function(a){f=a};f||(l.isMobileCX()?q.when("rewards-section-mobile").execute(Y):q.when("rewards-section-desktop").execute(Y));return{displayErrors:function(a,c){(X=a)&&X.hide().find(".error-message").hide().addClass("hidden");(z=c)&&z.find(".a-form-error").removeClass("a-form-error");if(g()){for(a=0;a<Z.length;a++){c=Z[a];if(c.target){var d=c.target.parent();d.hasClass("a-input-text-wrapper")&&!d.hasClass("a-form-error")?d.addClass("a-form-error"):
c.target.hasClass("a-form-error")||c.target.addClass("a-form-error")}c=c.identifier;(X&&X.length?X.find("#"+c):b("#"+c)).show().removeClass("hidden")}X&&X.length&&X.show()}},getHighestErrorId:function(){for(var a={priority:100},c=0;c<Z.length;c++){var d=Z[c],e;(e=d.identifier)?(e=X&&X.length?X.find("#"+e):b("#"+e),e=parseInt(l.getAttributeData(e,"priority"),10),e=isNaN(e)?100:e):e=100;e<=a.priority&&(a={identifier:d.identifier,priority:e,isPincodeError:d.isPincodeError,target:d.target})}return a},
hasErrors:g,isValidCardCVV:w,isValidCardPincode:x,validateBankAccountNum:function(b,c){B(b)&&a("addBankAccount_NoAccountNumber",c)},validateBankAccountNumConfirm:function(b,c,d){b.val()!==c.val()&&a("addBankAccount_AccountNumberMismatch",d)},validateBankDriverLicense:function(b,c){B(b)&&a("addBankAccount_NoDLNumber",c)},validateBankDriverLicenseState:function(b,c){b.val()!==G&&""!==b.val()&&"0"!==b.val()||a("addBankAccount_NoDLState",c)},validateBankHolderName:function(b,c){B(b)&&a("addBankAccount_NoName",
c)},validateBankRoutingNum:function(b,c){9!==b.val().length&&a("addBankAccount_ShortRoutingNumber",c)},validateCreditCardCVV2:function(b,c,d){d="true"===b.attr("isaddresschallenge")?b.attr("issuer"):d&&d.charAt(0);"R"!==d&&(b=b.val(),w(b,"A"===d?4:3)||a("addCreditCard_BadSecurityCode",c))},validateCreditCardDate:function(b,c,d,e){p(b.val(),d.val())||(a("addCreditCard_BadExpiration",c),a("addCreditCard_BadExpiration",e))},validateCreditCardMobile:function(b,c){b=b.val();m.isUpdateMobileNumberEnabled()?
b&&b.replace(/[^0-9]/g,"").match(/^1[0-9]{10}$/)||a("addCreditCard_BadMobileNumber",c):b&&b.replace(/[^0-9]/g,"").match(/^1[34578]{1}[0-9]{9}$/)||a("addCreditCard_BadMobileNumber",c)},validateCreditCardPincode:function(b,c){(b=b.val())&&b.match(/^[a-zA-Z0-9]{4,8}$/)||a("addCreditCard_BadPincode",c)},validateCreditCardName:function(b,c){B(b)&&a("addCreditCard_NoName",c)},validateCreditCardNumber:function(c,d){var e=h(c.val());e&&10<e.length&&v(e)||a("addCreditCard_BadNumber",d);e=b("#creditCardIssuersBlocked").val();
c=c.data("issuer");e&&""!==e&&c&&""!==c&&-1<b.inArray(c,e.split(","))&&a("addCreditCard_IssuerUnsupported",d)},validateSBIMaestroCardNumberLength:function(b,c){19!==h(b.val()).length&&a("addCreditCard_SBIMaestro_BadNumberLength",c)},isAMEXCreditCard:function(a){a=h(a.val());return null!==a?0===a.indexOf("37")||0===a.indexOf("34"):!1},validateCreditCardTail:function(b,c){var e=h(b.val());e&&10<e.length&&v(e)?(b=(l.isMobileCX()&&d?b.parent().data():b.data()).tail+"",e.substr(e.length-b.length)!==b&&
a("addCreditCard_NotMatch",c)):a("addCreditCard_NotMatch",c)},validateCreditCardType:function(b,c){b.is(":visible")&&((b=b.val())&&b.match(/^[A-Z][0-9]*$/)||a("addCreditCard_NoType",c))},validateRegistrationResult:function(b){b.cardStatus?1===b.checkStatusCount&&a("addCreditCard_RegisterFailed"):0<b.errors.length&&a("addCreditCard_RegisterFailed")},validateDirectDebitAccountName:function(b,c){B(b)&&a("addDirectDebit_NoAccountOwnerName",c)},validateDirectDebitAccountNum:function(b,c){B(b)&&a("addDirectDebit_NoAccountNumber",
c)},validateDirectDebitRoutingNum:function(b,c){B(b)&&a("addDirectDebit_NoRoutingNumber",c)},validateInvoiceFirstName:function(b,c){B(b)&&a("addInvoiceAccount_NoFirstName",c)},validateInvoiceLastName:function(b,c){B(b)&&a("addInvoiceAccount_NoLastName",c)},validateLocName:function(b,c){B(b)&&a("addLoc_NoName",c)},validateLocNumber:function(b,c){B(b)&&a("addLoc_BadNumber",c)},validateNewGiftPromotion:function(b,c){B(b)&&a("addGiftCardOrPromo_NoCode",c)},validatePayment:function(c){if(l.isMobileCX())M(c),
f&&e.wrap(function(){f.validatePaymentRewardsInRewardsSection(a)},"shopwithpointsmobile");else if(A(),c&&c.length){for(var d=0;d<c.length;d++){var h=b(c[d]);"true"===l.getAttributeData(h,"isaddresschallenge")&&a("continue_AddressChallenge");"true"===l.getAttributeData(h,"isverifiedfail")&&a("continue_VerifiedFail");"true"===l.getAttributeData(h,"iscupcardexpired")&&a("continue_CUPExpired");r(h);J(h);Q(h);F(h);R(h);U(h);T(h);I(h);V(h);S(h);ba(h);ca(h);C(h);W(h);P(h)}f&&e.wrap(function(){f.validatePaymentRewardsInRewardsSection(a)},
"shopwithpoints");t(c)}else a("continue_BlankSlate")},validateGetCreditCardTypeResult:function(b){if(b.errors&&0<b.errors.length)for(var c=0;c<b.errors.length;c++)a(b.errors[c])},validateEMIMenuForContinueButton:function(b){var c=b.find("#emiPaymentMethodsSelectList").find("option:selected").val();if("CreditCard"===c||"SelectOption"===c)a("continue_BlankSlate");else if(c=c.split("."),1<c.length){var d=c[0];if("emiCreditCard"===d||"netbankingEMI"===d)b=b.find("."+c[1]),b=b.find(".emiMenuTenuresDropDown"),
b.length&&!b.find("option:selected").val()&&a("continue_BlankSlate")}},apxValidatePayment:function(a,b){var c=k.get("payselect");c&&c.validatePayments(this,b,a)},addError:a,errors:Z,validatePCICVVBlock:r}}var b=a.$,d=r.P&&r.P.AUI_BUILD_DATE,f=G;return{create:function(){return new g}}});"use strict";q.when("A","ajax-utility","pay-common-util","pay-validator").register("pay-credit-card",function(a,l,n,e){function k(a,b,c,e){a&&a.length&&(b=c+"-"+b,(c=n.prop(b))&&(a=a.find(e).val(c))&&a.length&&(n.isMobileCX()?
a.closest(".card-cvv-field").hide().data("isHidden",1):a.closest(".a-column").hide(),n.prop(b,G)))}var m=a.$,g={cc:!1,vcc:!1,vdc:!1},b=r.P&&r.P.AUI_BUILD_DATE;return{confirmCreditCard:function(a,b,c){a.currentPaymentInstrumentID=a.paymentmethodid;a.recommendedPaymentMethodId=a.paymentmethodid;if(a.newMonth&&a.newYear)a.month=a.newMonth,a.year=a.newYear;else if(a.newExpDate){var d=a.newExpDate.split("-");a.year=parseInt(d[0],10);a.month=parseInt(d[1],10)}else a.expmonth&&a.expyear&&(a.month=a.expmonth,
a.year=a.expyear);(d="existingCvvNum"in a?a.addCreditCardVerificationNumber=a.existingCvvNum:a.addCreditCardVerificationNumber)&&n.prop("cvv-"+a.paymentmethodid,d);(d="existingPincodeNum"in a?a.addCreditCardPincode=a.existingPincodeNum:a.addCreditCardPincode)&&n.prop("pincode-"+a.paymentmethodid,d);n.makeAjaxCall(c,a,{successHandler:b,errorHandler:function(b,c){a.handler="confirm-credit-card";n.handleAjaxError(b,c,"/gp/buy/payselect/handlers/submit.html",a)}},{useSif:!0})},handleCreditCardType:function(a,
b){var c=a.$target,d=a.data.type,f=e.create();a.$currentTarget.data("issuer","");f.validateCreditCardNumber(c,c);f.hasErrors()||(g[d]=!0,n.makeAjaxCall(a.data.url,{addCreditCardNumber:c.val(),returnjson:1},{completeHandler:function(){g[d]=!1},successHandler:function(c){c=l.jsonify(c);b(c,d);a.$currentTarget.data("issuer",c.issuer)}},{useSif:!0},{suppressSpinner:!0}))},isWaitingForType:function(a){return g[a]},runConfirmCardValidator:function(a,b){var c=a.find("#existingCvvNum");c=c.length?c:a.find("#addCreditCardVerificationNumber");
var d=a.find("#addCreditCardNumber"),f=a.find("#newMonth"),g=a.find("#newYear"),k=e.create();k.validateCreditCardTail(d,d);f.length&&g.length&&k.validateCreditCardDate(f,f.closest(".card-date").find(".a-button"),g,g.closest(".card-date").find(".a-button"));c.length&&(d=(d=a.find("#issuer"))&&d.val(),k.validateCreditCardCVV2(c,c,d));k.displayErrors(b,a);return k.hasErrors()},setDateSelectorStatus:function(a,b){var c=b.find(".card-date").find("select");c&&c.length&&q.when("a-dropdown").execute(function(b){c.each(function(){var c=
m(this).attr("id");b.updateSelect(c,{status:"21"===a.brand&&"G"===a.issuer?"disabled":"enabled"})})})},setNewCardCVVInputStatus:function(a){(n.prop("cvv-newcard")||n.prop("pincode-newcard"))&&a.each(function(){var a=m(this);if("1"===(b?a.data("isnewcard")+"":a.attr("isnewcard")))return k(a,"newcard","cvv","#existingCvvNum"),k(a,"newcard","pincode","#existingPincodeNum"),!1})},setCardPasswordInputStatus:k}});"use strict";q.when("A","ajax-utility","pay-common-util","pay-validator","page-transition-controller",
"page-conductor","pay-credit-card").register("pay-credit-card-reregistration",function(a,l,n,e,k,m,g){function b(a,b){var c=e.create(),d=f("#cupMobileNumber-"+a),h=f("#cupSecurityCode-"+a),g=f("#reRegisterCCErrors-"+a);a=f("#reRegisterCCInputs-"+a);c.validateCreditCardCVV2(h,h,b);c.validateCreditCardMobile(d,d);c.displayErrors(g,a);return c.hasErrors()}function d(a,b,d){m.ajaxUpdatePage(a,b,d)}var f=a.$;return{actionReregisterCardInBox:function(a){a.$event.preventDefault();k.show();var c=a.data.type,
e=f("#cupMobileNumber-"+a.data.paymentMethodID).val(),m=f("#cupSecurityCode-"+a.data.paymentMethodID).val();b(a.data.paymentMethodID,c)?k.hide():(c={isReregistering:a.data.isReregistering,currentPaymentInstrumentID:a.data.paymentMethodID,name:a.data.holderName,year:a.data.expiredYear,month:a.data.expiredMonth,addCreditCardMobileNumber:e,addCreditCardVerificationNumber:m},e={useSif:n.isMobileCX()?!0:!1,success:function(a,b,c){a=l.jsonify(a);b=f("#reRegisterCCErrors-"+a.paymentInstrumentId);g.waitForCreditCardStatus(a,
d,b)}},a.$event.preventDefault(),n.makeAjaxCall(a.data.url,c,null,e))}}});"use strict";q.when("A","client-side-metrics","ajax-utility","pay-common-util","pay-validator","existing-payments","page-conductor","checkout-modal-popover","page-transition-controller","pay-credit-card","pay-gil","new-verified-debit-card","emi-helper").register("new-payments",function(a,l,n,e,k,m,g,b,d,f,c,h,y){function v(a){a.$event.preventDefault();var b=a.data.type;if(f.isWaitingForType(b))d.show(),setTimeout(function(){v(a)},
50);else{var c="vdc"===b?H.newVDC:"emi"===b?H.newEMI:H.newVCC;if(ea(c,b))d.hide();else{d.show();var g=e.getInputValues(c),h="vdc"===b?"_VDC":"_VCC";c=g["addCreditCardVerificationNumber"+h];var k=g["addCreditCardPincode"+h];b={addCreditCardNumber:g["addCreditCardNumber"+h],addCreditCardVerificationNumber:c,addCreditCardPincode:k,handler:g["handler"+h],month:g["month"+h],name:g["name"+h],newPaymentType:b,year:g["year"+h],cctype:g["cctype"+h],isSBIInternationalMaestroSelected:g["isSBIInternationalMaestroSelected"+
h],isCardSavedFromEMIMenu:g["isCardSavedFromEMIMenu"+h]};e.prop("cvv-newcard",c);k&&e.prop("pincode-newcard",k);e.makeAjaxCall(a.data.url,b,{successHandler:function(a,b,c){Q(a,b,c);f.setNewCardCVVInputStatus(H.paymentRows)}},{useSif:!0})}}}function w(a){a.$event.preventDefault();var b=a.data.type;if(f.isWaitingForType(b))d.show(),setTimeout(function(){w(a)},50);else{var c=H.newCCFormContent;if(ea(c,b))d.hide();else{d.show();b=e.getInputValues(c);b.handler=b.handler_addCCInBox;c=a.data.url;var g={};
D("#cupSecurityCode").is(":visible")&&D("#cupMobileNumber").is(":visible")?(c="/gp/buy/payselect/handlers/add-credit-card.html",g={successHandler:function(a){a=n.jsonify(a);F(a)}}):g={successHandler:Q};e.makeAjaxCall(c,b,g,{useSif:!0})}}}function x(a){a.$event.preventDefault();var b=D("#new-giftcard-promotion");b=e.getInputValues(b);D("input[name\x3disUnifiedActionsDesignEnabled]").length&&p(a)||(b.handler=b.handler_addGCInBox,a=a.data.url,d.show(),e.makeAjaxCall(a,b,{successHandler:function(a,b,
c){g.ajaxUpdatePage(a,b,c);ra||e.scrollTopTo(D("#existing-balance"))}},{useSif:!0}))}function p(a){a=a.$declarativeParent;var b=D("#gcpromoinput"),c=k.create();c.validateNewGiftPromotion(b,b);c.displayErrors(H.newGCErrors,a);return c.hasErrors()}function u(a){var b=D(a.currentTarget).parents("div.new-payment-line").find(".card-date select");if(b&&b.length){var c=D(a.currentTarget).val();q.when("a-dropdown").execute(function(a){b.each(function(){var b=D(this).attr("id");a.updateSelect(b,{status:"G21"===
c?"disabled":"enabled"})})})}}function B(a){var b=H.newVDC.find(".vdc-form-fields"),c=H.newVDC.find("#vdc-logo-prompt"),d=H.newVDC.find(".top-cell");a?b.show():b.hide();a?c.show():c.hide();a?d.addClass():d.removeClass()}function A(a){var b=D(a.currentTarget).val(),c=H.newVDC.find("#suppressedVerifiedDebitCard").hide(),d=H.newVDC.find(".vdc-selected-bank-prompt").hide();B(!1);var e="1"===H.newVDC.find("#isRupayAsSavedCardEnabled").val()&&"URP"===b;"OtherBanks"===b||"1"===D("#save_citi_card").val()&&
"CIT"===b||e?(B(!0),D.isEmptyObject(h)||h.showExpiryDateAndCvv()):"SMP"!==b||D.isEmptyObject(h)?""!==b&&(b=D(a.currentTarget).find("option:selected").prop("disabled"),a=D(a.currentTarget).find("option:selected").text(),b?c.show().find(".suppressed-card-text").html(a):d.show().find(".bank-name-text").html(a)):(B(!0),h.hideExpiryDateAndCvv())}function t(a,b){if(!D.isEmptyObject(y)&&a)return a(b)}function r(a){t(y.removeEMIMenuSelectionAttributes);H.newEMI.find(".emi-group").hide();a=D(a.currentTarget).find("option:selected").val();
H.newEMI.find("#emiMenuErrors_VCC").length&&H.newEMI.find("#emiMenuErrors_VCC").hide();if(a=t(y.showPaymentOptionBlock,a))t(y.addEMIMenuSelectionAttributes),a.show()}function J(a){f.handleCreditCardType(a,ka)}function Q(a,b,c){g.ajaxUpdatePage(a,b,c);ra||e.scrollTopTo(m.getSelectedPayment())}function P(a){a.$event.preventDefault();var b=a.data.type;f.isWaitingForType(b)?(d.show(),setTimeout(function(){P(a)},50)):ea(a.$declarativeParent,b)?d.hide():(ia&&ia.hide(),oa&&oa.hide(),d.show(),D("#cupSecurityCode").is(":visible")&&
D("#cupMobileNumber").is(":visible")?(b=a.$declarativeParent.serializeArray(),b=e.processSubmissionParameters(b),e.makeAjaxCall("/gp/buy/payselect/handlers/add-credit-card.html",b,{successHandler:function(a){a=n.jsonify(a);F(a)}},{useSif:!0})):e.handleForm(a,{successHandler:Q},{useSif:!0}))}function F(a){var b={};b.paymentInstrumentId=a.paymentInstrumentId;a.checkStatusCount&&(b.checkStatusCount=a.checkStatusCount);var c={successHandler:function(a){a=n.jsonify(a);var b=k.create();"VERIFIED"===a.cardStatus?
e.makeAjaxCall("/gp/buy/payselect/handlers/submit.html",{newPaymentMethodId:a.paymentInstrumentId},{successHandler:Q}):"PENDING"===a.cardStatus?(a.checkStatusCount?(a.checkStatusCount=parseInt(a.checkStatusCount,10),isNaN(a.checkStatusCount)&&(a.checkStatusCount=1)):a.checkStatusCount=3,b.validateRegistrationResult(a),1===a.checkStatusCount?(d.hide(),b.displayErrors(H.newCCErrors)):(--a.checkStatusCount,F(a))):(b.validateRegistrationResult(a),d.hide(),b.displayErrors(H.newCCErrors))}};setTimeout(function(){e.makeAjaxCall("/gp/buy/payselect/handlers/check-credit-card-status.html",
b,c)},2500)}function M(a){a.$event.preventDefault();var b=a.$declarativeParent,c=b.find("#loc-name"),f=b.find("#loc-number"),g=k.create();g.validateLocName(c,c);g.validateLocNumber(f,f);g.displayErrors(b.find("#error-box-new-loc"),b);g.hasErrors()||(qa&&qa.hide(),d.show(),e.handleForm(a,{successHandler:Q}))}function G(a){a.$event.preventDefault();var b=a.$declarativeParent,c=b.find("#gcpromoinput");b.find("#gcpromosuccessblock").hide();var f=k.create();f.validateNewGiftPromotion(c,c);f.displayErrors(H.newGCErrors,
b);f.hasErrors()||(d.show(),e.handleForm(a,{successHandler:function(a,b,c){g.ajaxUpdatePage(a,b,c);ra?H.newGCErrors.is(":visible")&&D("#gc-link-expander").trigger("click"):e.scrollTopTo(D("#existing-balance"))}}))}function U(a){a.$event.preventDefault();D("#ccAddCard").trigger("submit")}function T(a){a.$event.preventDefault();D("#bank-address-popover-submit").trigger("submit")}function I(a){a.$event.preventDefault();D("#direct-debit-popover-submit").trigger("submit")}function V(a){a.$event.preventDefault();
D("#new-loc-popover-submit").trigger("submit")}function S(a){a.$event.preventDefault();D("#new-invoice-popover-submit").trigger("submit")}function W(a){a.$event.preventDefault();D("#brdcAddCard").trigger("submit")}function ba(a){a.$event.preventDefault();var b=a.$declarativeParent,c=k.create(),f=b.find("#bank-name"),g=b.find("#bank-routing-number"),h=b.find("#bank-account-number"),m=b.find("#bank-account-number-confirm"),p=b.find("#bank-dl"),n=b.find("#bank-dl-state");c.validateBankHolderName(f,f);
c.validateBankRoutingNum(g,g);c.validateBankAccountNum(h,h);c.validateBankAccountNumConfirm(h,m,m);c.validateBankDriverLicense(p,p);c.validateBankDriverLicenseState(n,n.parents("div.a-button-dropdown"));c.displayErrors(b.find("#new-bank-error-box"),b);c.hasErrors()||(ha&&ha.hide(),d.show(),e.handleForm(a,{successHandler:Q}))}function ca(a){a.$event.preventDefault();var b=a.$declarativeParent,c=k.create(),f=b.find("#debit-bank-routing-number"),g=b.find("#debit-account-number"),h=b.find("#debit-account-name");
c.validateDirectDebitRoutingNum(f,f);c.validateDirectDebitAccountNum(g,g);c.validateDirectDebitAccountName(h,h);c.displayErrors(b.find("#new-direct-debit-error"),b);c.hasErrors()||(fa&&fa.hide(),d.show(),e.handleForm(a,{successHandler:Q}))}function C(a){a.$event.preventDefault();var b=a.$declarativeParent,c=k.create(),f=b.find("#invoice-first-name"),g=b.find("#invoice-last-name");c.validateInvoiceFirstName(f,f);c.validateInvoiceLastName(g,g);c.displayErrors(b.find("#new-invoice-error-box"),b);c.hasErrors()||
(L&&L.hide(),d.show(),e.handleForm(a,{successHandler:Q}))}function Z(a){a=D("#order-summary-total");var b=D("#order-summary-container");a.prev().addClass("a-first");b.addClass("a-box-group");a.show();e.isTouchCX()&&b.parent().find(".bottom-order-summary").show();H.newCCFormContent.is(":visible")||D("#wrapper-new-cc").find("a.a-link-expander").trigger("click");D("#ecard-help-link").show()}function X(a){var b="Unknown";e.isDesktopCX()?b="Desktop":e.isMobileCX()?b="Mobile":e.isTouchCX()&&(b="Tablet");
l.increaseCount("PayPage-ClientSide-AddCupClick-"+b,1);b=D("#cupForm");if(0<b.length)b.submit();else{var c=D("\x3cform\x3e\x3c/form\x3e");c.attr({target:"_blank",method:"POST",action:a.data.url});D("#cup-dc").find("input").each(function(){var a=D(this);"hidden"===a.attr("type")&&a.clone().appendTo(c)});D("body").append(c);c.submit();c.remove()}}function z(c){var f=c.$target.closest(".a-popover"),g=f.data("a-popover-id");b.hideById(g);f.hide();D("#a-popover-modal").hide();d.show();e.makeAjaxCall(c.data.url,
void 0,{successHandler:function(b){D("#existing-payment-methods").replaceWith(D(b).find("#existing-payment-methods"));a.trigger("checkout:reload:payselect");d.hide()}})}function Y(a){a.$event.preventDefault();a=a.data;d.show();c.submitNewGilPayment(a.subtype)}function aa(){if(!e.isMobileCX()){0===D("#form-add-credit-card").length&&(D("#ccAddCard").parents("div.cc-submit").hide(),D("#ccAddCardWithButton").parents("div.cc-submit").show());D("html").hasClass("a-ie6")&&(D("#cup-mbdc").show(),D(".mbdc-link").attr("data-action",
"redirect-cup"));H=e.getElements(pa);H.bankNumberConfirm.show();H.newVDC.find(".payment-row").data("hasstatus")||H.newVDC.find(".vdc-form-fields").hide();H.newVDC.find("#suppressedVerifiedDebitCard").hide();H.newCCFormContent.find(".cup-card-field").hide();H.newPayments.find("#cupInfoMessage").hide();H.newPayments.find("#use-ecard-link").show();H.newPayments.find(".mbdc-link").show();H.newPayments.find(".mbdc-button").hide();ra=!1;H.newPayments.each(function(){var a=D(this),b=a.data();b&&0===b.hasstatus?
(a.find("a.a-link-expander i.js-hide").remove(),a.find("a.a-link-section-expander i.js-hide").remove()):b&&1===b.hasstatus&&!ra&&(e.scrollTopTo(a),ra=!0)});var b=H.newVCC.find("#requireCVVOrPincode");b&&b.length&&b.val("1");na&&(a.declarative("new-cc",["submit"],P),a.declarative("new-brdc",["submit"],P),a.declarative("new-loc",["submit"],M),a.declarative("show-card-image",["change"],J),a.declarative("new-giftcard-promotion",["submit"],G),a.declarative("new-verified-card",["click"],v),a.declarative("new-cc-in-dashboard",
["click"],w),a.declarative("new-gc-in-dashboard",["click"],x),a.declarative("add-bank-account",["submit"],ba),a.declarative("add-direct-debit",["submit"],ca),a.declarative("add-invoice",["submit"],C),a.declarative("show-order-summary",["click"],Z),a.declarative("redirect-cup",["click"],X),a.declarative("cup-popover-close",["click"],z),a.declarative("add-new-debit-and-cc-popover-submit",["click"],U),a.declarative("add-bank-account-popover-submit",["click"],T),a.declarative("add-loc-account-popover-submit",
["click"],V),a.declarative("new-gil-payment",["click"],Y),a.declarative("add-direct-debit-popover-submit",["click"],I),a.declarative("add-invoice-account-popover-submit",["click"],S),a.declarative("add-new-br-debit-card-popover-submit",["click"],W),na=!1);H.cardTypeDropdown.unbind("change",u).bind("change",u);H.vdcBankDropdown.unbind("change",A).bind("change",A);H.emiCardsDropdown.unbind("change",r).bind("change",r);D("div.pay-desktop a.a-link-expander").unbind("keypress");D("div.pay-desktop .a-declarative, div.pay-desktop .a-button").filter("[data-action\x3da-checkout-modal-popover]").unbind("keypress");
a.on("a:popover:show:add-new-debit-cc-modal",function(a){oa=a.popover});a.on("a:popover:show:add-new-bank-account-modal",function(a){ha=a.popover});a.on("a:popover:show:add-new-direct-debit-modal",function(a){fa=a.popover});a.on("a:popover:show:add-new-loc-account-modal",function(a){qa=a.popover});a.on("a:popover:show:add-invoice-account-modal",function(a){L=a.popover});a.on("a:popover:show:add-br-debit-card-modal",function(a){ia=a.popover})}}function ea(a,b){var c,d,e,f,g,h,m,p,n,l,u,t;"vcc"===b?
(c="#vccCVVNum",d="#newVCCErrors",e="#vccMonth",f="#vccName",g="#newVerifiedCreditCardNumber",h="#vccType",m="#vccYear",p="#vccPincode",n=void 0,l=void 0,u=void 0,t=void 0):"vdc"===b?(c="#vdcCVVNum",d="#newVDCErrors",e="#vdcMonth",f="#vdcName",g="#newVerifiedDebitCardNumber",h="#vdcType",m="#vdcYear",n="#isSBIMaestroAsSavedCardEnabled",l="#isSBIInternationalMaestroSelected",p=void 0,u=void 0,t=void 0):"emi"===b?(c="#vccCVVNum",d="#newEMIErrors",e="#vccMonth",f="#vccName",g="#newVerifiedCreditCardNumber",
h="#vccType",m="#vccYear",p="#vccPincode",n=void 0,l=void 0,u=void 0,t=void 0):"brdc"===b?(d="#newBRDCErrors",e="#brdcMonth",f="#brdcName",g="#addCreditCardNumber_BRDC",m="#brdcYear",c=void 0,h=void 0,p=void 0,n=void 0,l=void 0,u=void 0,t=void 0):(u="#cupSecurityCode",t="#cupMobileNumber",c="#ccCVVNum",d="#newCCErrors",e="#ccMonth",f="#ccName",g="#addCreditCardNumber",h="#ccType",m="#ccYear",p=void 0,n=void 0,l=void 0);b=a.find(c);u&&0===b.length&&a.find(u).is(":visible")&&(b=a.find(u));n="1"===a.find(n).val()&&
"1"===a.find(l).val();f=a.find(f);g=a.find(g);t=t?a.find(t):null;e=a.find(e);h=a.find(h);m=a.find(m);var w;p&&a.find(p).is(":visible")&&(w=a.find(p));p=h.val();l=k.create();l.validateCreditCardName(f,f);l.validateCreditCardNumber(g,g);n&&l.validateSBIMaestroCardNumberLength(g,g);n=e.parent();n=n.hasClass("a-button")?n:n.find(".a-button");f=m.parent();f=f.hasClass("a-button")?f:f.find(".a-button");"G21"!==p&&l.validateCreditCardDate(e,n,m,f);l.validateCreditCardType(h,h.closest(".card-type-field").find(".a-button"));
m=p?p.substr(0,1):"";b.length&&"R"!==m&&b.is(":visible")&&l.validateCreditCardCVV2(b,b,p);t&&t.length&&t.is(":visible")&&l.validateCreditCardMobile(t,t);w&&w.length&&l.validateCreditCardPincode(w,w);l.displayErrors(D(d),a);return l.hasErrors()}function ka(a,b){if(a){"1"===a.isDebitCard?H.newCCWarnings.show().removeClass("hidden"):H.newCCWarnings.hide().addClass("hidden");if("1"===a.hasErrors){var c=k.create();c.validateGetCreditCardTypeResult(a);if(c.hasErrors()){c.displayErrors(H.newCCErrors);return}}b=
"vcc"===b?H.newVCC:"vdc"===b?H.newVDC:"emi"===b?H.newEMI:"brdc"===b?H.newBRDCFormContent:H.newCCFormContent;c=a.specificFields;var d=b.find(".cup-card-field");0!==d.length&&(c&&1===c.securityCode&&1===c.mobileNumber?(e.isTouchCX()&&b.find("#addCreditCardNumber").closest(".a-input-text-wrapper").removeClass("last-child"),d.show()):d.hide());c=a.specificFields;d=b.find(".amex-field");if(0!==d.length){var g=b.find(".cvv-field");0!==g.length&&(c&&1===c.pincode?(g.hide(),d.show()):c&&0===c.pincode&&0===
c.securityCode?(d.hide(),g.hide()):(d.hide(),g.show()))}c=b.find(".card-images");c.find("img").hide();g=a.installmentProgram;d=!1;g&&(g=c.find('img[data-installmentprogram\x3d"'+g+'"]'),0!==g.length&&(g.show(),d=!0));d||(a.issuerdisplayimage?c.find("img[data-issuer\x3dATM]").attr("src",a.issuerdisplayimage).show():(d=a.issuer+a.brand,c.find("img[data-issuer\x3d"+d+"]").show(),b.find(pa.cardTypeDropdown).val(d).trigger("change")));f.setDateSelectorStatus(a,b)}}var D=a.$,na=!0,ra=!1,H={},pa={bankNumberConfirm:"#wrapper-bank-account-number-confirm",
btnAddCard:"#ccAddCard",btnAddLoc:"#button-new-loc",btnAddGC:"#button-add-gcpromo",btnAddBank:"#button-add-bank-account",btnAddDirectDebit:"#button-add-direct-debit",btnAddInvoice:"#button-add-invoice",cardImages:"#newCreditCardImages",cardTypeDropdown:".card-type-dropdown select",newCCFormContent:"#new-cc",newBRDCFormContent:"#new-brdc",newGCErrors:"#gcpromoerrorblock",newGCFormContent:"#gc_entry",newPayments:"div.new-payment-line",newVCC:"#new-verified-credit-cards-table",newVDC:"#new-verified-debit-cards-table",
newEMI:"#newEmiCard",paymentRows:"#existing-payment-methods .payment-row",vdcBankDropdown:"#vdcBanksSelect",emiCardsDropdown:"#emiPaymentMethodsSelectList",cardList:"#existing-credit-cards-box",newCCErrors:"#newCCErrors",newCCWarnings:"#newCCWarnings"},oa,ha,qa,fa,L,ia;a.on("checkout:reload:payselect",aa);a.on("checkout:reload:spp-payment",aa);return{actionShowOrderSummary:Z,handleFormHandlerScrollToSelected:Q}});q.when("A","page-detector","client-side-metrics","ready").execute(function(a,l,n){function e(a,
e,b,d){a=k(e).is(":checked");r.P&&r.P.AUI_BUILD_DATE?a?k(b).val(k(b).parent().data("account-name")):k(b).val(""):(n.increaseCount("removeauijs8"),a?(k(d).removeClass("a-icon-touch-checkbox-inactive").addClass("a-icon-touch-checkbox-active"),k(b).val(k(b).data("account-name"))):(k(d).removeClass("a-icon-touch-checkbox-active").addClass("a-icon-touch-checkbox-inactive"),k(b).val("")));b="undefined"!==typeof r.ue&&"undefined"!==typeof r.ue.count;d=l.isMobilePayment()?"mobile":"tablet";a=k("#showNameOnCardCheckbox").is(":checked");
b&&r.ue.count(d+"NameOnCardCheckBox"+(a?"Checked":"Unchecked"),1)}var k=a.$;a.declarative("show-card-name",["click"],function(a){e(a,"#showNameOnCardCheckbox","#ccName","#showNameOnCardIcon")});a.declarative("show-br-debit-card-name",["click"],function(a){e(a,"#showNameOnCardCheckbox_BRDC","#brdcName","#showNameOnCardIcon_BRDC")})});"use strict";q.when("A").register("pay-rewards-currency",function(a){var l=function(a,e){e=Math.pow(10,e);a=a.replace(/[^0-9]/g,"");return parseFloat(a)/e},n={CA:{groupingSeparator:",",
decimalSeparator:".",decimalPlace:2},DE:{groupingSeparator:".",decimalSeparator:",",decimalPlace:2},GB:{groupingSeparator:",",decimalSeparator:".",decimalPlace:2},JP:{groupingSeparator:",",decimalSeparator:".",decimalPlace:0},US:{groupingSeparator:",",decimalSeparator:".",decimalPlace:2}},e=function(a,e,b,d,f){this.groupingSeparator=a;this.decimalSeparator=e;this.currencyDecimalPlace=b;this.pointsDecimalPlace=d;this.ratio=f;this.getCurrencyAmount=function(a){return l(a,this.currencyDecimalPlace)};
this.getPointsAmount=function(a){return this.getCurrencyAmount(a)/this.ratio};this.format=function(a,b){var c=parseInt(a,10);a=parseFloat(a-c).toFixed(b);a=this.decimalSeparator+a.slice(2);c=c.toString();b=3<c.length?c.length%3:0;c=(0<b?c.substr(0,b)+this.groupingSeparator:"")+c.substr(b).replace(/(\d{3})(?=\d)/g,"$1"+this.groupingSeparator);return a===G||a===this.decimalSeparator?c:c+a};this.formatCurrency=function(a){return this.format(a,b)};this.formatPoints=function(a){return this.format(a,d)}},
k=function(e,g,b,d){this.maxAmount=d;this.rewardsFormatter=b;this.currencyElement=e;this.pointElement=g;var f=this;this.isControlKey=function(a){switch(a.which){case 8:case 46:return!0;case 86:case 88:return a.ctrlKey;default:return!1}};this.isNavigationKey=function(a){switch(a.which){case 9:case 16:case 17:case 35:case 36:case 37:case 39:return!0;case 65:case 67:return a.ctrlKey;default:return!1}};this.isValidKey=function(a){var b=a.which;return 48<=b&&57>=b||96<=b&&105>=b||8===a.which||46===a.which};
this.getCaret=function(){var a=f.currencyElement,b=a.get(0),d=0,e=0;if("number"===typeof b.selectionStart&&"number"===typeof b.selectionEnd)d=b.selectionStart,e=b.selectionEnd;else{var g=document.selection.createRange();if(g!==G&&g.parentElement()===b){a=a.val();e=a.length;var k=b.createTextRange();k.moveToBookmark(g.getBookmark());b=b.createTextRange();b.collapse(!1);-1<k.compareEndPoints("StartToEnd",b)?d=e:(d=-k.moveStart("character",-e),d+=a.slice(0,d).length-1,-1<k.compareEndPoints("EndToEnd",
b)||(e=-k.moveEnd("character",-e),e+=a.slice(0,e).length-1))}}return{start:d,end:e}};this.setCaret=function(a){var b=f.currencyElement.get(0);b.setSelectionRange?b.setSelectionRange(a,a):b.createTextRange&&(b=b.createTextRange(),b.collapse(!0),b.moveStart("character",a),b.moveEnd("character",a),b.select())};this.bind=function(){f.currencyElement.unbind();f.currencyElement.bind("keydown",function(a){f.isNavigationKey(a)||f.isControlKey(a)||f.isValidKey(a)||a.preventDefault()});f.currencyElement.bind("keyup",
function(b){if(!f.isNavigationKey(b)){b=f.getCaret();var c=f.currencyElement.val().length;f.format();var d=f.currencyElement.val().length;b.start===b.end&&f.setCaret(Math.min(b.start+(d-c),d));a.trigger("inlineFormatter:formattingCompleted",f)}})};this.unbind=function(){f.currencyElement.unbind("keydown keyup")};this.format=function(a){a=f.currencyElement.val();a=f.rewardsFormatter.getCurrencyAmount(a);isNaN(a)&&(a=0);a>f.maxAmount&&(a=f.maxAmount);a=f.rewardsFormatter.formatCurrency(a);f.currencyElement.val(a)}};
a.on("inlineFormatter:formattingCompleted",function(a){var e=a.pointElement,b=a.currencyElement.val();b=a.rewardsFormatter.getPointsAmount(b);a=a.rewardsFormatter.formatPoints(Math.round(b));e.html(a)});return{getCurrencyFormatByCountryCode:function(a){(a=n[a])||(a=n["default"]);return a},getAmount:l,initializeInlineFormatting:function(m,g,b){var d=m.maxAmount;b=new e(b.groupingSeparator,b.decimalSeparator,b.decimalPlace,g.decimalPlace,g.ratio);m=new k(m.$element,g.$element,b,d);m.bind();m.format(0);
a.trigger("inlineFormatter:formattingCompleted",m)}}});"use strict";q.when("A","pay-common-util","pay-validator","page-conductor","mobile-carrier-billing-util","weblab-helper").register("jppoints",function(a,l,n,e,k,m){function g(){!l.isMobileCX()&&A("#jppoints").length&&(t=l.getElements(N),h())}function b(){var a=t.paymentRows.find('input[type\x3d"radio"][name\x3d"paymentMethod"]');a.closest("div.payment-selected").removeClass("payment-selected");a.attr("checked",!1);l.isTouchCX()&&d(a,"radio")}
function d(a,b){a.siblings("i").removeClass("a-icon-touch-"+b+"-active").addClass("a-icon-touch-"+b+"-inactive")}function f(a,b){a.is(":disabled")||a.siblings("i").removeClass("a-icon-touch-"+b+"-inactive").addClass("a-icon-touch-"+b+"-active")}function c(){return A('input[type\x3d"radio"][name\x3d"paymentMethod"][value\x3d"availablebalance"]').is(":checked")}function h(){if(t.jppoints&&t.jppoints.length){c()&&r();t.jppoints.show();var a=t.jppoints.find("#redeemPoints");l.isTouchCX()?a.parents("label").bind("click",
x):a.bind("click",x);t.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').bind("click",function(){var a=t.jppoints.find("#jpPointsCustom");a.attr("checked",!0);var b=t.jppoints.find("#redeemPoints");b.attr("checked",!0);l.isTouchCX()&&(f(a,"radio"),d(t.jppoints.find("#jpPointsMax"),"radio"),f(b,"checkbox"))});t.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]').bind("click",v);t.jppoints.find("#jpPointsCustom").bind("click",function(){t.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').focus()});
t.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').bind("keyup",B)}}function r(){var a=t.jppoints.find("#redeemPoints"),b=t.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"]'),c=t.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),f=t.jppoints.find("#redeemableAmount"),g=t.jppoints.find("#redeemableValue");a.attr("checked",!1);a.attr("disabled",!0);b.attr("checked",!1);b.attr("disabled",!0);t.jppoints.find("#jpPointsError").hide();c.val("");
c.removeClass("a-form-error");c.attr("disabled",!0);g.text(t.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithGC"]').val());f.text(t.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithGC"]').val());e.isSPP()&&(t.jppoints.find("label").addClass("disabled-color"),t.jppoints.removeClass("payment-selected"));l.isTouchCX()&&(d(a,"checkbox"),d(b,"radio"),a.siblings("i").addClass("a-button-disabled"),b.siblings("i").addClass("a-button-disabled"))}function v(c){var e=c.currentTarget,
g=t.jppoints.find("#redeemPoints");g.attr("checked",!0);if(l.isTouchCX()){f(A("#"+e.id),"radio");var h="jpPointsMax"===e.id?t.jppoints.find("#jpPointsCustom"):t.jppoints.find("#jpPointsMax");d(h,"radio");f(g,"checkbox")}"true"===e.value&&(t.jppoints.find("#jpPointsError").hide(),e=t.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),e.removeClass("a-form-error"),e.val(""),g=t.jppoints.find("#redeemableAmount"),h=parseInt(t.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsConversionRate"]').val(),
10),e=parseInt(t.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10),g=parseInt(g.text(),10)*h,A('input[name\x3d"useAvailableBalance"]').is(":checked")&&(h=t.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]'),e-=parseInt(h.val(),10)),g>=e&&b());q.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:toggleJPPointsInstallmentEligibility",A(c.currentTarget))})}function w(a){var c=t.jppoints.find("#redeemableAmount"),
e=t.jppoints.find("#redeemableValue"),f=parseInt(t.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10);if(a.is(":checked")){a=t.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithGC"]').val();var g=t.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithGC"]').val();f-=parseInt(t.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]').val(),10)}else a=t.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithoutGC"]').val(),
g=t.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithoutGC"]').val();var h=parseInt(t.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsConversionRate"]').val(),10)*a;c.text(a);e.text(g);0>=parseInt(a,10)?(c=t.jppoints.find("#redeemPoints"),c.attr("checked",!1),e=t.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"]'),e.attr("checked",!1),l.isTouchCX()&&(d(c,"checkbox"),d(e,"radio"))):t.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"][value\x3d"true"]').is(":checked")?
h>=f&&b():B()}function x(){var b=t.jppoints.find("#redeemPoints");if(!b.is(":disabled")){b=b.is(":checked");if(l.isTouchCX())b?(d(t.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]'),"radio"),u()):(f(t.jppoints.find("#jpPointsMax"),"radio"),d(t.jppoints.find("#jpPointsCustom"),"radio"),p());else if(b)p(),e.isSPP()&&t.jppoints.addClass("payment-selected");else if(u(),e.isSPP()){t.jppoints.removeClass("payment-selected");if(c())return;l.selectDefaultPaymentMethodIfNotSelected()}q.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:toggleJPPointsInstallmentEligibility",
t.jppoints)})}}function p(){var a=t.jppoints.find("#jpPointsMax");a.attr("checked",!0);var c=parseInt(t.jppoints.find("#redeemableAmount").text(),10),g=t.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithoutGC"]').val(),h=parseInt(t.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10);l.isTouchCX()&&(d(t.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]'),"radio"),f(a,"radio"));t.jppoints.find("#jpPointsMax").is(":checked")&&(c>=h?b():e.isSPP()&&t.paymentRows.find("#gcPromo, input[name\x3d'useAvailableBalance']").is(":checked")&&
(a=t.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]'),h-=parseInt(a.val(),10),g>=h&&b()))}function u(){var a=t.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]');a.attr("checked",!1);var b=t.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]');b.val("");b.removeClass("a-form-error");t.jppoints.find("#jpPointsError").hide();l.isTouchCX()&&d(a,"radio")}function B(){var c=t.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),d=parseInt(c.val(),
10);!d||0>d?(c.val(""),t.jppoints.find("#jpPointsError").hide(),t.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').removeClass("a-form-error")):(c.val(d),parseInt(t.jppoints.find("#redeemableAmount").text(),10)<d?(t.jppoints.find("#jpPointsError").show(),t.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').addClass("a-form-error")):(t.jppoints.find("#jpPointsError").hide(),t.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').removeClass("a-form-error"),
c=parseInt(t.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10),parseInt(t.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsConversionRate"]').val(),10),d>=c&&b(),q.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:actionToggleJPPointsSection",d)})))}var A=a.$,t={},N={paymentRows:"#existing-payment-methods .payment-row",jppoints:"#jppoints",mcbPointsWarning:"#mcbPointsWarning"};a.on("checkout:reload:payselect",g);a.on("checkout:reload:spp-payment",
g);return{handleJPPointsOnPaymentRows:function(a){a=A(a.currentTarget);if("jppoints"!==a.attr("id"))if("useAvailableBalance"===a.attr("name"))w(a);else{m.isMCBMultiTenderWeblabEnabled()||k.hideMCBWarningMessageForPoints(t);var b=a.find('input[type\x3d"radio"][name\x3dpaymentMethod]');if(!m.isMCBMultiTenderWeblabEnabled()&&b.length&&0<b.filter("[value^\x3dMCB]").size())k.showMCBWarningMessageForPoints(t),r();else if("availablebalance"===a.attr("value")||a.find("#pm_300")&&"availablebalance"===a.find("#pm_300").attr("value"))r();
else{a=t.jppoints.find("#redeemPoints");b=t.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"]');var c=t.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),d=t.jppoints.find("#redeemableAmount"),f=t.jppoints.find("#redeemableValue");e.isSPP()&&t.jppoints.find("label").removeClass("disabled-color");a.attr("disabled",!1);b.attr("disabled",!1);c.attr("disabled",!1);A('#existing-balance input[type\x3d"radio"][value\x3d"availablebalance"]').length&&(d.text(t.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithoutGC"]').val()),
f.text(t.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithoutGC"]').val()));l.isTouchCX()&&(a.siblings("i").removeClass("a-button-disabled"),b.siblings("i").removeClass("a-button-disabled"))}}},handleJPPointsWithGC:w}});"use strict";q.when("A","ajax-utility","client-side-metrics","pay-common-util","pay-validator","page-transition-controller","page-conductor","a-popover-position","inline-points-register-controller","jppoints","pay-credit-card","checkout-general-utils","a-popover-base",
"a-dropdown","pay-rewards-currency","cache-page-data-controller","pay-credit-card-reregistration","mobile-carrier-billing-util","emi-helper","instant-bank-discount-helper","safe-apx-helper","apb-limit-messaging-helper").register("existing-payments",function(a,l,n,e,k,m,g,b,d,f,c,h,y,v,w,x,p,u,B,A,t,N){function J(){return E.paymentRows.filter(function(){return K(this).hasClass("payment-selected")||K(this).find("#redeemPoints").is(":checked")})}function Q(a){m.show();a.$event.preventDefault();var b=
J().find(".card-unreg-rewards").data();b.recommendedPaymentMethodId=b.paymentinstrumentid;e.makeAjaxCall(a.$target.attr("href"),b)}function P(b){b=K(b.currentTarget);var c=b.data();if(!(0>=c.ratio)){var d=b.val()/c.ratio;if(!isNaN(d)){var f=b.val();f<c.min&&(d=0);b=e.getNumberWithSeparators(d,c.decimalplaces);J().find(".custom-reward-points").html(b);q.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:actionToggleRewardsSection",f)})}}}function F(a){1===a.data.refresh&&
(m.show(),e.makeAjaxCall(a.data.url))}function M(a){Aa(a)?(a=E.continueBtns,a.find(".a-button-primary:not(.a-button-disabled)").addClass("aok-hidden"),a.find(".a-button-disabled").removeClass("aok-hidden")):K("#payPageContinueBtnStateFixEnabled").length&&S(a)}function G(a){e.isTouchCX()&&(Aa()?a.$event.preventDefault():(E.continueErrPopover.hide().find(".error-message").hide(),m.show()))}function U(a){e.isTouchCX()&&(Aa()||E.continueErrPopover.hide().find(".error-message").hide())}function T(a){a=
K(a.currentTarget);a.click();a=a.closest(".payment-container");a.find("#cc-errors").is(":visible")?a.find(".tv-update .a-button-primary").focus():a.click()}function I(a){a.$event.preventDefault();var b=J();if(!c.runConfirmCardValidator(b,b.find("#cc-errors"))){m.show();var d=(b=e.getInputValues(b))||{},f=e.getInputValues(E.hiddenFormFields),g;for(g in f)f.hasOwnProperty(g)&&(d[g]=f[g]);c.confirmCreditCard(b,fa,a.data.url)}}function V(){E.continueErrPopover.filter(":visible").length&&E.continueErrPopover.hide()}
function S(){E.continueErrPopover.filter(":visible").length&&E.continueErrPopover.hide().find(".error-message").hide();var a=J();E.disableSubmitButtons.length?a.find(".no-address").length||(a.find(".continue-center").removeClass("aok-hidden"),a.find(".a-button-disabled").addClass("aok-hidden")):(E.continueBtns.find(".a-button-primary:not(.a-button-disabled)").removeClass("aok-hidden"),E.continueBtns.find(".a-button-disabled").addClass("aok-hidden"));if(a){var b=a.find(".a-form-error");b&&b.length&&
(b.removeClass("a-form-error"),(a=a.find(".pincode-err-block").filter(":visible"))&&a.length&&(E.continueErrPopover.hide().find(".error-message").hide(),E.continueBtns.find(".a-button-primary").removeClass("aok-hidden"),E.continueBtns.find(".a-button-disabled").addClass("aok-hidden"),a.hide()))}}function W(){E.continueErrPopover.filter(":visible").length||E.continueBtnTop.trigger("click")}function ba(a){if(13===a.which){var b=K(document.activeElement),c=b.closest("div.payment-row"),d=b.closest(".a-button");
b=b.get(0).tagName;if(c.length&&!d.length&&"A"!==b&&"a"!==b)return c=c.find('input[type\x3d"submit"]'),c.length?c.trigger("click"):(E.continueErrPopover.filter(":visible").length&&E.continueErrPopover.hide(),Aa(a)?(e.isTouchCX()||(E.continueBtns.find(".a-button-primary").addClass("aok-hidden"),E.continueBtns.find(".a-button-disabled").removeClass("aok-hidden")),a.preventDefault()):E.continueBtnTop.trigger("click")),!1}}function ca(a){m.show();var b=J(),c=b.find("input[type\x3dradio][name\x3dpaymentMethod]").val(),
d=b.find(".card-unreg-rewards").data();b=e.isTouchCX()?b.find(".flag-register-rewards"):E.rewardsRegister;b=e.getInputValues(b);b.programid=d.programid;b.paymentinstrumentid=d.paymentinstrumentid;b.CARD_EXPIRATION_DATE=d.expiredate;b.CARD_HOLDER_NAME=d.holdername;b.returnRefreshedPage=a.data.returnRefreshedPage;b.rewardsdateofbirthmonth&&b.rewardsdateofbirthday&&(b.DATE_OF_BIRTH=b.rewardsdateofbirthmonth+b.rewardsdateofbirthday);-1===a.data.url.toLowerCase().indexOf("cachebuster")&&(a.data.url=h.addQueryStringParameter(a.data.url,
"cacheBuster",(new Date).getTime()));e.makeAjaxCall(a.data.url,b,{successHandler:function(a,b,d){m.hide();if(a){a=l.jsonify(a);E.rewardsRegister.find(".register-content").hide();var f=e.isTouchCX()?J().find(".register-error"):E.rewardsRegister.find(".register-error");f.hide();a.error?f.show().find(".error-message").hide().filter("#"+a.error).show():(g.ajaxUpdatePage(a.refreshedPage,b,d),b=E.paymentRows.find('input[type\x3dradio][name\x3dpaymentMethod][value\x3d"'+c+'"]').closest(".payment-row"),b.trigger("click"),
e.scrollTopTo(b))}}})}function C(a){a=K(a.currentTarget).parents("div.currency-list");var b=a.find("label.a-touch-radio");b.length?b.trigger("click"):a.find("input[type\x3dradio][value\x3dOther]").trigger("click")}function Z(a){a=a.$target.closest("div.payment-row");var b=a.find(".currency-list");if(g.isSPP()){var c=v.getSelect(b.find("select"));null!==c&&c.setValue("")}a.find(".change-currency").hide();b.show();e.isTouchCX()&&(a.find(".top-cell").removeClass("bottom-line").addClass("bottom-line"),
a.find(".bottom-cell").show());L();ma()}function X(a){a=a.$target.closest("div.payment-row");a.find(".expire-info, .expire-date").hide();a.find(".enter-date, .expire-date-fields").show();L();ia()}function z(a){var b=a.$target.closest("div.payment-row"),c="true"===e.getAttributeData(b,"isaddresschallenge")?1:0;b.find(".expire-date-fields").length?(X(a),b.find("#newExpDate").focus()):c&&b.find("#addCreditCardNumber").focus()}function Y(a){setTimeout(function(a){var b=K(a.target);a=document.createEvent("UIEvents");
a.initUIEvent("DOMActivate",!0,!0,r,1);b.get(0).dispatchEvent(a)},0,a)}function aa(a){var b=K(a.target).closest("div.payment-row");""!==K(a.target).val()&&("true"===e.getAttributeData(b,"isaddresschallenge")?b.find("#addCreditCardNumber").focus():W())}function ea(){var a=J();a.find("div.flag-register-rewards").is(":visible")?(a.find(".bottom-cell").hide(),a.find(".top-cell").removeClass("bottom-line"),a.find(".card-unreg-rewards").show()):(a.find(".card-unreg-rewards").hide(),a.find(".bottom-cell").show(),
a.find(".top-cell").removeClass("bottom-line").addClass("bottom-line"))}function ka(){ea()}function D(a){a.$event.preventDefault();if("1"===J().find("div.flag-register-rewards").attr("cached"))ea();else{var b=a.$target.attr("href");-1===b.toLowerCase().indexOf("cachebuster")&&(b=h.addQueryStringParameter(b,"cacheBuster",(new Date).getTime()));m.show();e.makeAjaxCall(b,a.data,{successHandler:function(a){m.hide();var b=l.jsonify(a);a=e.decodeJSONResponse(b.widgetHTML);var c=J();c.find("div.flag-register-rewards").html(a);
c.find("div.flag-register-rewards").attr("cached",1);c.find("div.flag-register-rewards .error-message").each(function(){var a=K(this),c=a.data("errorid");a.html(b.displaydata[c])});ea()}})}}function na(b){var c=K(b.target);if(!c.is(":visible"))return b.preventDefault(),b.stopPropagation(),!1;g.isSPP()&&(g.isPrefetchFromAddressEnabled()?g.disablePageNoUpdateTransition():K("#payment").find(".panel-cancel-row").hide(),x.clearCache());var d=K(b.currentTarget);E.jppoints.length&&f.handleJPPointsOnPaymentRows(b);
var h=d.find("[name\x3duseAvailableBalance]");if("useAvailableBalance"!==b.target.name&&!h.length)if(H(d),u.toggleGCForMCB(d,E),ra(d),d.hasClass("payment-selected")||d.hasClass("payment-label"))E.disableSubmitButtons.length&&(oa(d,d,!1),!c.hasClass("continue-center")&&d.find(".continue-center").length||W());else if(b=d.find('input[type\x3d"radio"][name\x3d"paymentMethod"]'),b.length&&"disabled"!==b.attr("disabled")){bb();b=J();g.isSPP()?b.filter(function(){var a=K(this).attr("id");return"gcPromo"===
a?(a=K(this).find('input[type\x3d"radio"][name\x3d"paymentMethod"][value\x3d"availablebalance"]'))&&a.length:"jppoints"!==a}).removeClass("payment-selected"):b.removeClass("payment-selected");b.find("[name\x3dpaymentMethod]").attr("checked",!1);b.find("i[data-a-input-name\x3dpaymentMethod]").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");b.find(".top-cell").removeClass("bottom-line");wa(b);e.isTouchCX()&&(b.find(".bottom-cell").hide(),b.find(".card-unreg-rewards").show());
d.addClass("payment-selected");d.find("[name\x3dpaymentMethod]").attr("checked",!0);d.find("i[data-a-input-name\x3dpaymentMethod]").removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active");c="true"===e.getAttributeData(d,"isaddresschallenge")?1:0;h=d.find('.rewards-list input[type\x3d"radio"]').length;var k="1"===e.getAttributeData(d,"hasDerivedCurrency")?1:0,p=d.find(".vcc-form-fields").length,m=d.find(".card-ref-num").length;e.isTouchCX()&&(c||h||p||m||k)&&(d.find(".top-cell").removeClass("align-top bottom-line").addClass("bottom-line"),
d.find(".bottom-cell").show());q.when("rewards-section-desktop").execute(function(b){a.trigger("rewards-section-desktop:select-payment-row",d,ma)});Ra(d);Va(d);Oa(d);Pa(d);db(d);"1"===K("#suppressionMessageFixEnabledStatus").val()&&cb(d);eb(d);Xa(d);Qa(d);Ya(d);fb(d);gb(d);Za(d);Ha(B,B.toggleEMIMenu,d);$a(d);hb();ha(d);Da();L();ia();U();xa();qa(d,b);Ta();E.hideInputBoxes.length&&(Ua(d,b),Sa(d));E.disableSubmitButtons.length&&oa(d,b,!0);Ka();ma();E.disableSubmitButtons.length&&!d.find(".continue-center").length&&
W()}}function ra(a){a=a.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]');var b=K("input[type\x3d'hidden'][name\x3d'paySelectLocale']");b.length&&"IN"===b.val()&&a.length&&q.when("client-side-metrics").execute(function(a){a.increaseCount("PayPage-COD-NonMobile",1)})}function H(a){var b=K("#isGlobalCODEligible").val();if(b&&"0"!==b){a=a.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]');b=K("#button-add-gcpromo");var c=K("#button-add-gcpromo").parent().parent();a.length?(c.addClass("a-button-disabled"),
b.attr("disabled","disabled")):(c.removeClass("a-button-disabled"),b.removeAttr("disabled"))}}function pa(a){q.when("A","a-tv").execute(function(b,c){b=b.$;var d=b(a);d.length&&(b(".tv-lastSelected").removeClass("tv-lastSelected"),d.addClass("tv-lastSelected"),c.select(d))})}function oa(a,b,c){c&&b.find(".billing-address, .cc-continue-button").hide();if(a.find(".tv-update").length)Ua(a,b),Sa(a);else{var d=a.find(".billing-address, .cc-continue-button");if(d.length&&!d.is(":visible")){var e=!1;a.find(".no-address").length&&
(e=!0,a.find(".a-button-primary").addClass("aok-hidden"),a.find(".a-button-disabled").removeClass("aok-hidden"));q.when("a-tv").execute(function(f){c&&(b.find(".payment-container").hasClass(".a-tv-navigate")||f.add(b.find(".payment-container")));f.remove(a.find(".payment-container"));f=e?a.find(".billing-address-link"):d.find(".continue-center");pa(f)});d.show()}}}function ha(a){var b=K("#one-click-final-review-message");b.length&&(a.find("#canTryTFX").length?b.removeClass("aok-hidden"):b.addClass("aok-hidden"))}
function qa(a,b){if(e.isTouchCX()&&(b&&b.find(".top-cell .data-row").children(".a-column").height("auto"),a)){a=a.find(".top-cell .data-row");var c=a.find(".addr-challenge-card-scan .a-box");if(c.length){b=a.height();c=c.height();var d=a.children(".a-column:first");a.children(".a-column").height(c);d.height(b);d.children(".vertical-center-grid:first").height(c)}else a.children(".a-column").height(a.height())}}function fa(b){m.hide();var d=l.jsonify(b);d.imbWidgetHTML&&K("#imb-wrapper").html(e.decodeJSONResponse(d.imbWidgetHTML));
if(d.cardWidgetHTML&&(b=J(),b.replaceWith(e.decodeJSONResponse(d.cardWidgetHTML)),null!=d.rewardsAccountsWidgetHTML&&q.when("rewards-section-desktop").execute(function(b){a.trigger("rewards-section-desktop:refresh-rewards-section",e.decodeJSONResponse(d.rewardsAccountsWidgetHTML))}),a.trigger("checkout:reload"),a.trigger("checkout:reload:payselect"),b=J(),"true"!==e.getAttributeData(b,"isaddresschallenge"))){c.setCardPasswordInputStatus(b,d.newpaymentmethodid,"cvv","#existingCvvNum");c.setCardPasswordInputStatus(b,
d.newpaymentmethodid,"pincode","#existingPincodeNum");if(E.cvvColumnLabel.length){var f=!1;E.paymentRows.each(function(){if("true"===e.getAttributeData(K(this),"isaddresschallenge"))return f=!0,!1});f||E.cvvColumnLabel.hide()}E.disableSubmitButtons.length&&W()}}function L(){E.paymentRows.each(function(){var a=K(this),b=a.find('.currency-list input[type\x3d"radio"]').length,c=a.find('.rewards-list input[type\x3d"radio"]').length,d=a.find(".card-reg-info").is(":visible"),f=a.find(".expire-date-fields").is(":visible"),
g=a.find("a[data-action\x3dshow-expire-date-fields]").is(":visible"),h=a.find(".bottom-cell .inner-grid-left"),k=a.find(".bottom-cell .inner-grid-right");f?b||c||d?(h.removeClass("hidden a-span10 a-span12").addClass("a-span8"),k.removeClass("a-span12 a-span2 hidden").addClass("a-span4")):(h.removeClass("a-span8 a-span10 a-span12").addClass("hidden"),k.removeClass("a-span4 a-span2 hidden").addClass("a-span12")):g?(h.removeClass("a-span12 a-span8 hidden").addClass("a-span10"),k.removeClass("hidden a-span4 a-span12").addClass("a-span2")):
(h.removeClass("a-span10 a-span8 hidden").addClass("a-span12"),k.removeClass("a-span2 a-span4 a-span12").addClass("hidden"));!e.isTouchCX()&&g&&(b||c||d)&&a.find(".bottom-cell").removeClass("align-top").addClass("align-top")});var a=J(),b=a.find("a[data-action\x3dshow-expire-date-fields]").filter(":visible").length,c=a.find(".top-cell.bottom-line").length;b&&!c||a.find(".bottom-cell").removeClass("align-top")}function ia(){e.isTouchCX()&&E.paymentRows.each(function(){var a=K(this),b="true"===e.getAttributeData(a,
"isaddresschallenge")?1:0,c=a.find("a[data-action\x3dshow-expire-date-fields]").is(":visible"),d=a.find(".expire-date-fields").is(":visible"),f=a.find(".card-reg-info").is(":visible"),g=a.find(".rewards-info").is(":visible"),h=a.find(".change-currency").is(":visible");c?a.find(".top-cell .second-row").addClass("align-top"):a.find(".top-cell .second-row").removeClass("align-top");b=b||h||f||g;f=d||c;g=a.find(".top-cell .inner-grid-left");a=a.find(".top-cell .inner-grid-right");b||(g.removeClass("a-span6 a-span8 a-span12").addClass("hidden"),
a.removeClass("a-span4 a-span6 hidden").addClass("a-span12"));f||(g.removeClass("a-span6 a-span8 hidden").addClass("a-span12"),a.removeClass("a-span4 a-span6 a-span12").addClass("hidden"));b&&c&&(g.removeClass("a-span6 a-span12 hidden").addClass("a-span8"),a.removeClass("a-span6 a-span12 hidden").addClass("a-span4"));b&&d&&(g.removeClass("a-span6 a-span8 hidden").addClass("a-span6"),a.removeClass("a-span4 a-span12 hidden").addClass("a-span6"))})}function wa(a){var b=a.find(".currency-list");if(b.length){var c=
b.find("[type\x3dradio]:checked").val();b=b.find("#cardCurrencyDropDown option:selected").val();"Other"!==c||"-1"!==b&&"-2"!==b||a.find(".currency-list input[type\x3dradio][value!\x3dOther]").attr("checked",!0)}}function ja(a){var b=K(a.currentTarget);a=b.find("option:selected");if(""===a.val())b.parents("div.selected-section").find(".selected-note-content").hide();else{var c=a.prop("disabled");b=b.parents("div.selected-section");var d=b.find("#active-bank-content"),e=b.find("#disable-bank-content");
c?(e.show(),d.hide()):(d.show(),e.hide());b.find("span.selected-note-bank").text(a.text()).show()}}function sa(a){var b=K(a.currentTarget);a=b.find("option:selected");""===a.val()?b.parents("div.selected-section-more-payment-method").find(".selected-more-payment-content").hide():(b=b.parents("div.selected-section-more-payment-method"),b.find("span.selected-payment-option").text(a.text()).show(),b.find("span.selected-more-payment-content").show())}function da(a){(E.continueErrPopover.filter(":visible").length||
Aa())&&a.$event.preventDefault()}function O(b){b=K(b.currentTarget);var c=b.find("input[type\x3dcheckbox]");c.attr("checked")?(c.attr("checked",!1),b.find(".checked-checkbox").addClass("aok-hidden"),b.find(".empty-checkbox").removeClass("aok-hidden"),b.find(".gc-balance-insufficient-msg").addClass("aok-hidden")):(c.attr("checked",!0),b.find(".checked-checkbox").removeClass("aok-hidden"),b.find(".empty-checkbox").addClass("aok-hidden"),b.find(".gc-balance-insufficient-msg").removeClass("aok-hidden"));
q.when("a-tv").execute(function(b){setTimeout(function(){b.select(".tv-lastSelected")},500);a.trigger("a:tv:resize")})}function ta(a){a=K(a.currentTarget);"1"===a.attr("isclicked")?a.attr("isclicked",0):a.attr("isclicked",1);xa()}function xa(a){var b=K("#pm_promo");a=K("#pm_gc_radio");var c=K("#pm_gc_checkbox"),d;K("input[name\x3ddoesPurchaseContainOnlyRecurringPrimeMembership]").length&&(d=K("input[name\x3ddoesPurchaseContainOnlyRecurringPrimeMembership]").val());if(a&&a.length||c&&c.length){var f=
K("input[name\x3dgcBalanceRaw]").val();K("input[name\x3damBalanceRaw]").length&&(f=K("input[name\x3damBalanceRaw]").val());var g=K("input[name\x3disAPBLimitMessagingLaunchWeblabEnabled]").val(),h=K("input[name\x3dhasAPBRedeemableLimitExhausted]").val(),k=K("input[name\x3damAvailableBalanceRaw]").val(),p=K("input[name\x3dremainingBalanceRaw]").val(),m=K("input[name\x3dpurchaseTotalRaw]").val(),n=K(".purchase-total").length;if(n){var l=K(".purchase-total").html();var u=K(".remaining-balance").html()}else l=
K("input[name\x3dpurchaseTotal]").val(),u=K("input[name\x3dremainingBalance]").val();var t=K(".balance-applied");n?t.html(l):t.text(l);(e.isTouchCX()&&"checkbox"===b.attr("type")?"1"===b.closest(".a-control-row").attr("isclicked"):b.is(":checked"))?(b=p,0<b&&(n?t.html(u):t.text(u))):b=m;g&&N.renderAPBMessagingRemainingBalance({purchaseTotal:l,remainingBalance:u,balanceApplied:t,isPurchaseTotalInSpan:n},f,m,k);u=a.closest(".radio-col");l=c.closest(".radio-col");p=K(".amazon-money-limit-breached");
n=K(".long");t=K(".short");"1"===g&&"1"===h?N.displayAPBRedeemableLimitExhaustedMessaging({gcRadioContainer:u,gcCheckboxContainer:l,gcCheckbox:c,gcRadio:a,shortMsg:t,longMsg:n,amazonMoneyLimitBreachedMsg:p}):0<=f-m?("disabled"===a.attr("disabled")&&a.removeAttr("disabled"),u.removeClass("hidden"),a.is(":checked")&&u.trigger("click"),l.addClass("hidden"),c.attr("disabled","disabled"),0==f-m?(n.hide(),t.show()):(n.show(),t.hide())):0<f-b?0>=b?(l.removeClass("hidden"),c.attr("disabled","disabled"),e.isTouchCX()&&
l.find("i").addClass("a-button-disabled checkbox-disabled"),u.addClass("hidden"),a.attr("disabled","disabled"),t.show(),n.hide()):("disabled"===a.attr("disabled")&&a.removeAttr("disabled"),u.removeClass("hidden"),a.is(":checked")?u.trigger("click"):e.isTouchCX()&&u.find("i").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive"),l.addClass("hidden"),c.attr("disabled","disabled"),n.show(),t.hide()):("disabled"===c.attr("disabled")&&(c.removeAttr("disabled"),e.isTouchCX()&&
l.find("i").removeClass("a-button-disabled checkbox-disabled")),l.removeClass("hidden"),(h=l.closest(".payment-row"))&&h.hasClass("payment-selected")&&h.removeClass("payment-selected"),u.addClass("hidden"),a.attr("disabled","disabled"),"1"===g?N.renderAPBInsufficientMessaging({shortMsg:t,longMsg:n},f,k):(t.show(),n.hide()));"1"===d&&(a.attr("disabled","disabled"),c.attr("disabled","disabled"),(h=l.closest(".payment-row"))&&h.hasClass("payment-selected")&&h.removeClass("payment-selected"))}}function ua(b){var c=
J().find(".enter-custom-rewards");if("rewardscustom"===K(b.currentTarget).children('input[type\x3d"radio"]').val()){c.show();var d=c.find("input.custom-rewards-input");d.focus();E.paymentRows.find(".rewards-list").hasClass("show-currency-input-widget-new")&&(c=d.val().length,d=d.get(0),d.setSelectionRange?d.setSelectionRange(c,c):d.createTextRange&&(d=d.createTextRange(),d.collapse(!0),d.moveStart("character",c),d.moveEnd("character",c),d.select()))}else c.hide();q.when("installments-payselect").execute(function(c){a.trigger("installments-payselect:toggleRewardsInstallmentEligibility",
K(b.currentTarget))});ma()}function Fa(a){a=a.$target||K(a.currentTarget);za(a)}function za(b){if(b.length){var c=E.paymentRows.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]'),d=E.paymentRows.find(".installments-select.a-row"),e=d.siblings(".installments-message"),f=d.siblings(".card-offers"),g=E.paymentRows.find('input[type\x3d"radio"][value\x3d"morePaymentMethod"]'),h=E.installmentsOnlyCards,k=E.paymentRows.find('input[type\x3d"radio"][id\x3d"pmEmiPaymentOptions"]'),p=E.paymentRows.find('input[type\x3d"radio"][value\x3d"amazonBusinessCredit"]');
if(c.length){var m=c.closest(".payment-row"),n=g.closest(".payment-row"),l=k.closest(".payment-row"),u=p.closest(".payment-row");b.is(":checked")?(c.prop("disabled",!0),c.is(":checked")&&(c.prop("checked",!1),m.removeClass("payment-selected")),c.parent().siblings().addClass("a-color-secondary"),Ha(B,B.disableEMIPaymentMethods,k),q.when("abc-helper").execute(function(b){a.trigger("abc-helper:disable-payment",p)}),A.showInstantBankDiscountAmazonPaySelected(),Ea(g,n),(b=d.find("select"))&&b.each(function(){var a=
this.id.replace(/\./g,"\\.");v.setValue(a,"")}),d.find(".installments-enabled-text").hide(),e.find(".installments-enabled-text").hide(),f.find(".installments-enabled-text").hide(),d.find(".installments-disabled-text").show(),e.find(".installments-disabled-text").show(),f.find(".installments-disabled-text").show(),K("#isGurupaPspToggleGcBugfixEnabled").length&&"1"===K("#isGurupaPspToggleGcBugfixEnabled").val()?h.find("input[name\x3dpaymentMethod]").attr("disabled","disabled").filter(":checked").removeAttr("checked"):
h.find("input[name\x3dpaymentMethod]").attr("disabled","disabled").removeAttr("checked"),h.removeClass("payment-selected")):(m.find(".payment-invalid").length||(c.prop("disabled",!1),c.parent().siblings().removeClass("a-color-secondary")),n.find(".payment-invalid").length||Ba(g,n),l.find(".payment-invalid").length||Ha(B,B.enableEMIPaymentMethods,k),u.find(".payment-invalid").length||q.when("abc-helper").execute(function(b){a.trigger("abc-helper:enable-payment",p)}),A.showInstantBankDiscountAmazonPayDeselected(),
d.find(".installments-disabled-text").hide(),e.find(".installments-disabled-text").hide(),f.find(".installments-disabled-text").hide(),d.find(".installments-enabled-text").show(),e.find(".installments-enabled-text").show(),f.find(".installments-enabled-text").show(),h.find("input[name\x3dpaymentMethod]").removeAttr("disabled"))}}}function Ba(a,b){a.prop("disabled",!1);a.parent().siblings().removeClass("a-color-secondary");b.find(".selected-section-more-payment-method").show();b.find(".more-payment-gc-disabled-text").hide()}
function Ea(a,b){a.prop("disabled",!0);a.is(":checked")&&(a.prop("checked",!1),b.removeClass("payment-selected"));a.parent().siblings().addClass("a-color-secondary");b.find(".selected-section-more-payment-method").hide();b.find(".more-payment-gc-disabled-text").show()}function la(a){var b=a.$target||K(a.currentTarget);a=b.closest(".currency-list");b=b.val();!0===(e.isTouchCX()?"Other"===b:"Other"!==b)?(a.find("select").attr("disabled",!0),a.find(".a-button.a-button-dropdown").addClass("a-button-disabled"),
a.find(".a-button.a-touch-select").addClass("a-button-disabled")):(a.find("select").attr("disabled",!1),a.find(".a-button.a-button-dropdown").removeClass("a-button-disabled"),a.find(".a-button.a-touch-select").removeClass("a-button-disabled"));ma()}function va(a){p.actionReregisterCardInBox(a);e.scrollTopTo(J())}function Ga(a){ma()}function Ca(){E.paymentRows.each(function(){var a=K(this),b=".card-ref-num, .addr-challenge, .addr-challenge-msg, .cup-expired-msg, .enter-date, .expire-date-fields, .rewards-static-help-link, .verified-fail-msg, .tv-update, .billing-address, .cc-continue-button",
c=".card-info, .card-name, .card-reg-info, .expire-info, .rewards-err-msg, .rewards-list label, .rewards-list div.a-radio, .rewards-dynamic-help-link, .financial-offer-err-detail";a.hasClass("payment-selected")&&("1"===e.getAttributeData(a,"hasDerivedCurrency")||"1"===e.getAttributeData(a,"hasPreferredCurrency")&&"1"===e.getAttributeData(a,"isNewCard"))||(b+=", .currency-list");"1"===e.getAttributeData(a,"hasPreferredCurrency")&&"1"!==e.getAttributeData(a,"isNewCard")&&(c+=", .change-currency");a.find(b).hide();
a.find(c).show()})}function Da(){E.paymentRows.each(function(){var a=K(this),b="#cc-errors, .enter-date, .expire-date-fields",c=".expire-info";if(a.hasClass("payment-selected")&&"1"===e.getAttributeData(a,"hasDerivedCurrency"))b+=", .change-currency",c+=", .currency-list";else{var d=a.find(".currency-list"),f=d.find("[type\x3dradio]:checked").val();if(f){if("Other"!==f)var g=d.find(".currencyNameLabel").html();else{f=d.find("#cardCurrencyDropDown option:selected");var h=f.val();"-1"!==h&&"-2"!==h&&
(g=f.text())}g&&(c+=", .change-currency",d.closest("div.payment-row").find(".change-currency .currencyNameLabel").html(g))}b+=", .currency-list"}a.find(b).hide();a.find(c).show()})}function ya(){var a=K("#aan-ads-box");if(a.length){var b=a.data("adsendpoint"),c=a.data("adsclient"),d="https://"+b+"/2009-09-09/ad/";b="/jsc?pt\x3dstatic\x26slot\x3dlib\x26pt2\x3daanjs";a.data("useaannojq")&&(b+="-nojq");K.getScript(d+c+b,function(){r.d16g&&r.d16g.requestAanAd({elemId:"aan-ads-box",baseUrl:d,afterOnload:!0,
client:c,pt:"checkout",slot:"display-ad-right",pt2:"payselect"})})}}function Ja(){ab&&(a.declarative("auto-rewards-reg",["click"],Q),a.declarative("complete-rewards-register",["click"],F),a.declarative("confirm-card",["click"],I),a.declarative("register-card-rewards",["click"],ca),a.declarative("cancel-register-card-rewards",["click"],ka),a.declarative("show-currencies",["click"],Z),a.declarative("show-expire-date-fields",["click"],X),a.declarative("focus-cc-update-fields",["click"],z),a.declarative("show-rewards-reg",
["click"],D),a.declarative("submit-payment-form",["submit"],da),a.declarative("toggle-tfx-option",["click"],la),a.declarative("reregister-cc-in-dashboard",["click"],va),a.declarative("modify-expire-date-fields",["change"],Ga),e.isTouchCX()&&a.declarative("continue-button",["click"],G),ab=!1);E.paymentRows.unbind("click").has("input[name\x3dpaymentMethod]:enabled").bind("click",na);q.when("apx-payselect-helper").execute(function(){var a=t.get("payselect");a&&a.initEvents(E.paymentRows,ma)});E.paymentRows.find("input[name\x3dusePromoBalance]").unbind("change",
xa).bind("change",xa);E.disableSubmitButtons.length&&E.paymentRows.has("input[type\x3dcheckbox]:enabled").unbind("click",O).bind("click",O);E.existingPincodeNum.unbind("click",La).bind("click",La);E.paymentRows.find("select#cardCurrencyDropDown").unbind("change",C).bind("change",C);E.paymentRows.find(".rewards-list").hasClass("show-currency-input-widget-new")?E.paymentRows.find(".rewards-list").undelegate("label","click").delegate("label","click",ua).each(function(b,c){c=a.$(c);b=c.find("input.custom-rewards-input");
c=c.find(".custom-reward-points");var d=a.$(b);b={$element:d,maxAmount:d.data("max")};c={$element:a.$(c),decimalPlaces:d.data("decimalplaces"),ratio:d.data("ratio")};d=d.data("country-code");d=w.getCurrencyFormatByCountryCode(d);w.initializeInlineFormatting(b,c,d)}):E.paymentRows.find(".rewards-list").undelegate("label","click").delegate("label","click",ua).undelegate("input.custom-rewards-input","keyup").delegate("input.custom-rewards-input","keyup",P);if(e.isTouchCX())E.pageContainer.find("#existing-payment-methods").find("select, input[type\x3dtext], input[type\x3dpassword]").unbind("change",
U).bind("change",U),E.pageContainer.find("#existing-payment-methods").find("div.currency-list label.a-touch-radio").unbind("click").bind("click",la),E.pageContainer.find("#existing-payment-methods").find("label.promoLabel").unbind("click").bind("click",ta);else if(!g.isSPP()){var b=E.continueBtns.find(".a-button-text");K("#payPageContinueBtnStateFixEnabled").length?b.filter('input[type\x3d"button"]').unbind("mouseenter",Ia).bind("mouseenter",Ia).unbind("focus",Ia).bind("focus",Ia).unbind("mouseleave",
V).bind("mouseleave",V).unbind("blur",V).bind("blur",V):(b.filter('input[type\x3d"submit"]').unbind("mouseenter").bind("mouseenter",M).unbind("focus").bind("focus",M),b.filter('input[type\x3d"button"]').unbind("mouseleave").bind("mouseleave",S).unbind("blur").bind("blur",S))}E.netBankingSelect.unbind("change",ja).bind("change",ja);E.morePaymentMethodsSelect.unbind("change",sa).bind("change",sa);E.continueBtnBottom.unbind("click").bind("click",W);0<K("input[name\x3d'needDisableCODandEMIforGC']").length&&
(b=K("input#pm_300[type\x3d'checkbox'], #pm_gc_checkbox"),b.length&&(b.bind("change",Fa),b.is(":checked")&&za(b)));E.jppoints.length&&E.paymentRows.find('input[name\x3d"useAvailableBalance"]').bind("click",f.handleJPPointsOnPaymentRows);q.when("installments-payselect").execute(function(){a.trigger("installments-payselect:initEvents")});E.hideInputBoxes.length&&(E.paymentRows.find("#confirm-card").unbind("focus").bind("focus",T),E.paymentRows.find("#newExpDate").unbind("focus").bind("focus",Y),E.paymentRows.find("#newExpDate").unbind("change").bind("change",
aa))}function Ka(){var a=k.create();a.validatePayment(J());a.hasErrors()||g.makePrefetch(E.existingPaymentForm)}function La(a){a=E.showAmexWarning;null!==a&&(a.removeClass("hidden"),a.removeClass("amex_display"))}function Ma(){if(!e.isMobileCX()){E=e.getElements(ib);E.paymentRows.filter(".payment-selected-marker").removeClass("payment-selected-marker").addClass("payment-selected");var b=J();q.when("rewards-section-desktop").execute(function(b){a.trigger("rewards-section-desktop:page-load",ma)});q.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:page-load")});
Pa(b);Qa(b);ha(b);Ca();Ra(b);Va(b);Oa(b);Ya(b);Za(b);$a(b);Xa(b);xa();Ta();K(document).undelegate("div.pay-desktop .checkout-page-form","keypress").delegate("div.pay-desktop .checkout-page-form","keypress",ba);K(document).undelegate("div.pay-desktop .checkout-page-form .enter-custom-rewards","keyup").delegate("div.pay-desktop .checkout-page-form .enter-custom-rewards","keyup",ma);E.addressChallengeCardList.length&&E.addressChallengeCardList.show();E.paymentRows.find('input[type\x3d"radio"][value\x3d"rewardsmax"]').each(function(){K(this).siblings('[type\x3d"checkbox"]').remove()}).removeClass("hidden");
ia();L();Ja();E.existingPaymentForm.data("checkoutFormReady",!0);Ka();ya();E.orderSummaryBottom.show();qa(b);U();ma();H(b);u.determineIsMCBEnabled(E);u.toggleGCForMCB(b,E);K(".a-popover-preload").each(function(){var b=K(this).find(".rewards-registration").data("parentPaymentMethodId");b&&(a.off("a:popover:show:rewards-registration-"+b,d.displayRewardsRegister),a.off("a:popover:hide:rewards-registration-"+b,d.hideRewardsRegister),a.on("a:popover:show:rewards-registration-"+b,d.displayRewardsRegister),
a.on("a:popover:hide:rewards-registration-"+b,d.hideRewardsRegister))});q.when("a-tv").execute(function(c){a.trigger("a:tv:resize");b.find(".a-tv-navigate").length&&oa(b,b,!1)})}}function ma(b){g.isSPP()?(Aa()?E.disableSubmitButtons.length?(b=J(),b.find(".continue-center").addClass("aok-hidden"),b.find(".a-button-disabled").removeClass("aok-hidden")):(E.continueBtns.find(".a-button-primary:not(.a-button-disabled)").addClass("aok-hidden"),E.continueBtns.find(".a-button-disabled").removeClass("aok-hidden")):
S(),a.trigger("orderSummary:primaryActionButton:mirrorPanelBtnState")):K("#payPageContinueBtnStateFixEnabled").length&&M(b)}function Na(a,c){a=K(a.target).closest(".order-summary-box").find(".continue-button-errors");a.length&&c.length&&(c=b.triggerLeft(a,c),a.show(),a.offset(c))}function Ia(a){if((!E.continueErrPopover.filter(":visible").length||e.isTouchCX())&&E.continueErrPopover.find(".error-message:not(.hidden)").length&&a&&("mouseenter"===a.type||"focus"===a.type)){var b=K(a.target).closest(".continue-buttons").find(".a-button-disabled");
Na(a,b)}}function Aa(a){if(E.continueErrPopover.filter(":visible").length&&!e.isTouchCX())return!0;var c=J(),d=k.create();Ha(B,B.isEMIPaymentInstrument,c)&&(d.validateEMIMenuForContinueButton(c),c=Ha(B,B.getEMIMenuSelectedCardSection));d.validatePayment(c);d.apxValidatePayment(c,E.paymentRows);d=d.getHighestErrorId();if(!d||!d.identifier)return!1;E.continueErrPopover.find(".error-message").hide();c=c.find(".pincode-err-block");c.hide();c&&c.length&&d.target&&d.target.length&&d.target.addClass("a-form-error");
d.isPincodeError?(c.show(),c.addClass("a-form-error")):(E.continueErrPopover.find("#"+d.identifier).show(),E.continueErrPopover.find("#"+d.identifier).removeClass("hidden"),!a||"mouseenter"!==a.type&&"focus"!==a.type?g.isSPP||E.continueBtns.find(".a-button input").filter(":visible").each(function(){var a=K(this).closest(".order-summary-box").find(".continue-button-errors"),c=b.triggerLeft(a,K(this));a.show();a.offset(c)}):(c=K(a.target).closest(".continue-buttons").find(".a-button-primary"),Na(a,
c)));return!0}function Ra(b){E.paymentRows.find(".addr-challenge, .addr-challenge-msg").hide();E.hideInputBoxes.length?E.paymentRows.find(".card-name").show():E.paymentRows.find(".card-info").show();if("true"===e.getAttributeData(b,"isaddresschallenge")){var c=b.find(".addr-challenge, .addr-challenge-msg");0===c.length&&n.increaseCount("Checkout:Payment:AddressChallengeMissingInputAndMsg");c.show();E.hideInputBoxes.length?b.find(".card-name").hide():b.find(".card-info").hide();b=b.attr("paymentmethodid")?
b.attr("paymentmethodid"):b.attr("data-paymentmethodid");a.trigger("checkout:payment:challenge:log",b)}}function Sa(a){E.paymentRows.find(".expire-date-fields").hide();a=a.find(".expire-date-fields");a.length&&a.show()}function Ta(){E.paymentRows.find(".pci-blocking-cvv").length&&E.paymentRows.each(function(){var a=K(this),b=a.find(".pci-blocking-cvv");a.find("[type\x3dradio]:checked").val()&&b.length?b.show():b.length&&b.hide()})}function Ua(a,b){q.when("a-tv").execute(function(c){c.add(b.find(".payment-container"));
b.find(".tv-update").hide();var d=a.find(".tv-update");d.length&&(c.remove(a.find(".payment-container")),d.show(),pa(d.find(".a-button-primary")))})}function Va(a){E.paymentRows.find(".verified-fail-msg").hide();"true"===e.getAttributeData(a,"isverifiedfail")&&a.find(".verified-fail-msg").show()}function Oa(a){E.paymentRows.find(".cup-expired-msg").hide();"true"!==e.getAttributeData(a,"iscupcardexpired")&&"true"!==e.getAttributeData(a,"iscupcardexpiringsoon")||a.find(".cup-expired-msg").show()}function Pa(b){E.paymentRows.find(".rewards-list").hide();
E.paymentRows.find(".top-cell .inner-grid-left").show().find(".rewards-info").show();var c=b.find('.rewards-list input[type\x3d"radio"]'),d=c.filter(":checked");E.paymentRows.find('.rewards-list input[type\x3d"radio"]').prop("checked",!1);0<d.length?d.prop("checked",!0):b.find(".rewards-list").hasClass("apply-by-default")?c.filter('[value\x3d"rewardsmax"]').prop("checked",!0):c.filter('[value\x3d"rewardsnone"]').prop("checked",!0);c=b.find(".rewards-list").show();c.find('input[type\x3d"radio"][value\x3d"rewardscustom"]').is(":checked")&&
c.children(".enter-custom-rewards").show();e.isTouchCX()&&c.length&&(b.find(".rewards-info").hide(),b.find(".top-cell").addClass("bottom-line"),b.find(".bottom-cell").show());q.when("installments-payselect").execute(function(c){a.trigger("installments-payselect:toggleRewardsInstallmentEligibility",b)})}function Qa(a){E.paymentRows.find(".financial-offer-list").hide();E.paymentRows.find(".financial-offer-err-detail").hide();var b=a.find('.financial-offer-list input[type\x3d"radio"]'),c=b.filter(":checked");
b.prop("checked",!1);0<c.length?c.prop("checked",!0):b.first().prop("checked",!0);b=a.find(".financial-offer-list").show();a.find(".financial-offer-err-detail").show();e.isTouchCX()&&b.length&&(a.find(".top-cell").addClass("bottom-line"),a.find(".bottom-cell").show())}function bb(){K(document.body).find(".a-dropdown").each(function(){y.hide(K(this))})}function db(a){E.paymentRows.find(".installments-select").hide();E.paymentRows.find(".installments-message").show();a.find(".installments-select").show();
a.find(".installments-message").hide()}function cb(a){E.paymentRows.find("#savedCardSuppressed").hide();a.find("#savedCardSuppressed").show()}function eb(a){E.paymentRows.find(".installments-list").hide();a.find(".installments-list").show()}function Xa(a){E.paymentRows.find(".card-ref-num, .selected-note, .selected-more-payment-option").hide();E.paymentRows.find(".card-benefit").show();a.find(".card-ref-num, .selected-note, .selected-more-payment-option").show();a.find(".card-benefit").hide()}function fb(a){E.paymentRows.find(".otpBlock").hide();
a.find(".otpBlock").show()}function gb(a){E.paymentRows.find(E.ovdWidgetSection).hide();a.find(E.ovdWidgetSection).show()}function Ya(a){E.paymentRows.find(".vcc-info-prompt,.vcc-form-fields").hide();a.find(".vcc-info-prompt,.vcc-form-fields").show()}function Za(a){var b=E.newVDC.find("#vdcBanksSelect"),c=E.newVDC.find(".vdc-selected-bank-prompt").hide(),d=E.newVDC.find("#suppressedVerifiedDebitCard").hide(),e=b.val(),f="1"===K("#save_citi_card").val()?"CIT"!==e:!0,g="1"===K("#save_citi_card").val()&&
"CIT"===e;a.find("#vdcBanksSelect").length?""!==e&&"OtherBanks"!==e&&f&&(E.newVDC.find("option:selected").prop("disabled")?(d.show(),c.hide()):(d.hide(),c.show())):(("OtherBanks"===e||g)&&b.val(b.children("option").first().val()).trigger("change"),c.hide())}function Ha(a,b,c){if(!K.isEmptyObject(a)&&b)return b(c)}function $a(a){var b=K("#cash-back-ineligible-for-cod-message");b&&b.length&&((a=a.find("#cashOnDeliveryCash"))&&a.length?b.removeClass("hidden"):b.addClass("hidden"))}function hb(){var a=
K("#imb-wrapper");if(a.length&&a.is(":visible")){var b=a.find(".defaultPaymentMethodExpired"),c=a.find(".codUnavailable"),d=a.find("p").length;0===b.length&&0===c.length||1!==d||a.hide()}}var K=a.$,ab=!0,E={},ib={cardImages:"#newCreditCardImages",continueBtns:".continue-buttons:not(.place-order-button)",continueBtnTop:"#continue-top",continueBtnBottom:"#continue-bottom",continueErrPopover:".continue-button-errors",cvvColumnLabel:"#cvvColumnLabel",existingPaymentForm:"form.checkout-page-form",netBankingSelect:"#net-banking-select-list",
morePaymentMethodsSelect:"#more-payment-methods-select-list",newVDC:"#new-vdc",newEMI:"#newEmiCard",orderSummaryBottom:"#order-summary-bottom",pageContainer:"div.a-container",paymentRows:"#existing-payment-methods .payment-row",rewardsRegister:"#rewards-register",addressChallengeCardList:".address-challenge-card",hiddenFormFields:"#hiddenFormFields",jppoints:"#jppoints",gcpromo:"#gcPromo",disableSubmitButtons:"#disableSubmitButtons",hideInputBoxes:"#hideInputBoxes",showAmexWarning:"#showAmexWarning",
existingPincodeNum:"#existingPincodeNum",mcbBalanceWarning:"#mcbBalanceWarning",installmentsOnlyCards:".installments-only-card",ovdWidgetSection:"#ovdWidgetSection"};a.on("checkout:reload:payselect",Ma);a.on("checkout:reload:spp-payment",Ma);return{getSelectedPayment:J}});"use strict";q.when("A","page-detector").register("wechat-detector",function(a,l){var n=a.$,e=function(a){a&&!1!==a.isWeChatInstalled&&(a=n("#wechat_payment"),a.length&&a.show())},k=function(a){},m="MShopWeChatPayment";a.on("checkout:reload:payselect",
function(){n("#wechat_payment").length&&(n("#mShopWeChatApiName").length&&(m=n("#mShopWeChatApiName").val()),q.when("safe-mash").execute(function(a){r.cordova.require("cordova/exec")(e,k,m,"isWeChatInstalled",[])}))})});"use strict";q.when("A","page-main","client-side-metrics","ready").register("otp-for-cod",function(a,l,n){function e(){w=v("#cashOnDeliveryCash");if(w.length&&(x=w.find(I.verifyOTP),p=w.find(I.sendOTP),Q=x.length&&p.length,P=v(I.payMobile).length?1:0,Q&&(u=w.find(I.submitSendOTP),
B=w.find(I.submitVerifyOTP),A=w.find(I.submitResendOTP),t=w.find(I.changeOTPNumber),q=w.find(I.OTPPhoneNumber),J=w.find(I.otpCode),u.length&&B.length&&A.length&&t.length))){F=w.find(I.addURLHash).length;n.increaseCount(S.metricPrefix+S.block,1,1);u.click(function(){r();n.increaseCount(S.metricPrefix+S.send,1,1)});B.click(function(){M=q.val();T=J.val();h();var a=m(M);var b=/^\d{6}$/;b=T&&b.test(T);a&&b&&""!==R?c("VerifyOTP",R):b?a||w.find(I.otpServiceFailed).removeClass(I.aokHidden):w.find(I.invalidOTPError).removeClass(I.aokHidden);
n.increaseCount(S.metricPrefix+S.verify,1,1)});if(F&&location.hash&&location.hash.length){var a=location.hash;a=a.replace("#","");a=a.split(";");for(var d=0;d<a.length;d++)0<=a[d].indexOf(V.codehandle)&&(R=a[d].replace(V.codehandle,"")),0<=a[d].indexOf(V.contactid)&&(U=a[d].replace(V.contactid,"")),0<=a[d].indexOf(V.phonenumber)&&(M=a[d].replace(V.phonenumber,""),q.val(M));""!==R&&""!==U&&""!==M&&b()}A.click(function(){n.increaseCount(S.metricPrefix+S.resend,1,1);r()});t.click(function(){x.addClass(I.aokHidden);
p.removeClass(I.aokHidden);k(A,!1);k(B,!1);h();n.increaseCount(S.metricPrefix+S.changeNumber,1,1)})}}function k(a,b){b?a.addClass(I.aButtonDisabled):a.removeClass(I.aButtonDisabled);P?a.find("button").prop("disabled",b):a.find("input").prop("disabled",b)}function m(a){var b=/^\d{10}$/;return a&&b.test(a)}function g(){w.find(I.otpServiceFailed).removeClass(I.aokHidden)}function b(){var a=w.find(I.verifyOTPPhoneNumber);w.find(I.invalidPhoneNumber).addClass(I.aokHidden);p.hasClass(I.aokHidden)?w.find(I.otpResentSuccess).removeClass(I.aokHidden):
P&&w.find(I.otpSentSuccess).removeClass(I.aokHidden);p.addClass(I.aokHidden);x.removeClass(I.aokHidden);var b=M.substr(0,2)+"*****"+M.substr(7,9);a.text(b);k(A,!1)}function d(a){if(a!==G&&"object"!==typeof a)try{a=v.parseJSON(a)}catch(Z){a={}}a=a||{};var b=F&&location.hash?location.hash:"#";F&&location.hash&&";"!==b.slice(-1)&&(b+=";");var c=a.status;a.codeHandle&&null!==a.codeHandle&&(R=a.codeHandle,F&&"SEND-SUCCESS"===c&&(b=f(b,V.codehandle,R)));a.contactId&&null!==a.contactId&&(U=a.contactId,F&&
"SEND-SUCCESS"===c&&(b=f(b,V.contactid,U),b=f(b,V.phonenumber,M)));F&&(location.hash=b);w.find(I.otpAlertClass).addClass(I.aokHidden);if(W[c])W[c]();else W.DEFAULT()}function f(a,b,c){var d=a.indexOf(b);if(0<=d){var e=a.indexOf(";",d);e=0<=e?e:a.length;a=a.substring(0,d)+a.substring(e+1,a.length+1)}return a+b+c+";"}function c(b,c){a.ajax("/gp/buy/payselect/handlers/otpAjaxHandler.html",{method:"get",params:{phoneNumber:M,method:b,codeHandle:c,contactId:U,otp:T},success:d,error:function(){d({status:"SERVICE-FAILED"})}})}
function h(){J.val("");w.find(I.otpAlertClass).addClass(I.aokHidden)}function r(){h();M=q.val();m(M)?c("SendOTP",R):w.find(I.invalidPhoneNumber).removeClass(I.aokHidden)}var v=a.$,w,x,p,u,B,A,t,q,J,Q,P,F,M="",R="",U="",T="",I={aokHidden:"aok-hidden",aRadio:".a-radio",aButtonHidden:"a-button-hidden",aButtonDisabled:"a-button-disabled",payMobile:".pay-mobile",invalidOTPError:".invalidOTPError",verifyOTP:"#verifyOTP",sendOTP:"#sendOTP",submitSendOTP:"#submitSendOTP",submitVerifyOTP:"#submitVerifyOTP",
submitResendOTP:"#submitResendOTP",changeOTPNumber:"#changeOTPNumber",OTPPhoneNumber:"#OTPPhoneNumber",otpCode:"#otpCode",cashOnDeliveryCash:"#cashOnDeliveryCash",invalidPhoneNumber:".invalidPhoneNumber",otpServiceFailed:".otpServiceFailed",enterOTPLabel:"#enterOTPLabel",reEnterOTPLabel:"#reEnterOTPLabel",maxOTPError:".maxOTPError",numberAlreadyUsed:".numberAlreadyUsed",verifiedOTPSuccess:".verifiedOTPSuccess",verifyOTPPhoneNumber:"#verifyOTPPhoneNumber",otpResentSuccess:".otpResentSuccess",otpSentSuccess:".otpSentSuccess",
otpAlertClass:".otpAlertClass",phonenumberNotVerified:"phonenumberNotVerified",addURLHash:".addURLHash"},V={codehandle:"codehandle:",contactid:"contactid:",phonenumber:"phonenumber:"},S={metricPrefix:"PayPage-COD-OTP-",block:"Block",send:"Send",verify:"Verify",resend:"ReSend",changeNumber:"ChangeNumber"},W={"SERVICE-FAILED":g,"SEND-SUCCESS":b,"VERIFY-SUCCESS":function(){p.addClass(I.aokHidden);x.addClass(I.aokHidden);w.find(I.verifiedOTPSuccess).removeClass(I.aokHidden);w.find("."+I.phonenumberNotVerified).removeClass(I.phonenumberNotVerified);
P&&l.setContinueButtonStatus(!0)},"INVALID-NUMBER":function(){w.find(I.invalidPhoneNumber).removeClass(I.aokHidden)},"NUMBER-ALREADY-USED":function(){k(A,!0);k(B,!0);w.find(I.numberAlreadyUsed).removeClass(I.aokHidden)},"MAX-OTP-REACHED":function(){w.find(I.maxOTPError).removeClass(I.aokHidden);k(A,!0)},"INVALID-OTP":function(){w.find(I.invalidOTPError).removeClass(I.aokHidden);J.val("");P?J.attr("placeholder","Re-enter OTP"):(w.find(I.enterOTPLabel).addClass(I.aokHidden),w.find(I.reEnterOTPLabel).removeClass(I.aokHidden))},
DEFAULT:g};a.on("checkout:reload:payselect",e);a.on("checkout:reload:spp-payment",e)});"use strict";q.when("A","pay-common-util","ready").execute(function(a,l){var n={productGls:"#productGls",gcTypes:"#gcDeliveryTypes",device:"#device"},e=l.getElements(n);a.on("checkout:payment:challenge:log",function(k){var m={},g;for(g in n)n.hasOwnProperty(g)&&e[g]&&e[g].val()&&(m[g]=e[g].val());k&&(m.paymentInstrumentId=k);Object.keys&&Object.keys(m).length&&a.ajax("/gp/buy/payselect/handlers/log-payment-challenge.html?ref_\x3dcheckout-payment-challenge",
{method:"POST",params:m,timeout:1E3,cache:!1})})});"use strict";q.when("A","page-spinner-controller","page-main","page-transition-controller","page-conductor","client-side-metrics","button-blocker","ready").register("pay-auth",function(a,l,n,e,k,m,g){function b(){var a=h("#otp_id").val(),b=/^\d{6}$/;a&&b.test(a)?g.hide("pay-auth-otp-checks"):(a=h("#otp_invalid_msg").val(),g.show("pay-auth-otp-checks",a))}function d(b,c){l.show();a.ajax("validate-otp.html",{method:"post",params:{otp_name:b,paystationRequestId:c},
success:function(a){!a||"APPROVED"!==a.status&&"PENDING"!==a.status?(h("#otp_id").addClass("a-form-error"),h("#otpBadCode").removeClass("hidden"),l.hide()):(h("#isFormValidated").val("1"),v.submit())},error:function(a){l.hide()}})}function f(){h("#otp_id").removeClass("a-form-error");h("#otpBadCode").addClass("hidden")}function c(){m.increaseCount(w.metricPrefix+w.resend,1,1);var b="1"===h("#isPaystationFlow").val();if(b){var c="resend-otp.html?returnHtml\x3d0\x26isPaystationFlow\x3d1";l.show()}else c=
"resend-otp.html?returnHtml\x3d0";a.ajax(c,{method:"get",success:function(a){b&&(a&&1===a.successful&&(h("#authSourceId").val(a.authSourceId),h("#paystationRequestId").val(a.paystationRequestId)),l.hide())},error:function(a){b&&l.hide()}})}var h=a.$,r,v,w={metricPrefix:"Payauth-",resend:"Resend"};a.on("checkout:reload:payauth",function(){r=h("#resend_form");v=h("#otp_form");v.submit(function(a){var b=h(a.currentTarget);if("1"===b.find('input[id\x3d"isPaystationFlow"]').val()&&(f(),"1"!==b.find('input[id\x3d"isFormValidated"]').val()))return a=
b.find('input[id\x3d"otp_id"]').val(),b=b.find('input[id\x3d"paystationRequestId"]').val(),d(a,b),!1});r.submit(function(a){"1"===h("#isPaystationFlow").val()&&f();c();return!1});b();h("#otp_id").unbind("keyup").bind("keyup",b)})});"use strict";q.when("A","ajax-utility","client-side-metrics","loading-spinner-controller","pay-common-lib","pay-common-util","page-conductor","page-transition-controller","quantity-service","weblab-helper").register("pay-gil",function(a,l,n,e,k,m,g,b,d,f){function c(a){q=
a.popover;var b=u(q);A("#gil-estimates-popover-"+b+" .gil-popover-content").html("");A("#gil-estimates-popover-"+b+" .gil-popover-error").html("");a.popover.updatePosition(!0)}function h(a){q=a.popover;var b=u(q),c=A("#gil-estimates-popover-"+b);c.find("input[name\x3dgil-subtype]").val(b);e.showSpinner(c,!1,q);a="/gp/buy/payselect/handlers/get-gil-popover-content.html?cachebuster\x3d"+(new Date).getTime();var d="hasWorkingJavascript\x3d1\x26subtype\x3d"+encodeURIComponent(b);A.ajax({type:"POST",url:a,
data:d,dataType:"text",async:!0,cache:!1,dataFilter:function(a){return l.jsonify(a)},success:function(a,d,f){u(q)===b&&(n.increaseCount("Checkout:GIL:"+b+":IneligiblePopoverSuccess",1),d=q,e.hideSpinner(c),a&&a.errors&&0<a.errors.length?c.find(".gil-popover-error").show():a&&a.widgetHTML?c.find(".gil-popover-content").html(decodeURIComponent(a.widgetHTML)):c.find(".gil-popover-error").show(),d.updatePosition(!0))},error:function(a){u(q)===b&&(n.increaseCount("Checkout:GIL:"+b+":IneligiblePopoverError",
1),a=q,e.hideSpinner(c),c.find(".gil-popover-error").show(),a.updatePosition(!0))}})}function r(a){a.$event.preventDefault();a.$target.closest(".a-popover").find(".a-button-close").trigger("click")}function v(a){a.$event.preventDefault();var c=u(q),h=A("#gil-estimates-popover-"+c);e.showSpinner(h,!1,q);var k=w(a.$currentTarget.parents("#gil-estimates-popover-"+c));e.showSpinner(h,!1,q);d.callBatch(k,{success:function(d,e,h){u(q)===c&&(n.increaseCount("Checkout:GIL:"+c+":SubmitIneligiblePopoverSuccess",
1),r(a),b.show(),1==parseInt(A("input[name\x3d'gil-rendered-using-apx']").val(),10)&&f.isGILCreditCardEnabled()?(d=A(".pmts-select-payment-instrument-form"),e=q,"APX_PSP_TO_RCX_SPC"==(e.attrs?e.attrs("data").onSubmit:e.data.onSubmit)&&d&&0<d.length?g.continueClicked(null,d):n.increaseCount("Checkout:GIL:"+c+"Popover:ErrorRedirectingToSPC",1)):p(c))},error:function(a){u(q)===c&&(n.increaseCount("Checkout:GIL:"+c+":SubmitIneligiblePopoverError",1),a=q,e.hideSpinner(h),h.find(".gil-popover-error").show(),
a.updatePosition(!0))},isTrial:0})}function w(a){var b={};a.find(".gil-ineligible-items").children(".gil-ineligible-item").each(function(a,c){a=A(c).find('input[name^\x3d"ineligible-item"]').val();b[a]=0});return b}function x(a){a.$event.preventDefault();var b=A("#gil-ineligible-"+a.data.subtype).find(".gil-ineligible-items"),c=b.data("index"),d=b.data("size");c=(c+("next"===a.data.direction?1:-1)+d)%d;d=(c+1)%d;b.find(".gil-ineligible-item").addClass("aok-hidden").removeClass("a-span-last");a=b.find("#gil-ineligible-item-"+
c);d=b.find("#gil-ineligible-item-"+d);a.removeClass("aok-hidden");d.addClass("a-span-last").removeClass("aok-hidden");b.data("index",c)}function p(b){m.makeAjaxCall("/gp/buy/payselect/handlers/submit.html",{handler:"new-gil-payment",subtype:b},{successHandler:function(c,d,e){n.increaseCount("Checkout:GIL:"+b+":NewToExistingSuccess",1);g.ajaxUpdatePage(c,d,e);m.scrollTopTo(A("#existing-payment-methods [value\x3d"+b+"]"));if(g.isSPP())a.on("checkout:afterReload",function R(){A("#existing-gil input[value\x3d"+
b+"]").trigger("click");a.off("checkout:afterReload",R)});else A("#existing-gil input[value\x3d"+b+"]").trigger("click")},errorHandler:function(a,c,d){n.increaseCount("Checkout:GIL:"+b+":NewToExistingError",1);g.ajaxUpdatePage(a,c,d)}})}function u(a){return a.attrs?a.attrs("data").subtype:a.data.subtype}function B(){t&&(a.declarative("gil-close-popover",["click"],r),a.declarative("gil-submit-popover",["click"],v),a.declarative("gil-ineligible-pagination",["click"],x));A("#gil-cc-payment-type").length&&
(a.off("a:popover:beforeShow:gil-estimates",c),a.off("a:popover:show:gil-estimates",h),a.on("a:popover:beforeShow:gil-estimates",c),a.on("a:popover:show:gil-estimates",h));A("#gil-payment-type").length&&(a.off("a:popover:beforeShow:gil-si-estimates",c),a.off("a:popover:show:gil-si-estimates",h),a.on("a:popover:beforeShow:gil-si-estimates",c),a.on("a:popover:show:gil-si-estimates",h));t=!1}var A=a.$,t=!0,q;a.on("checkout:reload:payselect",B);a.on("checkout:reload:spp-payment",B);return{submitNewGilPayment:p,
displayGILEstimatesMobile:function(a,b,c){var d="/gp/buy/payselect/handlers/get-gil-popover-content.html?cachebuster\x3d"+(new Date).getTime(),e="hasWorkingJavascript\x3d1\x26subtype\x3d"+encodeURIComponent(a);m.makeAjaxCall(d,e,{successHandler:function(c,d,e){var f=l.jsonify(c);f&&!f.errors&&f.widgetHTML?n.increaseCount("Checkout:GIL:"+a+":Mobile:IneligibleSubPageSuccess",1):n.increaseCount("Checkout:GIL:"+a+":Mobile:IneligibleSubPageError",1);b(c,d,e)},errorHandler:function(b){n.increaseCount("Checkout:GIL:"+
a+":Mobile:IneligibleSubPageError",1);c(b)}})},actionCloseGilMobileSubpage:function(a){a.$event.preventDefault();A("#gil-estimates-subpage").remove();A(m.pages.main.pageId).show()},actionSubmitGilMobileSubpage:function(a,b,c){a.$event.preventDefault();A("#gil-ineligible-view");var e=w(a.$currentTarget.parents("#gil-ineligible-view"));d.callBatch(e,{success:function(c,d,e){n.increaseCount("Checkout:GIL:"+a.data.subtype+":Mobile:SubmitIneligibleSubPageSuccess",1);b(c,d,e)},error:function(b){n.increaseCount("Checkout:GIL:"+
a.data.subtype+":Mobile:SubmitIneligibleSubPageError",1);c(b)},isTrial:0})}}});"use strict";q.when("A","ready").register("new-verified-debit-card",function(a){});"use strict";q.when("A").register("apb-limit-messaging-helper",function(a){return{}});"use strict";q.when("A","page-conductor","page-transition-controller","quantity-service").register("rentals-ineligible-util",function(a,l,n,e){function k(a){var b={};a.find(".rentals-ineligible-item").each(function(a,c){a=g(c).find('input[name^\x3d"ineligible-item"]').val();
b[a]=0});return b}function m(){var a=g(".pmts-select-payment-instrument-form");a.attr("data-pmts-ajax-continuation","false");a.submit();n.show()}var g=a.$;return{actionSubmitRentalsIneligibleItemsInSfl:function(a,d,f,c,g){f=k(f);e.callBatch(f,{success:function(){c(a,d);m()},error:function(){g(d)},isTrial:0,ref:"chk_pay_rental_sfl"})},continueWithPaymentMethod:m,toggleButton:function(a,d){d?a.removeClass("a-button-disabled").removeAttr("disabled"):a.addClass("a-button-disabled").attr("disabled","disabled")}}});
"use strict";q.when("A","ajax-utility","client-side-metrics","loading-spinner-controller","pay-common-lib","pay-common-util","rentals-ineligible-util","a-modal").register("rentals-ineligible",function(a,l,n,e,k,m,g,b){function d(a){"undefined"!==typeof b?(t=b.get(a.popover.name),t.update({content:"\x3cdiv id\x3d'rentals-ineligible-popover-loading'\x3e\x3c/div\x3e",height:400,width:600,padding:"none",footer:null})):(t=a.popover,q=a.popover.$popover,t.update("\x3cdiv id\x3d'rentals-ineligible-popover-loading'\x3e\x3c/div\x3e"),
q.find(".a-popover-inner").css("padding","0"),q.find(".a-popover-footer").html(""),q.find(".a-popover-footer").css("width",600),t.updatePosition(!0));f()}function f(){var a=u("#rentals-ineligible-popover-loading");e.showSpinner(a,!1,t);u.ajax({type:"POST",url:"/gp/buy/payselect/handlers/get-rentals-ineligible-content.html?ref_\x3dchk_pay_rentals_ineligible",data:"hasWorkingJavascript\x3d1",dataType:"text",async:!0,cache:!1,dataFilter:l.jsonify,success:function(d,f,h){e.hideSpinner(a);d&&d.widgetHTML?
(n.increaseCount("Checkout:Rentals:RenderIneligiblePopoverDesktopSuccess",1),d=u(m.decodeJSONResponse(d.widgetHTML)),d.find("#no-ineligible-items").length?(t.$popover.find(".a-button-close").trigger("click"),g.continueWithPaymentMethod()):(h=d.find("#rentals-ineligible-popover-footer"),f=h.removeClass("aok-hidden"),h.remove(),A&&(g.toggleButton(f.find("#rentals-ineligible-submit"),!1),g.toggleButton(f.find("#rentals-ineligible-cancel"),!1)),"undefined"!==typeof b?(h=d.find(".rentals-ineligible-item").length,
t.update({content:d.html(),height:2<h?400:0,footer:f.html()}),x()):(t.update(d.html()),q.find(".a-popover-inner").css("padding","0"),q.find(".a-popover-footer").html(f.html()),q.find(".a-popover-footer").css("width",600),t.updatePosition(!0)))):c(a)},error:function(b){c(a)}})}function c(a){n.increaseCount("Checkout:Rentals:RenderIneligiblePopoverDesktopError",1);e.hideSpinner(a);a=u("#rentals-ineligible-content-unavailable-error");"undefined"!==typeof b?t.update({content:a.val(),padding:null,footer:null}):
(t.update(a.val()),q.find(".a-popover-inner").css("padding","100px"),q.find(".a-popover-footer").html(""),q.find(".a-popover-footer").css("width",600),t.updatePosition(!0))}function h(a){a.$event.preventDefault();A=!0;g.toggleButton(u("#rentals-ineligible-submit"),!1);g.toggleButton(u("#rentals-ineligible-cancel"),!1);var b=u("#rentals-ineligible-popover-container");e.showSpinner(b,!1,t);var c=u(".rentals-ineligible");g.actionSubmitRentalsIneligibleItemsInSfl(a,b,c,r,v)}function r(a,b){n.increaseCount("Checkout:Rentals:SubmitIneligibleItemsInSflDesktopSuccess",
1);A=!1;e.hideSpinner(b);w(a)}function v(a){n.increaseCount("Checkout:Rentals:SubmitIneligibleItemsInSflDesktopError",1);A=!1;g.toggleButton(u("#rentals-ineligible-submit"),!0);g.toggleButton(u("#rentals-ineligible-cancel"),!0);u("#rentals-ineligible-sfl-error").removeClass("aok-hidden");e.hideSpinner(a);"undefined"!==typeof b&&x()}function w(a){a.$event.preventDefault();"undefined"!==typeof b?t.hide():t.$popover.find(".a-button-close").trigger("click")}function x(){var a=t.$popover.find(".a-popover-inner").outerHeight(!0),
b=u("#rentals-ineligible-popover-fixed-content").outerHeight(!0);u("#rentals-ineligible-popover-items-container").css("height",a-b)}function p(){B&&(a.declarative("rentals-ineligible-cancel",["click"],w),a.declarative("rentals-ineligible-submit",["click"],h),a.on("a:popover:show:rentals-ineligible-popover",d));B=!1}var u=a.$,B=!0,A=!1,t,q;a.on("checkout:reload:payselect",p);a.on("checkout:reload:spp-payment",p);return{displayRentalsIneligible:function(){u("#rentals-ineligible-popover-trigger").trigger("click")}}});
"use strict";q.when("A").register("payment-marketplace-helper",function(a){return{}});"use strict";q.when("A","cvf","page-detector","weblab-helper","ready").register("cvf-old-amazon-aui-fixes",function(a,l,n,e){function k(){a.$(".cvf-widget-form .a-button-dropdown .a-button-text").css("text-overflow","unset")}function m(){var a=h(this).parent(),b=a.find(".a-native-dropdown option")[0];if(b&&b.hasAttribute("data-a-html-content")){var c=[];a.find(".cvf-widget-input.a-native-dropdown option").each(function(){c.push({phone_country_code:h(this).data("a-html-content"),
country_iso:h(this).val()})});var d=setInterval(function(){if(h(".a-popover-inner ul").length){var a="rtl"===h("html").attr("dir");h(".a-popover-inner ul").addClass("a-cvf-list-link");h.each(c,function(b,c){if(b=c.phone_country_code){if(a){b=b.split("+");var d=b[1];b=b[0].trim()+" "+d+"+"}h(".a-popover-inner [data-value\x3d'"+c.country_iso+"']").html(b)}});clearInterval(d)}},0)}h(".cvf-widget-form .a-button-dropdown").die("click")}function g(){var a=h(this).data("value");h(".cvf-widget-form .a-native-dropdown.cvf-widget-input").val(a).change()}
function b(){var a=h(this).parent().find(".a-dropdown-prompt"),b=h(this).find("option:selected").html().trim(),c=setTimeout(function(){a.html(b);clearTimeout(c)},0)}function d(){a.$(".cvf-widget-form .a-alert-inline.cvf-hidden").remove()}function f(){0===h(".cvf-widget-form").length&&(h("#apx-content .a-alert-info").first().remove(),h("[data-testid\x3d'pmts-cod-cash-description']").closest(".pmts-portal-component").find(".a-radio input").trigger("click"))}function c(){if(!q)if(v)a.on("a:pageUpdate a:ajax:complete",
d);else a.on("a:pageUpdate a:ajax:complete",k),h(".cvf-widget-form .a-button-dropdown").live("click",m),h(".a-cvf-list-link a").live("click",g),h(".cvf-widget-input.a-native-dropdown").live("change",b);a.on("cvf:verification:complete",f)}var h=a.$,q=n.isMobile(),v=r.P&&r.P.AUI_BUILD_DATE;e.isCvfOldAmazonUiFixesEnabled()&&(a.on("checkout:reload:payselect",c),a.on("checkout:reload:spp-payment",c))});"use strict";q.when("A","page-detector").register("alipay-detector",function(a,l){var n=a.$,e=function(){var a=
n("input[name\x3d'isAlipayAppPayment']");0<a.length&&l.isMobileSpc&&a.val("1")},k=function(a){},m=function(){var a=n("input[name\x3d'isAlipayRedirect']");0<a.length&&l.isMobileSpc&&a.val("1")},g=function(a){};a.on("checkout:reload:spc",function(){n("input[name\x3d'isAlipayAppPayment']").length&&q.when("safe-mash").execute(function(a){a=r.cordova.require("cordova/exec");a(e,k,"AlipayPlugin","isAlipayInstalled",[]);n("input[name\x3d'isAlipayRedirect']").length&&a(m,g,"AlipayPlugin","isAlipayFailReturnSupported",
[])})})});"use strict";q.when("A","page-transition-controller","page-detector").execute(function(a,l,n){function e(){var a=k("#backButtonProtection");a.length&&"1"===a.val()&&(l.showPageTransition(),document.location.reload())}var k=a.$;q.register("back-button-protection",function(){return{markAsDirty:function(){k("#backButtonProtection").val(1)}}});a.on("checkout:reload:spc",e);a.on("checkout:reload:spp-revieworder",e)});"use strict";q.when("A","page-transition-controller","loading-spinner-controller",
"ajax-utility","page-conductor","checkout-general-utils","page-detector","client-side-metrics","delivery-preferences-csm-helper").register("delivery-preferences-controller",function(a,l,n,e,k,m,g,b,d){function f(){var a=p.find("input[name\x3dpreference]:checked").val(),b=p.find("select[name\x3dSafePlaceLocation]");"NeighborDelivery"===a?(p.find("input[name\x3dneighbor-name]").removeAttr("disabled").removeClass("a-form-disabled"),p.find("input[name\x3dneighbor-house]").removeAttr("disabled").removeClass("a-form-disabled"),
k.isSPP()?q.when("a-dropdown").execute(function(a){a.getSelect(b).update({status:"disabled"})}):b.attr("disabled","disabled").closest(".a-button").addClass("a-button-disabled"),p.find(".safe-place-error").hide()):"SafePlaceDelivery"===a?(k.isSPP()?q.when("a-dropdown").execute(function(a){a.getSelect(b).update({status:"enabled"})}):b.removeAttr("disabled").closest(".a-button").removeClass("a-button-disabled"),p.find("input[name\x3dneighbor-name]").attr("disabled","disabled").addClass("a-form-disabled"),
p.find("input[name\x3dneighbor-house]").attr("disabled","disabled").addClass("a-form-disabled"),p.find(".neighbor-name-error").hide(),p.find(".neighbor-house-error").hide()):(p.find("input[name\x3dneighbor-name]").attr("disabled","disabled").addClass("a-form-disabled"),p.find("input[name\x3dneighbor-house]").attr("disabled","disabled").addClass("a-form-disabled"),k.isSPP()?q.when("a-dropdown").execute(function(a){a.getSelect(b).update({status:"disabled"})}):b.attr("disabled","disabled").closest(".a-button").addClass("a-button-disabled"),
p.find(".neighbor-name-error").hide(),p.find(".neighbor-house-error").hide(),p.find(".safe-place-error").hide());c(!0)}function c(a){var b=p.find("input[name\x3dpreference]:checked").val();p.find(".safe-place-error").hide();p.find(".neighbor-name-error").hide();p.find(".neighbor-house-error").hide();p.find("input").removeClass("a-form-error");p.find("div.a-input-text-wrapper").removeClass("a-form-error");p.find("select").closest(".a-button").removeClass("a-button-error");0<x("div.spc-tablet").length?
p.find(".set-delivery-preferences-button").removeClass("a-button-disabled"):p.find(".set-delivery-preferences-button").show();p.find(".save-disabled").hide();p.find(".current-blocker-content").text("");var c=!1;if("NeighborDelivery"===b){var d=p.find("input[name\x3dneighbor-name]");d.data("defaultValueRemoved")&&d.val()||(p.find(".neighbor-name-error").show(),d.addClass("a-form-error"),d.closest(".a-input-text-wrapper").addClass("a-form-error"),p.find(".current-blocker-content").html(p.find(".neighbor-name-error-text").text()),
c=!0);d=p.find("input[name\x3dneighbor-house]");d.data("defaultValueRemoved")&&d.val()||(p.find(".neighbor-house-error").show(),d.addClass("a-form-error"),d.closest(".a-input-text-wrapper").addClass("a-form-error"),p.find(".current-blocker-content").html(p.find(".neighbor-house-error-text").text()),c=!0)}else"SafePlaceDelivery"===b&&(d=p.find("select[name\x3dSafePlaceLocation]"),d.val()||(p.find(".safe-place-error").show(),d.closest(".a-button").addClass("a-button-error"),p.find(".current-blocker-content").html(p.find(".safe-place-error-text").text()),
c=!0));d=x("#disableSaveBtnWhenNoDeliveryPrefSelected").val();if(a&&c||"true"===d&&b===G)0<x("div.spc-tablet").length?p.find(".set-delivery-preferences-button").addClass("a-button-disabled"):p.find(".set-delivery-preferences-button").hide(),p.find(".save-disabled").show();return!c}function h(a){a&&a.$event&&a.$event.preventDefault();a="hasWorkingJavascript\x3d1\x26returnFullHTML\x3d1\x26cachebuster\x3d"+(new Date).getTime()+"\x26";var f="",g=p.find(".popover-deliv-prefs-content");g.data("obfuscatedEntityId")?
f=g.data("obfuscatedEntityId"):p.data("obfuscatedEntityId")&&(f=p.data("obfuscatedEntityId"));a+="obfuscatedEntityId\x3d"+f+"\x26";f=p.find("input[name\x3dpreference]:checked").val();""!==f&&(a+="prefDelLocation\x3d"+f+"\x26","NeighborDelivery"===f?(a+="neighborName\x3d"+encodeURIComponent(p.find("input[name\x3dneighbor-name]").val())+"\x26",a+="houseNo\x3d"+encodeURIComponent(p.find("input[name\x3dneighbor-house]").val())+"\x26"):"SafePlaceDelivery"===f&&(a+="safePlaceLocation\x3d"+p.find("select[name\x3dSafePlaceLocation]").val()+
"\x26"),f=p.find("input[name\x3ddefaultPreference]:checked").val(),f!==G&&""!==f&&(a+="isDefaultPreference\x3d1"));0<x("div.spc-tablet").length?l.show():n.showSpinner(p.find(".popover-deliv-prefs-content"),!1,u);d.recordCSMWithCurrentFieldValues("popover-submitted","preference","defaultPreference");x.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/update-delivery-preference.html",data:a,dataType:"text",contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc",
"x-amz-checkout-transition":"ajax"},success:function(a,c,d){B=!0;0<x("div.spc-tablet").length?l.hide():n.hideSpinner(p.find(".popover-deliv-prefs-content"));d.getResponseHeader("x-amz-checkout-page")?(p.find(".a-button-close").trigger("click"),k.ajaxUpdatePage(a,c,d)):(a=e.jsonify(a),k.redirect(a));b.increaseCount("checkoutSpcDeliveryPref-save",1)},error:function(a,b,d){0<x("div.spc-tablet").length?l.hide():n.hideSpinner(p.find(".popover-deliv-prefs-content"));c(!0)}})}function r(){p.find("input[name\x3d'neighbor-name'], input[name\x3d'neighbor-house']").unbind("focus").bind("focus",
function(){if(!x(this).data("defaultValueRemoved")){if(g.isMobileSpc()||g.isDesktopSpc())x(this).val(""),x(this).css("color","black");x(this).data("defaultValueRemoved",!0)}}).each(function(){(g.isMobileSpc()||g.isDesktopSpc())&&x(this).data("defaultValueRemoved")&&x(this).css("color","black")});p.find("input:radio[name\x3dpreference]").unbind("click").bind("click",f);p.find("input[name^\x3dneighbor]").unbind("keyup").bind("keyup",function(){c(!1)});0<x("div.spc-tablet").length?p.find("select[name\x3dSafePlaceLocation]").unbind("change").bind("change",
v):p.find("select[name\x3dSafePlaceLocation]").unbind("change").bind("change",function(){c(!1)})}function v(a){c(!0)&&h(a)}function w(a){var b=x("#spc-orders .delivery-preferences-options"),c="";if(a){var d=a.$currentTarget.find("input");c=b.find("input[name\x3dpreference]:checked").val()}else d=b.find("input[name\x3dpreference]:checked");b=d.val();if(c!==b){p.find(".expand-content").hide();c=d;var e=c.closest(".delivery-preferences-options");e.find("i.a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");
e.find("input").attr("checked",!1);c.siblings("i").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive");c.attr("checked",!0);"NeighborDelivery"===b||"SafePlaceDelivery"===b?d.closest(".deliverypreference-option").siblings(".expand-content").show():a&&h(a)}}var x=a.$;if(!x("html").hasClass("a-ie6")){var p,u,B;a.on("a:popover:beforeShow",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("button-blocker-delivprefs")&&(a.popover.$popover.find(".a-popover-inner").html(p.find(".current-blocker-content").text()),
a.popover.updatePosition())});a.on("a:popover:show",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("deliv-prefs")&&(b.increaseCount("checkoutSpcDeliveryPref-open",1),u=a.popover,p=u.$popover,B=!1,r(),d.recordCSMWithCurrentFieldValues("popover-displayed","preference","defaultPreference"),f(),p.find("select").trigger("change"))});a.on("a:popover:dismiss",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("deliv-prefs")&&(B||b.increaseCount("checkoutSpcDeliveryPref-dismissed",
1))});a.on("a:popover:hide",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("deliv-prefs")&&(B||d.recordCSM("popover-dismissed"))});a.declarative("delivery-preferences-switch-tablet",["click"],function(a){w(a)});a.declarative("delivery-preferences-expander-toggle",["click"],function(a){m.toggleExpanderContent(a)});a.declarative("set-delivery-preferences",["click","touchend"],function(a){a.$event.preventDefault();m.protectAgainstDoubleAction("set-delivery-preferences")||c(!0)&&h()});
a.declarative("delivery-preferences-set-default-checkbox-triggered","change",function(a){(a=p.find("#delivery-preferences-set-default-checkbox"))&&1===a.length&&(a.prop("checked")?b.increaseCount("checkoutSpcDeliveryPref-setAsDefault",1):b.increaseCount("checkoutSpcDeliveryPref-setAsTemporary",1))});a.on("checkout:reload:spc",function(){g.isTabletSpc()&&(p=x("#spc-orders .delivery-preferences-options"),w(),p.find("select").trigger("change"),r())})}});"use strict";q.when("A","page-detector","time-left-formatter",
"weblab-helper").register("fast-track-controller",function(a,l,n,e){function k(){for(var b in r)r[b]&&clearInterval(r[b]);a.defer(m)}function m(){c.DAY=f("#fasttrack-day").html();c.DAYS=f("#fasttrack-days").html();c.HOUR=f("#fasttrack-hour").html();c.HOURS=f("#fasttrack-hours").html();c.AND=f("#fasttrack-and").html();c.MINUTE=f("#fasttrack-minute").html();c.MINUTES=f("#fasttrack-minutes").html();c.SECOND=f("#fasttrack-second").html();c.SECONDS=f("#fasttrack-seconds").html();(f("#isfresh").length&&
f(".checkout.spc-mobile").length||f("#lazy-fresh-promise-delivery-message").length?f("#spc-form"):f("#spc-orders")).find(".fasttrack-span").each(function(){var b=f(this),c=b.find("input[name\x3d'countdownId']").val();h[c]=parseInt(b.find("input[name\x3d'fasttrackExpiration']").val());v[c]=a.now()/1E3+h[c];g(b.find("input[name\x3d'countdownThreshold']").val(),b,b.find("input[name\x3d'showSimplifiedCountdown']").val(),c);b.show()})}function g(a,c,e,f){0>=h[f]?d(c,null):a&&0<a&&h[f]>a?c.find("span.fasttrackavailable").hide():
(b(c,e),r[f]=setInterval(function(){b(c,e,f)},1E3))}function b(b,e,g){0<h[g]?(h[g]=Math.round(v[g]-a.now()/1E3),e=n.getTimeLeftFormatted(h[g],1===e||"1"===e?!0:!1,c),f("html").hasClass("a-tablet")?b.find("span[data-field\x3d'fasttrackcountdown']").html("\x26nbsp;"+e):b.find("span[data-field\x3d'fasttrackcountdown']").html(e),b.find("span.fasttrackexpired").hide(),b.find("span.fasttrackcountdown").show(),b.find("span.fasttrackavailable").show()):d(b,g)}function d(a,b){b?(r[b]&&clearInterval(r[b]),
a.find("span.fasttrackavailable").hide(),a.find("span.fasttrackexpired").show()):clearInterval(r[b])}var f=a.$;if(!f("html").hasClass("a-ie6")){var c={},h={},r={},v={};a.on("checkout:reload:spc",k);a.on("checkout:reload:spp-revieworder",k);return{spcLiteLazyLoadFastTrack:function(){k()}}}});"use strict";q.when("A","page-transition-controller","ajax-utility","page-conductor","client-side-metrics").register("gc-redeem-controller",function(a,l,n,e,k){function m(a){if(!q){a.preventDefault();h(a.currentTarget);
var b;0<h("#spc-gcpromoinput").length&&(b=encodeURIComponent(h("#spc-gcpromoinput").val()));0<h("#gc-promo-input").length&&(b=encodeURIComponent(h("#gc-promo-input").val()));var c=encodeURIComponent(h("#spc-usePromoOnly").val());if(b&&0!==b.length){var f=encodeURIComponent(h("input[name\x3dpurchaseTotal]").val());h("#gc-error").hide();h("#gc-promo-success").hide();h("#gc-success").hide();h("#gc-ineligible").hide();h("#promo-success").hide();e.isSPP()?(l.blockAllActions(),l.showTransitionInContainer(h("#payment"))):
l.show();var k=(new Date).getTime();a="/gp/buy/spc/handlers/add-giftcard-promotion.html/ref\x3dox_pay_page_gc_add";h(".checkout.spc.aui-templatized").length&&(a="/gp/buy/spc/handlers/add-giftcard-promotion.html/ref\x3dox_spc_gc_add");b="purchaseTotal\x3d"+f+"\x26claimcode\x3d"+b+"\x26disablegc\x3d"+c+"\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26hasWorkingJavascript\x3d1\x26fromAnywhere\x3d"+h("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+k;c=e.setAjaxTransitionHeader({"Cache-Control":"no-cache",
pragma:"no-cache","x-amz-checkout-page":"spc"});h.ajax({type:"POST",url:a,data:b,headers:c,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",complete:function(){q=!1},success:g,error:e.ajaxRedirect});q=!0}else d("addGiftCardOrPromo_NoCode")}}function g(a,c,g){var k=g.getResponseHeader("x-amz-checkout-page");if(k){if(e.ajaxUpdatePage(a,c,g),"spc"===k||"spclite"===k||"spp-revieworder"===k)(a=parseInt(h("#checkoutDisplayPage").data("delaySetTitle"),10)||parseInt(h("#gc-promo-delay").data("egcDelayUpdateRedemptionMessage"),
10)||0)?setTimeout(function(){b(g)},a):b(g)}else{a=n.jsonify(a);if(!a)return e.redirect();if(a.error)return d(a.error);if(a.errors)return d(a.errors);if(a.autohandlererror)return f(a.autohandlererror);e.redirect(a)}}function b(a){var b=a.getResponseHeader("x-updated-promo-type");a=a.getResponseHeader("x-updated-gc-applied-but-ineligible");b&&(a||h("#gc-promo-success").show(),0<h("div.spc-desktop").length?(h("#spc-gcpromoinput").removeClass("a-form-error"),h("#gc-promo-input").removeClass("a-form-error")):
(h("#spc-gcpromoinput").closest(".a-input-text-wrapper").removeClass("a-form-error"),h("#gc-promo-input").closest(".a-input-text-wrapper").removeClass("a-form-error")),"giftcard"===b?(c("applied"),a?(h("#gc-ineligible").show(),c("gcIneligible")):h("#gc-success").show()):h("#promo-success").show())}function d(a){l.hide();h("#gc-error p").hide();h("#gc-error").show();c("error");0<h("div.spc-desktop").length?(h("#spc-gcpromoinput").addClass("a-form-error"),h("#gc-promo-input").addClass("a-form-error")):
(h("#spc-gcpromoinput").closest(".a-input-text-wrapper").addClass("a-form-error"),h("#gc-promo-input").closest(".a-input-text-wrapper").addClass("a-form-error"));h(0<h("#gc-promo-input").length?"."+v[a]:"#"+a).show()}function f(a){if(a){var b=a.action,c="/gp/buy/payselect/handlers/error.html?errorType\x3d"+encodeURIComponent(a.type?a.type:b&&b.code?b.code:"string"===typeof a?a:"Unknown:pipelineJSError");"fatal"===b?c+="\x26errorAction\x3dfatal":"redirect"===b&&(a.url?c=a.url:"cart"===a.page&&(c="/gp/cart/view.html"));
r.location.href=c}else r.location.href="/gp/buy/payselect/handlers/error.html?errorType\x3dUnknown:pipelineJSError"}function c(b){var c=a.state("cxt-gc-redemption-method").method;k.increaseCount("rcxGCRedeem:"+c+":"+b,1)}var h=a.$,q=!1;if(!h("html").hasClass("a-ie6")){a.state("cxt-gc-redemption-method",{method:"type"});var v={addGiftCardOrPromo_Unknown:"UNKNOWN",addGiftCardOrPromo_NoCode:"NO_CODE",addPromo_InvalidForPurchase:"PROMO_INVALID_FOR_PURCHASE",addPromo_BadCode:"PROMO_BAD_CODE",addPromo_ExpiredCode:"PROMO_EXPIRED_CODE",
addPromo_InvalidForOrgUnit:"PROMO_INVALID_FOR_ORG_UNIT",addPromo_OfferNotYetBegun:"USED_BEFORE_START_DATE",addPromo_AlreadyRedeemed:"PROMO_ALREADY_REDEEMED",addGiftCard_AlreadyRedeemedByAnotherAccount:"GC_ALREADY_REDEEMED_BY_ANOTHER_ACCOUNT",addGiftCard_AlreadyRedeemedByThisAccount:"GC_ALREADY_REDEEMED_BY_THIS_ACCOUNT",addGiftCard_BadCode:"GC_BAD_CODE",addGiftCard_ExpiredCode:"GC_EXPIRED_CODE",addGiftCard_Cancelled:"CANCELLED_CODE",addGiftCard_WrongOrgUnit:"GC_WRONG_ORG_UNIT",addGiftCard_ServiceDown:"GC_SERVICE_DOWN",
addGiftCard_InvalidForAGS:"GC_INVALID_FOR_AGS",addGiftCard_PassedClaimByDate:"PASSED_CLAIM_BY_DATE",addGiftCard_OfferNotYetBegun:"GC_NOT_YET_BEGUN",addGiftCard_ExceededMaxLimit:"GC_EXCEED_MAX_LIMIT",addGiftCard_Disabled:"GC_DISABLED",addGiftCard_OTP_Required:"GC_OTP_REQUIRED",addGiftCard_SEVIS_Decline:"GC_SEVIS_DECLINE",addGiftCard_OCRAH_Decline:"GC_OCRAH_DECLINE",addGiftCard_DEFAULT_Message:"GC_DEFAULT_MESSAGE"};a.declarative("gc-element",["click"],function(a){var b=a.data.click;b&&null!==b&&m(a.$event)});
a.on("a:expander:redeem-gc-expander:toggle:expand",function(a){k.increaseCount("checkout:spp-payment:expand_addgc_coll",1)});h(document).delegate("#spc-gcpromoinput, #gc-promo-input","keypress",function(a){13===a.which&&m(a)});return{actionAddGiftPromotion:m,giftSystemErrorHandling:f}}});"use strict";q.when("A","page-transition-controller","loading-spinner-controller","ajax-utility","page-conductor","checkout-general-utils","page-detector","client-side-metrics","gift-utility","weblab-helper").register("gift-popover-controller",
function(a,l,n,e,k,m,g,b,d,f){function c(){var a=H;a.find("#select-recipient").empty();for(var b=0;b<L.length;b++){var c=D("\x3coption/\x3e").attr({value:L[b].value}).text(L[b].text);a.find("#select-recipient").append(c)}ja&&(b=a.find('#select-recipient option[value\x3d"'+ja+'"]').attr("selected","selected"),a.find("#select-recipient").closest("#popover-gift-connection-recipient").find(".a-placeholder").text(b.text()),X())}function h(){a.defer(function(){D("#spc-orders").find(".gift-popover-link").each(function(){D(this).data("action")&&
D(this).removeAttr("href").attr("tabindex",0)})});D(".larger-image-link").find("a").removeAttr("href")}function q(a){var b=H;b.find(".gift-error-box").hide();b.find(".fake-label").each(function(){D(this).unbind("click").bind("click",function(){D(this).closest(".popover-checkbox").find("input").trigger("click")})});a&&a.item&&a.item.title&&b.find(".popover-gift-top .gift-item-title span").html(a.item.title);a&&a.item&&a.item.isAutoripEligible?b.find("#gift-autorip-unavailable-msg").show():b.find("#gift-autorip-unavailable-msg").hide();
if(a&&a.obfuscatedEntityId){var e=b.find(".set-gift-options-button input");e.unbind("click").bind("click",{obfuscatedentityid:a.obfuscatedEntityId,giftData:a},v);m.bindActionEnterKeyOnButton(e)}ha?(fa=a&&a.item&&a.item.isAmazonFulfilled,qa=!(a&&a.address&&0===a.address.shipToSelf),fa&&(a&&a.options&&a.options.canHaveMessage||a&&a.options&&a.options.canBeWrapped)?(p(!0),b.find(".mfn-hide-prices").hide(),b.find(".include-gift-receipt").show()):fa||(p(!0),b.find(".include-gift-receipt").hide(),b.find(".mfn-hide-prices").show(),
b.find(".include-gift-message").show()),sa=b.find(".include-gift-message").is(":visible"),N()):a&&a.options&&a.options.canHidePrices?b.find(".hide-prices-checkbox").closest("div").show():b.find(".hide-prices-checkbox").closest("div").hide();a&&a.selected&&(e=O(b.find(".hide-prices-checkbox")),a.selected.hidePrices?e.attr("checked",!0):e.removeAttr("checked"));if(a&&a.item&&a.item.purchaseIsKindle){if(e=b.find(".kindle-registration-box"),e.show(),e.find(".register-kindle-customer-name").html(b.find(".gift-customer-name").html()),
!ha){e=O(b.find(".kindle-reg-radio-another-account"));var f=O(b.find(".kindle-reg-radio-your-account"));a.selected.hidePrices||a.selected.isWrapped?(f.removeAttr("checked"),e.attr("checked",!0)):(e.removeAttr("checked"),f.attr("checked","checked"));O(b.find(".hide-prices-checkbox")).trigger("change")}}else b.find(".kindle-registration-box").hide();if(a&&a.options&&a.options.canHaveMessage){a&&a.selected&&(e=a.selected.message,f=O(b.find(".include-gift-message-checkbox")),e&&e.length?(b.find("textarea[name\x3d'gift-message-text']").val(e),
B(!0)):null===e&&(a.selected.isWrapped||a.selected.hasReceipt)?(f.removeAttr("checked"),b.find(".textarea[name\x3d'gift-message-text']").val("")):(b.find("textarea[name\x3d'gift-message-text']").val(""),e="",ha?(e+=b.find(".sample-gift-msg-greeting").html(),a&&a.address&&a.address.firstName&&!qa&&(e+=" "+a.address.firstName),e=e+",\n"+b.find(".sample-gift-msg").html(),e+="\n"):(e+=b.find(".sample-gift-msg").html(),e+="\n\n"),e+=b.find(".sample-gift-msg-from").text(),e=ha?e+d.getNameWithNoTitle(b.find(".gift-customer-name").html()):
e+d.getFirstName(b.find(".gift-customer-name").html()),b.find("textarea[name\x3d'gift-message-text']").val(e),!ha||qa&&sa||B(!0)));var g=D(".gift-message-warning").length;e=function(){ha&&B(!0);F(a.options.maxMessageChars,a.options.maxMessageLines,a.options.hasFixedGiftMsgLimit);if(g){var b=H.find("textarea[name\x3d'gift-message-text']");d.toggleGiftMessageWarning(b,H)}};if(a&&a.options){var h=b.find("textarea[name\x3d'gift-message-text']");h.bind("keyup",e);h.bind("mouseup",e);F(a.options.maxMessageChars,
a.options.maxMessageLines,a.options.hasFixedGiftMsgLimit);g&&d.toggleGiftMessageWarning(h,b);O(b.find(".include-gift-message-checkbox")).bind("change",function(){var c=D(this).is(":checked"),e=a.options.maxMessageChars,f=a.options.maxMessageLines,k=a.options.hasFixedGiftMsgLimit,m=H,n=m.find("textarea[name\x3d'gift-message-text']");c?ha&&t():(0<m.find(".validateInputCharactersOnBlur.a-form-error").size()&&(m.find(".validateInputCharactersOnBlur.a-form-error").removeClass("a-form-error"),0<m.find("#onblur-character-validation-error-gift-message-text").size()&&
m.find("#onblur-character-validation-error-gift-message-text").remove()),ha?N():(n.val(""),F(e,f,k)));g&&d.toggleGiftMessageWarning(h,b)})}}else b.find(".popover-gift-message-text").css("visibility","hidden"),b.find(".include-gift-message").css("visibility","hidden"),ha&&(b.find(".include-gift-message").hide(),b.find(".popover-gift-message").css("visibility","hidden")),b.find(".popover-gift-message-not-available").show();a&&a.options&&!a.options.canBeWrapped?(b.find(".wrap-option").hide(),b.find(".popover-gift-no-wrap-available").show(),
b.find(".hide-prices-amazon-msg").hide(),b.find(".hide-prices-note").hide(),b.find(".hide-prices-merchant-msg").show(),O(b.find(".hide-prices-checkbox")).attr("disabled",!1)):a&&a.item&&a.item.isAmazonFulfilled?(b.find(".wrap-option").hide(),b.find(".popover-gift-fba-wrap").show(),b.find(".hide-prices-amazon-msg").show(),b.find(".hide-prices-merchant-msg").hide(),(e=a.options.wraps[0].imageurl)&&0<e.length&&(b.find(".large-preview").find("img").attr("src",e),b.find(".large-preview").show(),b.find(".fba-wrap-checkbox").show(),
f=b.find(".larger-image-link"),f.unbind("click").bind("click",{imageURL:e},M),m.bindActionEnterKeyOnButton(f)),a.options.wraps[0].description&&b.find(".gift-wrap-title").show().html(a.options.wraps[0].description),"1"===D("#multipleAFNGiftWrapOption").val()?a.options&&a.options.wraps&&1<=a.options.wraps.length&&(e=b.find(".popover-gift-amazon-wrap"),w(b,e),ba(a,"afn",e)):a.options&&a.options.wraps&&1===a.options.wraps.length?(b.find(".popover-gift-amazon-wrap").hide(),b.find(".popover-gift-merchant-wrap").hide(),
b.find(".fba-wrap-checkbox .gift-wrap-price").html(a.options.wraps[0].price),f=O(b.find(".amazon-gift-wrap")),f.val(a.options.wraps[0].id),e=O(b.find(".hide-prices-checkbox")),a.selected.isWrapped?(f.attr("checked",!0),a.item.purchaseIsKindle||(e.attr("checked",!0),e.attr("disabled",!0),b.find(".hide-prices-note").show())):(f.removeAttr("checked"),e.attr("disabled",!1),b.find(".hide-prices-note").hide())):a.options&&a.options.wraps&&1<a.options.wraps.length&&(e=b.find(".popover-gift-amazon-wrap"),
w(b,e),C(a,"afn",e))):(b.find(".wrap-option").hide(),O(b.find(".hide-prices-checkbox")).removeAttr("disabled"),b.find(".hide-prices-amazon-msg").hide(),b.find(".hide-prices-note").hide(),b.find(".hide-prices-merchant-msg").show(),b.find(".large-preview").hide(),e=b.find(".popover-gift-merchant-wrap").show(),e.find(".mfn-wrap-copy").remove(),C(a,"mfn",e));ha&&(Q(),P(),J());if(0<D(".enable-gift-connections").length){b.find("#popover-gift-connection select.a-touch-select-input").each(function(){D(this).unbind("change").bind("change",
function(){var a=D(this),b=a.siblings("a.a-placeholder");a=a.find(":selected").text();b.text(a);return!1})});b.find("#select-recipient").bind("change",function(a){Y(a);return!1});b.find("#select-occasion").bind("change",function(a){aa(a);return!1});b.find("#input-recipient-first-name").keyup(function(){X()});b.find("#input-recipient-last-name").keyup(function(){X()});b.find("#popover-gift-connection-recipient").unbind("click").bind("click",function(a){a=H;ia||a.find("#select-recipient-spinner").show()});
ja=G;if(a.giftConnection){typeof a.giftConnection.giftlistTypeId!==G&&"0"===a.giftConnection.giftlistTypeId&&typeof a.giftConnection.occasionId!==G&&"0"===a.giftConnection.occasionId&&b.find("#include-gift-connection-checkbox").attr("checked",!1);a.giftConnection.firstName&&b.find("#input-recipient-first-name").val(a.giftConnection.firstName);a.giftConnection.lastName&&b.find("#input-recipient-last-name").val(a.giftConnection.lastName);if("1"===a.giftConnection.giftlistTypeId||"2"===a.giftConnection.giftlistTypeId)e=
b.find('#select-recipient option[value\x3d"'+a.giftConnection.giftlistTypeId+'"]').attr("selected","selected"),b.find("#select-recipient").closest(".a-button-inner").find(".a-placeholder").text(e.text()),b.find(".gift-connection-recipient-extra").show();if(a.giftConnection.giftlistId&&"0"!==a.giftConnection.giftlistId)ja=a.giftConnection.giftlistId;else if("0"===a.giftConnection.giftlistTypeId||"1"===a.giftConnection.giftlistTypeId||"2"===a.giftConnection.giftlistTypeId)ja=a.giftConnection.giftlistTypeId;
a.giftConnection.occasionId&&(e=b.find('#select-occasion option[value\x3d"'+a.giftConnection.occasionId+'"]').attr("selected","selected"),b.find("#select-occasion").closest(".a-button-inner").find(".a-placeholder").text(e.text()));a.giftConnection.occasionMonth&&(e=b.find('#select-occasion-month option[value\x3d"'+a.giftConnection.occasionMonth+'"]').attr("selected","selected"),b.find("#select-occasion-month").closest(".a-button-inner").find(".a-placeholder").text(e.text()));a.giftConnection.occasionDay&&
(e=b.find('#select-occasion-day option[value\x3d"'+a.giftConnection.occasionDay+'"]').attr("selected","selected"),b.find("#select-occasion-day").closest(".a-button-inner").find(".a-placeholder").text(e.text()));a.giftConnection.age&&(e=b.find('#select-occasion-age option[value\x3d"'+a.giftConnection.age+'"]').attr("selected","selected"),b.find("#select-occasion-age").closest(".a-button-inner").find(".a-placeholder").text(e.text()));if("1"===a.giftConnection.occasionId||"2"===a.giftConnection.occasionId)b.find(".gift-connection-occasion-extra").show(),
"2"===a.giftConnection.giftlistTypeId&&b.find("#select-occasion-age-row").show();a.giftConnection.hasReminder&&"0"===a.giftConnection.hasReminder&&b.find("#occasion-has-reminder-checkbox").attr("checked",!1)}(!a.giftConnection||typeof a.giftConnection.occasionId===G||"1"!==a.giftConnection.occasionId&&"2"!==a.giftConnection.occasionId&&"3"!==a.giftConnection.occasionId)&&X();L&&(typeof ja!==G||a.registryId in wa)?(typeof ja===G&&(ja=wa[a.registryId]),c(),b.find("#select-recipient").show(),b.find("#select-recipient-spinner").hide(),
ia=!0):(ia=!1,typeof ja!==G?ea():ea(a.registryId))}H.find(".content-container").css("visibility","visible");pa.updatePosition(!0);n.hideSpinner(b.find(".popover-content-main"))}function v(a){var b=H,c="";if(!(0<b.find(".validateInputCharactersOnBlur.a-form-error").size())){a&&a.data&&a.data.obfuscatedentityid&&(c+="obfuscatedEntityId\x3d"+a.data.obfuscatedentityid+"\x26");fa&&(c+="isAFN\x3d1\x26");O(b.find(".include-gift-receipt-checkbox")).is(":checked")&&(c+="includeReceipt\x3d1\x26");O(b.find(".include-gift-message-checkbox")).is(":checked")?
(c+="includeMessage\x3d1\x26message\x3d"+encodeURIComponent(b.find("textarea[name\x3d'gift-message-text']").val())+"\x26",c+="maxChars\x3d"+a.data.giftData.options.maxMessageChars+"\x26",c+="maxLines\x3d"+a.data.giftData.options.maxMessageLines+"\x26"):c+="includeMessage\x3d0\x26";c=O(b.find(".hide-prices-checkbox")).is(":checked")?c+"hidePrices\x3d1\x26":c+"hidePrices\x3d0\x26";b.find(".kindle-registration-box").is(":visible")&&(c+="isKindlePurchase\x3d1\x26");var d;if(b.find(".popover-gift-fba-wrap").is(":visible"))if(b.find(".popover-gift-amazon-wrap").is(":visible")){if((d=
b.find("input[name\x3d'afn-gift-wrap']:checked").eq(0).val())&&d.length)for(c+="giftWrap\x3d"+d+"\x26",d=0;d<a.data.giftData.options.wraps.length;d++)if(b.find(".popover-gift-amazon-wrap").find(".afn-wrap-"+d).is(":checked")){c+="currencyAmount\x3d"+a.data.giftData.options.wraps[d].priceAmount+"\x26";c+="currencyUnit\x3d"+a.data.giftData.options.wraps[d].unit+"\x26";break}}else d=O(b.find(".amazon-gift-wrap")),d.is(":checked")&&(c+="giftWrap\x3d"+d.val()+"\x26",a.data.giftData.options&&(c+="currencyAmount\x3d"+
a.data.giftData.options.wraps[0].priceAmount+"\x26",c+="currencyUnit\x3d"+a.data.giftData.options.wraps[0].unit+"\x26"));else if(b.find(".popover-gift-merchant-wrap").is(":visible")&&(d=b.find("input[name\x3d'mfn-gift-wrap']:checked").eq(0).val())&&d.length)for(c+="giftWrap\x3d"+d+"\x26",d=0;d<a.data.giftData.options.wraps.length;d++)if(b.find(".popover-gift-merchant-wrap").find(".mfn-wrap-"+d).is(":checked")){c+="currencyAmount\x3d"+a.data.giftData.options.wraps[d].priceAmount+"\x26";c+="currencyUnit\x3d"+
a.data.giftData.options.wraps[d].unit+"\x26";break}if(0<D(".enable-gift-connections").length)if(b.find("#include-gift-connection-checkbox").is(":checked")){c+="includeGiftConnection\x3d1\x26";a=b.find("#select-recipient").val();c+="gcGiftlistTypeId\x3d"+a+"\x26";if("1"===a||"2"===a)c+="gcFirstName\x3d"+b.find("#input-recipient-first-name").val()+"\x26",c+="gcLastName\x3d"+b.find("#input-recipient-last-name").val()+"\x26";d=b.find("#select-occasion").val();c+="gcOccasionId\x3d"+d+"\x26";if("1"===d||
"2"===d)c+="gcMonth\x3d"+b.find("#select-occasion-month").val()+"\x26",c+="gcDay\x3d"+b.find("#select-occasion-day").val()+"\x26","1"===d&&"2"===a&&(c+="gcAge\x3d"+b.find("#select-occasion-age").val()+"\x26"),c+="gcHasReminder\x3d"+(b.find("#occasion-has-reminder-checkbox").is(":checked")?"1":"0")+"\x26"}else c+="includeGiftConnection\x3d0\x26";(a=D("input#executionId").val())&&(c+="executionId\x3d"+a+"\x26");a=(new Date).getTime();c+="isClientTimeBased\x3d"+D("input[name\x3d'useCtb']").val()+"\x26returnjson\x3d1\x26isDecoupleSPC\x3d1\x26hasWorkingJavascript\x3d1\x26returnFullHTML\x3d1\x26cachebuster\x3d"+
a;k.isSPP()&&(pa.hide(),a=D("#setOrderingPrefsCheckbox"),a.length&&a.is(":checked")&&(c+="\x26saveAsDefaultsSelected\x3d1"));l.show();a=k.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"});D.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/update-gift.html",data:c,dataType:"text",async:!0,cache:!1,headers:a,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(a,c,d){d.getResponseHeader("x-amz-checkout-page")?(k.isSPP()||b.find(".a-button-close").trigger("click"),
k.ajaxUpdatePage(a,c,d)):(a=e.jsonify(a),k.redirect(a))},error:function(a,b,c){k.ajaxRedirect(a,b,c)}})}}function w(a,b){a.find(".fba-wrap-checkbox").hide();a.find(".large-preview").hide();b.show();b.find(".afn-wrap-copy").remove()}function x(){var a=H,b=a.find(".popover-gift-amazon-wrap").is(":visible"),c=O(a.find(".amazon-gift-wrap")),d=O(a.find(".afn-wrap-none")),e=O(a.find(".hide-prices-checkbox"));if(c.is(":checked")||!d.is(":checked")&&b)e.attr("checked",!0),e.attr("disabled",!0),a.find(".hide-prices-note").show();
else if(c.not(":checked")||d.is(":checked")&&b)e.attr("checked",!0),e.attr("disabled",!1),a.find(".hide-prices-note").hide()}function p(a){var b=H,c=O(b.find(".include-gift-receipt-checkbox"));b=O(b.find(".mfn-hide-prices-checkbox"));a?(fa&&!c.is(":checked")&&c.attr("checked",!0).trigger("change"),fa||b.is(":checked")||b.attr("checked",!0).trigger("change")):(fa&&c.is(":checked")&&c.removeAttr("checked").trigger("change"),!fa&&b.is(":checked")&&b.removeAttr("checked").trigger("change"))}function u(a){var b=
H,c=O(b.find(".include-gift-receipt-checkbox"));b=O(b.find(".mfn-hide-prices-checkbox"));a?(p(!0),fa?c.attr("disabled","disabled"):b.attr("disabled","disabled")):fa?c.removeAttr("disabled"):b.removeAttr("disabled")}function B(a){var b=O(H.find(".include-gift-message-checkbox"));a?(b.is(":checked")||b.attr("checked",!0).trigger("change"),A(!1),t()):(b.is(":checked")&&b.removeAttr("checked").trigger("change"),N())}function A(a){var b=H,c=b.find(".no-message-warning"),d=b.find(".no-receipt-warning"),
e=b.find("textarea[name\x3d'gift-message-text']");b=b.find(".message-remaining-text");a&&!d.is(":visible")?(f.showGiftTextAreaOnWarning()||e.addClass("gift-message-warning"),b.hide(),c.show()):(f.showGiftTextAreaOnWarning()||e.removeClass("gift-message-warning"),c.hide(),b.show())}function t(){var a=H,b=a.find("textarea[name\x3d'gift-message-text']");a=a.find(".gift-message-label");b.removeClass("gift-message-inactive");a.removeClass("a-color-secondary")}function N(){var a=H,b=a.find("textarea[name\x3d'gift-message-text']");
a=a.find(".gift-message-label");b.addClass("gift-message-inactive");a.addClass("a-color-secondary")}function J(){var b=H,c=O(b.find(".include-gift-message-checkbox")),d=b.find(".gift-msg-on-card"),e=b.find(".gift-msg-on-receipt"),f=a.trim(b.find(".gift-message-default-placeholder").text()),g=a.trim(b.find(".gift-message-with-wrap-placeholder").text()),h=b.find("textarea"),k=!1;b.find(".amazon-gift-wrap").each(function(){O(D(this)).is(":checked")&&(k=!0)});b.find(".afn-gift-wrap").each(function(){O(D(this)).is(":checked")&&
(k=!0)});b.find(".mfn-gift-wrap").each(function(){O(D(this)).is(":checked")&&(k=!0)});k?(e.hide(),d.show(),h.attr("placeholder",g),fa&&(B(!0),sa&&c.attr("disabled","disabled"))):(d.hide(),fa&&e.show(),h.attr("placeholder",f),c.removeAttr("disabled"))}function Q(a){a=H;var b=O(a.find(".include-gift-receipt-checkbox"));b=fa&&b.is(":checked");var c=O(a.find(".mfn-hide-prices-checkbox"));c=!fa&&c.is(":checked");b||c?(T(),a.find(".kindle-reg-msg-your-account").hide(),a.find(".kindle-reg-msg-another-account").show()):
(I(),u(!1),a.find(".kindle-reg-msg-another-account").hide(),a.find(".kindle-reg-msg-your-account").show())}function P(a){a=H;var b=!1;O(a.find(".include-gift-message-checkbox")).is(":checked")&&(b=!0);var c=!1;a.find(".amazon-gift-wrap").each(function(){O(D(this)).is(":checked")&&(c=!0)});a.find(".afn-gift-wrap").each(function(){O(D(this)).is(":checked")&&(c=!0)});a.find(".mfn-gift-wrap").each(function(){O(D(this)).is(":checked")&&(c=!0)});(b||c)&&p(!0);b&&sa||c?u(!0):u(!1)}function F(a,b,c){var d=
H;na=a;ra=b;if(a=d.find("textarea[name\x3d'gift-message-text']")){b=c?a.val().length:r.unescape(encodeURIComponent(a.val())).length;ha&&!qa&&fa&&(0<b?A(!1):A(!0));var e=a.val().split("\n").length;c=na-b;e=ra-e;!ha&&0<b&&d.find(".include-gift-message-checkbox").not(":checked")&&d.find(".include-gift-message-checkbox").attr("checked",!0);a=a.val().split("\n");for(var f in a)24<a[f].length&&(e=0===a[f].length%24?e-(Math.floor(a[f].length/24)-1):e-Math.floor(a[f].length/24));d.find(".popover-gift-center .remainder-count").hide();
(-1>c?d.find(".popover-gift-center .remaining-char-over-multiple").show():0>c?d.find(".popover-gift-center .remaining-char-over-single").show():1===c?d.find(".popover-gift-center .remaining-char-single").show():d.find(".popover-gift-center .remaining-char-multiple").show()).find(".chars-remaining").html(Math.abs(c));(-1>e?d.find(".popover-gift-center .remaining-line-over-multiple").show():0>e?d.find(".popover-gift-center .remaining-line-over-single").show():1===e?d.find(".popover-gift-center .remaining-line-single").show():
d.find(".popover-gift-center .remaining-line-multiple").show()).find(".lines-remaining").html(Math.abs(e));if(0>c||0>e)k.isSPP()?(d.find(".set-gift-options-button").addClass("aok-hidden"),d.find(".set-gift-options-button-disabled").removeClass("aok-hidden")):(d.find(".set-gift-options-button").hide(),d.find(".set-gift-options-button-disabled").show()),0>c?(d.find(".gift-char-limit-error").find(".char-limit-error").html(na),d.find(".current-blocker-content").html(d.find(".gift-char-limit-error").html())):
0>e&&(d.find(".gift-line-limit-error").find(".line-limit-error").html(ra),d.find(".current-blocker-content").html(d.find(".gift-line-limit-error").html()));-1<c&&-1<e&&(k.isSPP()?(d.find(".set-gift-options-button").removeClass("aok-hidden"),d.find(".set-gift-options-button-disabled").addClass("aok-hidden")):(d.find(".set-gift-options-button").show(),d.find(".set-gift-options-button-disabled").hide()))}}function M(a){a.stopPropagation();var b=H;b.find(".popover-content-main").fadeOut(100,function(){b.find(".popover-content-gift-wrap-preview .gift-wrap-preview-image").attr("src",
a.data.imageURL);b.find(".popover-content-gift-wrap-preview").fadeIn(100)});var c=b.find(".popover-content-gift-wrap-preview .back-to-gift-options-button");c.unbind("click").bind("click",R);m.bindActionEnterKeyOnButton(c);oa=!0}function R(a){oa=!1;var b=H;a?b.find(".popover-content-gift-wrap-preview").fadeOut(100,function(){b.find(".popover-content-main").fadeIn(100)}):setTimeout(function(){b.find(".popover-content-gift-wrap-preview").hide();b.find(".popover-content-main").show()},500)}function U(a){var b=
H,c=!1;D(".amazon-gift-wrap").each(function(){O(D(this)).is(":checked")&&(c=!0)});D(".afn-gift-wrap").each(function(){O(D(this)).is(":checked")&&(c=!0)});D(".mfn-gift-wrap").each(function(){O(D(this)).is(":checked")&&(c=!0)});if(c)T(),V();else if(O(b.find(".hide-prices-checkbox")).is(":disabled"))S();else if(a.is("input[type\x3dcheckbox]")&&(a.closest(".a-checkbox").hasClass("hide-prices-checkbox")||a.hasClass("hide-prices-checkbox")))a.is(":checked")?T():I();else if(k.isSPP())(b=a.closest(".a-radio"))&&
a.is(":checked")&&(b.hasClass("kindle-reg-radio-your-account")?I():b.hasClass("kindle-reg-radio-another-account")&&T());else if(a.hasClass("kindle-reg-radio-another-account")||a.hasClass("kindle-reg-radio-your-account"))b.find(".kindle-reg-radio-your-account").is(":checked")?I():T()}function T(){var a=H,b=O(a.find(".hide-prices-checkbox"));b.is(":checked")&&!k.isSPP()||b.attr("checked","checked");O(a.find(".kindle-reg-radio-your-account")).is(":checked")&&O(a.find(".kindle-reg-radio-another-account")).attr("checked",
!0)}function I(){var a=H,b=O(a.find(".hide-prices-checkbox"));b.is(":checked")&&b.removeAttr("checked");O(a.find(".kindle-reg-radio-another-account")).is(":checked")&&O(a.find(".kindle-reg-radio-your-account")).attr("checked",!0)}function V(){var a=H;O(a.find(".hide-prices-checkbox")).attr("disabled","true");O(a.find(".kindle-reg-radio-another-account")).attr("disabled",!0);O(a.find(".kindle-reg-radio-your-account")).attr("disabled",!0);a.find(".hide-prices-merchant-cant").is(":visible")||a.find(".hide-prices-note").show()}
function S(){var a=H;O(a.find(".hide-prices-checkbox")).removeAttr("disabled");O(a.find(".kindle-reg-radio-another-account")).removeAttr("disabled");O(a.find(".kindle-reg-radio-your-account")).removeAttr("disabled");a.find(".hide-prices-note").hide()}function W(a){var b=m.getPosition(a,"#",2),c=m.getPosition(a,"#",3);return"60"===a.substring(b+1,c)}function ba(b,c,d){var e=ca();if(e){var f=d.find('li[class\x3d"a-carousel-card gift-wrap noshi-wrap none-wrap"]');var g=d.find(".carousel-gift-wrap").find("ol")}else f=
d.find("."+c+"-wrap-template"),g=d.find("ul.allGiftWrapList");e&&a.trigger("checkout:gift:removeEmptyCarouselCards",g);var h=(d.data("lineitemid")||b.obfuscatedEntityId||"").replace(":","-");"afn"!==c||e||(g.find('li[class!\x3d"none-wrap gift-wrap noshi-wrap"]').remove(),D("#giftwrap-carousel-wrap-holder-"+h).css("width",90*(b.options.wraps.length+1)),D("#giftwrap-carousel-wrap-pane-"+h).css("width",360));for(var k=H,m=k.find(".larger-image-link-carousel-template"),n=0;n<b.options.wraps.length;n++){var l=
f.clone(!0).removeClass(c+"-wrap-template").addClass(c+"-wrap-copy"),p=m.clone(!0).removeClass("larger-image-link-carousel-template").addClass("larger-image-link-carousel-"+n),u=c,t=b,r=n,v=l,B=p,q=t.options.wraps[r].id;v.find("input").addClass(u+"-wrap-"+r).val(q);v.find("label").attr("for",u+"-wrap-"+r);q=t.options.wraps[r].description;v.find("."+u+"-wrap-description").html(q);q=t.options.wraps[r].price;v.find("."+u+"-wrap-price").html(q);(t=t.options.wraps[r].imageurl)&&t.length?(v.find("."+u+
"-image").attr("src",t).show(),u=v.find(".larger-image-link"),u.show(),u.unbind("click").bind("click",{imageURL:t},M),B.unbind("click").bind("click",{imageURL:t},M),B.find("a").unbind("click").bind("click",{imageURL:t},M)):"mfn"!==u||ca()||(v.find(".a-span3").hide(),v.find(".a-span9").addClass("a-span12").removeClass("a-span9"),v.find(".a-color-price").removeClass("wrap-price"));if("afn"===c){r=b;B=n;v=h;u=g;t=k;q=r.options.wraps[B].id;l.data("giftwrap-id",q);l.data("wrap-no",B);if(r.selected.wrap===
q){u.find("li.none-wrap").find("img").removeClass("selected-giftwrap-image");l.find("img").addClass("selected-giftwrap-image");r=l.find("img").attr("src");var C=D("#giftwrap-option-preview-imagearea-image-"+v);C.find("img").attr("src",r);C.removeClass("aok-hidden");D("#giftwrap-option-preview-imagearea-default-"+v).addClass("aok-hidden");U(l.find("input"));x();p.removeClass("aok-hidden");p.addClass("selectedWrapLargeLink")}ca()?(v=W(q)?"gift-wrap":"noshi-wrap",l.removeClass(v).removeClass("none-wrap"),
u.append(l.show())):(v=W(q)?"\x3cli class\x3dnoshi-wrap\x3e":"\x3cli class\x3dgift-wrap\x3e",u.append(D(v).append(l.show())));l=t.find("#carousel-larger-image-div");l.find(".larger-image-link-carousel-"+B).length||l.append(p.show())}}d.find("."+c+"-wrap-checkbox").removeAttr("checked");b.selected&&b.selected.isWrapped?d.find("input[value\x3d'"+b.selected.wrap+"']").attr("checked",!0):O(d.find("."+c+"-wrap-none")).attr("checked",!0);e&&a.trigger("checkout:gift:adjustCarouselInitial",b,d)}function ca(){return k.isSPP()&&
D("input[name\x3dsppGiftPopoverWithCarousel]").length}function C(a,b,c){for(var d=c.find("."+b+"-wrap-template"),e=0;e<a.options.wraps.length;e++){var f=d.clone(!0).removeClass(b+"-wrap-template").addClass(b+"-wrap-copy"),g=a.options.wraps[e].id;f.find("input").addClass(b+"-wrap-"+e).val(g);f.find("label").attr("for",b+"-wrap-"+e);g=a.options.wraps[e].description;f.find("."+b+"-wrap-description").html(g);g=a.options.wraps[e].price;f.find("."+b+"-wrap-price").html(g);if((g=a.options.wraps[e].imageurl)&&
g.length){var h=f.find("."+b+"-image");k.isSPP()&&h.removeClass("hidden");h.attr("src",g).show();h=f.find(".larger-image-link");k.isSPP()&&h.removeClass("hidden");h.show();h.unbind("click").bind("click",{imageURL:g},M)}else f.find(".a-span3").hide(),f.find(".a-span9").addClass("a-span12").removeClass("a-span9"),f.find(".a-color-price").removeClass("wrap-price");k.isSPP()&&f.removeClass("hidden");f.insertAfter(d).show()}c.find("."+b+"-wrap-checkbox").removeAttr("checked");a.selected&&a.selected.isWrapped?
c.find("input[value\x3d'"+a.selected.wrap+"']").attr("checked",!0):O(c.find("."+b+"-wrap-none")).attr("checked",!0)}function Z(a){for(var b=H,c=0;c<L.length;c++)if(a&&a===L[c].value&&L[c].bMonth&&L[c].bDay){var d=b.find('#select-occasion-month option[value\x3d"'+L[c].bMonth+'"]').attr("selected","selected");b.find("#select-occasion-month").closest(".a-button-inner").find(".a-placeholder").text(d.text());d=b.find('#select-occasion-day option[value\x3d"'+L[c].bDay+'"]').attr("selected","selected");
b.find("#select-occasion-day").closest(".a-button-inner").find(".a-placeholder").text(d.text())}}function X(){var a=H,b=a.find("#popover-gift-connection #select-recipient").find(":selected").val();if(""!==b&&"0"!==b&&("1"!==b&&"2"!==b||a.find("#input-recipient-first-name").val()||a.find("#input-recipient-last-name").val()))a.find("#select-occasion").prop("disabled",!1),a.find("#popover-gift-connection-occasion .a-touch-select").css({opacity:1});else{b=H;b.find(".gift-connection-occasion-extra").hide();
var c=b.find('#select-occasion option[value\x3d"0"]').attr("selected","selected");b.find("#select-occasion").closest(".a-button-inner").find(".a-placeholder").text(c.text());c=b.find('#select-occasion-month option[value\x3d"0"]').attr("selected","selected");b.find("#select-occasion-month").closest(".a-button-inner").find(".a-placeholder").text(c.text());c=b.find('#select-occasion-day option[value\x3d"0"]').attr("selected","selected");b.find("#select-occasion-day").closest(".a-button-inner").find(".a-placeholder").text(c.text());
c=b.find('#select-occasion-age option[value\x3d"-1"]').attr("selected","selected");b.find("#select-occasion-age").closest(".a-button-inner").find(".a-placeholder").text(c.text());b.find("#occasion-has-reminder-checkbox").attr("checked",!0);a.find("#select-occasion").prop("disabled",!0);a.find("#popover-gift-connection-occasion .a-touch-select").css({opacity:.5})}}function z(a,b){var c=H;"1"===a&&"2"===b?c.find("#select-occasion-age-row").show():c.find("#select-occasion-age-row").hide()}function Y(a){a=
H;var b=a.find("#popover-gift-connection #select-recipient").find(":selected").val(),c=a.find("#popover-gift-connection #select-occasion").find(":selected").val();!b||"1"!==b&&"2"!==b?(a.find(".gift-connection-recipient-extra").hide(),"1"===c&&b&&Z(b)):a.find(".gift-connection-recipient-extra").show();z(c,b);X()}function aa(a){a=H;var b=a.find("#popover-gift-connection #select-occasion").find(":selected").val(),c=a.find("#popover-gift-connection #select-recipient").find(":selected").val();!b||"1"!==
b&&"2"!==b?a.find(".gift-connection-occasion-extra").hide():("1"===b&&c&&"1"!==c&&"2"!==c&&Z(c),a.find(".gift-connection-occasion-extra").show());z(b,c)}function ea(a){var b=H,d="/gp/buy/pipeline/handlers/list-of-giftlists.html?escape\x3d0";L&&(d+="\x26mappingOnly\x3d1");a&&(d+="\x26fromRegistryIds\x3d"+a);D.ajax({type:"POST",url:d,dataType:"json",async:!0,cache:!1,timeout:5E3,success:function(d){b.find("#select-recipient").hide();!L&&d.options&&0<d.options.length&&(L=d.options);a&&d.registryIdMapping?
(wa[a]=d.registryIdMapping[a],ja=d.registryIdMapping[a]):a&&(wa[a]=G);L&&c();b.find("#select-recipient").show();b.find("#select-recipient-spinner").hide();ia=!0},error:function(){b.find("#select-recipient").show();b.find("#select-recipient-spinner").hide();ia=!0}})}function ka(b,c){var d=ca(),e=c.lineItemId;c=ca()?c.currentTab:b.data("current-tab");var f=D("#popover-gift-options-wrapper-"+e).data("active-tab");c!==f&&(b.parent().find(".selected-giftwrap-tab").removeClass("selected-giftwrap-tab"),
b.addClass("selected-giftwrap-tab"),b=D("#giftwrap-carousel-wrap-holder-"+e),d||b.css("left",0),f=D("#giftwrap-carousel-wrap-holder-"+e+" li"),d?(a.trigger("checkout:gift:changeCarouselWrapOptions",b,c,e),a.trigger("checkout:gift:adaptCarouselSPCPanel",e,c)):"all"===c?f.show():(f.hide(),f.filter("."+{"gift-wrap":"gift-wrap",noshi:"noshi-wrap"}[c]).show()),D("#popover-gift-options-wrapper-"+e).data("active-tab",c),f.find(".selected-giftwrap-image").removeClass("selected-giftwrap-image"),f.filter(".none-wrap").find("img").addClass("selected-giftwrap-image"),
D("#giftwrap-option-preview-imagearea-default-"+e).removeClass("aok-hidden"),D("#giftwrap-option-preview-imagearea-image-"+e).addClass("aok-hidden"),d=D("#allGiftWrapList-"+e).find(".none-wrap").find("input"),e=D(".selectedWrapLargeLink"),d.prop("checked",!0),d.val("").change(),e.length&&(e.addClass("aok-hidden"),e.removeClass("selectedWrapLargeLink")))}var D=a.$;if(!D("html").hasClass("a-ie6")){var na,ra,H,pa,oa=!1,ha=!1,qa=!0,fa=!0,L,ia=!1,wa={},ja,sa=!1;a.on("a:popover:hide",function(a){a.popover&&
a.popover.name&&0===a.popover.name.indexOf("gift-")&&(k.isSPP()&&b.increaseCount("checkout:spp-revieworder:gift_pop_cancel_sec",1),oa&&R(),ha&&(a=H,a.find(".gift-msg-on-card").hide(),a.find(".popover-gift-warning").hide(),a.find(".message-remaining-text").show(),O(a.find(".amazon-gift-wrap")).removeAttr("checked"),B(!1),a.find('input[type\x3d"checkbox"]').removeAttr("disabled")))});a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("gift-")){H=a.popover.$popover;
pa=a.popover;0<H.find(".include-gift-receipt-checkbox").length&&(ha=!0);n.showSpinner(H.find(".popover-content-main"),!1,pa);H.find(".content-container").css("visibility","hidden");a="returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isDecoupleSPC\x3d1\x26cachebuster\x3d"+(new Date).getTime();try{var b=pa.data;if(b)a+="\x26obfuscatedEntityId\x3d"+b;else throw{name:"MissingData",message:"lineItemId is undefined"};}catch(ua){r.ueLogError&&r.ueLogError(ua,{logLevel:"FATAL",attribution:"gift-popover",message:"[No lineItemId to open the gift-popover with]. "})}D.ajax({type:"POST",
url:"/gp/buy/pipeline/handlers/gift-select-content.html",data:a,dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc"},dataFilter:function(a){return e.jsonify(a)},success:function(a,b,c){a&&a.conductoraction&&a.conductoraction.url&&k.redirect(a);null!==a?q(a,b,c):k.ajaxRedirect()},error:function(a,b,c){k.ajaxRedirect(a,b,c)}})}});a.on("a:popover:beforeShow",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("button-blocker-gift"))b=H,a.popover.$popover.find(".a-popover-inner").html(b.find(".current-blocker-content").text()),
a.popover.updatePosition(!0);else if(a.popover&&a.popover.$popover){var b=a.popover.$popover;a=b.find(".validateInputCharactersOnBlur.a-form-error");0<a.size()&&a.removeClass("a-form-error");b=b.find("#onblur-character-validation-error-gift-message-text");0<b.size()&&b.remove()}});var da={enforceSelectorParity:U,enforceGiftReceiptParity:P,enforceHidePriceParity:Q,disableHidePrice:x,toggleMessageBoxDisplay:J,toggleEmptyMsgWarning:function(){var a=H,b=O(a.find(".include-gift-message-checkbox"));a=a.find("textarea[name\x3d'gift-message-text']");
!qa&&fa&&(b.is(":checked")&&0<a.val().length?A(!1):A(!0))},toggleNoReceiptWarning:function(){var a=H,b=O(a.find(".include-gift-receipt-checkbox")),c=a.find(".no-receipt-warning");a=a.find(".no-message-warning");b.is(":checked")?(c.hide(),sa||B(!0)):(a.hide(),c.show(),B(!1))},includeGiftConnection:function(){H.find("#include-gift-connection-checkbox").attr("checked",!0)},clearGiftConnection:function(){if(H.find(".include-gift-connection-checkbox").not(":checked")){var a=H;a.find(".gift-connection-recipient-extra").hide();
var b=a.find('#select-recipient option[value\x3d"0"]').attr("selected","selected");a.find("#select-recipient").closest(".a-button-inner").find(".a-placeholder").text(b.text());a.find("#input-recipient-first-name").val("");a.find("#input-recipient-last-name").val("");X()}},toggleGiftConnectionRecipientArea:Y,toggleGiftConnectionOccasionArea:aa,updateGiftOptionsTabSelection:ka,updateCarouselOnLeftClick:function(a,b,c){c.$event.preventDefault();a=b.lineItemId;b=parseInt(D("#giftwrap-carousel-wrap-holder-"+
a).css("left"),10);0>b&&(b=b+90+"px",D("#giftwrap-carousel-wrap-holder-"+a).css("left",b))},updateCarouselOnRightClick:function(a,b,c){c.$event.preventDefault();a=b.lineItemId;var d=D("#allGiftWrapList-"+a);b=d.find("li").size();c=d.find("li.gift-wrap").size();d=d.find("li.noshi-wrap").size();var e=D("#popover-gift-options-wrapper-"+a).data("active-tab"),f;"all"===e?f=b:"gift-wrap"===e?f=c:"noshi"===e&&(f=d);b=parseInt(D("#giftwrap-carousel-wrap-holder-"+a).css("left"),10);b>-90*(f-4)&&(b=b-90+"px",
D("#giftwrap-carousel-wrap-holder-"+a).css("left",b))},updateSelectedGiftWrap:function(a,b){var c=b.lineItemId;D("#allGiftWrapList-"+c).find(".selected-giftwrap-image").removeClass("selected-giftwrap-image");a.find(".afn-image").addClass("selected-giftwrap-image");b=a.parent();var d=a.data("giftwrap-id"),e=a.find("input"),f=a.data("wrap-no");e.prop("checked",!0);e.val(d).change();d=D("#giftwrap-option-preview-imagearea-default-"+c);c=D("#giftwrap-option-preview-imagearea-image-"+c);e=D(".selectedWrapLargeLink");
f=D(".larger-image-link-carousel-"+f);b.hasClass("none-wrap")?(d.removeClass("aok-hidden"),c.addClass("aok-hidden"),e.length&&(e.addClass("aok-hidden"),e.removeClass("selectedWrapLargeLink"))):(a=a.find("img").attr("src"),c.find("img").attr("src",a),d.addClass("aok-hidden"),c.removeClass("aok-hidden"),e.length&&(e.addClass("aok-hidden"),e.removeClass("selectedWrapLargeLink")),f.length&&(f.addClass("selectedWrapLargeLink"),f.removeClass("aok-hidden")))},updatePreviewImageOnMouseEnter:function(a,b){var c=
b.lineItemId;b=D("#giftwrap-option-preview-imagearea-default-"+c);c=D("#giftwrap-option-preview-imagearea-image-"+c);a.hasClass("none-wrap")?(b.removeClass("aok-hidden"),c.addClass("aok-hidden")):(a=a.find("img").attr("src"),c.find("img").attr("src",a),b.addClass("aok-hidden"),c.removeClass("aok-hidden"))},updatePreviewImageOnMouseLeave:function(a,b){var c=b.lineItemId;a=D("#giftwrap-option-preview-imagearea-default-"+c);b=D("#giftwrap-option-preview-imagearea-image-"+c);D("#allGiftWrapList-"+c).find(".selected-giftwrap-image").parentsUntil("ul",
"li").hasClass("none-wrap")?(a.removeClass("aok-hidden"),b.addClass("aok-hidden")):(c=D("#allGiftWrapList-"+c).find(".selected-giftwrap-image").attr("src"),b.find("img").attr("src",c),a.addClass("aok-hidden"),b.removeClass("aok-hidden"))}},O=d.getInput;a.declarative("gift-popover-element",["change"],function(a){var b=a.$event.isInit?a.data.onInit||[]:a.data.onChange||[];for(var c=0;c<b.length;c++)if(da[b[c]])da[b[c]](a.$target,a.data)});a.declarative("gift-popover-element","click mouseenter mouseleave",
function(a){var b;if(b=a.data[{click:"onClick",mouseenter:"mouseEnter",mouseleave:"mouseLeave"}[a.type]])for(var c=0;c<b.length;c++)if(da[b[c]])da[b[c]](a.$currentTarget,a.data,a)});a.declarative("spc-update-gift-options-tab-selection","click",function(a){var b=a.$target.parents("li");b.attr("data",a.data);ka(b,a.data)});a.on("checkout:reload:spc",h);a.on("checkout:reload:spp-revieworder",h)}});"use strict";q.when("A","page-transition-controller","loading-spinner-controller","ajax-utility","page-conductor",
"checkout-general-utils","page-detector","client-side-metrics").register("concealment-popover-controller",function(a,l,n,e,k,m,g,b){function d(){q("#spc-orders").find(".concealment-widgets-desktop").removeClass("no-js-hide");a.defer(function(){q("#spc-orders").find(".concealment-popover-link").each(function(){q(this).data("action")&&q(this).removeAttr("href").attr("tabindex",0)})})}function f(a){return a.is("input")?a:a.find("input")}function c(a){var b=v;b.find(".fake-label").each(function(){q(this).unbind("click").bind("click",
function(){q(this).closest(".popover-checkbox").find("input").trigger("click")})});a&&a.item&&a.item.title&&b.find(".concealment-item-title").html(a.item.title);if(a&&a.obfuscatedEntityId){var c=b.find(".set-concealment-options-button input");c.unbind("click").bind("click",{obfuscatedentityid:a.obfuscatedEntityId,concealmentData:a,quantity:a.quantity},h);m.bindActionEnterKeyOnButton(c)}x=a&&a.item&&a.item.isAmazonFulfilled;a&&a.selected&&(c=f(b.find(".conceal-item-checkbox")),a.selected.concealItem?
c.attr("checked",!0):c.removeAttr("checked"));v.find(".content-container").css("visibility","visible");w.updatePosition(!0);n.hideSpinner(b.find(".popover-content-main"))}function h(a){var c=v,d="";a&&a.data&&a.data.obfuscatedentityid&&(d+="obfuscatedEntityId.0\x3d"+a.data.obfuscatedentityid+"\x26");a&&a.data&&a.data.quantity&&(d+="quantity.0\x3d"+a.data.quantity+"\x26");var g="";a&&a.data&&a.data.concealmentData&&a.data.concealmentData.saveConcealmentRefTag&&(g=a.data.concealmentData.saveConcealmentRefTag);
var h="";a&&a.data&&a.data.concealmentData&&a.data.concealmentData.cancelConcealmentRefTag&&(h=a.data.concealmentData.cancelConcealmentRefTag);(a=f(c.find(".conceal-item-checkbox")).is(":checked"))?(x&&(d+="isAFN.0\x3d1\x26"),d=d+"includeReceipt.0\x3d1\x26includeMessage.0\x3d1\x26"+("message.0\x3d"+encodeURIComponent(q("input[name\x3d'concealment-item-message']").val())+"\x26"),d=d+"hidePrices.0\x3d0\x26saveOnly\x3d1"+("ref\x3d"+g+"\x26")):d+="ref\x3d"+h+"\x26";var m=q("input#executionId").val();
m&&(d+="executionId\x3d"+m+"\x26");m="/gp/buy/gift/handlers/save-all.html/ref\x3d";a?(m+=g,b.increaseCount("CPEX.Checkout.Select.Concealment",1)):(m+=h,b.increaseCount("CPEX.Checkout.Cancel.Concealment",1));k.isSPP()&&(c.find(".a-button-close").trigger("click"),g=q("#setOrderingPrefsCheckbox"),g.length&&g.is(":checked")&&(d+="\x26saveAsDefaultsSelected\x3d1"));l.show();q.ajax({type:"POST",url:m,data:d,dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"},
contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(a,b,d){d.getResponseHeader("x-amz-checkout-page")?(k.isSPP()||c.find(".a-button-close").trigger("click"),k.ajaxUpdatePage(a,b,d)):(a=e.jsonify(a),k.redirect(a))},error:function(a,b,c){k.ajaxRedirect(a,b,c)}})}var q=a.$;if(!q("html").hasClass("a-ie6")){var v,w,x=!0;q(document).delegate(".concealment-popover-link, .concealment-options-button","click",function(){b.increaseCount("CPEX.Checkout.Concealment.Button.click",
1)});a.on("a:popover:hide",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("concealment-")&&(k.isSPP()&&b.increaseCount("checkout:spp-revieworder:concealment_pop_cancel_sec",1),f(v.find(".conceal-item-checkbox")).removeAttr("checked"))});a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("concealment-")){v=a.popover.$popover;w=a.popover;n.showSpinner(v.find(".popover-content-main"),!1,w);v.find(".content-container").css("visibility","hidden");
a="returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isDecoupleSPC\x3d1\x26cachebuster\x3d"+(new Date).getTime();try{var b=w.data.lineItemEntityId,d=w.data.itemId;if(b)a+="\x26obfuscatedEntityId\x3d"+b;else if(d)a+="\x26lineItemEntityId\x3d"+d;else throw{name:"MissingData",message:"lineItemId is undefined"};var f=w.data.quantity;if(f)a+="\x26quantity\x3d"+f;else throw{name:"MissingData",message:"quantity is undefined"};}catch(N){r.ueLogError&&r.ueLogError(N,{logLevel:"FATAL",attribution:"concealment-popover",
message:"[Data missing to open the concealment-popover]. "})}b=w.data.ref;q.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/concealment-select-content.html/ref\x3d"+b,data:a+("\x26ref\x3d"+b),dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc"},dataFilter:function(a){return e.jsonify(a)},success:function(a,b,d){a&&a.conductoraction&&a.conductoraction.url&&k.redirect(a);null!==a?c(a,b,d):k.ajaxRedirect()},error:function(a,b,c){k.ajaxRedirect(a,b,c)}})}});a.on("a:popover:beforeShow",
function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("button-blocker-concealment")){var b=v;a.popover.$popover.find(".a-popover-inner").html(b.find(".current-blocker-content").text());a.popover.updatePosition(!0)}});var p={};a.declarative("concealment-popover-element",["change"],function(a){var b=a.$event.isInit?a.data.onInit||[]:a.data.onChange||[];for(var c=0;c<b.length;c++)if(p[b[c]])p[b[c]](a.$target,a.data)});a.declarative("concealment-popover-element","click mouseenter mouseleave",
function(a){var b;if(b=a.data[{click:"onClick",mouseenter:"mouseEnter",mouseleave:"mouseLeave"}[a.type]])for(var c=0;c<b.length;c++)if(p[b[c]])p[b[c]](a.$currentTarget,a.data,a)});a.on("checkout:reload:spc",d);a.on("checkout:reload:spp-revieworder",d)}});"use strict";q.when("A","page-conductor","scroll-controller","page-detector","client-side-metrics","button-blocker","weblab-helper").register("gold-box-controller",function(a,l,n,e,k,m,g){function b(){a.defer(c);a.defer(h)}var d=a.$,f={};if(!d("html").hasClass("a-ie6")){var c=
function(){var a=d("#goldbox-countdown"),b=d("#spc-orders");b&&0!==b.length||(b=d("#spclite-items-block"));b=b.find("input[name\x3dgoldboxexpirelefttime]");if(0!==b.length){if(1<b.size()){var c=parseInt(b.attr("data-timeleftms"),10),e=b;d.each(b,function(){var a=d(this),b=parseInt(a.attr("data-timeleftms"),10);b<c&&(e=a,c=b)});b=e}var g=parseFloat(b.attr("data-pagestarttime")),h=parseFloat(b.attr("data-timeleftms")/1E3);if(!(isNaN(g)||isNaN(h)||0>=h)){var m=(new Date).getTime();isNaN(f[g])?(f={},
f[g]=m):m=f[g];var q=a.find("span[data-timefield\x3dminute]"),t=a.find("span[data-timefield\x3dsecond]"),N=r.setInterval(function(){var b=(new Date).getTime();h-=(b-m)/1E3;m=b;if(0>h&&N)t.html("00"),r.clearInterval(N),N=null,l.isSPP()&&k.increaseCount("checkout:spp-revieworder:deal_expired",1),d("#gold-box-modal-launcher").trigger("click"),n.scrollToTop(),n.toggleScrollOff();else{b=Math.floor(h/60%60);var c=Math.floor(h%60);c=10>c?"0"+c:c;q.html(b);t.html(c);a.is(":visible")||a.show()}},1E3);l.isSPP()&&
k.increaseCount("checkout:spp-revieworder:deal_countdown",1)}}},h=function(){var a=d("#gold-box-button-blocker");1===a.length&&m.show("place-order-gold-box-blocker",a.attr("data-blocker-message"))};a.on("checkout:reload:spc",b);a.on("checkout:reload:spclite",b);a.on("checkout:reload:spp-revieworder",b)}});"use strict";q.when("A","page-transition-controller","ajax-utility","page-conductor","currency-formatter","page-detector","client-side-metrics","pay-rewards-currency","weblab-helper").register("inline-points-controller",
function(a,l,n,e,k,m,g,b,d){function f(){u("#spc-points-input")&&u("#spc-points-input").data("points-used")&&(u("#points-applied").show(),u("#inline-points-button").hide());u("#inline-points-register")&&u("#inline-points-register").removeAttr("href");u("#spc-loyalty-points-input")&&u("#spc-loyalty-points-input").val()&&(u("#loyalty-points-applied").show(),u("#loyalty-points-button").hide());u("#spc-points-input")&&u("#spc-points-input").hasClass("show-currency-input-widget-new")&&u("#spc-points-input").each(function(c,
d){var e=a.$(d);c={$element:e,maxAmount:e.data("max-dollar-amount")};d={$element:a.$("#inline-raw-points"),decimalPlaces:e.data("decimal-places"),ratio:e.data("conversion-ratio")};var f=e.data("country-code");f=b.getCurrencyFormatByCountryCode(f);b.initializeInlineFormatting(c,d,f);u(document).delegate("#spc-points-input","keydown",function(a){if(e.data("points-used")!==e.val){a=u("#inline-points-button");var b=!1;a.is("span")&&(b=!0);var c=a.find("span.apply"),d=a.find("span.change");u("#points-applied").hide();
e.data("points-used")?(c.hide(),d.show()):(c.show(),d.hide());b?a.addClass("display-inline-block"):a.show()}})})}function c(a,b){a.preventDefault();if(h(b)){e.isSPP()?(l.blockAllActions(),l.showTransitionInContainer(u("#payment"))):l.show();a={"x-amz-checkout-page":"spc"};if(b){var c=u("#loyalty-points-hidden-fields");b="/gp/buy/spc/handlers/update-loyalty-points.html/ref\x3dox_spc_points_edit";var f="\x26jpPointsPaymentInstrumentId\x3d"+encodeURIComponent(c.find("input[name\x3d'jpPointsPaymentInstrumentId']").val())+
"\x26jpPointsCustomerRequestedAmount\x3d"+u("#spc-loyalty-points-input").val()+"\x26jpPointsConversionRate\x3d"+c.find("input[name\x3d'jpPointsConversionRate']").val()+"\x26jpPointsBaseCurrencyCode\x3d"+c.find("input[name\x3d'jpPointsBaseCurrencyCode']").val()+"\x26jpPointsTargetCurrencyCode\x3d"+c.find("input[name\x3d'jpPointsTargetCurrencyCode']").val()+"\x26jpPointsAvailablePoints\x3d"+c.find("input[name\x3d'jpPointsAvailablePoints']").val()+"\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+
u("input[name\x3duseCtb]").val()}else{a=e.setAjaxTransitionHeader(a);c=u("#inline-points-hidden-fields");var g=c.find("input[name\x3d'useGCBalance']").val();b="/gp/buy/pipeline/handlers/update-reward-points.html/ref\x3d"+(e.isSPP()?"chk_pay_addswp_coll":"ox_pay_page_points_apply");f="paymentMethodId\x3d"+c.find("input[name\x3d'paymentMethodId']").val()+"\x26paymentMethodType\x3d"+c.find("input[name\x3d'paymentMethodType']").val()+"\x26rewardAccountId\x3d"+c.find("input[name\x3d'rewardAccountId']").val()+
"\x26rewardAccountAmount\x3d"+u("#spc-points-input").val()+"\x26rewardAccountRate\x3d"+c.find("input[name\x3d'rewardAccountRate']").val()+"\x26useGCBalance\x3d"+g+"\x26usePromoBalance\x3d"+g+"\x26returnFullHTML\x3d1\x26returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+u("input[name\x3duseCtb]").val();d.isBRMarketplaceCurrencyFormatEnabled()&&(f="paymentMethodId\x3d"+c.find("input[name\x3d'paymentMethodId']").val()+"\x26paymentMethodType\x3d"+c.find("input[name\x3d'paymentMethodType']").val()+
"\x26rewardAccountId\x3d"+c.find("input[name\x3d'rewardAccountId']").val()+"\x26rewardAccountAmount\x3d"+u("#spc-points-input").val().replaceAll(",",".")+"\x26rewardAccountRate\x3d"+c.find("input[name\x3d'rewardAccountRate']").val()+"\x26useGCBalance\x3d"+g+"\x26usePromoBalance\x3d"+g+"\x26returnFullHTML\x3d1\x26returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+u("input[name\x3duseCtb]").val())}u.ajax({type:"POST",url:b,data:f,dataType:"text",async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
headers:a,success:function(a,b,c){c.getResponseHeader("x-amz-checkout-page")?e.ajaxUpdatePage(a,b,c):(a=n.jsonify(a),e.redirect(a))},error:function(a,b,c){e.ajaxRedirect(a,b,c)}})}}function h(a){var b=!1,c=u("input[name\x3drewardAccountAmount]"),d=u("#inline-points-error-block");a||u("#spc-points-input")&&!u("#spc-points-input").hasClass("show-currency-input-widget-new")?(a&&(c=u("input[name\x3dloyaltyPointsValue]"),d=u("#loyalty-points-error")),d.hide(),d.find("p").hide(),q(c))?w(c,a)?x(c,a)||(d.find("p").filter(function(){return"badMax"===
u(this).data("error")}).show().css("display","inline"),b=!0):(d.find("p").filter(function(){return"badMin"===u(this).data("error")}).show().css("display","inline"),b=!0):(d.find("p").filter(function(){return"badValue"===u(this).data("error")}).show().css("display","inline"),b=!0):a||w(c,a)||(d.find("p").filter(function(){return"badMin"===u(this).data("error")}).show().css("display","inline"),b=!0);if(b)return d.show(),c.addClass("a-form-error"),!1;c.removeClass("a-form-error");return!0}function r(a,
b){var c=u(a.currentTarget),e=c.val();d.isBRMarketplaceCurrencyFormatEnabled()&&(e=e.includes(".")?e.replaceAll(".",","):e.replaceAll(",","."));a=u("#inline-raw-points");b&&(a=u("#loyalty-points-applied-value"));var f=a.html();if(b)!/^\s*$/.test(e)&&!isNaN(e)&&0<e?a.html(e):a.html(0);else if(!u("#spc-points-input").hasClass("show-currency-input-widget-new")){var g=c.data("min-dollar-amount");!/^\s*$/.test(e)&&!isNaN(e)&&0<e&&!isNaN(g)&&e>=g?(g=c.data("conversion-ratio"),c=c.data("decimal-places"),
c=d.isBRMarketplaceCurrencyFormatEnabled()?k.getNumberWithSeparators(e/g,c).replaceAll(".","z").replaceAll(",",".").replaceAll("z",","):k.getNumberWithSeparators(e/g,c),a.html(c)):a.html(0)}(b||u("#points-applied").is(":visible"))&&f!==a.html()&&(a=u("#spc-loyalty-points-display"),f=u("#loyalty-points-applied"),c=u("#loyalty-points-button"),e=!1,b||(a=u("#inline-points-button"),a.is("span")&&(e=!0),f=a.find("span.apply"),c=a.find("span.change"),u("#points-applied").hide()),f.hide(),c.show(),e?a.css("display",
"inline-block"):a.show())}function q(a){a=a.val();d.isBRMarketplaceCurrencyFormatEnabled()&&(a=a.includes(".")?a.replaceAll(".",","):a.replaceAll(",","."));return/^\s*$/.test(a)||!isNaN(a)}function w(a,b){if(b)return!0;b=a.val();d.isBRMarketplaceCurrencyFormatEnabled()&&(b=b.includes(".")?b.replaceAll(".",","):b.replaceAll(",","."));if(/^\s*$/.test(b))return!0;b=parseFloat(b);return isNaN(b)||!a.data("min-dollar-amount")?!0:0===b||b>=a.data("min-dollar-amount")}function x(a,b){var c=a.val();d.isBRMarketplaceCurrencyFormatEnabled()&&
(c=c.includes(".")?c.replaceAll(".",","):c.replaceAll(",","."));if(/^\s*$/.test(c))return!0;c=parseFloat(c);var e=a.data("max-dollar-amount");b&&(e=a.data("available-points"));return isNaN(c)||!e?!0:c<=e}function p(a){switch(a.keyCode?a.keyCode:a.which){case 13:case 10:var b=u("#loyalty-points-button"),d=u("#spc-points-input");0<b.length&&b.is(":visible")?c(a,1):0<d.length&&c(a,0)}}var u=a.$;u("html").hasClass("a-ie6")||(u(document).delegate("#spc-loyalty-points-input","keypress",function(a){p(a)}),
u("#spc-points-input")&&!u("#spc-points-input").hasClass("show-currency-input-widget-new")&&(u(document).delegate("#spc-points-input","keypress",function(a){p(a)}),u(document).delegate("#spc-points-input","keyup",function(a){r(a,0)})),u(document).delegate("#spc-loyalty-points-input","keyup",function(a){r(a,1)}),u(document).delegate("#inline-points-button","click",function(a){c(a,0)}),u(document).delegate("#loyalty-points-button","click",function(a){c(a,1)}),a.on("a:expander:apply-point-expander:toggle:expand",
function(a){g.increaseCount("checkout:spp-payment:expand_addswp_coll",1)}),a.on("checkout:reload:spc",f),a.on("checkout:reload:spp-revieworder",f))});"use strict";q.when("A","client-side-metrics","ready").execute(function(a,l){var n=a.$;a.on("checkout:reload:spc",function(){var a=n("input[name\x3d'rewardsProgramId']").val(),k=n("input[name\x3d'swpWidgetCase']").val();a&&k&&l.increaseCount("Checkout::SPC::SWPWidgetCSM::"+a+"::"+k,1)})});"use strict";q.when("A","page-transition-controller","ajax-utility",
"page-conductor").register("inline-fps-balance-controller",function(a,l,n,e){function k(a){a.preventDefault();m("#inline-fps-balance-checkbox").prop("disabled","disabled");e.isSPP()?(l.blockAllActions(),l.showTransitionInContainer(m("#payment"))):l.show();var b=m("#inline-fps-balance-hidden-fields"),d=0;m("#inline-fps-balance-checkbox").prop("checked")&&(d=1);a=e.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});var f="/gp/buy/pipeline/handlers/update-fps-balance.html/ref\x3d"+(e.isSPP()?"chk_pay_"+
(d?"apply":"remmove")+"_fps_balance_coll":"ox_spc_page_fps_balance_apply");b="fpsPaymentMethodId\x3d"+b.find("input[name\x3d'fpsPaymentMethodId']").val()+"\x26useFlexiblePayments\x3d"+d+"\x26returnFullHTML\x3d1\x26returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+m("input[name\x3duseCtb]").val();m.ajax({type:"POST",url:f,data:b,dataType:"text",async:!0,cache:!1,headers:a,success:function(a,b,d){d.getResponseHeader("x-amz-checkout-page")?e.ajaxUpdatePage(a,b,d):(a=n.jsonify(a),
e.redirect(a))},error:function(a,b,d){e.ajaxRedirect(a,b,d)}})}var m=a.$;m("html").hasClass("a-ie6")||m(document).delegate("#inline-fps-balance-checkbox","click",function(a){k(a)})});"use strict";q.when("A","page-transition-controller","ajax-utility","page-conductor","checkout-general-utils","error-feature-detection","page-detector","client-side-metrics","weblab-helper","a-modal").register("shipping-speed-selection-controller",function(a,l,n,e,k,m,g,b,d,f){function c(){z?C("fieldset div.a-radio").addClass("a-touch-radio"):
a.defer(function(){var a=C("#spc-orders").find("div.ship-option");a.filter(".no-scheduled-delivery");a.each(function(){C(this).find("input.radio-image").remove()});a.each(function(){var a=C(this).find("input.radio-standard");a.attr("checked")&&a.attr("checked",!0)})});ea=C("#spc-orders").find("div.ship-option").find('input[type\x3d"radio"]:checked');ka=ea.attr("value");h();m.markFeatureAvailable("shipping-speed-selection-controller");y()}function h(){var a=0<C("#trigger-case-call-to-resolve-cv").length||
0<C(".force-resolve-invalid-ship-option").length;if(e.isSPP()&&a){a=function(){var a=r.setInterval(function(){e.isAnimating()||(l.show(),r.clearInterval(a))},50)};var b=C("div.ship-option").filter(".call-set-to-resolve-cv").first().find("input[type\x3d'radio']");if(b&&b.length){var c=b.parents(".shipping-speeds").find("input.lineitemidinput[type\x3dhidden]").val();P(b,null,null,{transitionAction:a,refTag:"chk_revieworder_set_ship_option_no_default",extraData:{callingCASEResolveCV:1,lineItemIds:c}})}}}
function y(){C("#buy-button-disabled-state").length&&v(function(a){w(a)})}function v(a){C("div.sd-widgets").each(function(b,c){a(c)})}function w(a){var b=setInterval(C.proxy(function(){if(C(this).hasClass("sd_widget_initialized")){var a=C(this),c=C(a).attr("id");c&&(a=x(a),a["ScheduledDeliveryEntity.startDeliveryDate"]&&P(null,c,a));r.clearInterval(b)}},a),1E3)}function x(a){var b={};p(a,function(a){var c=C(a).attr("key");a=C(a).val();b[c]=a||""});return b}function p(a,b){C(a).find("input[type\x3d'hidden']").each(function(a,
c){b(c)})}function u(a){return d.isExcludeMdwFromGoldenCXWidgetRenamingWeblabEnabled()?!(a&&a[0]&&a[0].classList&&a[0].classList.contains("sd-mdw-widget-root")):!0}function B(){Z||(Z=C("input[type\x3d'hidden'][name\x3d'scopeId']").val());return Z}function A(a,b,c){if(c.getResponseHeader("x-amz-checkout-page")){var f=n.jsonify(a);return f&&f.success&&f.trialkey&&X[f.trialkey]?(a=X[f.trialkey],e.isSPP()&&"object"===typeof a&&(a=JSON.stringify(X[f.trialkey])),d.isSPCMobileDisplayMoreShipOptionsEnabled()&&
0<C(".mobile-view").length?e.ajaxUpdatePage(a,b,c,{pushNewFrame:"false"}):e.ajaxUpdatePage(a,b,c),Y&&(clearTimeout(Y),Y=null),X={},!0):d.isSPCMobileDisplayMoreShipOptionsEnabled()&&0<C(".mobile-view").length?e.ajaxUpdatePage(a,b,c,{pushNewFrame:"false"}):e.ajaxUpdatePage(a,b,c)}return e.redirect(a)}function t(a,b){if(a){var c=a.data(b);if(c!==G)return c;(a=a.closest(".radio-standard"))&&(c=a.data(b));return c}}function N(a){a.closest("fieldset").find("i.a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");
a.siblings("i").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive")}function J(a){var b=a;C(".shipping-group").each(function(a,c){var d=!1;C(c).parents().each(function(a,b){return C(b).hasClass("shipment")?(d=!0,!1):!0});d||(b=b.add(c))});return b}function Q(a,b,c){var e="",f=0;1<a.length&&(e+="\x26forcesetbylineitem\x3d1");a.each(function(g,h){var k=C(h),m="",l=k.data("orderid"),n=k.has(".prime-calendar-container"),p=k.find("input[name\x3d'currentshippingspeed']").attr("value"),
r=k.find("input[name\x3d'currentshipsplitpreference']").attr("value");1===a.length&&(e+="\x26oldoption\x3d"+p+"."+r);var q=k.find("input[name\x3d'defaultshipsplitpreference."+l+"']").attr("value"),v=k.find("input[name\x3d'usingprimeshipping."+l+"']").attr("value");q&&v&&(m+="\x26defaultshipsplitpreference."+f+"\x3d"+q,m+="\x26usingprimeshipping."+f+"\x3d"+v);q=k.find(".shipping-speed");q=b?q.find('input[type\x3d"radio"]:checked'):q.find("input[src*\x3dradio-on]");n&&!q.length&&(q=k.find("input[name\x3d'hiddenSelection"+
l+"']"));v=k.find(".ship-split-preferences").find("input[type\x3d'radio']:checked");1!==v.length&&(v=k.find(".ship-split-preferences").find("input[type\x3d'hidden'][name^\x3d'shippriority']"));c===k.data("orderid")&&(t(b,"shippingofferingid")?q=b:v=b,1===a.length&&(m=n?m+("\x26option\x3d"+q.data("key")+"."+(v?v.attr("value"):"")):m+("\x26option\x3d"+q.attr("value")+"."+(v?v.attr("value"):""))));var w=k.find("input[name\x3d'lineitemids"+l+"']");0<w.length&&(m+="\x26lineitemids"+f+"\x3d"+w.attr("value"));
d.isSecureUnifiedDeliveryEnabled()&&(w=k.find("input[name\x3d'issecureunifieddelivery"+l+"']"),0<w.length&&(m+="\x26issecureunifieddelivery"+f+"\x3d"+w.attr("value")));w=k.find("input[name\x3d'onOrAfterAppointment"+l+"']").val();var x=k.find("input[name\x3d'onOrAfterLineItemId"+l+"']").val(),y="";w&&x&&(y+="\x26onOrAfterAppointment"+f+"\x3d"+w,y+="\x26onOrAfterLineItemId"+f+"\x3d"+x);m+=y;if(q.length)m+=T(q,v,f,n),1===t(q,"isscheduleddelivery")?(h=q.closest(".shipping-speed").find('[id^\x3d"sd_widgets_"]'),
d.isScheduleDeliveryHiddenInputIdFixEnabled()?(u(h)&&(h=C("#sd-widgets-"+l)),g=h.children(":input").serialize(),h.length&&(l=h.get(0).id.substring(11),h=l.replace(/^(\d+)(-)?/,function(a,b,c){return f+(c?c:"")}),g=g.replaceAll(l+"\x3d",h+"\x3d"),g=g.replace(/(SD-OrderID-\d+=)\d+/,"$1"+f),g=g.replace(/(SDV1-orderId-\d+=)\d+/,"$1"+f)),m+="\x26"+g):(u(h)&&(h=C("#sd-widgets-"+g)),m+="\x26"+h.children(":input").serialize())):1===t(q,"isscheduleddeliveryslot")&&t(q,"sddatastring")&&(m+="\x26ScheduledDeliveryEntity.data."+
f+"\x3d"+encodeURIComponent(q.data("sddatastring"))),"rush-ispu"===q.attr("value")&&(m+=R(k,f,v));else if(F(k))m+=M(k,f,p,r);else{if(k.find("[data-action\x3d'checkout-select-ship-option-radio'").length)return;d.isRemoveDigitalFlagForScheduledDeliveryShipmentEnabled()&&"1"===C(h).find("input[type\x3d'hidden'][name\x3d'previousSDSelected"+f+"']").attr("value")||(m+="\x26isdigital"+f+"\x3d1")}f++;e+=m});0<f&&(e+="\x26groupcount\x3d"+f);return e}function P(a,c,f,g){z&&N(a);g&&g.transitionAction?g.transitionAction():
l.show();for(var h in aa)aa.hasOwnProperty(h)&&(aa[h].abort(),delete aa[h]);f=C("#spc-orders").find("input[type\x3d'hidden'][name\x3d'shiptrialprefix']").val();a||(a=C("#"+c).closest(".shipping-speed").find("input[type\x3d'radio']"));a.attr("value")!==ka&&(b.increaseCount("checkout:spc:shipoption:change",1),ka=a.attr("value"));var m=a.closest(".shipment").data("orderid");a&&a.length&&a.hasClass("valid-btn")&&a.closest(".prime-calendar").hasClass("long-calendar")&&(m=a.closest(".prime-calendar").data("orderid"));
var n="returnpipedata\x3d0\x26returnFullHTML\x3d1\x26cachebuster\x3d"+(new Date).getTime()+"\x26hasWorkingJavascript\x3d1";if(g&&g.extraData)for(var p in g.extraData)g.extraData.hasOwnProperty(p)&&(n+="\x26"+p+"\x3d"+g.extraData[p]);var q=C(".shipment"),r=0;c=q.length;q=J(q);n+="\x26groupsadded\x3d"+(q.length-c);d.isSkipZeroShippingSpeedShipmentEnabled()?n+=Q(q,a,m):(q.each(function(b,c){var e=C(c),f="",g=e.has(".prime-calendar-container"),h=e.find("input[name\x3d'currentshippingspeed']").attr("value"),
k=e.find("input[name\x3d'currentshipsplitpreference']").attr("value");1===q.length&&(n+="\x26oldoption\x3d"+h+"."+k);var l=e.find("input[name\x3d'defaultshipsplitpreference."+r+"']").attr("value"),p=e.find("input[name\x3d'usingprimeshipping."+r+"']").attr("value");l&&p&&(n+="\x26defaultshipsplitpreference."+r+"\x3d"+l,n+="\x26usingprimeshipping."+r+"\x3d"+p);l=e.find(".shipping-speed");l=a?l.find('input[type\x3d"radio"]:checked'):l.find("input[src*\x3dradio-on]");g&&!l.length&&(l=e.find("input[name\x3d'hiddenSelection"+
r+"']"));p=e.find(".ship-split-preferences").find("input[type\x3d'radio']:checked");1!==p.length&&(p=e.find(".ship-split-preferences").find("input[type\x3d'hidden'][name^\x3d'shippriority']"));m===e.data("orderid")&&(t(a,"shippingofferingid")?l=a:p=a,1===q.length&&(f=g?f+("\x26option\x3d"+l.data("key")+"."+(p?p.attr("value"):"")):f+("\x26option\x3d"+l.attr("value")+"."+(p?p.attr("value"):""))));var v=e.find("input[name\x3d'lineitemids"+r+"']");0<v.length&&(f+="\x26lineitemids"+r+"\x3d"+v.attr("value"));
d.isSecureUnifiedDeliveryEnabled()&&(v=e.find("input[name\x3d'issecureunifieddelivery"+r+"']"),0<v.length&&(f+="\x26issecureunifieddelivery"+r+"\x3d"+v.attr("value")));f+=ba(e,r);l.length?(f+=T(l,p,r,g),1===t(l,"isscheduleddelivery")?(c=l.closest(".shipping-speed").find('[id^\x3d"sd_widgets_"]'),u(c)&&(c=C("#sd-widgets-"+b)),f+="\x26"+c.children(":input").serialize()):1===t(l,"isscheduleddeliveryslot")&&t(l,"sddatastring")&&(f+="\x26ScheduledDeliveryEntity.data."+r+"\x3d"+encodeURIComponent(l.data("sddatastring"))),
"rush-ispu"===l.attr("value")&&(f+=R(e,r,p))):F(e)?f+=M(e,r,h,k):d.isRemoveDigitalFlagForScheduledDeliveryShipmentEnabled()&&"1"===C(c).find("input[type\x3d'hidden'][name\x3d'previousSDSelected"+r+"']").attr("value")||(f+="\x26isdigital"+r+"\x3d1");r++;n+=f}),0<r&&(n+="\x26groupcount\x3d"+r));c="ox_spc_set_ship_option";e.isSPP()&&(c="chk_revieworder_set_ship_option",p=C("#setOrderingPrefsCheckbox"),p.length&&p.is(":checked")&&(n+="\x26saveAsDefaultsSelected\x3d1"));p=C("input[name\x3duseCtb]").val();
n+="\x26isClientTimeBased\x3d"+p;1===t(a,"istrial")?(f=B()+":"+a.attr("name")+":"+a.attr("value"),n+="\x26trialkey\x3d"+f,X[f]&&(Y&&clearTimeout(Y),c="ox_spc_set_cached_ship_option",e.isSPP()&&(c="chk_revieworder_set_cached_ship_option"),n=n.replace("returnFullHTML\x3d1","returnFullHTML\x3d0"),n+="\x26trialSuccess\x3d1")):"undefined"!==typeof f&&(f=f+":"+a.attr("name")+":"+a.attr("value"),n+="\x26trialkey\x3d"+f);g&&g.refTag&&(c=g.refTag);g&&g.removeGiftOption&&(n+="\x26giftOrderid\x3d"+a.closest(".shipment").data("orderid"));
0===n.indexOf("\x26")&&(n=n.substr(1));g="/gp/buy/spc/handlers/set-delivery-options.html/ref\x3d"+c;f=e.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});d.isSPCMobileDisplayMoreShipOptionsEnabled()&&0<C(".mobile-view").length&&(f=e.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"}));C.ajax({type:"POST",url:g,data:n,dataType:"text",async:!0,cache:!1,headers:f,success:function(a,b,c){A(a,b,c);k.nukeDropdowns("#b2brd-cadence-dropdown")},error:function(a,b,
c){e.ajaxRedirect(a,b,c)}})}function F(a){return d.isVasTrueSPCEnabled()?"1"===C.trim(a.data("iahiddenshipment"))||0<a.find(".vas-scheduling-prefBlock").length:0<a.find(".vas-scheduling-prefBlock").length}function M(a,b,c,d){var e="\x26shippingofferingid"+b+"\x3d"+a.find("input[type\x3d'hidden'][name^\x3d'shippingofferingid']").val();e+="\x26guaranteetype"+b+"\x3d"+a.find("input[type\x3d'hidden'][name^\x3d'guaranteetype']").val();e+="\x26issss"+b+"\x3d"+a.find("input[type\x3d'hidden'][name^\x3d'issss']").val();
e+="\x26forceshipsplitpreference"+b+"\x3d"+a.find("input[type\x3d'hidden'][name^\x3d'forceshipsplitpreference']").val();return e+("\x26shippingspeed"+b+"\x3d"+c)+("\x26shippriority"+b+"\x3d"+d)}function R(a,b,c){var d="\x26preferredSSP"+b+"\x3d"+a.find("input[type\x3d'hidden'][name^\x3d'shipsplitpriority']").val();d+="\x26currentSSP"+b+"\x3d"+c.attr("value");"shipWhenever"==a.find("input[name\x3d'ispuShipSplitPriority']").attr("value")&&(d=d+("\x26isShipWheneverValid"+b+"\x3d1")+("\x26isShipWhenCompleteValid"+
b+"\x3d0"));return d}function U(a,b){z&&N(a);a=b.find("input[name\x3d'ispuLoadingText']").attr("value");if(e.isSPP()&&a){var c=C("#shipaddress");c&&c.length&&(c.hasClass("expanded")?l.show():(l.shrinkPanel(C(".spp-panel.expanded"),!1),l.shrinkPanel(c,!0,a)))}else l.show();a="returnpipedata\x3d0\x26returnFullHTML\x3d1\x26cachebuster\x3d"+(new Date).getTime()+"\x26hasWorkingJavascript\x3d1";c=b.find("input[name\x3d'storeAddressID']").attr("value");var d=b.find("input[name\x3d'storeId']").attr("value"),
f=b.find("input[name\x3d'storeOwnerId']").attr("value"),g=b.find("input[name\x3d'lineItemsQuantity']").attr("value"),h=b.find("input[name\x3d'destinationType']").attr("value"),k=b.find("input[name\x3d'ispuShippingOfferingId']").attr("value"),m=b.find("input[name\x3d'ispuShipSplitPriority']").attr("value"),n=b.find("input[name\x3d'ispuGuaranteeType']").attr("value"),p=b.find("input[name\x3d'ispuPageType']").attr("value");a=a+("\x26storeId\x3d"+d)+("\x26storeAddressId\x3d"+c)+("\x26storeOwnerId\x3d"+
f);a+="\x26lineItemsQuantity\x3d"+g;a+="\x26destinationType\x3d"+h;a+="\x26shippingOfferingId\x3d"+k;a+="\x26shipPriority\x3d"+m;a+="\x26guaranteeType\x3d"+n;a+="\x26pageType\x3d"+p;b=b.find("input[name\x3d'retailProgram']");b.length&&(a+="\x26retailProgram\x3d"+b.attr("value"));b="chk_spc_ispu_ship_option";e.isSPP()&&(b="chk_revieworder_ispu_ship_option");b="/gp/buy/ispu/handlers/ispu-select-store.html/ref\x3d"+b;c=e.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});0<C(".mobile-view").length&&
(c=e.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"}));C.ajax({type:"POST",url:b,data:a,dataType:"text",async:!0,cache:!1,headers:c,success:function(a,b,c){A(a,b,c)},error:function(a,b,c){e.ajaxRedirect(a,b,c)}})}function T(a,b,c,d,e){var f="";"undefined"!==typeof e&&(c+="-"+e);if(t(a,"rcxsspdecoupling"))return f={},f["shippingspeed"+c]=d?a.attr("key"):a.attr("value"),f["shippingofferingid"+c]=t(a,"shippingofferingid"),f["guaranteetype"+c]=t(a,"guaranteetype"),
f["issss"+c]=t(a,"issss"),f["forceshipsplitpreference"+c]=t(a,"forceshipsplitpreference"),d="shipWhenComplete",b&&(d=b.attr("value")),1===t(a,"isscheduleddelivery")&&(f["isscheduleddelivery"+c]="1",d="shipWhenComplete"),f["shippriority"+c]=d,f["preferredSSP"+c]=t(a,"shipsplitpriority"),f["currentSSP"+c]=b.attr("value"),f["isShipWheneverValid"+c]=t(a,"isshipwhenevervalid"),f["isShipWhenCompleteValid"+c]=t(a,"isshipwhencompletevalid"),f=C.param(f),"\x26"+f;f=d?f+("\x26shippingspeed"+c+"\x3d"+a.data("key")):
f+("\x26shippingspeed"+c+"\x3d"+a.attr("value"));f+="\x26shippingofferingid"+c+"\x3d"+t(a,"shippingofferingid");f+="\x26guaranteetype"+c+"\x3d"+t(a,"guaranteetype");f+="\x26issss"+c+"\x3d"+t(a,"issss");f+="\x26forceshipsplitpreference"+c+"\x3d"+t(a,"forceshipsplitpreference");d="shipWhenComplete";b&&(d=b.attr("value"));1===t(a,"isscheduleddelivery")&&(f+="\x26isscheduleddelivery"+c+"\x3d1",d="shipWhenComplete");return f+("\x26shippriority"+c+"\x3d"+d)}function I(a){var b=[a.closest(".shipment").data("orderid")];
S(a,b)}function V(a){var c=[];C("#spc-orders").find(".shipment").each(function(a,b){c.push(a)});b.increaseCount("checkout:spc:mobile:same-day-upsell-banner:clicked",1);S(a,c)}function S(a,b){l.show();var c="returnpipedata\x3d0\x26returnFullHTML\x3d1\x26cachebuster\x3d"+(new Date).getTime()+"\x26hasWorkingJavascript\x3d1",d="/gp/buy/spc/handlers/set-delivery-options.html/ref\x3d"+a.data("reftag");C("#spc-orders").find(".shipment").each(function(d,e){c+="\x26lineitemids"+d+"\x3d"+C(e).find("input[type\x3d'hidden'][name\x3d'lineitemids"+
d+"']").attr("value");c+=ba(C(e),d);var f=C(e).find("input[type\x3d'hidden'][name^\x3d'shippriority']");if(e=-1===b.indexOf(d)?C(e).find("#selected-ship-option-"+d):a)c+="\x26shippingofferingid"+d+"\x3d"+e.data("shippingofferingid"),c+="\x26guaranteetype"+d+"\x3d"+e.data("guaranteetype"),c+="\x26issss"+d+"\x3d"+e.data("issss"),c+="\x26forceshipsplitpreference"+d+"\x3d"+e.data("forceshipsplitpreference"),c+="\x26shippriority"+d+"\x3d"+e.data("targetshipoptionkey"),e.data("rcxsspdecoupling")&&(c+="\x26preferredSSP"+
d+"\x3d"+e.data("shipsplitpriority"),c+="\x26currentSSP"+d+"\x3d"+f.attr("value"),c+="\x26isShipWheneverValid"+d+"\x3d"+e.data("isshipwhenevervalid"),c+="\x26isShipWhenCompleteValid"+d+"\x3d"+e.data("isshipwhencompletevalid"))});var f=C("#spc-orders").find("input[type\x3d'hidden'][name\x3d'groupcount']").val();c+="\x26groupcount\x3d"+f;c+="\x26isClientTimeBased\x3d"+C("input[type\x3d'hidden'][name\x3d'useCtb']").attr("value");c+="\x26trialkey\x3d"+B()+":"+a.data("orderindex")+":"+a.data("targetshipoptionkey");
f=e.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});C.ajax({type:"POST",url:d,data:c,dataType:"text",async:!0,cache:!1,headers:f,success:function(a,b,c){A(a,b,c)},error:function(a,b,c){e.ajaxRedirect(a,b,c)}})}function W(b,c,e,f){k.protectAgainstDoubleAction(c)||d.isAmazonDayIncentiveDetailsLinkRedirectionEnabledOnStripeMsg()&&b.$target.is('a[target\x3d"PromoDetails"]')||na||(a.trigger(e,b),b=b.$currentTarget.find("a"),f&&f(b))}function ba(a,b){var c=a.find("input[name\x3d'onOrAfterAppointment"+
b+"']").val();a=a.find("input[name\x3d'onOrAfterLineItemId"+b+"']").val();var d="";c&&a&&(d=d+("\x26onOrAfterAppointment"+b+"\x3d"+c)+("\x26onOrAfterLineItemId"+b+"\x3d"+a));return d}function ca(){D.closest("div.shipping-speed").find('input[type\x3d"radio"]').attr("checked",!0);"undefined"!==typeof f?(0<C(".mobile-view").length?f.get(C("#faster-than-same-day-sosp-popover")):f.get(C("#faster-than-same-day-spc-popover"))).hide():a.$("div.a-popover button.a-button-close").trigger("click");P(D,null,null,
{removeGiftOption:!0})}var C=a.$;if(!C("html").hasClass("a-ie6"))if(r.spcpage){var Z,X={},z=C("html").hasClass("a-touch"),Y,aa={},ea,ka,D;r.spcpage.scheduledDeliverySetSOCallback=function(b,c){e.isSPP()&&a.objectIsEmpty(b)||(r.spcpage&&C("#spcpagecontent").is(":visible")?r.spcpage.actionSetShipOptions(null,c,b):P(null,c,b))};r.spcpage.scheduledDeliverySetSOCallbackWithTarget=function(b,c,d){e.isSPP()&&a.objectIsEmpty(c)||(r.spcpage&&C("#spcpagecontent").is(":visible")?r.spcpage.actionSetShipOptions(null,
d,c):P(b,d,c))};r.spcpage.scheduledDeliveryEnableSOCallback=function(){};r.spcpage.scheduledDeliveryMdwSetSOCallback=function(b,c,f){d.isSsdMdwEnabled()&&(e.isSPP()&&a.objectIsEmpty(c)||(r.spcpage&&C("#spcpagecontent").is(":visible")?r.spcpage.actionSetShipOptions(null,f,c):P(b,f,c)))};r.spcpage.secureDeliverySetSOCallback=function(a,b){d.isSecureUnifiedDeliveryEnabled()&&P(a,null,null,b)};C(document).delegate(".ship-option","click",function(c){var e=C(c.target);d.isSPCMobileDisplayMoreShipOptionsEnabled()&&
C(c.target).closest(".ship-option").hasClass("mobile-view")&&"a-link-normal"!==c.target.parentNode.parentNode.className&&c.preventDefault();var h=C(c.currentTarget);b.resetMetrics();if(!e.is('a[target\x3d"AmazonHelp"]')&&!e.is('a[target\x3d"PromoDetails"]')&&!e.hasClass("no-ship-option-selection-change"))if(d.isAmazonDayDatePickerClickSkipShipOptionChangeEnabled()&&e.closest(".no-ship-option-selection-change").length)c.preventDefault();else if(!(h.is("input")||e.hasClass("a-button")||e.closest("a-button").length||
e.is("img")&&(e.closest("div").is(".prime-ship-speed")||e.closest(".prime-fake-radio").parent().is(".prime-ship-speed"))))if(e=h.find("div.prime-ship-speed"),0<e.length)e.find("a:first img").trigger("click");else if((e=h.find("input[type\x3d'image']").attr("src"))&&e.match(/radio-off/)&&C(".ap_popover_sprited").hide(),h=h.find("input[type\x3d'radio']"),(e=h.closest("div.shipping-speeds").data("sospargs"))&&1===h.data("isscheduleddelivery")&&!h.is(":checked"))l.show(),h.attr("checked",!0),N(h),k.redirectWithJavascript("/gp/buy/shipoptionselect/handlers/display.html?"+
e);else if(d.removesGiftOptionOnRush()&&0<h.closest(".shipment").find("input[name^\x3dItemIsGift]").length&&1===h.closest(".radio-standard").data("nosupportforgiftoption")){D=h;D.is(":checked")&&(D.attr("checked",!1),ea.attr("checked",!0));var m=0<C(".mobile-view").length?C("#faster-than-same-day-sosp-popover"):C("#faster-than-same-day-spc-popover");"undefined"!==typeof f?f.get(m).show():a.delay(function(){m.trigger("click")},10)}else if(h.hasClass("js-no-serverside-callback")&&(h.attr("checked",
!0),N(h),h.closest(".a-section-expander-container").find(".a-link-section-expander").click()),!d.isSsdMdwEnabled()||1!==h.closest(".radio-standard").data("callcaseforsdoverride"))if(1!==t(h,"isscheduleddelivery")||!g.isDesktopSpc()){e=C("#disableSubmitButtons").length;var n=!1;d.isSPCMobileDisplayMoreShipOptionsEnabled()&&(c=C(c.currentTarget).closest(".ship-option"),c.hasClass("mobile-view")&&!c.hasClass("mobile-selected-option")&&(n=!0));!e&&h.is(":checked")&&!n||1===h.data("isscheduleddelivery")||
(h.attr("checked",!0),P(h))}});C(document).delegate(".ship-option input[type\x3d'radio']","change",function(a){if(!d.isSPCMobileDisplayMoreShipOptionsEnabled()||!C(a.target).closest(".ship-option").hasClass("mobile-view")){a=C(a.currentTarget);var b=a.closest("div.prime-ship-speed");d.removesGiftOptionOnRush()&&0<a.closest(".shipment").find("input[name^\x3dItemIsGift]").length&&1===a.closest(".radio-standard").data("nosupportforgiftoption")||d.isSsdMdwEnabled()&&1===a.closest(".radio-standard").data("callcaseforsdoverride")||
1===t(a,"isscheduleddelivery")&&g.isDesktopSpc()||(0<b.length?b.find('input[type\x3d"radio"]').attr("checked",!1):1!==a.data("isscheduleddelivery")&&P(a))}});C(document).delegate(".ispu-ship-option","click",function(a){if(d.isISPUMasterEnabled()){C(a.target).closest(".ispu-ship-option").hasClass("mobile-view")&&a.preventDefault();C(a.target);var c=C(a.currentTarget);b.resetMetrics();var e=c.find("input[type\x3d'radio']"),f=!1;a=C(a.currentTarget).closest(".ispu-ship-option");a.hasClass("mobile-view")&&
!a.hasClass("mobile-selected-option")&&(f=!0);if(!e.is(":checked")||f)e.attr("checked",!0),U(e,c)}else b.increaseCount("checkout:ispu:selection:weblab:disabled",1)});C(document).delegate(".ispu-ship-option input[type\x3d'radio']","change",function(a){if(!d.isISPUMasterEnabled())b.increaseCount("checkout:ispu:selection:weblab:disabled",1);else if(!C(a.target).closest(".ispu-ship-option").hasClass("mobile-view")){a=C(a.currentTarget);var c=a.closest(".ispu-ship-option");U(a,c)}});C(document).delegate(".rush-ispu-ship-option",
"click",function(a){if(d.isRushISPUMasterEnabled()){C(a.target).closest(".rush-ispu-ship-option").hasClass("mobile-view")&&a.preventDefault();C(a.target);var c=C(a.currentTarget);b.resetMetrics();var e=c.find("input[type\x3d'radio']"),f=!1;a=C(a.currentTarget).closest(".rush-ispu-ship-option");a.hasClass("mobile-view")&&!a.hasClass("mobile-selected-option")&&(f=!0);if(!e.is(":checked")||f)e.attr("checked",!0),U(e,c)}else b.increaseCount("checkout:rushIspu:selection:weblab:disabled",1)});C(document).delegate(".rush-ispu-ship-option input[type\x3d'radio']",
"change",function(a){if(!d.isRushISPUMasterEnabled())b.increaseCount("checkout:rushIspu:selection:weblab:disabled",1);else if(!C(a.target).closest(".rush-ispu-ship-option").hasClass("mobile-view")){a=C(a.currentTarget);var c=a.closest(".rush-ispu-ship-option");U(a,c)}});C(document).delegate(".rush-ispu-view-details-link","click",function(a){a.preventDefault();a.stopPropagation()});C(document).delegate(".mfn-ispu-view-details-link","click",function(a){a.preventDefault();a.stopPropagation()});a.declarative("shipping-speed-expander-toggle",
["click"],function(a){var b=a.$target.closest(".a-box");if(b.hasClass("a-single")){var c=b.find(".expanded-header-content");var d=b.find(".collapsed-header-content");d.hide();c.hasClass("prime-title")&&c.find("div").attr("style","");c.show()}else d=b.find(".collapsed-header-content"),c=b.find(".expanded-header-content"),b=b.siblings(".a-expander-content").find(".a-icon-touch-radio-active").siblings(".a-radio-label").html(),d.html(b),c.hide(),d.show();k.toggleExpanderContent(a)});a.declarative("select-prime-slot",
["click"],function(a){a=a.$currentTarget;C(".a-button-close").trigger("click");a.closest(".valid-slot").hasClass("selected-slot")||P(a)});var na=!1;C(document).delegate(".mobile-upsell","touchmove",function(a){na=!0});C(document).delegate(".mobile-upsell","touchstart",function(a){na=!1});a.declarative("select-upsell-shipping-speed",["click","touchend"],function(a){W(a,"select-upsell-shipping-speed","a:checkout:mobile-upsell-shipping-speed:select",I)});a.declarative("select-all-upsell-shipping-speed",
["click","touchend"],function(a){W(a,"select-all-upsell-shipping-speed","a:checkout:mobile-upsell-shipping-speed:select-all",V)});a.declarative("faster-than-same-day-save",["click"],ca);a.declarative("faster-than-same-day-sosp-save",["click"],ca);a.on("checkout:reload:spc",c);a.on("checkout:reload:spp-revieworder",c)}else q.log("window.spcpage undefined, shipping-speed-selection-controller not initialized","WARN","ship-speed")});"use strict";q.when("A","page-detector","spc-page-state","client-side-metrics",
"page-conductor","page-transition-controller","weblab-helper").register("order-summary-controller",function(a,l,n,e,k,m,g){function b(a){if(0!==p("#currencyConverterFooter").length){p("input[name\x3dcurrentViewId]").val(a.attr("id"));var b=a.find("input[name\x3dgurupaFxCurrencyChoice]").val();p("input[name\x3d'fxCurrencyChoice']").val(b);b=p("input[name\x3d'fxApplicabilityChoice']");if(0!==b.length){var c=a.find("input[name\x3dgurupaFxApplicabilityChoice]").val();b.val(c)}b=a.find("input[name\x3dselectedCurrencyOption]").val();
p("input[name\x3d'currentCurrencyOption']").val(b);b=p("input[name\x3d'currentTnCOption']");0!==b.length&&(c=a.find("input[name\x3dselectedTnCOption]").val(),b.val(c));b=a.find("input[name\x3dplaceYourOrderButtonText]").val();p(".place-your-order-button").val(b);u&&(k.isSPP()?p(".place-order-button-text"):p(".place-your-order-button + span")).text(b);b=a.find("input[name\x3d'selectedCurrencyOption']").val();c=p("#subtotals-marketplace-table");var e=p("#subtotals-marketplace-spp-bottom"),f=p("#vatRetailSubtotals-marketplace-table"),
g=p("#vatGlobalSubtotals-marketplace-table"),h=p("#vatMerchantSubtotals-marketplace-table"),m=p("#subtotals-transactional-table"),l=p("#subtotals-transactional-spp-bottom"),n=p("#vatRetailSubtotals-transactional-table"),t=p("#vatGlobalSubtotals-transactional-table"),r=p("#vatMerchantSubtotals-transactional-table");"LOCAL"===b?(d("transactional"),m.show(),l.show(),n.show(),t.show(),r.show(),c.hide(),e.hide(),f.hide(),g.hide(),h.hide()):"MARKETPLACE"===b&&(d("marketplace"),m.hide(),l.hide(),n.hide(),
t.hide(),r.hide(),c.show(),e.show(),f.show(),g.show(),h.show());b=p("#ACCB_GIFT_CARD_ORDER_SUMMARY_POLICY_MESSAGE");0!==b.length&&("LOCAL"===a.find("input[name\x3d'currencyOptions']:checked").val()?b.show():b.hide());p("#tfx-header").hide()}}function d(a){g.isTFXGuaranteedExchangeFeeEnabled()||(a="marketplace");p(".tfx-currency").each(function(){p(this).text(p(this).data(a))})}function f(b){d(b);n.prop("currencyType",b);var c=p("#subtotals-marketplace-table"),f=p("#subtotals-transactional-table"),
g=p("#subtotals-marketplace-spp-bottom"),h=p("#subtotals-transactional-spp-bottom"),m=p("#vatRetailSubtotals-transactional-table"),r=p("#vatGlobalSubtotals-transactional-table"),q=p("#vatMerchantSubtotals-transactional-table"),w=p("#vatRetailSubtotals-marketplace-table"),x=p("#vatGlobalSubtotals-marketplace-table"),y=p("#vatMerchantSubtotals-marketplace-table"),A=p(".place-your-order-button"),J=p("#fx-enable"),N=k.isSPP()?p(".place-order-button-text"):p(".place-your-order-button + span");k.isSPP()||
setTimeout(function(){var a=Math.max(c.outerHeight(),f.outerHeight());0<a&&(c.height(a),f.height(a))},500);if(!u){e.increaseCount("removeauijs17");var C=G.siblings("i"),Z=t.siblings("i");if(C.hasClass("a-icon-touch-radio-inactive")||C.hasClass("a-icon-touch-radio-active"))"marketplace"===b?(C.removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active"),Z.removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive")):(Z.removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active"),
C.removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive"))}"marketplace"===b?(p("#fxGoodNews-transactional").hide(),p("#fxGoodNews-marketplace").show(),f.hide(),c.show(),h.hide(),g.show(),m.hide(),r.hide(),q.hide(),w.show(),x.show(),y.show(),B&&B.hide(),J&&J.hide(),A.val(p("#placeYourOrderTextMarketplace").val()),v()&&p("#ACCB_GIFT_CARD_ORDER_SUMMARY_POLICY_MESSAGE").hide(),u&&N.text(p("#placeYourOrderTextMarketplace").val()),p("#currencyChanged").attr("value","true"),p("#fxCurrencyChoice").attr("value",
"marketplace"),p("#tfx-total-header").addClass("aok-hidden"),p("#mkt-total-header").removeClass("aok-hidden")):(p("#fxGoodNews-transactional").show(),p("#fxGoodNews-marketplace").hide(),c.hide(),f.show(),g.hide(),h.show(),w.hide(),x.hide(),y.hide(),m.show(),r.show(),q.show(),B&&B.show(),J&&J.show(),A.val(p("#placeYourOrderTextTransactional").val()),v()&&p("#ACCB_GIFT_CARD_ORDER_SUMMARY_POLICY_MESSAGE").show(),u&&N.text(p("#placeYourOrderTextTransactional").val()),p("#currencyChanged").attr("value",
"false"),p("#fxCurrencyChoice").attr("value","transactional"),p("#mkt-total-header").addClass("aok-hidden"),p("#tfx-total-header").removeClass("aok-hidden"));a.trigger("checkout:spc:ordersummary:sizeChanged");l.isMobileSpc()&&(g=p("#vatBreakdownNote"),0<g.size()&&(h=g.attr("href"),h=0<h.lastIndexOf(".html?")?h+("\x26currencyType\x3d"+b):h+("?currencyType\x3d"+b),g.attr("href",h)))}function c(a){var b=p("#tfx-footer"),c=p("#tfx-header");if(!u){e.increaseCount("removeauijs18");var d=p("#fxApplicabilityDecision").siblings("i"),
g=p("#fxApplicabilityAdoption").siblings("i");if(g.hasClass("a-icon-touch-checkbox-inactive")||g.hasClass("a-icon-touch-checkbox-active"))g.removeClass("a-icon-touch-checkbox-active").addClass("a-icon-touch-checkbox-inactive"),d.removeClass("a-icon-touch-checkbox-inactive").addClass("a-icon-touch-checkbox-active")}"accept"===a?(h()?(p("#fx-terms-and-conditions").show(),p("#fxCardCurrencySubcondition").hide()):(p("#fx-enable").show(),p("#fx-disable").hide()),p("#fxApplicabilityDecision").prop("checked",
!0),c.show(),f("transactional"),b.show(),p("#marketplaceRadio").prop("checked",!1),p("#transactionalRadio").prop("checked",!0),p("#fxApplicabilityChoice").attr("value","accept")):(h()?(p("#fx-terms-and-conditions").hide(),p("#fxCardCurrencySubcondition").show()):(p("#fx-enable").hide(),p("#fx-disable").show()),p("#fxApplicabilityAdoption").prop("checked",!1),c.hide(),f("marketplace"),b.hide(),p("#transactionalRadio").prop("checked",!1),p("#marketplaceRadio").prop("checked",!0),p("#fxApplicabilityChoice").attr("value",
"decline"))}function h(){return k.isSPP()&&p("input[name\x3disNewTFXExperienceEnabled]").length}function q(a){a.preventDefault();a=w();var c=a.find("input[name\x3d'currencyOptions']:checked").val(),d=p("input[name\x3d'currentCurrencyOption']").val();c!==d&&(e.increaseCount("checkout:CSM:TFX:CurrencySelection:"+d,1),c=a.find("input[name\x3d'currencyToggleTransition']").val(),a.hide(),a=p("#"+c),a.show(),b(a))}function v(){return 0!==p("#ACCB_GIFT_CARD_ORDER_SUMMARY_POLICY_MESSAGE").length}function w(){var a=
p("input[name\x3d'currentViewId']").val();return p("#"+a)}function x(a){a.preventDefault();a=w();var c=a.find("input[name\x3d'currencyConverterTCAgreement']").val(),d=p("input[name\x3d'currentTnCOption']").val();c===d&&(e.increaseCount("Checkout:CSM:TFX:TCSelection:"+!d,1),c=a.find("input[name\x3d'tncTransition']").val(),a.hide(),a=p("#"+c),a.show(),b(a))}var p=a.$;if(!p("html").hasClass("a-ie6")){var u=r.P&&r.P.AUI_BUILD_DATE,B,A,t,G;g.isTFXCurrencyToggleOnTabletFixed()?(p(document).delegate("#checkoutCurrencyTransactional",
"click",function(){f("transactional")}),p(document).delegate("#checkoutCurrencyMarketplace","click",function(){f("marketplace")})):(p(document).delegate("#transactionalRadio","click",function(){f("transactional")}),p(document).delegate("#marketplaceRadio","click",function(){f("marketplace")}));p(document).delegate("#fxApplicabilityDecisionCheckbox","click",function(){c("decline")});p(document).delegate("#fxApplicabilityAdoptionCheckbox","click",function(){var a=h()&&!p("#fxApplicabilityAdoption").is(":checked");
c(a?"decline":"accept")});a.on("a:expander:tfx-options-expander:toggle:expand",function(a){e.increaseCount("checkout:spp-ordersummary:expand_tfx_options",1)});a.on("a:expander:tfx-see-rate-expander:toggle:expand",function(a){e.increaseCount("checkout:spp-ordersummary:expand_tfx_see_rate",1)});p(document).delegate("input[name\x3d'currencyOptions']","click",q);p(document).delegate("input[name\x3d'currencyConverterTCAgreement']","click",x);return{changeCurrency:f,initOrderSummary:function(){t=p("#transactionalRadio");
G=p("#marketplaceRadio");B=p("#tfx-see-exchange-rates");A=p("#tfx-switch-currency-options");u||(e.increaseCount("removeauijs15"),p("#transactionalRadioImage").remove(),p("#marketplaceRadioImage").remove(),p("#acceptAccImage").remove());var a=p("#exchange-rate-link"),c=p("#switch-currency-link");if(0!==G.length){var d=A.find('input[name\x3d"switchCurrency"]'),g=d.not(":checked");d=n.prop("currencyType")||d.filter(":checked").val();g.val()===d?g.trigger("click"):f(d);u||(e.increaseCount("removeauijs16"),
a.find("i.a-icon-collapse").remove(),c.find("i.a-icon-collapse").remove())}b(w());p("#currencyConverterFooter").find("*[disabled\x3d'']").prop("disabled",!1)},updateCurrencyView:q,updateTnCView:x}}});"use strict";q.when("A","ready").register("spc-page-state",function(a){var l={};return{prop:function(a,e){if(a&&"string"===typeof a)return 1<arguments.length&&(l[a]=e),l[a]}}});"use strict";q.when("A","ready").execute(function(a){function l(){0<n("#spcCachedPromiseData").length&&(e=(new Date).getTime(),
n(".place-your-order-button").click(function(){var a=(new Date).getTime()-e;n("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'spcWaitingTime' value\x3d'"+a+"' /\x3e")}))}var n=a.$,e=0;a.on("checkout:reload:spc",l);a.on("checkout:reload:spclite",l);a.on("checkout:reload:spp-revieworder",l)});"use strict";q.when("A","client-side-metrics","ready").register("spc-apx-standin",function(a,l){function n(e){var k=a.state("apx-standin-state");k.timestamp=(new Date).toISOString();k.metricName=e;return k}
if(a.state("apx-standin-state")){var e=n("APX_STANDIN_ENABLED");l.emitNexusMetrics(e,e.producerId,e.schemaId);a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&"apx-popover"==a.popover.name||a.popover&&a.popover.originalFocus&&a.popover.originalFocus.id&&"payChangeButtonId"==a.popover.originalFocus.id)a=n("APX_STANDIN_POPOVER_SHOW"),l.emitNexusMetrics(a,a.producerId,a.schemaId)});a.on("a:sheet:afterShow:apx_standin_bottom_sheet_instance",function(a){a=n("APX_STANDIN_POPOVER_SHOW");l.emitNexusMetrics(a,
a.producerId,a.schemaId)})}});"use strict";q.when("A","page-transition-controller","scroll-controller","loading-spinner-controller","page-conductor","checkout-general-utils","ready").register("changeCustomerDetailsPopover",function(a,l,n,e,k,m){function g(){return 0<f("#onblur-character-validation-error-changeNameInput").size()}function b(){c&&c.find("button[data-action\x3da-popover-close]").trigger("click")}function d(){var a=f("#saveButton");if(a.length){var b=f("#changeNameInput"),c=f("#changePostNumberInput"),
d=f("#changePhoneInput"),e=1,k=1,m=1;b.length&&!b.val()&&(e=0);c.length&&!c.val()&&(k=0);d.length&&!d.val()&&(m=0);e&&k&&m&&!g()?(a.removeClass("a-button-disabled"),a.removeAttr("disabled")):(a.addClass("a-button-disabled"),a.attr("disabled","true"))}}var f=a.$,c;a.declarative("clickedsave","click submit",function(a){if(!g()){var c=f("#changeNameInput").val(),d=f("#changePhoneInput").val(),e=f("#changePostNumberInput").val(),h=f("#changeAccountNameCheckBox").is(":checked")?1:0,m=f("#changePostNumberCheckBox").is(":checked")?
1:0;c="custName\x3d"+encodeURIComponent(c)+"\x26changeAccountName\x3d"+encodeURIComponent(h);d&&(c=c+"\x26custPhoneNumber\x3d"+encodeURIComponent(d));e&&(c=c+"\x26dhlPostNumber\x3d"+encodeURIComponent(e),m&&(c=c+"\x26changeDhlPostNumberInEmbu\x3d"+encodeURIComponent(m)));d=a.data.changeDetailUrl;k.isSPP()&&(d=a.$target.data("changedetailurl"),f("#cancelReminderPopover").click());k.isSPP()||(c+="\x26usePipelineDispatch\x3d1");l.show();d&&f.ajax({type:"POST",data:c,url:d,dataType:"html",contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
async:!0,cache:!1,headers:k.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"}),success:function(a,c,d){b();l.hide();k.ajaxUpdatePage(a,c,d)},error:function(a,b,c){k.ajaxRedirect(a,b,c)}})}});a.declarative("clickedsave","mouseenter mousemove touchstart",function(a){d()});a.declarative("changeNameKeyIn changePostNumberKeyIn changePhoneNumberKeyIn","keydown keyup change keypress mouseenter mouseleave mousemove",function(a){d()});a.declarative("clickedcancel","click submit",function(a){b()});a.on("a:popover:beforeShow:changeDetailPopover",
function(a){g()&&f("#onblur-character-validation-error-changeNameInput").remove()});a.on("a:popover:show:changeDetailPopover",function(a){if(!k.isSPP()){var b=f(r).width(),e=f(r).height();b=parseInt(.6*b,10);e=parseInt(.7*e,10);c=a.popover.$popover;var g=a.popover;c.css("position","absolute");c.css("top","50px");c.css("height",e+"px");c.css("width",b+"px");g.updatePosition()}b=k.isSPP()?a.popover.originalnamevalue:a.popover.$trigger.data("original-name-value");e=k.isSPP()?a.popover.originalcellphonevalue:
a.popover.$trigger.data("original-cellphone-value");a=k.isSPP()?a.popover.originalpostnumbervalue:a.popover.$trigger.data("original-postnumber-value");g=f("#changeNameInput");var h=f("#changePhoneInput"),m=f("#changePostNumberInput");g.val(b);h.val(e);m.val(a);d()})});"use strict";q.when("A","page-transition-controller","ajax-utility","page-conductor","page-detector","checkout-general-utils").register("prime-decline-controller",function(a,l,n,e,k,m){function g(){d("input[name\x3d'changeCardNoEndDatePrime']").attr("data-action",
"prime-decline-element")}function b(a,b,d){if(d.getResponseHeader("x-amz-checkout-page"))e.ajaxUpdatePage(a,b,d);else{a=n.jsonify(a);if(!a)return e.redirect();a.error?l.hide():a.errors?l.hide():a.autohandlererror?(b=(a=a.autohandlererror)?a.action:null,d=a&&a.type?a.type:b&&b.code?b.code:"string"===typeof a?a:"Unknown:pipelineJSError",r.location.href="fatal"===b?"/gp/buy/payselect/handlers/error.html?errorAction\x3dfatal\x26errorType\x3d"+encodeURIComponent(d):"redirect"===b?a.url:"/gp/buy/payselect/handlers/error.html?errorType\x3d"+
encodeURIComponent(d)):e.redirect(a)}}var d=a.$;d("html").hasClass("a-ie6")||(a.declarative("prime-decline-element",["click","touchend"],function(a){m.protectAgainstDoubleAction("prime-decline-element")||(a.$event.preventDefault(),l.show(),a=(new Date).getTime(),a="changeCardNoEndDatePrime\x3d1\x26hasWorkingJavascript\x3d1\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26fromAnywhere\x3d"+d("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+a,d.ajax({type:"POST",url:"/gp/buy/spc/handlers/stuff-handler.html/ref\x3dox_spc_prime_renew_nodate",
data:a,headers:{"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":"spc"},contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",success:b,error:e.ajaxRedirect}))}),a.on("checkout:reload:spc",g),a.on("checkout:reload:spp-revieworder",g))});"use strict";q.when("A","loading-spinner-controller","page-conductor").register("prime-popover-controller",function(a,l,n){function e(){m={};a.defer(function(){0!==k("#spc-orders").find(".prime-popover-link").length&&
(k("#spc-orders").find(".prime-popover-link").each(function(){var a=k(this);if(a.data("action")){a.removeAttr("href").attr("tabindex",0);var b=a.data("aCheckoutModalPopover");var d=b.name,e="";b.width&&b.height&&(e="width:"+b.width+"px;height:"+b.height+"px;");0<k("#spc-orders").find("#"+d+"-popover").length||(b=k(['\x3cdiv id\x3d"a-popover-'+d+'" class\x3d"a-popover-preload" style\x3d"display:none;"\x3e','\x3cdiv id\x3d"'+d+'-popover" class\x3d"checkout" style\x3d"'+e+'"\x3e\x3c/div\x3e',"\x3c/div\x3e"].join("")),
k("#spc-orders").append(b));a=a.data("aCheckoutModalPopover").name;m[a]||(b=k(".prime-popover-content").html())&&0<b.length&&(m[a]=b,k("#"+a+"-popover").html(b))}}),k("#spc-orders").find(".a-box").each(function(){var a=k(this),b=a.find(".prime-ad-banner-content .prime-popover-link");1<b.length&&(b=b.first());a.find("a.primeAdLauncher").each(function(){var a=k(this);a.wrap('\x3cspan class\x3d"a-declarative" data-action\x3d"prime-event" data-prime-event\x3d\'{"metric":"lm3"}\'\x3e\x3c/span\x3e');a.replaceWith(b.clone().text(a.text()).addClass("a-size-mini"))})}))})}
var k=a.$;if(!k("html").hasClass("a-ie6")){var m={};a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("prime")&&(a=a.popover.name,!m[a])){var b=k("input#primePopopverFallbackContent").val()||"";m[a]=b;k("#"+a+"-popover").html(b)}});a.on("checkout:reload:spc",e);a.on("checkout:reload:spp-revieworder",e)}});"use strict";q.when("A","page-transition-controller","back-button-protection","page-conductor","weblab-helper").register("place-order-controller",function(a,
l,n,e,k){function m(){if(!e.isAnimating()){var d=b("#spc-form");if("0"===b("#showPageTransition").attr("content"))if(d.hasClass("paylast-spc"))l.show();else{if(0<b("#enableAlternatePYOBlocker").length){var f=d.find(".a-button.continue-button");if("disabled"===f.find("input").attr("disabled"))return;f.find("input").attr("disabled","disabled");f.addClass("a-button-disabled");setTimeout(function(){f.removeClass("a-button-disabled");f.find("input").removeAttr("disabled")},4E4)}}else l.showPageTransition();
var c=b("#currencyChanged");0<c.length&&"true"===c.val()&&(c='\x3cinput type\x3d"hidden" name\x3d"checkoutCurrencySelection.'+b("#tfx-switch-currency-options").find("input:radio:checked").val()+'" /\x3e',b("#spc-form-inputs").append(c));if(k.isMfaPSD2DeviceDescriptionCollectionEnabled()){c=[{name:"javaEnabled",value:r&&r.navigator&&r.navigator.javaEnabled()},{name:"language",value:r&&r.navigator&&r.navigator.language},{name:"screenColorDepth",value:r&&r.screen&&r.screen.colorDepth},{name:"screenHeight",
value:r&&r.screen&&r.screen.height},{name:"screenWidth",value:r&&r.screen&&r.screen.width},{name:"timeZone",value:(new Date).getTimezoneOffset()}];for(var g=0;g<c.length;g++)if(c[g].name!==G&&c[g].value!==G){var m='\x3cinput type\x3d"hidden" name\x3d"'+c[g].name+'" value\x3d"'+c[g].value+'" /\x3e';b("#spc-form-inputs").append(m)}}0==d.find("input[type\x3d'hidden'][name\x3d'placeYourOrder1']").length&&d.append("\x3cinput type\x3d'hidden' name\x3d'placeYourOrder1' value\x3d'1' /\x3e");(c=a.state("firetv-aws-attributes"))&&
c.queryParams&&(g=d.attr("action"),g+=0<=g.indexOf("?")?"\x26":"?",g+=b.param(c.queryParams),d.attr("action",g));e.isSPP()&&d.append(b("#subtotalsSection").find("input").hide());n.markAsDirty();d.submit()}}function g(a){a.preventDefault();m(a.target)}var b=a.$;if(!b("html").hasClass("a-ie6"))return a.declarative("a-checkout-place-order",["click"],function(a){m(a.target)}),b(document).delegate("span.place-order-button-link","click",g),{placeOrderClick:m,placeOrderClickDelegate:g,PLACE_ORDER_BUTTON_LINK_SELECTOR:"span.place-order-button-link"}});
"use strict";q.when("A","page-conductor","button-blocker","client-side-metrics","weblab-helper").register("verification-checkbox-controller",function(a,l,n,e,k){function m(a){x?g(a):b(a);p&&a&&a.blocking&&(e.setmarker("fn"),p=!1)}function g(a){var b=y(".continue-button"),d=y(".continue-button-blocker"),e=y(".place-order-blocker-message.custom-blocker-message");if(a.blocking||!c())a.blocking?(e.text(a.message),b.addClass("aok-hidden"),d.removeClass("aok-hidden")):(e.empty(),b.removeClass("aok-hidden"),
d.addClass("aok-hidden"),q.when("a-tooltip").execute(function(a){(a=a.get(d))&&a.isActive()&&a.hide()}))}function b(a){a.blocking?n.show("place-order-imb-checks",a.message):(n.hide("place-order-imb-checks"),y("#hasTVNavigation").length&&q.when("a-tv").execute(function(a){a.select(".continue-button")}))}function d(){var b={blocking:!1,message:""};if(x){var c=y("#spc-imb").find(".verification-checkbox input:not(:checked)");0<c.length&&(b={blocking:!0,message:c.first().closest(".verification-checkbox").attr("data-blocker-message")})}else{e.increaseCount("removeauijs23");
if(!y("#spc-imb").find(".verification-checkbox").length)return;c=l.isSPP()?y("#spc-imb").find(".verification-checkbox input:not(:checked)"):y("#spc-imb").find(".verification-checkbox:not(:checked)");0<c.length&&(b={blocking:!0,message:l.isSPP()?c.first().closest(".spp-panel").hasClass("aok-hidden")?c.first().closest(".verification-checkbox").data("non-review-panel-blocker-msg"):c.first().closest(".verification-checkbox").data("blocker-message"):c.first().attr("data-blocker-message")})}k.isPyoClientSideInitiationEnabled()?
m(b):a.trigger("checkbox:primaryActionBlocker:blockingStateChanged",b)}function f(){var a=y("#wineNoticeCheckbox");a&&a.length&&(v?(a.attr("checked",""),w&&(a=a.siblings(".a-icon-touch-checkbox-inactive"))&&a.length&&(a.removeClass("a-icon-touch-checkbox-inactive"),a.addClass("a-icon-touch-checkbox-active"))):(a.removeAttr("checked",""),w&&(a=a.siblings(".a-icon-touch-checkbox-active"))&&a.length&&(a.removeClass("a-icon-touch-checkbox-active"),a.addClass("a-icon-touch-checkbox-inactive"))))}function c(){var a=
y("input[name\x3disINExpressCheckoutCC]");return a&&a.length?1===parseInt(a.val(),10):!1}function h(){k.isPyoClientSideInitiationEnabled()||f();y('[data-client-component\x3d"PrimaryActionBlockerCheckbox"]').length||(d(),k.isPyoClientSideInitiationEnabled()&&f());var a=r.P&&r.P.AUI_BUILD_DATE?'.verification-checkbox input[type\x3d"checkbox"]':"input.verification-checkbox";y("#spc-imb").find(a).unbind("change.verification-checkbox").bind("change.verification-checkbox",d)}var y=a.$,v,w=y("html").hasClass("a-touch"),
x=!l.isSPP()&&r.P&&r.P.AUI_BUILD_DATE,p=!0;if(!y("html").hasClass("a-ie6")){if(!k.isPyoClientSideInitiationEnabled())a.on("checkbox:primaryActionBlocker:blockingStateChanged",m);a.declarative("change-wine-notice-checkbox",["change"],function(a){v=a.$target.is(":checked")?1:0});a.on("checkout:reload:spc",h);a.on("checkout:reload:spclite",h);a.on("checkout:reload:spp-revieworder",h);a.on("checkout:reload:spp-collapsed",h);a.on("checkout:unload",function(){p=!0});a.on("checkout:afterReload",function(){p=
!1});return{verifyCheckboxes:d,updatePyo:m}}});"use strict";q.when("A","page-transition-controller","scroll-controller","ajax-utility","page-conductor","quantity-service","checkout-modal-popover","page-detector","checkout-general-utils","a-popover","client-side-metrics","weblab-helper").register("quantity-update-controller",function(a,l,n,e,k,m,g,b,d,f,c,h){function y(){S=V=!1;a.defer(function(){var a=F("#spc-orders");a.find("a.quantity-change-button-static").remove();"1"!==F("#spc-form-inputs").find("input[name\x3d'isQuantityInvariant']").val()&&
a.find("div.quantity-value-static").remove()});F(".lineitem").each(function(a,b){a=F(b);a.find(".no-js-quantity").remove();b=a.find(".quantity-dropdown");b.is(":visible")?(a.find(".js-select").prop("disabled",!1),b.removeClass("a-button-disabled")):(a=a.find(".quantity-input"),a.prop("disabled",!1),a.removeClass("a-form-disabled"))});var b=F("#pantry-mov-popover-content"),d=F("#pantry-mov-popover-placeholder");!b.length&&d.length&&(b=d.attr("data-device"),F.ajax({type:"GET",url:"/gp/pantry/checkout/mov/get-pantry-mov-popover-contents.html",
data:"device\x3d"+b,dataType:"text",async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(a,b,e){~a.indexOf("pantry-mov-popover-content")?d.append(a):c.increaseCount("checkout:pantry:pantry_mov_popover_contents:bad-content",1)},error:function(a,b,d){c.increaseCount("checkout:pantry:pantry_mov_popover_contents:"+d,1)}}))}function v(a,b){a=F('.update-quantity-error[data-itemid\x3d"'+a+'"]');a.find(".error-message").hide();a.find('.error-message[data-error-type\x3d"'+
b+'"]').show();a.find("i").show();a.find(".a-span12").show();a.show();b=a.closest(".item-details-right-column");b.find(".spc-quantity-dropdown-button").addClass("a-button-error");b.find(".spc-quantity-input").addClass("a-form-error");b=a.parents("div.update-quantity-error");a=b.siblings(".item-details");0<a.length&&(a.find(".a-input-text-wrapper").addClass("a-form-error"),a.removeClass("a-spacing-large"),a.find(".a-touch-select").addClass("a-input-text a-form-error"));b.show()}function w(a,b,g){var h=
g.getResponseHeader("x-amz-checkout-new-cart-quantity");d.updateCartByMash(h);if(g.getResponseHeader("x-amz-checkout-page"))k.ajaxUpdatePage(a,b,g,{pushNewFrame:"false"}),a=g.getResponseHeader("x-amz-checkout-updated-itemid"),g=g.getResponseHeader("x-amz-checkout-quantity-error"),a&&g&&v(a,g);else if(a=e.jsonify(a))if(a&&a.errors&&a.errors.pantry&&a.errors.pantry.mov)p(a.errors.pantry.showAddonInfo);else{if(a&&a.errors&&a.errors.addon&&(k.isSPP()&&c.increaseCount("checkout:spp-revieworder:addon_warn_pri",
1),g=a.errors.addon.type,b=a.errors.addon.asins,x(),F(".item-list").hide(),b.forEach(function(a){F('[data-asin\x3d"'+a+'"]').show()}),g=F("#addon-warning-"+g+"-launcher"),g.length)){F("input[name\x3duseLiveAUI]").length?f.get(g).attrs({$trigger:W}).show():ba&&F("div.checkout.spc-mobile.aui-templatized").length?g.click():(c.increaseCount("removeauijs19"),a=F.Event("keyup",{triggerPositioningElement:W,manualTrigger:!0}),g.trigger(a),0<F("div.spc-mobile").length&&(n.scrollToTop(),n.toggleScrollOff()));
l.hide();return}return k.redirect(a)}else k.redirect()}function x(){F("#a-popover-addon-warning-normal .select-address-title").hide();0<M?(F("#a-popover-addon-warning-normal .reduce-title").show(),F("#a-popover-addon-warning-normal .delete-title").hide()):(F("#a-popover-addon-warning-normal .delete-title").show(),F("#a-popover-addon-warning-normal .reduce-title").hide())}function p(a){var b=F("#pantry-mov-popover-launcher"),d=F(".pantry-mov-reduce-prompt"),e=F(".pantry-mov-delete-prompt"),f=F("#pantry-mov-addon-info-container");
b.length?(P()||c.increaseCount("checkout:pantry:pantry_mov_popover:non_spc",1),f.length&&f.empty(),a&&F("#addon-warning-normal-popover-content").length&&(x(),f.length||(f=F("\x3cdiv/\x3e",{id:"pantry-mov-addon-info-container"})),f.append('\x3chr class\x3d"a-divider-normal"\x3e').append(F("#addon-warning-normal-popover-content").html()).appendTo("#pantry-mov-popover-content")),0<M?(d.show(),e.hide()):(e.show(),d.hide()),b.length&&(b.click(),l.hide())):(c.increaseCount("checkout:pantry:pantry_mov_popover_contents:no-launcher",
1),k.redirect())}function u(a,b){l.show();var c={isClientTimeBased:F('input[name\x3d"useCtb"]').val(),fromAnywhere:F("input[name\x3dfromAnywhere]").val(),success:w};if(b)for(var d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);k.isSPP()?(c.ref="chk_ship_chg_qty_pri",b=F("#setOrderingPrefsCheckbox"),b.length&&b.is(":checked")&&(c.saveAsDefaultsSelected=1)):F(".spc-mobile.aui-templatized").length&&(c.ref="ox_spc_change_quantity");b=F("#addon-indicator")&&"true"===F("#addon-indicator").attr("data-has-addon-items");
d=F("#pantry-mov-indicator")&&"true"===F("#pantry-mov-indicator").attr("data-has-pantry-items");a||!b&&!d||(c.istrial=1);m.call(U,M,c);T?T.data("currentQuantity",M):I&&I.data("currentQuantity",M)}function B(){l.hide();r.location="/gp/aw/c/ref\x3dox_spc_deal_expired?app-action\x3dcart"}function A(a){var b=R;M=R;T&&q.when("a-dropdown").execute(function(a){T&&(a.getSelect(T).setValue(b.toString()),T.data("currentQuantity",M))});a===ca.addOn&&n.toggleScrollOn();I&&(I.val(b),I.data("currentQuantity",M),
a=I.closest(".quantity-block"),a.find(".change-quantity-button").closest(".a-declarative").removeClass("hidden"),a.find(".quantity-display").removeClass("hidden"),a.find(".quantity-display-block-tablet").removeClass("hidden"),a.find(".dynamic-quantity-update").hasClass("stay-visible")||a.find(".dynamic-quantity-update").addClass("hidden").children().addClass("hidden"))}function t(a,b){var d=a.$currentTarget.is("a")?a.$currentTarget:a.$currentTarget.find("a");U=d.data("entityId");M=0;T=null;R=d.data("currentQuantity");
W=F("a.quantity-delete-button[data-entity-id\x3d'"+U+"']");W.length||(W=a.$currentTarget);I=d.closest(".dynamic-quantity-update").find(".quantity-input");I.length||(I=null);d.data("isBundleDelete")?F("#pb-delete-trigger-"+d.data("bundleGroupId")).trigger("click"):h.isItemAssociationDeleteConfirmationPopoverForWirelessPlansEnabled()&&d.data("showItemAssocDeletePopover")?(c.increaseCount("checkout:item-association:delete:selected",1),setTimeout(function(){F("#ia-delete-trigger-"+d.data("itemAssocGroupId")).trigger("click")},
100)):(u(!1,b),g.hideById(d.closest(".a-popover").data("aPopoverId")))}function G(a){if(!d.protectAgainstDoubleAction("order-summary-update-quantity",200)){c.resetMetrics();var b=a.$currentTarget,e=b.closest(".lineitem"),f=b.find("select"),h=f.length?f:b;U=e.data("entityId");f=F('.update-quantity-error[data-itemid\x3d"'+U+'"]');I=T=null;h.is("select")?(T=b.find("select"),M=h.val()):(I=e.find(".quantity-input"),M=I.val());R!==M&&(W=h.is("select")?T.parent():I,""===M?J(e):"Delete"===M||0===parseInt(M,
10)?(a.$event.preventDefault(),d.protectAgainstDoubleAction("delete-item")||(e=a.$currentTarget.closest(".lineitem"),U=e.data("entityId"),M=0,e.data("isBundleDelete")?F("#pb-delete-trigger-"+e.data("bundleGroupId")).trigger("click"):(u(!1,void 0),g.hideById(e.closest(".a-popover").data("aPopoverId"))))):(a=parseInt(F("#quantity-input-max-value").val(),10),d.validateNumber(M,0,a)?(f.hide(),e.blur(),e.data("isBundleDelete")?F("#pb-delete-trigger-"+e.data("bundleGroupId")).trigger("click"):u(!1)):v(U,
"changeQuantity_quantityNotInRange")))}}function J(a){a.find(".quantity-input").val(R)}function Q(b,d,e){var f=d.data("itemAssocGroupId"),g="a:sheet:beforeShow:ia-delete-mbs-"+f,h="a:sheet:afterHide:ia-delete-mbs-"+f;a.on(g,function D(b){b=b.sheet.getContentContainer();var c=F("#ia-delete-"+f).html();c&&(b.empty(),b.html(c));a.off(g,D)});q.when("a-dropdown").execute(function(d){a.on(h,function na(){c.increaseCount("checkout:item-association:delete:canceled",1);F("#ia-delete-trigger-"+f).data("isItemAssocAlreadyDeleted")||
(M=e,T.data("currentQuantity",e),d.getSelect(b).setValue(e));a.off(h,na)})});F("#ia-delete-trigger-"+f).trigger("click")}function P(){return k.isSPP()?F("#revieworder").hasClass("expanded")?!0:!1:0<F("div.spc").length?!0:!1}var F=a.$;if(!F("html").hasClass("a-ie6")){var M,R,U,T,I,V=!1,S=!1,W,ba=r.P&&r.P.AUI_BUILD_DATE,ca={addOn:"addOn",pantryMOV:"pantryMOV"};a.declarative("change-quantity",["click","touchend"],function(a){if(!d.protectAgainstDoubleAction("lock-update-quantity",200)){a=a.$currentTarget;
var b=!0;a.addClass("hidden");a=a.closest(".quantity-block");a.find(".change-quantity").addClass("hidden");a.find(".quantity-display").addClass("hidden");a.find(".quantity-display-block-tablet").addClass("hidden");a.find(".dynamic-quantity-update").removeClass("hidden").find(".hidden").each(function(){var a=F(this);a.removeClass("hidden");a.is("input")&&(a.focus(),a.select(),a.unbind("keydown.update-quantity-spc").bind("keydown.update-quantity-spc",function(a){13===a.which&&a.preventDefault()}),a.unbind("keyup.update-quantity-spc").bind("keyup.update-quantity-spc",
function(a){13!==a.which||b||F(a.target).closest(".dynamic-quantity-update").find(".update-quantity-button").trigger("click")}))});setTimeout(function(){b=!1},500)}});a.declarative("order-summary-get-quantity",["click","touchend"],function(a){d.protectAgainstDoubleAction("order-summary-get-quantity",200)||a.$currentTarget.find("select").length&&(R=a.$currentTarget.find("select").val())});a.declarative("order-summary-update-quantity",["change"],G);a.declarative("order-summary-update-quantity-text-field",
["click","touchend"],G);a.declarative("order-summary-handle-text-input",["keydown"],function(a){13===a.$event.which?(a.$event.preventDefault(),G(a)):d.limitInputToNumbers(a)});a.declarative("order-summary-show-update-button",["change","keyup"],function(a){var b=a.$currentTarget.closest(".quantity-text-field").find(".update-quantity-link"),c=a.$currentTarget.is("input")?a.$currentTarget.val():a.$currentTarget.find("input").val(),d=a.$currentTarget.find("input").data("currentQuantity");R=d;-1===parseInt(c,
10)||""===c?("change"===a.type&&J(a.$currentTarget.closest(".lineitem")),b.hide()):parseInt(c,10)!==d?b.show():b.hide()});a.declarative("trigger-update-quantity-button",["keydown"],function(a){13===a.$event.which&&(a.$event.preventDefault(),a.$currentTarget.closest(".quantity-block").find(".update-quantity-button").trigger("click"))});a.declarative("toggle-update-quantity-button",["change","keyup"],function(a){var b=a.$currentTarget.closest(".quantity-block").find(".update-quantity-button"),c=a.$currentTarget.find("input"),
d=c.val(),e=c.data("currentQuantity");""===d?("change"===a.type&&c.val(e),b.hide()):parseInt(d,10)!==e?b.show():b.hide()});a.declarative("update-quantity",["click","touchend"],function(a){c.resetMetrics();a=a.$currentTarget.is("a")?a.$currentTarget:a.$currentTarget.find("a");var b=a.closest(".quantity-block"),e=a.closest(".dynamic-quantity-update"),f=e.find(".quantity-input");e.length||(f=b.find(".quantity-input"));if(d.protectAgainstDoubleAction("lock-update-quantity",200))f.focus();else{var g=f.val();
U=a.data("entityId");var h=F('.update-quantity-error[data-itemid\x3d"'+U+'"]'),k=parseInt(F("#quantity-input-max-value").val(),10);d.validateNumber(g,0,k)?(h.hide(),e.find(".a-form-error").removeClass("a-form-error"),f.removeClass("a-form-error"),g=parseInt(g,10),I=f,R=I.data("currentQuantity"),R=parseInt(R,10),g===R?(b.find(".change-quantity-button").closest(".a-declarative").removeClass("hidden"),b.find(".quantity-display").removeClass("hidden"),b.find(".quantity-display-block-tablet").removeClass("hidden"),
e.addClass("hidden").children().addClass("hidden")):(M=g,W=a,a.blur(),a.data("isBundleDelete")?F("#pb-delete-trigger-"+a.data("bundleGroupId")).trigger("click"):u(!1))):v(U,"changeQuantity_quantityNotInRange")}});F(document).delegate(".spc-quantity-dropdown","change",function(a){T=F(a.currentTarget);c.resetMetrics();ba?(a=T.next(),U=a.data("entityId"),R=a.data("currentQuantity")):(c.increaseCount("removeauijs21"),U=T.data("entityId"),R=T.data("currentQuantity"));a=T.find(":selected");M=parseInt(a.val(),
10);if(R!==M){var b=F("#toggleDropdownQuantityTrigger");b.length&&M===parseInt(b.val(),10)?(a=T.closest(".quantity-block"),a.find(".spc-quantity-dropdown-button").hide(),a.find(".quantity-input").show()):(W=T.parent(),T.blur(),a&&a.data("isBundleDelete")?F("#pb-delete-trigger-"+a.data("bundleGroupId")).trigger("click"):h.isItemAssociationDeleteConfirmationPopoverForWirelessPlansEnabled()&&a&&a.data("showItemAssocDeletePopover")||u(!1))}});a.on("a:dropdown:select",function(a){if(h.isItemAssociationDeleteConfirmationPopoverForWirelessPlansEnabled()&&
(a=F(a.nativeItemNode))&&a.data("showItemAssocDeletePopover")){c.increaseCount("checkout:item-association:delete:selected",1);var b=a.closest("select"),d=ba?b.next().data("currentQuantity"):b.data("currentQuantity");Q(b,a,d)}});a.declarative("item-assoc-delete-confirm",["click","touchend"],function(a){if(!d.protectAgainstDoubleAction("item-assoc-delete-confirm")){c.increaseCount("checkout:item-association:delete:confirmed",1);u(!1);var b=F(a.$target).data("itemAssocGroupId");F("#ia-delete-trigger-"+
b).data("isItemAssocAlreadyDeleted",1);q.when("a-sheet").execute(function(a){var c=a.get("ia-delete-mbs-"+b);c&&a.hideSheet(c)})}});a.declarative("item-assoc-delete-cancel",["click","touchend"],function(){d.protectAgainstDoubleAction("item-assoc-delete-cancel")||(c.increaseCount("checkout:item-association:delete:canceled",1),M=R)});a.declarative("dont-delete-item",["click","touchend"],function(a){a.$event.preventDefault();d.protectAgainstDoubleAction("dont-delete-item")||g.hideById(a.$currentTarget.closest(".a-popover").data("aPopoverId"))});
a.declarative("delete-item",["click","touchend"],function(a){a.$event.preventDefault();d.protectAgainstDoubleAction("delete-item")||t(a)});a.declarative("delete-prime-membership-item-confirm",["click","touchend"],function(a){a.$event.preventDefault();if(!d.protectAgainstDoubleAction("delete-prime-membership-item-confirm")){var b={additionalData:{deletePrimeMembership:1,primeMembershipASIN:(a.$currentTarget.is("a")?a.$currentTarget:a.$currentTarget.find("a")).data("asin")}};t(a,b)}});a.declarative("bundle-delete",
["click","touchend"],function(){d.protectAgainstDoubleAction("bundle-delete")||u(!1)});a.declarative("bundle-delete-action",["click","touchend"],function(a){d.protectAgainstDoubleAction("bundle-delete-action")||(q.when("a-popover-base").execute(function(b){b.get(a.data.popoverName).hide()}),u(!1))});a.declarative("egc-delete",function(a){U=a.entityId;M=0;u(!0)});a.declarative("bundle-dont-delete",["click","touchend"],function(){d.protectAgainstDoubleAction("bundle-dont-delete")||(M=R,q.when("a-dropdown").execute(function(a){T&&
(a.getSelect(T).setValue(R.toString()),T.data("currentQuantity",M))}))});a.declarative("pantry-return-to-cart-btn",["click","touchend"],function(){d.protectAgainstDoubleAction("pantry-return-to-cart-btn")||P()&&B()});a.declarative("pantry-delete-items-btn",["click","touchend"],function(){!d.protectAgainstDoubleAction("pantry-delete-items-btn")&&P()&&(S=!0,F(".a-button-close").trigger("click"),u(!0))});a.declarative("pantry-cancel-delete-btn",["click","touchend"],function(){d.protectAgainstDoubleAction("pantry-cancel-delete-btn")||
P()&&A(ca.pantryMOV)});a.on("a:popover:hide:pantry-mov-popover",function(){P()&&(S||A(ca.pantryMOV))});a.declarative("addon-return-to-cart",["click","touchend"],function(){d.protectAgainstDoubleAction("addon-return-to-cart")||P()&&B()});a.declarative("addon-delete-items",["click","touchend"],function(){d.protectAgainstDoubleAction("addon-delete-items")||(P()&&(V=!0,F(".a-button-close").trigger("click"),u(!0)),k.isSPP()&&c.increaseCount("checkout:spp-revieworder:addon_delete_pri",1))});a.declarative("addon-dont-delete",
["click","touchend"],function(){d.protectAgainstDoubleAction("addon-dont-delete")||(P()&&A(ca.addOn),k.isSPP()&&c.increaseCount("checkout:spp-revieworder:addon_keep_pri",1))});a.on("a:popover:hide:addon-warning-normal",function(){0<F("div.spc-mobile").length?B():P()&&(V||A(ca.addOn))});a.on("a:popover:hide:addon-warning-special",function(){P()&&(V||A(ca.addOn))});a.on("checkout:reload:spc",y);a.on("checkout:reload:spp-revieworder",y)}});q.when("A","ready").execute(function(a){a.on("a:popover:beforeShow",
function(a){if(a.popover.$trigger.hasClass("quantity-dropdown-button")){var l=a.popover.$popover,e=l.closest("div.a-dropdown");e.length&&(a.popover.$iframe.css("max-height","260px"),l.css("max-height","260px"),l=e.find("div.a-popover-inner"),l.css({"max-height":"260px"}),a.popover.updatePosition(),l.css({"overflow-y":"scroll"}))}})});"use strict";q.when("A","page-transition-controller","page-conductor","ajax-utility").register("tax-exemption-controller",function(a,l,n,e){function k(a,d,f){return f.getResponseHeader("x-amz-checkout-page")?
n.ajaxUpdatePage(a,d,f,{pushNewFrame:"false"}):(a=e.jsonify(a))?n.redirect(a):n.redirect()}function m(a,d){var b=d.$target.data("entityId");if(b){l.show();var c={isClientTimeBased:g('input[name\x3d"useCtb"]').val(),fromAnywhere:g("input[name\x3dfromAnywhere]").val()};c=c||{};d={returnFullHTML:1,cachebuster:(new Date).getTime(),isClientTimeBased:0,hasWorkingJavascript:1};g.extend(d,c);d.entityId=b;d.optOut=a;a=n.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});g.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/tax-exemption-optout.html",
data:g.param(d),dataType:"text",async:!0,cache:!1,headers:a,success:k,error:n.ajaxRedirect})}else r.ueLogError&&r.ueLogError({name:"MissingData",message:"lineItemId is undefined, when trying to opt out from tax exemption",logLevel:"FATAL"})}var g=a.$;g("html").hasClass("a-ie6")||(a.declarative("tax-exemption-opt-out",["click","touchend"],function(a){m(!0,a)}),a.declarative("tax-exemption-opt-in",["click","touchend"],function(a){m(!1,a)}))});"use strict";q.when("A").execute(function(a){return{}});
"use strict";q.when("A","page-transition-controller","page-conductor").register("sns-subscription-controller",function(a,l,n){function e(a){var b=a.closest(".sns-upsell,.sns-upsell-mobile,.sns-upsell-tablet");if(a.length&&b.length){var d=b.data("index"),e=b.find("span.sns-change-delivery-txt");e&&e.text(a.find("option:selected").data("date"));e=a.find("option:selected").data("epoch");a=a.find("option:selected").val();b.find("input[type\x3d'hidden'][name\x3d'sns_nextDelivery"+d+"']").val(e);b.find("input[type\x3d'hidden'][name\x3d'sns_frequency"+
d+"']").val(a)}}function k(a,b){l.show();var d=a.data("index"),e=(new Date).getTime(),c=a.find("input[type\x3d'hidden'][name\x3d'sns_lineItemIdentifier"+d+"']").attr("value"),g=a.find("input[type\x3d'hidden'][name\x3d'sns_merchantId"+d+"']").attr("value"),k=a.find("input[type\x3d'hidden'][name\x3d'sns_asin"+d+"']").attr("value");a=a.find("input[type\x3d'hidden'][name\x3d'sns_frequency"+d+"']").attr("value");b=b.prop("checked")||b.find("[type\x3dcheckbox]").is(":checked");e={returnpipedata:0,returnFullHTML:1,
cachebuster:e,hasWorkingJavascript:1};e.lineItemIdentifier=c;e.isONMLSelected=b?1:0;e.merchantId=g;e.asin=k;e.frequency=a;c=n.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});m.ajax({type:"POST",url:"/gp/buy/spc/handlers/set-sns-options.html",data:m.param(e),dataType:"text",async:!0,cache:!1,headers:c,success:function(a,b,c){return n.ajaxUpdatePage(a,b,c)},error:function(a,b,c){n.ajaxRedirect(a,b,c)}})}var m=a.$;m("html").hasClass("a-ie6")||function(){var g=m(document);g.delegate(".sns-option",
"click",function(a){a=m(this);k(a.closest(".sns-upsell"),a)});g.delegate(".sns-option-mobile","click",function(a){var b=m(this);a.target.name&&"snsSetCreateSubscription"===a.target.name&&k(b.closest(".sns-upsell-mobile"),b)});g.delegate(".sns-option-tablet","click",function(a){a=m(this);k(a.closest(".sns-upsell-tablet"),a)});g.delegate(".sns-upsell-nextdelivery","change",function(){e(m(this))});a.declarative("sns-upsell-nextdelivery-dropdown","change",function(a){e(m(a.$target))});g.delegate(".sns-upsell-learn-more",
"click",function(a){var b=m(this);a=b.width();var e=b.height(),c=b.position();b=b.find(".sns-upsell-popover-learn-more");b.removeClass("aok-hidden");var g=b.width();b.height();b.css({top:c.top+e,left:c.left-(g-a)/2,position:"absolute"})});g.delegate(".sns-upsell-learn-more-close","click",function(a){(a=m(this))&&a.closest(".sns-upsell-popover-learn-more")&&a.closest(".sns-upsell-popover-learn-more").addClass("aok-hidden");return!1})}()});"use strict";q.when("A","page-detector","page-detector-current-page",
"page-conductor","page-transition-controller","ajax-utility","place-order-controller","client-side-metrics").execute(function(a,l,n,e,k,m,g,b){function d(a){"function"===typeof r.ues&&(r.ues("t0",a,new Date),r.ues("ctb",a,"1"));"function"===typeof r.uet&&r.uet("tc",a,{wb:1})}function f(a,b){"function"===typeof r.uet&&r.uet(a,b,{wb:1})}function c(a){r.ueLogError&&r.ueLogError({message:a},{logLevel:"WARN",attribution:"ajax-typ"})}function h(){var a=t("span#typ-load").attr("data-typ-args");r.location.href=
"https://"+r.location.hostname+"/gp/buy/thankyou/handlers/display.html?"+a}function q(){f("cf","ajax-typ:place-your-order");if(T){var a=t("#typ-desktop-frame").contents(),c=T;if(c.deliveryestimates)for(var d in c.deliveryestimates)if(c.deliveryestimates.hasOwnProperty(d)){var e=a.find("span#"+d);e&&e.replaceWith(c.deliveryestimates[d])}c.autorip&&(a=a.find("#thank-you-rogue"))&&a.replaceWith(c.autorip)}c=t("#typ-desktop-frame").contents();a=c.find("span#typ-rewrite-url");history&&history.pushState&&
a&&0<a.length&&(history.pushState({},"",a.attr("data-url")),a.attr("data-view"));c=c.find("title").text();t("#checkoutDisplayPage").hide();t("#typ-desktop").show();document.title=c;k.hide();t("span#typ-load").attr("data-typ-args");f("be","ajax-typ:place-your-order");b.setmarker&&(c=b.getscope(),V&&b.setscope("ajax-typ"),b.setmarker("cf"),V&&b.setscope(c));V||(b.sendUEPageLoadStats(),"function"===typeof r.uex&&r.uex("ld","ajax-typ:place-your-order",{wb:1}))}function v(a,b,d){a&&a.conductoraction&&
a.conductoraction.url?e.redirect(a):(f("af","ajax-typ:place-your-order"),T=a,P?q():J?F=1:(c("No TYP data available after place-order, redirecting to static TYP"),h()))}function w(){if(!ba)if(W&&clearTimeout(W),3===S.readyState){try{var a=m.jsonify(S.responseText)}catch(X){a=null}null!==a?(ba=1,v(a)):W=setTimeout(w,50)}else 4===S.readyState&&(ba=1,200===S.status?(a=m.jsonify(S.responseText),null!==a?v(a):(c("No results from place-order, calling ajaxRedirect"),e.ajaxRedirect())):(c("Error calling place-order, calling ajaxRedirect"),
e.ajaxRedirect()))}function x(){Q=1;R&&clearTimeout(R);U&&clearTimeout(U);var a=t("#currencyChanged");0<a.length&&"true"===a.val()&&(a='\x3cinput type\x3d"hidden" name\x3d"checkoutCurrencySelection.'+t("#tfx-switch-currency-options").find("input:radio:checked").val()+'" /\x3e',t("#spc-form-inputs").append(a));t("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'placeYourOrder1' value\x3d'1' /\x3e");a=(new Date).getTime()-ca;t("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'waitingTime' value\x3d'"+
a+"' /\x3e");t("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'returnjson' value\x3d'1' /\x3e");C&&t("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'isAsyncTYPEnabled' value\x3d'1' /\x3e");a=t("#spc-form").serialize();var b=t("#typ-desktop-frame").contents().find("input#cached-promise-data");0<b.length&&(a+="\x26cachedPromiseData\x3d"+b.val());if(I){if(r.XMLHttpRequest)S=new XMLHttpRequest;else if(r.ActiveXObject)try{S=new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(z){S=null}if(!S){c("Can't get XMLHttpRequest for data stream, calling standard placeOrderController");
Q=1;g.placeOrderClick();return}S.open("POST","/gp/buy/spc/handlers/place-your-decoupled-order.html",!0);S.setRequestHeader("Content-type","application/x-www-form-urlencoded");S.setRequestHeader("Content-length",a.length);S.setRequestHeader("Connection","close");S.onreadystatechange=w;S.overrideMimeType("text/plain");S.send(a)}else t.ajax({type:"POST",url:"/gp/buy/spc/handlers/place-your-decoupled-order.html",data:a,dataType:"text",async:!0,cache:!1,dataFilter:function(a){return m.jsonify(a)},success:function(a,
b,d){null!==a?v(a,b,d):(c("No results from place-order, calling ajaxRedirect"),e.ajaxRedirect())},error:function(a,b,d){c("Error calling place-order, calling ajaxRedirect");e.ajaxRedirect(a,b,d)}});"function"===typeof r.uet&&r.uet("bb","ajax-typ:place-your-order",{wb:1})}function p(){P=J=M=0;t("div#typ-desktop").empty()}function u(a,c,e){M||(M=1,clearTimeout(U),J=0,P=1,G++,(a=t("#typ-desktop-frame").contents().find("span#typ-rewrite-url"))&&0<a.length&&(a=a.attr("data-requestid"),d("ajax-typ:place-your-order"),
V||(b.setAsyncRequestId(a),"function"===typeof r.ues&&r.ues("id","ajax-typ:place-your-order",a))),F?q():!Q&&5>G&&(R=setTimeout(function(){p();B()},12E4)))}function B(){if(!(Q||J||5<=G)){J=1;var a=t("span#typ-load").attr("data-typ-args");U=setTimeout(function(){p();F&&(c("Timed out waiting for TYP fetch after place-order, redirecting to static TYP"),h())},45E3);t("\x3ciframe /\x3e",{name:"typ-desktop-frame",id:"typ-desktop-frame",width:"100%",height:"100%",frameborder:"0",src:"/gp/buy/thankyou/handlers/display.html?"+
a}).appendTo("div#typ-desktop").load(u)}}function A(){l.isSpc()&&0<t("span#typ-load").length&&(ca=(new Date).getTime(),G=0,t("div#typ-desktop").length?p():t("body").append('\x3cdiv id\x3d"typ-desktop" style\x3d"position:absolute;left:0;right:0;bottom:0;top:0;display:none;"\x3e\x3c/div\x3e'),I=t("span#typ-load").attr("data-early-json-flush")&&!t("html").hasClass("a-lt-ie10"),C=0<t("span#async-typ-enabled").length,V=t("span#typ-load").attr("data-use-cds-stub"),t(document).undelegate("span.place-order-button-link",
"click"),t(document).delegate("span.place-order-button-link","click",function(a){a.preventDefault();V?(a=b.getscope(),b.setscope("ajax-typ"),b.setctb(),b.resetue(),b.setmarker("tc"),b.setscope(a)):(b.resetMetrics(),b.setmarker("tc"));J||P?(k.show(),x()):(Q=1,g.placeOrderClick())}),B())}var t=a.$;if(!t("html").hasClass("a-ie6")){var G=0,J=0,Q=0,P=0,F=0,M=0,R,U,T,I=0,V=0,S,W,ba=0,ca=0,C=0;a.on("ajax-typ-cf",function(){u()});a.on("checkout:reload:spc",A);a.on("checkout:reload:spp-revieworder",A);a.on("checkout:reload:spclite",
A)}});"use strict";q.when("A","client-side-metrics").register("trialSignPrefetchCommon",function(a,l){function n(){e()&&(c().val(0),l.increaseCount("TrialSign:js:activated"),k(),q!==G&&f(),q=a.interval(d,5E4),w=0)}function e(){return 0!==c().length&&0!==h("input[name\x3d'purchaseID']").length}function k(){r!==G&&r.abort();r=a.ajax("/gp/buy/spc/handlers/trigger-trial-sign.html",{method:"post",params:{purchaseId:h("input[name\x3d'purchaseID']").val()},success:m,error:g,abort:b})}function m(a,b,d){c().val(a.signPurchaseTrialId);
r=G;l.increaseCount("TrialSign:js:success")}function g(a,b,c){f();r=G;l.increaseCount("TrialSign:js:failed")}function b(){f();r=G;l.increaseCount("TrialSign:js:aborted")}function d(){w++;10<w?f():(l.increaseCount("TrialSign:js:retry"),l.increaseCount("TrialSign:js:retry:"+w),k())}function f(){q!==G&&(clearInterval(q),q=G)}function c(){return h("input[name\x3d'trialSignId']")}var h=a.$,r,q,w=0;a.on("checkout:reload:spc",n);a.on("checkout:reload:spclite",n);a.on("checkout:billing-address-update",n);
return{makeTrialSignCall:k,trialSignCallSucceeded:m,isTrialSignActivated:e}});"use strict";q.when("A","page-transition-controller","client-side-metrics","page-conductor").register("recurring-delivery-line-item",function(a,l,n,e){function k(a,b,c){if("undefined"===typeof a)throw n.increaseCount("Checkout:B2B:RD:RecurrencePeriod:Update:JSFailure:VariableUndefined:"+b,1),c.show(),Error("Provided variable is undefined");c.hide()}function m(a,f,c){k(a,"updateRecurrencePeriod",f);k(a.lineItemId,"updateRecurrencePeriod-lineItemId",
f);var d=e.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"});g.ajax({type:"POST",url:"/gp/buy/spc/handlers/update-recurrence-period.html",data:{recurrencePeriod:b,encodedLineItemEntityId:a.lineItemId,relatedRequestId:a.relatedRequestId},dataType:"json",cache:!1,headers:d,success:function(a,b){n.increaseCount("Checkout:B2B:RD:RecurrencePeriod:Update:"+b,1);g("#b2brd-frdd").text(a.firstRecurringDeliveryDate);c.hide();f.hide();l.hide()},error:function(b){n.increaseCount("Checkout:B2B:RD:RecurrencePeriod:Update:"+
b,1);g("#b2brd-cadence-selector").find(".a-dropdown-prompt").text(a.selectedRecurrencePeriodDisplayString);c.hide();f.show();l.hide()}});l.show()}var g=a.$,b;a.declarative("b2brd-cadence-dropdown-change","change",function(a){var d=g("#update-recurrence-period-error"),c=g("#update-recurrence-period-link");k(a,"b2brd-cadence-dropdown-change",d);a=a.$event.target.value;k(a,"handleDropdownChange",d);c.show();b=a});a.declarative("update-recurrence-period","click",function(a){var b=g("#update-recurrence-period-error"),
c=g("#update-recurrence-period-link");k(a,"update-recurrence-period",b);m(a.data,b,c)});a.declarative("update-recurrence-period-mobile","change",function(a){var d=g("#update-recurrence-period-error"),c=g("#update-recurrence-period-link");k(a,"update-recurrence-period-mobile",d);var e=a.$event.target.value;k(e,"handleDropdownChange",d);c.show();b=e;m(a.data,d,c)})});"use strict";q.when("A","client-side-metrics","ajax-utility","button-blocker","button-blocker-popover","spclite-items-viewer","fast-track-controller").register("get-final-results-update",
function(a,l,n,e,k,m,g){function b(){for(var b=function(){a.trigger("checkout:spc:ordersummary:sizeChanged")},c=0;20>c;++c)setTimeout(b,100*c)}function d(a,c){setTimeout(function(){var d=m.prepare(a);d&&v("#spclite-items-operation").show();v("#spclite-items-header-dynamic").fadeIn(c?0:300,function(){d&&v("#spclite-items-operation").find(".spclite-items-view-switch").each(function(){var a=v(this).attr("view-name");a&&v(this).find("a").click(function(){l.increaseCount("SPCLite:ClientSide:SwitchViewClick:"+
a,1);m.switchToView(a);v("#spclite-items-operation").fadeOut(c?0:300);b()})})})},c?0:800)}function f(b,c,d){if(b&&v.isArray(b))for(var e=!1,f=0;f<b.length;f++){var g=b[f];if(g.identifier&&g.content){var h=v("#"+c+"-"+g.identifier);h&&0!==h.length?a.slideDown(h.html(g.content),d?0:500,"ease-out",function(){}):(l.increaseCount("SPCLite:LazyContentPlaceHolderMissing:Item:"+c,1),e||(l.increaseCount("SPCLite:LazyContentPlaceHolderMissing:Page:"+c,1),e=!0))}}}function c(c,e){if(c.presentCVs&&0<c.presentCVs.countOfCVs)h();
else{c.orderSummaryHTML&&(a.fadeOut(v("#order-summary-footer"),e?0:250,"ease-out"),a.fadeOut(v("#spc-order-summary"),e?0:250,"ease-out",function(){v("#spc-order-summary").replaceWith(c.orderSummaryHTML).hide();c.additionalOrderSummaryHTML&&v("#order-summary-footer").html(c.additionalOrderSummaryHTML);a.fadeIn(v("#spc-order-summary"),e?0:400,"ease-out");a.fadeIn(v("#order-summary-footer"),e?0:400,"ease-out")}));c.freshDeliveryMessageHTML&&(v("#lazy-fresh-promise-delivery-message").html(c.freshDeliveryMessageHTML),
a.slideDown(v("#lazy-fresh-promise-delivery-message"),e?0:500,"ease-out"),g.spcLiteLazyLoadFastTrack());f(c.itemToPrimeMembershipDelivery,"lazy-membership-delivery",e);f(c.itemToGiftContentMapping,"lazy-gift-options",e);f(c.itemToShipOfferingMapping,"lazy-ship-method",e);f(c.itemToPromise,"lazy-promise",e);c.freshDeliverySlotInformationHTML&&(v("#lazy-fresh-delivery-slot-information").html(c.freshDeliverySlotInformationHTML),a.slideDown(v("#lazy-fresh-delivery-slot-information"),e?0:250,"ease-out"));
c.freshDeliveryInstructionsHTML&&(v("#lazy-fresh-delivery-instructions").html(c.freshDeliveryInstructionsHTML),a.slideDown(v("#lazy-fresh-delivery-instructions"),e?0:250,"ease-out"));if(c.itemToPromoMapping&&v.isArray(c.itemToPromoMapping))for(var k=v("#items-block"),m=0;m<c.itemToPromoMapping.length;m++){var l=c.itemToPromoMapping[m];"lightningdeal"===l.type?k.find(".lazy-lightning-promo-details-"+l.identifier).removeClass("aok-hidden"):"promotion"===l.type&&k.find(".lazy-promo-details-"+l.identifier).removeClass("aok-hidden")}c.freeShippingId&&
v("#"+c.freeShippingId).removeClass("aok-hidden");v("input#isOrderSummaryReady").val(1);d(c.itemGroupData,e);b()}}function h(){var b=v("#spclite-block-order-place-message").html()||"";e.show("disabled-order-place",b);e.lock();k.create({name:"disabled-order-place",content:b});k.lock();var c=e.getButtonBlocker().data("a-popover-id");a.on("checkout:beforeReload",function(){k.unlock();e.unlock();k.destroy();v("#a-popover-"+c).remove()})}function q(a){if(a&&a.data){try{var b=r.atob(a.data)}catch(B){return l.increaseCount("SPCLite:FinalResult:Base64Decode:Failure",
1),null}if((b=n.jsonify(b))&&!v.isEmptyObject(b))return b}return null}var v=a.$,w,x=function(a,b){function c(){if(f&&0!==f.length){for(var a="",b=0;b<d%3+1;b++)a+=".";f.html(a);d++}}var d=0,e,f;this.start=function(){b&&b.useTextAnimate&&(d=0,f=a.find(".spclite-loading-text .spclite-processing-indicator"),e=setInterval(c,800))};this.stop=function(){e&&(clearInterval(e),f&&0<f.length&&f.html(""),d=0);a.find(".spclite-loading-spinner").hide();b&&b.showTextAlways||a.find(".spclite-loading-text").hide()}};
a.on("checkout:reload:spclite",function(){if("1"===v('script[type\x3d"spclite-encoding"]').attr("data-base64-encode-final-results")){var a=q(r.__spcliteFinalResultsData);if(a){c(a,!0);return}}else if(r.__spcliteFinalResultsData){c(r.__spcliteFinalResultsData,!0);return}a="";var b=v("input#executionId").val();b&&(a+="executionId\x3d"+b);return v.ajax({type:"GET",url:"/gp/buy/spclite/handlers/get-final-results.html/ref\x3dox_spclite_get_final_results",data:a,dataType:"text",async:!0,beforeSend:function(a){w=
new x(v("#spclite-order-summary-loading-indicator"),{showTextAlways:!0});w.start();r.uet&&r.uet("bb","SPCLite:ClientSide:Perf:FinalAjax",{wb:1})},success:function(a,b,d){a=n.jsonify(a);"1"===v('script[type\x3d"spclite-encoding"]').attr("data-base64-encode-final-results")?(a=q(a))?c(a,!1):h():a&&!v.isEmptyObject(a)?c(a,!1):h()},error:function(a,b,c){h()},complete:function(a){w.stop();r.uex&&r.uex("ld","SPCLite:ClientSide:Perf:FinalAjax",{wb:1})},cache:!1})});a.on("checkout:beforeLoadPage",function(){r.__spcliteFinalResultsData=
G})});"use strict";q.when("A","client-side-metrics").register("spclite-items-viewer",function(a,l){function n(){var a=k("#spclite-items-block").find(".spclite-item-detail");a&&0<a.length&&(g={},a.each(function(a){a=k(this).attr("entity-id");g[a]=k("\x3cp\x3e\x3c/p\x3e").append(k(this).clone().removeClass("a-span-last")).html()}))}function e(a,d){if(!d||0===d.length)return null;a=k('\x3cdiv class\x3d"a-row spclite-item-view" view-type\x3d"order-by-delivery"\x3e\x3c/div\x3e');var b=d;d=[];for(var c=
[],e=0;e<b.length;e++){var m=b[e];if("normal"!==m.type)c.push(m);else{for(var l=0;l<d.length;)if(m.data.destinationAddressId!==d[l].data.destinationAddressId)l++;else break;for(;l<d.length;)if(m.data.destinationAddressId===d[l].data.destinationAddressId&&m.data.promise.starttime.dayepoch>d[l].data.promise.starttime.dayepoch)l++;else break;d.splice(l,0,m)}}for(b=0;b<c.length;b++)switch(m=c[b],m.type){case "primemembership":d.unshift(m);break;case "vas":case "digital":case "no-promise":case "exception":d.push(m);
break;default:d.push(m)}for(c=0;c<d.length;c++){m=d[c];if(b=m.content)e='\x3cdiv class\x3d"row spclite-item-group-title"\x3e',b.destination&&(e+='\x3cdiv class\x3d"row destination"\x3e'+b.destination+"\x3c/div\x3e"),b.promise&&(e+='\x3cdiv class\x3d"row promise"\x3e'+b.promise+"\x3c/div\x3e"),e+="\x3c/div\x3e",a.append(e);a:if(b=m.items,g&&b&&0!==b.length){e="";for(l=0;l<b.length;l++){0===l%2&&(e+='\x3cdiv class\x3d"a-row"\x3e');var n=b[l].identifier;if(!g[n]){b=null;break a}n=k(g[n]);1===l%2&&n.addClass("a-span-last");
e+=k("\x3cp\x3e\x3c/p\x3e").append(n).html();1===l%2&&(e+="\x3c/div\x3e")}1===b.length%2&&(e+='\x3cdiv class\x3d"a-column a-span6 a-span-last"\x3e\x3c/div\x3e\x3c/div\x3e');b=e}else b=null;if(b)b=k(b),("no-promise"===m.type||"normal"===m.type&&m.data&&m.data.promise&&"scheduled"!==m.data.promise.type)&&b.find(".spclite-promise").hide(),a.append(b);else return null;c<d.length-1&&a.append("\x3chr\x3e")}return a}var k=a.$,m,g;return{prepare:function(a){try{a:{n();if(g){var b=e("order-by-delivery",a);
if(b){m={"order-by-delivery":b};var f=!0;break a}}f=!1}return f}catch(c){l.increaseCount("SPCLite:ClientSide:Exception:SwitchViewPrepare",1)}return!1},switchToView:function(a,d){if(m&&m[a])var b=m[a];else l.increaseCount("SPCLite:ClientSide:SwitchViewNoPrepared:"+a,1),"order-by-delivery"===a&&(b=e(a,d));if(b){var c=k("#spclite-items-block");c.find(".spclite-item-view").fadeOut(300,function(){c.empty();c.append(b.clone().hide());c.find(".spclite-item-view").fadeIn(500)})}}}});"use strict";q.when("A",
"loading-spinner-controller").register("cpf-controller",function(a,l){function n(a){if(/^\d{11}$/.test(a)||/^\d{3}\.\d{3}\.\d{3}-\d{2}$/.test(a)){a=a.replace(/[^\w\s]|_/g,"");if(/(\d)\1{10}/.test(a))return!1;var e=a.substring(0,9);var g=a.substring(9);var b=0;for(var d=10;1<d;d--)b+=e.charAt(10-d)*d;if((2>b%11?0:11-b%11)!==g.charAt(0))return!1;e=a.substring(0,10);b=0;for(a=11;1<a;a--)b+=e.charAt(11-a)*a;return(2>b%11?0:11-b%11)!==g.charAt(1)?!1:!0}return!1}var e=a.$;a.on("checkout:reload:spp-taxid",
function(){e("#useThresholdTaxIdService").length||e("#taxidForm").submit(function(){var a=e("#taxidregistration-imb");if(!n(e("#taxid-field").val()))return l.hideSpinner(e("#spinner-anchor"),!0),a.show(),!1;a.hide();return!0})})});"use strict";q.when("A","page-conductor","ready").register("taxid-threshold-controller",function(a,l){function n(){var a=e();l.isSPP()?a?(k("#taxid-continue-disabled").hide(),k("#taxid-continue-enabled").show()):(k("#taxid-continue-enabled").hide(),k("#taxid-continue-disabled").show()):
a?k("span.#continue").removeClass("a-button-disabled").find('input[type\x3d"submit"]').removeAttr("disabled"):k("span.#continue").addClass("a-button-disabled").find('input[type\x3d"submit"]').attr("disabled","disabled")}function e(){var a=!0,e=k("#taxIdForm");e.length&&e.find('input[type\x3d"text"]').each(function(){var b=k(this);if(!b.val()||7>b.val().length)b.parents(".taxid-form").find('input[type\x3d"checkbox"]').attr("checked")||(a=!1)});return a}var k=a.$;a.on("checkout:reload:spp-taxid",function(){if(k("#useThresholdTaxIdService").length){var a=
k("#taxIdForm");a.length&&(a.find('input[type\x3d"text"]').keyup(n),a.find('input[type\x3d"checkbox"]').change(n));n()}})});"use strict";q.when("A","page-conductor","loading-spinner-controller","taxaddress-page-config","ready").register("taxaddress-controller",function(a,l,n,e){function k(){l.isSPP()&&(g(),b())}function m(){if(l.isSPP()){var a=c(q.taxregistrationnumberInputIdSelector).val();c(q.taxregistrationnumberInputIdSelector).val(a.replace(r,""));a=c(q.businesslegalnameInputIdSelector).val();
c(q.businesslegalnameInputIdSelector).val(a.trim());g();b()}}function g(){if(q.isChewbaccaURL){var a=f(c(q.taxregistrationnumberInputIdSelector).val()),b=f(c(q.businesslegalnameInputIdSelector).val());a&&b?c(q.taxaddressFormIdSelector).attr("action",q.formActionNonSifEncryptionUrl):c(q.taxaddressFormIdSelector).attr("action",q.formActionSifEncryptionUrl)}}function b(){var a=c("#taxid-continue-enabled"),b=c("#taxid-continue-disabled");var d=c(q.taxregistrationnumberInputIdSelector).val();var e=c(q.businesslegalnameInputIdSelector).val();
if(f(d)&&f(e))d=!0;else{e=!e||f(e.toString().trim());var g=f(c(q.taxaddressInputNameSelector).val());d=f(d)||!h.test(d)||e||g?!1:!0}d?(a.show(),b.hide()):(a.hide(),b.show());d=f(c(q.taxregistrationnumberInputIdSelector).val())&&f(c(q.businesslegalnameInputIdSelector).val())?q.continueLabel:q.saveContinueLabel;a.find("span.a-button-text").text(d);b.find("span.a-button-text").text(d)}function d(){if(w)w=!1;else{var a=c(q.taxregistrationnumberInputIdSelector).val().trim(),b=c(q.businesslegalnameInputIdSelector).val().trim();
if(!f(a)||!f(b)){var d={tax_registration_number:a,business_legal_name:b};c.ajax({type:"POST",url:q.sifEncryptionUrl,dataType:"json",data:d,success:function(a,b,e){f(d.tax_registration_number)?c(q.taxregistrationnumberInputIdSelector).val(""):c(q.taxregistrationnumberInputIdSelector).val(a.sifEncryptedTaxId);f(d.business_legal_name)?c(q.businesslegalnameInputIdSelector).val(""):c(q.businesslegalnameInputIdSelector).val(a.sifEncryptedLegalName);w=!0;c(q.taxaddressFormIdSelector).submit()},error:function(a,
b,c){console.log("[taxaddress-controller.js] Error while encrypting the input fields. Error Type: "+b+" tax_registration_number: "+d.tax_registration_number+" business_legal_name: "+d.business_legal_name)}});return!1}}}function f(a){return!a||0===a.toString().length}var c=a.$,h=/^\d{11}$/,r=/\s+/g,q=e.getConfig(),w=!1;a.on("checkout:reload:spp-taxaddress",function(){c(q.taxregistrationnumberInputIdSelector).keyup(m).blur(m);c(q.businesslegalnameInputIdSelector).keyup(k).blur(m);c('input:radio[name\x3d"'+
q.taxaddressInputName+'"]').each(function(){c(this).change(k)});q.isChewbaccaURL=-1!=q.formActionSifEncryptionUrl.indexOf("/checkout/p/p-");q.isChewbaccaURL||c(q.taxaddressFormIdSelector).submit(d);k()});return{getNewTaxAddressPopoverURL:function(){return q.newTaxAddressPopoverURL},submitTaxAddressFormWithNewAddressId:function(a){c(q.newTaxaddressInputIdSelector).val(a);n.showSpinner(c(q.taxAddressPanelSelector),!1);c(q.taxaddressFormIdSelector).submit()}}});q.when("A","address-popovers","taxaddress-controller",
"ready").register("taxaddress-addresspopover-helper",function(a,l,n){l.actionRegisterTaxAddressController(n)});"use strict";q.when("A","page-spinner-controller","ajax-utility","page-conductor","client-side-metrics").execute(function(a,l,n,e,k){function m(){function d(a){if(!h)if(a.preventDefault(),a=encodeURIComponent(g("#spc-deliverytipinput").val()),g("#tip-error").addClass("aok-hidden"),g("#tip-promo-success").addClass("aok-hidden"),g("#tip-success").addClass("aok-hidden"),g("#tip-ineligible").addClass("aok-hidden"),
g("#tip-success").addClass("aok-hidden"),a&&0!==a.length)if(0>a)c("invalidDeliveryTip_NoAmount");else if(/^[0-9]*(\.[0-9]{1,2})?$/.test(a)){l.show();k=g("#spc-deliverytipnoticecheckbox").attr("checked")?1:0;var b=(new Date).getTime();a="tipamount\x3d"+a+"\x26isDefaultTip\x3d"+k+"\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26hasWorkingJavascript\x3d1\x26fromAnywhere\x3d"+g("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+b;b=e.setAjaxTransitionHeader({"Cache-Control":"no-cache",pragma:"no-cache",
"x-amz-checkout-page":"spc"});g.ajax({type:"POST",url:"/gp/buy/spc/handlers/add-delivery-tip.html/ref\x3dox_tip_page_delivery_tip_add",data:a,headers:b,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",complete:function(){h=!1;l.hide()},success:f,error:e.ajaxRedirect});h=!1}else c("invalidDeliveryTip_NoAmount");else c("addDeliveryTip_NoAmount")}function f(a,b,c){l.hide()}function c(a){l.hide();g("#tip-error").removeClass("aok-hidden");0<g("div.spc-desktop").length?
g("#spc-deliverytipinput").addClass("a-form-error"):g("#spc-deliverytipinput").closest(".a-input-text-wrapper").addClass("a-form-error");g("#"+a).removeClass("aok-hidden")}var h=!1,k=0;b&&(a.declarative("tip-element",["click"],function(a){var b=a.data.click;b&&null!==b&&d(a.$event)}),b=!1)}var g=a.$;if(!g("html").hasClass("a-ie6")){var b=!0;a.on("checkout:reload:spc",m);a.on("checkout:reload:spclite",m)}});"use strict";q.when("A","checkout-general-utils","page-conductor","loading-spinner-controller").register("checkout-feedback-controller",
function(a,l,n,e){function k(){if(!g||"function"!==typeof g)return"";var a=g(),d="";if(a)for(var e in a)if("number"===typeof a[e]||"string"===typeof a[e]||"boolean"===typeof a[e])d+="\x26__pagedata_"+e+"\x3d"+a[e];return d}var m=a.$,g;a.declarative("checkout-submit-feedback",["click","touchend"],function(a){if(!l.protectAgainstDoubleAction("checkout-submit-feedback",200)&&(a=m("#checkout-feedback-form"),a.length)){e.showSpinner(a,!1);var b=a.serialize();b+=k();m.ajax({type:"POST",url:a.attr("action"),
data:b,dataType:"text",error:n.ajaxRedirect,success:function(a,b,d){b=d.getResponseHeader("checkout-feedback-submitted");m(".a-button-close").trigger("click");null!==b&&b!==G&&m("#checkout-feedback-banner").append(a)}})}});return{registerPageDataCollecter:function(a){a&&"function"===typeof a&&(g=a)}}});"use strict";q.when("A","page-spinner-controller","scroll-controller","ajax-utility","page-conductor","checkout-modal-popover","page-detector-current-page","checkout-general-utils","a-popover","client-side-metrics").execute(function(a,
l,n,e,k,m,g,b,d,f){function c(){function b(a){a=a.$currentTarget.closest(".delivery-instructions-block");a.find(".edit-delivery-instructions-link").addClass("aok-hidden");a.find(".delivery-instructions-display").addClass("aok-hidden");var b=a.find(".dynamic-delivery-instructions-update").find(".delivery-instructions-input").attr("maxlength");a.find(".dynamic-delivery-instructions-update").removeClass("aok-hidden");h("#deliveryInstructions").focus();h("#deliveryInstructions").select();h("#deliveryInstructions").keydown(function(a){10===
a.which&&a.preventDefault()});h("#deliveryInstructions").keyup(function(){h("#delivery-instructions-left-text").hasClass("aok-hidden")&&h("#delivery-instructions-left-text").removeClass("aok-hidden");var a=b-h(this).val().length;0>a&&(a=0);h("#delivery-instructions-left").text(a)});setTimeout(function(){},500)}function c(a){l.show();a=a.$currentTarget;var b=h("#deliveryInstructions").val(),c=a.closest(".delivery-instructions-block"),e=a.closest(".dynamic-delivery-instructions-update");c.find(".edit-delivery-instructions-link").removeClass("aok-hidden");
c.find(".delivery-instructions-display").removeClass("aok-hidden");e.addClass("aok-hidden");c=(new Date).getTime();b="deliveryInstructions\x3d"+encodeURIComponent(b)+"\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26hasWorkingJavascript\x3d1\x26fromAnywhere\x3d"+h("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+c;c=k.setAjaxTransitionHeader({"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":g.getCurrentPage()});h.ajax({type:"POST",url:"/gp/buy/spc/handlers/add-delivery-instructions.html/ref\x3dox_instructions_page_delivery_instructions_update",
data:b,headers:c,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",complete:function(){l.hide()},success:d,error:k.ajaxRedirect});a.blur()}function d(a,b,c){(a=e.jsonify(a))&&!h.isEmptyObject(a)&&h("#deliveryInstructionsDisplay").html(a.deliveryInstructions);l.hide()}q&&(a.declarative("edit-delivery-instructions",["click"],b),a.declarative("update-delivery-instructions",["click"],c),q=!1)}var h=a.$;if(!h("html").hasClass("a-ie6")){var q=!0;a.on("checkout:reload:spc",
c);a.on("checkout:reload:spclite",c);a.on("checkout:reload:spp-shipaddress",c);a.on("checkout:reload:spp-f3-sosp",c);a.on("checkout:reload:spp-payment",c)}});"use strict";q.when("A","page-conductor","page-transition-controller").register("installments-service",function(a,l,n){var e=a.$;return{call:function(a,m,g){n.show();e.ajax({type:"POST",url:"/gp/buy/installments/handlers/set-item-installments.html/ref\x3dox_spc_inst_toggle",data:{itemId:a,programId:m},dataType:"text",async:!0,cache:!1,headers:l.setAjaxTransitionHeader(),
success:g.success||null,error:g.error||null})},sendReftag:function(a){e.post("/gp/buy/spc/handlers/pmts-continue-widget.html/ref\x3d"+a)}}});"use strict";q.when("A","page-transition-controller","page-conductor","page-detector","button-blocker","installments-service","client-side-metrics","widgets/installmentsModal/state","allow-installments-page-transition","weblab-helper").register("installments-controller",function(a,l,n,e,k,m,g,b,d,f){function c(){a.defer(q)}function h(a,b,c){d.isEnabled?n.ajaxUpdatePage(a,
b,c,{pushNewFrame:"true"}):(l.hide(),n.ajaxUpdatePage(a,b,c,{pushNewFrame:"false"}))}function q(){var a=r("#installments-button-blocker");1===a.length&&(a=a.data("blocker-message"),k.show("place-order-installments-blocker",a))}var r=a.$;a.declarative("installments-sync-state",["change"],function(a){var c=r("#trigger-installments-modal");if(c.length){b.$target=a.$target;b.bundleAsin=a.data.bundleAsin;b.asin=a.data.asin;b.itemId=a.data.itemId;b.isChecked=b.$target.is(":checked");b.programId=b.isChecked?
a.data.programId:"";a={success:h,error:n.ajaxRedirect};b.handlerData=a;var d=b.isChecked?"Checkout:Installments:UpdateOptIn":"Checkout:Installments:UpdateOptOut";if(b.isChecked)c=b.asin,a=b.bundleAsin,m.call(b.itemId,b.programId,b.handlerData),a?m.sendReftag("installments_toggle_on_asin_"+c+"_bundle_asin_"+a):m.sendReftag("installments_toggle_on_asin_"+c);else{a=b.itemId;var e=b.programId,f=b.handlerData,k=b.asin,l=b.bundleAsin;l&&c.length?(m.sendReftag("installments_toggle_off_asin_"+k+"_bundle_asin_"+
l),c.click()):(m.sendReftag("installments_toggle_off_asin_"+k),m.call(a,e,f))}}else c=a.data.itemId,e=(d=a.$target.is(":checked"))?a.data.programId:"",a={success:h,error:n.ajaxRedirect},d=d?"Checkout:Installments:UpdateOptIn":"Checkout:Installments:UpdateOptOut",m.call(c,e,a);g.increaseCount(d)});a.declarative("page-transit-invalidate-ric","click",function(a){if(!n.isAnimating()){a.$event.preventDefault();var b=a.$currentTarget.closest("div.spp-panel");l.shrinkPanel(b,!0);b={invalidate:!0,gurupaRicCSRFToken:r("#gurupaRicCSRFToken").val()};
g.increaseCount("Checkout:RetailInstallmentContract:Invalidate");f.isInstallmentsInvalidateRicSetterEnabled()?n.ajaxUpdate("/checkout/p/p-"+a.data.purchaseId+"/ihi/deleteretailinstallmentcontract?pipelineType\x3dChewbacca\x26referrer\x3dspc",b):r.ajax({type:"POST",url:"/gp/buy/retailinstallmentcontract/handlers/set-line-item-ric.html?_from\x3dgurupa",data:b,async:!0,cache:!1,headers:n.setAjaxTransitionHeader(),success:n.redirect,error:n.redirect})}});a.on("checkout:reload:spp-revieworder",c);a.on("checkout:reload:spc",
c)});"use strict";q.when("A","page-conductor","checkout-modal-popover","page-transition-controller","ajax-utility","page-detector","payments-portal-common","ready").register("spc-payments-portal",function(a,l,n,e,k,m,g){function b(b,d){d={refTag:d,callbackBeforePageUpdate:function(){a.$("div.a-popover button.a-button-close").trigger("click")}};l.isSPP()&&(d.keepCachedPagesData=1);l.loadPage("spc",b,null,d)}function d(a,b,d){l.isSPP()?(e.blockAllActions(),e.showTransitionInContainer(f("#payment"))):
e.show();a="/gp/buy/spc/handlers/pmts-continue-widget.html/ref\x3d"+a;var c=l.setAjaxTransitionHeader({"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":"spc"});f.ajax({type:"POST",url:a,data:b,headers:c,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",success:function(a,b,c){c.getResponseHeader("x-amz-checkout-page")?l.ajaxUpdatePage(a,b,c):d(a)},error:l.ajaxRedirect})}var f=a.$;return{prepareDelegatedPopovers:function(b){function c(a,b){a=f(a);
a.data("aCheckoutModalPopover",b);n.createModal({$declarativeParent:a},b)}a.on("pmts:retail:billing-address-popover",function(a){c(".pmts-change-address-link",{header:b.billingAddressPopoverHeader,footer:"",name:"billing-address",allowScrollOnPage:!0})});a.on("pmts:retail:rewards-registration",function(a){c(".pmts-shop-with-points-learn-more-link",{header:b.rewardsRegistrationPopoverHeader,footer:"",name:"rewards-registration",allowScrollOnPage:!0})})},handleClaimCodeSubmittedEvent:function(a,b){var c=
{returnjson:"1",returnFullHTML:"1",hasWorkingJavascript:"1",fromAnywhere:f("input[name\x3dfromAnywhere]").val(),cachebuster:(new Date).getTime(),nextAction:"pipeline-dispatch",embedOnlyData:"1"};a=f.param(a)+"\x26"+f.param(c);d("ox_pay_page_gc_add",a,function(a){g.claimCodePageUpdater(b,a)})},handleChangeBillingAddressRequestedEvent:function(){m.isDesktopSpc()?l.isSPP()?f("#pmts-change-billing-address-popover").trigger("click"):a.trigger("pmts:retail:billing-address-popover"):(e.show(),l.isPipeliningOn()&&
b("billingaddressselect","ox_spc_change_ship_addr"))},handleChangePaymentInstrumentRequestedEvent:function(){e.show();l.isPipeliningOn()&&b("payselect","ox_spc_change_payment")},handleRewardsAccountLearnMoreRequestedEvent:function(){a.trigger("pmts:retail:rewards-registration")},handlePointsAccountSubmittedEvent:function(a){var b={hasWorkingJavascript:"1",isClientTimeBased:f("input[name\x3duseCtb]").val(),nextAction:"dispatch"};a=f.param(a)+"\x26"+f.param(b);d("ox_spc_points_edit",a,function(a){a=
k.jsonify(a);l.redirect(a)})}}});"use strict";q.when("ajax-utility","gc-redeem-controller","page-transition-controller","ready").register("payments-portal-common",function(a,l,n){return{claimCodePageUpdater:function(e,k){k=a.jsonify(k);null!==k?k.widgetJsonData?(e.update(k.widgetJsonData),n.hide()):k.autohandlererror&&l.giftSystemErrorHandling(k.autohandlererror):n.hide()}}});"use strict";q.when("A","page-detector-current-page","a-button","a-meter").register("checkout-throttle-error",function(a,l,
n,e){var k=a.$;a.on("checkout:reload:throttle",function(){if(k("#checkout-throttle-meter").length){var a=1E3*k('input[name\x3d"waiting-time"]').val()/100;n("#checkout-throttle-return-to-cart").disable();var g=e("#checkout-throttle-meter"),b=0,d=setInterval(function(){g.percent(b);if(100>b)b+=1;else{clearInterval(d);var a=n("#checkout-throttle-return-to-cart");a.text(k("#checkout-throttle-primary-button-active-text").text());a.enable()}},a)}})});"use strict";q.when("A","weblab-helper").register("nav-bar-helper",
function(a,l){function n(){try{q.register("navCF")}catch(e){if(-1===e.message.toLowerCase().indexOf("already registered"))throw e;}}if(l.isNavCFWeblabOn())a.on("checkout:reload",n)});"use strict";q.register("pipeline-dispatch-endpoint",function(){return{get:function(a){return a}}});q.when("A").execute(function(a){a.declarative("remaining-customizations-action","click",function(a){a.$currentTarget.parent().find(".remaining_customization_info").removeClass("aok-hidden");a.$currentTarget.hide();a.$event.preventDefault()})});
"use strict";q.when("A","checkout-federation-utilities","client-side-metrics").register("checkout-federation-wrapper",function(a,l,n){function e(a){for(var e=[],b=k;b<a.length;b++)e.push(a[b]);return e}var k=2;return{wrap:function(a,g){try{return a.apply(null,e(arguments))}catch(c){var b=g,d=c;var f=l.getExternalDependecies()[b];f=f!==G&&null!==f?f.cti:"Undefined";n.logError(d,"["+b+"] Javascript error thrown while executing wrapper",f,"FATAL");r.console&&r.console.error&&r.console.error(d,b,f)}}}});
"use strict";q.when("A","jQuery","checkout-federation-utilities").register("checkout-federation-injector",function(a,l,n){function e(a){a=a.assetsModule;if(k[a]?0:0<l('script[type\x3d"checkout-asset-trigger"][data-checkout-asset-trigger\x3d"'+a+'"]').length)k[a]=!0,q.register("trigger"+a,function(){})}var k={};a.on("checkout:reload",function(){var a=n.getExternalDependecies(),g;for(g in a)a.hasOwnProperty(g)&&e(a[g])})});"use strict";q.when("A","client-side-metrics").register("checkout-federation-utilities",
function(a,l){return{getExternalDependecies:function(){var n=a.state("triggerExternalDependencies");Object&&Object.keys&&l.increaseCount("Checkout:ExternalDependencies:count:"+(n?Object.keys(n).length:"undefined"));return n===G||null===n?{}:n}}});"use strict";q.register("allow-installments-page-transition",function(){return{isEnabled:!0}})});
/* ******** */
