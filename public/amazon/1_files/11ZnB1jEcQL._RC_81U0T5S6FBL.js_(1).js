(function(c){var g=window.AmazonUIPageJS||window.P,h=g._namespace||g.attributeErrors,a=h?h("WidgetStreamer",""):g;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,g,h){c.when("jQuery","widget-streamer-action-ws-append","widget-streamer-action-ws-prepend","widget-streamer-action-ws-update","widget-streamer-action-ws-event").register("widget-streamer-actions",function(a,d,e,b,f){var c={"ws-append":d,"ws-prepend":e,"ws-update":b,"ws-event":f},k={execute:a.noop};
return{create:function(f){var b,e,d;b=k;if(a.isArray(f)&&f.length&&f[0]){b=f[0];e=c[b];d="widget-streamer-action-"+b;if("function"!==typeof e)throw Error("Action: "+b+" is not supported. Register component "+d+" to handle this action");b=e(f)}return b}}});"use strict";c.register("widget-streamer-jquery-action",function(){return function(a,d,e){var b,f;if(!a||3>a.length)throw Error("Can not create update action, insufficient data in chunk: "+JSON.stringify(a));b=a[1];f=a[2];return{execute:function(a){var c=
a._$target.find(b).add(a._$target.filter(b));a._isTargetUpdated?e(c,f):d(c.get(0),f)}}}});"use strict";c.when("widget-streamer-jquery-action").register("widget-streamer-action-ws-update",function(a){return function(d){return a(d,function(a,b){a.innerHTML=b},function(a,b){a.html(b)})}});"use strict";c.when("widget-streamer-jquery-action").register("widget-streamer-action-ws-append",function(a){return function(d){return a(d,function(a,b){a.innerHTML+=b},function(a,b){a.append(b)})}});"use strict";c.when("widget-streamer-jquery-action").register("widget-streamer-action-ws-prepend",
function(a){return function(d){return a(d,function(a,b){a.innerHTML=b+a.innerHTML},function(a,b){a.prepend(b)})}});c.register("widget-streamer-action-ws-event",function(){return function(a){var d=a[1],c;try{c=JSON.parse(a[2])}catch(b){c=null}return{execute:function(a){a._emitEvent(d,c)}}}});"use strict";c.register("widget-streamer-utils",function(){return{isStreamingAjax:function(a){if(a&&"function"===typeof a.getResponseHeader)a=a.getResponseHeader("Content-Type");else if(a&&a.http&&"function"===
typeof a.http.getResponseHeader)a=a.http.getResponseHeader("Content-Type");else throw Error("Unable to retrive headers for the given xhr object: "+a);return"application/json-amazonui-streaming"===a}}});"use strict";c.when("A","jQuery","widget-streamer-actions").register("widget-streamer",function(a,c,e){function b(a){a=a||{};this._$originalTarget=a.$target;this._$target=a.$target.clone();this._actions=[];this._isExecutable="undefined"===typeof a.immediateExecution||a.immediateExecution;this._onUpdate=
a.onUpdate||c.noop;this._hasExecutionStarted=!1;this._events=a.events||{};this._isTargetUpdated=!1;this._updateTriggerEvent=a.updateTriggerEvent;this.chunkHandler=c.proxy(this.chunkHandler,this)}b.prototype.chunkHandler=function(a){a=e.create(a);this._actions.push(a);this.executeActions()};b.prototype.enableExecution=function(){this._isExecutable=!0;this.executeActions()};b.prototype.executeActions=function(){var a;if(this._isExecutable&&this._actions.length)for(this._hasExecutionStarted||(this._hasExecutionStarted=
!0,this._updateTriggerEvent||this._updateTarget()),a=this._actions.shift();a;)a.execute(this),a=this._actions.shift()};b.prototype._emitEvent=function(a,b){var e=(this._events||{})[a]||c.noop;a===this._updateTriggerEvent&&this._updateTarget(b);e.call(this,b)};b.prototype._updateTarget=function(){this._onUpdate.apply(this,arguments);this._$originalTarget.html(this._$target.html());this._$target=this._$originalTarget;this._isTargetUpdated=!0};return function(a){return new b(a)}})});
/* ******** */
(function(q){var r=window.AmazonUIPageJS||window.P,H=r._namespace||r.attributeErrors,ta=H?H("CheckoutCommonAsset",""):r;ta.guardFatal?ta.guardFatal(q)(ta,window):ta.execute(function(){q(ta,window)})})(function(q,r,H){q.register("polyfill-indexof",function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(a,m){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),e=n.length>>>0;if(0===e)return-1;m=+m||0;Infinity===Math.abs(m)&&(m=0);if(m>=e)return-1;for(m=
Math.max(0<=m?m:e-Math.abs(m),0);m<e;){if(m in n&&n[m]===a)return m;m++}return-1})});"use strict";q.register("polyfill-filter",function(){Array.prototype.filter||(Array.prototype.filter=function(a){if(void 0===this||null===this)throw new TypeError;var m=Object(this),n=m.length>>>0;if("function"!==typeof a)throw new TypeError;for(var e=[],g=2<=arguments.length?arguments[1]:void 0,l=0;l<n;l++)if(l in m){var h=m[l];a.call(g,h,l,m)&&e.push(h)}return e})});"use strict";q.register("polyfill-json-stringify",
function(){"object"!==typeof JSON&&(JSON={});(function(){function a(a){return 10>a?"0"+a:a}function m(){return this.valueOf()}function n(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=D[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function e(a,b){var d,f,k=c,h,g=b[a];g&&"object"===typeof g&&"function"===typeof g.toJSON&&(g=g.toJSON(a));"function"===typeof u&&(g=u.call(b,a,g));switch(typeof g){case "string":return n(g);case "number":return isFinite(g)?
String(g):"null";case "boolean":case "null":return String(g);case "object":if(!g)return"null";c+=p;h=[];if("[object Array]"===Object.prototype.toString.apply(g)){f=g.length;for(a=0;a<f;a+=1)h[a]=e(a,g)||"null";b=0===h.length?"[]":c?"[\n"+c+h.join(",\n"+c)+"\n"+k+"]":"["+h.join(",")+"]";c=k;return b}if(u&&"object"===typeof u)for(f=u.length,a=0;a<f;a+=1)"string"===typeof u[a]&&(d=u[a],(b=e(d,g))&&h.push(n(d)+(c?": ":":")+b));else for(d in g)Object.prototype.hasOwnProperty.call(g,d)&&(b=e(d,g))&&h.push(n(d)+
(c?": ":":")+b);b=0===h.length?"{}":c?"{\n"+c+h.join(",\n"+c)+"\n"+k+"}":"{"+h.join(",")+"}";c=k;return b}}var g=/^[\],:{}\s]*$/,l=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,h=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,b=/(?:^|:|,)(?:\s*\[)+/g,d=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,k=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=m,Number.prototype.toJSON=m,String.prototype.toJSON=m);var c,p,D,u;"function"!==typeof JSON.stringify&&(D={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=
function(a,b,d){var f;p=c="";if("number"===typeof d)for(f=0;f<d;f+=1)p+=" ";else"string"===typeof d&&(p=d);if((u=b)&&"function"!==typeof b&&("object"!==typeof b||"number"!==typeof b.length))throw Error("JSON.stringify");return e("",{"":a})});"function"!==typeof JSON.parse&&(JSON.parse=function(a,d){function c(a,b){var e,p,k=a[b];if(k&&"object"===typeof k)for(e in k)Object.prototype.hasOwnProperty.call(k,e)&&(p=c(k,e),p!==H?k[e]=p:delete k[e]);return d.call(a,b,k)}a=String(a);k.lastIndex=0;k.test(a)&&
(a=a.replace(k,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(g.test(a.replace(l,"@").replace(h,"]").replace(b,"")))return a=eval("("+a+")"),"function"===typeof d?c({"":a},""):a;throw new SyntaxError("JSON.parse");})})()});"use strict";q.when("A","jQuery","client-side-metrics","weblab-helper","polyfill-filter","polyfill-json-stringify").register("ajax-wrapper",function(a,m,n,e){function g(a,b){function d(a,b){for(var c=0;c<a._options.length;c++){var e=a._options[c];
if(e=b.call(a,e,"object"===typeof e?e.name:e))return e}}this._options=a instanceof g&&b&&b.length?a._options.concat(b):a instanceof g?a._options:a&&a.length?a:[];this.filter=function(a){var b={};d(this,function(d,c){c in a&&(b[c]=a[c])});return b};this.getOption=function(a){return d(this,function(b,d){if(d===a)return b})};return this}function l(a){this._options=a.allowedOptions;this._messageForViolation=a.messageForViolation;this._messageForViolationWithValue=a.messageForViolationWithValue;this._optionName=
a.optionName;this._valueName=a.valueName;this.validate=function(a){for(var b in a)if(a.hasOwnProperty(b)){var d=this._options.getOption(b);if(!d)throw d=this._messageForViolation.replace(this._optionName,b),Error(d);if("object"===typeof d&&!d.validate(a[b]))throw d=this._messageForViolationWithValue.replace(this._optionName,b),d=d.replace(this._valueName,a[b]),Error(d);}};return this}function h(a){try{A.validate(a)}catch(d){console.error(d)}var c=f.filter(a),c=m.extend(c,b(a));return m.ajax(c)}function b(a){if(a.params){if(a.data&&
a.params)throw Error("The option data can not be present with the emulated params option. Merge both and use just one.");return{data:a.params}}}function d(b){try{C.validate(b)}catch(d){console.error(d)}var f={url:H,options:t.filter(b)},h=new m.Deferred;f.url=b.url;if(b.data){if(b.data&&b.params)throw Error("Unsupported options. 'params' and 'data' options are both specified. Remove one of them.");if("object"===typeof b.data)f.options.params=b.data;else if("string"===typeof b.data)e.isSetParamsFormatAsStirngWeblabOn()?
"GET"===b.type?f.url+="?"+b.data:(f.options.params=b.data,f.options.paramsFormat="string"):f.url+="?"+b.data;else throw Error("Unsupported type provided in the 'data' attribute of an AJAX call");}if(b.type){if(b.type&&b.method)throw Error("Unsupported options. 'type' and 'method' options are both specified. Remove one of them.");f.options.method=b.type}if("crossDomain"in b){if("crossDomain"in b&&"withCredentials"in b)throw Error("Unsupported options. 'crossDomain' and 'withCredentials' options are both specified. Remove one of them.");
f.options.withCredentials=b.crossDomain}f=c(f,b,h);f=k(f,b,h);f=D(f,b,h);f=p(f,b,h);f=u(f,b,h);b.beforeSend&&b.beforeSend(f.options);f=w(f,b,h);b=a.ajax(f.url,f.options);return b=h.promise(b)}function k(a,b,d){var c=a.options.success;a.options.success=function(a,b,f){c&&c(a,b,f);d.resolve(a,b,f)};var f=a.options.error;a.options.error=function(a,b,c){f&&f(a,b,c);d.reject(a,b,c)};var e=a.options.abort;a.options.abort=function(a){e&&e(a);d.reject(a,"abort")};return a}function c(a,b){if(!b.complete)return a;
var d=a.options.success;a.options.success=function(a,c,f){d&&d(a,c,f);b.complete(f,"success")};var c=a.options.error;a.options.error=function(a,d,f){c&&c(a,d,f);b.complete(a,"error")};var f=a.options.abort;a.options.abort=function(a){f&&f(a);b.complete(a,"abort")};return a}function p(a,b){var d=a.options.success;a.options.success=function(a,c,f){d&&("text"===b.dataType&&"object"===typeof a&&(a=JSON.stringify(a)),d(a,c,f))};return a}function D(a,b){if(!b.useXMLHttp)return a;var d=a.options.success;
a.options.success=function(a,b,c){c&&(c=c.http);d(a,b,c)};var c=a.options.error;a.options.error=function(a,b,d){a&&(a=a.http);c(a,b,d)};var f=a.options.abort;a.options.abort=function(a){a&&(a=a.http);f(a)};return a}function u(a,b){var d=a.options.success;a.options.success=function(a,b,c){c&&304===c.http.status?d(a,"notmodified",c):d(a,"success",c)};var c=a.options.error;a.options.error=function(a,b,f){a&&a.http.readyState<z.DONE?c(a,"timeout",f):a&&200<=a.http.status&&300>a.http.status&&a.http.readyState===
z.DONE?d(a.http.responseText,"success",a):a&&0==a.http.status?c(a,"abort",f):c(a,"error",f)};return a}function w(a,b){var d=a.options.success;a.options.success=function(a,b,c){x(c,"success");d(a,b,c)};var c=a.options.error;a.options.error=function(a,b,d){x(a,"error");c(a,b,d)};return a}function x(a,b){a?(n.increaseCount("AUI:Ajax:"+b+":xhr:defined"),a.http?n.increaseCount("AUI:Ajax:"+b+":xhr:http:defined"):a.http===H?n.increaseCount("AUI:Ajax:"+b+":xhr:http:undefined"):null===a.http&&n.increaseCount("AUI:Ajax:"+
b+":xhr:http:null")):a===H?n.increaseCount("AUI:Ajax:"+b+":xhr:undefined"):null===a&&n.increaseCount("AUI:Ajax:"+b+":xhr:null")}var z={UNSET:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},f=new g("accepts async beforeSend cache complete contents contentType context converters crossDomain data dataFilter dataType error global headers ifModified isLocal jsonp jsonpCallback method mimeType password processData scriptCharset statusCode success timeout traditional type url username xhr xhrFields".split(" ")),
t=new g("abort accepts cache chunk contentType error headers indicator method params success timeout withCredentials".split(" ")),J=new g(t,[{name:"async",validate:function(a){return a}},"useXMLHttp","beforeSend","complete","crossDomain","dataType","data","type","url"]),v=new g(f,["params"]),C=new l({allowedOptions:J,messageForViolation:"The option %O is not supported in AUI ajax calls and default ajax. Consider using jQuery ajax.",messageForViolationWithValue:"The option %O with value %V is not supported in AUI ajax calls and default ajax. Consider using jQuery ajax.",
optionName:"%O",valueName:"%V"}),A=new l({allowedOptions:v,messageForViolation:"The option %O is not supported in jQuery ajax calls and default ajax. Consider using AUI ajax.",messageForViolationWithValue:"The option %O with value %V is not supported in jQuery ajax calls and default ajax. Consider using AUI ajax.",optionName:"%O",valueName:"%V"}),M=m("meta[name\x3ddefaultAJAX]").attr("content");"jQuery"!==M&&"AUI"!==M&&(M="jQuery");return{default:function(a){try{C.validate(a),A.validate(a)}catch(b){console.error(b)}if("jQuery"===
M)h(a);else if("AUI"===M)d(a);else throw Error("Unknown AJAX method: "+M);},jQuery:h,aui:d,READY_STATE:z}});"use strict";q.when("jQuery").register("weblab-helper",function(a){return{isAJAXWeblabOn:function(){return"1"===a("meta[name\x3dPAGE_CONDUCTOR_AUI_AJAX]").attr("content")},isAjaxStreamingEnabled:function(){return"1"===a("meta[name\x3dENABLE_AJAX_STREAMING]").attr("content")},isNavCFWeblabOn:function(){return"1"===a("meta[name\x3dEMIT_NAV_CF]").attr("content")},isRemoveOrderSummaryPrimaryActionBtnTextWeblabOff:function(){return"1"!==
a("#is-remove-os-pabt").val()},isSetParamsFormatAsStirngWeblabOn:function(){return"1"===a("meta[name\x3dSET_PARAMS_FORMAT_AS_STRING]").attr("content")},disablePrefetchForScheduledDeliveryWeblabOn:function(){return"1"===a("meta[name\x3dDISABLE_PREFETCH_FOR_SCHEDULED_DELIVERY]").attr("content")},isRemoveAddressFormOnDeleteAddressWeblabOn:function(){return"1"===a("meta[name\x3dREMOVE_ADDRESS_FORM_ON_DELETE_ADDRESS]").attr("content")},isSOSPExclusiveJSHandlerWeblabOn:function(){return"1"===a("meta[name\x3dSOSP_EXCLUSIVE_JS]").attr("content")},
sospPartialAvailabilityWeblabOn:function(){return"1"===a("meta[name\x3dSOSP_PARTIAL_UNAVAILABILITY]").attr("content")},refactorExtractURL:function(){return"1"===a("meta[name\x3dREFACTOR_EXTRACT_URL]").attr("content")},showGiftTextAreaOnWarning:function(){return"1"===a("meta[name\x3dSHOW_GIFT_TEXT_AREA_ON_WARNING]").attr("content")},isInterceptionAddressFormWidthFixEnabled:function(){return"1"===a("meta[name\x3dFIX_FIELD_WIDTH_IN_CHECKOUT_INTERCEPTION_FIX_ENABLED]").attr("content")},removesGiftOptionOnRush:function(){return"1"===
a("meta[name\x3dREMOVE_GIFT_OPTION_RUSH]").attr("content")},isSPCMobileDisplayMoreShipOptionsEnabled:function(){return"1"===a("meta[name\x3dSPC_MOBILE_DISPLAY_MORE_SHIP_OPTIONS]").attr("content")},isMCBMultiTenderWeblabEnabled:function(){return"1"===a("meta[name\x3dMCB_MULTI_TENDER_ENABLED]").attr("content")},isCreateAddressLinkForTaxAddressFormWeblabOn:function(){return"1"===a("meta[name\x3dCREATE_ADDRESS_IN_TAX_COLLECTION_ENABLED]").attr("content")},isMfaPSD2DeviceDescriptionCollectionEnabled:function(){return"1"===
a("meta[name\x3dMFA_PSD2_DEVICE_DESCRIPTION_COLLECTION_ENABLED]").attr("content")},isSospCalendarFixEnabled:function(){return"1"===a("meta[name\x3dSOSP_CALENDAR_FIX]").attr("content")},isUpdateMobileNumberEnabled:function(){return"1"===a("meta[name\x3dUPDATE_MOBILE_NUMBER]").attr("content")},isGILCreditCardEnabled:function(){return"1"===a("meta[name\x3dGIL_CREDIT_CARD_PAYMENT_METHOD]").attr("content")},isPyoClientSideInitiationEnabled:function(){return"1"===a("meta[name\x3dPYO_CLIENT_SIDE_INITIATION]").attr("content")},
isTFXCurrencyToggleOnTabletFixed:function(){return"1"===a("meta[name\x3dTFX_CURRENCY_TOGGLE_ON_TABLET_FIXED]").attr("content")},isTFXGuaranteedExchangeFeeEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_TFX_GUARANTEED_EXCHANGE_FEE]").attr("content")},isCSMErrorLoggingEnabled:function(){return"1"===a("meta[name\x3dENABLE_CSM_ERROR_LOGGING]").attr("content")},isLogAFFNFallbackEnabled:function(){return"1"===a("meta[name\x3dENABLE_AF_FN_FALLBACK]").attr("content")},isExecutionIdInQueryStringEnabled:function(){return"1"===
a("meta[name\x3dADD_EXECUTION_ID_TO_QUERY_STRING]").attr("content")},isDigitalAsinIndexingFixedOnSOSPEnabled:function(){return"1"===a("meta[name\x3dDIGITAL_ASIN_INDEXING_FIXED_ON_SOSP]").attr("content")},isCvfOldAmazonUiFixesEnabled:function(){return"1"===a("meta[name\x3dCVF_OLD_AUI_FIXES]").attr("content")},isHeadersCleaned:function(){return"1"===a("meta[name\x3dCLEAN_UP_HEADERS]").attr("content")},isItemAssociationDeleteConfirmationPopoverForWirelessPlansEnabled:function(){return"1"===a("#is-item-assoc-delete-confirmation-popover-for-wireless-plans").val()},
isSsdMdwEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_SSD_MDW]").attr("content")},isExcludeMdwFromGoldenCXWidgetRenamingWeblabEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_GOLDEN_CX_WIDGET_RENAMING_EXCLUDE_MDW]").attr("content")},isRemoveDigitalFlagForScheduledDeliveryShipmentEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_SD_NOT_DIGITAL]").attr("content")},isEGiftOptionsActive:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_EGIFT_OPTIONS_MOBILE]").attr("content")},
isPipelineDispatchSendHeaderEnabled:function(){return"1"===a("meta[name\x3dSEND_HEADER_FOR_PIPELINE_REQUEST]").attr("content")},isIngressEnabled:function(){return"1"===a("meta[name\x3dINGRESS_ENABLED]").attr("content")},isISPUMasterEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_ISPU_MASTER]").attr("content")},isRushISPUMasterEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_RENDER_RUSH_ISPU_MASTER]").attr("content")},isProgressiveOrderReviewCardAnchorEnabled:function(){return 1===
a("#progressive-order-review-card-anchor").length},isTaxExemptionMessagingFixed:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_TAX_EXEMPTION_MSGING]").attr("content")},isProgressiveOrderReviewScrollingFixEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_PROGRESSIVE_SCROLLING_FIX]").attr("content")},isVasTrueSPCEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_VAS_TRUESPC]").attr("content")},isSecureUnifiedDeliveryEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_SECURE_UNIFIED_DELIVERY]").attr("content")},
isChooseSDOButtonMultiClickFixEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_TSPC_CHOOSE_SDO_BUTTON_MULTI_CLICK_FIX]").attr("content")},isPageConductorConvergenceEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_PAGE_CONDUCTOR_TANGO_INGRESS_CONVERGENCE]").attr("content")},isSkipZeroShippingSpeedShipmentEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_SKIP_ZERO_SHIPPING_SPEED_SHIPMENT]").attr("content")},isScheduleDeliveryHiddenInputIdFixEnabled:function(){return"1"===
a("meta[name\x3dRCX_CHECKOUT_SCHEDULE_DELIVERY_HIDDEN_INPUT_ID_FIX_ENABLED]").attr("content")},isIngressEDGSetterResponseHandlerEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_INGRESS_EDG_SETTER_RESPONSE_HANDLER_ENABLED]").attr("content")},isProgressiveIndicatorScrollingFixEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_PROGRESS_INDICATOR_SCROLLING_FIX]").attr("content")},isOrderSummaryUpsellWidgetUpdateEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_PAGE_CONDUCTOR_OSU_WIDGET_UPDATE_ENABLED]").attr("content")},
isSnsChangeOrderTypeEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_SNS_CHANGE_ORDER_TYPE_ENABLED]").attr("content")},isBRMarketplaceCurrencyFormatEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_BR_MARKETPLACE_CURRENCY_FORMAT]").attr("content")},isProgressIndicatorPaySelectFixEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_PROGRESS_INDICATOR_PSP_FIX_ENABLED]").attr("content")},isAmazonDayDatePickerClickSkipShipOptionChangeEnabled:function(){return"1"===a("meta[name\x3dAMAZON_DAY_DATE_PICKER_CALENDAR_CLICK_SKIP_SHIP_OPTION_CHANGE]").attr("content")},
isAmazonDayIncentiveDetailsLinkRedirectionEnabledOnStripeMsg:function(){return"1"===a("meta[name\x3dIS_AMAZON_DAY_INCENTIVE_DETAILS_LINK_REDIRECTION_ENABLED_ON_STRIPE_MSG]").attr("content")},isDeleteTogetherPopoverEnabled:function(){return"1"===a("meta[name\x3dRCX_DELETE_TOGETHER_POPOVER_ENABLED]").attr("content")},isChewbaccaAffordUpsellCheckboxMigrationEnabledUsingAjaxUpdate:function(){return"1"===a("meta[name\x3dIS_CHEWBACCA_AFFORD_UPSELL_CHECKBOX_MIGRATION_ENABLED_USING_AJAX_UPDATE]").attr("content")},
isInstallmentsInvalidateRicSetterEnabled:function(){return"1"===a("meta[name\x3dIS_INSTALLMENTS_INVALIDATE_RIC_SETTER_ENABLED]").attr("content")}}});"use strict";q.when("A","client-side-metrics").register("weekend-availability-expander-helper",function(a,m){function n(a){return(a=h[a])?l("#weekend-availability-expander-header-text-"+a).text():l("#weekend-availability-default").text()}function e(){return 1==l("input[name\x3d'isBusinessDefaultWeekendDeliveryEnabled']").attr("value")?!0:!1}function g(a,
d){return a&&d?"BOTH":a?"SAT":d?"SUN":"NONE"}var l=a.$,h={BOTH:"both",SAT:"sat",SUN:"sun",NONE:"none"};return{isBusinessDefaultWeekendDeliveryViewActive:e,logExpanderState:function(a,d,e,c){m.increaseCount("checkout:delivery-preferences:"+a+":expander:"+d+":"+(e&&c?"neverExpanded":c?"collapsed":"expanded"),1)},stateToCheckboxes:function(a){var d=!1,k=!1;if(e()){if("BOTH"===a||"SAT"===a)d=!0;if("BOTH"===a||"SUN"===a)k=!0}else{if("BOTH"===a||"OTH"===a||"SAT"===a)d=!0;if("BOTH"===a||"OTH"===a||"SUN"===
a)k=!0}return{isSaturdayChecked:d,isSundayChecked:k}},updateAllOptOutMessages:function(a){1==l("input[name\x3d'isSundayDeliveryPreferenceSuppressed']").attr("value")?a.isSaturdayChecked?l(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!0):(l(".weekend-availability-opt-out-message").text(l("#weekend-availability-opt-out-sat-text").text()),l(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1)):a.isSaturdayChecked||a.isSundayChecked?a.isSaturdayChecked?a.isSundayChecked?
l(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!0):(l(".weekend-availability-opt-out-message").text(l("#weekend-availability-opt-out-sun-text").text()),l(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1)):(l(".weekend-availability-opt-out-message").text(l("#weekend-availability-opt-out-sat-text").text()),l(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1)):(l(".weekend-availability-opt-out-message").text(l("#weekend-availability-opt-out-both-text").text()),
l(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1))},updateAllTitles:function(a){a=g(a.isSaturdayChecked,a.isSundayChecked);l(".sat-sun-expander-heading-text").text(n(a))},updateAllWeekendAvailabilityStates:function(a){a=g(a.isSaturdayChecked,a.isSundayChecked);l("input[name\x3d'BusinessHours']").attr("value",a)}}});"use strict";q.when("A","loading-spinner-controller","page-transition-controller","page-conductor","checkout-general-utils","address-utilities","page-detector-current-page",
"client-side-metrics","weblab-helper").register("address-popovers",function(a,m,n,e,g,l,h,b,d){function k(a){(d.isHeadersCleaned()?a.popoverValid:a.getResponseHeader("x-amz-checkout-popover-valid"))||e.redirect({conductoraction:{url:"/gp/cart/view.html",type:"redirect"}})}function c(c,f,p){g.protectAgainstDoubleAction("show-add-address-popover",200)||(M=c.popover,!A('input[name\x3d"preloadAddressPopover"]').length||f.is(":empty")?(f.empty(),f.css("min-height",397),M.updatePosition(!0),m.showSpinner(f,
!1,M),c=(new Date).getTime(),p=h.getCurrentPage(),b.increaseCount("checkout:address-popover-pagetype:".curPage,1),p="itemselect"===p||"spp-itemselect"===p?1:0,d.isHeadersCleaned()?A.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/display.html?cachebuster\x3d"+c,data:{isBilling:r,isMultiAddress:p},dataType:"json",async:!0,cache:!1,headers:{"x-amz-checkout-page":"itemselect"},success:function(a,b,d){k(a);f.css("min-height",0);t(f,a.popoverContent)},error:e.ajaxRedirect}):A.ajax({type:"POST",
url:"/gp/buy/addressselect/handlers/popover/display.html?cachebuster\x3d"+c,data:{isBilling:r,isMultiAddress:p},async:!0,cache:!1,headers:{"x-amz-checkout-page":"itemselect"},success:function(a,b,d){k(d);f.css("min-height",0);t(f,a)},error:e.ajaxRedirect})):(l.customizeFormFromIdentity(f),l.countrySpecificPopoverOptimizationCheck(A("html")),p&&a.trigger("identity-assets")))}function p(a,c){if(!g.protectAgainstDoubleAction("add-new-address",200)){b.resetMetrics();var f=!1;A(".identity-protect-from-errant").each(function(){var a=
A(this),a=a.is("input")?a:a.find("input:first");-1!==a.val().search(/(\d[ -]?){13}/)&&(f=!0)});if(f){var p=A(".address-form-security-error:first");p.length?alert(p.text()):alert("Please check that the address you have entered is correct.")}else{c.$event.preventDefault();m.showSpinner(a,!1,M);var h=A("#domestic-address-popover-form, #international-address-popover-form, #address-popover-suggestions-form").filter(":visible"),p=h.serialize(),l=(new Date).getTime();c=c.$currentTarget.find('input[type\x3d"submit"]').attr("name");
"useSelectedAddress"===c?p+="\x26fromSuggestionPage\x3d1":"fromAddressEditToContinue"===c&&(p+="\x26fromAddressEditToContinue\x3d1");A("#addAddressOnly").length&&(p+="\x26addOnly\x3d1");r&&(p+="\x26isBilling\x3d1");var n="/gp/buy/addressselect/handlers/popover/new.html";if(M){if("domestic-address-popover-form"===h.attr("id")&&(h.find(".enterAddressFormField").blur(),h="#"+a.attr("id")+" div[id^\x3donblur-character-validation-error-]",0<A(h).size())){m.hideSpinner(a);return}n+="/ref\x3dchk_addr_editPopoverSubmit";
e.isSPP()&&(M.lock(11),setTimeout(function(){M.unlock(12)},2E3))}var u=null!==S&&S!==H&&null!==P&&P!==H;"useSelectedAddress"===c&&!r&&u&&(p+="\x26fromSTMAPopover\x3d1");A("#international-address-popover-form").filter(":visible").length&&(p+="\x26showSecondaryForm\x3d1");v()&&L?D(a,l,p):d.isHeadersCleaned()?A.ajax({type:"POST",url:n+"?cachebuster\x3d"+l,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",data:p,dataType:"json",async:!0,cache:!1,error:e.ajaxRedirect,success:function(b,
c,d){e.isSPP()&&M.unlock(12);k(b);b.newPopoverType?w(b,c,b):b.reloadPopover?t(a,b.popoverContent):u?x(b):z("added",b.popoverContent)}}):A.ajax({type:"POST",url:n+"?cachebuster\x3d"+l,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",data:p,async:!0,cache:!1,error:e.ajaxRedirect,success:function(b,c,d){e.isSPP()&&M.unlock(12);k(d);d.getResponseHeader("x-amz-checkout-open-new-popover")?w(b,c,d):d.getResponseHeader("x-amz-checkout-reload-popover")?t(a,b):u?x(d):z("added",d)}})}}}function D(a,
b,c){var f=L.getNewTaxAddressPopoverURL();d.isHeadersCleaned()?A.ajax({type:"POST",url:f+"?cachebuster\x3d"+b,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",data:c,dataType:"json",async:!0,cache:!1,error:e.ajaxRedirect,success:function(b,c,d){e.isSPP()&&M.unlock(12);k(b);b.reloadPopover?t(a,b.popoverContent):b.newAddressId&&(A(".a-button-close").trigger("click"),g.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"),L.submitTaxAddressFormWithNewAddressId(b.newAddressId))}}):
A.ajax({type:"POST",url:f+"?cachebuster\x3d"+b,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",data:c,async:!0,cache:!1,error:e.ajaxRedirect,success:function(b,c,d){e.isSPP()&&M.unlock(12);k(d);d.getResponseHeader("x-amz-checkout-reload-popover")?t(a,b):d.getResponseHeader("x-amz-checkout-new-address-id")&&(A(".a-button-close").trigger("click"),g.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"),b=d.getResponseHeader("x-amz-checkout-new-address-id"),L.submitTaxAddressFormWithNewAddressId(b))}})}
function u(a){if(!g.protectAgainstDoubleAction("show-edit-address-popover",200)){var b=A("#address-suggestions-popover");a.$event.preventDefault();m.showSpinner(b,!1,M);a=A("#address-popover-suggestions-form");var c=a.serialize();a.find('input[type\x3d"radio"]').each(function(){var a=A(this);a.attr("checked")&&(c+="\x26edit_"+a.val()+"\x3d1")});r&&(c+="\x26isBilling\x3d1");M&&e.isSPP()&&(M.lock(11),setTimeout(function(){M.unlock(12)},2E3));a=(new Date).getTime();d.isHeadersCleaned()?A.ajax({type:"POST",
url:"/gp/buy/addressselect/handlers/popover/edit.html?cachebuster\x3d"+a,data:c,dataType:"json",async:!0,cache:!1,error:e.ajaxRedirect,success:function(a,b,c){e.isSPP()&&M.unlock(12);k(a);w(a,b,a)}}):A.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/edit.html?cachebuster\x3d"+a,data:c,async:!0,cache:!1,error:e.ajaxRedirect,success:function(a,b,c){e.isSPP()&&M.unlock(12);k(c);w(a,b,c)}})}}function w(b,c,f){A('input[name\x3d"preloadAddressPopover"]').remove();d.isHeadersCleaned()?(c=f.newPopoverType,
"suggestions"===c?(A("#address-suggestions-popover").empty().append(f.popoverContent),A("#address-suggestions-popover-link").trigger("click")):"edit"===c&&(c=A("#edit-address-popover"),c.empty().append(f.popoverContent),A("#edit-address-popover-link").trigger("click"),t(c,f.popoverContent))):(c=f.getResponseHeader("x-amz-checkout-open-new-popover"),"suggestions"===c?(A("#address-suggestions-popover").empty().append(b),A("#address-suggestions-popover-link").trigger("click")):"edit"===c&&(c=A("#edit-address-popover"),
c.empty().append(b),A("#edit-address-popover-link").trigger("click"),t(c,b)));a.trigger("identity-assets")}function x(a){a=d.isHeadersCleaned()?a.newAddressId:a.getResponseHeader("x-amz-checkout-new-address-id");var b=(new Date).getTime();A.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html?cachebuster\x3d"+b,data:{action:"update-address",lineitems:S,quantities:P,addresses:a+".home..",returnHTML:0},async:!0,cache:!1,error:e.ajaxRedirect,success:function(a,b,c){z("applied",c)}})}function z(b,
c){var d=(new Date).getTime();A('input[name\x3d"shipToAddress"]').length?(b=function(){e.isSPP()?(n.blockAllActions(),n.shrinkPanel(A(".spp-panel.expanded"),!0)):n.show()},e.isNonBlockingAnimationEnabled()?a.delay(b,0):b(),b=h.getCurrentPage(),e.loadPage(b,"",H,{refTag:"chk_addr_editPopoverSubmit"},H,c)):(c=e.setAjaxTransitionHeader(),A.ajax({type:"POST",headers:c,url:"/gp/buy/shared/handlers/pipeline-dispatch.html?cachebuster\x3d"+d,data:{useCase:"multiAddress",showAddressAdded:b,page:"itemselect"},
dataType:"text",async:!0,cache:!1,error:e.ajaxRedirect,success:function(a,b,c){e.ajaxUpdatePage(a,b,c);A(".a-button-close").trigger("click");g.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")}}))}function f(a){a=A("#"+a);a.length&&a.empty()}function t(b,c){b.html(c);l.customizeFormFromIdentity(b);M.updatePosition(!0);a.trigger("identity-assets");l.countrySpecificPopoverOptimizationCheck(A("html"))}function J(a){a=a.$currentTarget.closest(".lineitem");S=a.find('input[name^\x3d"lineItemEntityID."]').val();
P=a.find('input[name^\x3d"quantity."]').val();a=A("#add-address-popover-link");a.length?a.trigger("click"):A("#add-new-address-popover").trigger("click")}function v(){return d.isCreateAddressLinkForTaxAddressFormWeblabOn()&&0<A("#isTaxAddress").length}function C(){r=A("#isBilling").length?1:0;if(d.isInterceptionAddressFormWidthFixEnabled()){var a=A(".enter-address-form");l.customizeFormFromIdentity(a)}}var A=a.$,M,S,P,r=0,L=null;if(!A("html").hasClass("a-ie6"))return a.on("a:popover:show:add-address",
function(a){f("edit-address-popover");f("add-billing-address-popover");r=0;c(a,A("#add-address-popover"),!1)}),a.on("a:popover:show:add-billing-address",function(a){f("edit-address-popover");f("add-address-popover");c(a,A("#add-billing-address-popover"),!0)}),a.on("a:popover:show:address-suggestions",function(a){M=a.popover}),a.on("a:expander:delivery-expander:toggle:expand",function(a){a=A(".a-expander-content");l.fixOverflow(a)}),a.declarative("close-delete-popover",["click","touchend"],function(a){q.when("a-popover-base").execute(function(b){(b=
b.get(a.data.popoverName))&&b.hide()})}),a.declarative("rm-address-action",["click","touchend"],function(a){q.when("a-popover-base").execute(function(b){(b=b.get(a.data.popoverName))&&b.hide()});d.isRemoveAddressFormOnDeleteAddressWeblabOn()&&(f("edit-address-popover"),f("add-address-popover"),f("add-billing-address-popover"));q.when("page-conductor").execute(function(b){b.continueClicked(null,a.$target)})}),A(document).delegate("a.prevent-default-marker","click",function(a){a.preventDefault()}),
a.declarative("select-billing-address-in-popover",["click","touchend"],function(a){a.$event.preventDefault();A("#address-list").submit();q.when("a-popover-base").execute(function(a){a.get("select-billing-address")&&a.remove("select-billing-address")})}),a.declarative("trigger-popover-from-link",["click","touchend"],function(a){g.protectAgainstDoubleAction("trigger-popover-from-link",200)||(P=S=null,A("#add-address-popover-link").trigger("click"))}),a.declarative("add-address-popover-submit",["click",
"touchend"],function(a){p(A("#add-address-popover"),a)}),a.declarative("add-billing-address-popover-submit",["click","touchend"],function(a){p(A("#add-billing-address-popover"),a)}),a.declarative("edit-address-popover-submit",["click","touchend"],function(a){p(A("#edit-address-popover"),a)}),a.declarative("address-suggestions-submit",["click","touchend"],function(a){p(A("#address-suggestions-popover"),a)}),a.declarative("delete-address-popover-submit",["click","touchend"],function(a){a=A("#delete-address-button");
0<a.length&&a.click()}),a.declarative("edit-address-suggestions",["click","touchend"],u),a.declarative("add-address-popover-edit",["click","touchend"],function(a){if(!g.protectAgainstDoubleAction("add-address-popover-edit",200)){a.$event.preventDefault();var b=A("#add-address-popover");m.showSpinner(b,!1,M);a=A("#address-popover-suggestions-form").serialize()+"\x26"+a.$currentTarget.find('input[type\x3d"submit"]').attr("name")+"\x3d1";var c=(new Date).getTime();d.isHeadersCleaned()?A.ajax({type:"POST",
url:"/gp/buy/addressselect/handlers/popover/edit.html?cachebuster\x3d"+c,data:a,dataType:"json",async:!0,cache:!1,error:e.ajaxRedirect,success:function(a,c,d){k(a);t(b,a.popoverContent)}}):A.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/edit.html?cachebuster\x3d"+c,data:a,async:!0,cache:!1,error:e.ajaxRedirect,success:function(a,c,d){k(d);t(b,a)}})}}),a.declarative("add-address-popover-toggle",["click","touchend"],function(a){g.protectAgainstDoubleAction("add-address-popover-toggle",
200)||(a.$event.preventDefault(),a=a.$currentTarget.closest(".enter-address-form"),l.toggleAddressForm(a,a.siblings(".enter-address-form")))}),a.declarative("select-radio-option",["click","touchend"],function(a){a=a.$currentTarget.find(".radio-option");a.find('input[type\x3d"radio"]').attr("checked","checked");a.closest(".radio-option-list").find(".radio-option").removeClass("radio-option-selected");a.addClass("radio-option-selected")}),a.declarative("trigger-address-popover",["click","touchend"],
function(a){g.protectAgainstDoubleAction("trigger-address-popover",200)||A("#add-address-popover-link").trigger("click")}),a.on("checkout:reload:spp-shipaddress",C),a.on("checkout:reload:spp-billing-address",C),a.on("checkout:reload:itemselect",C),a.on("checkout:reload:spp-itemselect",C),{actionTriggerPopoverFromDropdown:J,actionRegisterTaxAddressController:function(a){v()&&!L&&a&&(L=a)}}});"use strict";q.when("A").register("address-book-controller",function(a){function m(){n("div.address-book").unbind("recalculate-address-height").bind("recalculate-address-height",
function(){var a,g=n(),l=0,h=n("div.address-book .js-same-height"),b=h.length;h.css({height:"auto"}).each(function(d){var k=n(this);a=a||k.offset().top;a!==k.offset().top&&(g.height(l),g=n(),l=0,a=k.offset().top);var c=k.height();g=g.add(k);c>l&&(l=c);d===b-1&&0<l&&g.height(l)})}).trigger("recalculate-address-height");n(r).unbind("resize.checkout-as").bind("resize.checkout-as",function(){n("div.address-book").trigger("recalculate-address-height")})}var n=a.$;a.on("checkout:reload:spp-shipaddress",
m);a.on("checkout:reload:shipaddressselect",m);a.on("checkout:reload:billingaddressselect",m);a.on("checkout:reload:spp-billing-address",m)});"use strict";q.when("A","client-side-metrics","weblab-helper").register("address-utilities",function(a,m,n){function e(a){a.find("input").each(function(){var a=b(this),c=a.outerWidth(!0),d=a.parent().outerWidth(!0);c>d&&a.attr("size")&&(document.getElementById(a.attr("id")).removeAttribute("size"),a.width("100%"))})}function g(a){if(b('input[name\x3d"useLiveAUI"]').length)q.when("p-detect").execute(function(c){c.capabilities.inputPlaceholder&&
a.find(".field-description").each(function(){var a=b(this),c=a.text(),d=a.closest(".a-col-right").find(":not(.address-form-skip-js-tweaks):not(.address-form-skip-js-tweaks *) input");d.attr("maxlength")<c.length&&d.attr("size",c.length);d.attr("placeholder",a.text())})}),a.find("input").each(function(){b(this).outerWidth()}),a.find("input[type\x3d'text'], select").each(function(){var a=b(this).closest(".full-width-config"),c=b(this);0===a.find(".a-popover-trigger").length&&(n.isInterceptionAddressFormWidthFixEnabled()?
c.addClass("addressform-textfield-width"):c.width("96%"))});else{q.when("p-detect").execute(function(c){c.capabilities.inputPlaceholder?a.find(".field-description").each(function(){var a=b(this),c=a.text(),d=a.closest(".a-column").find(":not(.address-form-skip-js-tweaks):not(.address-form-skip-js-tweaks *) input");d.attr("maxlength")<c.length&&d.attr("size",c.length);d.attr("placeholder",a.text())}):a.find(".field-description").each(function(){var a=b(this);a.find("br").remove();a.show()})});a.find(".popover-field-label").each(function(){var a=
b(this);a.find("b").each(function(){var a=b(this);a.text(b.trim(a.text()))});a.find("font").each(function(){var a=b(this);"-2"===a.attr("size")&&a.remove()})});var k=b(".enter-address-form");e(k);var c=0,k=a.find(".one-new-address-form-field").first();k.length&&k.find(".a-column").each(function(){c+=b(this).outerWidth()});a.width(0<c?c:"")}}function l(b){function e(){n=p.val();(z=l[n])&&h.find(".learn-more a").text(z.popOverLinkText)}var c=r.P&&r.P.AUI_BUILD_DATE,p=b.find("#enterAddressCountryCode"),
h=b.find(".country-specific-form-input"),g,l;c?(g=h.find("input"),l=b.find(".country-specific-config").data("popovercountryconfig")):(m.increaseCount("removeauijs2"),g=h.find("#"+h.data("inputid")),l=h.find(".country-specific-config").data("popovercountryconfig"));if(p.length&&h.length&&g.length&&l){var n=p.val(),z=l[n];p.unbind("change.countryChangeConfigUpdate").bind("change.countryChangeConfigUpdate",e);e();var f=c?"show":"beforeShow";a.on("a:popover:"+f+":checkout-"+h.data("inputid")+"Name",function(a){"beforeShow"===
f&&m.increaseCount("removeauijs3");z&&(a.popover.$popover.find(".a-popover-header h4").html(z.popOverTitle),a.popover.$popover.find(".a-popover-inner").html(z.popOverText),a.popover.updatePosition())})}}function h(a){function e(){var a=p.val();(a=l[a])?(a=(a=a.label)||"",g.attr("placeholder",b("\x3cdiv /\x3e").html(a).text().replace(":","")),h.show()):h.hide()}var c=r.P&&r.P.AUI_BUILD_DATE,p=a.find("#enterAddressCountryCode"),h=a.find(".country-specific-form-input-mobile"),g,l;c?(g=h.find("input"),
l=a.find(".country-specific-config").data("labelcountryconfig")):(m.increaseCount("removeauijs3"),g=h.find("#"+h.data("inputid")),l=h.find(".country-specific-config").data("labelcountryconfig"));p.length&&h.length&&g.length&&l&&(p.unbind("change.countryChangeLabelUpdate").bind("change.countryChangeLabelUpdate",function(){h.hasClass("initial-edit-value")?h.removeClass("initial-edit-value"):g.val("");e()}),e())}var b=a.$;q.when("a-checkbox").execute(function(b){a.declarative("delivery-preferences-weekend-availability-checkbox-triggered",
"click",function(a){if("undefined"!==typeof a.$target){var c=a.$target.val();a.$target.is(":checked")&&("NONE"===c?(b("#delivery-preferences-weekend-availability-sat").uncheck(),b("#delivery-preferences-weekend-availability-sun").uncheck()):"SAT"!==c&&"SUN"!==c||b("#delivery-preferences-weekend-availability-none").uncheck())}})});a.declarative("wdp-redesign-addresstype-radio-clicked","click",function(a){var e=a.$target.context.id;a=b(".com-businesshours-text");var c=b("#delivery-preferences-weekend-availability-sat").is(":checked"),
p=b("#delivery-preferences-weekend-availability-sun").is(":checked");"devyPrefs_AddressType_COM"===e?(m.increaseCount("WDPTotalCOMClick"),b(".wdp-res").removeClass("a-color-base-background").addClass("a-color-alternate-background"),b(".wdp-com").removeClass("a-color-alternate-background").addClass("a-color-base-background"),b(".wdp-BusinessHours").removeClass("aok-hidden")):"devyPrefs_AddressType_RES"===e?(m.increaseCount("WDPTotalRESClick"),b(".wdp-com").removeClass("a-color-base-background").addClass("a-color-alternate-background"),
b(".wdp-res").removeClass("a-color-alternate-background").addClass("a-color-base-background"),b(".wdp-BusinessHours").addClass("aok-hidden")):"delivery-preferences-weekend-availability-sat"===e?(m.increaseCount("WDPTotalSATClick"),e=c?p?"BOTH":"SAT":p?"SUN":"OTH",a.addClass("aok-hidden"),b(".com-businesshours-"+e).removeClass("aok-hidden")):"delivery-preferences-weekend-availability-sun"===e&&(m.increaseCount("WDPTotalSUNClick"),e=p?c?"BOTH":"SUN":c?"SAT":"OTH",a.addClass("aok-hidden"),b(".com-businesshours-"+
e).removeClass("aok-hidden"))});return{toggleAddressForm:function(a,h){a.hide();h.find("div.a-alert-error:not(.js-originally-shown-imb)").hide();a.find("input[type\x3d'text'], select, input[type\x3d'radio']:checked, input[type\x3d'hidden']").each(function(){var a=b(this),d=a.attr("name")||a.data("copyto")||a.attr("id");if(!a.is(":disabled")&&!a.find(":selected").is(".js-not-a-value")){var e=h.find("input[name\x3d'"+d+"']");"enterAddressLandmark"===d&&(e=h.find("input[name\x3d'Landmark']"));"Landmark"!==
d||e.length||(e=h.find("input[name\x3d'enterAddressLandmark']"));1<e.length&&a.is("input[type\x3d'radio']")?e.filter("[value\x3d'"+a.val()+"']").attr("checked",!0):e.is("select")?e.find("option[value\x3d'"+a.val()+"']").attr("selected",!0):a.is("input[type\x3d'hidden']")||e.is("input[type\x3d'hidden']")||e.val(a.val())}});h.show();e(h);g(h)},customizeFormFromIdentity:g,fixOverflow:e,countrySpecificLabelOptimizationCheck:function(a){var b=a.find(".enter-address-form");1===b.data("taxidOpt")?setTimeout(function(){h(b)},
100):h(b)},countrySpecificPopoverOptimizationCheck:function(a){var b=a.find(".enter-address-form");1===b.data("taxidOpt")?setTimeout(function(){l(b)},100):l(b)}}});"use strict";q.when("A","page-conductor","page-transition-controller","client-side-metrics","page-detector-current-page","checkout-general-utils").register("address-form-helper",function(a,m,n,e,g,l){function h(a,b,c){p(".a-button-close").trigger("click");p('\x3cinput name\x3d"addressID"/\x3e').val(a).appendTo(c);p('\x3cinput name\x3d"purchaseId"/\x3e').val(b).appendTo(c);
m.continueClicked(null,c)}function b(a,b){b||(b=p("#address-ui-checkout-form"));k(b);var e=(new Date).getTime();p.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html?cachebuster\x3d"+e,data:{action:"update-address",lineitems:D,quantities:u,addresses:a,returnHTML:0},async:!0,cache:!1,error:function(){c(b);m.ajaxRedirect},success:function(a,c,e){d("applied",b)}})}function d(a,b){var d=(new Date).getTime(),f=m.setAjaxTransitionHeader();p.ajax({type:"POST",headers:f,url:"/gp/buy/shared/handlers/pipeline-dispatch.html?cachebuster\x3d"+
d,data:{useCase:"multiAddress",showAddressAdded:a,page:"itemselect"},dataType:"text",async:!0,cache:!1,error:function(){c(b);m.ajaxRedirect},success:function(a,d,f){c(b);m.ajaxUpdatePage(a,d,f);p(".a-button-close").trigger("click");l.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")}})}function k(a){m.isSPP()?(n.blockAllActions(),n.showTransitionInContainer(a)):n.show()}function c(a){m.isSPP()?(n.unblockAllActions(),p(a).find("div.section-overwrap").remove()):n.hide()}var p=a.$,D,u;
a.on("a:popover:afterUpdatePosition:edit-address",function(b){b.popover&&b.popover.isVisible()&&a.trigger("checkout:popoverContentLoaded:edit-address",b.popover)});a.on("a:popover:afterUpdatePosition:add-address",function(b){b.popover&&b.popover.isVisible()&&a.trigger("checkout:popoverContentLoaded:add-address",b.popover)});a.on("a:popover:visible:add-address",function(b){b.popover&&b.popover.isVisible()&&a.trigger("checkout:popoverContentLoaded:add-address",b.popover)});a.on("a:popover:beforeShow:add-address",
function(){a.trigger("checkout:popover-beforeShow:add-address")});a.on("a:popover:beforeShow:edit-address",function(){a.trigger("checkout:popover-beforeShow:edit-address")});a.on("a:popover:invisible:add-address",function(){a.trigger("checkout:popover-hide:add-address")});a.on("a:popover:invisible:edit-address",function(){a.trigger("checkout:popover-hide:edit-address")});a.on("checkout:reload:spp-shipaddress",function(){a.trigger("checkout:reload:address-page")});a.declarative("itemselect-update-address",
["change"],function(a){a=a.$currentTarget.closest(".lineitem");D=a.find('input[name^\x3d"lineItemEntityID."]').val();u=a.find('input[name^\x3d"quantity."]').val()});return{setDestination:function(a,c){a||(e.increaseCount("checkout:addressForm:setDestination:noRequest",1),a={});var d=a.addressId;d||e.increaseCount("checkout:addressForm:setDestination:noAddressId",1);var f=a.purchaseId||p("input[name\x3d'purchaseId']").val();f||e.increaseCount("checkout:addressForm:setDestination:noPurchaseId",1);a=
a.ref||"ox_shipaddress_add_new_addr";var k=g.getCurrentPage();if("itemselect"===k||"spp-itemselect"===k)return b(d,c);p('[name\x3d"isBilling"]')&&1==p('[name\x3d"isBilling"]').val()?(a="ox_billing_continue",(c=p("input[name\x3d'paymentInstrumentId']").val())||e.increaseCount("checkout:addressForm:setDestination:noPaymentInstrumentId",1),(k=p("input[name\x3d'paymentMethodCode']").val())||e.increaseCount("checkout:addressForm:setDestination:noPaymentMethodCode",1),a=p("\x3cform/\x3e").attr("action",
"/gp/buy/billingaddressselect/handlers/continue.html/ref\x3d"+a),p('\x3cinput name\x3d"paymentInstrumentId"/\x3e').val(c).appendTo(a),p('\x3cinput name\x3d"paymentMethodCode"/\x3e').val(k).appendTo(a),p('\x3cinput name\x3d"action" value\x3d"select-billing"/\x3e').appendTo(a),p('\x3cinput name\x3d"isAUIWSAddressCreationWorkflow" value\x3d"1"/\x3e').appendTo(a)):(a=p("\x3cform/\x3e").attr("action","/gp/buy/addressselect/handlers/continue.html/ref\x3d"+a),p('\x3cinput name\x3d"action" value\x3d"select-shipping"/\x3e').appendTo(a));
h(d,f,a)},onPageTransitionStart:k,onPageTransitionComplete:c}});"use strict";q.when("A","client-side-metrics","weblab-helper").register("action-logger",function(a,m){var n=a.$;a.declarative("ue-count",["click","touchend"],function(a){m.increaseCount(a.data.countFlag,a.data.countValue)});return{logUsedPrefetch:function(a,g,l,h){h||(m.increaseCount("Checkout:action-log:MissingRefMarker"),h="");n.ajax({type:"GET",url:"/gp/buy/shared/handlers/log-used-prefetch.html"+h,data:"pageType\x3d"+a+"\x26subPageType\x3d"+
g+"\x26relatedRequestId\x3d"+l,dataType:"text",cache:!1})}}});"use strict";q.when("A","weblab-helper").register("ajax-utility",function(a,m){return{jsonify:function(n){var e;if(e=m.isAJAXWeblabOn()){e=n instanceof Function;var g=n instanceof Array,l=n instanceof String;e=n instanceof Object&&!g&&!e&&!l}if(e)return n;try{n=a.$.parseJSON(n)}catch(h){n=null}return n}}});"use strict";q.when("A","page-conductor","client-side-metrics","weblab-helper").register("button-blocker",function(a,m,n,e){function g(a,
b,c,d){m.isSPP()?b.closest("span.a-declarative").data("blockerText",c):b.find("input.a-button-text").data("blockerText",c);l(d);p?(a.addClass("aok-hidden"),b.removeClass("aok-hidden"),h("#hasTVNavigation").length&&q.when("a-tv").execute(function(b){b.remove(a)})):(n.increaseCount("removeauijs10"),a.hide(),b.show(),b.hasClass("aok-hidden")&&b.removeClass("aok-hidden"))}function l(a){var b=h(".continue-button-blocker-text");b.length&&(a?(b.html(a),b.removeClass("aok-hidden")):(b.addClass("aok-hidden"),
b.empty()))}var h=a.$,b={},d=[],k,c,p=r.P&&r.P.AUI_BUILD_DATE,D=!1;e=e.isPyoClientSideInitiationEnabled()?"checkout:unload":"checkout:beforeReload";a.on(e,function(){d=[];b={};k=""});return{show:function(a,c,e){if(!D){var p=h(".continue-button");if(p.length)if(c){var f=h(".continue-button-blocker");if(f.length){e=e||"";var t=b[a]!==H&&b[a].tooltipText!==c,l=b[a]!==H&&b[a].buttonInlineText!==e;if(0===d.length||!b[a]||t||l)g(p,f,c,e),k=a;b[a]===H&&d.push(a);b[a]={tooltipText:c,buttonInlineText:e}}}else r.console&&
r.console.error&&console.error("showBlockerOnContinue should not be called with an empty tooltip."),n.increaseCount("Checkout:ButtonBlocker:EmptyTooltip")}},hide:function(a){if(!D){if(b[a]!==H){delete b[a];var c=h.inArray(a,d);d.splice(c,1)}var e=h(".continue-button");e.length&&(c=h(".continue-button-blocker"),c.length&&(0===d.length?(l(),p?(c.addClass("aok-hidden"),e.removeClass("aok-hidden"),h("#hasTVNavigation").length&&q.when("a-tv").execute(function(a){a.add(e)})):(n.increaseCount("removeauijs11"),
c.hide(),e.show(),e.hasClass("aok-hidden")&&e.removeClass("aok-hidden"))):k===a&&(k=d[0],g(e,c,b[k].tooltipText,b[k].buttonInlineText))))}},lock:function(){D=!0},unlock:function(){D=!1},getButtonBlocker:function(){c||(c=h(".continue-button-blocker"));return c}}});"use strict";q.when("A","button-blocker","client-side-metrics").register("button-blocker-controller",function(a,m,n){function e(a,b){h[a]!==H&&h[a].state!==b&&(h[a].state=b,g())}function g(){var a=!0,c;l.each(h,function(e,h){c=h.owner;if(h.state===
d.DISABLE_CONTINUE)return a=!1,m.show(c,h.toolTipMessage,h.buttonInlineMessage),b||(n.increaseCount("removeauijs12"),l(".continue-button-blocker").css("display","inline-block")),!1});a&&m.hide(c)}var l=a.$,h={},b=r.P&&r.P.AUI_BUILD_DATE,d={ENABLE_CONTINUE:"enableContinue",DISABLE_CONTINUE:"disableContinue"};a.on("checkout:beforeReload",function(){h={}});return{disableContinue:function(a,b,p,l){l=l||"";h[b]===H&&(p?(h[b]!==H||(h[b]={state:d.ENABLE_CONTINUE,owner:a,toolTipMessage:p,buttonInlineMessage:l}),
g()):r.console&&r.console.error&&console.error("_registerElement should not be called with an empty tooltip."));e(b,d.DISABLE_CONTINUE)},enableContinue:function(a){h[a]!==H&&e(a,d.ENABLE_CONTINUE)}}});"use strict";q.when("jQuery").register("cache-page-data-controller",function(a){var m={};return{clearCache:function(){m={}},setCachedPageData:function(n,e,g,l,h){var b=[],d=!0;a(".cacheable-spp-panel").each(function(){var c=a(this),e;e=!c||c.find(".is-scheduled-delivery").length?!1:!0;if(!e)return d=
!1;c.find(".expand-panel-button").removeClass("a-button-focus");b.push({id:c.attr("id"),content:c[0].outerHTML})});if(d){var k={panels:b};a(".cacheable-spp-section").each(function(){var b=a(this);k[b.attr("id")]=b[0].outerHTML});m[n+"-"+e]={curPageData:k,state:r.history?history.state:g,page:n,title:document.title||l,url:r.location.href||h}}},getCachedPageData:function(a,e){return m[a+"-"+e]}}});"use strict";q.when("A").register("checkout-general-utils",function(a){function m(a,b,d,k){var c=g.getAssocParamValuesFromUrl(a);
!d&&k?delete c[b]:c[b]=d;b=0<=a.indexOf("?")?a.substring(0,a.indexOf("?")):a;b=b+"?"+e.param(c,1);(a=g.getFragmentFromUrl(a))&&(b+="#"+a);return b}function n(a){a=a||document.location.pathname;var b;e.each(l,function(d,e){if((d=e.validator)&&d.test(a))return b=e,!1});b||(b=l.UNKNOWN);return b.type}var e=a.$,g={moveToNextInput:function(a){a=a.nextAll(":visible").find("input").get(0);a!==[]&&a.focus()},hide:function(a){a.hide()},show:function(a){r.P&&r.P.AUI_BUILD_DATE&&a.hasClass("aok-hidden")&&a.removeClass("aok-hidden");
a.show()},getAssocParamValuesFromUrl:function(a){var b={};if("string"!==typeof a||-1===a.indexOf("?"))return b;a=a.slice(a.indexOf("?")+1);if(!a)return b;-1!=a.indexOf("#")&&(a=a.substring(a,a.indexOf("#")));a=a.split("\x26");for(var d=0;d<a.length;d++){var e=a[d].split("\x3d");b[e[0]]=e[1]}return b},addQueryStringParameter:function(a,b,d){return m(a,b,d,!1)},addQueryStringParameterOrDeleteIfEmpty:function(a,b,d){return m(a,b,d,!0)},getQueryStringParameter:function(a,b){a=g.getAssocParamValuesFromUrl(a);
return b in a?a[b]:H},getFragmentFromUrl:function(a){var b=a.indexOf("#");return-1==b?H:a.substring(b+1)},extractURLParts:function(a){if(!a||"string"!==typeof a)return{};a=/(.*html)(\/ref[^?\n]*)?[?]?(.*)/g.exec(a);var b={};a&&(a[1]&&(b.normalizedUrl=a[1]),a[2]&&(b.refMarker=a[2]),a[3]&&(b.query=a[3]));return b},buildFilteredQueryString:function(a,b){var d="?";if(null==a||null==b)return"";b.forEach(function(b){var c=g.getQueryStringParameter(a,b);c&&(d=g.addQueryStringParameterOrDeleteIfEmpty(d,b,
c))});return"?"===d?"":d},redirectWithJavascript:function(a){r.location=g.addQueryStringParameter(a,"hasWorkingJavascript","1")},bindActionEnterKeyOnButton:function(a){a.keyup(function(a){13===a.which&&e(a.target).trigger("click")})},toggleExpanderContent:function(a){a=a.$target.closest(".a-box");a.hasClass("a-single")?a.removeClass("a-single").addClass("a-first"):a.addClass("a-single").removeClass("a-first")},validateNumber:function(a,b,d){e.trim(a);return/^\d+$/.test(a)&&a>=b&&a<=d}};g.protectAgainstDoubleAction=
function(){var a={};return function(b,d){if(!b)return r.console&&r.console.error&&console.error("Function is not used properly, use a unique owner to identify the caller."),!1;if(a.hasOwnProperty(b))return!0;a[b]=1;setTimeout(function(){delete a[b]},d||100);return!1}}();g.logErrorOnLevel=function(a,b){(r.ueLogError||e.noop)({message:a,logLevel:b});if(r.console){var d={FATAL:r.console.error,"default":r.console.warn};b=d[b]||d["default"]}else b=e.noop;b.call(r,a)};g.logError=function(a){g.logErrorOnLevel(a,
"FATAL")};g.updateCartByMash=function(a){q.when("safe-mash").execute(function(b){null!==a&&a!==H&&"1"===e("#updateCartByMash").attr("content")&&b&&b.cart&&b.cart.didUpdate&&b.cart.didUpdate({newCartQuantity:a})})};g.getPosition=function(a,b,d){for(var e=0,c=a.length,p=0;p<c;p++)if(a.charAt(p)===b&&(e++,e===d))return p;return-1};g.limitInputToNumbers=function(a){var b=a.$event.keyCode;-1!==e.inArray(b,[46,8,9,37,39])||-1!==e.inArray(b,[65,67,86])&&!0===a.ctrlKey||(a.$event.shiftKey||(48>b||57<b)&&
(96>b||105<b))&&a.$event.preventDefault()};g.nukeDropdowns=function(a){q.when("a-popover-base").execute(function(b){e.each(e(a),function(){b.remove(this.name)})})};var l={GURUPA:{type:"gurupa",validator:/.*\/gp\/buy\/.*/},CHEWBACCA:{type:"chewbacca",validator:/.*\/checkout\/p\/.*/},UNKNOWN:{type:"unknown"}};"function"===typeof Object.freeze&&Object.freeze(l);g.getUrlType=n;g.isChewbaccaUrl=function(a){return n(a)===l.CHEWBACCA.type};a.on("checkout:reload",function(){e('input[name\x3d"useLiveAUI"]').length||
a.defer(function(){e(".a-declarative, .a-button").filter("[data-action]").unbind("keypress.checkout-page").bind("keypress.checkout-page",function(a){13===a.which&&e(this).trigger("click")})})});a.on("checkout:beforeLoadPage",function(){e("div.a-popover").find(".a-declarative:first:[data-action\x3dcustom-popover-close|a-popover-close]").click()});return g});"use strict";q.when("A","weblab-helper").register("client-side-metrics",function(a,m){var n=a.$,e=null,g=null,l=0,h,b=a.capabilities&&a.capabilities.isAmazonApp||
r.amazon&&r.amazon.mash;a=function(){};var d=r.uet||a,k=r.uex||a,c=!1,p=!1,D=function(a){r.ue&&r.ue.t&&(r.uet(a,e),v("checkout:client-side-metrics:uet:marker:"+a,1,1),null===e&&null===g&&r.ue.isl&&(v("checkout:client-side-metrics:mark:at",1,1),r.uex("at")));"af"===a?c=!0:"fn"===a&&(p=!0)},u=function(a){r.ue&&r.uex&&(r.uex(a,e),v("checkout:client-side-metrics:uex:marker:"+a,1,1))},w=function(a){r.ue&&r.ues&&r.ues("id",e,a)},x=function(){r.ue&&r.ues&&r.ues("ctb",e,"1")},z=function(){r.ue&&r.ues&&(b&&
D("mts",e),r.ues("t0",e,(new Date).getTime()),D("ue"),D("bb"))},f=function(a){a?g="ctbajax"+l++:e="ajax"+l++};a=function(a){e=a};var t=function(){return e},J=function(){return g},v=function(a,b,c){"undefined"!==typeof r.ue&&"undefined"!==typeof r.ue.count&&(b=b?b:1,c?r.ue.count(a,(r.ue.count(a)||0)+1):r.ue.count(a,b))},C=function(a){if(a&&a.length){var b=e;e=g;w(a);e=b}},A=function(){h===H&&(h=0<n("#transitionLogging").length);return h},M=function(a,b,c,d){r.ueLogError&&r.ueLogError(a,{message:b,
attribution:c,logLevel:d})};return{getscope:t,getasyncscope:J,setmarker:D,sendue:u,setrid:w,setctb:x,resetue:z,createscope:f,setscope:a,getScope:t,getAsyncScope:J,setMarker:D,sendUe:u,setRid:w,setCtb:x,resetUe:z,createScope:f,setScope:a,increaseCount:v,resetMetrics:function(){e=g;x();z()},setAsyncRequestId:C,sendUEPageLoadStats:function(){!m.isCSMErrorLoggingEnabled()||c&&p||M({message:"Logged ld without both af and fn logged first af:"+c+" fn:"+p},"","checkout-client-side-metrics","WARN");m.isLogAFFNFallbackEnabled()&&
(!0===c&&v("checkout:client-side-metrics:page-load-stats:earlyaf",1),v("checkout:client-side-metrics:page-load-stats:af",1),D("af"));m.isLogAFFNFallbackEnabled()&&(!0===p&&v("checkout:client-side-metrics:page-load-stats:earlyfn",1),v("checkout:client-side-metrics:page-load-stats:fn",1),D("fn"));u("ld");f(1);p=c=!1},isTransitionLoggingEnabled:A,logPageTransition:function(a,b,c,d){if(A()){var f=(new Date).getTime();n.ajax({type:"POST",url:"/gp/buy/shared/handlers/log-page-transition.html?cachebuster\x3d"+
f,data:{fromPage:a,toPage:b},async:!0,cache:!1,timeout:1E3,success:function(a,b,d){var f=d.getResponseHeader("x-amz-checkout-requestid");C(f);c&&c.call(this,a,b,d)},complete:function(a,b){d&&d.call(this,a,b)}})}},logError:M,startWidgetTiming:function(a){d("bb",a,{wb:1})},finishWidgetTiming:function(a){k("ld",a,{wb:1})},setMarkerForWidget:function(a,b){d(a,b,{wb:1})},emitNexusMetrics:function(a,b,c){"undefined"!==typeof r.ue&&"undefined"!==typeof r.ue.event&&r.ue.event(a,b,c)},setCountValue:function(a,
b){v(a,b,!1)}}});"use strict";q.register("currency-formatter",function(){function a(m,n){isNaN(n)||(m=Number(m).toFixed(n));m=m.toString();n=0<=m.lastIndexOf(".")?m.lastIndexOf("."):m.length;return 3>=n?m:a(m.substring(0,n-3),0)+","+m.substring(n-3)}return{getNumberWithSeparators:a}});"use strict";q.when("A","client-side-metrics","page-conductor","page-detector").register("delivery-preferences-csm-helper",function(a,m,n,e){function g(a){var d=n.isSPP()?"spp":"mpp",g="desktop";e.isMobile()?g="mobile":
e.isTablet()&&(g="tablet");m.increaseCount("checkout:delivery-preferences:"+g+":"+d+":"+a,1)}function l(a){return 0===a.length?"NoValueSet":a}var h=a.$;return{recordCSM:g,recordCSMWithCurrentFieldValues:function(a,d,e){d=h("input[name\x3d"+d+"]:checked");d.length&&(d=d.val(),g(a+":preference:"+l(d)));e=h("input[name\x3d"+e+"]");e.length&&g(a+":set-as-default:"+(e.is(":checked")?"yes":"no"))},recordCSMForEligiblePages:function(a){a=a||"";g(a+"eligible-page-displayed");var d=h("input[name\x3ddelivery-preferences-preference-set]");
d.length&&g(a+"summary-displayed:preference:"+l(d.val()))}}});"use strict";q.when("A").register("error-feature-detection",function(a){function m(a){r.errorFeatureDetection&&r.errorFeatureDetection.safelyLogError?r.errorFeatureDetection.safelyLogError(a):(r.ueLogError&&r.ueLogError(a),r.console&&r.console.error&&console.error(a))}try{a.on("page-detector:page-changed",function(){q.now("page-detector-current-page").execute(function(a){if((a=a.getCurrentPage())&&"spc"===a)try{r.errorFeatureDetection&&
r.errorFeatureDetection.enableErrorHandling&&r.errorFeatureDetection.enableErrorHandling()}catch(e){m(e)}else try{r.errorFeatureDetection&&r.errorFeatureDetection.disableErrorHandling&&r.errorFeatureDetection.disableErrorHandling()}catch(e){m(e)}})})}catch(n){m(n)}return{registerFeature:function(a,e){try{r.errorFeatureDetection&&r.errorFeatureDetection.registerFeature&&r.errorFeatureDetection.registerFeature(a,e)}catch(g){m(g)}},markFeatureAvailable:function(a){try{r.errorFeatureDetection&&r.errorFeatureDetection.markFeatureAvailable&&
r.errorFeatureDetection.markFeatureAvailable(a)}catch(e){m(e)}},markFeatureUnavailable:function(a){try{r.errorFeatureDetection&&r.errorFeatureDetection.markFeatureUnavailable&&r.errorFeatureDetection.markFeatureUnavailable(a)}catch(e){m(e)}}}});q.when("error-feature-detection").execute(function(a){a.registerFeature("continue-action",0);a.markFeatureAvailable("javascript-detection");a.markFeatureAvailable("continue-action")});"use strict";q.when("A","page-transition-controller").execute(function(a,
m){a=a.$;"1"===a("#showSpinnerOnProceedToCheckout").attr("content")&&(m.show(),q.when("ready").execute(function(){m.hide()}))});"use strict";q.when("A","loading-spinner-controller","ajax-utility","currency-formatter","page-conductor","page-transition-controller").register("inline-points-register-controller",function(a,m,n,e,g,l){function h(a){var b=new RegExp(String.fromCharCode(65340),"g"),c=new RegExp(String.fromCharCode(92,92,92,92),"g");a=a.replace(b,String.fromCharCode(92),"g");a=a.replace(c,
String.fromCharCode(92));a=a.replace(/\\1/g,String.fromCharCode(34));return a=a.replace(/\\2/g,String.fromCharCode(10))}function b(a){var b=u.$popover.find(".rewards-registration");m.hideSpinner(b);b.children("div").hide();b=b.find(".rewards-registration-error");a&&a.error?(a=b.find("[data-error\x3d'"+a.error+"']"),a.length?a.show():b.find("[data-error\x3d'rewards_SystemUnavailable']").show()):b.find("[data-error\x3d'rewards_SystemUnavailable']").show();b.fadeIn(300)}function d(a){u=a.popover;var c=
u.$popover.find(".rewards-registration");m.showSpinner(c,!1,u);a=c.data("issuer-id");var d=c.data("program-id"),e=c.data("cc-issuer"),p=c.data("cc-brand"),c=c.data("parent-payment-method-id"),g="/gp/buy/payselect/handlers/get-rewards-configuration.html?cachebuster\x3d"+(new Date).getTime();D.ajax({type:"POST",url:g,data:"programid\x3d"+d+"\x26partner\x3d"+a+"\x26ccpaymentinstrumentid\x3d"+c+"\x26issuer\x3d"+e+"\x26brand\x3d"+p+"\x26hasWorkingJavascript\x3d1",dataType:"text",async:!0,cache:!1,dataFilter:function(a){return n.jsonify(a)},
success:function(a,b,c){b=u.$popover.find(".rewards-registration");m.hideSpinner(b);c=a.fields||{};for(var d in c)if(c.hasOwnProperty(d)){var e=c[d],f=b.find("[data-field\x3d'"+e.type+"']");e.value&&f.filter("input").attr("value",e.value);f.parents(".rewardsfield").show()}a.termshtml&&b.find(".rewardstermstext").html(h(a.termshtml));a.billingzip&&b.find("[data-field\x3dBILLING_POSTAL_CODE]").attr("value",a.billingzip);if(a.displaydata){d=b.find("[data-field]");for(var p in a.displaydata)a.displaydata.hasOwnProperty(p)&&
d.filter("[data-field\x3d"+p+"]").html(a.displaydata[p])}a.marketinglink&&b.find("[data-field\x3d'rewards_marketing_link']").html(a.marketinglink);b.find("#rewards-registration-image").show();b.find(".rewards-registration-main").fadeIn(300);u.updatePosition(!0)},error:function(a){b(a)}})}function k(){if(u){var a=u.$popover.find(".rewards-registration");m.hideSpinner(a);a.find(".rewards-registration-success").hide();a=a.find(".rewards-registration-error");a.hide();a.find("h4").hide();w&&(l.show(),
g.isSPP()?g.reloadPage():D("div.pay").length?g.loadPage("payselect","payselect"):D("div.spc").length&&g.loadPage("spc","spc"))}}function c(a){return a.is("input")?a:a.find("input")}function p(){if(u){var a=u.$popover.find(".rewards-registration");a.find(".rewards-registration-main").hide();a.find("#rewards-registration-image").hide();m.showSpinner(a,!1,u);var d=(new Date).getTime(),f="programid\x3d"+encodeURIComponent(a.data("programId")),f=f+("\x26paymentinstrumentid\x3d"+encodeURIComponent(a.data("parent-payment-method-id"))+
"\x26hasWorkingJavascript\x3d1\x26returnjson\x3d1\x26cachebuster\x3d"+d),p=a.find("[data-field]");p.each(function(){var a=D(this).attr("data-field");if("CVV2"===a)f+="\x26registerRewardsCreditCardVerificationNumber\x3d"+encodeURIComponent(D(this).val());else if(D(this).data("entryindex")){if(1===D(this).data("entryindex")){var b=p.filter("[data-field\x3d"+a+"]").sort(function(a,b){return Number(D(a).data("entryindex"))-Number(D(b).data("entryindex"))});f+="\x26"+a+"\x3d";b.each(function(){f+=encodeURIComponent(D(this).val())})}}else"TERMS_AND_CONDITIONS"===
a?c(D(this)).is(":checked")&&(f+="\x26"+a+"\x3dtrue"):f+="\x26"+a+"\x3d"+encodeURIComponent(D(this).val())});d="ox_pay_page_swp_reg_popover_submit";a.data("programId")&&(d+="_"+a.data("programId"));a="/gp/buy/payselect/handlers/register-rewards-account.html/ref\x3d"+d+"?cachebuster\x3d"+(new Date).getTime();D.ajax({type:"POST",url:a,data:f,dataType:"text",async:!0,cache:!1,dataFilter:function(a){return n.jsonify(a)},success:function(a,c,d){a?a&&0===a.success?b(a):u&&(c=u.$popover.find(".rewards-registration-success"),
c.find(".customername").text(a.customername),a.dollarbalancedisplay&&a.pointsbalance&&(c.find("[data-field\x3d'rewardsamount']").html(a.dollarbalancedisplay),c.find("[data-field\x3d'pointsamount']").html(e.getNumberWithSeparators(a.pointsbalance,a.rewardsdecimalplaces)),c.find(".rewardsuccessbalance").show()),a.showwarnmessage&&c.find(".warnmessage").show(),w=!0,c.fadeIn(300),m.hideSpinner(u.$popover.find(".rewards-registration"))):b()},error:function(a){b(a)}})}}var D=a.$,u,w=!1;a.on("a:popover:show:rewards-registration",
d);a.on("a:popover:hide:rewards-registration",k);a.declarative("close-rewards",["click"],function(a){a.$event.preventDefault();a.$target.closest(".a-popover").find(".a-button-close").trigger("click")});a.declarative("rewards-signup",["click"],function(a){a.$event.preventDefault();p(a)});a.declarative("toggle-reward-signup-button","change",function(a){a=a.$target;var b=u.$popover.find(".rewards-registration");a&&a.is(":checked")?(b.find("#reward-signup-button").removeClass("aok-hidden"),b.find("#disabled-reward-signup-button").addClass("aok-hidden")):
(b.find("#reward-signup-button").addClass("aok-hidden"),b.find("#disabled-reward-signup-button").removeClass("aok-hidden"))});a.on("a:popover:beforeShow:cvv2helpcontent",function(a){a.popover.$popover.find(".a-popover-inner").html(D(".cvv2helpcontent").text());a.popover.updatePosition()});return{displayRewardsRegister:d,hideRewardsRegister:k}});"use strict";q.when("A","error-feature-detection","safe-mash","ready").register("shared-kitchensink",function(a,m,n){var e=a.$;a.on("checkout:reload",function(){(e("body.a-touch").length||
e("div.a-touch:first").length)&&e("html").addClass("a-touch");e("form").each(function(){var a=e(this).find('input[name\x3d"hasWorkingJavascript"]');a&&0<a.length?a.val("1"):e(this).append('\x3cinput type\x3d"hidden" name\x3d"hasWorkingJavascript" value\x3d"1" /\x3e')});n&&(e("div.checkout-tablet a[target\x3d'AmazonHelp']").each(function(){var a=e(this).attr("href"),a=a+(0<=a.indexOf("?")?"\x26app-nav-type\x3dmodal":"?app-nav-type\x3dmodal"),a=a.replace("#","");e(this).attr("href",a);e(this).removeAttr("data-action");
e(this).removeAttr("data-help-popup");e(this).removeAttr("onclick")}),e("div.checkout.mobile a[target\x3d'AmazonHelp']").each(function(){var a=e(this).attr("href"),a=a.replace("#","");e(this).attr("href",a);e(this).removeAttr("data-help-popup");e(this).removeAttr("onclick");e(this).addClass("a-declarative help-popup");e(this).attr("data-action","help-popup")}));if(0<e("div.checkout-tablet").length)for(var a=document.getElementsByTagName("a"),l=0;l<a.length;l++)a[l].href||(a[l].href="#")});e(document).bind("jsdetection",
function(){m.markFeatureAvailable("javascript-detection")})});q.when("A","safe-mash","ready").execute(function(a,m){var n=a.$;a.declarative("mash-navigate",["click"],function(a){a=a.$currentTarget.attr("href");m&&m.navigate?m.navigate({url:a}):r.location.href=a});a.declarative("expander-scroll-there",["click"],function(a){if("false"!==a.$currentTarget.closest(".a-expander-container").find(".a-expander-content").attr("aria-expanded")){var g=n(r),l=n(document),h=a.$currentTarget.offset().top,b=0,d=
0,k=function(){r.setTimeout(function(){g.scrollTop(h);b===l.height()?d++:(d=0,b=l.height());10>d&&k()},10)};k()}})});r.amz_js_PopWin=function(a,m,n){(a=r.open(a,m,n))&&a.focus&&a.focus();return!1};var ta=!1;r.confirmPurchase_onSubmit||(r.confirmPurchase_onSubmit=function(){return ta?!1:ta=!0});"use strict";q.when("A","error-feature-detection","loading-spinner-spp-controller","loading-spinner-aui-controller").register("loading-spinner-controller",function(a,m,n,e){function g(){return b("#checkout-spinner").length}
function l(a){if(d&&k){var e,p,g;D&&x?(a=D.getContent(),e=a.innerHeight(),p=a.innerWidth()):(e=a.height(),p=a.width());g=a.offset();a=k.width();var l=k.height();if(c)g="1"===b("input[name\x3dfromAnywhere]").val()?b(document).height():b(r).height(),d.width(b(document).width()).height(g).css("left","0px").css("z-index",2E3),k.css("left",p/2-a/2+"px").css("top",e/2-l/2+"px").css("z-index",4E3).show();else{var h=b(r),n=x?h.scrollLeft():0;d.css("position","fixed").width(p).height(e).css("z-index",3E3).css("left",
g.left-n).css("top",g.top-h.scrollTop());u?k.css("position","fixed").css("left",g.left-n+(p/2-a/2)+"px").css("top",g.top-h.scrollTop()+(e/2-l/2)+"px").css("z-index",4E3).show():k.css("left",p/2-a/4+"px").css("top",e/2-l/4+"px").css("z-index",4E3).show()}}}function h(){var a="https://images-na.ssl-images-amazon.com/images/G/01/amazonui/loading/loading-4x._V391853216_.gif",c=b("#first-pipeline-load-page-spinner-img");c.length&&(a=b.trim(c.attr("src")));1>b("#loading-spinner-blocker-doc").length&&(a=
b(['\x3cdiv class\x3d"template loading-spinner" style\x3d"display:none"\x3e\x3cdiv class\x3d"loading-spinner-blocker"\x3e\x3c/div\x3e\x3cdiv class\x3d"loading-spinner-inner"\x3e','\x3cimg id\x3d"loading-spinner-img" class\x3d"loading-spinner-img" src\x3d"'+a+'"/\x3e','\x3c/div\x3e\x3c/div\x3e\x3cdiv id\x3d"loading-spinner-blocker-doc" class\x3d"loading-spinner-blocker" style\x3d"display:none;"\x3e\x3c/div\x3e\x3cdiv id\x3d"spinner-anchor" class\x3d"spinner-anchor" style\x3d"display:none"\x3e\x3c/div\x3e'].join("")),
k=d=p=null,"1"===b("#showSpinnerWithoutBox").attr("content")&&a.find(".loading-spinner-inner").addClass("loading-spinner-inner-no-box"),b("body").prepend(a));b("input[name\x3duseModifiedSpinnerResizeFn]").length&&(u=!0);b("#useRelativeSpinner").length&&(w=!0);b("#modifiedBlockerDivSize").length&&(x=!0)}var b=a.$,d,k,c,p,D,u=!1,w=!1,x=!1,z=!1;a.on("a:popover:positionUpdated",function(a){if(x&&D&&D.name===a.popover.name&&d&&k){var c=D.getContent();a=c.innerHeight();var e=c.innerWidth(),c=c.offset(),
p=b(r);d.width(e).height(a).css("left",c.left-p.scrollLeft()).css("top",c.top-p.scrollTop());k.css("left",c.left-p.scrollLeft()+(e/2-k.width()/2)+"px").css("top",c.top-p.scrollTop()+(a/2-k.height()/2)+"px")}});h();a.on("checkout:reload",h);return{showSpinner:function(a,t,h){if(w&&!t&&x&&u&&h)return z=!0,n.showSpinner(a,h);g()?e.showSpinner():(z=!1,0!==a.length&&(D=(c=t)?H:h,p||(p=b(".loading-spinner.template").clone().removeClass("template"),p.show()),a.append(p),c?(d=b("#loading-spinner-blocker-doc"),
a.find(".loading-spinner-blocker").hide()):d=a.find(".loading-spinner-blocker"),d.show(),c&&m.markFeatureUnavailable("continue-action"),k=a.find(".loading-spinner-inner"),l(a)))},hideSpinner:function(a,b){if(g())return e.hideSpinner();if(z)return z=!1,n.hideSpinner(a,b);z=!1;d&&(c&&(d.hide(),m.markFeatureAvailable("continue-action")),p.detach());b&&a.hide()},adjustSize:function(a){return g()?e.adjustSize():z?n.adjustSize():l(a)}}});"use strict";q.when("A","error-feature-detection").register("loading-spinner-spp-controller",
function(a,m){function n(){if(g&&l){var a=b.innerHeight(),c=b.innerWidth();g.width(c).height(a);l.css("left",c/2-l.width()/2+"px").css("top",a/2-l.height()/2+"px")}}var e=a.$,g,l,h,b,d;a.on("a:popover:positionUpdated",function(a){d&&d.name===a.popover.name&&n()});a.on("checkout:reload",function(){var a="https://images-na.ssl-images-amazon.com/images/G/01/amazonui/loading/loading-4x._V391853216_.gif",b=e("#first-pipeline-load-page-spinner-img");b.length&&(a=e.trim(b.attr("src")));1>e(".loading-spinner-spp").length&&
(a=e(['\x3cdiv class\x3d"template loading-spinner-spp" style\x3d"display:none"\x3e\x3cdiv class\x3d"loading-spinner-spp-blocker"\x3e\x3c/div\x3e\x3cdiv class\x3d"loading-spinner-spp-inner"\x3e','\x3cimg class\x3d"loading-spinner-spp-img" src\x3d"'+a+'"/\x3e',"\x3c/div\x3e\x3c/div\x3e"].join("")),l=g=h=null,"1"===e("#showSpinnerWithoutBox").attr("content")&&a.find(".loading-spinner-inner").addClass("loading-spinner-inner-no-box"),e("body").prepend(a))});return{showSpinner:function(a,c){0!==a.length&&
(d=c,b=a,h||(h=e(".loading-spinner-spp.template").clone().removeClass("template"),h.show()),c.getContent().before(h),b.prepend(h),g=b.find(".loading-spinner-spp-blocker"),g.show(),l=b.find(".loading-spinner-spp-inner"),n())},hideSpinner:function(a,b){g&&h.detach();b&&a.hide()},adjustSize:n}});"use strict";q.when("A","error-feature-detection").register("loading-spinner-aui-controller",function(a,m){function n(){return e("#checkoutDisplayPage").outerHeight()}var e=a.$;return{showSpinner:function(){m.markFeatureUnavailable("continue-action");
var g=e("#checkout-spinner");a.show(e("#checkout-spinner-overwrap").height(n()));g.attr("aria-busy","true");a.show(g)},hideSpinner:function(){m.markFeatureAvailable("continue-action");var g=e("#checkout-spinner");a.hide(e("#checkout-spinner-overwrap"));g.attr("aria-busy","false");a.hide(g)},adjustSize:function(){var g=e("#checkout-spinner-overwrap");g.is(":visible")&&a.show(g.height(n()))}}});"use strict";q.when("A","page-transition-controller","ajax-utility","page-detector-current-page","checkout-general-utils",
"client-side-metrics","safe-mash","cache-page-data-controller","ajax-wrapper","widget-streamer","widget-streamer-utils","weblab-helper","payment-marketplace-helper","pipeline-dispatch-endpoint").register("page-conductor",function(a,m,n,e,g,l,h,b,d,k,c,p,D,u){function w(a){r.ueLogError&&r.ueLogError({message:a},{logLevel:"WARN",attribution:"CheckoutCommonAsset-PageConductor"})}function x(a){ka&&(a?(a["x-amz-checkout-transition"]||(a["x-amz-checkout-transition"]="ajax"),a["x-amz-checkout-type"]||(a["x-amz-checkout-type"]=
"spp")):a={"x-amz-checkout-transition":"ajax","x-amz-checkout-type":"spp"});p.isPipelineDispatchSendHeaderEnabled()&&(a?a["x-amz-checkout-transition"]||(a["x-amz-checkout-transition"]="ajax"):a={"x-amz-checkout-transition":"ajax"});return a}function z(){la=!1;fa=null;ja=0;sa=!1;Q=Ca=ga=null}function f(a){var b=parseInt(E("#checkoutDisplayPage").data("delaySetTitle"),10)||0;b?r.setTimeout(function(){document.title=a},b):document.title=a}function t(b){"function"===typeof a.state.parse&&a.state.parse();
a.trigger("checkout:beforeReload");a.trigger("checkout:reload");b&&("spp-revieworder"===b?a.trigger("checkout:reload:spc"):a.trigger("checkout:reload:"+b));a.trigger("checkout:afterReload")}function J(a){m.show();var b="/gp/buy/addtocart/handlers/display.html";a&&(b+="?errorType\x3d"+a);r.location=b}function v(b){(b=E("#pageTypeRedirectedTo").text())&&a.trigger("checkout:reload:"+b)}function C(b,c){var d;if(c.getResponseHeader("x-amz-force-full-page-update"))A(b);else{if(c.getResponseHeader("x-amz-checkout-redirect-addtocart")){(c=
n.jsonify(b))?J(c.errorCode):J();return}d=ua(b)}b=E("#pipelinedPageTitle").text();f(b);var e=c.getResponseHeader("x-amz-checkout-page");ka?a.delay(function(){t(e)},d):t(e)}function A(a){var b=document.open("text/html","replace");b.write(a);b.close()}function M(a,b,c){try{if(b.getResponseHeader("x-amz-force-full-page-update"))A(a);else{if(!va)throw Error("Member _updateDisplayPageContent not set in page-conductor. Make sure 'initFunc' is called.");va(a,c)}}catch(d){a="Error while replacing page content.",
d.message&&(a+="  Error message: "+d.message),q.error(a,"page-conductor","replaceDisplayPage",d)}a=E("#pipelinedPageTitle").text();f(a);b=b.getResponseHeader("x-amz-checkout-page");t(b)}function S(a){var b=parseInt(E("#showPageTransition").attr("content"),10);(b=isNaN(b)?1:b)||m.hide();b="/gp/buy/shared/handlers/dispatch.html";a&&(a.conductoraction&&a.conductoraction.url?b=a.conductoraction.url:a.pipedata&&a.pipedata.conductoraction&&a.pipedata.conductoraction.url&&(b=a.pipedata.conductoraction.url));
b=0<b.indexOf("?")?b+"\x26":b+"?";E("input[name\x3dfromAnywhere][value\x3d1]").length&&(b+="fromAnywhere\x3d1");b=ba(b);h&&E("html").hasClass("a-tablet")&&-1<b.indexOf("/gp/cart/view.html")&&(b="/gp/aw/c?app-action\x3dcart");r.location=b}function P(a,c,d,e,f){e=e||{};e.pushNewFrame=e.pushNewFrame||"true";e.anchor=e.anchor||H;z();"true"===e.pushNewFrame&&h&&h.navigate&&E("#checkoutDisplayPage").data("useMashNavigateForTransitions")?h.navigate({url:null,transitionEffect:"slide",successCallback:function(){V(a,
c,d,e,f)},failCallback:function(a){}}):V(a,c,d,e,f);e.keepCachedPagesData||b.clearCache()}function G(){var a=E("input#isPipelinedPage");return g.isChewbaccaUrl()||0<a.length&&"1"===a.val()}function L(a){return p.isExecutionIdInQueryStringEnabled()?a?a.getResponseHeader("x-amz-checkout-executionid"):g.getQueryStringParameter(r.location.href,"executionId"):E("input#executionId").val()}function V(b,d,f,k,h){function m(a){var b=f.getResponseHeader(a);null==b&&(l.increaseCount("Checkout:PageConductor:Ajax:Update:MissingHeader"),
l.increaseCount("Checkout:PageConductor:Ajax:Update:MissingHeader:"+a),w("performUpdatePageFromResponse is missing required header "+a));return b}function A(a){var b=/^\s*\<(?:!doctype|html)/;if("string"===typeof a&&a.match(b)){var b=(new DOMParser).parseFromString(a,"text/html"),c=E(b).find("#checkoutDisplayPage");if(0<c.length)return l.increaseCount("Checkout:PageConductor:Ajax:Update:CenterContentExtracted"),c[0].outerHTML;b=E(b).find("body");if(0<b.length)return l.increaseCount("Checkout:PageConductor:Ajax:Update:BodyExtracted"),
b[0].outerHTML}return a}k=k||{};k.pushNewFrame=k.pushNewFrame||"true";k.anchor=k.anchor||H;k.mixedContentFallback=k.mixedContentFallback||"fallback";var D=m("x-amz-checkout-page"),z=m("x-amz-checkout-requestid"),u=e.getCurrentPage();e.setCurrentPage(D);if(k.freshLoad)k.freshLoad=!1,q.when("first-load-dependencies").execute(function(a){V(b,d,f,k)});else if(D){E("head .aui-page-asset").removeAttr("disabled");E("head .old-pipeline-asset").removeAttr("disabled");l.setAsyncRequestId(z);var ea=f.getResponseHeader("x-amz-checkout-redirect");
if(ea)S({conductoraction:{url:ea,type:"redirect"}});else{if(p.isPageConductorConvergenceEnabled()){if(g.isChewbaccaUrl(document.location.pathname)&&"reload"==k.mixedContentFallback){l.increaseCount("Checkout:PageConductor:mixedContentFallback:"+k.mixedContentFallback);location.reload();return}}else wa(b)&&oa(k);p.isIngressEnabled()&&(b=A(b));if(p.isAJAXWeblabOn()&&c.isStreamingAjax(f))p.isAjaxStreamingEnabled()?t(D):(v(f),T(b,D));else if(a.trigger("checkout:unload"),0<E("#checkoutDisplayPage").length?
M(b,f,D!==u):C(b,f),p.isAjaxStreamingEnabled()&&G()){var u=E("#pipelinedPageTitle").text(),ea=m("x-amz-checkout-url"),ma=f.getResponseHeader("x-amz-checkout-additional-page-args");X(D,u,ea,L(f),ma,k.anchor,k.pushNewFrame)}!p.isAjaxStreamingEnabled()&&G()&&(u=E("#pipelinedPageTitle").text(),ea=m("x-amz-checkout-url"),ma=f.getResponseHeader("x-amz-checkout-additional-page-args"),X(D,u,ea,L(f),ma,k.anchor,k.pushNewFrame));ka||I(D);k.anchor&&(D=E(k.anchor),0===D.length&&(D=k.anchor.replace("#",""),D=
E(document.getElementsByName(D))),D.length&&E(document).scrollTop(D.offset().top));k.logUsedPrefetch&&q.when("action-logger").execute(function(a){a.logUsedPrefetch(m("x-amz-checkout-page-type"),m("x-amz-checkout-sub-page-type"),z,h)})}}else{if(r.getOldAjaxSuccessCallback)return r.getOldAjaxSuccessCallback("ajaxConductor","generalErrorHandling","generalErrorHandling")(b,d,f);b=n.jsonify(b);S(b)}}function X(a,b,c,d,e,f,k){b&&c&&r.history&&r.history.pushState&&(p.isExecutionIdInQueryStringEnabled()?
"true"!==k||history.state&&history.state.page===a||(c=ba(c),f&&(c+=f),d&&(c=g.addQueryStringParameterOrDeleteIfEmpty(c,"executionId",d)),history.pushState({page:a,additionalURLArgs:e},b,c)):(c=ba(c),f&&(c+=f),d&&(c=g.addQueryStringParameter(c,"executionId",d)),"true"===k&&history.state&&history.state.page!==a&&history.pushState({page:a,additionalURLArgs:e},b,c)))}function I(a){var b=E("#checkoutDisplayPage");if(b.length){var c=0<=document.location.search.indexOf("pipelineType\x3dChewbacca")?"multi-page-pipeline-chewbacca":
ka?"single-page":"multi-page";b.attr({"data-checkout-pipeline":c,"data-checkout-page":a||""})}}function T(a,b){a.executeActions();a=E("#pipelinedPageTitle").text();f(a);t(b)}function U(){r.location=O?"/gp/buy/addtocart/handlers/display.html":"/gp/buy/payselect/handlers/error.html"}function W(b,e,f,k,l,t){k=k||{};k.refTag=k.refTag||"";k.pushNewFrame=k.pushNewFrame||"true";k.anchor=k.anchor||H;k.refTag&&0!==k.refTag.indexOf("/ref\x3d")&&(k.refTag="/ref\x3d"+k.refTag);var h="";p.isPageConductorConvergenceEnabled()&&
l&&g.isChewbaccaUrl(l)||(h="fromPage\x3d"+b+"\x26page\x3d"+e);(b=L(t))&&(h+="\x26executionId\x3d"+b);f&&(h+="\x26"+f);e=u.get(l||"/gp/buy/shared/handlers/pipeline-dispatch.html",{nextPage:e});p.isPageConductorConvergenceEnabled()&&g.isChewbaccaUrl(e)||(e+=k.refTag);f=function(){};l=function(){};"function"===typeof k.resultscallback?(b=function(a,b,c){k.resultscallback(a,b,c)},t=function(a,b,c){k.resultscallback(H,b,a)}):(f=function(b){a.trigger("checkout:beforeLoadPage");qa&&qa.abort();qa=b},b=function(a,
b,d){p.isAJAXWeblabOn()&&c.isStreamingAjax(d)||k.callbackBeforePageUpdate&&k.callbackBeforePageUpdate();P(a,b,d,k);k.callbackAfterPageUpdate&&k.callbackAfterPageUpdate()},t=function(a,b,c){"abort"!==b&&("error"===b&&a.readyState===d.READY_STATE.UNSET?q.when("a-tv","mash").execute(function(a,b){r.cordova.exec(null,null,"MASHDisplayErrorPlugin","execute",{})}):(Y(a,b),U()))},l=function(a){qa=null});h={type:"GET",url:e,data:h,dataType:"text",async:!0,beforeSend:f,success:b,error:t,complete:l,cache:!1};
if(ka||p.isPipelineDispatchSendHeaderEnabled())h.headers=x({"x-amz-checkout-transition":"ajax"});B(h);return p.isAJAXWeblabOn()?(h.useXMLHttp=!0,h=p.isAjaxStreamingEnabled()?aa(h,k.callbackBeforePageUpdate,k.anchor,k.pushNewFrame):aa(h,k.callbackBeforePageUpdate),d.aui(h)):E.ajax(h)}function aa(b,d,g,l){b.timeout=5E4;b.data=ha(b.data,"acceptsStreaming\x3d1");var t=b.data.match(/.*isAsync=1.*/)?!0:!1;Da=k({$target:E("#checkoutDisplayPage"),updateTriggerEvent:"pageReady",immediateExecution:!t,updateTarget:E("#checkoutDisplayPage"),
onUpdate:function(b){"function"===typeof d&&d();a.trigger("checkout:unload");f(b.title);X(b.page,b.title,b.url,b.executionId,b.additionalURLArgs,g,l||"true");e.setCurrentPage(b.page)}});b.chunk=Da.chunkHandler;if(!p.isAjaxStreamingEnabled()){var h=b.success;b.success=function(a,b,d){h&&c.isStreamingAjax(d)?h(Da,b,d):h&&h(a,b,d)}}return b}function ha(a,b){return a?a+"\x26"+b:b}function B(a){if(a.data.match(/.*isAsync=1.*/))return a.headers?a.headers["x-amzn-tiertwo"]="yes":a.headers={"x-amzn-tiertwo":"yes"},
l.increaseCount("Checkout:PageConductor:Prefetch:Tagging:T"),!0;l.increaseCount("Checkout:PageConductor:Prefetch:Tagging:C");return!1}function Y(a,b){l.increaseCount("Checkout:PageConductor:Ajax:Error");p.isAJAXWeblabOn()?(a?(l.increaseCount("Checkout:AUI:Ajax:jqXHR:defined"),w("jqXHR defined throw CheckoutErrorAW under AJAX Weblab, textStatus:"+b+" stateCode:"+a.state+" readyState:"+a.readyState)):a===H?(l.increaseCount("Checkout:AUI:Ajax:jqXHR:undefined"),w("jqXHR undefined throw CheckoutErrorAW under AJAX Weblab")):
null===a&&(l.increaseCount("Checkout:AUI:Ajax:jqXHR:null"),w("jqXHR null throw CheckoutErrorAW under AJAX Weblab")),l.increaseCount("Checkout:AUI:Ajax:Error:textStatus:"+b),l.increaseCount("Checkout:AUI:Ajax:Error:statusCode:"+a.status),l.increaseCount("Checkout:AUI:Ajax:Error:readyState:"+a.readyState)):(a?(l.increaseCount("Checkout:jQuery:Ajax:jqXHR:defined"),w("jqXHR defined throw CheckoutErrorAW using jQuery, textStatus:"+b+" stateCode:"+a.state+" readyState:"+a.readyState)):a===H?(l.increaseCount("Checkout:jQuery:Ajax:jqXHR:undefined"),
w("jqXHR undefined throw CheckoutErrorAW using jQuery")):null===a&&(l.increaseCount("Checkout:jQuery:Ajax:jqXHR:null"),w("jqXHR null throw CheckoutErrorAW using jQuery")),l.increaseCount("Checkout:jQuery:Ajax:Error:textStatus:"+b),l.increaseCount("Checkout:jQuery:Ajax:Error:statusCode:"+a.status),l.increaseCount("Checkout:jQuery:Ajax:Error:readyState:"+a.readyState))}function Z(a,b,c,e){var f=a;b=ha(b,"isClientTimeBased\x3d1");var k;if(p.refactorExtractURL()){k=g.extractURLParts(a);a=k.normalizedUrl;
if(!a)return l.increaseCount("Checkout:PageConductor:submitAjax:url:missingHtml:T1"),w("Unable to normalize url ["+f+"]. Ajax request aborted."),!1;var t=a.indexOf("/gp/buy/");0<t?(a=a.substring(t),l.increaseCount("Checkout:PageConductor:submitAjax:url:removedGpBuy:T1")):l.increaseCount("Checkout:PageConductor:submitAjax:url:missingGpBuy:T1");k.query?(b+="\x26"+k.query,l.increaseCount("Checkout:PageConductor:submitAjax:url:hasQueryPart:T1")):l.increaseCount("Checkout:PageConductor:submitAjax:url:missingQueryPart:T1");
k=k.refMarker;k||(l.increaseCount("Checkout:PageConductor:submitAjax:url:missingRefMarker:T1"),k="");k&&-1===k.indexOf("ref\x3d")&&(l.increaseCount("Checkout:PageConductor:submitAjax:url:refMarkerMalformed:T1"),k="")}else{var h=a.indexOf("?");0<h?(t=a,b+="\x26"+a.substring(h+1),a=a.substring(0,h),h=g.buildFilteredQueryString(t,Ja),""===h?l.increaseCount("Checkout:PageConductor:submitAjax:url:hasNoAllowlistedQueryParameter"):l.increaseCount("Checkout:PageConductor:submitAjax:url:hasAllowlistedQueryParameter"),
a+=h,l.increaseCount("Checkout:PageConductor:submitAjax:url:hasQueryPart:C")):l.increaseCount("Checkout:PageConductor:submitAjax:url:missingQueryPart:C");t=a.indexOf("/gp/buy/");0<t?(a=a.substring(t),l.increaseCount("Checkout:PageConductor:submitAjax:url:removedGpBuy:C")):l.increaseCount("Checkout:PageConductor:submitAjax:url:missingGpBuy:C");if(h=g.isChewbaccaUrl(a))a=a.slice(a.indexOf("/checkout/p/p-")),l.increaseCount("Checkout:PageConductor:submitAjax:url:chewbacca:C");else{if(-1===a.indexOf(".html"))return l.increaseCount("Checkout:PageConductor:submitAjax:url:missingHtml:C"),
w("url ["+f+"] is missing html extension and not a chewbacca call. Ajax request aborted."),!1;f=a.indexOf(".html");k=a.substring(f+5);a=a.substring(0,f+5)}k||l.increaseCount("Checkout:PageConductor:submitAjax:url:missingRefMarker:C");k&&-1===k.indexOf("ref\x3d")&&(l.increaseCount("Checkout:PageConductor:submitAjax:url:refMarkerMalformed:C"),k="")}b+="\x26handler\x3d"+a;f="";f=u.get(h?a:"/gp/buy/shared/handlers/async-continue.html"+k);a={type:"POST",url:f,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
headers:x({"x-amz-checkout-transition":"ajax"}),data:b,dataType:"text",async:!0,success:c,error:function(a,b,c){"abort"!==b&&("error"===b&&a.readyState===d.READY_STATE.UNSET?q.when("a-tv","mash").execute(function(a,b){r.cordova.exec(null,null,"MASHDisplayErrorPlugin","execute",{})}):"function"===typeof e&&(Y(a,b),e()))},cache:!1};B(a);return p.isAJAXWeblabOn()?(a.useXMLHttp=!0,aa(a),d.aui(a)):E.ajax(a)}function y(a,b,c,d,e){e=e&&e.action?e.action:a.attr("action");a=a.serialize();d&&(a+="\x26isAsync\x3d1");
return Z(e,a,b,c)}function ca(a,b,c,d){a=ba(a.attr("href"));d&&(a+="\x26isAsync\x3d1");return Z(a,"",b,c)}function da(a){a=a||{};a.logUsedPrefetch=1;P(fa.data,fa.status,fa.response,a,fa.refMarker)}function ba(a){-1===a.toLowerCase().indexOf("hasworkingjavascript")&&(a+=(0<=a.indexOf("?")?"\x26":"?")+"hasWorkingJavascript\x3d1");return a}function ma(a){sa=!1;var b=e.getCurrentPage(),c=Q-Ca,d=ja,f=a.data("pushNewFrame"),k=function(a,b,c){"boolean"===typeof f&&!1===f?P(a,b,c,{pushNewFrame:"false"}):
P(a,b,c)};ia&&clearTimeout(ia);if(a.is("form"))N(a)?(da(),l.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+d+":Success"),l.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+d+":TimeSaved",c)):(p.isPageConductorConvergenceEnabled()?y(a,k,U):y(a,P,U),l.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+d+":Failure:Invalid"));else if(a.is("a"))if(ra(a)){var g;1===parseInt(a.data("keepCachedPagesData"),10)&&(g={keepCachedPagesData:1});da(g);l.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+
d+":Success");l.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+d+":TimeSaved",c)}else p.isPageConductorConvergenceEnabled()?ca(a,k,U):ca(a,P,U),l.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+d+":Failure:Invalid");else l.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+d+":Failure:NoTrigger"),q.error("function called without a trigger","page-conductor","handleContinueAction")}function N(a){return a.is("form")&&null!==fa&&fa.serializedValue===a.serialize()}function ra(a){return a.is("a")&&
null!==fa&&ba(fa.serializedValue)===ba(a.attr("href"))}function oa(a){"reload"==a.mixedContentFallback?(l.increaseCount("Checkout:PageConductor:mixedContentFallback:"+a.mixedContentFallback),location.reload()):"fallback"==a.mixedContentFallback?(l.increaseCount("Checkout:PageConductor:mixedContentFallback:"+a.mixedContentFallback),S({conductoraction:{url:"/gp/buy/spc/handlers/display.html?_from\x3dcheetah",type:"redirect"}})):(l.increaseCount("Checkout:PageConductor:mixedContentFallback:Invalid"),
q.log("mixedContentFallback is invalid. mixedContentFallback should be reload or fallback","ERROR","mixedContentFallback"))}function R(a){return na&&(a.is("form")&&na!==a.serialize()||a.is("a")&&ba(na)!==ba(a.attr("href")))}function xa(a,b,d,f,k){function t(e,g,A){var z=!0;if("success"===g){if(!p.isAJAXWeblabOn()||!c.isStreamingAjax(A)){var ea=n.jsonify(e);null!==ea&&ea&&ea.result&&"noPrefetch"===ea.result&&(fa=null,z=!1)}z&&(fa={},fa.serializedValue=u,fa.data=e,fa.status=g,fa.response=A,fa.refMarker=
D,null==Q&&(Q=(new Date).getTime()))}else fa=null,l.increaseCount("Checkout:"+m+":PageConductor:Prefetch:"+ja+":Failure:Response");la=!1;ka&&q.when("spp-button-blocker").execute(function(a){a.hideDefaultContinueBtnBlocker()});if(sa)return ma(ga),!0;if(z){var C=function(){f?xa(a,b,d,!0,k):pa(a)};if(null===fa||"form"===h&&fa.serializedValue!==a.serialize())return C(),!0;b&&(0===b?l.increaseCount("checkoutPrefetchTimeoutSetToZero",1):ia=setTimeout(function(){fa=null;C()},1E3*b))}return!0}if(!G()||0===
a.length)return!1;var h=a.get(0).tagName.toLowerCase();if("form"!==h&&"a"!==h||"function"===typeof k&&!k(h))return!1;b=b||0;d=d||0;f=f||!1;if(la||ja>=d)return!1;la=!0;q.when("link-prefetch").execute(function(a){a.isClearCacheEnabled()&&a.clearCache()});ka&&q.when("spp-button-blocker").execute(function(a){a.showDefaultContinueBtnBlocker()});ja++;var m=e.getCurrentPage();Ca=(new Date).getTime();Q=null;l.increaseCount("Checkout:"+m+":PageConductor:Prefetch:"+ja+":Attempted");ia&&clearTimeout(ia);var D=
g.extractURLParts("form"===h?a.attr("action"):a.attr("href")).refMarker,A,u=null;"form"===h?(u=a.serialize(),A=p.isAJAXWeblabOn()?y(a,t,t,!0):y(a,null,null,!0)):"a"===h&&(u=ba(a.attr("href")),A=p.isAJAXWeblabOn()?ca(a,t,t,!0):ca(a,null,null,!0));p.isAjaxStreamingEnabled()&&u&&(na=u);"object"!==typeof A||"function"!==typeof A.always||p.isAJAXWeblabOn()||A.always(t)}function pa(a){var b=parseInt(a.data("prefetchTimeout"),10),c=parseInt(a.data("maxPrefetches"),10);return xa(a,b,c,!1,function(b){if(a.find("input:checked").hasClass("no-prefetch"))return!1;
if(p.disablePrefetchForScheduledDeliveryWeblabOn()){var c=a.find("div.one-shipment:not(:hidden)").find("input:checked");if(c.parents('[data-a-input-name\x3d"'+c.attr("name")+'"]').hasClass("no-prefetch"))return!1}return"1"===E("input#block-prefetch").val()||"1"===E("input#block-all-prefetch").val()||"form"===b&&!a.data("checkoutFormReady")?!1:!0})}function wa(a,b){return/.*\/checkout\/p\/.*\/spc/.test(b||r.window.location.pathname)&&/data-checkout-page/.test(a)}function ya(b,c){la&&null==Q&&(Q=(new Date).getTime());
b&&b.preventDefault();var d=b?E(b.currentTarget):c;b=function(){if(ka){m.blockAllActions();var a=d.data("shrink-panel"),b=d.data("loading-text");(a=E("#"+a))&&a.length?a.hasClass("expanded")||m.shrinkPanel(E(".spp-panel.expanded"),!1):a=E(".spp-panel.expanded");m.shrinkPanel(a,!0,b)}else m.show()};l.resetMetrics();!Fa||N(d)||ra(d)?b():a.delay(b,0);try{sa=!0,ga=d,p.isAjaxStreamingEnabled()&&Da&&!R(d)&&Da.enableExecution(),la||ma(d)}catch(e){b="An error occured while click on the continue button.",
e.message&&(b+="  Error message: "+e.message),q.error(b,"page-conductor","continueClicked",e)}}function Ba(){E("#checkout-btf-spinner").addClass("aok-hidden")}var E=a.$,la,Ca,Q,qa,fa,ja,sa,ga,ia,za,va,na,ua=function(a){if(!za)throw Error("Member _updatePageContent not set in page-conductor. Make sure 'initFunc' is called.");return za(a)},ka=!1,O=!1,ea=!1,Fa=!1,Ga=!1,Da,Ja=["sif_profile"];z();a.declarative("page-transit-no-update-action","click",function(c){if(!ea){c.$event.preventDefault();l.resetMetrics();
var d=c.data.targetDeclarativeActionId;if(d&&(d=E("#"+d),d.length)){d.trigger("click");return}var f=c.data.toPage,d=c.data.fromPage||e.getCurrentPage(),k=c.data.refTag||"chk_"+d+"_cancel_pri",g=c.data.args,h=c.$currentTarget.find("a.checkout-pipeline-pref-link"),n=ka&&"function"===typeof D.isIN&&D.isIN();ka&&(!n||"spp-payment"!==d&&"spp-rxselect"!==d?b.setCachedPageData(d,f):("spp-payment"==d&&l.increaseCount("checkout:trueSPC:disableCachingPSP:"+f,1),"spp-rxselect"==d&&l.increaseCount("checkout:trueSPC:disableCachingRxSelect:"+
f,1)));if(b.getCachedPageData(f,d)){l.increaseCount("checkout:"+d+":cancelpri",1);k=b.getCachedPageData(f,d);z();e.setCurrentPage(k.page);var A;A=p.isAJAXWeblabOn()?ua(k.curPageData):ua(JSON.stringify(k.curPageData));if(ka)if(l.isTransitionLoggingEnabled()){var u=(new Date).getTime();l.logPageTransition(d+"-cached",f,H,function(b){b=(new Date).getTime()-u;b<A?a.delay(function(){t(f)},A-b):t(f)})}else a.delay(function(){t(f)},A);else t(f);k.title&&k.url&&r.history&&r.history.pushState&&history.state&&
history.state.page!==k.page&&history.pushState(k.state,k.title,k.url)}else h.length?ya(null,h):(l.increaseCount("checkoutSPPCancelNoCachedData",1),n&&"spp-payment"===f&&l.increaseCount("checkout:trueSPC:emptyPSPCacheFrom:"+d,1),h=function(){if(ka)if(m.blockAllActions(),c.data.noShrink)m.show();else{var a=c.data.loadingText,b=E("#"+c.data.shrinkPanel);b.length||(b=c.$currentTarget.closest("div.spp-panel"));m.shrinkPanel(b,!0,a)}else m.show()},Fa?a.delay(h,0):h(),W(d,f,g,{refTag:k,keepCachedPagesData:1}))}});
p.isAjaxStreamingEnabled()&&(a.on("checkout:page:atf",function(){m.hide();E("#checkout-btf-spinner").removeClass("aok-hidden")}),a.on("checkout:page:end",function(){Ba()}));a.on("ready",function(){Fa=0<E("#executeNonBlockingAnimations").length;Ga=0<E("#prefetchFromAddressEnabled").length});a.on("checkout:afterReload",function(){m.hide();p.isAjaxStreamingEnabled()&&Ba();a.delay(l.sendUEPageLoadStats);if(G()){var c=E("form.checkout-page-form:not(:disabled):first"),d=E("a.checkout-continue-link:not(:disabled):first");
E("#useFirstActivePrefetch").length&&(d=E("a.checkout-continue-link:not(:disabled)").filter(function(){return 0<(parseInt(E(this).data("maxPrefetches"),10)||0)}).first());var e=!1;c.length&&(e=pa(c));!e&&d.length&&(e=pa(d));!e&&ka&&(c=E("a.checkout-pipeline-pref-link:not(:disabled):first"),c.length&&(d=c.data("fromPage"),e=c.data("toPage"),b.getCachedPageData(e,d)||(e=pa(c))))}});return{ajaxUpdatePage:P,ajaxRedirect:S,ajaxSorryPage:U,isPageLoadRequestInProgress:function(){return qa?1:0},submitFormAjax:y,
reloadPage:function(){var a=e.getCurrentPage();W(a,a)},loadPage:W,usePrefetch:da,makePrefetch:pa,makePrefetchWithParams:xa,isPrefetchValidFor:function(a,b){if(null!==fa){var c=fa.response.getResponseHeader("x-amz-checkout-page");if(p.isPageConductorConvergenceEnabled()&&b){var d=fa.response.getResponseHeader("x-amz-checkout-url"),d=g.getUrlType(d);b=g.getUrlType(b);return a===c&&d===b}return a===c}return!1},redirect:S,continueClicked:ya,initFunc:function(a,b){za=a;va=b},overrideIsSPP:function(a){ka=
a},isSPP:function(){return ka},overrideAddToCart:function(a){O=a},isAnimating:function(){return ea},overrideIsAnimating:function(a){ea=a},setAjaxTransitionHeader:x,isPipeliningOn:G,disablePageNoUpdateTransition:function(){Ga&&q.when("a-button").execute(function(a){var b=E(".spp-panel.expanded").data("stepIndex");E(".expand-collapsed-panel-trigger").each(function(){var c=E(this),d=c.parents(".spp-panel").data("stepIndex");if(!b||!d||d>b)c.filter(".clickable-heading").removeClass("clickable-heading").addClass("off-clickable-heading"),
a(c.filter(".expand-panel-button")).disable(),c.filter("a.expand-panel-button").addClass("disabled-link"),c.parents(".a-declarative").addClass("off-declarative").removeClass("a-declarative")});E(".panel-cancel-row").hide()})},enablePageNoUpdateTransition:function(){Ga&&q.when("a-button").execute(function(a){E(".off-clickable-heading").addClass("clickable-heading").removeClass("off-clickable-heading");a(".expand-collapsed-panel-trigger.expand-panel-button").enable();E(".off-declarative").addClass("a-declarative").removeClass("off-declarative")})},
isNonBlockingAnimationEnabled:function(){return Fa},isPrefetchFromAddressEnabled:function(){return Ga},getExecutionId:L,isPrefetchRequestInProgress:function(){return la},isRequestMixedContent:wa,ajaxUpdate:function(b,c,d){d=d||{};"undefined"===typeof d.pushNewFrame&&(d.pushNewFrame=!1);"boolean"===typeof d.pushNewFrame&&(d.pushNewFrame=d.pushNewFrame.toString());var e="";c&&"object"===typeof c?e=a.map(c,function(a,b){return b+"\x3d"+a}).join("\x26"):"string"===typeof c&&(e=c);ia&&clearTimeout(ia);
l.resetMetrics();m.show();return Z(b,e,function(a,b,c){P(a,b,c,d)},U)}}});q.when("A","jQuery","page-transition-controller","ajax-utility","page-detector-current-page","checkout-general-utils","page-conductor","cache-page-data-controller","client-side-metrics","weblab-helper","ready").execute(function(a,m,n,e,g,l,h,b,d,k){if(h.isPipeliningOn()){r.history&&m(r).bind("popstate",function(){var a=this.history.state,b=g.getCurrentPage();if(a&&a.page&&b&&(a.page!==b||h.isPageLoadRequestInProgress())){n.show();
b=m("#checkoutDisplayPage");b.data("wipeOnPipelineBackTransition")&&b.empty();d.resetMetrics();b=m("#useFastBackButton").length;if(k.isPageConductorConvergenceEnabled()){if(b&&h.isPrefetchValidFor(a.page,document.location.pathname)){h.usePrefetch({pushNewFrame:!1});return}}else if(b&&h.isPrefetchValidFor(a.page)){h.usePrefetch({pushNewFrame:!1});return}b="spc"===a.page?"":a.page;if(k.isPageConductorConvergenceEnabled()){var c="";if(l.isChewbaccaUrl(document.location.pathname)){var e=document.location.href.indexOf("/checkout/p/p-");
0<=e&&(c=document.location.href.substring(e))}h.loadPage(g.getCurrentPage(),b,a.additionalURLArgs,{refTag:"pipelinedBackButton",pushNewFrame:"false"},c)}else h.loadPage(g.getCurrentPage(),b,a.additionalURLArgs,{refTag:"pipelinedBackButton",pushNewFrame:"false"})}});m(document).delegate("form.checkout-page-form","change",function(a){m(a.target).parent().hasClass("no-prefetch-on-change")||(a=m(a.currentTarget),h.makePrefetch(a))});m(document).delegate("form.checkout-page-form","submit",function(a){h.continueClicked(a)});
m(document).delegate("a.checkout-continue-link","click",function(a){h.continueClicked(a)});a.declarative("checkout-page-form-submit","change",function(a){var b;a=a.$target.closest("form.checkout-page-form");b=a.attr("data-push-new-frame");"undefined"!==typeof b&&""!==b||a.attr("data-push-new-frame","false");a.submit()});m(document).delegate("form.checkout-page-form .submit-button-with-name","click",function(a){a=m(a.currentTarget);m("\x3cinput\x3e").attr({type:"hidden",name:a.attr("name"),value:a.val()}).appendTo(a.closest("form.checkout-page-form"))});
var c=!1;m(document).delegate("a.pipeline-link, div.pipeline-link, span.pipeline-link a","touchmove",function(a){c=!0});m(document).delegate("a.pipeline-link, div.pipeline-link, span.pipeline-link a","click keypress touchend",function(a){if(c)c=!1,a.preventDefault();else if(l.protectAgainstDoubleAction("pipeline-link"))a.preventDefault();else if("keypress"!==a.type||13===a.which){var e=m(a.currentTarget),g=e.data("pipelineLinkFromPage"),w=e.data("pipelineLinkToPage"),x=e.data("pipelineLinkAnchor"),
z=e.data("pipelineLinkRef");z||((z=l.extractURLParts(e.attr("href")).refMarker)?d.increaseCount("Checkout:PageConductor:LoadPage:AddedRefMarker"):d.increaseCount("Checkout:PageConductor:LoadPage:NoRefMarkerInUrl"));var f=e.data("pipelineLinkArgs");w&&(d.resetMetrics(),a.preventDefault(),h.isSPP()&&b.setCachedPageData(g,w),n.show(),a={refTag:z,anchor:x},h.isSPP()&&(a.keepCachedPagesData=1),x="",e=e.attr("href"),k.isPageConductorConvergenceEnabled()&&e&&l.isChewbaccaUrl(e)&&(x=e.substring(e.indexOf("/checkout/p/p-")),
f=""),h.loadPage(g,w,f,a,x))}});m(document).delegate("a.spclite-dispatch-link","click keypress touchend",function(a){if("keypress"!==a.type||13===a.which){var b=m(a.currentTarget),c=b.data("spcliteLinkFromPage"),d=b.data("spcliteLinkToPage");b.data("spcliteLinkAnchor");var e=b.data("spcliteLinkRef"),b=b.data("spcliteLinkArgs"),k=m("input#executionId").val(),b=b?b+("\x26executionId\x3d"+k):"executionId\x3d"+k;d&&(a.preventDefault(),n.show(),h.loadPage(c,d,b,{refTag:e},"/gp/buy/shared/handlers/spclite-dispatch.html"))}})}m(document).delegate("input.submit",
"click touchend",function(){d.resetMetrics()});m(document).delegate("form","submit",function(){d.resetMetrics()});m(document).delegate(".panel-cancel-row a, .clickable-heading","click",function(){d.isTransitionLoggingEnabled()&&d.resetMetrics()});k.isExecutionIdInQueryStringEnabled()&&(m.ajaxSetup({beforeSend:function(a,b){b.url&&(a=l.getQueryStringParameter(r.location.href,"executionId"),b.url=l.addQueryStringParameterOrDeleteIfEmpty(decodeURIComponent(b.url),"executionId",a));return!0}}),m(document).ajaxSuccess(function(a,
b,c){if(c&&c.url&&c.url.match(/\/async-continue|\/set-|\/update-|\/new/i)&&(a=b.getResponseHeader("x-amz-checkout-sub-page-type")||"Unknown",!a.match(/^p-/))){c=h.getExecutionId(b);if(r.history&&r.history.replaceState){var e=l.addQueryStringParameterOrDeleteIfEmpty(r.location.href,"executionId",c,!0);r.history.replaceState(r.history.state,"",e)}else d.increaseCount("Checkout:PageConductor:NoReplaceState");c||(b=b.getResponseHeader("x-amz-checkout-page-type")||"Unknown",d.increaseCount("Checkout:PageConductor:"+
(null===c?"ExecutionIdIsNotSet":"ExecutionIdIsEmpty")+":"+b+":"+a,1))}}))});"use strict";q.when("A","a-popover-base","a-popover-util").register("checkout-modal-popover",function(a,m,n){function e(b){return b.disableHide?function(){}:function(){var c=this;c.animating=!0;a.fadeOut(this.$popover,250);b.secondaryPopover||d("#a-popover-modal").hide();a.delay(function(){c.animating=!1},250)}}function g(a,b){var c=e(b);a=a.$event.triggerPositioningElement?a.$event.triggerPositioningElement:a.$declarativeParent;
(k=m.show({$trigger:a,name:b.name,skin:p(b.header,b.closeButton,b.closeTextOverride),content:b.content,url:b.url,data:b.data,update:u,alone:b.alone?"true"===b.alone:!0,position:b.position||"triggerVertical",hide:c}))&&k.$trigger!==a&&(k.$trigger=a,k.updatePosition())}function l(a,b){b.disableHide=!0;var k=e(b);c=!1;(b=m.show({$trigger:a.$declarativeParent,skin:D(b.header,b.footer,b.closeButton,b.contentClass),name:b.name,requestURL:b.url,position:"windowCenter",update:u,data:b.data,updatePosition:b.allowScrollOnPage?
w:x,modal:!0,alone:b.alone?"true"===b.alone:!0,show:function(){this.animating=!0;this.$popover.show();d("#a-popover-modal").show();this.animating=!1},hide:k}))&&b.$trigger!==a.$declarativeParent&&(b.$trigger=a.$declarativeParent,b.updatePosition())}function h(c){var d=c.$declarativeParent;a.delay(function(){b(c,d)},250)}function b(c,d){k&&(n.eventOccursWithin(c,d)||n.eventOccursWithin(c,k.$popover))?a.delay(function(){b(c,d)},250):m.hide(d)}var d=a.$,k,c=!1,p=function(a,b,c){return function(e){var k=
c;c===H&&(k=d("input#closeButtonText").val()||"");var p="";k&&(p='\x3ca href\x3d"#" data-action\x3d"custom-popover-close" class\x3d"a-declarative popover-close-link"\x3e'+k+"\x3c/a\x3e\x26nbsp;");k="false"===b?"":['\x3cdiv class\x3d"popover-close-section"\x3e',p,'\x3c/div\x3e\x3cbutton data-action\x3d"custom-popover-close" class\x3d"a-button-close a-declarative" role\x3d"button"\x3e\x3ci class\x3d"a-icon a-icon-close"\x3e\x3c/i\x3e\x3c/button\x3e'].join("");return['\x3cdiv class\x3d"a-popover"\x3e\x3cdiv class\x3d"a-popover-wrapper"\x3e',
a||k?['\x3cdiv class\x3d"a-popover-header"\x3e\x3ch4\x3e',a,"\x3c/h4\x3e",k,"\x3c/div\x3e"].join(""):"",'\x3cdiv class\x3d"a-popover-inner"\x3e',e,'\x3c/div\x3e\x3cdiv class\x3d"a-arrow-border"\x3e\x3cdiv class\x3d"a-arrow"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'].join("")}},D=function(a,b,c,e){return function(k){var p=d("input#closeButtonText").val()||"",g="";p&&(g='\x3ca href\x3d"#" data-action\x3d"custom-popover-close" class\x3d"a-declarative popover-close-link"\x3e'+p+"\x3c/a\x3e\x26nbsp;");
p="false"===c?"":['\x3cdiv class\x3d"popover-close-section"\x3e',g,'\x3c/div\x3e\x3cbutton data-action\x3d"custom-popover-close" class\x3d"a-button-close a-declarative" role\x3d"button"\x3e\x3ci class\x3d"a-icon a-icon-close"\x3e\x3c/i\x3e\x3c/button\x3e'].join("");p=a||p?['\x3cdiv class\x3d"a-popover-header huawei-device-header-fix"\x3e\x3ch4\x3e',a,"\x3c/h4\x3e",p,"\x3c/div\x3e"].join(""):"";g="";if(b){var h=d("#a-popover-footer-"+b);0<h.length&&(g=['\x3cdiv class\x3d"a-popover-footer"\x3e',h.html(),
"\x3c/div\x3e"].join(""))}return['\x3cdiv class\x3d"a-popover a-popover-modal"\x3e\x3cdiv class\x3d"a-popover-wrapper"\x3e',p,'\x3cdiv class\x3d"a-popover-inner ',e,'"\x3e',k,"\x3c/div\x3e",g,'\x3cdiv class\x3d"a-arrow-border"\x3e\x3cdiv class\x3d"a-arrow"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'].join("")}};a.declarative("custom-popover-close",["click","touchend"],function(b){b.$event.preventDefault();var c=b.$target;d("html").hasClass("a-ie6")||d("html").hasClass("a-ie7")||d("html").hasClass("a-ie8")?
c.closest(".a-popover").hide():a.fadeOut(c.closest(".a-popover"),250);d("#a-popover-modal").hide();a.trigger("a:declarative:a-popover-close:click",{$target:c,$event:b.$event,$currentTarget:b.$currentTarget})});a.on("a:popover:positionUpdated",function(a){a=a.popover.$popover;0>a.offset().left&&a.offset({left:0});0>a.offset().top&&a.offset({top:0})});a.on("a:popover:show",function(a){if(a.popover&&a.popover.$trigger){var b=a.popover.$trigger.data("aCheckoutModalPopover");b&&b.allowScrollOnPage&&a.popover.$popover.css("position",
"absolute")}});var u=function(a){d(".a-popover-inner",this.$popover).html(a)},w=function(a){if(!c||a)x.call(this,!0),c=!0},x=function(a){var b=d(r),c=b.height()/2,e=b.width()/2,k=this.$popover.height()/2,p=this.$popover.width()/2,c=c-k;if(a||"fixed"!==this.$popover.css("position"))c+=b.scrollTop();a=Math.max(0,e-p);c=Math.max(0,c);this.$popover.css({top:c,left:a})};a.declarative("a-checkout-popover",["click","mouseenter","mouseleave","keyup","touchend"],function(a){a.data.showOnHover&&"touchend"!==
a.type?"mouseenter"===a.type||"click"===a.type?g(a,a.data):"mouseleave"===a.type&&h(a):("click"===a.type||"touchend"===a.type||"keyup"===a.type&&a.$event.manualTrigger)&&g(a,a.data)});a.declarative("a-checkout-modal-popover",["click","keyup","touchend"],function(a){("click"===a.type||"touchend"===a.type||"keyup"===a.type&&a.$event.manualTrigger)&&l(a,a.data)});a.on("checkout:reload",function(){a.defer(function(){0===d("#a-popover-modal").length&&d("body").append('\x3cdiv id\x3d"a-popover-modal" /\x3e')})});
return{hideById:function(a){m.hide(a)},createModal:l}});"use strict";(function(){var a=!1;q.when("A").register("page-detector",function(m){function n(){return e("checkout-as")}function e(a){d||(d={});d.hasOwnProperty(a)||(d[a]=0<b("div."+a).length);return d[a]}function g(){return e("checkout.pay")}function l(){return e("checkout.spc")||-1<r.location.href.search(/\/checkout\/p\/p[-\d]+\/spc.*/)?!0:!1}function h(){return m.capabilities.mobile}var b=m.$,d;m.on("checkout:reload",function(){d={};a||q.when("page-detector-current-initializer").execute(function(a){a.initializeDetectorWithCurrentPage(null)})});
return{isAddressSelect:n,isAddressTranslation:function(){return e("translate-address-form")},isDesktopPayment:function(){return g()&&e("pay-desktop")},isDesktopSpc:function(){return l()&&e("spc-desktop")},isMobileAddressSelect:function(){return n()&&e("checkout-as-mobile")},isMobilePayment:function(){return g()&&e("pay-mobile")},isMobileSpc:function(){return l()&&h()},isTabletAddressSelect:function(){return n()&&e("checkout-as-tablet")},isTabletPayment:function(){return g()&&e("pay-tablet")},isTabletSpc:function(){return l()&&
e("spc-tablet")},isSpcLite:function(){return l()&&e("spclite")},isPayment:g,isSosp:function(){return e("checkout.sosp")},isSpc:l,isMobile:h,isTablet:function(){return m.capabilities.tablet}}});q.register("page-detector-current-initializer",function(){return{initializeDetectorWithCurrentPage:function(m){if(!a){var n=m;q.register("page-detector-current-page",function(){return{getCurrentPage:function(){return n},setCurrentPage:function(a){var g=n;n=a;q.when("A").execute(function(l){l.trigger("page-detector:page-changed",
g,a)})}}});a=!0}}}})})();"use strict";q.when("jQuery","loading-spinner-controller").register("page-spinner-controller",function(a,m){function n(){"function"===typeof w.blockAllActions&&w.blockAllActions()}function e(){"function"===typeof w.unblockAllActions&&w.unblockAllActions()}function g(a){"function"===typeof w.showTransitionInContainer&&w.showTransitionInContainer(a)}function l(){var b=a(r).width(),c=a(r).height(),d=a(r),e=0;null!==u&&(e=u.outerHeight()-a(r).scrollTop(),0>e&&(e=0));p.css("top",
d.scrollTop()+e+"px").css("left",d.scrollLeft()+"px").width(b).height(c);"1"!==a("input[name\x3dfromAnywhere]").val()&&a("#loading-spinner-blocker-doc").css("top",d.scrollTop()+e+"px").css("left",d.scrollLeft()+"px").width(b).height(c)}function h(){var b;b=document.activeElement?a(document.activeElement):a(":focus:first");b.is("button, a, input:enabled")&&b.blur()}function b(){if(x){n();q.when("spp-button-blocker").execute(function(a){a.hideContinueBtnBlocker()});var b=a(".spp-panel.expanded");if(0<
b.length&&b.is(":visible")){g(b,1);return}}if(D)return p.length&&p.find(".loading-spinner-inner").show(),!1;D=!0;h();p=a("#spinner-anchor");p.find(".loading-spinner-inner").show();a("#unblockHeader").length&&(u=a("#header"));k=p.css("z-index");a(r).unbind("scroll.checkout-page-spinner").bind("scroll.checkout-page-spinner",function(a){c&&r.clearTimeout(c);c=setTimeout(function(){l();c=null},50)});a(r).unbind("resize.checkout-page-spinner").bind("resize.checkout-page-spinner",function(){l();m.adjustSize(p)});
a(r).unbind("orientationchange.checkout-page-spinner").bind("orientationchange.checkout-page-spinner",function(){l();m.adjustSize(p)});l();p.show();p.css("z-index",2E3);m.showSpinner(p,!0);return!0}function d(){if(x)e(),"function"===typeof w.hideSpinner&&w.hideSpinner();else{a("#first-pipeline-load-page-spinner").remove();if(!D)return!1;D=!1;p.length&&p.find(".loading-spinner-inner").show();p&&(a(r).unbind(".checkout-page-spinner"),p.hide(),p.css("z-index",k),m.hideSpinner(p));return!0}}var k,c=null,
p,D=!1,u=null,w={},x=!1;return{show:b,showPageTransition:function(){return"0"===a("#showPageTransition").attr("content")?!1:b()},hide:d,hidePageTransition:function(){"0"===a("#showPageTransition").attr("content")&&d();return!0},hideAnimatedSpinnerImage:function(){p.length&&p.find(".loading-spinner-inner").hide()},initFunc:function(a){null!==a&&(w=a,x=!0)},blockAllActions:n,unblockAllActions:e,showTransitionInContainer:g,shrinkPanel:function(a,b,c){"function"===typeof w.shrinkPanel&&w.shrinkPanel(a,
b,c)},clearFocus:h}});"use strict";q.when("A").execute(function(a){a=a.$;var m="",m="mash-transitions"===a("input[name\x3dpageTransitionType]").val()?"page-mash-transition-controller":"page-spinner-controller";q.when(m).register("page-transition-controller",function(a){q.when("A").execute(function(e){e.declarative("page-spinner-show",["click"],{allowLinkDefault:!0},function(e){e=e.$target;e.hasClass("a-button-disabled")||e.closest(".a-button-disabled").length||a.showPageTransition()})});q.when("A").execute(function(e){e.declarative("page-spinner-show-on-submit",
["submit"],{allowLinkDefault:!0},function(e){a.showPageTransition()})});return{show:a.show,hide:a.hide,showPageTransition:a.showPageTransition,hidePageTransition:a.hidePageTransition,blockAllActions:a.blockAllActions,unblockAllActions:a.unblockAllActions,showTransitionInContainer:a.showTransitionInContainer,shrinkPanel:a.shrinkPanel}})});"use strict";q.when("A","page-conductor","client-side-metrics","page-detector-current-page","a-popover","ready").execute(function(a,m,n,e){function g(a,d,e){m.isSPP()&&
n.setmarker&&n.setmarker("af");n.sendUEPageLoadStats()}var l=a.$,h=!1;a.on("a:popover:afterHide",function(a){a.popover&&(h=!1)});a.on("a:popover:beforeShow",function(a){var d=a.popover;d&&(h=!0,d.$trigger.find(".modal-parameters").each(function(){l.each(l(this).data(),function(a,b){d.attrs(a,b)})}))});a.on("a:popover:dismiss",function(a){a=a.popover;if(n.isTransitionLoggingEnabled()&&a&&h){h=!1;var d,k;"prime-acquisition-spc-popover"===a.name&&(d="prime-acquisition",k=e.getCurrentPage());d||k||!a.attrs||
(d=a.attrs("returnfrom"),k=a.attrs("returnto"));d&&k&&(n.resetMetrics(),n.logPageTransition(d,k,g))}})});"use strict";q.when("A","page-detector-current-page","checkout-general-utils","client-side-metrics").register("first-load-dependencies-base",function(a,m,n,e){function g(){"function"===typeof r.uet&&"function"===typeof r.uex&&(r.uet("cf","first-load-dependencies-ready",{wb:1}),r.uex("ld","first-load-dependencies-ready",{wb:1}));e.startWidgetTiming("first-load-dependencies:checkout:beforeReload");
a.trigger("checkout:beforeReload");e.finishWidgetTiming("first-load-dependencies:checkout:beforeReload");e.startWidgetTiming("first-load-dependencies:checkout:reload");a.trigger("checkout:reload");e.finishWidgetTiming("first-load-dependencies:checkout:reload");var b;h&&(b="spp-revieworder"===h?"spc":h);b&&(e.finishWidgetTiming("first-load-dependencies:checkout:reload:"+b),a.trigger("checkout:reload:"+b),e.finishWidgetTiming("first-load-dependencies:checkout:reload:"+b));e.startWidgetTiming("first-load-dependencies:checkout:afterReload");
a.trigger("checkout:afterReload");e.finishWidgetTiming("first-load-dependencies:checkout:afterReload");setTimeout(function(){var a=l("#first-pipeline-load-page-spinner");a.is(":visible")&&(a.remove(),e.increaseCount("checkout:pageload:timeout"),n.logError("The page has taken more than 90 seconds to load, or there was a JS error preventing it from loading, hiding page spinner."))},9E4)}var l=a.$,h=m.getCurrentPage();"function"===typeof r.uet&&r.uet("bb","first-load-dependencies-ready",{wb:1});return{allDependenciesCheck:function(a){if(a&&
a.length){var d=!1,k={};l.each(a,function(a,b){e.startWidgetTiming("checkout:dependency:"+b+":ready");k[b]=1;q.when(b).execute(function(){e.finishWidgetTiming("checkout:dependency:"+b+":ready");delete k[b]})});var c=function(a){a="Page ("+h+") is missing dependencies ["+a.join(", ")+"] after 5 secs.";e.increaseCount("checkout:dependency:missed:regular-page:error");n.logErrorOnLevel(a,"ERROR")},p=setTimeout(function(){if(!d){var a=[];l.each(k,function(b){e.increaseCount("checkout:dependency:"+b+":missed");
a.push(b)});e.increaseCount("checkout:dependency:missed");0<l("#assets-prefetch").length?e.increaseCount("checkout:dependency:missed:assets-prefetch"):(e.increaseCount("checkout:dependency:missed:regular-page"),c(a));g()}},5E3);q.when.apply(q,a).execute(function(){d=!0;r.clearTimeout&&p&&r.clearTimeout(p);g()})}else g()}}});"use strict";q.when("A","page-detector","client-side-metrics").register("gift-utility",function(a,m,n){var e=a.$,g=/[^\s\u0020-\u007E\u00A0-\u00FF]/g,l=r.P&&r.P.AUI_BUILD_DATE,
h=/((?:file|https?|ftps?|sip):\/\/)/im,b=/((?:\b|[\s!@#$%^&*()_=+[\]{}\|;:'",.<>\?])www\.(?:(?:[^\s!@#$%^&*()_=+[\]{}\|;:'",.<>\?]+\.[^\s!@#$%^&*()_=+[\]{}\|;:'",.<>\?]+))+)(?:[\s!@#$%^&*()_=+[\]{}\|;:'",<>\?]|$|\b)/im,d=/([^\s!@#$%^&*()_=+[\]{}\|;:'",.<>\?\/]+\.(?:[a-z][a-z]|aero|arpa|asia|biz|cat|com|coop|edu|gov|info|int|jobs|mil|mobi|museum|name|net|org|om|pro|qa|tel|travel|xxx)(?:\b|$))/im,k=/^\S+\@\S+\.\S+$/im;return{getInput:function(a){return a.is("input")?a:a.find("input")},getCharCount:function(a,
b){return b?r.unescape(encodeURIComponent(a)).length:a.length},getLineCount:function(a,b){var d=a.split("\n").length;b=Math.floor(b);a=a.split("\n");for(var e=0;e<a.length;e++)a[e].length>b&&(d+=Math.floor(a[e].length/b),0===a[e].length%b&&d--);return d},getNameWithNoTitle:function(a){var b=!1;a=a.split(" ");/^(?:Dr|Mr|Mrs|Ms|Mme|Lt|Attn|Attn:|Prof|Pt|The)\.?$/i.test(a[0])&&(b=!0);b&&a.shift();return a.join(" ")},getFirstName:function(a){var b=!1;a=a.split(" ");/^(?:Dr|Mr|Mrs|Ms|Mme|Lt|Attn|Attn:|Prof|Pt|The)\.?$/i.test(a[0])&&
(b=!0);b&&a.shift();return a.shift()},toggleGiftMessageWarning:function(a,b){var d=b.find(".gift-message-warning");if(g.test(a.val())){var k=b.find(".gift-message-preview-trigger"),h=a.val().replace(g,"?");l?q.when("a-popover").execute(function(a){var b=a.get(k);b?b.update({content:h}):a.create(k,{inlineContent:h,position:"triggerVertical",closeButton:"false"})}):(n.increaseCount("removeauijs13"),k.unbind("click.preview").bind("click.preview",function(a){q.when("a-popover-base").execute(function(b){var c=
e(a.target);c.data("popoverid")&&(b=b.get(c.data("popoverid")))&&(b.update(h),b.updatePosition())})}));a.addClass("a-form-error");d.show()}else a.removeClass("a-form-error"),d.hide()},valueContainsUrl:function(a){return h.test(a)||b.test(a)||d.test(a)},isValidEmail:function(a){return k.test(""+a)}}});"use strict";q.when("A","page-detector","safe-mash","client-side-metrics").register("help-popup",function(a,m,n,e){function g(){if(l("div#help-popover").length){l(r).unbind("resize.checkout-help-popover");
var a=l("#help-popover-frame")[0];l(a.contentWindow?a.contentWindow:a.contentDocument.defaultView).undelegate("a","click");l("div#help-popover").remove()}}var l=a.$;m=m.isMobile();e=l("input#isPipelinedPage");e=0<e.length&&"1"===e.val();var h=m&&e&&n&&n.navigate;a.declarative("help-popup",["click"],function(a){if(!l(".a-touch").length||h){a.$event.preventDefault();a.data&&"1"===a.data.stopPropagation&&a.$event.stopPropagation();var d=a.$target.closest("a").attr("href");a=a.data;h?n.navigate({url:d,
transitionEffect:"slide"}):(a.width||(a.width="340"),a.height||(a.height="340"),r.open(d,"AmazonHelp","width\x3d"+a.width+",height\x3d"+a.height+",left\x3d10,top\x3d10,resizable\x3dyes,scrollbars\x3dyes,menubar\x3dno,toolbar\x3dyes,location\x3dno,directories\x3dno,status\x3dyes"))}else r.open(a.$target.closest("a").attr("href"),"AmazonHelp")});if(h)a.on("checkout:reload",g)});"use strict";q.execute("persistent-order-controller",function(){return{}});"use strict";q.when("jQuery","page-conductor").register("quantity-service",
function(a,m){function n(e,g){g=g||{};var l;g.additionalData&&(l=g.additionalData);var h="/gp/buy/pipeline/handlers/update-quantity.html",b={returnFullHTML:1,cachebuster:(new Date).getTime(),isClientTimeBased:0,hasWorkingJavascript:1};l&&l.deletePrimeMembership&&l.primeMembershipASIN&&(b.deletePrimeMembershipItemIn=l.deletePrimeMembership,b.deletedPrimeMembershipASINIn=l.primeMembershipASIN);g.ref&&(h+="/ref\x3d"+g.ref,delete g.ref);l=g.success;delete g.success;var d=m.ajaxRedirect;g.error&&(d=g.error,
delete g.error);a.extend(b,g);g=[];for(var k in e)e[k]!==H&&(g.push(k),b[k]=e[k]);b.entityids=g;e=m.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"});a.ajax({type:"POST",url:h,data:a.param(b,!0),dataType:"text",async:!0,cache:!1,headers:e,success:l,error:d})}return{callBatch:function(a,g){n(a,g)},call:function(a,g,l){var h={};h[a]=g;n(h,l)}}});"use strict";q.when("jQuery").register("scroll-controller",function(a){return{scrollToTop:function(){a(r).scrollTop(0)},
toggleScrollOn:function(){a(document).unbind("touchmove")},toggleScrollOff:function(){a(document).bind("touchmove",function(a){a.preventDefault()})}}});"use strict";q.when("A","checkout-general-utils","ready").execute(function(a,m){var n=a.capabilities&&a.capabilities.isAmazonApp,e=r.amazon&&r.amazon.mash;a=a.$("#checkout-mash-will-load").length;n||e||a?q.when("mash").execute(function(a){var e;"object"===typeof a?e=a:r.amazon&&r.amazon.mash&&(e=r.amazon.mash);"object"!==typeof e?m.logError("MASH is expected but can't be found!"):
(q.register("safe-mash",function(){return e}),r.ue&&r.ue.tag&&r.ue.tag("safe-mash:mash"))}):(q.register("safe-mash",function(){}),r.ue&&r.ue.tag&&r.ue.tag("safe-mash:no-mash"));r.ue&&r.ue.tag&&(n&&r.ue.tag("safe-mash:A.capabilities.isAmazonApp"),e&&r.ue.tag("safe-mash:window.amazon.mash"),a&&r.ue.tag("safe-mash:checkout-mash-will-load"),!n&&e&&r.ue.tag("safe-mash:fallback:window.amazon.mash"),n||e||!a||r.ue.tag("safe-mash:fallback:checkout-mash-will-load"))});"use strict";q.when("A","scheduled-delivery-external-interface",
"shipping-speed-selection-controller","page-detector","ready").register("scheduled-delivery-controller",function(a,m,n,e){var g=a.$,l={};n=function(){l={};g("div.fake-label input[type\x3d'radio']:checked").each(function(){var a=g(this),b=a.closest("div.fake-label");(b=m.getSdWidgetRootId(b))&&(l[a.attr("name")]=b)})};a.on("checkout:reload:shipoptionselect",n);a.on("checkout:reload:spp-revieworder",n);e.isSosp()&&n();g(document).delegate("div.fake-label","click",function(){if(e.isSosp()){var h=g(this),
b=h.find("input[type\x3d'radio']");b.attr("disabled")||(b=b.attr("name"),h=m.getSdWidgetRootId(h),a.trigger("scheduled-delivery:ship-option-changed",{current:h,previous:l[b]}),l[b]=h)}});g(document).delegate(".ship-option.is-scheduled-delivery","click",function(){if(e.isSpc()){var h=g(this);h.find("input[type\x3d'radio']").attr("disabled")||(h=m.getSdWidgetRootId(h))&&a.trigger("scheduled-delivery:ship-option-changed",{current:h,previous:null})}});a.on("scheduled-delivery:unblock-continue",function(){q.when("button-blocker").execute(function(a){a.hide("scheduled-delivery")})});
a.on("scheduled-delivery:block-continue",function(a){q.when("button-blocker").execute(function(b){b.show("scheduled-delivery",a)})});a.on("scheduled-delivery:disable-ship-option",function(a,b){var d;a=g("#"+a);if(0!==a.length){if(e.isSpc())a=a.closest(".shipping-speed");else if(e.isSosp())a=a.closest("div.fake-label.a-box");else return;d=a.find("input[type\x3d'radio']");d.attr("disabled",!0);d.is(":checked")&&b&&(b=g("input[name\x3d"+d.attr("name")+"]:radio:not(:disabled):first"),b.prop("checked",
!0),b.trigger("change"));a.addClass("sd-disabled")}});a.on("scheduled-delivery:enable-ship-option",function(a){var b;a=g("#"+a);if(0!==a.length){if(e.isSpc())a=a.closest(".shipping-speed");else if(e.isSosp())a=a.closest("div.fake-label.a-box");else return;b=a.find("input[type\x3d'radio']");b.removeAttr("disabled");a.removeClass("sd-disabled")}})});"use strict";q.when("A","ready").register("mobile-nav-bar-back-controller",function(a){a.capabilities.history&&(a=a.$,a=a("#mobile-top-bar-navigation-back"),
1<=a.length&&a.click(function(a){a.preventDefault();r.history.back()}))});"use strict";q.when("A","page-spinner-controller","page-detector","page-conductor","weblab-helper","ready").execute(function(a,m,n,e,g){function l(a,b){var c=[];a.addressId||c.push("addressId");a.slotKey||c.push("slotKey");a.shippingOfferingId||c.push("shippingOfferingId");a.conflictItems&&!p.isArray(a.conflictItems)&&c.push("conflictItems");if(0<c.length){a="Error calling fresh widget callback on "+b+": Bad or Missing Input: "+
c[0];for(b=1;b<c.length;b++)a+=", "+c[b];console.error(a);return 0}return 1}function h(){p("#freshSlotKey").val("");p("#freshAddressId").val("");p("#freshReservationToCancel").val("");p("#freshConflictingItems").val("");p("#freshShipOfferingId").val("")}function b(a){var b="",c=g.sospPartialAvailabilityWeblabOn();if(a&&p.isArray(a)&&0<a.length)for(var b=a[0].asin+":"+a[0].merchantId+(c?"|"+a[0].maxQtyAvailable:""),d=1;d<a.length;d++)b+="-"+a[d].asin+":"+a[d].merchantId+(c?"|"+a[d].maxQtyAvailable:
"");return b}function d(a){var c;c="page\x3dspc\x26returnFullHTML\x3d1\x26callSetters\x3d1\x26freshSlotKey\x3d"+a.addressId;c+="\x26freshAddressId\x3d"+a.slotKey;a.reservationToCancel&&(c+="\x26freshReservationToCancel\x3d"+a.reservationToCancel);(a=b(a.conflictItems))&&(c+="\x26freshConflictingItems\x3d"+a);a=e.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});m.show();p.ajax({type:"POST",url:"/gp/buy/shared/handlers/handle-fresh-widget-results.html/ref\x3dset-fresh-information",data:c,dataType:"text",
async:!0,cache:!1,headers:a,success:function(a,b,c){return c.getResponseHeader("x-amz-checkout-page")?e.ajaxUpdatePage(a,b,c):e.redirect(a)},error:function(a,b,c){e.ajaxRedirect(a,b,c)}})}function k(){p(".sosp-continue-button").removeClass("js-hide").removeClass("aok-hidden");p(".continue-button-blocker").addClass("aok-hidden")}function c(){p(".sosp-continue-button").addClass("aok-hidden");p(".continue-button-blocker").removeClass("aok-hidden")}var p=a.$;a.on("handle-fresh-results",function(a){if(p("#isfresh").val())if(a)if(n.isSosp())if(l(a,
"sosp")){p("#freshSlotKey").val(a.slotKey);p("#freshAddressId").val(a.addressId);p("#freshReservationToCancel").val(a.reservationToCancel);var g=b(a.conflictItems);p("#freshConflictingItems").val(g);p("#freshShipOfferingId").val(a.shippingOfferingId);g&&0<g.length?p("input#block-prefetch").val(1):p("input#block-prefetch").val(0);g=p("#shippingOptionFormId");a.conflictItems&&0<a.conflictItems.length||e.makePrefetch(g);k()}else h(),c();else n.isSpc()?l(a,"spc")&&d(a):console.error("remote fresh widget JS callback called on unsupported page.");
else console.error("remote fresh widget JS callback called with empty data.");else console.error("remote fresh widget JS callback called without isfresh flag on page")});a.on("block-continue",function(a){p("#isfresh").val()?a?"undefined"===typeof a.blockContinue?console.error("block continue callback - missing blockContinue"):n.isSosp()?1===a.blockContinue?(c(),h()):0===a.blockContinue?k():console.error("block continue callback - invalid value"):console.error("block continue callback called on unsupported page."):
console.error("block continue callback called with no argument"):console.error("block continue callback called without isfresh flag on page")});a.on("confirm-and-continue",function(){p("div.sosp-fresh #shippingOptionFormId").submit()});a.on("redirect-to-spc",function(){e.redirect({conductoraction:{url:'/gp/buy/spc/handlers/display.html/ref\x3d"cancel-fresh-address-select"',type:"redirect"}})})});"use strict";q.when("A","ready").execute(function(a){function m(){(0<n(".change-preference-block").length||
0<n(".mobile-change-preference-block").length)&&!1===e&&(q.register("loadVasRcxCheckoutAsset",function(){}),e=!0)}var n=a.$,e=!1;m();a.on("checkout:reload:spc",m);a.on("checkout:reload:shipoptionselect",m);a.on("checkout:reload:spp-revieworder",m);a.on("checkout:reload:spp-special-delivery-options",m)});"use strict";q.register("time-left-formatter",function(){function a(a,e,g,l,h){return 0>=e?a:a+e+" "+(1===e?h.HOUR:h.HOURS)+(!l&&0<g?" "+h.AND+" ":"")}function m(a,e,g,l,h){return 0>=e?a:a+e+" "+(1===
e?h.MINUTE:h.MINUTES)+(!l&&1>g?" "+h.AND+" ":"")+(1===l&&1>g?" ":"")}return{getTimeLeftFormatted:function(n,e,g){var l="",h=86400<n?(n-n%86400)/86400:0,b=3600<n?(n-n%3600)/3600:0;n-=3600*b;var d=60<n?(n-n%60)/60:0;n-=60*d;if(e&&0<h)return l+h+" "+(1===h?g.DAY:g.DAYS);if(e&&0<b)return a(l,b,d,e,g);if(e&&5<=d)return m(l,d,b,e,g);l=a(l,b,d,e,g);l=m(l,d,b,e,g);1<=b||(l=l+n+" "+(1===n?g.SECOND:g.SECONDS));return l}}});"use strict";q.register("email-validation",function(){function a(a){if(1!==a.length)throw Error("Invalid length for character");
return a}var m={isISOControl:function(m){"string"===typeof m&&(a(m),m=m.charCodeAt(0));return 31>=m||127===m},isWhitespace:function(m){m=a(m);return null!==m.match(/\s/g)},isLetterOrDigit:function(m){m=a(m);return null!==m.match(/[A-Za-z0-9]/g)}};return function(a){var e;if(!a||64<a.length)return!1;for(e=0;e<a.length;e++)if(127<a.charCodeAt(e))return!1;e=a.indexOf("@");if(e!==a.lastIndexOf("@")||1>e||e===a.length-1)return!1;var g=a.substring(0,e),l=a.substring(e+1);if("."===l.charAt(0)||"."===l.charAt(l.length-
1)||l.match(/[a-zA-Z\d\-.]+/)[0]!==l)return!1;for(e=0;e<l.length;e++)if(a=l.charAt(e),e<l.length-1&&"."===a&&"."===l.charAt(e+1))return!1;if(-1===l.indexOf("."))return!1;var h=l=!1;for(e=0;e<g.length;e++)if(a=g.charAt(e),l){switch(a){case "\\":h=!h;break;case '"':h||(l=!1);break;default:if(h&&!m.isLetterOrDigit(a))return!1;h=!1;if(m.isISOControl(a))return!1}if(!l&&('"'===g.charAt(e-1)||g.length-1!==e&&"."!==g.charAt(e+1)))return!1}else switch(a){case '"':if(0!==e&&"."!==g.charAt(e-1))return!1;l=!0;
break;case ".":if(0===e)return!1;break;case "(":case ")":case "\x3c":case "\x3e":case "[":case "]":case "\\":case ":":case ";":case ",":return!1;default:if(m.isISOControl(a)||m.isWhitespace(a))return!1}return!0}});"use strict";q.when("A","page-transition-controller","checkout-general-utils","page-detector","page-detector-current-page","safe-mash","loading-spinner-controller","weblab-helper").register("shipoptionselect-controller",function(a,m,n,e,g,l,h,b){function d(a){var b=x(".delivery-window-groups .more-window");
h.showSpinner(b,!1);a=a.$currentTarget.closest(".delivery-window-groups").data("orderid");b=x("input[name\x3dlineItemEntityIds_"+a+"]").attr("value");x.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/long-calendar-content.html",data:"lineitemids\x3d"+b+"\x26orderid\x3d"+a+"\x26isMobile\x3d1\x26fromPage\x3dsosp",dataType:"json",async:!0,cache:!1,headers:{"x-amz-checkout-page":"sosp"},success:function(a){h.hideSpinner();if(a&&a.deliveryWindowGroups){var b=x(".delivery-window-groups .a-box-group");
b.empty();x.each(a.deliveryWindowGroups,function(a,c){b.append(c)});a=x(".delivery-window-groups .selected-group");a.length&&a.trigger("click")}}})}function k(a,b){var c=x("div.one-shipment:visible");a=v?x("div.one-shipment").slice(parseInt(a,10),parseInt(b,10)+1):x("div.one-shipment#"+a);f&&0!==a.size()&&c.last().attr("id")!==a.last().attr("id")&&(c.hide(),a.show(),x(r).scrollTop(0),c=x(document.activeElement),c.is("button, a, input:enabled")&&c.blur())}function c(){if(f){var a=(location.hash?location.hash.replace("#",
""):"0-"+J).split("-");2===a.length&&k(a[0],a[1])}}function p(){function d(a,b){x.ajax({type:"POST",url:"/gp/buy/gift/handlers/remove-gift-option.html",data:b,dataType:"json",async:!0,cache:!1,headers:{"x-amz-checkout-page":"sosp"},success:a,error:function(a,b,c){m.hide()}})}function p(a){var b=a.closest("div."+n);a.is(":checked")?(b.siblings("div."+n+".selected").removeClass("selected").find(".a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive"),
b.addClass("selected").find(".a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active")):b.removeClass("selected").find(".a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");u("triggerChangeEvent",[a])}0<x(".prime-calendar-container").length&&x(".prime-calendar-container").contents().each(function(a,b){8===b.nodeType&&x(b).replaceWith(b.nodeValue)});var h=x(".delivery-window-groups .selected-group");
h.length&&h.trigger("click");z=x(".sosp-continue-button");f="1"===x("#isClientSidePagingEnabled").val()?1:0;J=b.isDigitalAsinIndexingFixedOnSOSPEnabled()?(x("div.shipment-with-ship-options:visible").length-1).toString():(x("div.one-shipment:visible").length-1).toString();t="1"===x("#useMashNavigateForClientSidePaging").val()?1:0;v="1"===x("#collapseDigitalShipmentsEnabled").val()?1:0;var n=(h=r.P&&r.P.AUI_BUILD_DATE)?"selectable-box":"fake-label";f&&(x(".one-shipment:gt("+J+")").hide(),c());z.bind("click",
function(c){function d(a,b){var c=g.getCurrentPage();if(r.history&&r.history.pushState){var e=location.href;0<e.indexOf("#")&&(e=e.substring(0,e.indexOf("#")));e+="#"+a.attr("id")+"-"+b.attr("id");history.pushState({page:c,id:a.attr("id")},x("title"),e)}}var f=x("div.one-shipment:visible input[id\x3d'fresh-block-continue']");if(f){if("1"===f.val())return a.trigger("f3:fresh-sosp-continue:blocked"),c.preventDefault(),!1;"0"===f.val()&&a.trigger("f3:fresh-sosp-continue:allowed")}var p=!1;x("div.one-shipment:visible input[type\x3d'radio'][checked]").each(function(){if(x(this).data("blockingOn"))return alert(x(this).data("blockingOn")),
c.preventDefault(),p=!0,!1});if(p)return!1;if(b.removesGiftOptionOnRush()&&e.isMobile()&&null!=C){var f=x("div.one-shipment:visible"),h=f.find("input[type\x3d'radio']:checked").closest(".shipping-option");if("1"===f.find("input[type\x3dhidden][name\x3disGiftWrapped]").attr("value")&&1===h.data("nosupportforgiftoption"))return C.show(),!1}D();f=x("div.one-shipment:visible");h=f.nextAll("div.one-shipment:hidden");if(0<h.length){c.preventDefault();var m=h.first(),n=m;v&&(n=h.filter(".shipment-with-ship-options"),
n=1<n.length?n.eq(1).prev():h.last());t&&l&&l.navigate?l.navigate({url:null,transitionEffect:"slide",successCallback:function(){d(m,n)},failCallback:function(a){}}):d(m,n);k(m.attr("id"),n.attr("id"));a.trigger("active-shipment-changed")}w("logInlineCalMetrics",[f])});x(".gift-option-removal-cancel-button").bind("click",function(a){C.hide()});x(".gift-option-removal-confirm-button").bind("click",function(a){m.show();C.hide();a="lineItemsToRemoveGiftOptionFrom\x3d"+x("div.one-shipment:visible").find("input[name^\x3dlineItemEntityIds_]").attr("value");
var b=x("div.one-shipment:visible"),c=b.nextAll("div.one-shipment:hidden");d(function(a,d,e){b.find("input[type\x3dhidden][name\x3disGiftWrapped]").each(function(){x(this).remove()});0<c.length?(z.click(),m.hide()):x(".checkout-page-form").submit()},a)});x(r).bind("popstate",function(a){e.isSosp()&&c()});x(document).delegate("div."+n,"click",function(a){a=x(this);a.find("input[type\x3d'radio']").trigger("change",["setActive"]);a.parent().hasClass("timeslot-picker")&&(a=a.find(".a-button-selected").length,
z&&z.length&&(a?z.removeClass("a-button-disabled").addClass("a-button-primary").find("input").prop("disabled",!1):z.removeClass("a-button-primary").addClass("a-button-disabled").find("input").prop("disabled",!0)))});var G;a.declarative("faster-than-same-day-sosp-save",["click","submit"],function(){var b="lineItemsToRemoveGiftOptionFrom\x3d"+G.closest(".one-shipment").find("input[name^\x3dlineItemEntityIds_]").attr("value");a.$("div.a-popover button.a-button-close").trigger("click");m.show();d(function(a,
b,c){G.closest(".one-shipment").find(".isGiftWrapped").each(function(){x(this).remove()});G.attr("checked",!0);p(G);m.hide()},b)});x(document).delegate("div."+n+" input[type\x3d'radio']","change",function(a,c){a=x(this);if("setActive"===c&&!a.attr("disabled")&&b.removesGiftOptionOnRush()&&0<a.closest(".one-shipment").find(".isGiftWrapped").length&&1==a.data("nosupportforgiftoption"))G=a,a.is(":checked")&&(c=a.closest("div."+n).siblings("div."+n+".selected").find('input[type\x3d"radio"]'),G.attr("checked",
!1),c.attr("checked",!0)),setTimeout(function(){x("#faster-than-same-day-sosp-popover").trigger("click")},10);else{if("setActive"===c){if(a.attr("disabled"))return;a.attr("checked",!0)}if("disabling"===c)if(a.attr("disabled",!0),a.is(":checked"))a.removeAttr("checked");else return;p(a)}});x("div."+n+" input[type\x3d'radio']:checked").change();x("h3").children().removeAttr("style");0===x("div."+n+".scheduled-delivery").length&&x("form.checkout-page-form").data("checkoutFormReady",!0).change();h&&x(document).delegate(".a-touch-radio a",
"click",function(a){if(!b.isSOSPExclusiveJSHandlerWeblabOn()||e.isSosp()){var c=x(a.target).attr("href");!c||c.startsWith("#")||c.toLowerCase().startsWith("javascript:")||(l&&l.navigate?l.navigate({url:c,transition:"slide"}):a.preventDefault=!1)}})}function D(){if(1===x("div.store-upsell-ship-options").length){var a="/gp/buy/shared/handlers/store-upsell-async.html",b="ox_store_upsell_continue_",c=x("div.ship-speed, div.store-upsell-ship-options").find("input.shipping-option, input.store-upsell-ship-option"),
d=[],e;x.each(c,function(a,c){a=x(c);c=a.attr("value");d.push(c.toLowerCase());a.is(":checked")&&(e=a.attr("value"),b=a.hasClass("store-upsell-ship-option")?b+"success":b+"failure")});a=n.addQueryStringParameter(a,"ref",b);x.ajax({url:a,type:"POST",async:!0,data:{shown:d.toString(),clicked:e}})}}function u(a,b){q.when("checkout-federation-wrapper","shipspeed-provider").execute(function(c,d){c.wrap(function(){d&&!x.isEmptyObject(d)&&"function"===typeof d[a]&&d[a].apply(this,b)},"VasCheckoutShipSpeedProvider")})}
function w(a,b){q.when("checkout-federation-wrapper","sd-methods").execute(function(c,d){c.wrap(function(){d&&!x.isEmptyObject(d)&&"function"===typeof d[a]&&d[a].apply(this,b)},"CricketInlineCalendarHeavyBulkyIN")})}var x=a.$,z,f,t,J,v=0,C;a.declarative("sosp-change-quantity-link",["click"],function(a){var b=a.$currentTarget,c=x("\x3cinput type\x3d'hidden' /\x3e").attr("name","change-quantities-or-delete").val("1");b.hasClass("pipeline-link")?(a.$event.preventDefault(),b.closest("form").removeClass("checkout-page-form").append(c).find(".sosp-continue-button:first").trigger("click")):
b.closest("form").removeClass("checkout-page-form").append(c).find(".sosp-continue-button:first").trigger("click").end().trigger("submit")});q.when("A","a-sheet").register("shipoptionselect-gift-removal-controller-mobile",function(a,b){C=b.create({name:"gift-removal-popover",height:220,preloadDomId:"gift-option-removal-message",closeType:"icon",sheetType:"web"})});a.declarative("sosp-extender-toggle",["click","touchend"],function(a){if(!n.protectAgainstDoubleAction("sosp-extender-toggle")){var b=
a.$target.closest("a"),c=x(".delivery-window-groups .a-box-group").find(".lazy-loaded");if(b.hasClass("aui-extender"))c.length?c.remove():d(a);else{var e=b.find("i"),b=b.closest("div.extender-section");e.hasClass("a-icon-extender-expand")?(b.find(".collapsed").hide(),b.find(".expanded").slideDown("fast"),e.removeClass("a-icon-extender-expand").addClass("a-icon-extender-collapse"),d(a)):(b.find(".collapsed").show(),b.find(".expanded").slideUp("fast"),e.removeClass("a-icon-extender-collapse").addClass("a-icon-extender-expand"),
c.length&&c.remove())}}});a.declarative("sosp-select-prime-slot",["click","touchend"],function(a){if(!n.protectAgainstDoubleAction("sosp-select-prime-slot")){a=a.$currentTarget;var b=a.closest(".valid-slot");if(b.closest(".prime-calendar").hasClass("long-calendar")){var c=b.closest(".prime-calendar").data("orderid"),d=x("#calendar-"+c),c=x("#calendar-delivery-message-"+c),e=a.closest(".long-calendar");e.find(".selected-slot").removeClass("selected-slot");0<b.length&&b.addClass("selected-slot");x(".a-button-close").trigger("click");
b=a.data("slotid");b=d.find(".slot-"+b);if(0<b.length)d.show(),c.parent().hide(),b.closest(".prime-calendar").find(".selected-slot").removeClass("selected-slot"),b.closest(".valid-slot").addClass("selected-slot");else{var f=a.parent()[0],k=a.parent().parent().find(".rhead")[0],b=k.innerText;b||(b=k.textContent);f=f.cellIndex;e=e.find("th")[f];f=e.innerText;f||(f=e.textContent);c.text(f+" "+b);d.hide();c.parent().show()}}else c=b.closest(".prime-calendar-container").data("orderid"),d=x("#calendar-"+
c).find(".selected-slot"),0<d.length&&(d.removeClass("selected-slot"),0<b.length&&b.addClass("selected-slot"));d=a.closest(".prime-calendar-container").data("orderid");a.data("key")&&x("#order_"+d+"_ShippingSpeed").val(a.data("key"));a.data("isscheduleddeliveryslot")&&x("#sdData"+d).val(a.data("sddatastring"))}});a.declarative("sosp-select-delivery-window",["click","touchend"],function(a){if(!n.protectAgainstDoubleAction("sosp-select-delivery-window")){a=a.$currentTarget;a.length&&!a.hasClass("dwg-button")&&
(a=a.find(".dwg-button"));x(".dwg-button").removeClass("selected-dwg-button");a.addClass("selected-dwg-button");var b=a.closest(".delivery-window-groups").data("orderid"),c=a.data("key");!c&&a.find("button").length&&(c=a.find("button").data("key"));c&&x("#order_"+b+"_ShippingSpeed").val(c);c=a.data("isscheduleddeliveryslot");!c&&a.find("button").length&&(c=a.find("button").data("isscheduleddeliveryslot"));c&&(c=a.data("sddatastring"),!c&&a.find("button").length&&(c=a.find("button").data("sddatastring")),
x("#sdData"+b).val(c))}});a.on("checkout:reload:shipoptionselect",p);a.on("checkout:reload:spp-shipoption",p);a.on("checkout:reload:spp-f3-sosp",p);if(b.isVasTrueSPCEnabled())a.on("checkout:reload:spp-special-delivery-options",p)});q.when("jQuery","page-detector").register("deliv-prefs-sosp",function(a,m){function n(){a(".sosp .order-delivery-time-preference").each(function(){var e=a(this);e.bind("selectionChanged",function(){0===e.find(".delivery-time-preference-group").length?e.hide():(e.show(),
0===e.find("input:checked").length&&e.find("input:first").trigger("change",["setActive"]))}).bind("empty",function(){e.find(".delivery-time-preference-group").detach()});var g=e.closest(".one-shipment").find("input.shipping-option");e.find(".delivery-time-preference-group").each(function(){var g=a(this),h=g.data("shippingoptionid"),h=a("#"+h);g.is(".template")&&g.detach().removeClass("template");h.change(function(){e.trigger("empty");g.appendTo(e);e.trigger("selectionChanged")}).addClass("hasDeliveryTimePreference")});
g.not(".hasDeliveryTimePreference").change(function(g,h){"disabling"===h||a(this).is(":disabled")||(e.trigger("empty"),e.trigger("selectionChanged"))});e.trigger("selectionChanged")})}q.when("A").execute(function(a){a.on("checkout:reload:shipoptionselect",n)})});q.when("A","shipoptionselect-controller").execute(function(a){var m=a.$,n={},e={};a.on("checkout:reload:shipoptionselect",function(){var a=m("#shippingOptionFormId"),l=a.find("input[name\x3dtrialKey]");if(1===l.length){for(var h in n)n.hasOwnProperty(h)&&
(n[h].abort(),delete n[h]);n={};e={};var b=function(a){return a.join("::").replace(/\s+/g,"_")},d=function(){return m.map(a.find("input[type\x3dradio]:checked"),function(a){return a.name})},k=function(){return m.map(a.find("input[type\x3dradio]:checked"),function(a){return a.value})},c=function(a,b){if(n.hasOwnProperty(a)||e.hasOwnProperty(a))return!1;console.debug('initiating ajax call for trial key "'+a+'"');b=m.ajax({type:"POST",url:"/gp/buy/shipoptionselect/handlers/launch-delivery-trial.html",
contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",headers:{"x-amz-checkout-transition":"ajax"},data:b,dataType:"json",async:!0,success:function(b){b?console.debug('trial "'+a+'" success'):console.debug('trial "'+a+'" failed');e[a]=b;delete n[a]},error:function(b,c,d){delete n[a];"abort"!==d&&(console.debug("trial "+a+" error"),q.error("issue with set-delivery-options trial: "+c,d))},cache:!1});n[a]=b;return!0},p=function(){for(var a=k(),a=b(a),c=Object.keys(n),d=0;d<c.length;++d){var e=
c[d];e!==a&&(console.debug('removing ajax call for trial key "'+e+'"'),n[e].abort(),delete n[e])}};m(document).delegate("#shippingOptionFormId","change",function(e){e=k();if(b(e)!==l.val())a:{p(),e=d();var h=k(),n=b(h);l.val(n);var x=c(n,a.serialize()),n=0;x&&++n;for(var z=0;z<e.length;++z)for(var f=a.find('input[type\x3dradio][name\x3d"'+e[z]+'"][value!\x3d"'+h[z]+'"]'),t=0;t<f.length;++t){var J=f[t],x=h.slice(0);x[z]=J.value;for(var x=b(x),v=J.name,J=J.value,C=a.serializeArray(),A=0;A<C.length;++A)C[A].name===
v&&(C[A].value=J),"trialKey"===C[A].name&&(C[A].value=x);v=m.param(C);if((x=c(x,v))&&5===++n)break a}}});m(document).delegate("#shippingOptionFormId","submit",function(a){p()})}})});q.when("A","button-blocker","page-detector").register("scheduled-delivery-readiness-checker",function(a,m,n){function e(){n.isMobile()&&n.isSosp()&&h("div.scheduled-delivery").length&&(h(document).delegate("div."+d+":visible input[type\x3d'radio'].shipping-option","change",function(){l(h(this).closest("div."+d))}),a.on("active-shipment-changed",
l))}function g(a){b||(a.hasClass("scheduled-delivery-loading")?b=a.find(".loading-tooltip").text():a.hasClass("scheduled-delivery-picking")&&(b=a.find(".picking-tooltip").text()))}function l(a){b=null;a?g(a):h("div.one-shipment:visible div."+d+".scheduled-delivery").each(function(){var a=h(this);a.find("input").is(":checked")&&g(a)});b?m.show("scheduled-delivery",b):m.hide("scheduled-delivery")}var h=a.$,b,d=r.P&&r.P.AUI_BUILD_DATE?"selectable-box":"fake-label";if(n.isMobile())a.on("checkout:reload:shipoptionselect",
e);return{check:l}});"use strict";q.when("A","quantity-service","page-conductor","page-detector","ajax-utility","page-transition-controller","gift-utility","client-side-metrics").register("gift-form-base-controller",function(a,m,n,e,g,l,h,b){function d(a){a.is(":checked")||(ca?a.is(":checked")||a.closest("label").click():(b.increaseCount("removeauijs4"),a.attr("checked",!0).trigger("change")))}function k(a){a.attr("disabled","disabled");ca&&a.closest("div").bind("click.disable",function(a){a.stopPropagation()})}
function c(a){a.removeAttr("disabled");ca&&a.closest("div").unbind("click.disable")}function p(){q.when("a-dropdown").execute(function(a){var b=y(".select-recipient");b.empty();for(var c=0;c<B.length;c++){var d=y("\x3coption/\x3e").attr({value:B[c].value}).text(B[c].text);b.append(d)}b.each(function(){var b=y(this).closest(".gift-connection-section"),c=b.find(".include-gift-connection-checkbox").is(":checked"),d=b.find(".item-id").val(),e=b.find(".item-giftlist-type-id").val(),f;!e||"0"!==e&&"1"!==
e&&"2"!==e?e&&"3"===e&&(f=b.find(".item-giftlist-id").val()):f=e;!f&&c&&(c=b.find(".item-registry-id").val())&&Z&&Z[c]&&(f=Z[c]);f&&(a.setValue(y(this).attr("id"),f),(e&&"1"===e||"2"===e)&&b.find(".gift-connection-recipient-extra").removeClass("aok-hidden").show(),J(d))})})}function D(){y(".gift-connection-recipient-section").unbind("click").bind("click",function(){if(!Y)return y(this).find(".select-recipient-spinner").removeClass("aok-hidden").show(),!1});y(".select-recipient").each(function(){y(this).unbind("change").bind("change",
function(){var a=y(this),b=a.next().find(".a-dropdown-prompt"),c=y("\x3cdiv/\x3e").html(a.find(":selected").text()).clone().html();setTimeout(function(){b.html(c)},0)})});q.when("a-dropdown").execute(function(a){y(".gift-connection-section").each(function(){var b=y(this),c=b.find(".item-id").val(),d=b.find(".item-giftlist-type-id").val();b.find(".item-giftlist-id").val();var e=b.find(".item-occasion-id").val(),f=b.find(".item-occasion-month").val(),k=b.find(".item-occasion-day").val(),p=b.find(".item-age").val();
b.find("#input-recipient-first-name-"+c).unbind("keyup").keyup(function(){J(c)});b.find("#input-recipient-last-name-"+c).unbind("keyup").keyup(function(){J(c)});if("1"===d||"2"===d)a.setValue(b.find(".select-recipient").attr("id"),d),b.find(".gift-connection-recipient-extra").removeClass("aok-hidden").show();a.setValue(b.find(".select-occasion").attr("id"),e);a.setValue(b.find(".select-occasion-month").attr("id"),f);a.setValue(b.find(".select-occasion-day").attr("id"),k);a.setValue(b.find(".select-occasion-age").attr("id"),
p);if("1"===e||"2"===e)b.find(".gift-connection-occasion-extra").removeClass("aok-hidden").show(),"2"===d&&b.find(".select-occasion-age-row").removeClass("aok-hidden").show();"1"!==e&&"2"!==e&&"3"!==e&&J(c)})});var a="/gp/buy/pipeline/handlers/list-of-giftlists.html",b=y(".item-registry-id").map(function(){if(y(this).val())return y(this).val()}).get().join();b&&(a+="?fromRegistryIds\x3d"+b);B?(p(),y(".select-recipient-spinner").hide(),Y=!0):(Y=!1,y.ajax({type:"POST",url:a,dataType:"json",async:!0,
cache:!1,timeout:5E3,success:function(a){!B&&a.options&&0<a.options.length&&(B=a.options);a.registryIdMapping&&(Z=a.registryIdMapping);B&&p();y(".select-recipient-spinner").hide();Y=!0},error:function(a,b,c){y(".select-recipient-spinner").hide();Y=!0}}))}function u(){aa=[];a.state("giftNotificationEmailConstraints",[]);a.state("giftDeliveryDateConstraints",[]);y('[data-action\x3d"gift-form-element"]').each(function(){var a=y(this);a.is("span")?a.find("input, textarea, select:first").trigger({type:"change",
isInit:!0}):a.trigger({type:"change",isInit:!0})});y("textarea").unbind("keyup.gift-textarea click.gift-textarea").bind("keyup.gift-textarea click.gift-textarea",function(){y(this).trigger("change")});0<y(".enable-gift-connections").length&&D()}function w(a,b){var c=31;if("1"===b)c=0===a%4&&0!==a%100||0===a%400?29:28;else if("3"===b||"5"===b||"8"===b||"10"===b)c=30;return c}function x(a,b,c){a=g.jsonify(a);n.redirect(a)}function z(a){q.when("a-dropdown").execute(function(b){y(".gift-connection-recipient-extra-"+
a).hide();b.setValue("select-recipient-"+a,"0");y("#input-recipient-first-name-"+a).val("");y("#input-recipient-last-name-"+a).val("")})}function f(a){q.when("a-dropdown").execute(function(b){y(".gift-connection-occasion-extra-"+a).hide();b.setValue("select-occasion-"+a,"0");b.setValue("select-occasion-month-"+a,"0");b.setValue("select-occasion-day-"+a,"0");b.setValue("select-occasion-age-"+a,"-1");y("#occasion-has-reminder-checkbox-"+a).attr("checked",!0)})}function t(a,b){q.when("a-dropdown").execute(function(c){for(var d=
0;d<B.length;d++)b&&b===B[d].value&&B[d].bMonth&&B[d].bDay&&(c.setValue("select-occasion-month-"+a,B[d].bMonth),c.setValue("select-occasion-day-"+a,B[d].bDay))})}function J(a){q.when("a-dropdown").execute(function(b){var c=y("#select-recipient-"+a).find(":selected").val();"0"!==c&&("1"!==c&&"2"!==c||y("#input-recipient-first-name-"+a).val()||y("#input-recipient-last-name-"+a).val())?b.updateSelect("select-occasion-"+a,{status:"enabled"}):(f(a),b.updateSelect("select-occasion-"+a,{status:"disabled"}))})}
function v(a,b,c){"1"===b&&"2"===c?y("#select-occasion-age-row-"+a).removeClass("aok-hidden").show():y("#select-occasion-age-row-"+a).hide()}function C(){var a=y("#hidePricesCheckbox"),c=y("#kindle-reg-radio-your-account");ca?c.is(":checked")?y("#kindle-reg-radio-another-account").closest("label").click():a.is(":checked")||a.closest("label").click():(b.increaseCount("removeauijs6"),a.is(":checked")||a.attr("checked","checked").trigger("change"),c.is(":checked")&&(c.removeAttr("checked").trigger("change"),
y("#kindle-reg-radio-another-account").attr("checked","checked").trigger("change")))}function A(){var a=y("#hidePricesCheckbox"),c=y("#kindle-reg-radio-another-account");ca?c.is(":checked")?y("#kindle-reg-radio-your-account").closest("label").click():a.is(":checked")&&a.closest("label").click():(b.increaseCount("removeauijs7"),a.is(":checked")&&a.removeAttr("checked").trigger("change"),c.is(":checked")&&(c.removeAttr("checked").trigger("change"),y("#kindle-reg-radio-your-account").attr("checked",
"checked").trigger("change")))}function M(){y("#hidePricesCheckboxLabel").hide();var a=y("#hidePricesCheckbox");ca&&(a.is(":checked")||a.closest("label").click());a.attr("disabled",!0).hide().trigger("change");y("#kindle-reg-radio-another-account").attr("disabled",!0).trigger("change");y("#kindle-reg-radio-your-account").attr("disabled",!0).trigger("change");y("#hidePricesDisabledMessage").show();y("#hidePricesDisabledMessage").removeClass("aok-hidden");ca&&(y("label.a-touch-checkbox.hide-prices-checkbox").addClass("a-touch-selector-disabled").bind("click.disable",
function(a){a.stopPropagation()}),y("label.a-touch-radio.kindle-reg-option").addClass("a-touch-selector-disabled").bind("click.disable",function(a){a.stopPropagation()}))}function S(a){var b=!1;y(".afn-wrap-checkbox").each(function(){var a=y(this),a=a.is("input")?a:a.find("input");if(a.is(":checked"))return b=!0,!1});y(".mfn-no-wrap-radio").each(function(){var a=y(this),a=a.is("input")?a:a.find("input");if(!a.is(":checked"))return b=!0,!1});if(b)C(),M();else if(y("#hidePricesCheckbox").is(":disabled"))y("#hidePricesCheckboxLabel").show(),
y("#hidePricesCheckbox").removeAttr("disabled").show().trigger("change"),y("#kindle-reg-radio-another-account").removeAttr("disabled").trigger("change"),y("#kindle-reg-radio-your-account").removeAttr("disabled").trigger("change"),y("#hidePricesDisabledMessage").hide(),ca&&(y("label.a-touch-checkbox.hide-prices-checkbox").removeClass("a-touch-selector-disabled").unbind("click.disable"),y("label.a-touch-radio.kindle-reg-option").removeClass("a-touch-selector-disabled").unbind("click.disable"));else if(a.is("input")||
(a=a.find("input")),"hidePricesCheckbox"===a.attr("id"))a.is(":checked")?C():A();else if("kindle-reg-radio-another-account"===a.attr("id")||"kindle-reg-radio-your-account"===a.attr("id"))y("#kindle-reg-radio-your-account").is(":checked")?A():C()}function P(a){var b=y("#giftwrap-carousel-wrap-pane-"+a+" ul li").size();b&&(y("#giftwrap-carousel-wrap-holder-"+a).css("width",90*b),y("#giftwrap-carousel-wrap-pane-"+a).css("width",90*ha));G(a)}function G(a){y("#giftwrap-carousel-wrap-holder-"+a).find("ul li, ol li").each(function(b,
c){b=y(c);b.find("input").is(":checked")&&L(b,{itemId:a})})}function L(a,b){a.parent().find(".selected-giftwrap-image").removeClass("selected-giftwrap-image");a.find(".giftwrap-carousel-item-image").addClass("selected-giftwrap-image");a.parent().find(".wrap.a-button-selected").removeClass("a-button-selected");a.addClass("a-button-selected");var c=b.itemId;b=b.wrapNo;var d=n.isSPP(),e=a.find("input[type\x3dradio]");e.attr("checked",!0);d||(d=a.data("giftwrap-id"),e.val(d).change());var e=a.data("wrap-no"),
d=y("#giftwrap-option-preview-imagearea-default-"+c),f=y("#giftwrap-option-preview-imagearea-image-"+c),k=y(".selectedWrapLargeLink","#item-"+c),c=y(".wrapNo-"+c+"-"+b);a.hasClass("none-wrap")?(d.removeClass("aok-hidden"),f.addClass("aok-hidden"),k.length&&(k.addClass("aok-hidden"),k.removeClass("selectedWrapLargeLink"))):(a=a.find("img").attr("src"),f.find("img").attr("src",a),d.addClass("aok-hidden"),f.removeClass("aok-hidden"),k.length&&(k.addClass("aok-hidden"),k.removeClass("selectedWrapLargeLink")),
c.length&&(c.addClass("selectedWrapLargeLink"),c.removeClass("aok-hidden")));a=y(".selectedWrapLargeLink");c=y(".larger-image-link-carousel-"+e);a.removeClass("selectedWrapLargeLink").addClass("aok-hidden");c.removeClass("aok-hidden").addClass("selectedWrapLargeLink")}function V(a,b){var c;c=b.itemId;b=y("#giftwrap-option-preview-imagearea-default-"+c);c=y("#giftwrap-option-preview-imagearea-image-"+c);a.hasClass("none-wrap")?(b.removeClass("aok-hidden"),c.addClass("aok-hidden")):(a=a.find("img").attr("src"),
c.find("img").attr("src",a),b.addClass("aok-hidden"),c.removeClass("aok-hidden"))}function H(a,b){var c=b.itemId;b=y("#giftwrap-option-preview-imagearea-default-"+c);c=y("#giftwrap-option-preview-imagearea-image-"+c);if(a.parent().find(".selected-giftwrap-image").parents("li").hasClass("none-wrap"))b.removeClass("aok-hidden"),c.addClass("aok-hidden");else{var d=".selected-giftwrap-image img";n.isSPP()&&(d="img.selected-giftwrap-image");a=a.parent().find(d).attr("src");c.find("img").attr("src",a);
b.addClass("aok-hidden");c.removeClass("aok-hidden")}}function I(a,b){var c=a.find(".empty-message-warning"),d=a.find(".no-receipt-warning"),e=a.find("textarea");a=a.find(".message-counter");b&&!d.is(":visible")?(a.hide(),c.show(),e.addClass("gift-warning")):(c.hide(),e.removeClass("gift-warning"),a.show())}function T(a){var b=y("#"+a.id),c=h.getCharCount(b.val(),a.useByteSize),b=h.getLineCount(b.val(),a.maxChars/a.maxLines);return{length:c,charDelta:a.maxChars-c,lineDelta:a.maxLines-b}}function U(a,
b){b=y("#item-"+b.itemId);var c=a.is(":checked")&&!a.hasClass("mfn-no-wrap-radio");n.isSPP()&&y("#carouselGiftWrap").length&&(c=!a.hasClass("mfn-no-wrap-radio"));c?(b.find(".gift-message-pslip").hide(),b.find(".gift-message-card").show()):(b.find(".gift-message-card").hide(),b.find(".gift-message-pslip").show())}function W(b,c){var d=c.itemId;c=n.isSPP()?c.currentTab:b.data("current-tab");var e=y("#afn-gift-options-wrapper-"+d).data("active-tab");c!==e&&(b.parent().find(".selected-giftwrap-tab").removeClass("selected-giftwrap-tab"),
b.addClass("selected-giftwrap-tab"),y("#afn-gift-options-wrapper-"+d).data("active-tab",c),b="#item-"+d,e=n.isSPP()?y("#giftwrap-carousel-wrap-holder-"+d,b):b,e.length&&a.trigger("checkout:gift:changeCarouselWrapOptions",e,c,d),c=y(".none-wrap",y(b)).find("input"),c.prop("checked",!0),c.val("").change(),n.isSPP()?(c=y("#afn-gift-options-wrapper-"+d),c.length&&(c=c.data("active-tab"),a.trigger("checkout:gift:adaptCarouselGiftPanel",d,c))):a.trigger("checkout:gift:adaptCarousel",d),y("#giftwrap-carousel-wrap-holder-"+
d).removeClass("a-button-selected").find(".selected-giftwrap-image").removeClass("selected-giftwrap-image"),y("#giftwrap-carousel-item-image-"+d).addClass("selected-giftwrap-image").parents(".wrap").addClass("a-button-selected"),y("#giftwrap-option-preview-imagearea-default-"+d).removeClass("aok-hidden"),y("#giftwrap-option-preview-imagearea-image-"+d).addClass("aok-hidden"),c=y(".selectedWrapLargeLink"),c.length&&(c.addClass("aok-hidden"),c.removeClass("selectedWrapLargeLink")),c=n.isSPP(),b="#item-"+
d,y("#gift-message-noshi-warning-"+d).addClass("aok-hidden"),y("#includeMessageCheckbox-"+d).removeAttr("disabled"),c?y("#afn-message-span-"+d,y(b)).removeClass("aok-hidden"):(y("#afn-message-span",y(b)).removeClass("disable-message-area").addClass("enable-message-area"),y("#gift-message-heading-"+d).removeClass("disable-message-area").addClass("enable-message-area"),y("#message-area-"+d).removeAttr("disabled")))}var aa,ha=4,B,Y=!1,Z,y=a.$,ca=r.P&&r.P.AUI_BUILD_DATE&&e.isMobile(),da=h.getInput;a.declarative("save-gift-for-later",
["click"],function(a){l.show();a=a.$currentTarget.data("entityId")||a.data.entityId;m.call(a,0,{success:x})});q.register("gift-base/init-carousel",function(){return P});q.register("gift-base/set-carousel-size",function(){return function(a){ha=a}});var ba={toggleGiftDataAndDeliveryOptions:function(a){a=a.closest(".gift-options-wrapper");var b=da(a.find(".includeMessageCheckbox"));b&&b.is(":checked")?(a.find(".gift-delivery-option").show(),a.find(".item-wrap-span").show(),a.find(".item-wrap-row").show(),
a.find(".item-gift-message-span").show()):(a.find(".gift-delivery-option").hide(),a.find(".item-wrap-span").hide(),a.find(".item-wrap-row").hide(),a.find(".item-gift-message-span").hide())},toggleGiftDeliveryOptions:function(a){var b=a.closest(".gift-options-wrapper");a.is("input[type\x3dcheckbox]")?a.is(":checked")?b.find(".gift-notification-email").removeClass("a-form-disabled"):b.find(".gift-notification-email").addClass("a-form-disabled"):(b.find(".gift-notification-email").removeClass("a-form-disabled"),
a=b.find(".includeMessageCheckbox"),d(a.find("input[type\x3dcheckbox]")),ca&&(a=a.find("i.a-icon"),a.length&&(a.removeClass("a-icon-checkbox-inactive"),a.removeClass("a-icon-touch-checkbox-inactive"),a.addClass("a-icon-checkbox-active"),a.addClass("a-icon-touch-checkbox-active"))))},initGiftNotificationEmail:function(b){var c=a.state("giftNotificationEmailConstraints");c.push({id:b.attr("id")});a.state("giftNotificationEmailConstraints",c)},initGiftDeliveryDate:function(b){var c=a.state("giftDeliveryDateConstraints");
b.hasClass("year-select")||(b=b.parents("div.del-opt-date-section").find("select.year-select:first"));c.push({id:b.attr("id")});a.state("giftDeliveryDateConstraints",c)},updateDateDropdown:function(a){var b=a.closest(".gift-options-wrapper");a=b.find(".month-select").val();var c=b.find(".day-select");c.val();var b=b.find(".year-select").val(),d=w(b,a);if(c.hasClass("a-native-dropdown"))q.when("a-dropdown").execute(function(a){a=a.getSelect(c);if(a.getOptions().size()>d)for(var b=a.getOptions().size()-
1;b>=d;b--)a.removeOption(b);else for(b=a.getOptions().size();b<d;b++)a.addOption({text:b+1,value:b+1},b)});else{if(c.find("option").length>d)c.find("option:gt("+(d-1)+")").remove();else for(a=c.find("option").length+1;a<=d;a++)c.append(y("\x3coption\x3e",{value:a}).text(a));c.trigger("change")}},initSelectedTabAndWrapHolderWidth:P,initGiftMessage:function(a,b){ca&&!a.is("textarea")&&(a=a.find("textarea"));aa.push({id:a.attr("id"),maxChars:parseInt(b.maxChars,10),maxLines:parseInt(b.maxLines,10),
useByteSize:b.useByteSize});da(a.closest(".gift-options-wrapper").find(".includeMessageCheckbox")).is(":checked")||a.addClass("a-form-disabled");"1"===y("#multipleAFNGiftWrapOption").val()&&(a=a.attr("id").substring(a.attr("id").lastIndexOf("-")+1,a.attr("id").size),P(a))},enforceSelectorParity:S,enforceGiftReceiptParity:function(a,b){a=y("#item-"+b.itemId);if(0!==a.length){b=a.find(".item-receipt-row label");var e=da(a.find(".includeReceiptCheckbox")),f=a.find(".mfn-hide-price-row label"),p=da(a.find(".mfnHidePriceCheckbox")),
g=a.find(".item-message-row label"),h=da(a.find(".includeMessageCheckbox")).is(":checked"),l=!1;0<a.find(".afn-wrap-checkbox").length?da(a.find(".afn-wrap-checkbox")).is(":checked")&&(l=!0):0<a.find(".mfn-no-wrap-radio").length&&(da(a.find(".mfn-no-wrap-radio")).is(":checked")||(l=!0));if(l||h)d(e),d(p);l||h&&g.is(":visible")?(k(e),b.addClass("checkout-gift-option-disabled"),k(p),f.addClass("checkout-gift-option-disabled")):(c(e),c(p),b.removeClass("checkout-gift-option-disabled"),f.removeClass("checkout-gift-option-disabled"))}},
enforceHidePriceParity:function(a){var b=!1;y(".includeReceiptCheckbox").each(function(){if(da(y(this)).is(":checked"))return b=!0,!1});var c=!1;y(".mfnHidePriceCheckbox").each(function(){if(da(y(this)).is(":checked"))return c=!0,!1});b||c?(C(),y(".kindle-reg-msg-your-account").hide(),y(".kindle-reg-msg-another-account").show()):(A(),y(".kindle-reg-msg-another-account").hide(),y(".kindle-reg-msg-your-account").show())},toggleNoReceiptWarning:function(a){var c=da(a).is(":checked"),e=a.closest(".gift-options-wrapper");
a=e.find(".no-receipt-warning");var f=e.find(".empty-message-warning"),e=e.find(".item-message-row").find(".includeMessageCheckbox"),k=da(e);c?(a.hide(),e.is(":visible")||d(k)):(f.hide(),a.show(),k.is(":checked")&&(ca?k.is(":checked")&&k.closest("label").click():(b.increaseCount("removeauijs5"),k.removeAttr("checked").trigger("change"))))},toggleMessageArea:function(a){var b=a.closest(".gift-options-wrapper");if(a.is("textarea"))b=da(b.find(".includeMessageCheckbox")),d(b);else{a=da(b.find(".includeMessageCheckbox")).is(":checked");
var c=b.find(".item-message-row label").is(":visible"),e=0<b.find(".empty-message-warning").length,f=b.find("textarea"),k=f.data("default-text"),p=0<f.val().length;a?(b.find(".gift-message-edit").show(),b.find(".gift-message-label").removeClass("a-color-secondary"),f.removeClass("a-form-disabled"),k&&f.val(k)):(c&&b.find(".gift-message-edit").hide(),b.find(".gift-message-label").addClass("a-color-secondary"),f.addClass("a-form-disabled"),k&&f.val(""));e&&(a&&p?I(b,!1):I(b,!0))}},toggleMessageLocationText:U,
toggleMessageBoxDisplay:function(b,e){var f=y("#item-"+e.itemId);if(0!==f.length){var p=f.find(".item-message-row");e=f.find(".item-receipt-row");var g=f.find(".gift-message-on-card"),h=f.find(".gift-message-on-receipt"),l=p.find("label"),p=da(p.find(".includeMessageCheckbox")),t=a.trim(f.find(".gift-message-default-placeholder").text()),m=a.trim(f.find(".gift-message-with-wrap-placeholder").text()),f=f.find("textarea"),n=b.hasClass("mfn-no-wrap-radio")||b.closest("div").hasClass("mfn-no-wrap-radio");
da(b).is(":checked")&&!n?(h.hide(),g.show(),f.attr("placeholder",m),e.is(":visible")&&(d(p),l.is(":visible")&&(k(p),l.addClass("checkout-gift-option-disabled")))):(g.hide(),h.show(),f.attr("placeholder",t),c(p),l.removeClass("checkout-gift-option-disabled"))}},updateContinueButtons:function(){for(var b=!0,c,d=0;d<aa.length;d++)if(c=y("#"+aa[d].id),c.closest(".gift-options-wrapper").find(".includeMessageCheckbox").find('input[type\x3d"checkbox"]').is(":checked")&&(c=T(aa[d]),0>c.charDelta||0>c.lineDelta))b=
!1;b?(y(".save-gift-button-box span.a-button-primary:not(.a-button-disabled)").show(),y(".save-gift-button-box span.a-button-disabled").hide()):(y(".save-gift-button-box span.a-button-primary:not(.a-button-disabled)").hide(),b=y(".save-gift-button-box span.a-button-disabled"),b.removeClass("aok-hidden"),b.show());a.trigger("orderSummary:primaryActionButton:mirrorPanelBtnState")},updateMessageCounter:function(a){ca&&!a.is("textarea")&&(a=a.find("textarea"));for(var b,c=0;c<aa.length;c++)a.attr("id")===
aa[c].id&&(b=T(aa[c]));if(b){a=a.closest(".gift-options-wrapper");c=a.find(".message-counter");c.find(".remaining-count").hide();if(0<a.find(".empty-message-warning").length){if(0===b.length){I(a,!0);return}I(a,!1)}(-1>b.charDelta?c.find(".remaining-char-over-multiple").show():0>b.charDelta?c.find(".remaining-char-over-single").show():1===b.charDelta?c.find(".remaining-char-single").show():c.find(".remaining-char-multiple").show()).find(".chars-remaining").html(Math.abs(b.charDelta));(-1>b.lineDelta?
c.find(".remaining-line-over-multiple").show():0>b.lineDelta?c.find(".remaining-line-over-single").show():1===b.lineDelta?c.find(".remaining-line-single").show():c.find(".remaining-line-multiple").show()).find(".lines-remaining").html(Math.abs(b.lineDelta));c.show()}},updateSelectedGiftWrap:L,clearGiftConnection:function(a,b){y("#include-gift-connection-checkbox-"+b.itemId).is(":checked")||(z(b.itemId),J(b.itemId))},toggleGiftConnectionAgeDropdown:v,toggleGiftConnectionRecipientArea:function(a,b){a=
y("#select-recipient-"+b.itemId).find(":selected").val();var c=y("#select-occasion-"+b.itemId).find(":selected").val();!a||"1"!==a&&"2"!==a?(y(".gift-connection-recipient-extra-"+b.itemId).hide(),"1"===c&&a&&t(b.itemId,a)):y(".gift-connection-recipient-extra-"+b.itemId).removeClass("aok-hidden").show();v(b.itemId,c,a);J(b.itemId)},toggleGiftConnectionOccasionArea:function(a,b){a=y("#select-occasion-"+b.itemId).find(":selected").val();var c=y("#select-recipient-"+b.itemId).find(":selected").val();
!a||"1"!==a&&"2"!==a?y(".gift-connection-occasion-extra-"+b.itemId).hide():("1"===a&&c&&"1"!==c&&"2"!==c&&t(b.itemId,c),y(".gift-connection-occasion-extra-"+b.itemId).removeClass("aok-hidden").show());v(b.itemId,a,c)},includeGiftConnection:function(a,b){(a=y("#select-recipient-"+b.itemId).find(":selected").val())&&"0"===a||y("#include-gift-connection-checkbox-"+b.itemId).attr("checked",!0)},updateGiftOptionsTabSelection:W,updatePreviewImageOnMouseEnter:V,updatePreviewImageOnMouseLeave:H,toggleGiftMessageWarning:function(a){var b=
y("#"+a.attr("id"));h.toggleGiftMessageWarning(b,a.closest(".item-gift-message-span"))}};a.declarative("gift-form-element",["change"],function(a){var b;b=a.$event.isInit?a.data.onInit||[]:a.data.onChange||[];for(var c=0;c<b.length;c++)if(ba[b[c]])ba[b[c]](a.$target,a.data)});a.declarative("gift-form-element","click mouseenter mouseleave",function(a){var b;if(b=a.data[{click:"onClick",mouseenter:"mouseEnter",mouseleave:"mouseLeave"}[a.type]])for(var c=0;c<b.length;c++)if(ba[b[c]])ba[b[c]](a.$currentTarget,
a.data,a)});a.declarative("select-gift-wrap","click",function(a){L(a.$target.parents("li"),{itemId:a.data.itemId,wrapNo:a.data.wrapNo});S(a.$target);var b=a.$target.parents("li").find(".gift-hidden-radio");U(b,{itemId:a.data.itemId})});a.declarative("select-gift-wrap","mouseenter",function(a){V(a.$target.parents("li"),a.data)});a.declarative("select-gift-wrap","mouseleave",function(a){H(a.$target.parents("li"),a.data)});a.declarative("update-gift-options-tab-selection",["click"],function(a){var b=
a.$target.parents("li");b.attr("data",a.data);W(b,a.data)});a.on("checkout:reload:giftselect",u);a.on("checkout:reload:spp-giftoptions",u);return{extendFunctions:function(a){y.extend(ba,a)}}});"use strict";q.when("A","page-transition-controller","page-conductor").register("gift-form-del-opt-controller",function(a,m,n){function e(a){var b=a.closest(".expando-box");b&&(b=b.find(".a-expander-header"),a.closest(".expando-content").is(":hidden")&&b.click())}function g(a){var b=a.closest(".gift-options-wrapper"),
c=b.find(".includeMessageCheckbox").find('input[type\x3d"checkbox"]');if(c&&!c.is(":checked"))return!0;c=b.find(".email-error-selector");b.find(".gift-notification-email-error").hide();c.removeClass("a-form-error");if(64<r.unescape(encodeURIComponent(a.val())).length)return c.addClass("a-form-error"),b.find(".gift-notification-email-length-exceeded-error").removeClass("aok-hidden").show(),!1;if(/^\S+[@]\S+[.]\S+$/.test(a.val()))return!0;c.addClass("a-form-error");b.find(".gift-notification-invalid-email-error").removeClass("aok-hidden").show();
return!1}function l(){b("#giftForm").find(".save-gift-button-box span.a-button-primary:not(.a-button-disabled)").unbind("click").bind("click",function(a){a.preventDefault();h(a)});b(".checkout-gift-image-preview-trigger \x3e a").show();b("#gift-kindle-imb").show()}function h(d){d=b("#giftForm");var k=d.find('input[name\x3d"hidePrices"]'),c=k.is(":disabled");c&&k.removeAttr("disabled");for(var p=!0,h=a.state("giftNotificationEmailConstraints"),l=a.state("giftDeliveryDateConstraints"),w=0;w<h.length;w++){var x=
b("#"+h[w].id);g(x)||(p=!1,e(x))}for(h=0;h<l.length;h++){w=b("#"+l[h].id);var x=w.closest(".gift-options-wrapper"),z=x.find(".includeMessageCheckbox").find('input[type\x3d"checkbox"]');if(z&&!z.is(":checked"))x=!0;else{var f=x.find(".month-select").val(),t=x.find(".day-select").val(),z=x.find(".year-select"),J=z.val(),v=x.find("#current-date").val().split("-"),f=new Date(J,f,t),v=new Date(v[0],v[1]-1,v[2]),t=new Date(v.getTime());t.setMonth(t.getMonth()+12);x.find(".gift-delivery-date-error").hide();
J=x.find(".date-error-selector");z=z.hasClass("a-native-dropdown")?"error-border a-form-error":"a-form-error";J.removeClass(z);f>=t||f<v?(x.find(".gift-delivery-date-error").removeClass("aok-hidden").show(),J.addClass(z),x=!1):x=!0}x||(p=!1,e(w))}a.state("continueAction",{enable:p});if(a.state("continueAction").enable)n.isSPP()||m.showPageTransition(),d.submit();else return b("html, body").animate({scrollTop:b(".a-form-error").closest("div").offset().top},500),!1;c&&k.attr("disabled",!0)}var b=a.$;
a.declarative("submit-gift-options","click",function(a){h(a)});a.declarative("discard-gift-options","click",function(a){b('#giftForm input[type\x3d"checkbox"]').prop("checked",!1);b("#giftForm textarea").addClass("a-form-disabled");h(a)});a.on("checkout:reload:giftselect",l);a.on("checkout:reload:spp-giftoptions",l)});"use strict";q.when("A").register("teen-message-controller",function(a){var m=a.$;a.declarative("teen-message-form-element","click keyup",function(a){a=a.data.maxChars;var e=m("#teen-message-box").val(),
g=e.match(/(\r\n|\n|\r)/g),l=0;g&&(l=g.length);e=e.length+l;m(".remaining-char").text(Math.max(a-e,0))});m("#aui-teen-message-box").length&&m(".remaining-char").length&&q.when("A").execute(function(a){function e(a){a=a.val();var d=(a.match(/(\r\n|\n|\r|\n\r)/g)||{}).length||0;return a.length+d}a=a.$;var g,l,h;g=a("#aui-teen-message-box");g.bind("change keypress",function(a){return e(g)>=h?(a.preventDefault(),!1):!0});g.bind("paste",function(a){if(a&&a.originalEvent&&a.originalEvent.clipboardData&&
a.originalEvent.clipboardData.getData("Text")){var d=a.originalEvent.clipboardData.getData("Text"),k=e(g);if(k+d.length>=h)return d=d.substring(0,h-k),d=g.val()+d,g.attr("value",d),a.preventDefault(),!1}return!0});g.bind("click keyup",function(){var a=Math.max(h-e(g),0);l.text(a)});l=a(".remaining-char");h=g.parent().data("maxchars")})});"use strict";q.when("A","page-transition-controller","page-conductor","loading-spinner-controller","client-side-metrics").register("concealment-form-del-opt-controller",
function(a,m,n,e,g){function l(a){var e=b("#concealmentForm");e.find("input:checked").length?(a=a.data.saveConcealmentRefTag,g.increaseCount("CPEX.Checkout.Select.Concealment",1)):(a=a.data.cancelConcealmentRefTag,g.increaseCount("CPEX.Checkout.Cancel.Concealment",1));e.find("input[name\x3dref]").val(a);e.attr("action",e.attr("action")+"/ref\x3d"+a)}function h(a){a=b("#concealmentForm");n.isSPP()||m.showPageTransition();a.submit()}var b=a.$;a.declarative("submit-concealment-options","click",function(a){l(a);
h(a)});a.declarative("discard-concealment-options","click",function(a){b('#concealmentForm input[type\x3d"checkbox"]').prop("checked",!1);l(a);h(a)});a.declarative("submit-concealment-form","click",function(a){l(a);a.$target.closest(".a-button").addClass("a-button-disabled");e.showSpinner(a.$target.closest("form"))})});"use strict";q.when("A","page-transition-controller","page-conductor","address-popovers","checkout-general-utils","a-popover","client-side-metrics","weblab-helper","ajax-utility").register("itemselect-address-controller",
function(a,m,n,e,g,l,h,b,d){function k(){u(".lineitem").each(function(a,b){a=u(b);a.find(".no-js-address-dropdown").remove();a.find(".no-js-address-select").remove();a.find(".js-address-dropdown").prop("disabled",!1);a.find(".address-dropdown").removeClass("a-button-disabled")});u("#suppressAddAddressPopover").val()&&u('select[name^\x3d"addressID."]').find("option").each(function(){var a=u(this);"New"===a.val()&&a.closest("optgroup").remove()})}function c(a){var c=(new Date).getTime(),e=n.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});
b.isHeadersCleaned()?u.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-address\x26cachebuster\x3d"+c,data:a,dataType:"text",headers:e,error:n.ajaxRedirect,success:function(a,b,c){var e=c.getResponseHeader("x-amz-checkout-fatal-error");if(null!==e&&e!==H)r.location=e;else if(p(a)){a=d.jsonify(a);D(a,c);var k;c=f.find('input[name^\x3d"previousAddress."]');if(null!==c||c!==H)k=x||c.val();var h=f.find('select[name^\x3d"addressID."]');null===h&&h===H||q.when("a-dropdown").execute(function(a){a.setValue(h.attr("id").replace(/\./g,
"\\."),k);h.find("option").removeAttr("selected");h.find('option[value\x3d"'+k+'"]').attr("selected","selected")});m.hide()}else n.ajaxUpdatePage(a,b,c),g.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")}}):u.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-address\x26cachebuster\x3d"+c,data:a,dataType:"text",headers:e,error:n.ajaxRedirect,success:function(a,b,c){var d=c.getResponseHeader("x-amz-checkout-fatal-error");if(null!==d&&d!==H)r.location=
d;else if(p(c)){D(a,c);var e;a=f.find('input[name^\x3d"previousAddress."]');if(null!==a||a!==H)e=x||a.val();var k=f.find('select[name^\x3d"addressID."]');null===k&&k===H||q.when("a-dropdown").execute(function(a){a.setValue(k.attr("id").replace(/\./g,"\\."),e);k.find("option").removeAttr("selected");k.find('option[value\x3d"'+e+'"]').attr("selected","selected")});m.hide()}else n.ajaxUpdatePage(a,b,c),g.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")}})}function p(a){var c;if(b.isHeadersCleaned()){if(a=
d.jsonify(a))c=a.showAddonWarning}else c=a.getResponseHeader("x-amz-checkout-show-addon-warning");return null!==c&&c!==H}function D(a,c){b.isHeadersCleaned()?(c=a.showAddonWarning,a=a.asins):c=c.getResponseHeader("x-amz-checkout-show-addon-warning");u(".item-list").hide();a.trim().split(",").forEach(function(a){u('[data-asin\x3d"'+a+'"]').show()});a=u("#addon-warning-"+c+"-launcher");a.length&&(u(".delete-title").hide(),u(".reduce-title").hide(),u(".select-address-title").show(),u("input[name\x3duseLiveAUI]").length?
l.get(a).attrs({$trigger:z,position:"triggerHorizontal"}).show():(c=u.Event("keyup",{triggerPositioningElement:z,manualTrigger:!0}),a.trigger(c)))}var u=a.$,w,x,z,f;a.declarative("itemselect-get-address",["click","touchend"],function(a){g.protectAgainstDoubleAction("itemselect-get-address",200)||(x=a.$currentTarget.find(".js-address-dropdown").val())});a.declarative("itemselect-update-address",["change"],function(a){if(!g.protectAgainstDoubleAction("itemselect-update-address",200)){h.resetMetrics();
var b=a.$currentTarget.is("select")?a.$currentTarget:a.$currentTarget.find("select");w=b.val();if("New"===w)e.actionTriggerPopoverFromDropdown(a),q.when("a-dropdown").execute(function(a){a.setValue(b.attr("id").replace(/\./g,"\\."),x)});else{m.show();f=b.closest(".lineitem");var d,k;if(f){var p=f.find('input[name^\x3d"lineItemEntityID."]');p&&(d=p.val());(p=f.find('input[name^\x3d"quantity."]'))&&(k=p.val());(p=f.find(".js-address-dropdown"))&&(w=p.val())}z=a.$currentTarget.is("select")?a.$currentTarget.closest(".address-dropdown"):
a.$currentTarget;a=0;p=u("#addon-indicator");p.length&&"true"===p.attr("data-has-addon-items")&&(a=1);c({lineitems:d,addresses:w,quantities:k,isTrial:a})}}});a.declarative("itemselect-update-pantry-address",["change"],function(a){if(!g.protectAgainstDoubleAction("itemselect-update-pantry-address",200)){w=a.$currentTarget.val();m.show();var b="";a=a.$currentTarget.closest(".pantry-row");u(a).find(".pantry-item").each(function(a,c){a=u(c);b+="lineitems\x3d"+a.find('input[name^\x3d"lineItemEntityID."]').val()+
"\x26";b+="addresses\x3d"+w+"\x26";b+="quantities\x3d"+a.find('input[name^\x3d"quantity."]').val()+"\x26"});c(b)}});a.declarative("addon-delete-items",["click","touchend"],function(a){if(z!==H&&null!==z&&!g.protectAgainstDoubleAction("itemselect-delete-addons",200)){u(".a-button-close").trigger("click");m.show();a=(new Date).getTime();var b=u("#useCase").val(),c=n.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"}),d=f.find('input[name^\x3d"lineItemEntityID."]').val(),e=f.find('input[name^\x3d"quantity."]').val();
u.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-address\x26cachebuster\x3d"+a,data:{lineitems:d,addresses:w,quantities:e,isTrial:0,deleteAddons:1,returnHTML:1,useCase:b},headers:c,error:n.ajaxRedirect,success:function(a,b,c){var d=c.getResponseHeader("x-amz-checkout-redirect-to-cart");null!==d&&d!==H?r.location=d:(d=c.getResponseHeader("x-amz-checkout-fatal-error"),null!==d&&d!==H?r.location=d:(n.ajaxUpdatePage(a,b,c),g.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")))}})}});
a.on("checkout:reload:itemselect",k);a.on("checkout:reload:spp-itemselect",k)});"use strict";q.when("A","page-transition-controller","page-conductor","checkout-general-utils","a-popover","client-side-metrics","weblab-helper","ajax-utility").register("itemselect-delete-controller",function(a,m,n,e,g,l,h,b){function d(a,b){k(a,null===b||b===H?a.$currentTarget.closest(".lineitem"):b)}function k(a,b){a.$event.preventDefault();if(!e.protectAgainstDoubleAction("itemselect-delete-single-item",200)){l.resetMetrics();
m.show();x=b;f=a.$currentTarget.is("select")?a.$currentTarget.closest(".quantity-dropdown"):a.$currentTarget;a=x.find('input[name^\x3d"lineItemEntityID."]').val();b=0;(new Date).getTime();var c=w("#addon-indicator");c.length&&"true"===c.attr("data-has-addon-items")&&(b=1);p({lineitems:a,isTrial:b})}}function c(a,b){a.$event.preventDefault();if(!e.protectAgainstDoubleAction("itemselect-delete-multiple-items",200)){m.show();z=b;f=a.$currentTarget;var c="";a=0;b=w("#addon-indicator");b.length&&"true"===
b.attr("data-has-addon-items")&&(a=1);b=z.hasClass("pantry-row")?!0:!1;z.find(b?".pantry-item":".lineitem").each(function(a,b){c+="lineitems\x3d"+w(b).find('input[name^\x3d"lineItemEntityID."]').val()+"\x26"});p(c+"isTrial\x3d"+a)}}function p(a){var b=(new Date).getTime(),c=w('input[name\x3d"useCase"]').val(),d=n.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});w.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3ddelete\x26useCase\x3d"+c+"\x26cachebuster\x3d"+
b,data:a,dataType:"text",headers:d,error:n.ajaxRedirect,success:D})}function D(a,c,d){var f;f=d.getResponseHeader("x-amz-checkout-redirect-to-cart");null!==f&&f!==H?(r.location=f,f=!0):f=!1;if(!f)if(f=d.getResponseHeader("x-amz-checkout-fatal-error"),null!==f&&f!==H)r.location=f;else{var k;if(h.isHeadersCleaned()){if(f=b.jsonify(a))k=f.showAddonWarning}else k=d.getResponseHeader("x-amz-checkout-show-addon-warning");k=null!==k&&k!==H?!0:!1;k?(u(a,d),m.hide()):(n.ajaxUpdatePage(a,c,d),e.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"))}}
function u(a,c){h.isHeadersCleaned()?(a=b.jsonify(a),c=a.showAddonWarning,a=a.asins):c=c.getResponseHeader("x-amz-checkout-show-addon-warning");w(".item-list").hide();a.trim().split(",").forEach(function(a){w('[data-asin\x3d"'+a+'"]').show()});a=w("#addon-warning-"+c+"-launcher");a.length&&(w(".delete-title").show(),w(".reduce-title").hide(),w(".select-address-title").hide(),w("input[name\x3duseLiveAUI]").length?g.get(a).attrs({$trigger:f,position:"triggerHorizontal"}).show():(c=w.Event("keyup",{triggerPositioningElement:f,
manualTrigger:!0}),a.trigger(c)))}var w=a.$,x,z,f;a.declarative("itemselect-delete-item",["click","touchend"],d);a.declarative("itemselect-delete-item-row",["click","touchend"],function(a){c(a,a.$currentTarget.closest(".item-row"))});a.declarative("addon-delete-items",["click","touchend"],function(a){if(f!==H&&!e.protectAgainstDoubleAction("itemselect-delete-addons",200)){w(".a-button-close").trigger("click");m.show();var b="";null!==z&&z!==H?(a=z.hasClass("pantry-row")?z.find(".pantry-item"):z.find(".lineitem"),
w(a).each(function(a,c){b+="lineitems\x3d"+w(c).find('input[name^\x3d"lineItemEntityID."]').val()+"\x26"})):null!==x&&x!==H&&(b+="lineitems\x3d"+x.find('input[name^\x3d"lineItemEntityID."]').val()+"\x26");p(b+"isTrial\x3d0\x26deleteAddons\x3d1")}});a.declarative("itemselect-delete-pantry-item",["click","touchend"],function(a){k(a,a.$currentTarget.closest(".pantry-item"))});a.declarative("itemselect-delete-pantry",["click","touchend"],function(a){c(a,a.$currentTarget.closest(".pantry-row"))});a.declarative("itemselect-delete-popover-item",
["click","touchend"],function(a){var b=a.$currentTarget.data("entityidtodelete");c(a,w('a[data-entityid\x3d"'+b+'"]').closest(".item-row"))});return{actionDeleteItem:d}});"use strict";q.when("A","page-transition-controller","page-conductor","itemselect-delete-controller","checkout-general-utils","a-popover","client-side-metrics","weblab-helper","ajax-utility").register("itemselect-quantity-controller",function(a,m,n,e,g,l,h,b,d){function k(){z(".lineitem, .pantry-item").each(function(a,b){a=z(b);
a.find(".no-js-quantity").remove();b=a.find(".quantity-dropdown");b.is(":visible")?(a.find(".js-select").prop("disabled",!1),b.removeClass("a-button-disabled")):(a=a.find(".quantity-input"),a.prop("disabled",!1),a.removeClass("a-form-disabled"))})}function c(a){a.find(".quantity-input").val(a.find('input[name^\x3d"previousQuantity."]').val())}function p(a){var b=a.$currentTarget.closest(".quantity-text-field").find(".update-quantity-link"),d=a.$currentTarget.is("input")?a.$currentTarget.val():a.$currentTarget.find("input").val(),
e;e="itemselect-show-update-pantry-button"===a.action?".pantry-item":".lineitem";0===parseInt(d,10)||""===d?("change"===a.type&&c(a.$currentTarget.closest(e)),b.hide()):(a=a.$currentTarget.closest(e).find('input[name^\x3d"previousQuantity."]').val(),d!==a?b.show():b.hide())}function D(a){a.$event.preventDefault();if(!g.protectAgainstDoubleAction("itemselect-update-quantity",200)){h.resetMetrics();J=a.$currentTarget.closest("itemselect-update-pantry-quantity"===a.action||"itemselect-update-pantry-quantity-text-field"===
a.action?".pantry-item":".lineitem");var k=J.find(".js-address-dropdown").val(),p=a.$currentTarget.find("select"),l=p.length?p:a.$currentTarget;f=l.is("select")?l.val():J.find(".quantity-input").val();if(0===parseInt(f,10)||""===f)c(J);else if("Delete"===f)q.when("a-dropdown").execute(function(a){a.setValue(l.attr("id").replace(/\./g,"\\."),t)}),e.actionDeleteItem(a,J);else{m.show();a=J.find('input[name^\x3d"lineItemEntityID."]').val();var p=0,D=(new Date).getTime(),G=z("#useCase").val(),L=z("#addon-indicator");
v=l.is("select")?l.parent():J.find(".quantity-input");L.length&&"true"===L.attr("data-has-addon-items")&&(p=1);L=n.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});b.isHeadersCleaned()?z.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-quantity\x26cachebuster\x3d"+D,data:{lineitems:a,quantities:f,address:k,isTrial:p,returnHTML:1,useCase:G},dataType:"text",headers:L,error:n.ajaxRedirect,success:function(a,b,c){var e=c.getResponseHeader("x-amz-checkout-fatal-error");
null!==e&&e!==H?r.location=e:w(a)?(a=d.jsonify(a),x(a,c),u(t===H?J.find('input[name^\x3d"previousQuantity."]').val():t,c),m.hide()):(n.ajaxUpdatePage(a,b,c),g.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"))}}):z.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-quantity\x26cachebuster\x3d"+D,data:{lineitems:a,quantities:f,address:k,isTrial:p,returnHTML:1,useCase:G},dataType:"text",headers:L,error:n.ajaxRedirect,success:function(a,b,c){var d=c.getResponseHeader("x-amz-checkout-fatal-error");
null!==d&&d!==H?r.location=d:w(c)?(x(a,c),u(t===H?J.find('input[name^\x3d"previousQuantity."]').val():t,c),m.hide()):(n.ajaxUpdatePage(a,b,c),g.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"))}})}}}function u(a,b){10>a?(q.when("a-dropdown").execute(function(b){var c=J.find('select[name^\x3d"quantity."]');b.setValue(c.attr("id").replace(/\./g,"\\."),a);c.find("option").removeAttr("selected");c.find('option[value\x3d"'+a+'"]').attr("selected","selected")}),J.find(".quantity-dropdown").show(),
J.find(".quantity-text-field").hide(),J.find(".js-select").prop("disabled",!1),J.find(".quantity-input").prop("disabled",!0)):(J.find(".quantity-dropdown").hide(),J.find(".quantity-text-field").show(),J.find(".update-quantity-link").hide(),J.find(".js-select").prop("disabled",!0),J.find(".quantity-input").prop("disabled",!1));J.find(".quantity-input").val(a);J.find('input[name^\x3d"previousQuantity."]').val(a)}function w(a){var c;if(b.isHeadersCleaned()){if(a=d.jsonify(a))c=a.showAddonWarning}else c=
a.getResponseHeader("x-amz-checkout-show-addon-warning");return null!==c&&c!==H?!0:!1}function x(a,c){b.isHeadersCleaned()?(c=a.showAddonWarning,a=a.asins):c=c.getResponseHeader("x-amz-checkout-show-addon-warning");z(".item-list").hide();a.trim().split(",").forEach(function(a){z('[data-asin\x3d"'+a+'"]').show()});a=z("#addon-warning-"+c+"-launcher");a.length&&0<a.length&&(z(".reduce-title").show(),z(".delete-title").hide(),z(".select-address-title").hide(),z("input[name\x3duseLiveAUI]").length?l.get(a).attrs({$trigger:v}).show():
(c=z.Event("keyup",{triggerPositioningElement:v,manualTrigger:!0}),a.trigger(c)))}var z=a.$,f,t,J,v;a.declarative("itemselect-get-quantity",["click","touchend"],function(a){g.protectAgainstDoubleAction("itemselect-get-quantity",200)||a.$currentTarget.find("select").length&&(t=a.$currentTarget.find("select").val())});a.declarative("itemselect-update-quantity",["change"],D);a.declarative("itemselect-update-pantry-quantity",["change"],D);a.declarative("addon-delete-items",["click","touchend"],function(a){if(v!==
H&&!g.protectAgainstDoubleAction("itemselect-delete-addons",200)){z(".a-button-close").trigger("click");m.show();a=J.find('input[name^\x3d"lineItemEntityID."]').val();var b=(new Date).getTime(),c=z("#useCase").val(),d=n.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});z.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-quantity\x26cachebuster\x3d"+b,data:{lineitems:a,quantities:f,isTrial:0,deleteAddons:1,returnHTML:1,useCase:c},headers:d,error:n.ajaxRedirect,
success:function(a,b,c){var d=c.getResponseHeader("x-amz-checkout-redirect-to-cart");null!==d&&d!==H?r.location=d:(d=c.getResponseHeader("x-amz-checkout-fatal-error"),null!==d&&d!==H?r.location=d:(n.ajaxUpdatePage(a,b,c),g.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")))}})}});a.declarative("itemselect-sanitize-input",["keydown"],function(a){g.limitInputToNumbers(a)});a.declarative("itemselect-update-quantity-text-field",["click","touchend"],D);a.declarative("itemselect-update-pantry-quantity-text-field",
["click","touchend"],D);a.declarative("itemselect-show-update-button",["change","keyup"],p);a.declarative("itemselect-show-update-pantry-button",["change","keyup"],p);a.on("checkout:reload:itemselect",k);a.on("checkout:reload:spp-itemselect",k)});"use strict";q.when("A","page-transition-controller","page-conductor","checkout-general-utils","client-side-metrics").register("itemselect-ship-to-multiple-controller",function(a,m,n,e,g){var l=a.$;a.declarative("itemselect-ship-to-multiple",["click","touchend"],
function(a){a.$event.preventDefault();g.resetMetrics();if(!e.protectAgainstDoubleAction("itemselect-ship-to-multiple",200)){m.show();var b=null,d=null,k=null;a.$currentTarget.closest(".item-row").find(".lineitem").each(function(a,c){a=l(c);c=a.find('select[name^\x3d"quantity."]');var e=a.find('input[type\x3d"number"]');if(a.find(".quantity-dropdown").is(":visible")&&1<c.val())return b=a.find('input[name^\x3d"lineItemEntityID."]').val(),d=c.val(),k=a.find(".js-address-dropdown").val(),!1;if(a.find(".quantity-text-field").is(":visible")&&
1<e.val())return b=a.find('input[name^\x3d"lineItemEntityID."]').val(),d=e.val(),k=a.find(".js-address-dropdown").val(),!1});if(null!==b){a=(new Date).getTime();var c=n.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});l.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dship-to-multiple\x26cachebuster\x3d"+a,data:{lineitem:b,quantity:d,address:k},headers:c,dataType:"text",error:n.ajaxRedirect,success:function(a,b,c){var d=c.getResponseHeader("x-amz-checkout-fatal-error");
null!==d&&d!==H?r.location=d:(n.ajaxUpdatePage(a,b,c),e.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"))}})}}})});"use strict";q.when("A").register("safe-apx-helper",function(a){var m={},n=a.$;return{get:function(a){return m[a]},set:function(){1===arguments.length?m=n.extend(m,arguments[0]):2===arguments.length?m[arguments[0]]=arguments[1]:r.console&&r.console.error&&r.console.error("Unexpected number of arguments: %d. Expected 1 or 2.",arguments.length)}}});"use strict";q.when("A",
"weblab-helper").register("mobile-carrier-billing-util",function(a,m){var n=!1;return{determineIsMCBEnabled:function(a){n=0<a.paymentRows.find('input[type\x3d"radio"][name\x3dpaymentMethod]').filter("[value^\x3dMCB]").size()},toggleGCForMCB:function(a,g){if(!m.isMCBMultiTenderWeblabEnabled()&&n&&(a=a.find('input[type\x3d"radio"][name\x3dpaymentMethod]'),a.length)){var l=g.paymentRows.find('input[type\x3d"checkbox"][name\x3duseAvailableBalance]'),l=g.existingBalance||l,h=0<g.paymentRows.find('input[type\x3d"hidden"][name\x3d"gcBalance"]').length,
b="paymentsForm"in g&&0<g.paymentsForm.find('input[type\x3d"hidden"][name\x3d"gcBalance"]').length,h=h||b;0<a.filter("[value^\x3dMCB]").size()&&h?(l.length&&(l.prop("checked",!1),l.prop("disabled",!0)),g.mcbBalanceWarning&&g.mcbBalanceWarning.show()):(l.length&&l.prop("disabled",!1),g.mcbBalanceWarning&&g.mcbBalanceWarning.hide())}},showMCBWarningMessageForPoints:function(a){n&&a.mcbPointsWarning&&a.mcbPointsWarning.show()},hideMCBWarningMessageForPoints:function(a){n&&a.mcbPointsWarning&&a.mcbPointsWarning.hide()}}});
"use strict";q.when("A").register("emi-utils",function(a){return{}});"use strict";q.when("A").register("emi-helper",function(a){return{}});"use strict";q.when().register("instant-bank-discount-helper",function(){return{showInstantBankDiscountAmazonPayDeselected:function(){},showInstantBankDiscountAmazonPaySelected:function(){}}});"use strict";q.when("A","page-detector","checkout-general-utils").register("pay-common-lib",function(a,m,n){function e(a,b){b.attr("name")&&(a[b.attr("name")]=b.val());b.attr("id")&&
(a[b.attr("id")]=b.val())}function g(a,b){if(!b)return a;for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);return a}function l(a,b,d){h.each(b,function(b,c){a[b]=d?d.find(c):h(c)})}var h=a.$,b="checkbox hidden password radio text number tel month".split(" "),d={};a.declarative("move-to-next-field",["keypress"],function(a){13===a.$event.charCode&&(n.moveToNextInput(a.$declarativeParent),a.$event.preventDefault())});a.declarative("scroll-to-input",["keypress"],function(a){13===a.$event.charCode&&(h(r).scrollTop(a.$declarativeParent.offset().top),
a.$event.preventDefault())});return{getAttributeData:function(a,b){if(a)return a.attr(b)||a.attr("data-"+b)||a.data(b)},getElements:function(a,b){var d={};l(d,a,b);return d},getInputValues:function(a){var c=a.find(".data-row").data()||{};a.find("input").each(function(){var a=h(this),d=a.attr("type");("radio"!==d&&"checkbox"!==d||a.is(":checked"))&&-1<h.inArray(d,b)&&e(c,a)});a.find("select").each(function(){e(c,h(this))});return c},isDesktopCX:m.isDesktopPayment,isMobileCX:m.isMobilePayment,isPayPage:m.isPayment,
isTouchCX:m.isTabletPayment,mergeFrom:function(a,b){b=g({},b);return g(b,a)},prop:function(a,b,e){if(a){if(1<arguments.length)return b===H?delete d[a]:d[a]={isOneTime:e?1:0,value:b},b;var g=d[a];if(g)return g.isOneTime&&delete d[a],g.value}},refreshElements:l,scrollTopTo:function(a){a&&a.length&&h("html,body").animate({scrollTop:a.offset().top-20},"fast")},selectDefaultPaymentMethodIfNotSelected:function(){var a=h("#existing-payment-methods .payment-row").find('input[type\x3d"radio"][name\x3d"paymentMethod"]'),
b=a.closest("div.payment-selected");b&&0<b.length||(a=a.closest("div.default-payment-marker"))&&a.length&&(a.addClass("payment-selected"),a.find("[name\x3dpaymentMethod]").attr("checked",!0))},processSubmissionParameters:function(a){for(var b={},d=0;d<a.length;d++)b[a[d].name]=a[d].value;return b}}});"use strict";q.when("A","pay-common-lib","a-popover-base","ajax-utility","loading-spinner-controller","page-conductor","page-transition-controller").register("pay-desktop-util",function(a,m,n,e,g,l,h){function b(a){a.$event.preventDefault();
a.$target.closest(".a-popover").hide();a.$target.siblings("span.error-message").hide()}function d(a){a.preventDefault();var b=t(a.currentTarget),c=b.closest("div.expando-section");a=c.find("div.expando-content");var c=c.find("div.expando-reverse-content"),d=a.is(":visible"),e=function(){var a=b.find("i");a.hasClass("a-icon-collapse")||a.hasClass("a-icon-expand")?d?(a.removeClass("a-icon-collapse").addClass("a-icon-expand"),b.find("div.expando-toggle-text-show").show(),b.find("div.expando-toggle-text-hide").hide()):
(a.removeClass("a-icon-expand").addClass("a-icon-collapse"),b.find("div.expando-toggle-text-show").hide(),b.find("div.expando-toggle-text-hide").show()):d?(a.removeClass("a-icon-section-collapse").addClass("a-icon-section-expand"),b.find("div.expando-toggle-text-show").show(),b.find("div.expando-toggle-text-hide").hide()):(a.removeClass("a-icon-section-expand").addClass("a-icon-section-collapse"),b.find("div.expando-toggle-text-show").hide(),b.find("div.expando-toggle-text-hide").show())};d?(c.slideDown("fast"),
a.slideUp("fast",e)):(c.slideUp("fast"),a.slideDown("fast",e))}function k(a){var b=a.$target.closest("a");a=b.closest("div.extender-section");b=b.find("i");b.hasClass("a-icon-extender-expand")?(a.find(".collapsed").hide(),a.find(".expanded").slideDown("fast"),b.removeClass("a-icon-extender-expand").addClass("a-icon-extender-collapse")):(a.find(".collapsed").show(),a.find(".expanded").slideUp("fast"),b.removeClass("a-icon-extender-collapse").addClass("a-icon-extender-expand"))}function c(a){M.msgPopovers.filter(":visible").hide();
a.$event.preventDefault();a.$event.stopPropagation();a=a.$target.parent().find(".a-popover");a.is(":visible")||a.show()}function p(a,b,c){var d=a||{},e="string"===typeof a;c=c&&c.useSif?t('input[type\x3d"hidden"][name\x3d"isAmazonApp"]').val():0;e?(d+="\x26ajaxResponse\x3d1\x26returnjson\x3d1",c&&(d+="\x26isAmazonApp\x3d1")):(d.ajaxResponse=1,d.returnjson=1,c&&(d.isAmazonApp=1));for(c=0;c<A.length;c++){var f=A[c],k=t("input[name\x3d"+f+"]").val();e?-1===b.search(f)&&-1===a.search(f)&&(d=d+"\x26"+
f+"\x3d"+k):d[f]=k}return d}function D(a,b){if(0>a)return 0;isNaN(b)||(a=Number(a).toFixed(b));a=a.toString();b=0<=a.lastIndexOf(".")?a.lastIndexOf("."):a.length;return 3>=b?a:D(a.substring(0,b-3),0)+","+a.substring(b-3)}function u(a,b,c,d){a="timeout"===b?"pay-ajax-timeout":"abort"===b?"pay-ajax-abort":"abort-for-cleanup"===b?"pay-ajax-abort-for-cleanup":"parsererror"===b?"pay-ajax-parsererror":500===a.status?"pay-ajax-500":"pay-ajax-error";if(c){a=c=-1===c.lastIndexOf(".html?")?c+("?ref\x3d"+a):
c+("\x26ref\x3d"+a);M.pageContainer.find("#tempForm").remove();c=t('\x3cform id\x3d"#tempForm" method\x3d"post"\x3e\x3c/form\x3e');c.attr("action",a);if("string"===typeof d){a={};b=d.split("\x26");for(var e=0;e<b.length;e++){var f=b[e].split("\x3d");2===f.length&&(a[f[0]]=f[1])}}else a=d;for(var k in a)"ajaxResponse"!==k&&"returnjson"!==k&&(a=t('\x3cinput type\x3d"hidden"/\x3e').attr("name",k).val(d[k]),c.append(a));M.pageContainer.append(c);c.submit()}}function w(a,b,c,d){var f=l.setAjaxTransitionHeader({"x-amz-checkout-page":"payselect"}),
f={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:p(b,a,d),dataType:"text",headers:f,timeout:v,type:"POST",url:a,beforeSend:function(a,b){c&&c.beforeHandler&&c.beforeHandler(a,b)},complete:function(a,b){c&&c.completeHandler&&c.completeHandler(a,b)},error:function(d,e){c&&c.errorHandler?c.errorHandler(d,e):u(d,e,a,b)},success:function(a,b,d){var f=d.getResponseHeader("x-amz-checkout-page");if("payselect"!==f&&"spp-payment"!==f)return a=e.jsonify(a),l.redirect(a);c&&c.successHandler?
c.successHandler(a,b,d):l.ajaxUpdatePage(a,b,d)}};t.extend(f,d);C.push(t.ajax(f))}function x(a,b,c,d){var e=l.setAjaxTransitionHeader({"x-amz-checkout-page":"payselect"}),e={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:p(b,a,d),dataType:"text",headers:e,timeout:v,type:"POST",url:a,error:function(d,e){c&&c.errorHandler?c.errorHandler(d,e):u(d,e,a,b)},success:function(a,b,d){var e=d.getResponseHeader("x-amz-checkout-page");"payselect"!==e&&"spp-payment"!==e&&c&&c.pageUpdater?
c.pageUpdater(a):l.ajaxUpdatePage(a,b,d)}};t.extend(e,d);C.push(t.ajax(e))}function z(){v=parseInt(t("input[type\x3d'hidden'][name\x3d'paypageTimeoutValue']").val(),10);v=isNaN(v)?1E4:v;m.isMobileCX()?r&&(r=!1):(M=m.getElements(q),r&&(a.declarative("close-popover",["click"],b),a.declarative("toggle-msg-popover",["click"],c),a.declarative("a-extender-toggle",["click"],k),r=!1),M.pageContainer.undelegate(".expando-link","click").delegate(".expando-link","click",d),M.pageContainer.find("form select.a-touch-select-input").unbind("change",
f).bind("change",f),t(".a-dropdown-container").each(function(){n.remove(t(this).find("select").attr("name"))}),t(document).bind("click",function(a){a.isPropagationStopped()||0===t(a.target).closest(".pay-popover-msg").length&&M.msgPopovers.filter(":visible").hide()}))}function f(a){var b=t(a.currentTarget);a=b.siblings("a.a-placeholder");b=b.find(":selected").text();a.html(b);return!1}var t=a.$,r=!0,v,C=[],A=["forceResponsive","fromAnywhere","hasWorkingJavascript"],M={},q={msgPopovers:"div.pay-popover-msg",
pageContainer:"div.a-container"};a.on("checkout:reload:payselect",z);a.on("checkout:reload:spp-payment",z);return m.mergeFrom({decodeJSONResponse:function(a){var b=new RegExp(String.fromCharCode(65340),"g"),c=new RegExp(String.fromCharCode(92,92,92,92),"g");a=a.replace(b,String.fromCharCode(92),"g");a=a.replace(c,String.fromCharCode(92));a=a.replace(/\\1/g,String.fromCharCode(34));return a=a.replace(/\\2/g,String.fromCharCode(10))},elements:M,getNumberWithSeparators:D,handleForm:function(a,b,c){a.$event.preventDefault();
var d=a.$declarativeParent;d.is("span")&&(d=d.find("form"));d=d.serializeArray();d=m.processSubmissionParameters(d);w(a.data.action,d,b,c)},makeAjaxCall:w,handleAjaxError:u,handlePaymentsPortalForm:function(a,b,c,d){a=m.processSubmissionParameters(a.submissionParameters);w(b,a,c,d)},handlePaymentsPortalRedeemClaimCodeTransition:function(a,b,c,d){a=m.processSubmissionParameters(a.submissionParameters);a.embedOnlyData=1;x(b,a,c,d)}},m)});"use strict";q.when("A","pay-common-lib","page-transition-controller").register("pay-mobile-util",
function(a,m,n){function e(a,b,c){a=a||{};var d=w.fromAnywhereField.val(),e=c&&c.useSif?p('input[type\x3d"hidden"][name\x3d"isAmazonApp"]').val():0,f=h();"string"===typeof a?(a=a+"\x26ajaxResponse\x3d1\x26currentPage\x3d"+f,-1===b.search("fromAnywhere")&&-1===a.search("fromAnywhere")&&(a=a+"\x26fromAnywhere\x3d"+d),e&&(a+="\x26isAmazonApp\x3d1")):(a.ajaxResponse=1,a.currentPage=f,-1===b.search("fromAnywhere")&&(a.fromAnywhere=d),e&&(a.isAmazonApp=1),c&&c.isAddCardAndContinueEnabled&&(a.isHideSpinnerDisabled=
!0));return a}function g(){D&&D.abort("abort-for-cleanup");D=null}function l(a,b,c,d){a=a&&a.status;b="timeout"===b?"pay-ajax-timeout":"abort"===b?"pay-ajax-abort":"abort-for-cleanup"===b?"pay-ajax-abort-for-cleanup":"parsererror"===b?"pay-ajax-parsererror":500===a?"pay-ajax-500":"unknown"===a?"pay-unknown-page":"pay-ajax-error";c&&(c=-1===c.lastIndexOf(".html?")?c+("?ref\x3d"+b):c+("\x26ref\x3d"+b),k(c,d))}function h(){var a;p.each(u,function(b,c){if(c.pageId&&p(c.pageId).is(":visible"))return a=
b,!1});return a}function b(a){(a=u[a]&&u[a].componentId)&&q.when(a).execute(function(a){a.init&&a.init()})}function d(a,c,d,k,g){g&&g.suppressSpinner||n.show();g={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:e(c,a,k),dataType:"text",timeout:f,type:"POST",url:a,beforeSend:function(a,b){d&&d.beforeHandler&&d.beforeHandler(a,b)},complete:function(a,b){d&&d.completeHandler&&d.completeHandler(a,b);c&&c.isHideSpinnerDisabled||n.hide()},error:function(b,e){d&&d.errorHandler?d.errorHandler(b,
e):l(b,e,a,c)},success:function(e,f,k){var g=k.getResponseHeader("x-amz-checkout-pay-page-name");if(g){var p=k.getResponseHeader("x-amz-checkout-pay-page-title");p&&w.pageTitle.text(decodeURIComponent(p));d&&d.successHandler?d.successHandler(e,f,k):w.pageContainer.html(e);b(g)}else l(null,"unknown",a,c)}};p.extend(g,k);D=p.ajax(g)}function k(a,b,c){var d=p("#tempForm",w.pageContainer);0<d.length&&d.remove();d=p('\x3cform method\x3d"post"\x3e\x3c/form\x3e');d.attr("action",a);c&&c.target&&d.attr("target",
c.target);if("string"===typeof b)for(a=b.split("\x26"),b=0;b<a.length;b++)c=a[b].split("\x3d"),2===c.length&&"ajaxResponse"!==c[0]&&(c=p('\x3cinput type\x3d"hidden"/\x3e').attr("name",c[0]).val(c[1]),d.append(c));else for(var e in b)"ajaxResponse"!==e&&d.append(p('\x3cinput type\x3d"hidden"/\x3e').attr("name",e).val(b[e]));w.pageContainer.append(d);d.submit()}function c(a,c,d,k,g){g&&g.suppressSpinner||n.show();g={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:e(c,a,k),dataType:"text",
timeout:f,type:"POST",url:a,complete:function(a,b){d&&d.completeHandler&&d.completeHandler(a,b);n.hide()},error:function(b,e){d&&d.errorHandler?d.errorHandler(b,e):l(b,e,a,c)},success:function(a,c,e){var f=e.getResponseHeader("x-amz-checkout-pay-page-name");if(!f&&d&&d.pageUpdater)d.pageUpdater(a);else{var k=e.getResponseHeader("x-amz-checkout-pay-page-title");k&&w.pageTitle.text(decodeURIComponent(k));d&&d.successHandler?d.successHandler(a,c,e):w.pageContainer.html(a);b(f)}}};p.extend(g,k);D=p.ajax(g)}
var p=a.$,D=null,u={main:{componentId:"page-main",pageId:"#select-payments-view"},"credit-card-rewards":{componentId:"page-rewards",pageId:"#select-payment-rewards-view"},"financial-offer":{componentId:"page-financial-offer",pageId:"#select-payment-financial-offer-view"},"new-payment-methods":{pageId:"#new-payments-view"},"gil-estimates":{pageId:"#gil-estimates-subpage"}},w={},x={cvvHelper:"div#cvv-help-popover",fromAnywhereField:"input[name\x3dfromAnywhere]",jppoints:"div#jppoints",pageContainer:"div#page-container",
pageTitle:"head title"},z=!0,f;return m.mergeFrom({decodeJSonResponse:function(a){var b=new RegExp(String.fromCharCode(65340),"g"),c=new RegExp(String.fromCharCode(92,92,92,92),"g");a=a.replace(b,String.fromCharCode(92),"g");a=a.replace(c,String.fromCharCode(92));a=a.replace(/\\1/g,String.fromCharCode(34));return a=a.replace(/\\2/g,String.fromCharCode(10))},elements:w,getCurrentPage:function(){return w.pageContainer.children("div.page").filter(":visible")},getCurrentPageName:h,getPageId:function(a){a=
a.getResponseHeader("x-amz-checkout-pay-page-name");return u[a]&&u[a].pageId},handleForm:function(a,b,c){a.$event.preventDefault();d(a.data.action,a.$target.serialize(),{successHandler:function(a,c,d){b(a,c,d)}},c)},submitFormRequest:k,init:function(){m.isMobileCX()&&(r.onbeforeunload=g,m.refreshElements(w,x),f=parseInt(p("input[type\x3d'hidden'][name\x3d'paypageTimeoutValue']").val(),10),f=isNaN(f)?1E4:f,z&&(z=!1,p("div.pay-mobile").bind("keypress",function(a){m.prop("activeGoElement",13===a.keyCode?
document.activeElement:null,!0)})))},makeAjaxCall:d,handleAjaxError:l,pages:u,handlePaymentsPortalForm:function(a,b,c,e){a=m.processSubmissionParameters(a.submissionParameters);d(b,a,c,e)},handlePaymentsPortalRedeemClaimCodeTransition:function(a,b,d,e){a=m.processSubmissionParameters(a.submissionParameters);a.embedOnlyData=1;c(b,a,d,e)}},m)});"use strict";q.when("page-detector","pay-desktop-util","pay-mobile-util").register("pay-common-util",function(a,m,n){return a.isMobile()?n:m});"use strict";
q.when("A","pay-common-util","pay-rewards-currency","checkout-federation-wrapper","safe-apx-helper","weblab-helper").register("pay-validator",function(a,m,n,e,g,l){function h(){function a(b,c,d,e){Y.push({identifier:b,priority:d||100,target:c,isPincodeError:e})}function p(a){if(!a)return null;var b=new RegExp(String.fromCharCode(32),"g"),c=new RegExp(String.fromCharCode(45),"g");return a.replace(b,"").replace(c,"")}function h(){return 0<Y.length}function u(a){if(!a||0===a.length)return!1;for(var b=
0,c=!1,d=a.length-1;0<=d;--d){var e=a.charAt(d);c&&(e*=2,9<e&&(e-=9));b+=parseInt(e,10);c=!c}return 0===b%10}function w(a,b){return a&&a.match(/^[0-9]+$/)&&a.length===b}function x(a,b,c){return a&&a.match(/^[0-9A-Za-z]+$/)&&a.length>=b&&a.length<=c}function z(a,b){if(!a||!b)return!1;a=parseInt(a,10);b=parseInt(b,10);return f(a,b)}function f(a,b){var c=new Date,d=c.getFullYear();return b>d||b===d&&a>=c.getMonth()+1}function t(a){a=a.val();return!a||0===a.length}function r(){var d=b("#pm_pay_by_check").is(":checked"),
e=b("#existing-balance [paymentmethodid\x3d'availablebalance'] input").is(":checked");d&&e&&a("continue_BadCombinationCheckExistingBalance")}function v(d){if(b("#jppoints").length){var e,f=!1;1===d.length&&"jppoints"===d.attr("id")?(e=d,f=!0):e=d.filter("#jppoints");if(e&&e.find("#redeemPoints").is(":checked")){d=e.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val();d=parseInt(d,10);b('input[type\x3d"checkbox"][name\x3d"useAvailableBalance"]').is(":checked")&&(d-=parseInt(e.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]').val(),
10));var k=parseInt(e.find("#redeemableAmount").text(),10),g=e.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]');e.find("#jpPointsMax").is(":checked")?e=k:(e=parseInt(g.val(),10))||(e=0);e>k?a("continue_jpPointsExceedsRedeemableAmount",g):f&&e<d?a("continue_notEnoughJPPoints"):e>d&&a("continue_jpPointsExceedsTotalPurchase")}}}function C(b){b&&(b=b.find(".pci-blocking-cvv"),b.length&&b.is(":visible")&&a("PCI_Block_CVV"))}function A(b){var d=b.find(".currency-list");d.length&&d.is(":visible")&&
(b=d.find("[type\x3dradio]:checked").val(),d=d.find("#cardCurrencyDropDown option:selected").val(),b&&("Other"!==b||"-1"!==d&&"-2"!==d)||a("continue_SelectCardCurrency"))}function M(b){var e=b.find("#existingCvvNum");if(0!==e.length){var f=e.val();b=d?b.data("validcvvlength"):b.attr("validcvvlength");w(f,parseInt(b,10))||a("continue_BadSecurityCode",e)}}function S(b){var d=b.find('input[name\x3d"paymentMethod"]').val();/^creditCard/.test(d)&&b.find("#savedCardSuppressed").length&&a("continue_BankTemporarilyNotAvailable")}
function P(b){b=b.find("#existingPincodeNum");if(0!==b.length){var d=b.val();d?x(d,4,8)||a("existingCreditCard_PincodeInvalid",b,null,!m.isMobileCX()):a("continue_EmptyPincode",b)}}function G(d){if(d&&d.length)for(var e=0;e<d.length;e++){var f=b(d[e]);C(f.parent());M(f);P(f);"netBanking"===f.find('input[name\x3d"paymentMethod"]').val()&&(b("#netBanking_select").val(),b("#net-banking-list").find("option:selected").data("isdisabled")&&a("continue_BankTemporarilyNotAvailable"));S(f);var k=f;k.find('input[name\x3d"paymentMethod"]').val();
k.find("#vdcBanksSelect").val();b("#vdcBanksSelect").find("option:selected").data("isdisabled")&&a("continue_BankTemporarilyNotAvailable");B(f);f=f.siblings("#upi-acceptance-input").find("#vpaCollect");if(!f||f.length)(k=f.val())&&k.match(/.+@.+/)||a("continue_BadVpaForUpi",f)}}function L(b){var d=b.find("#newMonth"),e=b.find("#newYear");b=b.find("#newExpDate");!(d=d.length&&!z(d.val(),e.val()))&&(d=b.length)&&((b=b.val())?(d=b.split("-"),b=parseInt(d[0],10),d=parseInt(d[1],10),b=f(d,b)):b=!1,d=!b);
d&&a("continue_BadExpiration")}function V(b){"domesticCards"===b.find('input[name\x3d"paymentMethod"]').val()&&((b=b.find("select").val())&&b.match(/^[0-9]*$/)||a("continue_BlankSlate"))}function X(d){var e=b("#existing-balance input[name\x3duseFlexiblePayments]").is(":checked");d=m.getAttributeData(d,"paymentmethodtype");e&&"creditCard"!==d&&a("continue_FlexiblePaymentsNeedsCreditCard")}function I(b){"thirdPartyAccounts"===b.find('input[name\x3d"paymentMethod"]').val()&&((b=b.find("select").val())&&
0!==b.length||a("continue_BlankSlate"))}function T(b){var d=b.find(".rewards-list");if(d.length&&d.find('input[type\x3d"radio"][value\x3d"rewardscustom"]').is(":checked")){b=d.find("input.custom-rewards-input");var e=b.val();if(d.hasClass("show-currency-input-widget-new")){var d=b.data("country-code"),f=n.getCurrencyFormatByCountryCode(d),d=b.data("min"),e=n.getAmount(e,f.decimalPlace);e<d&&a("continue_BadRewardsMin")}else/^\s*$/.test(e)||isNaN(e)?a("continue_BadRewardsValue"):(e=parseFloat(b.val()),
d=b.data("min"),0>=e||e<d?a("continue_BadRewardsMin"):e>b.data().max&&a("continue_BadRewardsMax"))}}function U(d){var e=d.find('input[name\x3d"paymentMethod"]').val();"verifiedCreditCard"===e?a("continue_BlankSlate"):"verifiedDebitCard"===e&&(e=d.find("#vdcBanksSelect").val(),(""===e||"OtherBanks"===e||"1"===b("#save_citi_card").val()&&"CIT"===e)&&a("continue_BlankSlate"),d.find("option:selected").prop("disabled")&&a("continue_BankTemporarilyNotAvailable"))}function W(b){"cashOnDeliveryCash"===b.find('input[name\x3d"paymentMethod"]').val()&&
b.find(".phonenumberNotVerified").length&&a("continue_OTPforCOD")}function aa(b){if("netBanking"===b.find('input[name\x3d"paymentMethod"]').val()){var d=b.find("#net-banking-select-list").val();b=b.find("option:selected").prop("disabled");""===d&&a("continue_BlankSlate");b&&a("continue_BankTemporarilyNotAvailable")}}function ha(b){"morePaymentMethod"===b.find('input[name\x3d"paymentMethod"]').val()&&""===b.find("#more-payment-methods-select-list").val()&&a("continue_BlankSlate")}function B(d){var e=
d.find('input[name\x3d"paymentMethod"]').val();if("StandaloneInstallment"===e||"StandaloneCreditCardInstallment"===e||"StandaloneReusableCreditLineInstallment"===e)d.find('input[name\x3d"gilShowContinueBlocker"]').val()&&("StandaloneCreditCardInstallment"===e?a("continue_GilCCContinueError"):"StandaloneReusableCreditLineInstallment"===e?a("continue_GilRCLContinueError"):a("continue_GilContinueError")),d.find('input[name\x3d"showIneligibleItemSubpage"]').val()&&("StandaloneCreditCardInstallment"===
e?a("continue_GilCCContinueErrorIneligibleItems"):"StandaloneReusableCreditLineInstallment"===e?a("continue_GilRCLContinueErrorIneligibleItems"):a("continue_GilContinueErrorIneligibleItems")),d.find('input[name\x3d"gilShowContinueBlockerIfPromotions"]').val()&&0<b("#existing-balance input[name\x3duseAvailableBalance]:checked").length&&("StandaloneCreditCardInstallment"===e?a("continue_GilCCContinueErrorPromotions"):"StandaloneReusableCreditLineInstallment"===e?a("continue_GilRCLContinueErrorPromotions"):
a("continue_GilContinueErrorPromotions"))}var Y=[],Z=null,y=null,ca=function(a){k=a};k||(m.isMobileCX()?q.when("rewards-section-mobile").execute(ca):q.when("rewards-section-desktop").execute(ca));return{displayErrors:function(a,c){(Z=a)&&Z.hide().find(".error-message").hide().addClass("hidden");(y=c)&&y.find(".a-form-error").removeClass("a-form-error");if(h()){for(a=0;a<Y.length;a++){c=Y[a];if(c.target){var d=c.target.parent();d.hasClass("a-input-text-wrapper")&&!d.hasClass("a-form-error")?d.addClass("a-form-error"):
c.target.hasClass("a-form-error")||c.target.addClass("a-form-error")}c=c.identifier;(Z&&Z.length?Z.find("#"+c):b("#"+c)).show().removeClass("hidden")}Z&&Z.length&&Z.show()}},getHighestErrorId:function(){for(var a={priority:100},c=0;c<Y.length;c++){var d=Y[c],e;(e=d.identifier)?(e=Z&&Z.length?Z.find("#"+e):b("#"+e),e=parseInt(m.getAttributeData(e,"priority"),10),e=isNaN(e)?100:e):e=100;e<=a.priority&&(a={identifier:d.identifier,priority:e,isPincodeError:d.isPincodeError,target:d.target})}return a},
hasErrors:h,isValidCardCVV:w,isValidCardPincode:x,validateBankAccountNum:function(b,d){t(b)&&a("addBankAccount_NoAccountNumber",d)},validateBankAccountNumConfirm:function(b,d,e){b.val()!==d.val()&&a("addBankAccount_AccountNumberMismatch",e)},validateBankDriverLicense:function(b,d){t(b)&&a("addBankAccount_NoDLNumber",d)},validateBankDriverLicenseState:function(b,d){b.val()!==H&&""!==b.val()&&"0"!==b.val()||a("addBankAccount_NoDLState",d)},validateBankHolderName:function(b,d){t(b)&&a("addBankAccount_NoName",
d)},validateBankRoutingNum:function(b,d){9!==b.val().length&&a("addBankAccount_ShortRoutingNumber",d)},validateCreditCardCVV2:function(b,d,e){e="true"===b.attr("isaddresschallenge")?b.attr("issuer"):e&&e.charAt(0);"R"!==e&&(b=b.val(),w(b,"A"===e?4:3)||a("addCreditCard_BadSecurityCode",d))},validateCreditCardDate:function(b,d,e,f){z(b.val(),e.val())||(a("addCreditCard_BadExpiration",d),a("addCreditCard_BadExpiration",f))},validateCreditCardMobile:function(b,d){b=b.val();l.isUpdateMobileNumberEnabled()?
b&&b.replace(/[^0-9]/g,"").match(/^1[0-9]{10}$/)||a("addCreditCard_BadMobileNumber",d):b&&b.replace(/[^0-9]/g,"").match(/^1[34578]{1}[0-9]{9}$/)||a("addCreditCard_BadMobileNumber",d)},validateCreditCardPincode:function(b,d){(b=b.val())&&b.match(/^[a-zA-Z0-9]{4,8}$/)||a("addCreditCard_BadPincode",d)},validateCreditCardName:function(b,d){t(b)&&a("addCreditCard_NoName",d)},validateCreditCardNumber:function(d,e){var f=p(d.val());f&&10<f.length&&u(f)||a("addCreditCard_BadNumber",e);f=b("#creditCardIssuersBlocked").val();
d=d.data("issuer");f&&""!==f&&d&&""!==d&&-1<b.inArray(d,f.split(","))&&a("addCreditCard_IssuerUnsupported",e)},validateSBIMaestroCardNumberLength:function(b,d){19!==p(b.val()).length&&a("addCreditCard_SBIMaestro_BadNumberLength",d)},isAMEXCreditCard:function(a){a=p(a.val());return null!==a?0===a.indexOf("37")||0===a.indexOf("34"):!1},validateCreditCardTail:function(b,e){var f=p(b.val());f&&10<f.length&&u(f)?(b=(m.isMobileCX()&&d?b.parent().data():b.data()).tail+"",f.substr(f.length-b.length)!==b&&
a("addCreditCard_NotMatch",e)):a("addCreditCard_NotMatch",e)},validateCreditCardType:function(b,d){b.is(":visible")&&((b=b.val())&&b.match(/^[A-Z][0-9]*$/)||a("addCreditCard_NoType",d))},validateRegistrationResult:function(b){b.cardStatus?1===b.checkStatusCount&&a("addCreditCard_RegisterFailed"):0<b.errors.length&&a("addCreditCard_RegisterFailed")},validateDirectDebitAccountName:function(b,d){t(b)&&a("addDirectDebit_NoAccountOwnerName",d)},validateDirectDebitAccountNum:function(b,d){t(b)&&a("addDirectDebit_NoAccountNumber",
d)},validateDirectDebitRoutingNum:function(b,d){t(b)&&a("addDirectDebit_NoRoutingNumber",d)},validateInvoiceFirstName:function(b,d){t(b)&&a("addInvoiceAccount_NoFirstName",d)},validateInvoiceLastName:function(b,d){t(b)&&a("addInvoiceAccount_NoLastName",d)},validateLocName:function(b,d){t(b)&&a("addLoc_NoName",d)},validateLocNumber:function(b,d){t(b)&&a("addLoc_BadNumber",d)},validateNewGiftPromotion:function(b,d){t(b)&&a("addGiftCardOrPromo_NoCode",d)},validatePayment:function(d){if(m.isMobileCX())G(d),
k&&e.wrap(function(){k.validatePaymentRewardsInRewardsSection(a)},"shopwithpointsmobile");else if(r(),d&&d.length){for(var f=0;f<d.length;f++){var g=b(d[f]);"true"===m.getAttributeData(g,"isaddresschallenge")&&a("continue_AddressChallenge");"true"===m.getAttributeData(g,"isverifiedfail")&&a("continue_VerifiedFail");"true"===m.getAttributeData(g,"iscupcardexpired")&&a("continue_CUPExpired");C(g);A(g);M(g);P(g);L(g);V(g);X(g);I(g);T(g);U(g);aa(g);ha(g);B(g);W(g);S(g)}k&&e.wrap(function(){k.validatePaymentRewardsInRewardsSection(a)},
"shopwithpoints");v(d)}else a("continue_BlankSlate")},validateGetCreditCardTypeResult:function(b){if(b.errors&&0<b.errors.length)for(var d=0;d<b.errors.length;d++)a(b.errors[d])},validateEMIMenuForContinueButton:function(b){var d=b.find("#emiPaymentMethodsSelectList").find("option:selected").val();if("CreditCard"===d||"SelectOption"===d)a("continue_BlankSlate");else if(d=d.split("."),1<d.length){var e=d[0];if("emiCreditCard"===e||"netbankingEMI"===e)b=b.find("."+d[1]),b=b.find(".emiMenuTenuresDropDown"),
b.length&&!b.find("option:selected").val()&&a("continue_BlankSlate")}},apxValidatePayment:function(a,b){var c=g.get("payselect");c&&c.validatePayments(this,b,a)},addError:a,errors:Y,validatePCICVVBlock:C}}var b=a.$,d=r.P&&r.P.AUI_BUILD_DATE,k=H;return{create:function(){return new h}}});"use strict";q.when("A","ajax-utility","pay-common-util","pay-validator").register("pay-credit-card",function(a,m,n,e){function g(a,b,c,e){a&&a.length&&(b=c+"-"+b,(c=n.prop(b))&&(a=a.find(e).val(c))&&a.length&&(n.isMobileCX()?
a.closest(".card-cvv-field").hide().data("isHidden",1):a.closest(".a-column").hide(),n.prop(b,H)))}var l=a.$,h={cc:!1,vcc:!1,vdc:!1},b=r.P&&r.P.AUI_BUILD_DATE;return{confirmCreditCard:function(a,b,c){a.currentPaymentInstrumentID=a.paymentmethodid;a.recommendedPaymentMethodId=a.paymentmethodid;if(a.newMonth&&a.newYear)a.month=a.newMonth,a.year=a.newYear;else if(a.newExpDate){var e=a.newExpDate.split("-");a.year=parseInt(e[0],10);a.month=parseInt(e[1],10)}else a.expmonth&&a.expyear&&(a.month=a.expmonth,
a.year=a.expyear);(e="existingCvvNum"in a?a.addCreditCardVerificationNumber=a.existingCvvNum:a.addCreditCardVerificationNumber)&&n.prop("cvv-"+a.paymentmethodid,e);(e="existingPincodeNum"in a?a.addCreditCardPincode=a.existingPincodeNum:a.addCreditCardPincode)&&n.prop("pincode-"+a.paymentmethodid,e);n.makeAjaxCall(c,a,{successHandler:b,errorHandler:function(b,c){a.handler="confirm-credit-card";n.handleAjaxError(b,c,"/gp/buy/payselect/handlers/submit.html",a)}},{useSif:!0})},handleCreditCardType:function(a,
b){var c=a.$target,g=a.data.type,l=e.create();a.$currentTarget.data("issuer","");l.validateCreditCardNumber(c,c);l.hasErrors()||(h[g]=!0,n.makeAjaxCall(a.data.url,{addCreditCardNumber:c.val(),returnjson:1},{completeHandler:function(){h[g]=!1},successHandler:function(c){c=m.jsonify(c);b(c,g);a.$currentTarget.data("issuer",c.issuer)}},{useSif:!0},{suppressSpinner:!0}))},isWaitingForType:function(a){return h[a]},runConfirmCardValidator:function(a,b){var c=a.find("#existingCvvNum"),c=c.length?c:a.find("#addCreditCardVerificationNumber"),
g=a.find("#addCreditCardNumber"),h=a.find("#newMonth"),l=a.find("#newYear"),m=e.create();m.validateCreditCardTail(g,g);h.length&&l.length&&m.validateCreditCardDate(h,h.closest(".card-date").find(".a-button"),l,l.closest(".card-date").find(".a-button"));c.length&&(g=(g=a.find("#issuer"))&&g.val(),m.validateCreditCardCVV2(c,c,g));m.displayErrors(b,a);return m.hasErrors()},setDateSelectorStatus:function(a,b){var c=b.find(".card-date").find("select");c&&c.length&&q.when("a-dropdown").execute(function(b){c.each(function(){var c=
l(this).attr("id");b.updateSelect(c,{status:"21"===a.brand&&"G"===a.issuer?"disabled":"enabled"})})})},setNewCardCVVInputStatus:function(a){(n.prop("cvv-newcard")||n.prop("pincode-newcard"))&&a.each(function(){var a=l(this);if("1"===(b?a.data("isnewcard")+"":a.attr("isnewcard")))return g(a,"newcard","cvv","#existingCvvNum"),g(a,"newcard","pincode","#existingPincodeNum"),!1})},setCardPasswordInputStatus:g}});"use strict";q.when("A","ajax-utility","pay-common-util","pay-validator","page-transition-controller",
"page-conductor","pay-credit-card").register("pay-credit-card-reregistration",function(a,m,n,e,g,l,h){function b(a,b){var d=e.create(),g=k("#cupMobileNumber-"+a),h=k("#cupSecurityCode-"+a),l=k("#reRegisterCCErrors-"+a);a=k("#reRegisterCCInputs-"+a);d.validateCreditCardCVV2(h,h,b);d.validateCreditCardMobile(g,g);d.displayErrors(l,a);return d.hasErrors()}function d(a,b,d){l.ajaxUpdatePage(a,b,d)}var k=a.$;return{actionReregisterCardInBox:function(a){a.$event.preventDefault();g.show();var e=a.data.type,
l=k("#cupMobileNumber-"+a.data.paymentMethodID).val(),u=k("#cupSecurityCode-"+a.data.paymentMethodID).val();b(a.data.paymentMethodID,e)?g.hide():(e={isReregistering:a.data.isReregistering,currentPaymentInstrumentID:a.data.paymentMethodID,name:a.data.holderName,year:a.data.expiredYear,month:a.data.expiredMonth,addCreditCardMobileNumber:l,addCreditCardVerificationNumber:u},l={useSif:n.isMobileCX()?!0:!1,success:function(a,b,c){a=m.jsonify(a);b=k("#reRegisterCCErrors-"+a.paymentInstrumentId);h.waitForCreditCardStatus(a,
d,b)}},a.$event.preventDefault(),n.makeAjaxCall(a.data.url,e,null,l))}}});"use strict";q.when("A","client-side-metrics","ajax-utility","pay-common-util","pay-validator","existing-payments","page-conductor","checkout-modal-popover","page-transition-controller","pay-credit-card","pay-gil","new-verified-debit-card","emi-helper").register("new-payments",function(a,m,n,e,g,l,h,b,d,k,c,p,r){function u(a){a.$event.preventDefault();var b=a.data.type;if(k.isWaitingForType(b))d.show(),setTimeout(function(){u(a)},
50);else{var c;c="vdc"===b?R.newVDC:"emi"===b?R.newEMI:R.newVCC;if(ba(c,b))d.hide();else{d.show();var f=e.getInputValues(c),g="vdc"===b?"_VDC":"_VCC";c=f["addCreditCardVerificationNumber"+g];var h=f["addCreditCardPincode"+g],b={addCreditCardNumber:f["addCreditCardNumber"+g],addCreditCardVerificationNumber:c,addCreditCardPincode:h,handler:f["handler"+g],month:f["month"+g],name:f["name"+g],newPaymentType:b,year:f["year"+g],cctype:f["cctype"+g],isSBIInternationalMaestroSelected:f["isSBIInternationalMaestroSelected"+
g],isCardSavedFromEMIMenu:f["isCardSavedFromEMIMenu"+g]};e.prop("cvv-newcard",c);h&&e.prop("pincode-newcard",h);e.makeAjaxCall(a.data.url,b,{successHandler:function(a,b,c){M(a,b,c);k.setNewCardCVVInputStatus(R.paymentRows)}},{useSif:!0})}}}function w(a){a.$event.preventDefault();var b=a.data.type;if(k.isWaitingForType(b))d.show(),setTimeout(function(){w(a)},50);else{var c=R.newCCFormContent;if(ba(c,b))d.hide();else{d.show();b=e.getInputValues(c);b.handler=b.handler_addCCInBox;var c=a.data.url,f={};
N("#cupSecurityCode").is(":visible")&&N("#cupMobileNumber").is(":visible")?(c="/gp/buy/payselect/handlers/add-credit-card.html",f={successHandler:function(a){a=n.jsonify(a);P(a)}}):f={successHandler:M};e.makeAjaxCall(c,b,f,{useSif:!0})}}}function x(a){a.$event.preventDefault();var b=N("#new-giftcard-promotion"),b=e.getInputValues(b);N("input[name\x3disUnifiedActionsDesignEnabled]").length&&z(a)||(b.handler=b.handler_addGCInBox,a=a.data.url,d.show(),e.makeAjaxCall(a,b,{successHandler:function(a,b,
c){h.ajaxUpdatePage(a,b,c);oa||e.scrollTopTo(N("#existing-balance"))}},{useSif:!0}))}function z(a){a=a.$declarativeParent;var b=N("#gcpromoinput"),c=g.create();c.validateNewGiftPromotion(b,b);c.displayErrors(R.newGCErrors,a);return c.hasErrors()}function f(a){var b=N(a.currentTarget).parents("div.new-payment-line").find(".card-date select");if(b&&b.length){var c=N(a.currentTarget).val();q.when("a-dropdown").execute(function(a){b.each(function(){var b=N(this).attr("id");a.updateSelect(b,{status:"G21"===
c?"disabled":"enabled"})})})}}function t(a){var b=R.newVDC.find(".vdc-form-fields"),c=R.newVDC.find("#vdc-logo-prompt"),d=R.newVDC.find(".top-cell");a?b.show():b.hide();a?c.show():c.hide();a?d.addClass():d.removeClass()}function J(a){var b=N(a.currentTarget).val(),c=R.newVDC.find("#suppressedVerifiedDebitCard").hide(),d=R.newVDC.find(".vdc-selected-bank-prompt").hide();t(!1);var e="1"===R.newVDC.find("#isRupayAsSavedCardEnabled").val()&&"URP"===b;"OtherBanks"===b||"1"===N("#save_citi_card").val()&&
"CIT"===b||e?(t(!0),N.isEmptyObject(p)||p.showExpiryDateAndCvv()):"SMP"!==b||N.isEmptyObject(p)?""!==b&&(b=N(a.currentTarget).find("option:selected").prop("disabled"),a=N(a.currentTarget).find("option:selected").text(),b?c.show().find(".suppressed-card-text").html(a):d.show().find(".bank-name-text").html(a)):(t(!0),p.hideExpiryDateAndCvv())}function v(a,b){if(!N.isEmptyObject(r)&&a)return a(b)}function C(a){v(r.removeEMIMenuSelectionAttributes);R.newEMI.find(".emi-group").hide();a=N(a.currentTarget).find("option:selected").val();
R.newEMI.find("#emiMenuErrors_VCC").length&&R.newEMI.find("#emiMenuErrors_VCC").hide();if(a=v(r.showPaymentOptionBlock,a))v(r.addEMIMenuSelectionAttributes),a.show()}function A(a){k.handleCreditCardType(a,ma)}function M(a,b,c){h.ajaxUpdatePage(a,b,c);oa||e.scrollTopTo(l.getSelectedPayment())}function S(a){a.$event.preventDefault();var b=a.data.type;k.isWaitingForType(b)?(d.show(),setTimeout(function(){S(a)},50)):ba(a.$declarativeParent,b)?d.hide():(la&&la.hide(),pa&&pa.hide(),d.show(),N("#cupSecurityCode").is(":visible")&&
N("#cupMobileNumber").is(":visible")?(b=a.$declarativeParent.serializeArray(),b=e.processSubmissionParameters(b),e.makeAjaxCall("/gp/buy/payselect/handlers/add-credit-card.html",b,{successHandler:function(a){a=n.jsonify(a);P(a)}},{useSif:!0})):e.handleForm(a,{successHandler:M},{useSif:!0}))}function P(a){var b={};b.paymentInstrumentId=a.paymentInstrumentId;a.checkStatusCount&&(b.checkStatusCount=a.checkStatusCount);var c={successHandler:function(a){a=n.jsonify(a);var b=g.create();"VERIFIED"===a.cardStatus?
e.makeAjaxCall("/gp/buy/payselect/handlers/submit.html",{newPaymentMethodId:a.paymentInstrumentId},{successHandler:M}):"PENDING"===a.cardStatus?(a.checkStatusCount?(a.checkStatusCount=parseInt(a.checkStatusCount,10),isNaN(a.checkStatusCount)&&(a.checkStatusCount=1)):a.checkStatusCount=3,b.validateRegistrationResult(a),1===a.checkStatusCount?(d.hide(),b.displayErrors(R.newCCErrors)):(--a.checkStatusCount,P(a))):(b.validateRegistrationResult(a),d.hide(),b.displayErrors(R.newCCErrors))}};setTimeout(function(){e.makeAjaxCall("/gp/buy/payselect/handlers/check-credit-card-status.html",
b,c)},2500)}function G(a){a.$event.preventDefault();var b=a.$declarativeParent,c=b.find("#loc-name"),f=b.find("#loc-number"),k=g.create();k.validateLocName(c,c);k.validateLocNumber(f,f);k.displayErrors(b.find("#error-box-new-loc"),b);k.hasErrors()||(ya&&ya.hide(),d.show(),e.handleForm(a,{successHandler:M}))}function L(a){a.$event.preventDefault();var b=a.$declarativeParent,c=b.find("#gcpromoinput");b.find("#gcpromosuccessblock").hide();var f=g.create();f.validateNewGiftPromotion(c,c);f.displayErrors(R.newGCErrors,
b);f.hasErrors()||(d.show(),e.handleForm(a,{successHandler:function(a,b,c){h.ajaxUpdatePage(a,b,c);oa?R.newGCErrors.is(":visible")&&N("#gc-link-expander").trigger("click"):e.scrollTopTo(N("#existing-balance"))}}))}function H(a){a.$event.preventDefault();N("#ccAddCard").trigger("submit")}function X(a){a.$event.preventDefault();N("#bank-address-popover-submit").trigger("submit")}function I(a){a.$event.preventDefault();N("#direct-debit-popover-submit").trigger("submit")}function T(a){a.$event.preventDefault();
N("#new-loc-popover-submit").trigger("submit")}function U(a){a.$event.preventDefault();N("#new-invoice-popover-submit").trigger("submit")}function W(a){a.$event.preventDefault();N("#brdcAddCard").trigger("submit")}function aa(a){a.$event.preventDefault();var b=a.$declarativeParent,c=g.create(),f=b.find("#bank-name"),k=b.find("#bank-routing-number"),h=b.find("#bank-account-number"),l=b.find("#bank-account-number-confirm"),p=b.find("#bank-dl"),m=b.find("#bank-dl-state");c.validateBankHolderName(f,f);
c.validateBankRoutingNum(k,k);c.validateBankAccountNum(h,h);c.validateBankAccountNumConfirm(h,l,l);c.validateBankDriverLicense(p,p);c.validateBankDriverLicenseState(m,m.parents("div.a-button-dropdown"));c.displayErrors(b.find("#new-bank-error-box"),b);c.hasErrors()||(wa&&wa.hide(),d.show(),e.handleForm(a,{successHandler:M}))}function ha(a){a.$event.preventDefault();var b=a.$declarativeParent,c=g.create(),f=b.find("#debit-bank-routing-number"),k=b.find("#debit-account-number"),h=b.find("#debit-account-name");
c.validateDirectDebitRoutingNum(f,f);c.validateDirectDebitAccountNum(k,k);c.validateDirectDebitAccountName(h,h);c.displayErrors(b.find("#new-direct-debit-error"),b);c.hasErrors()||(Ba&&Ba.hide(),d.show(),e.handleForm(a,{successHandler:M}))}function B(a){a.$event.preventDefault();var b=a.$declarativeParent,c=g.create(),f=b.find("#invoice-first-name"),k=b.find("#invoice-last-name");c.validateInvoiceFirstName(f,f);c.validateInvoiceLastName(k,k);c.displayErrors(b.find("#new-invoice-error-box"),b);c.hasErrors()||
(E&&E.hide(),d.show(),e.handleForm(a,{successHandler:M}))}function Y(a){a=N("#order-summary-total");var b=N("#order-summary-container");a.prev().addClass("a-first");b.addClass("a-box-group");a.show();e.isTouchCX()&&b.parent().find(".bottom-order-summary").show();R.newCCFormContent.is(":visible")||N("#wrapper-new-cc").find("a.a-link-expander").trigger("click");N("#ecard-help-link").show()}function Z(a){var b="Unknown";e.isDesktopCX()?b="Desktop":e.isMobileCX()?b="Mobile":e.isTouchCX()&&(b="Tablet");
m.increaseCount("PayPage-ClientSide-AddCupClick-"+b,1);b=N("#cupForm");if(0<b.length)b.submit();else{var c=N("\x3cform\x3e\x3c/form\x3e");c.attr({target:"_blank",method:"POST",action:a.data.url});N("#cup-dc").find("input").each(function(){var a=N(this);"hidden"===a.attr("type")&&a.clone().appendTo(c)});N("body").append(c);c.submit();c.remove()}}function y(c){var f=c.$target.closest(".a-popover"),g=f.data("a-popover-id");b.hideById(g);f.hide();N("#a-popover-modal").hide();d.show();e.makeAjaxCall(c.data.url,
void 0,{successHandler:function(b){N("#existing-payment-methods").replaceWith(N(b).find("#existing-payment-methods"));a.trigger("checkout:reload:payselect");d.hide()}})}function ca(a){a.$event.preventDefault();a=a.data;d.show();c.submitNewGilPayment(a.subtype)}function da(){if(!e.isMobileCX()){0===N("#form-add-credit-card").length&&(N("#ccAddCard").parents("div.cc-submit").hide(),N("#ccAddCardWithButton").parents("div.cc-submit").show());N("html").hasClass("a-ie6")&&(N("#cup-mbdc").show(),N(".mbdc-link").attr("data-action",
"redirect-cup"));R=e.getElements(xa);R.bankNumberConfirm.show();R.newVDC.find(".payment-row").data("hasstatus")||R.newVDC.find(".vdc-form-fields").hide();R.newVDC.find("#suppressedVerifiedDebitCard").hide();R.newCCFormContent.find(".cup-card-field").hide();R.newPayments.find("#cupInfoMessage").hide();R.newPayments.find("#use-ecard-link").show();R.newPayments.find(".mbdc-link").show();R.newPayments.find(".mbdc-button").hide();oa=!1;R.newPayments.each(function(){var a=N(this),b=a.data();b&&0===b.hasstatus?
(a.find("a.a-link-expander i.js-hide").remove(),a.find("a.a-link-section-expander i.js-hide").remove()):b&&1===b.hasstatus&&!oa&&(e.scrollTopTo(a),oa=!0)});var b=R.newVCC.find("#requireCVVOrPincode");b&&b.length&&b.val("1");ra&&(a.declarative("new-cc",["submit"],S),a.declarative("new-brdc",["submit"],S),a.declarative("new-loc",["submit"],G),a.declarative("show-card-image",["change"],A),a.declarative("new-giftcard-promotion",["submit"],L),a.declarative("new-verified-card",["click"],u),a.declarative("new-cc-in-dashboard",
["click"],w),a.declarative("new-gc-in-dashboard",["click"],x),a.declarative("add-bank-account",["submit"],aa),a.declarative("add-direct-debit",["submit"],ha),a.declarative("add-invoice",["submit"],B),a.declarative("show-order-summary",["click"],Y),a.declarative("redirect-cup",["click"],Z),a.declarative("cup-popover-close",["click"],y),a.declarative("add-new-debit-and-cc-popover-submit",["click"],H),a.declarative("add-bank-account-popover-submit",["click"],X),a.declarative("add-loc-account-popover-submit",
["click"],T),a.declarative("new-gil-payment",["click"],ca),a.declarative("add-direct-debit-popover-submit",["click"],I),a.declarative("add-invoice-account-popover-submit",["click"],U),a.declarative("add-new-br-debit-card-popover-submit",["click"],W),ra=!1);R.cardTypeDropdown.unbind("change",f).bind("change",f);R.vdcBankDropdown.unbind("change",J).bind("change",J);R.emiCardsDropdown.unbind("change",C).bind("change",C);N("div.pay-desktop a.a-link-expander").unbind("keypress");N("div.pay-desktop .a-declarative, div.pay-desktop .a-button").filter("[data-action\x3da-checkout-modal-popover]").unbind("keypress");
a.on("a:popover:show:add-new-debit-cc-modal",function(a){pa=a.popover});a.on("a:popover:show:add-new-bank-account-modal",function(a){wa=a.popover});a.on("a:popover:show:add-new-direct-debit-modal",function(a){Ba=a.popover});a.on("a:popover:show:add-new-loc-account-modal",function(a){ya=a.popover});a.on("a:popover:show:add-invoice-account-modal",function(a){E=a.popover});a.on("a:popover:show:add-br-debit-card-modal",function(a){la=a.popover})}}function ba(a,b){var c,d,e,f,k,h,l,p,m,n,t;"vcc"===b?(c=
"#vccCVVNum",b="#newVCCErrors",d="#vccMonth",e="#vccName",f="#newVerifiedCreditCardNumber",k="#vccType",h="#vccYear",l="#vccPincode",t=n=m=p=void 0):"vdc"===b?(c="#vdcCVVNum",b="#newVDCErrors",d="#vdcMonth",e="#vdcName",f="#newVerifiedDebitCardNumber",k="#vdcType",h="#vdcYear",p="#isSBIMaestroAsSavedCardEnabled",m="#isSBIInternationalMaestroSelected",t=n=l=void 0):"emi"===b?(c="#vccCVVNum",b="#newEMIErrors",d="#vccMonth",e="#vccName",f="#newVerifiedCreditCardNumber",k="#vccType",h="#vccYear",l="#vccPincode",
t=n=m=p=void 0):"brdc"===b?(b="#newBRDCErrors",d="#brdcMonth",e="#brdcName",f="#addCreditCardNumber_BRDC",h="#brdcYear",t=n=m=p=l=k=c=void 0):(n="#cupSecurityCode",t="#cupMobileNumber",c="#ccCVVNum",b="#newCCErrors",d="#ccMonth",e="#ccName",f="#addCreditCardNumber",k="#ccType",h="#ccYear",m=p=l=void 0);c=a.find(c);n&&0===c.length&&a.find(n).is(":visible")&&(c=a.find(n));p="1"===a.find(p).val()&&"1"===a.find(m).val();e=a.find(e);f=a.find(f);t=t?a.find(t):null;d=a.find(d);k=a.find(k);h=a.find(h);var A;
l&&a.find(l).is(":visible")&&(A=a.find(l));l=k.val();m=g.create();m.validateCreditCardName(e,e);m.validateCreditCardNumber(f,f);p&&m.validateSBIMaestroCardNumberLength(f,f);p=d.parent();p=p.hasClass("a-button")?p:p.find(".a-button");e=h.parent();e=e.hasClass("a-button")?e:e.find(".a-button");"G21"!==l&&m.validateCreditCardDate(d,p,h,e);m.validateCreditCardType(k,k.closest(".card-type-field").find(".a-button"));h=l?l.substr(0,1):"";c.length&&"R"!==h&&c.is(":visible")&&m.validateCreditCardCVV2(c,c,
l);t&&t.length&&t.is(":visible")&&m.validateCreditCardMobile(t,t);A&&A.length&&m.validateCreditCardPincode(A,A);m.displayErrors(N(b),a);return m.hasErrors()}function ma(a,b){if(a){"1"===a.isDebitCard?R.newCCWarnings.show().removeClass("hidden"):R.newCCWarnings.hide().addClass("hidden");if("1"===a.hasErrors){var c=g.create();c.validateGetCreditCardTypeResult(a);if(c.hasErrors()){c.displayErrors(R.newCCErrors);return}}b="vcc"===b?R.newVCC:"vdc"===b?R.newVDC:"emi"===b?R.newEMI:"brdc"===b?R.newBRDCFormContent:
R.newCCFormContent;var c=a.specificFields,d=b.find(".cup-card-field");0!==d.length&&(c&&1===c.securityCode&&1===c.mobileNumber?(e.isTouchCX()&&b.find("#addCreditCardNumber").closest(".a-input-text-wrapper").removeClass("last-child"),d.show()):d.hide());c=a.specificFields;d=b.find(".amex-field");if(0!==d.length){var f=b.find(".cvv-field");0!==f.length&&(c&&1===c.pincode?(f.hide(),d.show()):c&&0===c.pincode&&0===c.securityCode?(d.hide(),f.hide()):(d.hide(),f.show()))}c=b.find(".card-images");c.find("img").hide();
f=a.installmentProgram;d=!1;f&&(f=c.find('img[data-installmentprogram\x3d"'+f+'"]'),0!==f.length&&(f.show(),d=!0));d||(a.issuerdisplayimage?c.find("img[data-issuer\x3dATM]").attr("src",a.issuerdisplayimage).show():(d=a.issuer+a.brand,c.find("img[data-issuer\x3d"+d+"]").show(),b.find(xa.cardTypeDropdown).val(d).trigger("change")));k.setDateSelectorStatus(a,b)}}var N=a.$,ra=!0,oa=!1,R={},xa={bankNumberConfirm:"#wrapper-bank-account-number-confirm",btnAddCard:"#ccAddCard",btnAddLoc:"#button-new-loc",
btnAddGC:"#button-add-gcpromo",btnAddBank:"#button-add-bank-account",btnAddDirectDebit:"#button-add-direct-debit",btnAddInvoice:"#button-add-invoice",cardImages:"#newCreditCardImages",cardTypeDropdown:".card-type-dropdown select",newCCFormContent:"#new-cc",newBRDCFormContent:"#new-brdc",newGCErrors:"#gcpromoerrorblock",newGCFormContent:"#gc_entry",newPayments:"div.new-payment-line",newVCC:"#new-verified-credit-cards-table",newVDC:"#new-verified-debit-cards-table",newEMI:"#newEmiCard",paymentRows:"#existing-payment-methods .payment-row",
vdcBankDropdown:"#vdcBanksSelect",emiCardsDropdown:"#emiPaymentMethodsSelectList",cardList:"#existing-credit-cards-box",newCCErrors:"#newCCErrors",newCCWarnings:"#newCCWarnings"},pa,wa,ya,Ba,E,la;a.on("checkout:reload:payselect",da);a.on("checkout:reload:spp-payment",da);return{actionShowOrderSummary:Y,handleFormHandlerScrollToSelected:M}});q.when("A","page-detector","client-side-metrics","ready").execute(function(a,m,n){function e(a,e,b,d){a=g(e).is(":checked");r.P&&r.P.AUI_BUILD_DATE?a?g(b).val(g(b).parent().data("account-name")):
g(b).val(""):(n.increaseCount("removeauijs8"),a?(g(d).removeClass("a-icon-touch-checkbox-inactive").addClass("a-icon-touch-checkbox-active"),g(b).val(g(b).data("account-name"))):(g(d).removeClass("a-icon-touch-checkbox-active").addClass("a-icon-touch-checkbox-inactive"),g(b).val("")));b="undefined"!==typeof r.ue&&"undefined"!==typeof r.ue.count;d=m.isMobilePayment()?"mobile":"tablet";a=g("#showNameOnCardCheckbox").is(":checked");b&&r.ue.count(d+"NameOnCardCheckBox"+(a?"Checked":"Unchecked"),1)}var g=
a.$;a.declarative("show-card-name",["click"],function(a){e(a,"#showNameOnCardCheckbox","#ccName","#showNameOnCardIcon")});a.declarative("show-br-debit-card-name",["click"],function(a){e(a,"#showNameOnCardCheckbox_BRDC","#brdcName","#showNameOnCardIcon_BRDC")})});"use strict";q.when("A").register("pay-rewards-currency",function(a){var m=function(a,e){e=Math.pow(10,e);a=a.replace(/[^0-9]/g,"");return parseFloat(a)/e},n={CA:{groupingSeparator:",",decimalSeparator:".",decimalPlace:2},DE:{groupingSeparator:".",
decimalSeparator:",",decimalPlace:2},GB:{groupingSeparator:",",decimalSeparator:".",decimalPlace:2},JP:{groupingSeparator:",",decimalSeparator:".",decimalPlace:0},US:{groupingSeparator:",",decimalSeparator:".",decimalPlace:2}},e=function(a,e,b,d,g){this.groupingSeparator=a;this.decimalSeparator=e;this.currencyDecimalPlace=b;this.pointsDecimalPlace=d;this.ratio=g;this.getCurrencyAmount=function(a){return m(a,this.currencyDecimalPlace)};this.getPointsAmount=function(a){return this.getCurrencyAmount(a)/
this.ratio};this.format=function(a,b){var d=parseInt(a,10);a=parseFloat(a-d).toFixed(b);a=this.decimalSeparator+a.slice(2);d=d.toString();b=3<d.length?d.length%3:0;d=(0<b?d.substr(0,b)+this.groupingSeparator:"")+d.substr(b).replace(/(\d{3})(?=\d)/g,"$1"+this.groupingSeparator);return a===H||a===this.decimalSeparator?d:d+a};this.formatCurrency=function(a){return this.format(a,b)};this.formatPoints=function(a){return this.format(a,d)}},g=function(e,g,b,d){this.maxAmount=d;this.rewardsFormatter=b;this.currencyElement=
e;this.pointElement=g;var k=this;this.isControlKey=function(a){switch(a.which){case 8:case 46:return!0;case 86:case 88:return a.ctrlKey;default:return!1}};this.isNavigationKey=function(a){switch(a.which){case 9:case 16:case 17:case 35:case 36:case 37:case 39:return!0;case 65:case 67:return a.ctrlKey;default:return!1}};this.isValidKey=function(a){var b=a.which;return 48<=b&&57>=b||96<=b&&105>=b||8===a.which||46===a.which};this.getCaret=function(){var a=k.currencyElement,b=a.get(0),d=0,e=0;if("number"===
typeof b.selectionStart&&"number"===typeof b.selectionEnd)d=b.selectionStart,e=b.selectionEnd;else{var g=document.selection.createRange();if(g!==H&&g.parentElement()===b){var a=a.val(),e=a.length,h=b.createTextRange();h.moveToBookmark(g.getBookmark());b=b.createTextRange();b.collapse(!1);-1<h.compareEndPoints("StartToEnd",b)?d=e:(d=-h.moveStart("character",-e),d+=a.slice(0,d).length-1,-1<h.compareEndPoints("EndToEnd",b)||(e=-h.moveEnd("character",-e),e+=a.slice(0,e).length-1))}}return{start:d,end:e}};
this.setCaret=function(a){var b=k.currencyElement.get(0);b.setSelectionRange?b.setSelectionRange(a,a):b.createTextRange&&(b=b.createTextRange(),b.collapse(!0),b.moveStart("character",a),b.moveEnd("character",a),b.select())};this.bind=function(){k.currencyElement.unbind();k.currencyElement.bind("keydown",function(a){k.isNavigationKey(a)||k.isControlKey(a)||k.isValidKey(a)||a.preventDefault()});k.currencyElement.bind("keyup",function(b){if(!k.isNavigationKey(b)){b=k.getCaret();var d=k.currencyElement.val().length;
k.format();var e=k.currencyElement.val().length;b.start===b.end&&k.setCaret(Math.min(b.start+(e-d),e));a.trigger("inlineFormatter:formattingCompleted",k)}})};this.unbind=function(){k.currencyElement.unbind("keydown keyup")};this.format=function(a){a=k.currencyElement.val();a=k.rewardsFormatter.getCurrencyAmount(a);isNaN(a)&&(a=0);a>k.maxAmount&&(a=k.maxAmount);a=k.rewardsFormatter.formatCurrency(a);k.currencyElement.val(a)}};a.on("inlineFormatter:formattingCompleted",function(a){var e=a.pointElement,
b=a.currencyElement.val(),b=a.rewardsFormatter.getPointsAmount(b);a=a.rewardsFormatter.formatPoints(Math.round(b));e.html(a)});return{getCurrencyFormatByCountryCode:function(a){(a=n[a])||(a=n["default"]);return a},getAmount:m,initializeInlineFormatting:function(l,h,b){var d=l.maxAmount;b=new e(b.groupingSeparator,b.decimalSeparator,b.decimalPlace,h.decimalPlace,h.ratio);l=new g(l.$element,h.$element,b,d);l.bind();l.format(0);a.trigger("inlineFormatter:formattingCompleted",l)}}});"use strict";q.when("A",
"pay-common-util","pay-validator","page-conductor","mobile-carrier-billing-util","weblab-helper").register("jppoints",function(a,m,n,e,g,l){function h(){!m.isMobileCX()&&J("#jppoints").length&&(v=m.getElements(C),p())}function b(){var a=v.paymentRows.find('input[type\x3d"radio"][name\x3d"paymentMethod"]');a.closest("div.payment-selected").removeClass("payment-selected");a.attr("checked",!1);m.isTouchCX()&&d(a,"radio")}function d(a,b){a.siblings("i").removeClass("a-icon-touch-"+b+"-active").addClass("a-icon-touch-"+
b+"-inactive")}function k(a,b){a.is(":disabled")||a.siblings("i").removeClass("a-icon-touch-"+b+"-inactive").addClass("a-icon-touch-"+b+"-active")}function c(){return J('input[type\x3d"radio"][name\x3d"paymentMethod"][value\x3d"availablebalance"]').is(":checked")}function p(){if(v.jppoints&&v.jppoints.length){c()&&r();v.jppoints.show();var a=v.jppoints.find("#redeemPoints");m.isTouchCX()?a.parents("label").bind("click",x):a.bind("click",x);v.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').bind("click",
function(){var a=v.jppoints.find("#jpPointsCustom");a.attr("checked",!0);var b=v.jppoints.find("#redeemPoints");b.attr("checked",!0);m.isTouchCX()&&(k(a,"radio"),d(v.jppoints.find("#jpPointsMax"),"radio"),k(b,"checkbox"))});v.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]').bind("click",u);v.jppoints.find("#jpPointsCustom").bind("click",function(){v.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').focus()});v.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').bind("keyup",
t)}}function r(){var a=v.jppoints.find("#redeemPoints"),b=v.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"]'),c=v.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),f=v.jppoints.find("#redeemableAmount"),g=v.jppoints.find("#redeemableValue");a.attr("checked",!1);a.attr("disabled",!0);b.attr("checked",!1);b.attr("disabled",!0);v.jppoints.find("#jpPointsError").hide();c.val("");c.removeClass("a-form-error");c.attr("disabled",!0);g.text(v.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithGC"]').val());
f.text(v.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithGC"]').val());e.isSPP()&&(v.jppoints.find("label").addClass("disabled-color"),v.jppoints.removeClass("payment-selected"));m.isTouchCX()&&(d(a,"checkbox"),d(b,"radio"),a.siblings("i").addClass("a-button-disabled"),b.siblings("i").addClass("a-button-disabled"))}function u(c){var e=c.currentTarget,f=v.jppoints.find("#redeemPoints");f.attr("checked",!0);if(m.isTouchCX()){k(J("#"+e.id),"radio");var g;g="jpPointsMax"===e.id?v.jppoints.find("#jpPointsCustom"):
v.jppoints.find("#jpPointsMax");d(g,"radio");k(f,"checkbox")}"true"===e.value&&(v.jppoints.find("#jpPointsError").hide(),e=v.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),e.removeClass("a-form-error"),e.val(""),f=v.jppoints.find("#redeemableAmount"),g=parseInt(v.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsConversionRate"]').val(),10),e=parseInt(v.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10),f=parseInt(f.text(),10)*g,J('input[name\x3d"useAvailableBalance"]').is(":checked")&&
(g=v.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]'),e-=parseInt(g.val(),10)),f>=e&&b());q.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:toggleJPPointsInstallmentEligibility",J(c.currentTarget))})}function w(a){var c=v.jppoints.find("#redeemableAmount"),e=v.jppoints.find("#redeemableValue"),f=parseInt(v.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10),g;a.is(":checked")?(a=v.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithGC"]').val(),
g=v.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithGC"]').val(),f-=parseInt(v.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]').val(),10)):(a=v.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithoutGC"]').val(),g=v.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithoutGC"]').val());var k=parseInt(v.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsConversionRate"]').val(),10)*a;c.text(a);e.text(g);0>=parseInt(a,10)?
(c=v.jppoints.find("#redeemPoints"),c.attr("checked",!1),e=v.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"]'),e.attr("checked",!1),m.isTouchCX()&&(d(c,"checkbox"),d(e,"radio"))):v.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"][value\x3d"true"]').is(":checked")?k>=f&&b():t()}function x(){var b=v.jppoints.find("#redeemPoints");if(!b.is(":disabled")){b=b.is(":checked");if(m.isTouchCX())b?(d(v.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]'),"radio"),
f()):(k(v.jppoints.find("#jpPointsMax"),"radio"),d(v.jppoints.find("#jpPointsCustom"),"radio"),z());else if(b)z(),e.isSPP()&&v.jppoints.addClass("payment-selected");else if(f(),e.isSPP()){v.jppoints.removeClass("payment-selected");if(c())return;m.selectDefaultPaymentMethodIfNotSelected()}q.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:toggleJPPointsInstallmentEligibility",v.jppoints)})}}function z(){var a=v.jppoints.find("#jpPointsMax");a.attr("checked",!0);
var c=parseInt(v.jppoints.find("#redeemableAmount").text(),10),f=v.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithoutGC"]').val(),g=parseInt(v.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10);m.isTouchCX()&&(d(v.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]'),"radio"),k(a,"radio"));v.jppoints.find("#jpPointsMax").is(":checked")&&(c>=g?b():e.isSPP()&&v.paymentRows.find("#gcPromo, input[name\x3d'useAvailableBalance']").is(":checked")&&(a=v.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]'),
g-=parseInt(a.val(),10),f>=g&&b()))}function f(){var a=v.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]');a.attr("checked",!1);var b=v.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]');b.val("");b.removeClass("a-form-error");v.jppoints.find("#jpPointsError").hide();m.isTouchCX()&&d(a,"radio")}function t(){var c=v.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),d=parseInt(c.val(),10);!d||0>d?(c.val(""),v.jppoints.find("#jpPointsError").hide(),v.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').removeClass("a-form-error")):
(c.val(d),parseInt(v.jppoints.find("#redeemableAmount").text(),10)<d?(v.jppoints.find("#jpPointsError").show(),v.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').addClass("a-form-error")):(v.jppoints.find("#jpPointsError").hide(),v.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').removeClass("a-form-error"),c=parseInt(v.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10),parseInt(v.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsConversionRate"]').val(),
10),d>=c&&b(),q.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:actionToggleJPPointsSection",d)})))}var J=a.$,v={},C={paymentRows:"#existing-payment-methods .payment-row",jppoints:"#jppoints",mcbPointsWarning:"#mcbPointsWarning"};a.on("checkout:reload:payselect",h);a.on("checkout:reload:spp-payment",h);return{handleJPPointsOnPaymentRows:function(a){a=J(a.currentTarget);if("jppoints"!==a.attr("id"))if("useAvailableBalance"===a.attr("name"))w(a);else{l.isMCBMultiTenderWeblabEnabled()||
g.hideMCBWarningMessageForPoints(v);var b=a.find('input[type\x3d"radio"][name\x3dpaymentMethod]');if(!l.isMCBMultiTenderWeblabEnabled()&&b.length&&0<b.filter("[value^\x3dMCB]").size())g.showMCBWarningMessageForPoints(v),r();else if("availablebalance"===a.attr("value")||a.find("#pm_300")&&"availablebalance"===a.find("#pm_300").attr("value"))r();else{a=v.jppoints.find("#redeemPoints");var b=v.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"]'),c=v.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),
d=v.jppoints.find("#redeemableAmount"),f=v.jppoints.find("#redeemableValue");e.isSPP()&&v.jppoints.find("label").removeClass("disabled-color");a.attr("disabled",!1);b.attr("disabled",!1);c.attr("disabled",!1);J('#existing-balance input[type\x3d"radio"][value\x3d"availablebalance"]').length&&(d.text(v.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithoutGC"]').val()),f.text(v.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithoutGC"]').val()));m.isTouchCX()&&(a.siblings("i").removeClass("a-button-disabled"),
b.siblings("i").removeClass("a-button-disabled"))}}},handleJPPointsWithGC:w}});"use strict";q.when("A","ajax-utility","client-side-metrics","pay-common-util","pay-validator","page-transition-controller","page-conductor","a-popover-position","inline-points-register-controller","jppoints","pay-credit-card","checkout-general-utils","a-popover-base","a-dropdown","pay-rewards-currency","cache-page-data-controller","pay-credit-card-reregistration","mobile-carrier-billing-util","emi-helper","instant-bank-discount-helper",
"safe-apx-helper","apb-limit-messaging-helper").register("existing-payments",function(a,m,n,e,g,l,h,b,d,k,c,p,D,u,w,x,z,f,t,J,v,C){function A(){return F.paymentRows.filter(function(){return K(this).hasClass("payment-selected")||K(this).find("#redeemPoints").is(":checked")})}function M(a){l.show();a.$event.preventDefault();var b=A().find(".card-unreg-rewards").data();b.recommendedPaymentMethodId=b.paymentinstrumentid;e.makeAjaxCall(a.$target.attr("href"),b)}function S(b){b=K(b.currentTarget);var c=
b.data();if(!(0>=c.ratio)){var d=b.val()/c.ratio;if(!isNaN(d)){var f=b.val();f<c.min&&(d=0);b=e.getNumberWithSeparators(d,c.decimalplaces);A().find(".custom-reward-points").html(b);q.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:actionToggleRewardsSection",f)})}}}function P(a){1===a.data.refresh&&(l.show(),e.makeAjaxCall(a.data.url))}function G(a){Ea(a)?(a=F.continueBtns,a.find(".a-button-primary:not(.a-button-disabled)").addClass("aok-hidden"),a.find(".a-button-disabled").removeClass("aok-hidden")):
K("#payPageContinueBtnStateFixEnabled").length&&U(a)}function L(a){e.isTouchCX()&&(Ea()?a.$event.preventDefault():(F.continueErrPopover.hide().find(".error-message").hide(),l.show()))}function H(a){e.isTouchCX()&&(Ea()||F.continueErrPopover.hide().find(".error-message").hide())}function X(a){a=K(a.currentTarget);a.click();a=a.closest(".payment-container");a.find("#cc-errors").is(":visible")?a.find(".tv-update .a-button-primary").focus():a.click()}function I(a){a.$event.preventDefault();var b=A();
if(!c.runConfirmCardValidator(b,b.find("#cc-errors"))){l.show();var d=(b=e.getInputValues(b))||{},f=e.getInputValues(F.hiddenFormFields),g;for(g in f)f.hasOwnProperty(g)&&(d[g]=f[g]);c.confirmCreditCard(b,Ba,a.data.url)}}function T(){F.continueErrPopover.filter(":visible").length&&F.continueErrPopover.hide()}function U(){F.continueErrPopover.filter(":visible").length&&F.continueErrPopover.hide().find(".error-message").hide();var a=A();F.disableSubmitButtons.length?a.find(".no-address").length||(a.find(".continue-center").removeClass("aok-hidden"),
a.find(".a-button-disabled").addClass("aok-hidden")):(F.continueBtns.find(".a-button-primary:not(.a-button-disabled)").removeClass("aok-hidden"),F.continueBtns.find(".a-button-disabled").addClass("aok-hidden"));if(a){var b=a.find(".a-form-error");b&&b.length&&(b.removeClass("a-form-error"),(a=a.find(".pincode-err-block").filter(":visible"))&&a.length&&(F.continueErrPopover.hide().find(".error-message").hide(),F.continueBtns.find(".a-button-primary").removeClass("aok-hidden"),F.continueBtns.find(".a-button-disabled").addClass("aok-hidden"),
a.hide()))}}function W(){F.continueErrPopover.filter(":visible").length||F.continueBtnTop.trigger("click")}function aa(a){if(13===a.which){var b=K(document.activeElement),c=b.closest("div.payment-row"),d=b.closest(".a-button"),b=b.get(0).tagName;if(c.length&&!d.length&&"A"!==b&&"a"!==b)return c=c.find('input[type\x3d"submit"]'),c.length?c.trigger("click"):(F.continueErrPopover.filter(":visible").length&&F.continueErrPopover.hide(),Ea(a)?(e.isTouchCX()||(F.continueBtns.find(".a-button-primary").addClass("aok-hidden"),
F.continueBtns.find(".a-button-disabled").removeClass("aok-hidden")),a.preventDefault()):F.continueBtnTop.trigger("click")),!1}}function ha(a){l.show();var b=A(),c=b.find("input[type\x3dradio][name\x3dpaymentMethod]").val(),d=b.find(".card-unreg-rewards").data(),b=e.isTouchCX()?b.find(".flag-register-rewards"):F.rewardsRegister,b=e.getInputValues(b);b.programid=d.programid;b.paymentinstrumentid=d.paymentinstrumentid;b.CARD_EXPIRATION_DATE=d.expiredate;b.CARD_HOLDER_NAME=d.holdername;b.returnRefreshedPage=
a.data.returnRefreshedPage;b.rewardsdateofbirthmonth&&b.rewardsdateofbirthday&&(b.DATE_OF_BIRTH=b.rewardsdateofbirthmonth+b.rewardsdateofbirthday);-1===a.data.url.toLowerCase().indexOf("cachebuster")&&(a.data.url=p.addQueryStringParameter(a.data.url,"cacheBuster",(new Date).getTime()));e.makeAjaxCall(a.data.url,b,{successHandler:function(a,b,d){l.hide();if(a){a=m.jsonify(a);F.rewardsRegister.find(".register-content").hide();var f=e.isTouchCX()?A().find(".register-error"):F.rewardsRegister.find(".register-error");
f.hide();a.error?f.show().find(".error-message").hide().filter("#"+a.error).show():(h.ajaxUpdatePage(a.refreshedPage,b,d),b=F.paymentRows.find('input[type\x3dradio][name\x3dpaymentMethod][value\x3d"'+c+'"]').closest(".payment-row"),b.trigger("click"),e.scrollTopTo(b))}}})}function B(a){a=K(a.currentTarget).parents("div.currency-list");var b=a.find("label.a-touch-radio");b.length?b.trigger("click"):a.find("input[type\x3dradio][value\x3dOther]").trigger("click")}function Y(a){a=a.$target.closest("div.payment-row");
var b=a.find(".currency-list");if(h.isSPP()){var c=u.getSelect(b.find("select"));null!==c&&c.setValue("")}a.find(".change-currency").hide();b.show();e.isTouchCX()&&(a.find(".top-cell").removeClass("bottom-line").addClass("bottom-line"),a.find(".bottom-cell").show());E();Aa()}function Z(a){a=a.$target.closest("div.payment-row");a.find(".expire-info, .expire-date").hide();a.find(".enter-date, .expire-date-fields").show();E();la()}function y(a){var b=a.$target.closest("div.payment-row"),c="true"===e.getAttributeData(b,
"isaddresschallenge")?1:0;b.find(".expire-date-fields").length?(Z(a),b.find("#newExpDate").focus()):c&&b.find("#addCreditCardNumber").focus()}function ca(a){setTimeout(function(a){var b=K(a.target);a=document.createEvent("UIEvents");a.initUIEvent("DOMActivate",!0,!0,r,1);b.get(0).dispatchEvent(a)},0,a)}function da(a){var b=K(a.target).closest("div.payment-row");""!==K(a.target).val()&&("true"===e.getAttributeData(b,"isaddresschallenge")?b.find("#addCreditCardNumber").focus():W())}function ba(){var a=
A();a.find("div.flag-register-rewards").is(":visible")?(a.find(".bottom-cell").hide(),a.find(".top-cell").removeClass("bottom-line"),a.find(".card-unreg-rewards").show()):(a.find(".card-unreg-rewards").hide(),a.find(".bottom-cell").show(),a.find(".top-cell").removeClass("bottom-line").addClass("bottom-line"))}function ma(){ba()}function N(a){a.$event.preventDefault();if("1"===A().find("div.flag-register-rewards").attr("cached"))ba();else{var b=a.$target.attr("href");-1===b.toLowerCase().indexOf("cachebuster")&&
(b=p.addQueryStringParameter(b,"cacheBuster",(new Date).getTime()));l.show();e.makeAjaxCall(b,a.data,{successHandler:function(a){l.hide();var b=m.jsonify(a);a=e.decodeJSONResponse(b.widgetHTML);var c=A();c.find("div.flag-register-rewards").html(a);c.find("div.flag-register-rewards").attr("cached",1);c.find("div.flag-register-rewards .error-message").each(function(){var a=K(this),c=a.data("errorid");a.html(b.displaydata[c])});ba()}})}}function ra(b){var c=K(b.target);if(!c.is(":visible"))return b.preventDefault(),
b.stopPropagation(),!1;h.isSPP()&&(h.isPrefetchFromAddressEnabled()?h.disablePageNoUpdateTransition():K("#payment").find(".panel-cancel-row").hide(),x.clearCache());var d=K(b.currentTarget);F.jppoints.length&&k.handleJPPointsOnPaymentRows(b);var g=d.find("[name\x3duseAvailableBalance]");if("useAvailableBalance"!==b.target.name&&!g.length)if(R(d),f.toggleGCForMCB(d,F),oa(d),d.hasClass("payment-selected")||d.hasClass("payment-label"))F.disableSubmitButtons.length&&(pa(d,d,!1),!c.hasClass("continue-center")&&
d.find(".continue-center").length||W());else if(b=d.find('input[type\x3d"radio"][name\x3d"paymentMethod"]'),b.length&&"disabled"!==b.attr("disabled")){$a();b=A();h.isSPP()?b.filter(function(){var a=K(this).attr("id");return"gcPromo"===a?(a=K(this).find('input[type\x3d"radio"][name\x3d"paymentMethod"][value\x3d"availablebalance"]'))&&a.length:"jppoints"!==a}).removeClass("payment-selected"):b.removeClass("payment-selected");b.find("[name\x3dpaymentMethod]").attr("checked",!1);b.find("i[data-a-input-name\x3dpaymentMethod]").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");
b.find(".top-cell").removeClass("bottom-line");Ca(b);e.isTouchCX()&&(b.find(".bottom-cell").hide(),b.find(".card-unreg-rewards").show());d.addClass("payment-selected");d.find("[name\x3dpaymentMethod]").attr("checked",!0);d.find("i[data-a-input-name\x3dpaymentMethod]").removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active");var c="true"===e.getAttributeData(d,"isaddresschallenge")?1:0,g=d.find('.rewards-list input[type\x3d"radio"]').length,l="1"===e.getAttributeData(d,"hasDerivedCurrency")?
1:0,p=d.find(".vcc-form-fields").length,m=d.find(".card-ref-num").length;e.isTouchCX()&&(c||g||p||m||l)&&(d.find(".top-cell").removeClass("align-top bottom-line").addClass("bottom-line"),d.find(".bottom-cell").show());q.when("rewards-section-desktop").execute(function(b){a.trigger("rewards-section-desktop:select-payment-row",d,Aa)});Qa(d);Ua(d);Oa(d);ta(d);bb(d);"1"===K("#suppressionMessageFixEnabledStatus").val()&&ab(d);cb(d);Va(d);Pa(d);Wa(d);db(d);eb(d);Xa(d);Ha(t,t.toggleEMIMenu,d);Ya(d);fb();
wa(d);Ga();E();la();H();ga();ya(d,b);Sa();F.hideInputBoxes.length&&(Ta(d,b),Ra(d));F.disableSubmitButtons.length&&pa(d,b,!0);Ka();Aa();F.disableSubmitButtons.length&&!d.find(".continue-center").length&&W()}}function oa(a){a=a.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]');var b=K("input[type\x3d'hidden'][name\x3d'paySelectLocale']");b.length&&"IN"===b.val()&&a.length&&q.when("client-side-metrics").execute(function(a){a.increaseCount("PayPage-COD-NonMobile",1)})}function R(a){var b=
K("#isGlobalCODEligible").val();if(b&&"0"!==b){a=a.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]');var b=K("#button-add-gcpromo"),c=K("#button-add-gcpromo").parent().parent();a.length?(c.addClass("a-button-disabled"),b.attr("disabled","disabled")):(c.removeClass("a-button-disabled"),b.removeAttr("disabled"))}}function xa(a){q.when("A","a-tv").execute(function(b,c){b=b.$;var d=b(a);d.length&&(b(".tv-lastSelected").removeClass("tv-lastSelected"),d.addClass("tv-lastSelected"),c.select(d))})}
function pa(a,b,c){c&&b.find(".billing-address, .cc-continue-button").hide();if(a.find(".tv-update").length)Ta(a,b),Ra(a);else{var d=a.find(".billing-address, .cc-continue-button");if(d.length&&!d.is(":visible")){var e=!1;a.find(".no-address").length&&(e=!0,a.find(".a-button-primary").addClass("aok-hidden"),a.find(".a-button-disabled").removeClass("aok-hidden"));q.when("a-tv").execute(function(f){c&&(b.find(".payment-container").hasClass(".a-tv-navigate")||f.add(b.find(".payment-container")));f.remove(a.find(".payment-container"));
f=e?a.find(".billing-address-link"):d.find(".continue-center");xa(f)});d.show()}}}function wa(a){var b=K("#one-click-final-review-message");b.length&&(a.find("#canTryTFX").length?b.removeClass("aok-hidden"):b.addClass("aok-hidden"))}function ya(a,b){if(e.isTouchCX()&&(b&&b.find(".top-cell .data-row").children(".a-column").height("auto"),a)){a=a.find(".top-cell .data-row");var c=a.find(".addr-challenge-card-scan .a-box");if(c.length){b=a.height();var c=c.height(),d=a.children(".a-column:first");a.children(".a-column").height(c);
d.height(b);d.children(".vertical-center-grid:first").height(c)}else a.children(".a-column").height(a.height())}}function Ba(b){l.hide();var d=m.jsonify(b);d.imbWidgetHTML&&K("#imb-wrapper").html(e.decodeJSONResponse(d.imbWidgetHTML));if(d.cardWidgetHTML&&(b=A(),b.replaceWith(e.decodeJSONResponse(d.cardWidgetHTML)),null!=d.rewardsAccountsWidgetHTML&&q.when("rewards-section-desktop").execute(function(b){a.trigger("rewards-section-desktop:refresh-rewards-section",e.decodeJSONResponse(d.rewardsAccountsWidgetHTML))}),
a.trigger("checkout:reload"),a.trigger("checkout:reload:payselect"),b=A(),"true"!==e.getAttributeData(b,"isaddresschallenge"))){c.setCardPasswordInputStatus(b,d.newpaymentmethodid,"cvv","#existingCvvNum");c.setCardPasswordInputStatus(b,d.newpaymentmethodid,"pincode","#existingPincodeNum");if(F.cvvColumnLabel.length){var f=!1;F.paymentRows.each(function(){if("true"===e.getAttributeData(K(this),"isaddresschallenge"))return f=!0,!1});f||F.cvvColumnLabel.hide()}F.disableSubmitButtons.length&&W()}}function E(){F.paymentRows.each(function(){var a=
K(this),b=a.find('.currency-list input[type\x3d"radio"]').length,c=a.find('.rewards-list input[type\x3d"radio"]').length,d=a.find(".card-reg-info").is(":visible"),f=a.find(".expire-date-fields").is(":visible"),g=a.find("a[data-action\x3dshow-expire-date-fields]").is(":visible"),k=a.find(".bottom-cell .inner-grid-left"),h=a.find(".bottom-cell .inner-grid-right");f?b||c||d?(k.removeClass("hidden a-span10 a-span12").addClass("a-span8"),h.removeClass("a-span12 a-span2 hidden").addClass("a-span4")):(k.removeClass("a-span8 a-span10 a-span12").addClass("hidden"),
h.removeClass("a-span4 a-span2 hidden").addClass("a-span12")):g?(k.removeClass("a-span12 a-span8 hidden").addClass("a-span10"),h.removeClass("hidden a-span4 a-span12").addClass("a-span2")):(k.removeClass("a-span10 a-span8 hidden").addClass("a-span12"),h.removeClass("a-span2 a-span4 a-span12").addClass("hidden"));!e.isTouchCX()&&g&&(b||c||d)&&a.find(".bottom-cell").removeClass("align-top").addClass("align-top")});var a=A(),b=a.find("a[data-action\x3dshow-expire-date-fields]").filter(":visible").length,
c=a.find(".top-cell.bottom-line").length;b&&!c||a.find(".bottom-cell").removeClass("align-top")}function la(){e.isTouchCX()&&F.paymentRows.each(function(){var a=K(this),b="true"===e.getAttributeData(a,"isaddresschallenge")?1:0,c=a.find("a[data-action\x3dshow-expire-date-fields]").is(":visible"),d=a.find(".expire-date-fields").is(":visible"),f=a.find(".card-reg-info").is(":visible"),g=a.find(".rewards-info").is(":visible"),k=a.find(".change-currency").is(":visible");c?a.find(".top-cell .second-row").addClass("align-top"):
a.find(".top-cell .second-row").removeClass("align-top");b=b||k||f||g;f=d||c;g=a.find(".top-cell .inner-grid-left");a=a.find(".top-cell .inner-grid-right");b||(g.removeClass("a-span6 a-span8 a-span12").addClass("hidden"),a.removeClass("a-span4 a-span6 hidden").addClass("a-span12"));f||(g.removeClass("a-span6 a-span8 hidden").addClass("a-span12"),a.removeClass("a-span4 a-span6 a-span12").addClass("hidden"));b&&c&&(g.removeClass("a-span6 a-span12 hidden").addClass("a-span8"),a.removeClass("a-span6 a-span12 hidden").addClass("a-span4"));
b&&d&&(g.removeClass("a-span6 a-span8 hidden").addClass("a-span6"),a.removeClass("a-span4 a-span12 hidden").addClass("a-span6"))})}function Ca(a){var b=a.find(".currency-list");if(b.length){var c=b.find("[type\x3dradio]:checked").val(),b=b.find("#cardCurrencyDropDown option:selected").val();"Other"!==c||"-1"!==b&&"-2"!==b||a.find(".currency-list input[type\x3dradio][value!\x3dOther]").attr("checked",!0)}}function Q(a){var b=K(a.currentTarget);a=b.find("option:selected");if(""===a.val())b.parents("div.selected-section").find(".selected-note-content").hide();
else{var c=a.prop("disabled"),b=b.parents("div.selected-section"),d=b.find("#active-bank-content"),e=b.find("#disable-bank-content");c?(e.show(),d.hide()):(d.show(),e.hide());b.find("span.selected-note-bank").text(a.text()).show()}}function qa(a){var b=K(a.currentTarget);a=b.find("option:selected");""===a.val()?b.parents("div.selected-section-more-payment-method").find(".selected-more-payment-content").hide():(b=b.parents("div.selected-section-more-payment-method"),b.find("span.selected-payment-option").text(a.text()).show(),
b.find("span.selected-more-payment-content").show())}function fa(a){(F.continueErrPopover.filter(":visible").length||Ea())&&a.$event.preventDefault()}function ja(b){b=K(b.currentTarget);var c=b.find("input[type\x3dcheckbox]");c.attr("checked")?(c.attr("checked",!1),b.find(".checked-checkbox").addClass("aok-hidden"),b.find(".empty-checkbox").removeClass("aok-hidden"),b.find(".gc-balance-insufficient-msg").addClass("aok-hidden")):(c.attr("checked",!0),b.find(".checked-checkbox").removeClass("aok-hidden"),
b.find(".empty-checkbox").addClass("aok-hidden"),b.find(".gc-balance-insufficient-msg").removeClass("aok-hidden"));q.when("a-tv").execute(function(b){setTimeout(function(){b.select(".tv-lastSelected")},500);a.trigger("a:tv:resize")})}function sa(a){a=K(a.currentTarget);"1"===a.attr("isclicked")?a.attr("isclicked",0):a.attr("isclicked",1);ga()}function ga(a){var b=K("#pm_promo");a=K("#pm_gc_radio");var c=K("#pm_gc_checkbox"),d;K("input[name\x3ddoesPurchaseContainOnlyRecurringPrimeMembership]").length&&
(d=K("input[name\x3ddoesPurchaseContainOnlyRecurringPrimeMembership]").val());if(a&&a.length||c&&c.length){var f=K("input[name\x3dgcBalanceRaw]").val();K("input[name\x3damBalanceRaw]").length&&(f=K("input[name\x3damBalanceRaw]").val());var g=K("input[name\x3disAPBLimitMessagingLaunchWeblabEnabled]").val(),k=K("input[name\x3dhasAPBRedeemableLimitExhausted]").val(),h=K("input[name\x3damAvailableBalanceRaw]").val(),l=K("input[name\x3dremainingBalanceRaw]").val(),p=K("input[name\x3dpurchaseTotalRaw]").val(),
m,n,ea=K(".purchase-total").length;ea?(n=K(".purchase-total").html(),m=K(".remaining-balance").html()):(n=K("input[name\x3dpurchaseTotal]").val(),m=K("input[name\x3dremainingBalance]").val());var t=K(".balance-applied");ea?t.html(n):t.text(n);(e.isTouchCX()&&"checkbox"===b.attr("type")?"1"===b.closest(".a-control-row").attr("isclicked"):b.is(":checked"))?(b=l,0<b&&(ea?t.html(m):t.text(m))):b=p;g&&C.renderAPBMessagingRemainingBalance({purchaseTotal:n,remainingBalance:m,balanceApplied:t,isPurchaseTotalInSpan:ea},
f,p,h);m=a.closest(".radio-col");n=c.closest(".radio-col");l=K(".amazon-money-limit-breached");ea=K(".long");t=K(".short");"1"===g&&"1"===k?C.displayAPBRedeemableLimitExhaustedMessaging({gcRadioContainer:m,gcCheckboxContainer:n,gcCheckbox:c,gcRadio:a,shortMsg:t,longMsg:ea,amazonMoneyLimitBreachedMsg:l}):0<=f-p?("disabled"===a.attr("disabled")&&a.removeAttr("disabled"),m.removeClass("hidden"),a.is(":checked")&&m.trigger("click"),n.addClass("hidden"),c.attr("disabled","disabled"),0==f-p?(ea.hide(),
t.show()):(ea.show(),t.hide())):0<f-b?0>=b?(n.removeClass("hidden"),c.attr("disabled","disabled"),e.isTouchCX()&&n.find("i").addClass("a-button-disabled checkbox-disabled"),m.addClass("hidden"),a.attr("disabled","disabled"),t.show(),ea.hide()):("disabled"===a.attr("disabled")&&a.removeAttr("disabled"),m.removeClass("hidden"),a.is(":checked")?m.trigger("click"):e.isTouchCX()&&m.find("i").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive"),n.addClass("hidden"),c.attr("disabled",
"disabled"),ea.show(),t.hide()):("disabled"===c.attr("disabled")&&(c.removeAttr("disabled"),e.isTouchCX()&&n.find("i").removeClass("a-button-disabled checkbox-disabled")),n.removeClass("hidden"),(k=n.closest(".payment-row"))&&k.hasClass("payment-selected")&&k.removeClass("payment-selected"),m.addClass("hidden"),a.attr("disabled","disabled"),"1"===g?C.renderAPBInsufficientMessaging({shortMsg:t,longMsg:ea},f,h):(t.show(),ea.hide()));"1"===d&&(a.attr("disabled","disabled"),c.attr("disabled","disabled"),
(k=n.closest(".payment-row"))&&k.hasClass("payment-selected")&&k.removeClass("payment-selected"))}}function ia(b){var c=A().find(".enter-custom-rewards");if("rewardscustom"===K(b.currentTarget).children('input[type\x3d"radio"]').val()){c.show();var d=c.find("input.custom-rewards-input");d.focus();F.paymentRows.find(".rewards-list").hasClass("show-currency-input-widget-new")&&(c=d.val().length,d=d.get(0),d.setSelectionRange?d.setSelectionRange(c,c):d.createTextRange&&(d=d.createTextRange(),d.collapse(!0),
d.moveStart("character",c),d.moveEnd("character",c),d.select()))}else c.hide();q.when("installments-payselect").execute(function(c){a.trigger("installments-payselect:toggleRewardsInstallmentEligibility",K(b.currentTarget))});Aa()}function za(a){a=a.$target||K(a.currentTarget);va(a)}function va(b){if(b.length){var c=F.paymentRows.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]'),d=F.paymentRows.find(".installments-select.a-row"),e=d.siblings(".installments-message"),f=d.siblings(".card-offers"),
g=F.paymentRows.find('input[type\x3d"radio"][value\x3d"morePaymentMethod"]'),k=F.installmentsOnlyCards,h=F.paymentRows.find('input[type\x3d"radio"][id\x3d"pmEmiPaymentOptions"]'),l=F.paymentRows.find('input[type\x3d"radio"][value\x3d"amazonBusinessCredit"]');if(c.length){var p=c.closest(".payment-row"),m=g.closest(".payment-row"),n=h.closest(".payment-row"),ea=l.closest(".payment-row");b.is(":checked")?(c.prop("disabled",!0),c.is(":checked")&&(c.prop("checked",!1),p.removeClass("payment-selected")),
c.parent().siblings().addClass("a-color-secondary"),Ha(t,t.disableEMIPaymentMethods,h),q.when("abc-helper").execute(function(b){a.trigger("abc-helper:disable-payment",l)}),J.showInstantBankDiscountAmazonPaySelected(),ua(g,m),(b=d.find("select"))&&b.each(function(){var a=this.id.replace(/\./g,"\\.");u.setValue(a,"")}),d.find(".installments-enabled-text").hide(),e.find(".installments-enabled-text").hide(),f.find(".installments-enabled-text").hide(),d.find(".installments-disabled-text").show(),e.find(".installments-disabled-text").show(),
f.find(".installments-disabled-text").show(),K("#isGurupaPspToggleGcBugfixEnabled").length&&"1"===K("#isGurupaPspToggleGcBugfixEnabled").val()?k.find("input[name\x3dpaymentMethod]").attr("disabled","disabled").filter(":checked").removeAttr("checked"):k.find("input[name\x3dpaymentMethod]").attr("disabled","disabled").removeAttr("checked"),k.removeClass("payment-selected")):(p.find(".payment-invalid").length||(c.prop("disabled",!1),c.parent().siblings().removeClass("a-color-secondary")),m.find(".payment-invalid").length||
na(g,m),n.find(".payment-invalid").length||Ha(t,t.enableEMIPaymentMethods,h),ea.find(".payment-invalid").length||q.when("abc-helper").execute(function(b){a.trigger("abc-helper:enable-payment",l)}),J.showInstantBankDiscountAmazonPayDeselected(),d.find(".installments-disabled-text").hide(),e.find(".installments-disabled-text").hide(),f.find(".installments-disabled-text").hide(),d.find(".installments-enabled-text").show(),e.find(".installments-enabled-text").show(),f.find(".installments-enabled-text").show(),
k.find("input[name\x3dpaymentMethod]").removeAttr("disabled"))}}}function na(a,b){a.prop("disabled",!1);a.parent().siblings().removeClass("a-color-secondary");b.find(".selected-section-more-payment-method").show();b.find(".more-payment-gc-disabled-text").hide()}function ua(a,b){a.prop("disabled",!0);a.is(":checked")&&(a.prop("checked",!1),b.removeClass("payment-selected"));a.parent().siblings().addClass("a-color-secondary");b.find(".selected-section-more-payment-method").hide();b.find(".more-payment-gc-disabled-text").show()}
function ka(a){var b=a.$target||K(a.currentTarget);a=b.closest(".currency-list");b=b.val();!0===(e.isTouchCX()?"Other"===b:"Other"!==b)?(a.find("select").attr("disabled",!0),a.find(".a-button.a-button-dropdown").addClass("a-button-disabled"),a.find(".a-button.a-touch-select").addClass("a-button-disabled")):(a.find("select").attr("disabled",!1),a.find(".a-button.a-button-dropdown").removeClass("a-button-disabled"),a.find(".a-button.a-touch-select").removeClass("a-button-disabled"));Aa()}function O(a){z.actionReregisterCardInBox(a);
e.scrollTopTo(A())}function ea(a){Aa()}function Fa(){F.paymentRows.each(function(){var a=K(this),b=".card-ref-num, .addr-challenge, .addr-challenge-msg, .cup-expired-msg, .enter-date, .expire-date-fields, .rewards-static-help-link, .verified-fail-msg, .tv-update, .billing-address, .cc-continue-button",c=".card-info, .card-name, .card-reg-info, .expire-info, .rewards-err-msg, .rewards-list label, .rewards-list div.a-radio, .rewards-dynamic-help-link, .financial-offer-err-detail";a.hasClass("payment-selected")&&
("1"===e.getAttributeData(a,"hasDerivedCurrency")||"1"===e.getAttributeData(a,"hasPreferredCurrency")&&"1"===e.getAttributeData(a,"isNewCard"))||(b+=", .currency-list");"1"===e.getAttributeData(a,"hasPreferredCurrency")&&"1"!==e.getAttributeData(a,"isNewCard")&&(c+=", .change-currency");a.find(b).hide();a.find(c).show()})}function Ga(){F.paymentRows.each(function(){var a=K(this),b="#cc-errors, .enter-date, .expire-date-fields",c=".expire-info";if(a.hasClass("payment-selected")&&"1"===e.getAttributeData(a,
"hasDerivedCurrency"))b+=", .change-currency",c+=", .currency-list";else{var d=a.find(".currency-list"),f=d.find("[type\x3dradio]:checked").val();if(f){var g;if("Other"!==f)g=d.find(".currencyNameLabel").html();else{var f=d.find("#cardCurrencyDropDown option:selected"),k=f.val();"-1"!==k&&"-2"!==k&&(g=f.text())}g&&(c+=", .change-currency",d.closest("div.payment-row").find(".change-currency .currencyNameLabel").html(g))}b+=", .currency-list"}a.find(b).hide();a.find(c).show()})}function Da(){var a=
K("#aan-ads-box");if(a.length){var b=a.data("adsendpoint"),c=a.data("adsclient"),d="https://"+b+"/2009-09-09/ad/",b="/jsc?pt\x3dstatic\x26slot\x3dlib\x26pt2\x3daanjs";a.data("useaannojq")&&(b+="-nojq");K.getScript(d+c+b,function(){r.d16g&&r.d16g.requestAanAd({elemId:"aan-ads-box",baseUrl:d,afterOnload:!0,client:c,pt:"checkout",slot:"display-ad-right",pt2:"payselect"})})}}function Ja(){Za&&(a.declarative("auto-rewards-reg",["click"],M),a.declarative("complete-rewards-register",["click"],P),a.declarative("confirm-card",
["click"],I),a.declarative("register-card-rewards",["click"],ha),a.declarative("cancel-register-card-rewards",["click"],ma),a.declarative("show-currencies",["click"],Y),a.declarative("show-expire-date-fields",["click"],Z),a.declarative("focus-cc-update-fields",["click"],y),a.declarative("show-rewards-reg",["click"],N),a.declarative("submit-payment-form",["submit"],fa),a.declarative("toggle-tfx-option",["click"],ka),a.declarative("reregister-cc-in-dashboard",["click"],O),a.declarative("modify-expire-date-fields",
["change"],ea),e.isTouchCX()&&a.declarative("continue-button",["click"],L),Za=!1);F.paymentRows.unbind("click").has("input[name\x3dpaymentMethod]:enabled").bind("click",ra);q.when("apx-payselect-helper").execute(function(){var a=v.get("payselect");a&&a.initEvents(F.paymentRows,Aa)});F.paymentRows.find("input[name\x3dusePromoBalance]").unbind("change",ga).bind("change",ga);F.disableSubmitButtons.length&&F.paymentRows.has("input[type\x3dcheckbox]:enabled").unbind("click",ja).bind("click",ja);F.existingPincodeNum.unbind("click",
La).bind("click",La);F.paymentRows.find("select#cardCurrencyDropDown").unbind("change",B).bind("change",B);F.paymentRows.find(".rewards-list").hasClass("show-currency-input-widget-new")?F.paymentRows.find(".rewards-list").undelegate("label","click").delegate("label","click",ia).each(function(b,c){c=a.$(c);b=c.find("input.custom-rewards-input");c=c.find(".custom-reward-points");var d=a.$(b);b={$element:d,maxAmount:d.data("max")};c={$element:a.$(c),decimalPlaces:d.data("decimalplaces"),ratio:d.data("ratio")};
d=d.data("country-code");d=w.getCurrencyFormatByCountryCode(d);w.initializeInlineFormatting(b,c,d)}):F.paymentRows.find(".rewards-list").undelegate("label","click").delegate("label","click",ia).undelegate("input.custom-rewards-input","keyup").delegate("input.custom-rewards-input","keyup",S);if(e.isTouchCX())F.pageContainer.find("#existing-payment-methods").find("select, input[type\x3dtext], input[type\x3dpassword]").unbind("change",H).bind("change",H),F.pageContainer.find("#existing-payment-methods").find("div.currency-list label.a-touch-radio").unbind("click").bind("click",
ka),F.pageContainer.find("#existing-payment-methods").find("label.promoLabel").unbind("click").bind("click",sa);else if(!h.isSPP()){var b=F.continueBtns.find(".a-button-text");K("#payPageContinueBtnStateFixEnabled").length?b.filter('input[type\x3d"button"]').unbind("mouseenter",Ia).bind("mouseenter",Ia).unbind("focus",Ia).bind("focus",Ia).unbind("mouseleave",T).bind("mouseleave",T).unbind("blur",T).bind("blur",T):(b.filter('input[type\x3d"submit"]').unbind("mouseenter").bind("mouseenter",G).unbind("focus").bind("focus",
G),b.filter('input[type\x3d"button"]').unbind("mouseleave").bind("mouseleave",U).unbind("blur").bind("blur",U))}F.netBankingSelect.unbind("change",Q).bind("change",Q);F.morePaymentMethodsSelect.unbind("change",qa).bind("change",qa);F.continueBtnBottom.unbind("click").bind("click",W);0<K("input[name\x3d'needDisableCODandEMIforGC']").length&&(b=K("input#pm_300[type\x3d'checkbox'], #pm_gc_checkbox"),b.length&&(b.bind("change",za),b.is(":checked")&&va(b)));F.jppoints.length&&F.paymentRows.find('input[name\x3d"useAvailableBalance"]').bind("click",
k.handleJPPointsOnPaymentRows);q.when("installments-payselect").execute(function(){a.trigger("installments-payselect:initEvents")});F.hideInputBoxes.length&&(F.paymentRows.find("#confirm-card").unbind("focus").bind("focus",X),F.paymentRows.find("#newExpDate").unbind("focus").bind("focus",ca),F.paymentRows.find("#newExpDate").unbind("change").bind("change",da))}function Ka(){var a=g.create();a.validatePayment(A());a.hasErrors()||h.makePrefetch(F.existingPaymentForm)}function La(a){a=F.showAmexWarning;
null!==a&&(a.removeClass("hidden"),a.removeClass("amex_display"))}function Ma(){if(!e.isMobileCX()){F=e.getElements(gb);F.paymentRows.filter(".payment-selected-marker").removeClass("payment-selected-marker").addClass("payment-selected");var b=A();q.when("rewards-section-desktop").execute(function(b){a.trigger("rewards-section-desktop:page-load",Aa)});q.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:page-load")});ta(b);Pa(b);wa(b);Fa();Qa(b);Ua(b);Oa(b);Wa(b);
Xa(b);Ya(b);Va(b);ga();Sa();K(document).undelegate("div.pay-desktop .checkout-page-form","keypress").delegate("div.pay-desktop .checkout-page-form","keypress",aa);K(document).undelegate("div.pay-desktop .checkout-page-form .enter-custom-rewards","keyup").delegate("div.pay-desktop .checkout-page-form .enter-custom-rewards","keyup",Aa);F.addressChallengeCardList.length&&F.addressChallengeCardList.show();F.paymentRows.find('input[type\x3d"radio"][value\x3d"rewardsmax"]').each(function(){K(this).siblings('[type\x3d"checkbox"]').remove()}).removeClass("hidden");
la();E();Ja();F.existingPaymentForm.data("checkoutFormReady",!0);Ka();Da();F.orderSummaryBottom.show();ya(b);H();Aa();R(b);f.determineIsMCBEnabled(F);f.toggleGCForMCB(b,F);K(".a-popover-preload").each(function(){var b=K(this).find(".rewards-registration").data("parentPaymentMethodId");b&&(a.off("a:popover:show:rewards-registration-"+b,d.displayRewardsRegister),a.off("a:popover:hide:rewards-registration-"+b,d.hideRewardsRegister),a.on("a:popover:show:rewards-registration-"+b,d.displayRewardsRegister),
a.on("a:popover:hide:rewards-registration-"+b,d.hideRewardsRegister))});q.when("a-tv").execute(function(c){a.trigger("a:tv:resize");b.find(".a-tv-navigate").length&&pa(b,b,!1)})}}function Aa(b){h.isSPP()?(Ea()?F.disableSubmitButtons.length?(b=A(),b.find(".continue-center").addClass("aok-hidden"),b.find(".a-button-disabled").removeClass("aok-hidden")):(F.continueBtns.find(".a-button-primary:not(.a-button-disabled)").addClass("aok-hidden"),F.continueBtns.find(".a-button-disabled").removeClass("aok-hidden")):
U(),a.trigger("orderSummary:primaryActionButton:mirrorPanelBtnState")):K("#payPageContinueBtnStateFixEnabled").length&&G(b)}function Na(a,c){a=K(a.target).closest(".order-summary-box").find(".continue-button-errors");a.length&&c.length&&(c=b.triggerLeft(a,c),a.show(),a.offset(c))}function Ia(a){if((!F.continueErrPopover.filter(":visible").length||e.isTouchCX())&&F.continueErrPopover.find(".error-message:not(.hidden)").length&&a&&("mouseenter"===a.type||"focus"===a.type)){var b=K(a.target).closest(".continue-buttons").find(".a-button-disabled");
Na(a,b)}}function Ea(a){if(F.continueErrPopover.filter(":visible").length&&!e.isTouchCX())return!0;var c=A(),d=g.create();Ha(t,t.isEMIPaymentInstrument,c)&&(d.validateEMIMenuForContinueButton(c),c=Ha(t,t.getEMIMenuSelectedCardSection));d.validatePayment(c);d.apxValidatePayment(c,F.paymentRows);d=d.getHighestErrorId();if(!d||!d.identifier)return!1;F.continueErrPopover.find(".error-message").hide();c=c.find(".pincode-err-block");c.hide();c&&c.length&&d.target&&d.target.length&&d.target.addClass("a-form-error");
d.isPincodeError?(c.show(),c.addClass("a-form-error")):(F.continueErrPopover.find("#"+d.identifier).show(),F.continueErrPopover.find("#"+d.identifier).removeClass("hidden"),!a||"mouseenter"!==a.type&&"focus"!==a.type?h.isSPP||F.continueBtns.find(".a-button input").filter(":visible").each(function(){var a=K(this).closest(".order-summary-box").find(".continue-button-errors"),c=b.triggerLeft(a,K(this));a.show();a.offset(c)}):(c=K(a.target).closest(".continue-buttons").find(".a-button-primary"),Na(a,
c)));return!0}function Qa(b){F.paymentRows.find(".addr-challenge, .addr-challenge-msg").hide();F.hideInputBoxes.length?F.paymentRows.find(".card-name").show():F.paymentRows.find(".card-info").show();if("true"===e.getAttributeData(b,"isaddresschallenge")){var c=b.find(".addr-challenge, .addr-challenge-msg");0===c.length&&n.increaseCount("Checkout:Payment:AddressChallengeMissingInputAndMsg");c.show();F.hideInputBoxes.length?b.find(".card-name").hide():b.find(".card-info").hide();b=b.attr("paymentmethodid")?
b.attr("paymentmethodid"):b.attr("data-paymentmethodid");a.trigger("checkout:payment:challenge:log",b)}}function Ra(a){F.paymentRows.find(".expire-date-fields").hide();a=a.find(".expire-date-fields");a.length&&a.show()}function Sa(){F.paymentRows.find(".pci-blocking-cvv").length&&F.paymentRows.each(function(){var a=K(this),b=a.find(".pci-blocking-cvv");a.find("[type\x3dradio]:checked").val()&&b.length?b.show():b.length&&b.hide()})}function Ta(a,b){q.when("a-tv").execute(function(c){c.add(b.find(".payment-container"));
b.find(".tv-update").hide();var d=a.find(".tv-update");d.length&&(c.remove(a.find(".payment-container")),d.show(),xa(d.find(".a-button-primary")))})}function Ua(a){F.paymentRows.find(".verified-fail-msg").hide();"true"===e.getAttributeData(a,"isverifiedfail")&&a.find(".verified-fail-msg").show()}function Oa(a){F.paymentRows.find(".cup-expired-msg").hide();"true"!==e.getAttributeData(a,"iscupcardexpired")&&"true"!==e.getAttributeData(a,"iscupcardexpiringsoon")||a.find(".cup-expired-msg").show()}function ta(b){F.paymentRows.find(".rewards-list").hide();
F.paymentRows.find(".top-cell .inner-grid-left").show().find(".rewards-info").show();var c=b.find('.rewards-list input[type\x3d"radio"]'),d=c.filter(":checked");F.paymentRows.find('.rewards-list input[type\x3d"radio"]').prop("checked",!1);0<d.length?d.prop("checked",!0):b.find(".rewards-list").hasClass("apply-by-default")?c.filter('[value\x3d"rewardsmax"]').prop("checked",!0):c.filter('[value\x3d"rewardsnone"]').prop("checked",!0);c=b.find(".rewards-list").show();c.find('input[type\x3d"radio"][value\x3d"rewardscustom"]').is(":checked")&&
c.children(".enter-custom-rewards").show();e.isTouchCX()&&c.length&&(b.find(".rewards-info").hide(),b.find(".top-cell").addClass("bottom-line"),b.find(".bottom-cell").show());q.when("installments-payselect").execute(function(c){a.trigger("installments-payselect:toggleRewardsInstallmentEligibility",b)})}function Pa(a){F.paymentRows.find(".financial-offer-list").hide();F.paymentRows.find(".financial-offer-err-detail").hide();var b=a.find('.financial-offer-list input[type\x3d"radio"]'),c=b.filter(":checked");
b.prop("checked",!1);0<c.length?c.prop("checked",!0):b.first().prop("checked",!0);b=a.find(".financial-offer-list").show();a.find(".financial-offer-err-detail").show();e.isTouchCX()&&b.length&&(a.find(".top-cell").addClass("bottom-line"),a.find(".bottom-cell").show())}function $a(){K(document.body).find(".a-dropdown").each(function(){D.hide(K(this))})}function bb(a){F.paymentRows.find(".installments-select").hide();F.paymentRows.find(".installments-message").show();a.find(".installments-select").show();
a.find(".installments-message").hide()}function ab(a){F.paymentRows.find("#savedCardSuppressed").hide();a.find("#savedCardSuppressed").show()}function cb(a){F.paymentRows.find(".installments-list").hide();a.find(".installments-list").show()}function Va(a){F.paymentRows.find(".card-ref-num, .selected-note, .selected-more-payment-option").hide();F.paymentRows.find(".card-benefit").show();a.find(".card-ref-num, .selected-note, .selected-more-payment-option").show();a.find(".card-benefit").hide()}function db(a){F.paymentRows.find(".otpBlock").hide();
a.find(".otpBlock").show()}function eb(a){F.paymentRows.find(F.ovdWidgetSection).hide();a.find(F.ovdWidgetSection).show()}function Wa(a){F.paymentRows.find(".vcc-info-prompt,.vcc-form-fields").hide();a.find(".vcc-info-prompt,.vcc-form-fields").show()}function Xa(a){var b=F.newVDC.find("#vdcBanksSelect"),c=F.newVDC.find(".vdc-selected-bank-prompt").hide(),d=F.newVDC.find("#suppressedVerifiedDebitCard").hide(),e=b.val(),f="1"===K("#save_citi_card").val()?"CIT"!==e:!0,g="1"===K("#save_citi_card").val()&&
"CIT"===e;a.find("#vdcBanksSelect").length?""!==e&&"OtherBanks"!==e&&f&&(F.newVDC.find("option:selected").prop("disabled")?(d.show(),c.hide()):(d.hide(),c.show())):(("OtherBanks"===e||g)&&b.val(b.children("option").first().val()).trigger("change"),c.hide())}function Ha(a,b,c){if(!K.isEmptyObject(a)&&b)return b(c)}function Ya(a){var b=K("#cash-back-ineligible-for-cod-message");b&&b.length&&((a=a.find("#cashOnDeliveryCash"))&&a.length?b.removeClass("hidden"):b.addClass("hidden"))}function fb(){var a=
K("#imb-wrapper");if(a.length&&a.is(":visible")){var b=a.find(".defaultPaymentMethodExpired"),c=a.find(".codUnavailable"),d=a.find("p").length;0===b.length&&0===c.length||1!==d||a.hide()}}var K=a.$,Za=!0,F={},gb={cardImages:"#newCreditCardImages",continueBtns:".continue-buttons:not(.place-order-button)",continueBtnTop:"#continue-top",continueBtnBottom:"#continue-bottom",continueErrPopover:".continue-button-errors",cvvColumnLabel:"#cvvColumnLabel",existingPaymentForm:"form.checkout-page-form",netBankingSelect:"#net-banking-select-list",
morePaymentMethodsSelect:"#more-payment-methods-select-list",newVDC:"#new-vdc",newEMI:"#newEmiCard",orderSummaryBottom:"#order-summary-bottom",pageContainer:"div.a-container",paymentRows:"#existing-payment-methods .payment-row",rewardsRegister:"#rewards-register",addressChallengeCardList:".address-challenge-card",hiddenFormFields:"#hiddenFormFields",jppoints:"#jppoints",gcpromo:"#gcPromo",disableSubmitButtons:"#disableSubmitButtons",hideInputBoxes:"#hideInputBoxes",showAmexWarning:"#showAmexWarning",
existingPincodeNum:"#existingPincodeNum",mcbBalanceWarning:"#mcbBalanceWarning",installmentsOnlyCards:".installments-only-card",ovdWidgetSection:"#ovdWidgetSection"};a.on("checkout:reload:payselect",Ma);a.on("checkout:reload:spp-payment",Ma);return{getSelectedPayment:A}});"use strict";q.when("A","page-detector").register("wechat-detector",function(a,m){var n=a.$,e=function(a){a&&!1!==a.isWeChatInstalled&&(a=n("#wechat_payment"),a.length&&a.show())},g=function(a){},l="MShopWeChatPayment";a.on("checkout:reload:payselect",
function(){n("#wechat_payment").length&&(n("#mShopWeChatApiName").length&&(l=n("#mShopWeChatApiName").val()),q.when("safe-mash").execute(function(a){r.cordova.require("cordova/exec")(e,g,l,"isWeChatInstalled",[])}))})});"use strict";q.when("A","page-main","client-side-metrics","ready").register("otp-for-cod",function(a,m,n){function e(){w=u("#cashOnDeliveryCash");if(w.length&&(x=w.find(I.verifyOTP),z=w.find(I.sendOTP),M=x.length&&z.length,S=u(I.payMobile).length?1:0,M&&(f=w.find(I.submitSendOTP),
t=w.find(I.submitVerifyOTP),q=w.find(I.submitResendOTP),v=w.find(I.changeOTPNumber),C=w.find(I.OTPPhoneNumber),A=w.find(I.otpCode),f.length&&t.length&&q.length&&v.length))){P=w.find(I.addURLHash).length;n.increaseCount(U.metricPrefix+U.block,1,1);f.click(function(){r();n.increaseCount(U.metricPrefix+U.send,1,1)});t.click(function(){G=C.val();X=A.val();p();var a=l(G),b;b=/^\d{6}$/;b=X&&b.test(X);a&&b&&""!==L?c("VerifyOTP",L):b?a||w.find(I.otpServiceFailed).removeClass(I.aokHidden):w.find(I.invalidOTPError).removeClass(I.aokHidden);
n.increaseCount(U.metricPrefix+U.verify,1,1)});if(P&&location.hash&&location.hash.length){for(var a=location.hash,a=a.replace("#",""),a=a.split(";"),d=0;d<a.length;d++)0<=a[d].indexOf(T.codehandle)&&(L=a[d].replace(T.codehandle,"")),0<=a[d].indexOf(T.contactid)&&(V=a[d].replace(T.contactid,"")),0<=a[d].indexOf(T.phonenumber)&&(G=a[d].replace(T.phonenumber,""),C.val(G));""!==L&&""!==V&&""!==G&&b()}q.click(function(){n.increaseCount(U.metricPrefix+U.resend,1,1);r()});v.click(function(){x.addClass(I.aokHidden);
z.removeClass(I.aokHidden);g(q,!1);g(t,!1);p();n.increaseCount(U.metricPrefix+U.changeNumber,1,1)})}}function g(a,b){b?a.addClass(I.aButtonDisabled):a.removeClass(I.aButtonDisabled);S?a.find("button").prop("disabled",b):a.find("input").prop("disabled",b)}function l(a){var b=/^\d{10}$/;return a&&b.test(a)}function h(){w.find(I.otpServiceFailed).removeClass(I.aokHidden)}function b(){var a=w.find(I.verifyOTPPhoneNumber);w.find(I.invalidPhoneNumber).addClass(I.aokHidden);z.hasClass(I.aokHidden)?w.find(I.otpResentSuccess).removeClass(I.aokHidden):
S&&w.find(I.otpSentSuccess).removeClass(I.aokHidden);z.addClass(I.aokHidden);x.removeClass(I.aokHidden);var b=G.substr(0,2)+"*****"+G.substr(7,9);a.text(b);g(q,!1)}function d(a){if(a!==H&&"object"!==typeof a)try{a=u.parseJSON(a)}catch(b){a={}}a=a||{};var c,d=P&&location.hash?location.hash:"#";P&&location.hash&&";"!==d.slice(-1)&&(d+=";");c=a.status;a.codeHandle&&null!==a.codeHandle&&(L=a.codeHandle,P&&"SEND-SUCCESS"===c&&(d=k(d,T.codehandle,L)));a.contactId&&null!==a.contactId&&(V=a.contactId,P&&
"SEND-SUCCESS"===c&&(d=k(d,T.contactid,V),d=k(d,T.phonenumber,G)));P&&(location.hash=d);w.find(I.otpAlertClass).addClass(I.aokHidden);if(W[c])W[c]();else W.DEFAULT()}function k(a,b,c){var d=a.indexOf(b);if(0<=d){var e=a.indexOf(";",d),e=0<=e?e:a.length;a=a.substring(0,d)+a.substring(e+1,a.length+1)}return a+b+c+";"}function c(b,c){a.ajax("/gp/buy/payselect/handlers/otpAjaxHandler.html",{method:"get",params:{phoneNumber:G,method:b,codeHandle:c,contactId:V,otp:X},success:d,error:function(){d({status:"SERVICE-FAILED"})}})}
function p(){A.val("");w.find(I.otpAlertClass).addClass(I.aokHidden)}function r(){p();G=C.val();l(G)?c("SendOTP",L):w.find(I.invalidPhoneNumber).removeClass(I.aokHidden)}var u=a.$,w,x,z,f,t,q,v,C,A,M,S,P,G="",L="",V="",X="",I={aokHidden:"aok-hidden",aRadio:".a-radio",aButtonHidden:"a-button-hidden",aButtonDisabled:"a-button-disabled",payMobile:".pay-mobile",invalidOTPError:".invalidOTPError",verifyOTP:"#verifyOTP",sendOTP:"#sendOTP",submitSendOTP:"#submitSendOTP",submitVerifyOTP:"#submitVerifyOTP",
submitResendOTP:"#submitResendOTP",changeOTPNumber:"#changeOTPNumber",OTPPhoneNumber:"#OTPPhoneNumber",otpCode:"#otpCode",cashOnDeliveryCash:"#cashOnDeliveryCash",invalidPhoneNumber:".invalidPhoneNumber",otpServiceFailed:".otpServiceFailed",enterOTPLabel:"#enterOTPLabel",reEnterOTPLabel:"#reEnterOTPLabel",maxOTPError:".maxOTPError",numberAlreadyUsed:".numberAlreadyUsed",verifiedOTPSuccess:".verifiedOTPSuccess",verifyOTPPhoneNumber:"#verifyOTPPhoneNumber",otpResentSuccess:".otpResentSuccess",otpSentSuccess:".otpSentSuccess",
otpAlertClass:".otpAlertClass",phonenumberNotVerified:"phonenumberNotVerified",addURLHash:".addURLHash"},T={codehandle:"codehandle:",contactid:"contactid:",phonenumber:"phonenumber:"},U={metricPrefix:"PayPage-COD-OTP-",block:"Block",send:"Send",verify:"Verify",resend:"ReSend",changeNumber:"ChangeNumber"},W={"SERVICE-FAILED":h,"SEND-SUCCESS":b,"VERIFY-SUCCESS":function(){z.addClass(I.aokHidden);x.addClass(I.aokHidden);w.find(I.verifiedOTPSuccess).removeClass(I.aokHidden);w.find("."+I.phonenumberNotVerified).removeClass(I.phonenumberNotVerified);
S&&m.setContinueButtonStatus(!0)},"INVALID-NUMBER":function(){w.find(I.invalidPhoneNumber).removeClass(I.aokHidden)},"NUMBER-ALREADY-USED":function(){g(q,!0);g(t,!0);w.find(I.numberAlreadyUsed).removeClass(I.aokHidden)},"MAX-OTP-REACHED":function(){w.find(I.maxOTPError).removeClass(I.aokHidden);g(q,!0)},"INVALID-OTP":function(){w.find(I.invalidOTPError).removeClass(I.aokHidden);A.val("");S?A.attr("placeholder","Re-enter OTP"):(w.find(I.enterOTPLabel).addClass(I.aokHidden),w.find(I.reEnterOTPLabel).removeClass(I.aokHidden))},
DEFAULT:h};a.on("checkout:reload:payselect",e);a.on("checkout:reload:spp-payment",e)});"use strict";q.when("A","pay-common-util","ready").execute(function(a,m){var n={productGls:"#productGls",gcTypes:"#gcDeliveryTypes",device:"#device"},e=m.getElements(n);a.on("checkout:payment:challenge:log",function(g){var l={},h;for(h in n)n.hasOwnProperty(h)&&e[h]&&e[h].val()&&(l[h]=e[h].val());g&&(l.paymentInstrumentId=g);Object.keys&&Object.keys(l).length&&a.ajax("/gp/buy/payselect/handlers/log-payment-challenge.html?ref_\x3dcheckout-payment-challenge",
{method:"POST",params:l,timeout:1E3,cache:!1})})});"use strict";q.when("A","page-spinner-controller","page-main","page-transition-controller","page-conductor","client-side-metrics","button-blocker","ready").register("pay-auth",function(a,m,n,e,g,l,h){function b(){var a=p("#otp_id").val(),b=/^\d{6}$/;a&&b.test(a)?h.hide("pay-auth-otp-checks"):(a=p("#otp_invalid_msg").val(),h.show("pay-auth-otp-checks",a))}function d(b,c){m.show();a.ajax("validate-otp.html",{method:"post",params:{otp_name:b,paystationRequestId:c},
success:function(a){!a||"APPROVED"!==a.status&&"PENDING"!==a.status?(p("#otp_id").addClass("a-form-error"),p("#otpBadCode").removeClass("hidden"),m.hide()):(p("#isFormValidated").val("1"),u.submit())},error:function(a){m.hide()}})}function k(){p("#otp_id").removeClass("a-form-error");p("#otpBadCode").addClass("hidden")}function c(){l.increaseCount(w.metricPrefix+w.resend,1,1);var b="1"===p("#isPaystationFlow").val(),c;b?(c="resend-otp.html?returnHtml\x3d0\x26isPaystationFlow\x3d1",m.show()):c="resend-otp.html?returnHtml\x3d0";
a.ajax(c,{method:"get",success:function(a){b&&(a&&1===a.successful&&(p("#authSourceId").val(a.authSourceId),p("#paystationRequestId").val(a.paystationRequestId)),m.hide())},error:function(a){b&&m.hide()}})}var p=a.$,r,u,w={metricPrefix:"Payauth-",resend:"Resend"};a.on("checkout:reload:payauth",function(){r=p("#resend_form");u=p("#otp_form");u.submit(function(a){var b=p(a.currentTarget);if("1"===b.find('input[id\x3d"isPaystationFlow"]').val()&&(k(),"1"!==b.find('input[id\x3d"isFormValidated"]').val()))return a=
b.find('input[id\x3d"otp_id"]').val(),b=b.find('input[id\x3d"paystationRequestId"]').val(),d(a,b),!1});r.submit(function(a){"1"===p("#isPaystationFlow").val()&&k();c();return!1});b();p("#otp_id").unbind("keyup").bind("keyup",b)})});"use strict";q.when("A","ajax-utility","client-side-metrics","loading-spinner-controller","pay-common-lib","pay-common-util","page-conductor","page-transition-controller","quantity-service","weblab-helper").register("pay-gil",function(a,m,n,e,g,l,h,b,d,k){function c(a){C=
a.popover;var b=f(C);q("#gil-estimates-popover-"+b+" .gil-popover-content").html("");q("#gil-estimates-popover-"+b+" .gil-popover-error").html("");a.popover.updatePosition(!0)}function p(a){C=a.popover;var b=f(C),c=q("#gil-estimates-popover-"+b);c.find("input[name\x3dgil-subtype]").val(b);e.showSpinner(c,!1,C);a="/gp/buy/payselect/handlers/get-gil-popover-content.html?cachebuster\x3d"+(new Date).getTime();var d="hasWorkingJavascript\x3d1\x26subtype\x3d"+encodeURIComponent(b);q.ajax({type:"POST",url:a,
data:d,dataType:"text",async:!0,cache:!1,dataFilter:function(a){return m.jsonify(a)},success:function(a,d,g){f(C)===b&&(n.increaseCount("Checkout:GIL:"+b+":IneligiblePopoverSuccess",1),d=C,e.hideSpinner(c),a&&a.errors&&0<a.errors.length?c.find(".gil-popover-error").show():a&&a.widgetHTML?c.find(".gil-popover-content").html(decodeURIComponent(a.widgetHTML)):c.find(".gil-popover-error").show(),d.updatePosition(!0))},error:function(a){f(C)===b&&(n.increaseCount("Checkout:GIL:"+b+":IneligiblePopoverError",
1),a=C,e.hideSpinner(c),c.find(".gil-popover-error").show(),a.updatePosition(!0))}})}function r(a){a.$event.preventDefault();a.$target.closest(".a-popover").find(".a-button-close").trigger("click")}function u(a){a.$event.preventDefault();var c=f(C),g=q("#gil-estimates-popover-"+c);e.showSpinner(g,!1,C);var l=w(a.$currentTarget.parents("#gil-estimates-popover-"+c));e.showSpinner(g,!1,C);d.callBatch(l,{success:function(d,e,g){f(C)===c&&(n.increaseCount("Checkout:GIL:"+c+":SubmitIneligiblePopoverSuccess",
1),r(a),b.show(),1==parseInt(q("input[name\x3d'gil-rendered-using-apx']").val(),10)&&k.isGILCreditCardEnabled()?(d=q(".pmts-select-payment-instrument-form"),e=C,"APX_PSP_TO_RCX_SPC"==(e.attrs?e.attrs("data").onSubmit:e.data.onSubmit)&&d&&0<d.length?h.continueClicked(null,d):n.increaseCount("Checkout:GIL:"+c+"Popover:ErrorRedirectingToSPC",1)):z(c))},error:function(a){f(C)===c&&(n.increaseCount("Checkout:GIL:"+c+":SubmitIneligiblePopoverError",1),a=C,e.hideSpinner(g),g.find(".gil-popover-error").show(),
a.updatePosition(!0))},isTrial:0})}function w(a){var b={};a.find(".gil-ineligible-items").children(".gil-ineligible-item").each(function(a,c){a=q(c).find('input[name^\x3d"ineligible-item"]').val();b[a]=0});return b}function x(a){a.$event.preventDefault();var b=q("#gil-ineligible-"+a.data.subtype).find(".gil-ineligible-items"),c=b.data("index"),d=b.data("size"),c=(c+("next"===a.data.direction?1:-1)+d)%d,d=(c+1)%d;b.find(".gil-ineligible-item").addClass("aok-hidden").removeClass("a-span-last");a=b.find("#gil-ineligible-item-"+
c);d=b.find("#gil-ineligible-item-"+d);a.removeClass("aok-hidden");d.addClass("a-span-last").removeClass("aok-hidden");b.data("index",c)}function z(b){l.makeAjaxCall("/gp/buy/payselect/handlers/submit.html",{handler:"new-gil-payment",subtype:b},{successHandler:function(c,d,e){n.increaseCount("Checkout:GIL:"+b+":NewToExistingSuccess",1);h.ajaxUpdatePage(c,d,e);l.scrollTopTo(q("#existing-payment-methods [value\x3d"+b+"]"));if(h.isSPP())a.on("checkout:afterReload",function L(){q("#existing-gil input[value\x3d"+
b+"]").trigger("click");a.off("checkout:afterReload",L)});else q("#existing-gil input[value\x3d"+b+"]").trigger("click")},errorHandler:function(a,c,d){n.increaseCount("Checkout:GIL:"+b+":NewToExistingError",1);h.ajaxUpdatePage(a,c,d)}})}function f(a){return a.attrs?a.attrs("data").subtype:a.data.subtype}function t(){v&&(a.declarative("gil-close-popover",["click"],r),a.declarative("gil-submit-popover",["click"],u),a.declarative("gil-ineligible-pagination",["click"],x));q("#gil-cc-payment-type").length&&
(a.off("a:popover:beforeShow:gil-estimates",c),a.off("a:popover:show:gil-estimates",p),a.on("a:popover:beforeShow:gil-estimates",c),a.on("a:popover:show:gil-estimates",p));q("#gil-payment-type").length&&(a.off("a:popover:beforeShow:gil-si-estimates",c),a.off("a:popover:show:gil-si-estimates",p),a.on("a:popover:beforeShow:gil-si-estimates",c),a.on("a:popover:show:gil-si-estimates",p));v=!1}var q=a.$,v=!0,C;a.on("checkout:reload:payselect",t);a.on("checkout:reload:spp-payment",t);return{submitNewGilPayment:z,
displayGILEstimatesMobile:function(a,b,c){var d="/gp/buy/payselect/handlers/get-gil-popover-content.html?cachebuster\x3d"+(new Date).getTime(),e="hasWorkingJavascript\x3d1\x26subtype\x3d"+encodeURIComponent(a);l.makeAjaxCall(d,e,{successHandler:function(c,d,e){var f=m.jsonify(c);f&&!f.errors&&f.widgetHTML?n.increaseCount("Checkout:GIL:"+a+":Mobile:IneligibleSubPageSuccess",1):n.increaseCount("Checkout:GIL:"+a+":Mobile:IneligibleSubPageError",1);b(c,d,e)},errorHandler:function(b){n.increaseCount("Checkout:GIL:"+
a+":Mobile:IneligibleSubPageError",1);c(b)}})},actionCloseGilMobileSubpage:function(a){a.$event.preventDefault();q("#gil-estimates-subpage").remove();q(l.pages.main.pageId).show()},actionSubmitGilMobileSubpage:function(a,b,c){a.$event.preventDefault();q("#gil-ineligible-view");var e=w(a.$currentTarget.parents("#gil-ineligible-view"));d.callBatch(e,{success:function(c,d,e){n.increaseCount("Checkout:GIL:"+a.data.subtype+":Mobile:SubmitIneligibleSubPageSuccess",1);b(c,d,e)},error:function(b){n.increaseCount("Checkout:GIL:"+
a.data.subtype+":Mobile:SubmitIneligibleSubPageError",1);c(b)},isTrial:0})}}});"use strict";q.when("A","ready").register("new-verified-debit-card",function(a){});"use strict";q.when("A").register("apb-limit-messaging-helper",function(a){return{}});"use strict";q.when("A","page-conductor","page-transition-controller","quantity-service").register("rentals-ineligible-util",function(a,m,n,e){function g(a){var d={};a.find(".rentals-ineligible-item").each(function(a,b){a=h(b).find('input[name^\x3d"ineligible-item"]').val();
d[a]=0});return d}function l(){var a=h(".pmts-select-payment-instrument-form");a.attr("data-pmts-ajax-continuation","false");a.submit();n.show()}var h=a.$;return{actionSubmitRentalsIneligibleItemsInSfl:function(a,d,k,c,h){k=g(k);e.callBatch(k,{success:function(){c(a,d);l()},error:function(){h(d)},isTrial:0,ref:"chk_pay_rental_sfl"})},continueWithPaymentMethod:l,toggleButton:function(a,d){d?a.removeClass("a-button-disabled").removeAttr("disabled"):a.addClass("a-button-disabled").attr("disabled","disabled")}}});
"use strict";q.when("A","ajax-utility","client-side-metrics","loading-spinner-controller","pay-common-lib","pay-common-util","rentals-ineligible-util","a-modal").register("rentals-ineligible",function(a,m,n,e,g,l,h,b){function d(a){"undefined"!==typeof b?(v=b.get(a.popover.name),v.update({content:"\x3cdiv id\x3d'rentals-ineligible-popover-loading'\x3e\x3c/div\x3e",height:400,width:600,padding:"none",footer:null})):(v=a.popover,C=a.popover.$popover,v.update("\x3cdiv id\x3d'rentals-ineligible-popover-loading'\x3e\x3c/div\x3e"),
C.find(".a-popover-inner").css("padding","0"),C.find(".a-popover-footer").html(""),C.find(".a-popover-footer").css("width",600),v.updatePosition(!0));k()}function k(){var a=f("#rentals-ineligible-popover-loading");e.showSpinner(a,!1,v);f.ajax({type:"POST",url:"/gp/buy/payselect/handlers/get-rentals-ineligible-content.html?ref_\x3dchk_pay_rentals_ineligible",data:"hasWorkingJavascript\x3d1",dataType:"text",async:!0,cache:!1,dataFilter:m.jsonify,success:function(d,g,k){e.hideSpinner(a);d&&d.widgetHTML?
(n.increaseCount("Checkout:Rentals:RenderIneligiblePopoverDesktopSuccess",1),d=f(l.decodeJSONResponse(d.widgetHTML)),d.find("#no-ineligible-items").length?(v.$popover.find(".a-button-close").trigger("click"),h.continueWithPaymentMethod()):(k=d.find("#rentals-ineligible-popover-footer"),g=k.removeClass("aok-hidden"),k.remove(),q&&(h.toggleButton(g.find("#rentals-ineligible-submit"),!1),h.toggleButton(g.find("#rentals-ineligible-cancel"),!1)),"undefined"!==typeof b?(k=d.find(".rentals-ineligible-item").length,
v.update({content:d.html(),height:2<k?400:0,footer:g.html()}),x()):(v.update(d.html()),C.find(".a-popover-inner").css("padding","0"),C.find(".a-popover-footer").html(g.html()),C.find(".a-popover-footer").css("width",600),v.updatePosition(!0)))):c(a)},error:function(b){c(a)}})}function c(a){n.increaseCount("Checkout:Rentals:RenderIneligiblePopoverDesktopError",1);e.hideSpinner(a);a=f("#rentals-ineligible-content-unavailable-error");"undefined"!==typeof b?v.update({content:a.val(),padding:null,footer:null}):
(v.update(a.val()),C.find(".a-popover-inner").css("padding","100px"),C.find(".a-popover-footer").html(""),C.find(".a-popover-footer").css("width",600),v.updatePosition(!0))}function p(a){a.$event.preventDefault();q=!0;h.toggleButton(f("#rentals-ineligible-submit"),!1);h.toggleButton(f("#rentals-ineligible-cancel"),!1);var b=f("#rentals-ineligible-popover-container");e.showSpinner(b,!1,v);var c=f(".rentals-ineligible");h.actionSubmitRentalsIneligibleItemsInSfl(a,b,c,r,u)}function r(a,b){n.increaseCount("Checkout:Rentals:SubmitIneligibleItemsInSflDesktopSuccess",
1);q=!1;e.hideSpinner(b);w(a)}function u(a){n.increaseCount("Checkout:Rentals:SubmitIneligibleItemsInSflDesktopError",1);q=!1;h.toggleButton(f("#rentals-ineligible-submit"),!0);h.toggleButton(f("#rentals-ineligible-cancel"),!0);f("#rentals-ineligible-sfl-error").removeClass("aok-hidden");e.hideSpinner(a);"undefined"!==typeof b&&x()}function w(a){a.$event.preventDefault();"undefined"!==typeof b?v.hide():v.$popover.find(".a-button-close").trigger("click")}function x(){var a=v.$popover.find(".a-popover-inner").outerHeight(!0),
b=f("#rentals-ineligible-popover-fixed-content").outerHeight(!0);f("#rentals-ineligible-popover-items-container").css("height",a-b)}function z(){t&&(a.declarative("rentals-ineligible-cancel",["click"],w),a.declarative("rentals-ineligible-submit",["click"],p),a.on("a:popover:show:rentals-ineligible-popover",d));t=!1}var f=a.$,t=!0,q=!1,v,C;a.on("checkout:reload:payselect",z);a.on("checkout:reload:spp-payment",z);return{displayRentalsIneligible:function(){f("#rentals-ineligible-popover-trigger").trigger("click")}}});
"use strict";q.when("A").register("payment-marketplace-helper",function(a){return{}});"use strict";q.when("A","cvf","page-detector","weblab-helper","ready").register("cvf-old-amazon-aui-fixes",function(a,m,n,e){function g(){a.$(".cvf-widget-form .a-button-dropdown .a-button-text").css("text-overflow","unset")}function l(){var a=p(this).parent(),b=a.find(".a-native-dropdown option")[0];if(b&&b.hasAttribute("data-a-html-content")){var c=[];a.find(".cvf-widget-input.a-native-dropdown option").each(function(){c.push({phone_country_code:p(this).data("a-html-content"),
country_iso:p(this).val()})});var d=setInterval(function(){if(p(".a-popover-inner ul").length){var a="rtl"===p("html").attr("dir");p(".a-popover-inner ul").addClass("a-cvf-list-link");p.each(c,function(b,c){if(b=c.phone_country_code){if(a){b=b.split("+");var d=b[1];b=b[0].trim()+" "+d+"+"}p(".a-popover-inner [data-value\x3d'"+c.country_iso+"']").html(b)}});clearInterval(d)}},0)}p(".cvf-widget-form .a-button-dropdown").die("click")}function h(){var a=p(this).data("value");p(".cvf-widget-form .a-native-dropdown.cvf-widget-input").val(a).change()}
function b(){var a=p(this).parent().find(".a-dropdown-prompt"),b=p(this).find("option:selected").html().trim(),c=setTimeout(function(){a.html(b);clearTimeout(c)},0)}function d(){a.$(".cvf-widget-form .a-alert-inline.cvf-hidden").remove()}function k(){0===p(".cvf-widget-form").length&&(p("#apx-content .a-alert-info").first().remove(),p("[data-testid\x3d'pmts-cod-cash-description']").closest(".pmts-portal-component").find(".a-radio input").trigger("click"))}function c(){if(!q)if(u)a.on("a:pageUpdate a:ajax:complete",
d);else a.on("a:pageUpdate a:ajax:complete",g),p(".cvf-widget-form .a-button-dropdown").live("click",l),p(".a-cvf-list-link a").live("click",h),p(".cvf-widget-input.a-native-dropdown").live("change",b);a.on("cvf:verification:complete",k)}var p=a.$,q=n.isMobile(),u=r.P&&r.P.AUI_BUILD_DATE;e.isCvfOldAmazonUiFixesEnabled()&&(a.on("checkout:reload:payselect",c),a.on("checkout:reload:spp-payment",c))});"use strict";q.when("A","page-detector").register("alipay-detector",function(a,m){var n=a.$,e=function(){var a=
n("input[name\x3d'isAlipayAppPayment']");0<a.length&&m.isMobileSpc&&a.val("1")},g=function(a){},l=function(){var a=n("input[name\x3d'isAlipayRedirect']");0<a.length&&m.isMobileSpc&&a.val("1")},h=function(a){};a.on("checkout:reload:spc",function(){n("input[name\x3d'isAlipayAppPayment']").length&&q.when("safe-mash").execute(function(a){a=r.cordova.require("cordova/exec");a(e,g,"AlipayPlugin","isAlipayInstalled",[]);n("input[name\x3d'isAlipayRedirect']").length&&a(l,h,"AlipayPlugin","isAlipayFailReturnSupported",
[])})})});"use strict";q.when("A","page-transition-controller","page-detector").execute(function(a,m,n){function e(){var a=g("#backButtonProtection");a.length&&"1"===a.val()&&(m.showPageTransition(),document.location.reload())}var g=a.$;q.register("back-button-protection",function(){return{markAsDirty:function(){g("#backButtonProtection").val(1)}}});a.on("checkout:reload:spc",e);a.on("checkout:reload:spp-revieworder",e)});"use strict";q.when("A","page-transition-controller","loading-spinner-controller",
"ajax-utility","page-conductor","checkout-general-utils","page-detector","client-side-metrics","delivery-preferences-csm-helper").register("delivery-preferences-controller",function(a,m,n,e,g,l,h,b,d){function k(){h.isTabletSpc()&&(t=f("#spc-orders .delivery-preferences-options"),x(),t.find("select").trigger("change"),u())}function c(){var a=t.find("input[name\x3dpreference]:checked").val(),b=t.find("select[name\x3dSafePlaceLocation]");"NeighborDelivery"===a?(t.find("input[name\x3dneighbor-name]").removeAttr("disabled").removeClass("a-form-disabled"),
t.find("input[name\x3dneighbor-house]").removeAttr("disabled").removeClass("a-form-disabled"),g.isSPP()?q.when("a-dropdown").execute(function(a){a.getSelect(b).update({status:"disabled"})}):b.attr("disabled","disabled").closest(".a-button").addClass("a-button-disabled"),t.find(".safe-place-error").hide()):"SafePlaceDelivery"===a?(g.isSPP()?q.when("a-dropdown").execute(function(a){a.getSelect(b).update({status:"enabled"})}):b.removeAttr("disabled").closest(".a-button").removeClass("a-button-disabled"),
t.find("input[name\x3dneighbor-name]").attr("disabled","disabled").addClass("a-form-disabled"),t.find("input[name\x3dneighbor-house]").attr("disabled","disabled").addClass("a-form-disabled"),t.find(".neighbor-name-error").hide(),t.find(".neighbor-house-error").hide()):(t.find("input[name\x3dneighbor-name]").attr("disabled","disabled").addClass("a-form-disabled"),t.find("input[name\x3dneighbor-house]").attr("disabled","disabled").addClass("a-form-disabled"),g.isSPP()?q.when("a-dropdown").execute(function(a){a.getSelect(b).update({status:"disabled"})}):
b.attr("disabled","disabled").closest(".a-button").addClass("a-button-disabled"),t.find(".neighbor-name-error").hide(),t.find(".neighbor-house-error").hide(),t.find(".safe-place-error").hide());p(!0)}function p(a){var b=t.find("input[name\x3dpreference]:checked").val();t.find(".safe-place-error").hide();t.find(".neighbor-name-error").hide();t.find(".neighbor-house-error").hide();t.find("input").removeClass("a-form-error");t.find("div.a-input-text-wrapper").removeClass("a-form-error");t.find("select").closest(".a-button").removeClass("a-button-error");
0<f("div.spc-tablet").length?t.find(".set-delivery-preferences-button").removeClass("a-button-disabled"):t.find(".set-delivery-preferences-button").show();t.find(".save-disabled").hide();t.find(".current-blocker-content").text("");var c=!1;if("NeighborDelivery"===b){var d=t.find("input[name\x3dneighbor-name]");d.data("defaultValueRemoved")&&d.val()||(t.find(".neighbor-name-error").show(),d.addClass("a-form-error"),d.closest(".a-input-text-wrapper").addClass("a-form-error"),t.find(".current-blocker-content").html(t.find(".neighbor-name-error-text").text()),
c=!0);d=t.find("input[name\x3dneighbor-house]");d.data("defaultValueRemoved")&&d.val()||(t.find(".neighbor-house-error").show(),d.addClass("a-form-error"),d.closest(".a-input-text-wrapper").addClass("a-form-error"),t.find(".current-blocker-content").html(t.find(".neighbor-house-error-text").text()),c=!0)}else"SafePlaceDelivery"===b&&(d=t.find("select[name\x3dSafePlaceLocation]"),d.val()||(t.find(".safe-place-error").show(),d.closest(".a-button").addClass("a-button-error"),t.find(".current-blocker-content").html(t.find(".safe-place-error-text").text()),
c=!0));d=f("#disableSaveBtnWhenNoDeliveryPrefSelected").val();if(a&&c||"true"===d&&b===H)0<f("div.spc-tablet").length?t.find(".set-delivery-preferences-button").addClass("a-button-disabled"):t.find(".set-delivery-preferences-button").hide(),t.find(".save-disabled").show();return!c}function r(a){a&&a.$event&&a.$event.preventDefault();a="hasWorkingJavascript\x3d1\x26returnFullHTML\x3d1\x26cachebuster\x3d"+(new Date).getTime()+"\x26";var c="",k=t.find(".popover-deliv-prefs-content");k.data("obfuscatedEntityId")?
c=k.data("obfuscatedEntityId"):t.data("obfuscatedEntityId")&&(c=t.data("obfuscatedEntityId"));a+="obfuscatedEntityId\x3d"+c+"\x26";c=t.find("input[name\x3dpreference]:checked").val();""!==c&&(a+="prefDelLocation\x3d"+c+"\x26","NeighborDelivery"===c?(a+="neighborName\x3d"+encodeURIComponent(t.find("input[name\x3dneighbor-name]").val())+"\x26",a+="houseNo\x3d"+encodeURIComponent(t.find("input[name\x3dneighbor-house]").val())+"\x26"):"SafePlaceDelivery"===c&&(a+="safePlaceLocation\x3d"+t.find("select[name\x3dSafePlaceLocation]").val()+
"\x26"),c=t.find("input[name\x3ddefaultPreference]:checked").val(),c!==H&&""!==c&&(a+="isDefaultPreference\x3d1"));0<f("div.spc-tablet").length?m.show():n.showSpinner(t.find(".popover-deliv-prefs-content"),!1,J);d.recordCSMWithCurrentFieldValues("popover-submitted","preference","defaultPreference");f.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/update-delivery-preference.html",data:a,dataType:"text",contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc",
"x-amz-checkout-transition":"ajax"},success:function(a,c,d){v=!0;0<f("div.spc-tablet").length?m.hide():n.hideSpinner(t.find(".popover-deliv-prefs-content"));d.getResponseHeader("x-amz-checkout-page")?(t.find(".a-button-close").trigger("click"),g.ajaxUpdatePage(a,c,d)):(a=e.jsonify(a),g.redirect(a));b.increaseCount("checkoutSpcDeliveryPref-save",1)},error:function(a,b,c){0<f("div.spc-tablet").length?m.hide():n.hideSpinner(t.find(".popover-deliv-prefs-content"));p(!0)}})}function u(){t.find("input[name\x3d'neighbor-name'], input[name\x3d'neighbor-house']").unbind("focus").bind("focus",
function(){if(!f(this).data("defaultValueRemoved")){if(h.isMobileSpc()||h.isDesktopSpc())f(this).val(""),f(this).css("color","black");f(this).data("defaultValueRemoved",!0)}}).each(function(){(h.isMobileSpc()||h.isDesktopSpc())&&f(this).data("defaultValueRemoved")&&f(this).css("color","black")});t.find("input:radio[name\x3dpreference]").unbind("click").bind("click",c);t.find("input[name^\x3dneighbor]").unbind("keyup").bind("keyup",function(){p(!1)});0<f("div.spc-tablet").length?t.find("select[name\x3dSafePlaceLocation]").unbind("change").bind("change",
w):t.find("select[name\x3dSafePlaceLocation]").unbind("change").bind("change",function(){p(!1)})}function w(a){p(!0)&&r(a)}function x(a){var b=f("#spc-orders .delivery-preferences-options"),c,d="";a?(c=a.$currentTarget.find("input"),d=b.find("input[name\x3dpreference]:checked").val()):c=b.find("input[name\x3dpreference]:checked");b=c.val();if(d!==b){t.find(".expand-content").hide();var d=c,e=d.closest(".delivery-preferences-options");e.find("i.a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");
e.find("input").attr("checked",!1);d.siblings("i").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive");d.attr("checked",!0);"NeighborDelivery"===b||"SafePlaceDelivery"===b?c.closest(".deliverypreference-option").siblings(".expand-content").show():a&&r(a)}}function z(a){(a=t.find("#delivery-preferences-set-default-checkbox"))&&1===a.length&&(a.prop("checked")?b.increaseCount("checkoutSpcDeliveryPref-setAsDefault",1):b.increaseCount("checkoutSpcDeliveryPref-setAsTemporary",
1))}var f=a.$;if(!f("html").hasClass("a-ie6")){var t,J,v;a.on("a:popover:beforeShow",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("button-blocker-delivprefs")&&(a.popover.$popover.find(".a-popover-inner").html(t.find(".current-blocker-content").text()),a.popover.updatePosition())});a.on("a:popover:show",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("deliv-prefs")&&(b.increaseCount("checkoutSpcDeliveryPref-open",1),J=a.popover,t=J.$popover,v=!1,u(),d.recordCSMWithCurrentFieldValues("popover-displayed",
"preference","defaultPreference"),c(),t.find("select").trigger("change"))});a.on("a:popover:dismiss",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("deliv-prefs")&&(v||b.increaseCount("checkoutSpcDeliveryPref-dismissed",1))});a.on("a:popover:hide",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("deliv-prefs")&&(v||d.recordCSM("popover-dismissed"))});a.declarative("delivery-preferences-switch-tablet",["click"],function(a){x(a)});a.declarative("delivery-preferences-expander-toggle",
["click"],function(a){l.toggleExpanderContent(a)});a.declarative("set-delivery-preferences",["click","touchend"],function(a){a.$event.preventDefault();l.protectAgainstDoubleAction("set-delivery-preferences")||p(!0)&&r()});a.declarative("delivery-preferences-set-default-checkbox-triggered","change",z);a.on("checkout:reload:spc",k)}});"use strict";q.when("A","page-detector","time-left-formatter","weblab-helper").register("fast-track-controller",function(a,m,n,e){function g(){for(var b in u)u[b]&&clearInterval(u[b]);
a.defer(l)}function l(){p.DAY=c("#fasttrack-day").html();p.DAYS=c("#fasttrack-days").html();p.HOUR=c("#fasttrack-hour").html();p.HOURS=c("#fasttrack-hours").html();p.AND=c("#fasttrack-and").html();p.MINUTE=c("#fasttrack-minute").html();p.MINUTES=c("#fasttrack-minutes").html();p.SECOND=c("#fasttrack-second").html();p.SECONDS=c("#fasttrack-seconds").html();(c("#isfresh").length&&c(".checkout.spc-mobile").length||c("#lazy-fresh-promise-delivery-message").length?c("#spc-form"):c("#spc-orders")).find(".fasttrack-span").each(function(){var b=
c(this),d=b.find("input[name\x3d'countdownId']").val();r[d]=parseInt(b.find("input[name\x3d'fasttrackExpiration']").val());w[d]=a.now()/1E3+r[d];h(b.find("input[name\x3d'countdownThreshold']").val(),b,b.find("input[name\x3d'showSimplifiedCountdown']").val(),d);b.show()})}function h(a,c,e,g){0>=r[g]?d(c,null):a&&0<a&&r[g]>a?c.find("span.fasttrackavailable").hide():(b(c,e),u[g]=setInterval(function(){b(c,e,g)},1E3))}function b(b,e,f){0<r[f]?(r[f]=Math.round(w[f]-a.now()/1E3),e=n.getTimeLeftFormatted(r[f],
1===e||"1"===e?!0:!1,p),c("html").hasClass("a-tablet")?b.find("span[data-field\x3d'fasttrackcountdown']").html("\x26nbsp;"+e):b.find("span[data-field\x3d'fasttrackcountdown']").html(e),b.find("span.fasttrackexpired").hide(),b.find("span.fasttrackcountdown").show(),b.find("span.fasttrackavailable").show()):d(b,f)}function d(a,b){b?(u[b]&&clearInterval(u[b]),a.find("span.fasttrackavailable").hide(),a.find("span.fasttrackexpired").show()):clearInterval(u[b])}function k(){g()}var c=a.$;if(!c("html").hasClass("a-ie6")){var p=
{},r={},u={},w={};a.on("checkout:reload:spc",g);a.on("checkout:reload:spp-revieworder",g);return{spcLiteLazyLoadFastTrack:k}}});"use strict";q.when("A","page-transition-controller","ajax-utility","page-conductor","client-side-metrics").register("gc-redeem-controller",function(a,m,n,e,g){function l(a){if(!q){a.preventDefault();p(a.currentTarget);var b;0<p("#spc-gcpromoinput").length&&(b=encodeURIComponent(p("#spc-gcpromoinput").val()));0<p("#gc-promo-input").length&&(b=encodeURIComponent(p("#gc-promo-input").val()));
var c=encodeURIComponent(p("#spc-usePromoOnly").val());if(b&&0!==b.length){var f=encodeURIComponent(p("input[name\x3dpurchaseTotal]").val());p("#gc-error").hide();p("#gc-promo-success").hide();p("#gc-success").hide();p("#gc-ineligible").hide();p("#promo-success").hide();e.isSPP()?(m.blockAllActions(),m.showTransitionInContainer(p("#payment"))):m.show();var g=(new Date).getTime();a="/gp/buy/spc/handlers/add-giftcard-promotion.html/ref\x3dox_pay_page_gc_add";p(".checkout.spc.aui-templatized").length&&
(a="/gp/buy/spc/handlers/add-giftcard-promotion.html/ref\x3dox_spc_gc_add");b="purchaseTotal\x3d"+f+"\x26claimcode\x3d"+b+"\x26disablegc\x3d"+c+"\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26hasWorkingJavascript\x3d1\x26fromAnywhere\x3d"+p("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+g;c=e.setAjaxTransitionHeader({"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":"spc"});p.ajax({type:"POST",url:a,data:b,headers:c,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
dataType:"text",complete:function(){q=!1},success:h,error:e.ajaxRedirect});q=!0}else d("addGiftCardOrPromo_NoCode")}}function h(a,c,g){var f=g.getResponseHeader("x-amz-checkout-page");if(f){if(e.ajaxUpdatePage(a,c,g),"spc"===f||"spclite"===f||"spp-revieworder"===f)(a=parseInt(p("#checkoutDisplayPage").data("delaySetTitle"),10)||parseInt(p("#gc-promo-delay").data("egcDelayUpdateRedemptionMessage"),10)||0)?setTimeout(function(){b(g)},a):b(g)}else{a=n.jsonify(a);if(!a)return e.redirect();if(a.error)return d(a.error);
if(a.errors)return d(a.errors);if(a.autohandlererror)return k(a.autohandlererror);e.redirect(a)}}function b(a){var b=a.getResponseHeader("x-updated-promo-type");a=a.getResponseHeader("x-updated-gc-applied-but-ineligible");b&&(a||p("#gc-promo-success").show(),0<p("div.spc-desktop").length?(p("#spc-gcpromoinput").removeClass("a-form-error"),p("#gc-promo-input").removeClass("a-form-error")):(p("#spc-gcpromoinput").closest(".a-input-text-wrapper").removeClass("a-form-error"),p("#gc-promo-input").closest(".a-input-text-wrapper").removeClass("a-form-error")),
"giftcard"===b?(c("applied"),a?(p("#gc-ineligible").show(),c("gcIneligible")):p("#gc-success").show()):p("#promo-success").show())}function d(a){m.hide();p("#gc-error p").hide();p("#gc-error").show();c("error");0<p("div.spc-desktop").length?(p("#spc-gcpromoinput").addClass("a-form-error"),p("#gc-promo-input").addClass("a-form-error")):(p("#spc-gcpromoinput").closest(".a-input-text-wrapper").addClass("a-form-error"),p("#gc-promo-input").closest(".a-input-text-wrapper").addClass("a-form-error"));p(0<
p("#gc-promo-input").length?"."+u[a]:"#"+a).show()}function k(a){if(a){var b=a.action,c="/gp/buy/payselect/handlers/error.html?errorType\x3d"+encodeURIComponent(a.type?a.type:b&&b.code?b.code:"string"===typeof a?a:"Unknown:pipelineJSError");"fatal"===b?c+="\x26errorAction\x3dfatal":"redirect"===b&&(a.url?c=a.url:"cart"===a.page&&(c="/gp/cart/view.html"));r.location.href=c}else r.location.href="/gp/buy/payselect/handlers/error.html?errorType\x3dUnknown:pipelineJSError"}function c(b){var c=a.state("cxt-gc-redemption-method").method;
g.increaseCount("rcxGCRedeem:"+c+":"+b,1)}var p=a.$,q=!1;if(!p("html").hasClass("a-ie6")){a.state("cxt-gc-redemption-method",{method:"type"});var u={addGiftCardOrPromo_Unknown:"UNKNOWN",addGiftCardOrPromo_NoCode:"NO_CODE",addPromo_InvalidForPurchase:"PROMO_INVALID_FOR_PURCHASE",addPromo_BadCode:"PROMO_BAD_CODE",addPromo_ExpiredCode:"PROMO_EXPIRED_CODE",addPromo_InvalidForOrgUnit:"PROMO_INVALID_FOR_ORG_UNIT",addPromo_OfferNotYetBegun:"USED_BEFORE_START_DATE",addPromo_AlreadyRedeemed:"PROMO_ALREADY_REDEEMED",
addGiftCard_AlreadyRedeemedByAnotherAccount:"GC_ALREADY_REDEEMED_BY_ANOTHER_ACCOUNT",addGiftCard_AlreadyRedeemedByThisAccount:"GC_ALREADY_REDEEMED_BY_THIS_ACCOUNT",addGiftCard_BadCode:"GC_BAD_CODE",addGiftCard_ExpiredCode:"GC_EXPIRED_CODE",addGiftCard_Cancelled:"CANCELLED_CODE",addGiftCard_WrongOrgUnit:"GC_WRONG_ORG_UNIT",addGiftCard_ServiceDown:"GC_SERVICE_DOWN",addGiftCard_InvalidForAGS:"GC_INVALID_FOR_AGS",addGiftCard_PassedClaimByDate:"PASSED_CLAIM_BY_DATE",addGiftCard_OfferNotYetBegun:"GC_NOT_YET_BEGUN",
addGiftCard_ExceededMaxLimit:"GC_EXCEED_MAX_LIMIT",addGiftCard_Disabled:"GC_DISABLED",addGiftCard_OTP_Required:"GC_OTP_REQUIRED",addGiftCard_SEVIS_Decline:"GC_SEVIS_DECLINE",addGiftCard_OCRAH_Decline:"GC_OCRAH_DECLINE",addGiftCard_DEFAULT_Message:"GC_DEFAULT_MESSAGE"};a.declarative("gc-element",["click"],function(a){var b=a.data.click;b&&null!==b&&l(a.$event)});a.on("a:expander:redeem-gc-expander:toggle:expand",function(a){g.increaseCount("checkout:spp-payment:expand_addgc_coll",1)});p(document).delegate("#spc-gcpromoinput, #gc-promo-input",
"keypress",function(a){13===a.which&&l(a)});return{actionAddGiftPromotion:l,giftSystemErrorHandling:k}}});"use strict";q.when("A","page-transition-controller","loading-spinner-controller","ajax-utility","page-conductor","checkout-general-utils","page-detector","client-side-metrics","gift-utility","weblab-helper").register("gift-popover-controller",function(a,m,n,e,g,l,h,b,d,k){function c(){var a=Q;a.find("#select-recipient").empty();for(var b=0;b<ia.length;b++){var c=E("\x3coption/\x3e").attr({value:ia[b].value}).text(ia[b].text);
a.find("#select-recipient").append(c)}na&&(b=a.find('#select-recipient option[value\x3d"'+na+'"]').attr("selected","selected"),a.find("#select-recipient").closest("#popover-gift-connection-recipient").find(".a-placeholder").text(b.text()),ba())}function p(){a.defer(function(){E("#spc-orders").find(".gift-popover-link").each(function(){E(this).data("action")&&E(this).removeAttr("href").attr("tabindex",0)})});E(".larger-image-link").find("a").removeAttr("href")}function q(a){var b=Q;b.find(".gift-error-box").hide();
b.find(".fake-label").each(function(){E(this).unbind("click").bind("click",function(){E(this).closest(".popover-checkbox").find("input").trigger("click")})});a&&a.item&&a.item.title&&b.find(".popover-gift-top .gift-item-title span").html(a.item.title);a&&a.item&&a.item.isAutoripEligible?b.find("#gift-autorip-unavailable-msg").show():b.find("#gift-autorip-unavailable-msg").hide();if(a&&a.obfuscatedEntityId){var e=b.find(".set-gift-options-button input");e.unbind("click").bind("click",{obfuscatedentityid:a.obfuscatedEntityId,
giftData:a},u);l.bindActionEnterKeyOnButton(e)}ja?(ga=a&&a.item&&a.item.isAmazonFulfilled,sa=!(a&&a.address&&0===a.address.shipToSelf),ga&&(a&&a.options&&a.options.canHaveMessage||a&&a.options&&a.options.canBeWrapped)?(z(!0),b.find(".mfn-hide-prices").hide(),b.find(".include-gift-receipt").show()):ga||(z(!0),b.find(".include-gift-receipt").hide(),b.find(".mfn-hide-prices").show(),b.find(".include-gift-message").show()),ua=b.find(".include-gift-message").is(":visible"),C()):a&&a.options&&a.options.canHidePrices?
b.find(".hide-prices-checkbox").closest("div").show():b.find(".hide-prices-checkbox").closest("div").hide();a&&a.selected&&(e=O(b.find(".hide-prices-checkbox")),a.selected.hidePrices?e.attr("checked",!0):e.removeAttr("checked"));if(a&&a.item&&a.item.purchaseIsKindle){if(e=b.find(".kindle-registration-box"),e.show(),e.find(".register-kindle-customer-name").html(b.find(".gift-customer-name").html()),!ja){var e=O(b.find(".kindle-reg-radio-another-account")),f=O(b.find(".kindle-reg-radio-your-account"));
a.selected.hidePrices||a.selected.isWrapped?(f.removeAttr("checked"),e.attr("checked",!0)):(e.removeAttr("checked"),f.attr("checked","checked"));O(b.find(".hide-prices-checkbox")).trigger("change")}}else b.find(".kindle-registration-box").hide();if(a&&a.options&&a.options.canHaveMessage){a&&a.selected&&(e=a.selected.message,f=O(b.find(".include-gift-message-checkbox")),e&&e.length?(b.find("textarea[name\x3d'gift-message-text']").val(e),t(!0)):null===e&&(a.selected.isWrapped||a.selected.hasReceipt)?
(f.removeAttr("checked"),b.find(".textarea[name\x3d'gift-message-text']").val("")):(b.find("textarea[name\x3d'gift-message-text']").val(""),e="",ja?(e+=b.find(".sample-gift-msg-greeting").html(),a&&a.address&&a.address.firstName&&!sa&&(e+=" "+a.address.firstName),e=e+",\n"+b.find(".sample-gift-msg").html(),e+="\n"):(e+=b.find(".sample-gift-msg").html(),e+="\n\n"),e+=b.find(".sample-gift-msg-from").text(),e=ja?e+d.getNameWithNoTitle(b.find(".gift-customer-name").html()):e+d.getFirstName(b.find(".gift-customer-name").html()),
b.find("textarea[name\x3d'gift-message-text']").val(e),!ja||sa&&ua||t(!0)));var g=E(".gift-message-warning").length,e=function(){ja&&t(!0);L(a.options.maxMessageChars,a.options.maxMessageLines,a.options.hasFixedGiftMsgLimit);if(g){var b=Q.find("textarea[name\x3d'gift-message-text']");d.toggleGiftMessageWarning(b,Q)}};if(a&&a.options){var k=b.find("textarea[name\x3d'gift-message-text']");k.bind("keyup",e);k.bind("mouseup",e);L(a.options.maxMessageChars,a.options.maxMessageLines,a.options.hasFixedGiftMsgLimit);
g&&d.toggleGiftMessageWarning(k,b);O(b.find(".include-gift-message-checkbox")).bind("change",function(){var c=E(this).is(":checked"),e=a.options.maxMessageChars,f=a.options.maxMessageLines,h=a.options.hasFixedGiftMsgLimit,l=Q,p=l.find("textarea[name\x3d'gift-message-text']");c?ja&&v():(0<l.find(".validateInputCharactersOnBlur.a-form-error").size()&&(l.find(".validateInputCharactersOnBlur.a-form-error").removeClass("a-form-error"),0<l.find("#onblur-character-validation-error-gift-message-text").size()&&
l.find("#onblur-character-validation-error-gift-message-text").remove()),ja?C():(p.val(""),L(e,f,h)));g&&d.toggleGiftMessageWarning(k,b)})}}else b.find(".popover-gift-message-text").css("visibility","hidden"),b.find(".include-gift-message").css("visibility","hidden"),ja&&(b.find(".include-gift-message").hide(),b.find(".popover-gift-message").css("visibility","hidden")),b.find(".popover-gift-message-not-available").show();a&&a.options&&!a.options.canBeWrapped?(b.find(".wrap-option").hide(),b.find(".popover-gift-no-wrap-available").show(),
b.find(".hide-prices-amazon-msg").hide(),b.find(".hide-prices-note").hide(),b.find(".hide-prices-merchant-msg").show(),O(b.find(".hide-prices-checkbox")).attr("disabled",!1)):a&&a.item&&a.item.isAmazonFulfilled?(b.find(".wrap-option").hide(),b.find(".popover-gift-fba-wrap").show(),b.find(".hide-prices-amazon-msg").show(),b.find(".hide-prices-merchant-msg").hide(),(e=a.options.wraps[0].imageurl)&&0<e.length&&(b.find(".large-preview").find("img").attr("src",e),b.find(".large-preview").show(),b.find(".fba-wrap-checkbox").show(),
f=b.find(".larger-image-link"),f.unbind("click").bind("click",{imageURL:e},V),l.bindActionEnterKeyOnButton(f)),a.options.wraps[0].description&&b.find(".gift-wrap-title").show().html(a.options.wraps[0].description),"1"===E("#multipleAFNGiftWrapOption").val()?a.options&&a.options.wraps&&1<=a.options.wraps.length&&(e=b.find(".popover-gift-amazon-wrap"),w(b,e),B(a,"afn",e)):a.options&&a.options.wraps&&1===a.options.wraps.length?(b.find(".popover-gift-amazon-wrap").hide(),b.find(".popover-gift-merchant-wrap").hide(),
b.find(".fba-wrap-checkbox .gift-wrap-price").html(a.options.wraps[0].price),f=O(b.find(".amazon-gift-wrap")),f.val(a.options.wraps[0].id),e=O(b.find(".hide-prices-checkbox")),a.selected.isWrapped?(f.attr("checked",!0),a.item.purchaseIsKindle||(e.attr("checked",!0),e.attr("disabled",!0),b.find(".hide-prices-note").show())):(f.removeAttr("checked"),e.attr("disabled",!1),b.find(".hide-prices-note").hide())):a.options&&a.options.wraps&&1<a.options.wraps.length&&(e=b.find(".popover-gift-amazon-wrap"),
w(b,e),Z(a,"afn",e))):(b.find(".wrap-option").hide(),O(b.find(".hide-prices-checkbox")).removeAttr("disabled"),b.find(".hide-prices-amazon-msg").hide(),b.find(".hide-prices-note").hide(),b.find(".hide-prices-merchant-msg").show(),b.find(".large-preview").hide(),e=b.find(".popover-gift-merchant-wrap").show(),e.find(".mfn-wrap-copy").remove(),Z(a,"mfn",e));ja&&(P(),G(),A());if(0<E(".enable-gift-connections").length){b.find("#popover-gift-connection select.a-touch-select-input").each(function(){E(this).unbind("change").bind("change",
function(){var a=E(this),b=a.siblings("a.a-placeholder"),a=a.find(":selected").text();b.text(a);return!1})});b.find("#select-recipient").bind("change",function(a){N(a);return!1});b.find("#select-occasion").bind("change",function(a){ra(a);return!1});b.find("#input-recipient-first-name").keyup(function(){ba()});b.find("#input-recipient-last-name").keyup(function(){ba()});b.find("#popover-gift-connection-recipient").unbind("click").bind("click",function(a){a=Q;za||a.find("#select-recipient-spinner").show()});
na=H;if(a.giftConnection){typeof a.giftConnection.giftlistTypeId!==H&&"0"===a.giftConnection.giftlistTypeId&&typeof a.giftConnection.occasionId!==H&&"0"===a.giftConnection.occasionId&&b.find("#include-gift-connection-checkbox").attr("checked",!1);a.giftConnection.firstName&&b.find("#input-recipient-first-name").val(a.giftConnection.firstName);a.giftConnection.lastName&&b.find("#input-recipient-last-name").val(a.giftConnection.lastName);if("1"===a.giftConnection.giftlistTypeId||"2"===a.giftConnection.giftlistTypeId)e=
b.find('#select-recipient option[value\x3d"'+a.giftConnection.giftlistTypeId+'"]').attr("selected","selected"),b.find("#select-recipient").closest(".a-button-inner").find(".a-placeholder").text(e.text()),b.find(".gift-connection-recipient-extra").show();if(a.giftConnection.giftlistId&&"0"!==a.giftConnection.giftlistId)na=a.giftConnection.giftlistId;else if("0"===a.giftConnection.giftlistTypeId||"1"===a.giftConnection.giftlistTypeId||"2"===a.giftConnection.giftlistTypeId)na=a.giftConnection.giftlistTypeId;
a.giftConnection.occasionId&&(e=b.find('#select-occasion option[value\x3d"'+a.giftConnection.occasionId+'"]').attr("selected","selected"),b.find("#select-occasion").closest(".a-button-inner").find(".a-placeholder").text(e.text()));a.giftConnection.occasionMonth&&(e=b.find('#select-occasion-month option[value\x3d"'+a.giftConnection.occasionMonth+'"]').attr("selected","selected"),b.find("#select-occasion-month").closest(".a-button-inner").find(".a-placeholder").text(e.text()));a.giftConnection.occasionDay&&
(e=b.find('#select-occasion-day option[value\x3d"'+a.giftConnection.occasionDay+'"]').attr("selected","selected"),b.find("#select-occasion-day").closest(".a-button-inner").find(".a-placeholder").text(e.text()));a.giftConnection.age&&(e=b.find('#select-occasion-age option[value\x3d"'+a.giftConnection.age+'"]').attr("selected","selected"),b.find("#select-occasion-age").closest(".a-button-inner").find(".a-placeholder").text(e.text()));if("1"===a.giftConnection.occasionId||"2"===a.giftConnection.occasionId)b.find(".gift-connection-occasion-extra").show(),
"2"===a.giftConnection.giftlistTypeId&&b.find("#select-occasion-age-row").show();a.giftConnection.hasReminder&&"0"===a.giftConnection.hasReminder&&b.find("#occasion-has-reminder-checkbox").attr("checked",!1)}(!a.giftConnection||typeof a.giftConnection.occasionId===H||"1"!==a.giftConnection.occasionId&&"2"!==a.giftConnection.occasionId&&"3"!==a.giftConnection.occasionId)&&ba();ia&&(typeof na!==H||a.registryId in va)?(typeof na===H&&(na=va[a.registryId]),c(),b.find("#select-recipient").show(),b.find("#select-recipient-spinner").hide(),
za=!0):(za=!1,typeof na!==H?oa():oa(a.registryId))}Q.find(".content-container").css("visibility","visible");qa.updatePosition(!0);n.hideSpinner(b.find(".popover-content-main"))}function u(a){var b=Q,c="";if(!(0<b.find(".validateInputCharactersOnBlur.a-form-error").size())){a&&a.data&&a.data.obfuscatedentityid&&(c+="obfuscatedEntityId\x3d"+a.data.obfuscatedentityid+"\x26");ga&&(c+="isAFN\x3d1\x26");O(b.find(".include-gift-receipt-checkbox")).is(":checked")&&(c+="includeReceipt\x3d1\x26");O(b.find(".include-gift-message-checkbox")).is(":checked")?
(c+="includeMessage\x3d1\x26message\x3d"+encodeURIComponent(b.find("textarea[name\x3d'gift-message-text']").val())+"\x26",c+="maxChars\x3d"+a.data.giftData.options.maxMessageChars+"\x26",c+="maxLines\x3d"+a.data.giftData.options.maxMessageLines+"\x26"):c+="includeMessage\x3d0\x26";c=O(b.find(".hide-prices-checkbox")).is(":checked")?c+"hidePrices\x3d1\x26":c+"hidePrices\x3d0\x26";b.find(".kindle-registration-box").is(":visible")&&(c+="isKindlePurchase\x3d1\x26");var d;if(b.find(".popover-gift-fba-wrap").is(":visible"))if(b.find(".popover-gift-amazon-wrap").is(":visible")){if((d=
b.find("input[name\x3d'afn-gift-wrap']:checked").eq(0).val())&&d.length)for(c+="giftWrap\x3d"+d+"\x26",d=0;d<a.data.giftData.options.wraps.length;d++)if(b.find(".popover-gift-amazon-wrap").find(".afn-wrap-"+d).is(":checked")){c+="currencyAmount\x3d"+a.data.giftData.options.wraps[d].priceAmount+"\x26";c+="currencyUnit\x3d"+a.data.giftData.options.wraps[d].unit+"\x26";break}}else d=O(b.find(".amazon-gift-wrap")),d.is(":checked")&&(c+="giftWrap\x3d"+d.val()+"\x26",a.data.giftData.options&&(c+="currencyAmount\x3d"+
a.data.giftData.options.wraps[0].priceAmount+"\x26",c+="currencyUnit\x3d"+a.data.giftData.options.wraps[0].unit+"\x26"));else if(b.find(".popover-gift-merchant-wrap").is(":visible")&&(d=b.find("input[name\x3d'mfn-gift-wrap']:checked").eq(0).val())&&d.length)for(c+="giftWrap\x3d"+d+"\x26",d=0;d<a.data.giftData.options.wraps.length;d++)if(b.find(".popover-gift-merchant-wrap").find(".mfn-wrap-"+d).is(":checked")){c+="currencyAmount\x3d"+a.data.giftData.options.wraps[d].priceAmount+"\x26";c+="currencyUnit\x3d"+
a.data.giftData.options.wraps[d].unit+"\x26";break}if(0<E(".enable-gift-connections").length)if(b.find("#include-gift-connection-checkbox").is(":checked")){c+="includeGiftConnection\x3d1\x26";a=b.find("#select-recipient").val();c+="gcGiftlistTypeId\x3d"+a+"\x26";if("1"===a||"2"===a)c+="gcFirstName\x3d"+b.find("#input-recipient-first-name").val()+"\x26",c+="gcLastName\x3d"+b.find("#input-recipient-last-name").val()+"\x26";d=b.find("#select-occasion").val();c+="gcOccasionId\x3d"+d+"\x26";if("1"===d||
"2"===d)c+="gcMonth\x3d"+b.find("#select-occasion-month").val()+"\x26",c+="gcDay\x3d"+b.find("#select-occasion-day").val()+"\x26","1"===d&&"2"===a&&(c+="gcAge\x3d"+b.find("#select-occasion-age").val()+"\x26"),c+="gcHasReminder\x3d"+(b.find("#occasion-has-reminder-checkbox").is(":checked")?"1":"0")+"\x26"}else c+="includeGiftConnection\x3d0\x26";(a=E("input#executionId").val())&&(c+="executionId\x3d"+a+"\x26");a=(new Date).getTime();c+="isClientTimeBased\x3d"+E("input[name\x3d'useCtb']").val()+"\x26returnjson\x3d1\x26isDecoupleSPC\x3d1\x26hasWorkingJavascript\x3d1\x26returnFullHTML\x3d1\x26cachebuster\x3d"+
a;g.isSPP()&&(qa.hide(),a=E("#setOrderingPrefsCheckbox"),a.length&&a.is(":checked")&&(c+="\x26saveAsDefaultsSelected\x3d1"));m.show();a=g.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"});E.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/update-gift.html",data:c,dataType:"text",async:!0,cache:!1,headers:a,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(a,c,d){d.getResponseHeader("x-amz-checkout-page")?(g.isSPP()||b.find(".a-button-close").trigger("click"),
g.ajaxUpdatePage(a,c,d)):(a=e.jsonify(a),g.redirect(a))},error:function(a,b,c){g.ajaxRedirect(a,b,c)}})}}function w(a,b){a.find(".fba-wrap-checkbox").hide();a.find(".large-preview").hide();b.show();b.find(".afn-wrap-copy").remove()}function x(){var a=Q,b=a.find(".popover-gift-amazon-wrap").is(":visible"),c=O(a.find(".amazon-gift-wrap")),d=O(a.find(".afn-wrap-none")),e=O(a.find(".hide-prices-checkbox"));if(c.is(":checked")||!d.is(":checked")&&b)e.attr("checked",!0),e.attr("disabled",!0),a.find(".hide-prices-note").show();
else if(c.not(":checked")||d.is(":checked")&&b)e.attr("checked",!0),e.attr("disabled",!1),a.find(".hide-prices-note").hide()}function z(a){var b=Q,c=O(b.find(".include-gift-receipt-checkbox")),b=O(b.find(".mfn-hide-prices-checkbox"));a?(ga&&!c.is(":checked")&&c.attr("checked",!0).trigger("change"),ga||b.is(":checked")||b.attr("checked",!0).trigger("change")):(ga&&c.is(":checked")&&c.removeAttr("checked").trigger("change"),!ga&&b.is(":checked")&&b.removeAttr("checked").trigger("change"))}function f(a){var b=
Q,c=O(b.find(".include-gift-receipt-checkbox")),b=O(b.find(".mfn-hide-prices-checkbox"));a?(z(!0),ga?c.attr("disabled","disabled"):b.attr("disabled","disabled")):ga?c.removeAttr("disabled"):b.removeAttr("disabled")}function t(a){var b=O(Q.find(".include-gift-message-checkbox"));a?(b.is(":checked")||b.attr("checked",!0).trigger("change"),J(!1),v()):(b.is(":checked")&&b.removeAttr("checked").trigger("change"),C())}function J(a){var b=Q,c=b.find(".no-message-warning"),d=b.find(".no-receipt-warning"),
e=b.find("textarea[name\x3d'gift-message-text']"),b=b.find(".message-remaining-text");a&&!d.is(":visible")?(k.showGiftTextAreaOnWarning()||e.addClass("gift-message-warning"),b.hide(),c.show()):(k.showGiftTextAreaOnWarning()||e.removeClass("gift-message-warning"),c.hide(),b.show())}function v(){var a=Q,b=a.find("textarea[name\x3d'gift-message-text']"),a=a.find(".gift-message-label");b.removeClass("gift-message-inactive");a.removeClass("a-color-secondary")}function C(){var a=Q,b=a.find("textarea[name\x3d'gift-message-text']"),
a=a.find(".gift-message-label");b.addClass("gift-message-inactive");a.addClass("a-color-secondary")}function A(){var b=Q,c=O(b.find(".include-gift-message-checkbox")),d=b.find(".gift-msg-on-card"),e=b.find(".gift-msg-on-receipt"),f=a.trim(b.find(".gift-message-default-placeholder").text()),g=a.trim(b.find(".gift-message-with-wrap-placeholder").text()),k=b.find("textarea"),h=!1;b.find(".amazon-gift-wrap").each(function(){O(E(this)).is(":checked")&&(h=!0)});b.find(".afn-gift-wrap").each(function(){O(E(this)).is(":checked")&&
(h=!0)});b.find(".mfn-gift-wrap").each(function(){O(E(this)).is(":checked")&&(h=!0)});h?(e.hide(),d.show(),k.attr("placeholder",g),ga&&(t(!0),ua&&c.attr("disabled","disabled"))):(d.hide(),ga&&e.show(),k.attr("placeholder",f),c.removeAttr("disabled"))}function M(){var a=Q,b=O(a.find(".include-gift-message-checkbox")),a=a.find("textarea[name\x3d'gift-message-text']");!sa&&ga&&(b.is(":checked")&&0<a.val().length?J(!1):J(!0))}function S(){var a=Q,b=O(a.find(".include-gift-receipt-checkbox")),c=a.find(".no-receipt-warning"),
a=a.find(".no-message-warning");b.is(":checked")?(c.hide(),ua||t(!0)):(a.hide(),c.show(),t(!1))}function P(a){a=Q;var b=O(a.find(".include-gift-receipt-checkbox")),b=ga&&b.is(":checked"),c=O(a.find(".mfn-hide-prices-checkbox")),c=!ga&&c.is(":checked");b||c?(T(),a.find(".kindle-reg-msg-your-account").hide(),a.find(".kindle-reg-msg-another-account").show()):(U(),f(!1),a.find(".kindle-reg-msg-another-account").hide(),a.find(".kindle-reg-msg-your-account").show())}function G(a){a=Q;var b=!1;O(a.find(".include-gift-message-checkbox")).is(":checked")&&
(b=!0);var c=!1;a.find(".amazon-gift-wrap").each(function(){O(E(this)).is(":checked")&&(c=!0)});a.find(".afn-gift-wrap").each(function(){O(E(this)).is(":checked")&&(c=!0)});a.find(".mfn-gift-wrap").each(function(){O(E(this)).is(":checked")&&(c=!0)});(b||c)&&z(!0);b&&ua||c?f(!0):f(!1)}function L(a,b,c){var d=Q;la=a;Ca=b;if(a=d.find("textarea[name\x3d'gift-message-text']")){b=c?a.val().length:r.unescape(encodeURIComponent(a.val())).length;ja&&!sa&&ga&&(0<b?J(!1):J(!0));var e=a.val().split("\n").length;
c=la-b;e=Ca-e;!ja&&0<b&&d.find(".include-gift-message-checkbox").not(":checked")&&d.find(".include-gift-message-checkbox").attr("checked",!0);a=a.val().split("\n");for(var f in a)24<a[f].length&&(e=0===a[f].length%24?e-(Math.floor(a[f].length/24)-1):e-Math.floor(a[f].length/24));d.find(".popover-gift-center .remainder-count").hide();(-1>c?d.find(".popover-gift-center .remaining-char-over-multiple").show():0>c?d.find(".popover-gift-center .remaining-char-over-single").show():1===c?d.find(".popover-gift-center .remaining-char-single").show():
d.find(".popover-gift-center .remaining-char-multiple").show()).find(".chars-remaining").html(Math.abs(c));(-1>e?d.find(".popover-gift-center .remaining-line-over-multiple").show():0>e?d.find(".popover-gift-center .remaining-line-over-single").show():1===e?d.find(".popover-gift-center .remaining-line-single").show():d.find(".popover-gift-center .remaining-line-multiple").show()).find(".lines-remaining").html(Math.abs(e));if(0>c||0>e)g.isSPP()?(d.find(".set-gift-options-button").addClass("aok-hidden"),
d.find(".set-gift-options-button-disabled").removeClass("aok-hidden")):(d.find(".set-gift-options-button").hide(),d.find(".set-gift-options-button-disabled").show()),0>c?(d.find(".gift-char-limit-error").find(".char-limit-error").html(la),d.find(".current-blocker-content").html(d.find(".gift-char-limit-error").html())):0>e&&(d.find(".gift-line-limit-error").find(".line-limit-error").html(Ca),d.find(".current-blocker-content").html(d.find(".gift-line-limit-error").html()));-1<c&&-1<e&&(g.isSPP()?(d.find(".set-gift-options-button").removeClass("aok-hidden"),
d.find(".set-gift-options-button-disabled").addClass("aok-hidden")):(d.find(".set-gift-options-button").show(),d.find(".set-gift-options-button-disabled").hide()))}}function V(a){a.stopPropagation();var b=Q;b.find(".popover-content-main").fadeOut(100,function(){b.find(".popover-content-gift-wrap-preview .gift-wrap-preview-image").attr("src",a.data.imageURL);b.find(".popover-content-gift-wrap-preview").fadeIn(100)});var c=b.find(".popover-content-gift-wrap-preview .back-to-gift-options-button");c.unbind("click").bind("click",
X);l.bindActionEnterKeyOnButton(c);fa=!0}function X(a){fa=!1;var b=Q;a?b.find(".popover-content-gift-wrap-preview").fadeOut(100,function(){b.find(".popover-content-main").fadeIn(100)}):setTimeout(function(){b.find(".popover-content-gift-wrap-preview").hide();b.find(".popover-content-main").show()},500)}function I(a){var b=Q,c=!1;E(".amazon-gift-wrap").each(function(){O(E(this)).is(":checked")&&(c=!0)});E(".afn-gift-wrap").each(function(){O(E(this)).is(":checked")&&(c=!0)});E(".mfn-gift-wrap").each(function(){O(E(this)).is(":checked")&&
(c=!0)});if(c)T(),W();else if(O(b.find(".hide-prices-checkbox")).is(":disabled"))aa();else if(a.is("input[type\x3dcheckbox]")&&(a.closest(".a-checkbox").hasClass("hide-prices-checkbox")||a.hasClass("hide-prices-checkbox")))a.is(":checked")?T():U();else if(g.isSPP())(b=a.closest(".a-radio"))&&a.is(":checked")&&(b.hasClass("kindle-reg-radio-your-account")?U():b.hasClass("kindle-reg-radio-another-account")&&T());else if(a.hasClass("kindle-reg-radio-another-account")||a.hasClass("kindle-reg-radio-your-account"))b.find(".kindle-reg-radio-your-account").is(":checked")?
U():T()}function T(){var a=Q,b=O(a.find(".hide-prices-checkbox"));b.is(":checked")&&!g.isSPP()||b.attr("checked","checked");O(a.find(".kindle-reg-radio-your-account")).is(":checked")&&O(a.find(".kindle-reg-radio-another-account")).attr("checked",!0)}function U(){var a=Q,b=O(a.find(".hide-prices-checkbox"));b.is(":checked")&&b.removeAttr("checked");O(a.find(".kindle-reg-radio-another-account")).is(":checked")&&O(a.find(".kindle-reg-radio-your-account")).attr("checked",!0)}function W(){var a=Q;O(a.find(".hide-prices-checkbox")).attr("disabled",
"true");O(a.find(".kindle-reg-radio-another-account")).attr("disabled",!0);O(a.find(".kindle-reg-radio-your-account")).attr("disabled",!0);a.find(".hide-prices-merchant-cant").is(":visible")||a.find(".hide-prices-note").show()}function aa(){var a=Q;O(a.find(".hide-prices-checkbox")).removeAttr("disabled");O(a.find(".kindle-reg-radio-another-account")).removeAttr("disabled");O(a.find(".kindle-reg-radio-your-account")).removeAttr("disabled");a.find(".hide-prices-note").hide()}function ha(a){var b=l.getPosition(a,
"#",2),c=l.getPosition(a,"#",3);return"60"===a.substring(b+1,c)}function B(b,c,d){var e=Y(),f,g;e?(f=d.find('li[class\x3d"a-carousel-card gift-wrap noshi-wrap none-wrap"]'),g=d.find(".carousel-gift-wrap").find("ol")):(f=d.find("."+c+"-wrap-template"),g=d.find("ul.allGiftWrapList"));e&&a.trigger("checkout:gift:removeEmptyCarouselCards",g);var k=(d.data("lineitemid")||b.obfuscatedEntityId||"").replace(":","-");"afn"!==c||e||(g.find('li[class!\x3d"none-wrap gift-wrap noshi-wrap"]').remove(),E("#giftwrap-carousel-wrap-holder-"+
k).css("width",90*(b.options.wraps.length+1)),E("#giftwrap-carousel-wrap-pane-"+k).css("width",360));for(var h=Q,l=h.find(".larger-image-link-carousel-template"),p=0;p<b.options.wraps.length;p++){var m=f.clone(!0).removeClass(c+"-wrap-template").addClass(c+"-wrap-copy"),n=l.clone(!0).removeClass("larger-image-link-carousel-template").addClass("larger-image-link-carousel-"+p),t=c,u=b,r=p,v=m,q=n,y=u.options.wraps[r].id;v.find("input").addClass(t+"-wrap-"+r).val(y);v.find("label").attr("for",t+"-wrap-"+
r);y=u.options.wraps[r].description;v.find("."+t+"-wrap-description").html(y);y=u.options.wraps[r].price;v.find("."+t+"-wrap-price").html(y);(u=u.options.wraps[r].imageurl)&&u.length?(v.find("."+t+"-image").attr("src",u).show(),t=v.find(".larger-image-link"),t.show(),t.unbind("click").bind("click",{imageURL:u},V),q.unbind("click").bind("click",{imageURL:u},V),q.find("a").unbind("click").bind("click",{imageURL:u},V)):"mfn"!==t||Y()||(v.find(".a-span3").hide(),v.find(".a-span9").addClass("a-span12").removeClass("a-span9"),
v.find(".a-color-price").removeClass("wrap-price"));if("afn"===c){r=b;q=p;v=k;t=g;u=h;y=r.options.wraps[q].id;m.data("giftwrap-id",y);m.data("wrap-no",q);if(r.selected.wrap===y){t.find("li.none-wrap").find("img").removeClass("selected-giftwrap-image");m.find("img").addClass("selected-giftwrap-image");var r=m.find("img").attr("src"),z=E("#giftwrap-option-preview-imagearea-image-"+v);z.find("img").attr("src",r);z.removeClass("aok-hidden");E("#giftwrap-option-preview-imagearea-default-"+v).addClass("aok-hidden");
I(m.find("input"));x();n.removeClass("aok-hidden");n.addClass("selectedWrapLargeLink")}Y()?(v=ha(y)?"gift-wrap":"noshi-wrap",m.removeClass(v).removeClass("none-wrap"),t.append(m.show())):(v=ha(y)?"\x3cli class\x3dnoshi-wrap\x3e":"\x3cli class\x3dgift-wrap\x3e",t.append(E(v).append(m.show())));m=u.find("#carousel-larger-image-div");m.find(".larger-image-link-carousel-"+q).length||m.append(n.show())}}d.find("."+c+"-wrap-checkbox").removeAttr("checked");b.selected&&b.selected.isWrapped?d.find("input[value\x3d'"+
b.selected.wrap+"']").attr("checked",!0):O(d.find("."+c+"-wrap-none")).attr("checked",!0);e&&a.trigger("checkout:gift:adjustCarouselInitial",b,d)}function Y(){return g.isSPP()&&E("input[name\x3dsppGiftPopoverWithCarousel]").length}function Z(a,b,c){for(var d=c.find("."+b+"-wrap-template"),e=0;e<a.options.wraps.length;e++){var f=d.clone(!0).removeClass(b+"-wrap-template").addClass(b+"-wrap-copy"),k=a.options.wraps[e].id;f.find("input").addClass(b+"-wrap-"+e).val(k);f.find("label").attr("for",b+"-wrap-"+
e);k=a.options.wraps[e].description;f.find("."+b+"-wrap-description").html(k);k=a.options.wraps[e].price;f.find("."+b+"-wrap-price").html(k);if((k=a.options.wraps[e].imageurl)&&k.length){var h=f.find("."+b+"-image");g.isSPP()&&h.removeClass("hidden");h.attr("src",k).show();h=f.find(".larger-image-link");g.isSPP()&&h.removeClass("hidden");h.show();h.unbind("click").bind("click",{imageURL:k},V)}else f.find(".a-span3").hide(),f.find(".a-span9").addClass("a-span12").removeClass("a-span9"),f.find(".a-color-price").removeClass("wrap-price");
g.isSPP()&&f.removeClass("hidden");f.insertAfter(d).show()}c.find("."+b+"-wrap-checkbox").removeAttr("checked");a.selected&&a.selected.isWrapped?c.find("input[value\x3d'"+a.selected.wrap+"']").attr("checked",!0):O(c.find("."+b+"-wrap-none")).attr("checked",!0)}function y(){Q.find("#include-gift-connection-checkbox").attr("checked",!0)}function ca(){if(Q.find(".include-gift-connection-checkbox").not(":checked")){var a=Q;a.find(".gift-connection-recipient-extra").hide();var b;b=a.find('#select-recipient option[value\x3d"0"]').attr("selected",
"selected");a.find("#select-recipient").closest(".a-button-inner").find(".a-placeholder").text(b.text());a.find("#input-recipient-first-name").val("");a.find("#input-recipient-last-name").val("");ba()}}function da(a){for(var b=Q,c=0;c<ia.length;c++)if(a&&a===ia[c].value&&ia[c].bMonth&&ia[c].bDay){var d;d=b.find('#select-occasion-month option[value\x3d"'+ia[c].bMonth+'"]').attr("selected","selected");b.find("#select-occasion-month").closest(".a-button-inner").find(".a-placeholder").text(d.text());
d=b.find('#select-occasion-day option[value\x3d"'+ia[c].bDay+'"]').attr("selected","selected");b.find("#select-occasion-day").closest(".a-button-inner").find(".a-placeholder").text(d.text())}}function ba(){var a=Q,b=a.find("#popover-gift-connection #select-recipient").find(":selected").val();if(""!==b&&"0"!==b&&("1"!==b&&"2"!==b||a.find("#input-recipient-first-name").val()||a.find("#input-recipient-last-name").val()))a.find("#select-occasion").prop("disabled",!1),a.find("#popover-gift-connection-occasion .a-touch-select").css({opacity:1});
else{b=Q;b.find(".gift-connection-occasion-extra").hide();var c;c=b.find('#select-occasion option[value\x3d"0"]').attr("selected","selected");b.find("#select-occasion").closest(".a-button-inner").find(".a-placeholder").text(c.text());c=b.find('#select-occasion-month option[value\x3d"0"]').attr("selected","selected");b.find("#select-occasion-month").closest(".a-button-inner").find(".a-placeholder").text(c.text());c=b.find('#select-occasion-day option[value\x3d"0"]').attr("selected","selected");b.find("#select-occasion-day").closest(".a-button-inner").find(".a-placeholder").text(c.text());
c=b.find('#select-occasion-age option[value\x3d"-1"]').attr("selected","selected");b.find("#select-occasion-age").closest(".a-button-inner").find(".a-placeholder").text(c.text());b.find("#occasion-has-reminder-checkbox").attr("checked",!0);a.find("#select-occasion").prop("disabled",!0);a.find("#popover-gift-connection-occasion .a-touch-select").css({opacity:.5})}}function ma(a,b){var c=Q;"1"===a&&"2"===b?c.find("#select-occasion-age-row").show():c.find("#select-occasion-age-row").hide()}function N(a){a=
Q;var b=a.find("#popover-gift-connection #select-recipient").find(":selected").val(),c=a.find("#popover-gift-connection #select-occasion").find(":selected").val();!b||"1"!==b&&"2"!==b?(a.find(".gift-connection-recipient-extra").hide(),"1"===c&&b&&da(b)):a.find(".gift-connection-recipient-extra").show();ma(c,b);ba()}function ra(a){a=Q;var b=a.find("#popover-gift-connection #select-occasion").find(":selected").val(),c=a.find("#popover-gift-connection #select-recipient").find(":selected").val();!b||
"1"!==b&&"2"!==b?a.find(".gift-connection-occasion-extra").hide():("1"===b&&c&&"1"!==c&&"2"!==c&&da(c),a.find(".gift-connection-occasion-extra").show());ma(b,c)}function oa(a){var b=Q,d="/gp/buy/pipeline/handlers/list-of-giftlists.html?escape\x3d0";ia&&(d+="\x26mappingOnly\x3d1");a&&(d+="\x26fromRegistryIds\x3d"+a);E.ajax({type:"POST",url:d,dataType:"json",async:!0,cache:!1,timeout:5E3,success:function(d){b.find("#select-recipient").hide();!ia&&d.options&&0<d.options.length&&(ia=d.options);a&&d.registryIdMapping?
(va[a]=d.registryIdMapping[a],na=d.registryIdMapping[a]):a&&(va[a]=H);ia&&c();b.find("#select-recipient").show();b.find("#select-recipient-spinner").hide();za=!0},error:function(){b.find("#select-recipient").show();b.find("#select-recipient-spinner").hide();za=!0}})}function R(b,c){var d=Y(),e=c.lineItemId;c=Y()?c.currentTab:b.data("current-tab");var f=E("#popover-gift-options-wrapper-"+e).data("active-tab");c!==f&&(b.parent().find(".selected-giftwrap-tab").removeClass("selected-giftwrap-tab"),b.addClass("selected-giftwrap-tab"),
b=E("#giftwrap-carousel-wrap-holder-"+e),d||b.css("left",0),f=E("#giftwrap-carousel-wrap-holder-"+e+" li"),d?(a.trigger("checkout:gift:changeCarouselWrapOptions",b,c,e),a.trigger("checkout:gift:adaptCarouselSPCPanel",e,c)):"all"===c?f.show():(f.hide(),f.filter("."+{"gift-wrap":"gift-wrap",noshi:"noshi-wrap"}[c]).show()),E("#popover-gift-options-wrapper-"+e).data("active-tab",c),f.find(".selected-giftwrap-image").removeClass("selected-giftwrap-image"),f.filter(".none-wrap").find("img").addClass("selected-giftwrap-image"),
E("#giftwrap-option-preview-imagearea-default-"+e).removeClass("aok-hidden"),E("#giftwrap-option-preview-imagearea-image-"+e).addClass("aok-hidden"),d=E("#allGiftWrapList-"+e).find(".none-wrap").find("input"),e=E(".selectedWrapLargeLink"),d.prop("checked",!0),d.val("").change(),e.length&&(e.addClass("aok-hidden"),e.removeClass("selectedWrapLargeLink")))}function xa(a,b,c){c.$event.preventDefault();a=b.lineItemId;b=parseInt(E("#giftwrap-carousel-wrap-holder-"+a).css("left"),10);0>b&&(b=b+90+"px",E("#giftwrap-carousel-wrap-holder-"+
a).css("left",b))}function pa(a,b,c){c.$event.preventDefault();a=b.lineItemId;var d=E("#allGiftWrapList-"+a);b=d.find("li").size();c=d.find("li.gift-wrap").size();var d=d.find("li.noshi-wrap").size(),e=E("#popover-gift-options-wrapper-"+a).data("active-tab"),f;"all"===e?f=b:"gift-wrap"===e?f=c:"noshi"===e&&(f=d);b=parseInt(E("#giftwrap-carousel-wrap-holder-"+a).css("left"),10);b>-90*(f-4)&&(b=b-90+"px",E("#giftwrap-carousel-wrap-holder-"+a).css("left",b))}function wa(a,b){var c=b.lineItemId;E("#allGiftWrapList-"+
c).find(".selected-giftwrap-image").removeClass("selected-giftwrap-image");a.find(".afn-image").addClass("selected-giftwrap-image");b=a.parent();var d=a.data("giftwrap-id"),e=a.find("input"),f=a.data("wrap-no");e.prop("checked",!0);e.val(d).change();d=E("#giftwrap-option-preview-imagearea-default-"+c);c=E("#giftwrap-option-preview-imagearea-image-"+c);e=E(".selectedWrapLargeLink");f=E(".larger-image-link-carousel-"+f);b.hasClass("none-wrap")?(d.removeClass("aok-hidden"),c.addClass("aok-hidden"),e.length&&
(e.addClass("aok-hidden"),e.removeClass("selectedWrapLargeLink"))):(a=a.find("img").attr("src"),c.find("img").attr("src",a),d.addClass("aok-hidden"),c.removeClass("aok-hidden"),e.length&&(e.addClass("aok-hidden"),e.removeClass("selectedWrapLargeLink")),f.length&&(f.addClass("selectedWrapLargeLink"),f.removeClass("aok-hidden")))}function ya(a,b){var c=b.lineItemId;b=E("#giftwrap-option-preview-imagearea-default-"+c);c=E("#giftwrap-option-preview-imagearea-image-"+c);a.hasClass("none-wrap")?(b.removeClass("aok-hidden"),
c.addClass("aok-hidden")):(a=a.find("img").attr("src"),c.find("img").attr("src",a),b.addClass("aok-hidden"),c.removeClass("aok-hidden"))}function Ba(a,b){var c=b.lineItemId;a=E("#giftwrap-option-preview-imagearea-default-"+c);b=E("#giftwrap-option-preview-imagearea-image-"+c);E("#allGiftWrapList-"+c).find(".selected-giftwrap-image").parentsUntil("ul","li").hasClass("none-wrap")?(a.removeClass("aok-hidden"),b.addClass("aok-hidden")):(c=E("#allGiftWrapList-"+c).find(".selected-giftwrap-image").attr("src"),
b.find("img").attr("src",c),a.addClass("aok-hidden"),b.removeClass("aok-hidden"))}var E=a.$;if(!E("html").hasClass("a-ie6")){var la,Ca,Q,qa,fa=!1,ja=!1,sa=!0,ga=!0,ia,za=!1,va={},na,ua=!1;a.on("a:popover:hide",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("gift-")&&(g.isSPP()&&b.increaseCount("checkout:spp-revieworder:gift_pop_cancel_sec",1),fa&&X(),ja&&(a=Q,a.find(".gift-msg-on-card").hide(),a.find(".popover-gift-warning").hide(),a.find(".message-remaining-text").show(),O(a.find(".amazon-gift-wrap")).removeAttr("checked"),
t(!1),a.find('input[type\x3d"checkbox"]').removeAttr("disabled")))});a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("gift-")){Q=a.popover.$popover;qa=a.popover;0<Q.find(".include-gift-receipt-checkbox").length&&(ja=!0);n.showSpinner(Q.find(".popover-content-main"),!1,qa);Q.find(".content-container").css("visibility","hidden");a="returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isDecoupleSPC\x3d1\x26cachebuster\x3d"+(new Date).getTime();try{var b=qa.data;
if(b)a+="\x26obfuscatedEntityId\x3d"+b;else throw{name:"MissingData",message:"lineItemId is undefined"};}catch(c){r.ueLogError&&r.ueLogError(c,{logLevel:"FATAL",attribution:"gift-popover",message:"[No lineItemId to open the gift-popover with]. "})}E.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/gift-select-content.html",data:a,dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc"},dataFilter:function(a){return e.jsonify(a)},success:function(a,b,c){a&&a.conductoraction&&a.conductoraction.url&&
g.redirect(a);null!==a?q(a,b,c):g.ajaxRedirect()},error:function(a,b,c){g.ajaxRedirect(a,b,c)}})}});a.on("a:popover:beforeShow",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("button-blocker-gift"))b=Q,a.popover.$popover.find(".a-popover-inner").html(b.find(".current-blocker-content").text()),a.popover.updatePosition(!0);else if(a.popover&&a.popover.$popover){var b=a.popover.$popover;a=b.find(".validateInputCharactersOnBlur.a-form-error");0<a.size()&&a.removeClass("a-form-error");
b=b.find("#onblur-character-validation-error-gift-message-text");0<b.size()&&b.remove()}});var ka={enforceSelectorParity:I,enforceGiftReceiptParity:G,enforceHidePriceParity:P,disableHidePrice:x,toggleMessageBoxDisplay:A,toggleEmptyMsgWarning:M,toggleNoReceiptWarning:S,includeGiftConnection:y,clearGiftConnection:ca,toggleGiftConnectionRecipientArea:N,toggleGiftConnectionOccasionArea:ra,updateGiftOptionsTabSelection:R,updateCarouselOnLeftClick:xa,updateCarouselOnRightClick:pa,updateSelectedGiftWrap:wa,
updatePreviewImageOnMouseEnter:ya,updatePreviewImageOnMouseLeave:Ba},O=d.getInput;a.declarative("gift-popover-element",["change"],function(a){var b;b=a.$event.isInit?a.data.onInit||[]:a.data.onChange||[];for(var c=0;c<b.length;c++)if(ka[b[c]])ka[b[c]](a.$target,a.data)});a.declarative("gift-popover-element","click mouseenter mouseleave",function(a){var b;if(b=a.data[{click:"onClick",mouseenter:"mouseEnter",mouseleave:"mouseLeave"}[a.type]])for(var c=0;c<b.length;c++)if(ka[b[c]])ka[b[c]](a.$currentTarget,
a.data,a)});a.declarative("spc-update-gift-options-tab-selection","click",function(a){var b=a.$target.parents("li");b.attr("data",a.data);R(b,a.data)});a.on("checkout:reload:spc",p);a.on("checkout:reload:spp-revieworder",p)}});"use strict";q.when("A","page-transition-controller","loading-spinner-controller","ajax-utility","page-conductor","checkout-general-utils","page-detector","client-side-metrics").register("concealment-popover-controller",function(a,m,n,e,g,l,h,b){function d(){q("#spc-orders").find(".concealment-widgets-desktop").removeClass("no-js-hide");
a.defer(function(){q("#spc-orders").find(".concealment-popover-link").each(function(){q(this).data("action")&&q(this).removeAttr("href").attr("tabindex",0)})})}function k(a){return a.is("input")?a:a.find("input")}function c(a){var b=u;b.find(".fake-label").each(function(){q(this).unbind("click").bind("click",function(){q(this).closest(".popover-checkbox").find("input").trigger("click")})});a&&a.item&&a.item.title&&b.find(".concealment-item-title").html(a.item.title);if(a&&a.obfuscatedEntityId){var c=
b.find(".set-concealment-options-button input");c.unbind("click").bind("click",{obfuscatedentityid:a.obfuscatedEntityId,concealmentData:a,quantity:a.quantity},p);l.bindActionEnterKeyOnButton(c)}x=a&&a.item&&a.item.isAmazonFulfilled;a&&a.selected&&(c=k(b.find(".conceal-item-checkbox")),a.selected.concealItem?c.attr("checked",!0):c.removeAttr("checked"));u.find(".content-container").css("visibility","visible");w.updatePosition(!0);n.hideSpinner(b.find(".popover-content-main"))}function p(a){var c=u,
d="";a&&a.data&&a.data.obfuscatedentityid&&(d+="obfuscatedEntityId.0\x3d"+a.data.obfuscatedentityid+"\x26");a&&a.data&&a.data.quantity&&(d+="quantity.0\x3d"+a.data.quantity+"\x26");var h="";a&&a.data&&a.data.concealmentData&&a.data.concealmentData.saveConcealmentRefTag&&(h=a.data.concealmentData.saveConcealmentRefTag);var l="";a&&a.data&&a.data.concealmentData&&a.data.concealmentData.cancelConcealmentRefTag&&(l=a.data.concealmentData.cancelConcealmentRefTag);(a=k(c.find(".conceal-item-checkbox")).is(":checked"))?
(x&&(d+="isAFN.0\x3d1\x26"),d=d+"includeReceipt.0\x3d1\x26includeMessage.0\x3d1\x26"+("message.0\x3d"+encodeURIComponent(q("input[name\x3d'concealment-item-message']").val())+"\x26"),d=d+"hidePrices.0\x3d0\x26saveOnly\x3d1"+("ref\x3d"+h+"\x26")):d+="ref\x3d"+l+"\x26";var p=q("input#executionId").val();p&&(d+="executionId\x3d"+p+"\x26");p="/gp/buy/gift/handlers/save-all.html/ref\x3d";a?(p+=h,b.increaseCount("CPEX.Checkout.Select.Concealment",1)):(p+=l,b.increaseCount("CPEX.Checkout.Cancel.Concealment",
1));g.isSPP()&&(c.find(".a-button-close").trigger("click"),h=q("#setOrderingPrefsCheckbox"),h.length&&h.is(":checked")&&(d+="\x26saveAsDefaultsSelected\x3d1"));m.show();q.ajax({type:"POST",url:p,data:d,dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"},contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(a,b,d){d.getResponseHeader("x-amz-checkout-page")?(g.isSPP()||c.find(".a-button-close").trigger("click"),g.ajaxUpdatePage(a,
b,d)):(a=e.jsonify(a),g.redirect(a))},error:function(a,b,c){g.ajaxRedirect(a,b,c)}})}var q=a.$;if(!q("html").hasClass("a-ie6")){var u,w,x=!0;q(document).delegate(".concealment-popover-link, .concealment-options-button","click",function(){b.increaseCount("CPEX.Checkout.Concealment.Button.click",1)});a.on("a:popover:hide",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("concealment-")&&(g.isSPP()&&b.increaseCount("checkout:spp-revieworder:concealment_pop_cancel_sec",1),k(u.find(".conceal-item-checkbox")).removeAttr("checked"))});
a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("concealment-")){u=a.popover.$popover;w=a.popover;n.showSpinner(u.find(".popover-content-main"),!1,w);u.find(".content-container").css("visibility","hidden");a="returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isDecoupleSPC\x3d1\x26cachebuster\x3d"+(new Date).getTime();try{var b=w.data.lineItemEntityId,d=w.data.itemId;if(b)a+="\x26obfuscatedEntityId\x3d"+b;else if(d)a+="\x26lineItemEntityId\x3d"+d;else throw{name:"MissingData",
message:"lineItemId is undefined"};var k=w.data.quantity;if(k)a+="\x26quantity\x3d"+k;else throw{name:"MissingData",message:"quantity is undefined"};}catch(h){r.ueLogError&&r.ueLogError(h,{logLevel:"FATAL",attribution:"concealment-popover",message:"[Data missing to open the concealment-popover]. "})}b=w.data.ref;q.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/concealment-select-content.html/ref\x3d"+b,data:a+("\x26ref\x3d"+b),dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc"},
dataFilter:function(a){return e.jsonify(a)},success:function(a,b,d){a&&a.conductoraction&&a.conductoraction.url&&g.redirect(a);null!==a?c(a,b,d):g.ajaxRedirect()},error:function(a,b,c){g.ajaxRedirect(a,b,c)}})}});a.on("a:popover:beforeShow",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("button-blocker-concealment")){var b=u;a.popover.$popover.find(".a-popover-inner").html(b.find(".current-blocker-content").text());a.popover.updatePosition(!0)}});var z={};a.declarative("concealment-popover-element",
["change"],function(a){var b;b=a.$event.isInit?a.data.onInit||[]:a.data.onChange||[];for(var c=0;c<b.length;c++)if(z[b[c]])z[b[c]](a.$target,a.data)});a.declarative("concealment-popover-element","click mouseenter mouseleave",function(a){var b;if(b=a.data[{click:"onClick",mouseenter:"mouseEnter",mouseleave:"mouseLeave"}[a.type]])for(var c=0;c<b.length;c++)if(z[b[c]])z[b[c]](a.$currentTarget,a.data,a)});a.on("checkout:reload:spc",d);a.on("checkout:reload:spp-revieworder",d)}});"use strict";q.when("A",
"page-conductor","scroll-controller","page-detector","client-side-metrics","button-blocker","weblab-helper").register("gold-box-controller",function(a,m,n,e,g,l,h){function b(){a.defer(c);a.defer(p)}var d=a.$,k={};if(!d("html").hasClass("a-ie6")){var c=function(){var a=d("#goldbox-countdown"),b=d("#spc-orders");b&&0!==b.length||(b=d("#spclite-items-block"));b=b.find("input[name\x3dgoldboxexpirelefttime]");if(0!==b.length){if(1<b.size()){var c=parseInt(b.attr("data-timeleftms"),10),e=b;d.each(b,function(){var a=
d(this),b=parseInt(a.attr("data-timeleftms"),10);b<c&&(e=a,c=b)});b=e}var h=parseFloat(b.attr("data-pagestarttime")),f=parseFloat(b.attr("data-timeleftms")/1E3);if(!(isNaN(h)||isNaN(f)||0>=f)){var l=(new Date).getTime();isNaN(k[h])?(k={},k[h]=l):l=k[h];var p=a.find("span[data-timefield\x3dminute]"),q=a.find("span[data-timefield\x3dsecond]"),C=r.setInterval(function(){var b=(new Date).getTime();f-=(b-l)/1E3;l=b;if(0>f&&C)q.html("00"),r.clearInterval(C),C=null,m.isSPP()&&g.increaseCount("checkout:spp-revieworder:deal_expired",
1),d("#gold-box-modal-launcher").trigger("click"),n.scrollToTop(),n.toggleScrollOff();else{var b=Math.floor(f/60%60),c=Math.floor(f%60),c=10>c?"0"+c:c;p.html(b);q.html(c);a.is(":visible")||a.show()}},1E3);m.isSPP()&&g.increaseCount("checkout:spp-revieworder:deal_countdown",1)}}},p=function(){var a=d("#gold-box-button-blocker");1===a.length&&l.show("place-order-gold-box-blocker",a.attr("data-blocker-message"))};a.on("checkout:reload:spc",b);a.on("checkout:reload:spclite",b);a.on("checkout:reload:spp-revieworder",
b)}});"use strict";q.when("A","page-transition-controller","ajax-utility","page-conductor","currency-formatter","page-detector","client-side-metrics","pay-rewards-currency","weblab-helper").register("inline-points-controller",function(a,m,n,e,g,l,h,b,d){function k(){f("#spc-points-input")&&f("#spc-points-input").data("points-used")&&(f("#points-applied").show(),f("#inline-points-button").hide());f("#inline-points-register")&&f("#inline-points-register").removeAttr("href");f("#spc-loyalty-points-input")&&
f("#spc-loyalty-points-input").val()&&(f("#loyalty-points-applied").show(),f("#loyalty-points-button").hide());f("#spc-points-input")&&f("#spc-points-input").hasClass("show-currency-input-widget-new")&&f("#spc-points-input").each(function(c,d){var e=a.$(d);c={$element:e,maxAmount:e.data("max-dollar-amount")};d={$element:a.$("#inline-raw-points"),decimalPlaces:e.data("decimal-places"),ratio:e.data("conversion-ratio")};var g=e.data("country-code"),g=b.getCurrencyFormatByCountryCode(g);b.initializeInlineFormatting(c,
d,g);f(document).delegate("#spc-points-input","keydown",function(a){if(e.data("points-used")!==e.val){a=f("#inline-points-button");var b=!1;a.is("span")&&(b=!0);var c=a.find("span.apply"),d=a.find("span.change");f("#points-applied").hide();e.data("points-used")?(c.hide(),d.show()):(c.show(),d.hide());b?a.addClass("display-inline-block"):a.show()}})})}function c(a,b){a.preventDefault();if(p(b)){e.isSPP()?(m.blockAllActions(),m.showTransitionInContainer(f("#payment"))):m.show();var c,g;a={"x-amz-checkout-page":"spc"};
if(b)g=f("#loyalty-points-hidden-fields"),b="/gp/buy/spc/handlers/update-loyalty-points.html/ref\x3dox_spc_points_edit",c="\x26jpPointsPaymentInstrumentId\x3d"+encodeURIComponent(g.find("input[name\x3d'jpPointsPaymentInstrumentId']").val())+"\x26jpPointsCustomerRequestedAmount\x3d"+f("#spc-loyalty-points-input").val()+"\x26jpPointsConversionRate\x3d"+g.find("input[name\x3d'jpPointsConversionRate']").val()+"\x26jpPointsBaseCurrencyCode\x3d"+g.find("input[name\x3d'jpPointsBaseCurrencyCode']").val()+
"\x26jpPointsTargetCurrencyCode\x3d"+g.find("input[name\x3d'jpPointsTargetCurrencyCode']").val()+"\x26jpPointsAvailablePoints\x3d"+g.find("input[name\x3d'jpPointsAvailablePoints']").val()+"\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+f("input[name\x3duseCtb]").val();else{a=e.setAjaxTransitionHeader(a);g=f("#inline-points-hidden-fields");var k=g.find("input[name\x3d'useGCBalance']").val();b="/gp/buy/pipeline/handlers/update-reward-points.html/ref\x3d"+(e.isSPP()?"chk_pay_addswp_coll":"ox_pay_page_points_apply");
c="paymentMethodId\x3d"+g.find("input[name\x3d'paymentMethodId']").val()+"\x26paymentMethodType\x3d"+g.find("input[name\x3d'paymentMethodType']").val()+"\x26rewardAccountId\x3d"+g.find("input[name\x3d'rewardAccountId']").val()+"\x26rewardAccountAmount\x3d"+f("#spc-points-input").val()+"\x26rewardAccountRate\x3d"+g.find("input[name\x3d'rewardAccountRate']").val()+"\x26useGCBalance\x3d"+k+"\x26usePromoBalance\x3d"+k+"\x26returnFullHTML\x3d1\x26returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+
f("input[name\x3duseCtb]").val();d.isBRMarketplaceCurrencyFormatEnabled()&&(c="paymentMethodId\x3d"+g.find("input[name\x3d'paymentMethodId']").val()+"\x26paymentMethodType\x3d"+g.find("input[name\x3d'paymentMethodType']").val()+"\x26rewardAccountId\x3d"+g.find("input[name\x3d'rewardAccountId']").val()+"\x26rewardAccountAmount\x3d"+f("#spc-points-input").val().replaceAll(",",".")+"\x26rewardAccountRate\x3d"+g.find("input[name\x3d'rewardAccountRate']").val()+"\x26useGCBalance\x3d"+k+"\x26usePromoBalance\x3d"+
k+"\x26returnFullHTML\x3d1\x26returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+f("input[name\x3duseCtb]").val())}f.ajax({type:"POST",url:b,data:c,dataType:"text",async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",headers:a,success:function(a,b,c){c.getResponseHeader("x-amz-checkout-page")?e.ajaxUpdatePage(a,b,c):(a=n.jsonify(a),e.redirect(a))},error:function(a,b,c){e.ajaxRedirect(a,b,c)}})}}function p(a){var b=!1,c=f("input[name\x3drewardAccountAmount]"),
d=f("#inline-points-error-block");a||f("#spc-points-input")&&!f("#spc-points-input").hasClass("show-currency-input-widget-new")?(a&&(c=f("input[name\x3dloyaltyPointsValue]"),d=f("#loyalty-points-error")),d.hide(),d.find("p").hide(),u(c))?q(c,a)?x(c,a)||(d.find("p").filter(function(){return"badMax"===f(this).data("error")}).show().css("display","inline"),b=!0):(d.find("p").filter(function(){return"badMin"===f(this).data("error")}).show().css("display","inline"),b=!0):(d.find("p").filter(function(){return"badValue"===
f(this).data("error")}).show().css("display","inline"),b=!0):a||q(c,a)||(d.find("p").filter(function(){return"badMin"===f(this).data("error")}).show().css("display","inline"),b=!0);if(b)return d.show(),c.addClass("a-form-error"),!1;c.removeClass("a-form-error");return!0}function r(a,b){var c=f(a.currentTarget),e=c.val();d.isBRMarketplaceCurrencyFormatEnabled()&&(e=e.includes(".")?e.replaceAll(".",","):e.replaceAll(",","."));a=f("#inline-raw-points");b&&(a=f("#loyalty-points-applied-value"));var k=
a.html();if(b)!/^\s*$/.test(e)&&!isNaN(e)&&0<e?a.html(e):a.html(0);else if(!f("#spc-points-input").hasClass("show-currency-input-widget-new")){var h=c.data("min-dollar-amount");!/^\s*$/.test(e)&&!isNaN(e)&&0<e&&!isNaN(h)&&e>=h?(h=c.data("conversion-ratio"),c=c.data("decimal-places"),c=d.isBRMarketplaceCurrencyFormatEnabled()?g.getNumberWithSeparators(e/h,c).replaceAll(".","z").replaceAll(",",".").replaceAll("z",","):g.getNumberWithSeparators(e/h,c),a.html(c)):a.html(0)}(b||f("#points-applied").is(":visible"))&&
k!==a.html()&&(a=f("#spc-loyalty-points-display"),k=f("#loyalty-points-applied"),c=f("#loyalty-points-button"),e=!1,b||(a=f("#inline-points-button"),a.is("span")&&(e=!0),k=a.find("span.apply"),c=a.find("span.change"),f("#points-applied").hide()),k.hide(),c.show(),e?a.css("display","inline-block"):a.show())}function u(a){a=a.val();d.isBRMarketplaceCurrencyFormatEnabled()&&(a=a.includes(".")?a.replaceAll(".",","):a.replaceAll(",","."));return/^\s*$/.test(a)||!isNaN(a)}function q(a,b){if(b)return!0;
b=a.val();d.isBRMarketplaceCurrencyFormatEnabled()&&(b=b.includes(".")?b.replaceAll(".",","):b.replaceAll(",","."));if(/^\s*$/.test(b))return!0;b=parseFloat(b);return isNaN(b)||!a.data("min-dollar-amount")?!0:0===b||b>=a.data("min-dollar-amount")}function x(a,b){var c=a.val();d.isBRMarketplaceCurrencyFormatEnabled()&&(c=c.includes(".")?c.replaceAll(".",","):c.replaceAll(",","."));if(/^\s*$/.test(c))return!0;var c=parseFloat(c),e=a.data("max-dollar-amount");b&&(e=a.data("available-points"));return isNaN(c)||
!e?!0:c<=e}function z(a){switch(a.keyCode?a.keyCode:a.which){case 13:case 10:var b=f("#loyalty-points-button"),d=f("#spc-points-input");0<b.length&&b.is(":visible")?c(a,1):0<d.length&&c(a,0)}}var f=a.$;f("html").hasClass("a-ie6")||(f(document).delegate("#spc-loyalty-points-input","keypress",function(a){z(a)}),f("#spc-points-input")&&!f("#spc-points-input").hasClass("show-currency-input-widget-new")&&(f(document).delegate("#spc-points-input","keypress",function(a){z(a)}),f(document).delegate("#spc-points-input",
"keyup",function(a){r(a,0)})),f(document).delegate("#spc-loyalty-points-input","keyup",function(a){r(a,1)}),f(document).delegate("#inline-points-button","click",function(a){c(a,0)}),f(document).delegate("#loyalty-points-button","click",function(a){c(a,1)}),a.on("a:expander:apply-point-expander:toggle:expand",function(a){h.increaseCount("checkout:spp-payment:expand_addswp_coll",1)}),a.on("checkout:reload:spc",k),a.on("checkout:reload:spp-revieworder",k))});"use strict";q.when("A","client-side-metrics",
"ready").execute(function(a,m){var n=a.$;a.on("checkout:reload:spc",function(){var a=n("input[name\x3d'rewardsProgramId']").val(),g=n("input[name\x3d'swpWidgetCase']").val();a&&g&&m.increaseCount("Checkout::SPC::SWPWidgetCSM::"+a+"::"+g,1)})});"use strict";q.when("A","page-transition-controller","ajax-utility","page-conductor").register("inline-fps-balance-controller",function(a,m,n,e){function g(a){a.preventDefault();l("#inline-fps-balance-checkbox").prop("disabled","disabled");e.isSPP()?(m.blockAllActions(),
m.showTransitionInContainer(l("#payment"))):m.show();var b=l("#inline-fps-balance-hidden-fields"),d=0;l("#inline-fps-balance-checkbox").prop("checked")&&(d=1);a=e.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});var g="/gp/buy/pipeline/handlers/update-fps-balance.html/ref\x3d"+(e.isSPP()?"chk_pay_"+(d?"apply":"remmove")+"_fps_balance_coll":"ox_spc_page_fps_balance_apply"),b="fpsPaymentMethodId\x3d"+b.find("input[name\x3d'fpsPaymentMethodId']").val()+"\x26useFlexiblePayments\x3d"+d+"\x26returnFullHTML\x3d1\x26returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+
l("input[name\x3duseCtb]").val();l.ajax({type:"POST",url:g,data:b,dataType:"text",async:!0,cache:!1,headers:a,success:function(a,b,d){d.getResponseHeader("x-amz-checkout-page")?e.ajaxUpdatePage(a,b,d):(a=n.jsonify(a),e.redirect(a))},error:function(a,b,d){e.ajaxRedirect(a,b,d)}})}var l=a.$;l("html").hasClass("a-ie6")||l(document).delegate("#inline-fps-balance-checkbox","click",function(a){g(a)})});"use strict";q.when("A","page-transition-controller","ajax-utility","page-conductor","checkout-general-utils",
"error-feature-detection","page-detector","client-side-metrics","weblab-helper","a-modal").register("shipping-speed-selection-controller",function(a,m,n,e,g,l,h,b,d,k){function c(){y?B("fieldset div.a-radio").addClass("a-touch-radio"):a.defer(function(){var a=B("#spc-orders").find("div.ship-option");a.filter(".no-scheduled-delivery");a.each(function(){B(this).find("input.radio-image").remove()});a.each(function(){var a=B(this).find("input.radio-standard");a.attr("checked")&&a.attr("checked",!0)})});
ba=B("#spc-orders").find("div.ship-option").find('input[type\x3d"radio"]:checked');ma=ba.attr("value");p();l.markFeatureAvailable("shipping-speed-selection-controller");D()}function p(){var a=0<B("#trigger-case-call-to-resolve-cv").length||0<B(".force-resolve-invalid-ship-option").length;if(e.isSPP()&&a){var a=function(){var a=r.setInterval(function(){e.isAnimating()||(m.show(),r.clearInterval(a))},50)},b=B("div.ship-option").filter(".call-set-to-resolve-cv").first().find("input[type\x3d'radio']");
if(b&&b.length){var c=b.parents(".shipping-speeds").find("input.lineitemidinput[type\x3dhidden]").val();S(b,null,null,{transitionAction:a,refTag:"chk_revieworder_set_ship_option_no_default",extraData:{callingCASEResolveCV:1,lineItemIds:c}})}}}function D(){B("#buy-button-disabled-state").length&&u(function(a){w(a)})}function u(a){B("div.sd-widgets").each(function(b,c){a(c)})}function w(a){var b=setInterval(B.proxy(function(){if(B(this).hasClass("sd_widget_initialized")){var a=B(this),c=B(a).attr("id");
c&&(a=x(a),a["ScheduledDeliveryEntity.startDeliveryDate"]&&S(null,c,a));r.clearInterval(b)}},a),1E3)}function x(a){var b={};z(a,function(a){var c=B(a).attr("key");a=B(a).val();b[c]=a||""});return b}function z(a,b){B(a).find("input[type\x3d'hidden']").each(function(a,c){b(c)})}function f(a){return d.isExcludeMdwFromGoldenCXWidgetRenamingWeblabEnabled()?!(a&&a[0]&&a[0].classList&&a[0].classList.contains("sd-mdw-widget-root")):!0}function t(){Y||(Y=B("input[type\x3d'hidden'][name\x3d'scopeId']").val());
return Y}function J(a,b,c){if(c.getResponseHeader("x-amz-checkout-page")){var f=n.jsonify(a);return f&&f.success&&f.trialkey&&Z[f.trialkey]?(a=Z[f.trialkey],e.isSPP()&&"object"===typeof a&&(a=JSON.stringify(Z[f.trialkey])),d.isSPCMobileDisplayMoreShipOptionsEnabled()&&0<B(".mobile-view").length?e.ajaxUpdatePage(a,b,c,{pushNewFrame:"false"}):e.ajaxUpdatePage(a,b,c),ca&&(clearTimeout(ca),ca=null),Z={},!0):d.isSPCMobileDisplayMoreShipOptionsEnabled()&&0<B(".mobile-view").length?e.ajaxUpdatePage(a,b,
c,{pushNewFrame:"false"}):e.ajaxUpdatePage(a,b,c)}return e.redirect(a)}function v(a,b){if(a){var c=a.data(b);if(c!==H)return c;(a=a.closest(".radio-standard"))&&(c=a.data(b));return c}}function C(a){a.closest("fieldset").find("i.a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");a.siblings("i").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive")}function A(a){var b=a;B(".shipping-group").each(function(a,c){var d=
!1;B(c).parents().each(function(a,b){return B(b).hasClass("shipment")?(d=!0,!1):!0});d||(b=b.add(c))});return b}function M(a,b,c){var e="",g=0;1<a.length&&(e+="\x26forcesetbylineitem\x3d1");a.each(function(k,h){var l=B(h),p="",m=l.data("orderid"),n=l.has(".prime-calendar-container"),r=l.find("input[name\x3d'currentshippingspeed']").attr("value"),u=l.find("input[name\x3d'currentshipsplitpreference']").attr("value");1===a.length&&(e+="\x26oldoption\x3d"+r+"."+u);var t=l.find("input[name\x3d'defaultshipsplitpreference."+
m+"']").attr("value"),q=l.find("input[name\x3d'usingprimeshipping."+m+"']").attr("value");t&&q&&(p+="\x26defaultshipsplitpreference."+g+"\x3d"+t,p+="\x26usingprimeshipping."+g+"\x3d"+q);t=l.find(".shipping-speed");t=b?t.find('input[type\x3d"radio"]:checked'):t.find("input[src*\x3dradio-on]");n&&!t.length&&(t=l.find("input[name\x3d'hiddenSelection"+m+"']"));q=l.find(".ship-split-preferences").find("input[type\x3d'radio']:checked");1!==q.length&&(q=l.find(".ship-split-preferences").find("input[type\x3d'hidden'][name^\x3d'shippriority']"));
c===l.data("orderid")&&(v(b,"shippingofferingid")?t=b:q=b,1===a.length&&(p=n?p+("\x26option\x3d"+t.data("key")+"."+(q?q.attr("value"):"")):p+("\x26option\x3d"+t.attr("value")+"."+(q?q.attr("value"):""))));var y=l.find("input[name\x3d'lineitemids"+m+"']");0<y.length&&(p+="\x26lineitemids"+g+"\x3d"+y.attr("value"));d.isSecureUnifiedDeliveryEnabled()&&(y=l.find("input[name\x3d'issecureunifieddelivery"+m+"']"),0<y.length&&(p+="\x26issecureunifieddelivery"+g+"\x3d"+y.attr("value")));var y=l.find("input[name\x3d'onOrAfterAppointment"+
m+"']").val(),z=l.find("input[name\x3d'onOrAfterLineItemId"+m+"']").val(),w="";y&&z&&(w+="\x26onOrAfterAppointment"+g+"\x3d"+y,w+="\x26onOrAfterLineItemId"+g+"\x3d"+z);p+=w;if(t.length)p+=X(t,q,g,n),1===v(t,"isscheduleddelivery")?(h=t.closest(".shipping-speed").find('[id^\x3d"sd_widgets_"]'),d.isScheduleDeliveryHiddenInputIdFixEnabled()?(f(h)&&(h=B("#sd-widgets-"+m)),k=h.children(":input").serialize(),h.length&&(m=h.get(0).id.substring(11),h=m.replace(/^(\d+)(-)?/,function(a,b,c){return g+(c?c:"")}),
k=k.replaceAll(m+"\x3d",h+"\x3d"),k=k.replace(/(SD-OrderID-\d+=)\d+/,"$1"+g),k=k.replace(/(SDV1-orderId-\d+=)\d+/,"$1"+g)),p+="\x26"+k):(f(h)&&(h=B("#sd-widgets-"+k)),p+="\x26"+h.children(":input").serialize())):1===v(t,"isscheduleddeliveryslot")&&v(t,"sddatastring")&&(p+="\x26ScheduledDeliveryEntity.data."+g+"\x3d"+encodeURIComponent(t.data("sddatastring"))),"rush-ispu"===t.attr("value")&&(p+=L(l,g,q));else if(P(l))p+=G(l,g,r,u);else{if(l.find("[data-action\x3d'checkout-select-ship-option-radio'").length)return;
d.isRemoveDigitalFlagForScheduledDeliveryShipmentEnabled()&&"1"===B(h).find("input[type\x3d'hidden'][name\x3d'previousSDSelected"+g+"']").attr("value")||(p+="\x26isdigital"+g+"\x3d1")}g++;e+=p});0<g&&(e+="\x26groupcount\x3d"+g);return e}function S(a,c,k,h){y&&C(a);h&&h.transitionAction?h.transitionAction():m.show();for(var l in da)da.hasOwnProperty(l)&&(da[l].abort(),delete da[l]);k=B("#spc-orders").find("input[type\x3d'hidden'][name\x3d'shiptrialprefix']").val();var p;a||(a=B("#"+c).closest(".shipping-speed").find("input[type\x3d'radio']"));
a.attr("value")!==ma&&(b.increaseCount("checkout:spc:shipoption:change",1),ma=a.attr("value"));p=a.closest(".shipment").data("orderid");a&&a.length&&a.hasClass("valid-btn")&&a.closest(".prime-calendar").hasClass("long-calendar")&&(p=a.closest(".prime-calendar").data("orderid"));var n="returnpipedata\x3d0\x26returnFullHTML\x3d1\x26cachebuster\x3d"+(new Date).getTime()+"\x26hasWorkingJavascript\x3d1";if(h&&h.extraData)for(var r in h.extraData)h.extraData.hasOwnProperty(r)&&(n+="\x26"+r+"\x3d"+h.extraData[r]);
var u=B(".shipment"),q=0;c=u.length;u=A(u);n+="\x26groupsadded\x3d"+(u.length-c);d.isSkipZeroShippingSpeedShipmentEnabled()?n+=M(u,a,p):(u.each(function(b,c){var e=B(c),g="",k=e.has(".prime-calendar-container"),h=e.find("input[name\x3d'currentshippingspeed']").attr("value"),l=e.find("input[name\x3d'currentshipsplitpreference']").attr("value");1===u.length&&(n+="\x26oldoption\x3d"+h+"."+l);var m=e.find("input[name\x3d'defaultshipsplitpreference."+q+"']").attr("value"),r=e.find("input[name\x3d'usingprimeshipping."+
q+"']").attr("value");m&&r&&(n+="\x26defaultshipsplitpreference."+q+"\x3d"+m,n+="\x26usingprimeshipping."+q+"\x3d"+r);m=e.find(".shipping-speed");m=a?m.find('input[type\x3d"radio"]:checked'):m.find("input[src*\x3dradio-on]");k&&!m.length&&(m=e.find("input[name\x3d'hiddenSelection"+q+"']"));r=e.find(".ship-split-preferences").find("input[type\x3d'radio']:checked");1!==r.length&&(r=e.find(".ship-split-preferences").find("input[type\x3d'hidden'][name^\x3d'shippriority']"));p===e.data("orderid")&&(v(a,
"shippingofferingid")?m=a:r=a,1===u.length&&(g=k?g+("\x26option\x3d"+m.data("key")+"."+(r?r.attr("value"):"")):g+("\x26option\x3d"+m.attr("value")+"."+(r?r.attr("value"):""))));var t=e.find("input[name\x3d'lineitemids"+q+"']");0<t.length&&(g+="\x26lineitemids"+q+"\x3d"+t.attr("value"));d.isSecureUnifiedDeliveryEnabled()&&(t=e.find("input[name\x3d'issecureunifieddelivery"+q+"']"),0<t.length&&(g+="\x26issecureunifieddelivery"+q+"\x3d"+t.attr("value")));g+=aa(e,q);m.length?(g+=X(m,r,q,k),1===v(m,"isscheduleddelivery")?
(c=m.closest(".shipping-speed").find('[id^\x3d"sd_widgets_"]'),f(c)&&(c=B("#sd-widgets-"+b)),g+="\x26"+c.children(":input").serialize()):1===v(m,"isscheduleddeliveryslot")&&v(m,"sddatastring")&&(g+="\x26ScheduledDeliveryEntity.data."+q+"\x3d"+encodeURIComponent(m.data("sddatastring"))),"rush-ispu"===m.attr("value")&&(g+=L(e,q,r))):P(e)?g+=G(e,q,h,l):d.isRemoveDigitalFlagForScheduledDeliveryShipmentEnabled()&&"1"===B(c).find("input[type\x3d'hidden'][name\x3d'previousSDSelected"+q+"']").attr("value")||
(g+="\x26isdigital"+q+"\x3d1");q++;n+=g}),0<q&&(n+="\x26groupcount\x3d"+q));c="ox_spc_set_ship_option";e.isSPP()&&(c="chk_revieworder_set_ship_option",r=B("#setOrderingPrefsCheckbox"),r.length&&r.is(":checked")&&(n+="\x26saveAsDefaultsSelected\x3d1"));r=B("input[name\x3duseCtb]").val();n+="\x26isClientTimeBased\x3d"+r;1===v(a,"istrial")?(k=t()+":"+a.attr("name")+":"+a.attr("value"),n+="\x26trialkey\x3d"+k,Z[k]&&(ca&&clearTimeout(ca),c="ox_spc_set_cached_ship_option",e.isSPP()&&(c="chk_revieworder_set_cached_ship_option"),
n=n.replace("returnFullHTML\x3d1","returnFullHTML\x3d0"),n+="\x26trialSuccess\x3d1")):"undefined"!==typeof k&&(k=k+":"+a.attr("name")+":"+a.attr("value"),n+="\x26trialkey\x3d"+k);h&&h.refTag&&(c=h.refTag);h&&h.removeGiftOption&&(n+="\x26giftOrderid\x3d"+a.closest(".shipment").data("orderid"));0===n.indexOf("\x26")&&(n=n.substr(1));h="/gp/buy/spc/handlers/set-delivery-options.html/ref\x3d"+c;k=e.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});d.isSPCMobileDisplayMoreShipOptionsEnabled()&&0<
B(".mobile-view").length&&(k=e.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"}));B.ajax({type:"POST",url:h,data:n,dataType:"text",async:!0,cache:!1,headers:k,success:function(a,b,c){J(a,b,c);g.nukeDropdowns("#b2brd-cadence-dropdown")},error:function(a,b,c){e.ajaxRedirect(a,b,c)}})}function P(a){return d.isVasTrueSPCEnabled()?"1"===B.trim(a.data("iahiddenshipment"))||0<a.find(".vas-scheduling-prefBlock").length:0<a.find(".vas-scheduling-prefBlock").length}function G(a,
b,c,d){var e;e=""+("\x26shippingofferingid"+b+"\x3d"+a.find("input[type\x3d'hidden'][name^\x3d'shippingofferingid']").val());e+="\x26guaranteetype"+b+"\x3d"+a.find("input[type\x3d'hidden'][name^\x3d'guaranteetype']").val();e+="\x26issss"+b+"\x3d"+a.find("input[type\x3d'hidden'][name^\x3d'issss']").val();e+="\x26forceshipsplitpreference"+b+"\x3d"+a.find("input[type\x3d'hidden'][name^\x3d'forceshipsplitpreference']").val();return e+("\x26shippingspeed"+b+"\x3d"+c)+("\x26shippriority"+b+"\x3d"+d)}function L(a,
b,c){var d;d=""+("\x26preferredSSP"+b+"\x3d"+a.find("input[type\x3d'hidden'][name^\x3d'shipsplitpriority']").val());d+="\x26currentSSP"+b+"\x3d"+c.attr("value");"shipWhenever"==a.find("input[name\x3d'ispuShipSplitPriority']").attr("value")&&(d=d+("\x26isShipWheneverValid"+b+"\x3d1")+("\x26isShipWhenCompleteValid"+b+"\x3d0"));return d}function V(a,b){y&&C(a);a=b.find("input[name\x3d'ispuLoadingText']").attr("value");if(e.isSPP()&&a){var c=B("#shipaddress");c&&c.length&&(c.hasClass("expanded")?m.show():
(m.shrinkPanel(B(".spp-panel.expanded"),!1),m.shrinkPanel(c,!0,a)))}else m.show();a="returnpipedata\x3d0\x26returnFullHTML\x3d1\x26cachebuster\x3d"+(new Date).getTime()+"\x26hasWorkingJavascript\x3d1";var c=b.find("input[name\x3d'storeAddressID']").attr("value"),d=b.find("input[name\x3d'storeId']").attr("value"),f=b.find("input[name\x3d'storeOwnerId']").attr("value"),g=b.find("input[name\x3d'lineItemsQuantity']").attr("value"),k=b.find("input[name\x3d'destinationType']").attr("value"),h=b.find("input[name\x3d'ispuShippingOfferingId']").attr("value"),
l=b.find("input[name\x3d'ispuShipSplitPriority']").attr("value"),p=b.find("input[name\x3d'ispuGuaranteeType']").attr("value"),n=b.find("input[name\x3d'ispuPageType']").attr("value");a=a+("\x26storeId\x3d"+d)+("\x26storeAddressId\x3d"+c)+("\x26storeOwnerId\x3d"+f);a+="\x26lineItemsQuantity\x3d"+g;a+="\x26destinationType\x3d"+k;a+="\x26shippingOfferingId\x3d"+h;a+="\x26shipPriority\x3d"+l;a+="\x26guaranteeType\x3d"+p;a+="\x26pageType\x3d"+n;b=b.find("input[name\x3d'retailProgram']");b.length&&(a+="\x26retailProgram\x3d"+
b.attr("value"));b="chk_spc_ispu_ship_option";e.isSPP()&&(b="chk_revieworder_ispu_ship_option");b="/gp/buy/ispu/handlers/ispu-select-store.html/ref\x3d"+b;c=e.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});0<B(".mobile-view").length&&(c=e.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"}));B.ajax({type:"POST",url:b,data:a,dataType:"text",async:!0,cache:!1,headers:c,success:function(a,b,c){J(a,b,c)},error:function(a,b,c){e.ajaxRedirect(a,b,c)}})}function X(a,
b,c,d,e){var f="";"undefined"!==typeof e&&(c+="-"+e);if(v(a,"rcxsspdecoupling"))return f={},f["shippingspeed"+c]=d?a.attr("key"):a.attr("value"),f["shippingofferingid"+c]=v(a,"shippingofferingid"),f["guaranteetype"+c]=v(a,"guaranteetype"),f["issss"+c]=v(a,"issss"),f["forceshipsplitpreference"+c]=v(a,"forceshipsplitpreference"),d="shipWhenComplete",b&&(d=b.attr("value")),1===v(a,"isscheduleddelivery")&&(f["isscheduleddelivery"+c]="1",d="shipWhenComplete"),f["shippriority"+c]=d,f["preferredSSP"+c]=
v(a,"shipsplitpriority"),f["currentSSP"+c]=b.attr("value"),f["isShipWheneverValid"+c]=v(a,"isshipwhenevervalid"),f["isShipWhenCompleteValid"+c]=v(a,"isshipwhencompletevalid"),f=B.param(f),"\x26"+f;f=d?f+("\x26shippingspeed"+c+"\x3d"+a.data("key")):f+("\x26shippingspeed"+c+"\x3d"+a.attr("value"));f+="\x26shippingofferingid"+c+"\x3d"+v(a,"shippingofferingid");f+="\x26guaranteetype"+c+"\x3d"+v(a,"guaranteetype");f+="\x26issss"+c+"\x3d"+v(a,"issss");f+="\x26forceshipsplitpreference"+c+"\x3d"+v(a,"forceshipsplitpreference");
d="shipWhenComplete";b&&(d=b.attr("value"));1===v(a,"isscheduleddelivery")&&(f+="\x26isscheduleddelivery"+c+"\x3d1",d="shipWhenComplete");return f+("\x26shippriority"+c+"\x3d"+d)}function I(a){var b=[a.closest(".shipment").data("orderid")];U(a,b)}function T(a){var c=[];B("#spc-orders").find(".shipment").each(function(a,b){c.push(a)});b.increaseCount("checkout:spc:mobile:same-day-upsell-banner:clicked",1);U(a,c)}function U(a,b){m.show();var c="returnpipedata\x3d0\x26returnFullHTML\x3d1\x26cachebuster\x3d"+
(new Date).getTime()+"\x26hasWorkingJavascript\x3d1",d="/gp/buy/spc/handlers/set-delivery-options.html/ref\x3d"+a.data("reftag");B("#spc-orders").find(".shipment").each(function(d,e){c+="\x26lineitemids"+d+"\x3d"+B(e).find("input[type\x3d'hidden'][name\x3d'lineitemids"+d+"']").attr("value");c+=aa(B(e),d);var f=B(e).find("input[type\x3d'hidden'][name^\x3d'shippriority']");if(e=-1===b.indexOf(d)?B(e).find("#selected-ship-option-"+d):a)c+="\x26shippingofferingid"+d+"\x3d"+e.data("shippingofferingid"),
c+="\x26guaranteetype"+d+"\x3d"+e.data("guaranteetype"),c+="\x26issss"+d+"\x3d"+e.data("issss"),c+="\x26forceshipsplitpreference"+d+"\x3d"+e.data("forceshipsplitpreference"),c+="\x26shippriority"+d+"\x3d"+e.data("targetshipoptionkey"),e.data("rcxsspdecoupling")&&(c+="\x26preferredSSP"+d+"\x3d"+e.data("shipsplitpriority"),c+="\x26currentSSP"+d+"\x3d"+f.attr("value"),c+="\x26isShipWheneverValid"+d+"\x3d"+e.data("isshipwhenevervalid"),c+="\x26isShipWhenCompleteValid"+d+"\x3d"+e.data("isshipwhencompletevalid"))});
var f=B("#spc-orders").find("input[type\x3d'hidden'][name\x3d'groupcount']").val(),c=c+("\x26groupcount\x3d"+f),c=c+("\x26isClientTimeBased\x3d"+B("input[type\x3d'hidden'][name\x3d'useCtb']").attr("value")),c=c+("\x26trialkey\x3d"+t()+":"+a.data("orderindex")+":"+a.data("targetshipoptionkey")),f=e.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});B.ajax({type:"POST",url:d,data:c,dataType:"text",async:!0,cache:!1,headers:f,success:function(a,b,c){J(a,b,c)},error:function(a,b,c){e.ajaxRedirect(a,
b,c)}})}function W(b,c,e,f){g.protectAgainstDoubleAction(c)||d.isAmazonDayIncentiveDetailsLinkRedirectionEnabledOnStripeMsg()&&b.$target.is('a[target\x3d"PromoDetails"]')||ra||(a.trigger(e,b),b=b.$currentTarget.find("a"),f&&f(b))}function aa(a,b){var c=a.find("input[name\x3d'onOrAfterAppointment"+b+"']").val();a=a.find("input[name\x3d'onOrAfterLineItemId"+b+"']").val();var d="";c&&a&&(d=d+("\x26onOrAfterAppointment"+b+"\x3d"+c)+("\x26onOrAfterLineItemId"+b+"\x3d"+a));return d}function ha(){N.closest("div.shipping-speed").find('input[type\x3d"radio"]').attr("checked",
!0);"undefined"!==typeof k?(0<B(".mobile-view").length?k.get(B("#faster-than-same-day-sosp-popover")):k.get(B("#faster-than-same-day-spc-popover"))).hide():a.$("div.a-popover button.a-button-close").trigger("click");S(N,null,null,{removeGiftOption:!0})}var B=a.$;if(!B("html").hasClass("a-ie6"))if(r.spcpage){var Y,Z={},y=B("html").hasClass("a-touch"),ca,da={},ba,ma,N;r.spcpage.scheduledDeliverySetSOCallback=function(b,c){e.isSPP()&&a.objectIsEmpty(b)||(r.spcpage&&B("#spcpagecontent").is(":visible")?
r.spcpage.actionSetShipOptions(null,c,b):S(null,c,b))};r.spcpage.scheduledDeliverySetSOCallbackWithTarget=function(b,c,d){e.isSPP()&&a.objectIsEmpty(c)||(r.spcpage&&B("#spcpagecontent").is(":visible")?r.spcpage.actionSetShipOptions(null,d,c):S(b,d,c))};r.spcpage.scheduledDeliveryEnableSOCallback=function(){};r.spcpage.scheduledDeliveryMdwSetSOCallback=function(b,c,f){d.isSsdMdwEnabled()&&(e.isSPP()&&a.objectIsEmpty(c)||(r.spcpage&&B("#spcpagecontent").is(":visible")?r.spcpage.actionSetShipOptions(null,
f,c):S(b,f,c)))};r.spcpage.secureDeliverySetSOCallback=function(a,b){d.isSecureUnifiedDeliveryEnabled()&&S(a,null,null,b)};B(document).delegate(".ship-option","click",function(c){var e=B(c.target);d.isSPCMobileDisplayMoreShipOptionsEnabled()&&B(c.target).closest(".ship-option").hasClass("mobile-view")&&"a-link-normal"!==c.target.parentNode.parentNode.className&&c.preventDefault();var f=B(c.currentTarget);b.resetMetrics();if(!e.is('a[target\x3d"AmazonHelp"]')&&!e.is('a[target\x3d"PromoDetails"]')&&
!e.hasClass("no-ship-option-selection-change"))if(d.isAmazonDayDatePickerClickSkipShipOptionChangeEnabled()&&e.closest(".no-ship-option-selection-change").length)c.preventDefault();else if(!(f.is("input")||e.hasClass("a-button")||e.closest("a-button").length||e.is("img")&&(e.closest("div").is(".prime-ship-speed")||e.closest(".prime-fake-radio").parent().is(".prime-ship-speed"))))if(e=f.find("div.prime-ship-speed"),0<e.length)e.find("a:first img").trigger("click");else if((e=f.find("input[type\x3d'image']").attr("src"))&&
e.match(/radio-off/)&&B(".ap_popover_sprited").hide(),f=f.find("input[type\x3d'radio']"),(e=f.closest("div.shipping-speeds").data("sospargs"))&&1===f.data("isscheduleddelivery")&&!f.is(":checked"))m.show(),f.attr("checked",!0),C(f),g.redirectWithJavascript("/gp/buy/shipoptionselect/handlers/display.html?"+e);else if(d.removesGiftOptionOnRush()&&0<f.closest(".shipment").find("input[name^\x3dItemIsGift]").length&&1===f.closest(".radio-standard").data("nosupportforgiftoption")){N=f;N.is(":checked")&&
(N.attr("checked",!1),ba.attr("checked",!0));var l=0<B(".mobile-view").length?B("#faster-than-same-day-sosp-popover"):B("#faster-than-same-day-spc-popover");"undefined"!==typeof k?k.get(l).show():a.delay(function(){l.trigger("click")},10)}else if(f.hasClass("js-no-serverside-callback")&&(f.attr("checked",!0),C(f),f.closest(".a-section-expander-container").find(".a-link-section-expander").click()),!d.isSsdMdwEnabled()||1!==f.closest(".radio-standard").data("callcaseforsdoverride"))if(1!==v(f,"isscheduleddelivery")||
!h.isDesktopSpc()){var e=B("#disableSubmitButtons").length,p=!1;d.isSPCMobileDisplayMoreShipOptionsEnabled()&&(c=B(c.currentTarget).closest(".ship-option"),c.hasClass("mobile-view")&&!c.hasClass("mobile-selected-option")&&(p=!0));!e&&f.is(":checked")&&!p||1===f.data("isscheduleddelivery")||(f.attr("checked",!0),S(f))}});B(document).delegate(".ship-option input[type\x3d'radio']","change",function(a){if(!d.isSPCMobileDisplayMoreShipOptionsEnabled()||!B(a.target).closest(".ship-option").hasClass("mobile-view")){a=
B(a.currentTarget);var b=a.closest("div.prime-ship-speed");d.removesGiftOptionOnRush()&&0<a.closest(".shipment").find("input[name^\x3dItemIsGift]").length&&1===a.closest(".radio-standard").data("nosupportforgiftoption")||d.isSsdMdwEnabled()&&1===a.closest(".radio-standard").data("callcaseforsdoverride")||1===v(a,"isscheduleddelivery")&&h.isDesktopSpc()||(0<b.length?b.find('input[type\x3d"radio"]').attr("checked",!1):1!==a.data("isscheduleddelivery")&&S(a))}});B(document).delegate(".ispu-ship-option",
"click",function(a){if(d.isISPUMasterEnabled()){B(a.target).closest(".ispu-ship-option").hasClass("mobile-view")&&a.preventDefault();B(a.target);var c=B(a.currentTarget);b.resetMetrics();var e=c.find("input[type\x3d'radio']"),f=!1;a=B(a.currentTarget).closest(".ispu-ship-option");a.hasClass("mobile-view")&&!a.hasClass("mobile-selected-option")&&(f=!0);if(!e.is(":checked")||f)e.attr("checked",!0),V(e,c)}else b.increaseCount("checkout:ispu:selection:weblab:disabled",1)});B(document).delegate(".ispu-ship-option input[type\x3d'radio']",
"change",function(a){if(!d.isISPUMasterEnabled())b.increaseCount("checkout:ispu:selection:weblab:disabled",1);else if(!B(a.target).closest(".ispu-ship-option").hasClass("mobile-view")){a=B(a.currentTarget);var c=a.closest(".ispu-ship-option");V(a,c)}});B(document).delegate(".rush-ispu-ship-option","click",function(a){if(d.isRushISPUMasterEnabled()){B(a.target).closest(".rush-ispu-ship-option").hasClass("mobile-view")&&a.preventDefault();B(a.target);var c=B(a.currentTarget);b.resetMetrics();var e=
c.find("input[type\x3d'radio']"),f=!1;a=B(a.currentTarget).closest(".rush-ispu-ship-option");a.hasClass("mobile-view")&&!a.hasClass("mobile-selected-option")&&(f=!0);if(!e.is(":checked")||f)e.attr("checked",!0),V(e,c)}else b.increaseCount("checkout:rushIspu:selection:weblab:disabled",1)});B(document).delegate(".rush-ispu-ship-option input[type\x3d'radio']","change",function(a){if(!d.isRushISPUMasterEnabled())b.increaseCount("checkout:rushIspu:selection:weblab:disabled",1);else if(!B(a.target).closest(".rush-ispu-ship-option").hasClass("mobile-view")){a=
B(a.currentTarget);var c=a.closest(".rush-ispu-ship-option");V(a,c)}});B(document).delegate(".rush-ispu-view-details-link","click",function(a){a.preventDefault();a.stopPropagation()});B(document).delegate(".mfn-ispu-view-details-link","click",function(a){a.preventDefault();a.stopPropagation()});a.declarative("shipping-speed-expander-toggle",["click"],function(a){var b=a.$target.closest(".a-box"),c,d;b.hasClass("a-single")?(c=b.find(".expanded-header-content"),d=b.find(".collapsed-header-content"),
d.hide(),c.hasClass("prime-title")&&c.find("div").attr("style",""),c.show()):(d=b.find(".collapsed-header-content"),c=b.find(".expanded-header-content"),b=b.siblings(".a-expander-content").find(".a-icon-touch-radio-active").siblings(".a-radio-label").html(),d.html(b),c.hide(),d.show());g.toggleExpanderContent(a)});a.declarative("select-prime-slot",["click"],function(a){a=a.$currentTarget;B(".a-button-close").trigger("click");a.closest(".valid-slot").hasClass("selected-slot")||S(a)});var ra=!1;B(document).delegate(".mobile-upsell",
"touchmove",function(a){ra=!0});B(document).delegate(".mobile-upsell","touchstart",function(a){ra=!1});a.declarative("select-upsell-shipping-speed",["click","touchend"],function(a){W(a,"select-upsell-shipping-speed","a:checkout:mobile-upsell-shipping-speed:select",I)});a.declarative("select-all-upsell-shipping-speed",["click","touchend"],function(a){W(a,"select-all-upsell-shipping-speed","a:checkout:mobile-upsell-shipping-speed:select-all",T)});a.declarative("faster-than-same-day-save",["click"],
ha);a.declarative("faster-than-same-day-sosp-save",["click"],ha);a.on("checkout:reload:spc",c);a.on("checkout:reload:spp-revieworder",c)}else q.log("window.spcpage undefined, shipping-speed-selection-controller not initialized","WARN","ship-speed")});"use strict";q.when("A","page-detector","spc-page-state","client-side-metrics","page-conductor","page-transition-controller","weblab-helper").register("order-summary-controller",function(a,m,n,e,g,l,h){function b(){C=f("#transactionalRadio");A=f("#marketplaceRadio");
J=f("#tfx-see-exchange-rates");v=f("#tfx-switch-currency-options");t||(e.increaseCount("removeauijs15"),f("#transactionalRadioImage").remove(),f("#marketplaceRadioImage").remove(),f("#acceptAccImage").remove());var a=f("#exchange-rate-link"),b=f("#switch-currency-link");if(0!==A.length){var g=v.find('input[name\x3d"switchCurrency"]'),k=g.not(":checked"),g=n.prop("currencyType")||g.filter(":checked").val();k.val()===g?k.trigger("click"):c(g);t||(e.increaseCount("removeauijs16"),a.find("i.a-icon-collapse").remove(),
b.find("i.a-icon-collapse").remove())}d(x());f("#currencyConverterFooter").find("*[disabled\x3d'']").prop("disabled",!1)}function d(a){if(0!==f("#currencyConverterFooter").length){f("input[name\x3dcurrentViewId]").val(a.attr("id"));var b=a.find("input[name\x3dgurupaFxCurrencyChoice]").val();f("input[name\x3d'fxCurrencyChoice']").val(b);b=f("input[name\x3d'fxApplicabilityChoice']");if(0!==b.length){var c=a.find("input[name\x3dgurupaFxApplicabilityChoice]").val();b.val(c)}b=a.find("input[name\x3dselectedCurrencyOption]").val();
f("input[name\x3d'currentCurrencyOption']").val(b);b=f("input[name\x3d'currentTnCOption']");0!==b.length&&(c=a.find("input[name\x3dselectedTnCOption]").val(),b.val(c));b=a.find("input[name\x3dplaceYourOrderButtonText]").val();f(".place-your-order-button").val(b);t&&(g.isSPP()?f(".place-order-button-text"):f(".place-your-order-button + span")).text(b);var b=a.find("input[name\x3d'selectedCurrencyOption']").val(),c=f("#subtotals-marketplace-table"),d=f("#subtotals-marketplace-spp-bottom"),e=f("#vatRetailSubtotals-marketplace-table"),
h=f("#vatGlobalSubtotals-marketplace-table"),l=f("#vatMerchantSubtotals-marketplace-table"),p=f("#subtotals-transactional-table"),m=f("#subtotals-transactional-spp-bottom"),n=f("#vatRetailSubtotals-transactional-table"),r=f("#vatGlobalSubtotals-transactional-table"),q=f("#vatMerchantSubtotals-transactional-table");"LOCAL"===b?(k("transactional"),p.show(),m.show(),n.show(),r.show(),q.show(),c.hide(),d.hide(),e.hide(),h.hide(),l.hide()):"MARKETPLACE"===b&&(k("marketplace"),p.hide(),m.hide(),n.hide(),
r.hide(),q.hide(),c.show(),d.show(),e.show(),h.show(),l.show());b=f("#ACCB_GIFT_CARD_ORDER_SUMMARY_POLICY_MESSAGE");0!==b.length&&("LOCAL"===a.find("input[name\x3d'currencyOptions']:checked").val()?b.show():b.hide());f("#tfx-header").hide()}}function k(a){h.isTFXGuaranteedExchangeFeeEnabled()||(a="marketplace");f(".tfx-currency").each(function(){f(this).text(f(this).data(a))})}function c(b){k(b);n.prop("currencyType",b);var c=f("#subtotals-marketplace-table"),d=f("#subtotals-transactional-table"),
h=f("#subtotals-marketplace-spp-bottom"),l=f("#subtotals-transactional-spp-bottom"),p=f("#vatRetailSubtotals-transactional-table"),r=f("#vatGlobalSubtotals-transactional-table"),q=f("#vatMerchantSubtotals-transactional-table"),u=f("#vatRetailSubtotals-marketplace-table"),z=f("#vatGlobalSubtotals-marketplace-table"),v=f("#vatMerchantSubtotals-marketplace-table"),x=f(".place-your-order-button"),D=f("#fx-enable"),B=g.isSPP()?f(".place-order-button-text"):f(".place-your-order-button + span");g.isSPP()||
setTimeout(function(){var a=Math.max(c.outerHeight(),d.outerHeight());0<a&&(c.height(a),d.height(a))},500);if(!t){e.increaseCount("removeauijs17");var Y=A.siblings("i"),Z=C.siblings("i");if(Y.hasClass("a-icon-touch-radio-inactive")||Y.hasClass("a-icon-touch-radio-active"))"marketplace"===b?(Y.removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active"),Z.removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive")):(Z.removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active"),
Y.removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive"))}"marketplace"===b?(f("#fxGoodNews-transactional").hide(),f("#fxGoodNews-marketplace").show(),d.hide(),c.show(),l.hide(),h.show(),p.hide(),r.hide(),q.hide(),u.show(),z.show(),v.show(),J&&J.hide(),D&&D.hide(),x.val(f("#placeYourOrderTextMarketplace").val()),w()&&f("#ACCB_GIFT_CARD_ORDER_SUMMARY_POLICY_MESSAGE").hide(),t&&B.text(f("#placeYourOrderTextMarketplace").val()),f("#currencyChanged").attr("value","true"),f("#fxCurrencyChoice").attr("value",
"marketplace"),f("#tfx-total-header").addClass("aok-hidden"),f("#mkt-total-header").removeClass("aok-hidden")):(f("#fxGoodNews-transactional").show(),f("#fxGoodNews-marketplace").hide(),c.hide(),d.show(),h.hide(),l.show(),u.hide(),z.hide(),v.hide(),p.show(),r.show(),q.show(),J&&J.show(),D&&D.show(),x.val(f("#placeYourOrderTextTransactional").val()),w()&&f("#ACCB_GIFT_CARD_ORDER_SUMMARY_POLICY_MESSAGE").show(),t&&B.text(f("#placeYourOrderTextTransactional").val()),f("#currencyChanged").attr("value",
"false"),f("#fxCurrencyChoice").attr("value","transactional"),f("#mkt-total-header").addClass("aok-hidden"),f("#tfx-total-header").removeClass("aok-hidden"));a.trigger("checkout:spc:ordersummary:sizeChanged");m.isMobileSpc()&&(h=f("#vatBreakdownNote"),0<h.size()&&(l=h.attr("href"),l=0<l.lastIndexOf(".html?")?l+("\x26currencyType\x3d"+b):l+("?currencyType\x3d"+b),h.attr("href",l)))}function p(a){var b=f("#tfx-footer"),d=f("#tfx-header");if(!t){e.increaseCount("removeauijs18");var g=f("#fxApplicabilityDecision").siblings("i"),
k=f("#fxApplicabilityAdoption").siblings("i");if(k.hasClass("a-icon-touch-checkbox-inactive")||k.hasClass("a-icon-touch-checkbox-active"))k.removeClass("a-icon-touch-checkbox-active").addClass("a-icon-touch-checkbox-inactive"),g.removeClass("a-icon-touch-checkbox-inactive").addClass("a-icon-touch-checkbox-active")}"accept"===a?(q()?(f("#fx-terms-and-conditions").show(),f("#fxCardCurrencySubcondition").hide()):(f("#fx-enable").show(),f("#fx-disable").hide()),f("#fxApplicabilityDecision").prop("checked",
!0),d.show(),c("transactional"),b.show(),f("#marketplaceRadio").prop("checked",!1),f("#transactionalRadio").prop("checked",!0),f("#fxApplicabilityChoice").attr("value","accept")):(q()?(f("#fx-terms-and-conditions").hide(),f("#fxCardCurrencySubcondition").show()):(f("#fx-enable").hide(),f("#fx-disable").show()),f("#fxApplicabilityAdoption").prop("checked",!1),d.hide(),c("marketplace"),b.hide(),f("#transactionalRadio").prop("checked",!1),f("#marketplaceRadio").prop("checked",!0),f("#fxApplicabilityChoice").attr("value",
"decline"))}function q(){return g.isSPP()&&f("input[name\x3disNewTFXExperienceEnabled]").length}function u(a){a.preventDefault();a=x();var b=a.find("input[name\x3d'currencyOptions']:checked").val(),c=f("input[name\x3d'currentCurrencyOption']").val();b!==c&&(e.increaseCount("checkout:CSM:TFX:CurrencySelection:"+c,1),b=a.find("input[name\x3d'currencyToggleTransition']").val(),a.hide(),a=f("#"+b),a.show(),d(a))}function w(){return 0!==f("#ACCB_GIFT_CARD_ORDER_SUMMARY_POLICY_MESSAGE").length}function x(){var a=
f("input[name\x3d'currentViewId']").val();return f("#"+a)}function z(a){a.preventDefault();a=x();var b=a.find("input[name\x3d'currencyConverterTCAgreement']").val(),c=f("input[name\x3d'currentTnCOption']").val();b===c&&(e.increaseCount("Checkout:CSM:TFX:TCSelection:"+!c,1),b=a.find("input[name\x3d'tncTransition']").val(),a.hide(),a=f("#"+b),a.show(),d(a))}var f=a.$;if(!f("html").hasClass("a-ie6")){var t=r.P&&r.P.AUI_BUILD_DATE,J,v,C,A;h.isTFXCurrencyToggleOnTabletFixed()?(f(document).delegate("#checkoutCurrencyTransactional",
"click",function(){c("transactional")}),f(document).delegate("#checkoutCurrencyMarketplace","click",function(){c("marketplace")})):(f(document).delegate("#transactionalRadio","click",function(){c("transactional")}),f(document).delegate("#marketplaceRadio","click",function(){c("marketplace")}));f(document).delegate("#fxApplicabilityDecisionCheckbox","click",function(){p("decline")});f(document).delegate("#fxApplicabilityAdoptionCheckbox","click",function(){var a=q()&&!f("#fxApplicabilityAdoption").is(":checked");
p(a?"decline":"accept")});a.on("a:expander:tfx-options-expander:toggle:expand",function(a){e.increaseCount("checkout:spp-ordersummary:expand_tfx_options",1)});a.on("a:expander:tfx-see-rate-expander:toggle:expand",function(a){e.increaseCount("checkout:spp-ordersummary:expand_tfx_see_rate",1)});f(document).delegate("input[name\x3d'currencyOptions']","click",u);f(document).delegate("input[name\x3d'currencyConverterTCAgreement']","click",z);return{changeCurrency:c,initOrderSummary:b,updateCurrencyView:u,
updateTnCView:z}}});"use strict";q.when("A","ready").register("spc-page-state",function(a){var m={};return{prop:function(a,e){if(a&&"string"===typeof a)return 1<arguments.length&&(m[a]=e),m[a]}}});"use strict";q.when("A","ready").execute(function(a){function m(){0<n("#spcCachedPromiseData").length&&(e=(new Date).getTime(),n(".place-your-order-button").click(function(){var a=(new Date).getTime()-e;n("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'spcWaitingTime' value\x3d'"+a+"' /\x3e")}))}
var n=a.$,e=0;a.on("checkout:reload:spc",m);a.on("checkout:reload:spclite",m);a.on("checkout:reload:spp-revieworder",m)});"use strict";q.when("A","client-side-metrics","ready").register("spc-apx-standin",function(a,m){function n(e){var l=a.state("apx-standin-state");l.timestamp=(new Date).toISOString();l.metricName=e;return l}if(a.state("apx-standin-state")){var e=n("APX_STANDIN_ENABLED");m.emitNexusMetrics(e,e.producerId,e.schemaId);a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&
"apx-popover"==a.popover.name||a.popover&&a.popover.originalFocus&&a.popover.originalFocus.id&&"payChangeButtonId"==a.popover.originalFocus.id)a=n("APX_STANDIN_POPOVER_SHOW"),m.emitNexusMetrics(a,a.producerId,a.schemaId)});a.on("a:sheet:afterShow:apx_standin_bottom_sheet_instance",function(a){a=n("APX_STANDIN_POPOVER_SHOW");m.emitNexusMetrics(a,a.producerId,a.schemaId)})}});"use strict";q.when("A","page-transition-controller","scroll-controller","loading-spinner-controller","page-conductor","checkout-general-utils",
"ready").register("changeCustomerDetailsPopover",function(a,m,n,e,g,l){function h(){return 0<k("#onblur-character-validation-error-changeNameInput").size()}function b(){c&&c.find("button[data-action\x3da-popover-close]").trigger("click")}function d(){var a=k("#saveButton");if(a.length){var b=k("#changeNameInput"),c=k("#changePostNumberInput"),d=k("#changePhoneInput"),e=1,g=1,f=1;b.length&&!b.val()&&(e=0);c.length&&!c.val()&&(g=0);d.length&&!d.val()&&(f=0);e&&g&&f&&!h()?(a.removeClass("a-button-disabled"),
a.removeAttr("disabled")):(a.addClass("a-button-disabled"),a.attr("disabled","true"))}}var k=a.$,c;a.declarative("clickedsave","click submit",function(a){if(!h()){var c=k("#changeNameInput").val(),d=k("#changePhoneInput").val(),e=k("#changePostNumberInput").val(),l=k("#changeAccountNameCheckBox").is(":checked")?1:0,n=k("#changePostNumberCheckBox").is(":checked")?1:0,c="custName\x3d"+encodeURIComponent(c)+"\x26changeAccountName\x3d"+encodeURIComponent(l);d&&(c=c+"\x26custPhoneNumber\x3d"+encodeURIComponent(d));
e&&(c=c+"\x26dhlPostNumber\x3d"+encodeURIComponent(e),n&&(c=c+"\x26changeDhlPostNumberInEmbu\x3d"+encodeURIComponent(n)));d=a.data.changeDetailUrl;g.isSPP()&&(d=a.$target.data("changedetailurl"),k("#cancelReminderPopover").click());g.isSPP()||(c+="\x26usePipelineDispatch\x3d1");m.show();d&&k.ajax({type:"POST",data:c,url:d,dataType:"html",contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",async:!0,cache:!1,headers:g.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"}),success:function(a,
c,d){b();m.hide();g.ajaxUpdatePage(a,c,d)},error:function(a,b,c){g.ajaxRedirect(a,b,c)}})}});a.declarative("clickedsave","mouseenter mousemove touchstart",function(a){d()});a.declarative("changeNameKeyIn changePostNumberKeyIn changePhoneNumberKeyIn","keydown keyup change keypress mouseenter mouseleave mousemove",function(a){d()});a.declarative("clickedcancel","click submit",function(a){b()});a.on("a:popover:beforeShow:changeDetailPopover",function(a){h()&&k("#onblur-character-validation-error-changeNameInput").remove()});
a.on("a:popover:show:changeDetailPopover",function(a){if(!g.isSPP()){var b=k(r).width(),e=k(r).height(),b=parseInt(.6*b,10),e=parseInt(.7*e,10);c=a.popover.$popover;var h=a.popover;c.css("position","absolute");c.css("top","50px");c.css("height",e+"px");c.css("width",b+"px");h.updatePosition()}b=g.isSPP()?a.popover.originalnamevalue:a.popover.$trigger.data("original-name-value");e=g.isSPP()?a.popover.originalcellphonevalue:a.popover.$trigger.data("original-cellphone-value");a=g.isSPP()?a.popover.originalpostnumbervalue:
a.popover.$trigger.data("original-postnumber-value");var h=k("#changeNameInput"),l=k("#changePhoneInput"),m=k("#changePostNumberInput");h.val(b);l.val(e);m.val(a);d()})});"use strict";q.when("A","page-transition-controller","ajax-utility","page-conductor","page-detector","checkout-general-utils").register("prime-decline-controller",function(a,m,n,e,g,l){function h(){d("input[name\x3d'changeCardNoEndDatePrime']").attr("data-action","prime-decline-element")}function b(a,b,d){if(d.getResponseHeader("x-amz-checkout-page"))e.ajaxUpdatePage(a,
b,d);else{a=n.jsonify(a);if(!a)return e.redirect();a.error?m.hide():a.errors?m.hide():a.autohandlererror?(b=(a=a.autohandlererror)?a.action:null,d=a&&a.type?a.type:b&&b.code?b.code:"string"===typeof a?a:"Unknown:pipelineJSError",r.location.href="fatal"===b?"/gp/buy/payselect/handlers/error.html?errorAction\x3dfatal\x26errorType\x3d"+encodeURIComponent(d):"redirect"===b?a.url:"/gp/buy/payselect/handlers/error.html?errorType\x3d"+encodeURIComponent(d)):e.redirect(a)}}var d=a.$;d("html").hasClass("a-ie6")||
(a.declarative("prime-decline-element",["click","touchend"],function(a){l.protectAgainstDoubleAction("prime-decline-element")||(a.$event.preventDefault(),m.show(),a=(new Date).getTime(),a="changeCardNoEndDatePrime\x3d1\x26hasWorkingJavascript\x3d1\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26fromAnywhere\x3d"+d("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+a,d.ajax({type:"POST",url:"/gp/buy/spc/handlers/stuff-handler.html/ref\x3dox_spc_prime_renew_nodate",data:a,headers:{"Cache-Control":"no-cache",
pragma:"no-cache","x-amz-checkout-page":"spc"},contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",success:b,error:e.ajaxRedirect}))}),a.on("checkout:reload:spc",h),a.on("checkout:reload:spp-revieworder",h))});"use strict";q.when("A","loading-spinner-controller","page-conductor").register("prime-popover-controller",function(a,m,n){function e(){l={};a.defer(function(){0!==g("#spc-orders").find(".prime-popover-link").length&&(g("#spc-orders").find(".prime-popover-link").each(function(){var a=
g(this);if(a.data("action")){a.removeAttr("href").attr("tabindex",0);var b=a.data("aCheckoutModalPopover");var d=b.name,e="";b.width&&b.height&&(e="width:"+b.width+"px;height:"+b.height+"px;");0<g("#spc-orders").find("#"+d+"-popover").length||(b=g(['\x3cdiv id\x3d"a-popover-'+d+'" class\x3d"a-popover-preload" style\x3d"display:none;"\x3e','\x3cdiv id\x3d"'+d+'-popover" class\x3d"checkout" style\x3d"'+e+'"\x3e\x3c/div\x3e',"\x3c/div\x3e"].join("")),g("#spc-orders").append(b));a=a.data("aCheckoutModalPopover").name;
l[a]||(b=g(".prime-popover-content").html())&&0<b.length&&(l[a]=b,g("#"+a+"-popover").html(b))}}),g("#spc-orders").find(".a-box").each(function(){var a=g(this),b=a.find(".prime-ad-banner-content .prime-popover-link");1<b.length&&(b=b.first());a.find("a.primeAdLauncher").each(function(){var a=g(this);a.wrap('\x3cspan class\x3d"a-declarative" data-action\x3d"prime-event" data-prime-event\x3d\'{"metric":"lm3"}\'\x3e\x3c/span\x3e');a.replaceWith(b.clone().text(a.text()).addClass("a-size-mini"))})}))})}
var g=a.$;if(!g("html").hasClass("a-ie6")){var l={};a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("prime")&&(a=a.popover.name,!l[a])){var b=g("input#primePopopverFallbackContent").val()||"";l[a]=b;g("#"+a+"-popover").html(b)}});a.on("checkout:reload:spc",e);a.on("checkout:reload:spp-revieworder",e)}});"use strict";q.when("A","page-transition-controller","back-button-protection","page-conductor","weblab-helper").register("place-order-controller",function(a,
m,n,e,g){function l(){if(!e.isAnimating()){var d=b("#spc-form");if("0"===b("#showPageTransition").attr("content"))if(d.hasClass("paylast-spc"))m.show();else{if(0<b("#enableAlternatePYOBlocker").length){var k=d.find(".a-button.continue-button");if("disabled"===k.find("input").attr("disabled"))return;k.find("input").attr("disabled","disabled");k.addClass("a-button-disabled");setTimeout(function(){k.removeClass("a-button-disabled");k.find("input").removeAttr("disabled")},4E4)}}else m.showPageTransition();
var c=b("#currencyChanged");0<c.length&&"true"===c.val()&&(c='\x3cinput type\x3d"hidden" name\x3d"checkoutCurrencySelection.'+b("#tfx-switch-currency-options").find("input:radio:checked").val()+'" /\x3e',b("#spc-form-inputs").append(c));if(g.isMfaPSD2DeviceDescriptionCollectionEnabled())for(var c=[{name:"javaEnabled",value:r&&r.navigator&&r.navigator.javaEnabled()},{name:"language",value:r&&r.navigator&&r.navigator.language},{name:"screenColorDepth",value:r&&r.screen&&r.screen.colorDepth},{name:"screenHeight",
value:r&&r.screen&&r.screen.height},{name:"screenWidth",value:r&&r.screen&&r.screen.width},{name:"timeZone",value:(new Date).getTimezoneOffset()}],h=0;h<c.length;h++)if(c[h].name!==H&&c[h].value!==H){var l='\x3cinput type\x3d"hidden" name\x3d"'+c[h].name+'" value\x3d"'+c[h].value+'" /\x3e';b("#spc-form-inputs").append(l)}0==d.find("input[type\x3d'hidden'][name\x3d'placeYourOrder1']").length&&d.append("\x3cinput type\x3d'hidden' name\x3d'placeYourOrder1' value\x3d'1' /\x3e");(c=a.state("firetv-aws-attributes"))&&
c.queryParams&&(h=d.attr("action"),h+=0<=h.indexOf("?")?"\x26":"?",h+=b.param(c.queryParams),d.attr("action",h));e.isSPP()&&d.append(b("#subtotalsSection").find("input").hide());n.markAsDirty();d.submit()}}function h(a){a.preventDefault();l(a.target)}var b=a.$;if(!b("html").hasClass("a-ie6"))return a.declarative("a-checkout-place-order",["click"],function(a){l(a.target)}),b(document).delegate("span.place-order-button-link","click",h),{placeOrderClick:l,placeOrderClickDelegate:h,PLACE_ORDER_BUTTON_LINK_SELECTOR:"span.place-order-button-link"}});
"use strict";q.when("A","page-conductor","button-blocker","client-side-metrics","weblab-helper").register("verification-checkbox-controller",function(a,m,n,e,g){function l(a){x?h(a):b(a);z&&a&&a.blocking&&(e.setmarker("fn"),z=!1)}function h(a){var b=D(".continue-button"),d=D(".continue-button-blocker"),e=D(".place-order-blocker-message.custom-blocker-message");if(a.blocking||!c())a.blocking?(e.text(a.message),b.addClass("aok-hidden"),d.removeClass("aok-hidden")):(e.empty(),b.removeClass("aok-hidden"),
d.addClass("aok-hidden"),q.when("a-tooltip").execute(function(a){(a=a.get(d))&&a.isActive()&&a.hide()}))}function b(a){a.blocking?n.show("place-order-imb-checks",a.message):(n.hide("place-order-imb-checks"),D("#hasTVNavigation").length&&q.when("a-tv").execute(function(a){a.select(".continue-button")}))}function d(){var b,c={blocking:!1,message:""};if(x)b=D("#spc-imb").find(".verification-checkbox input:not(:checked)"),0<b.length&&(c={blocking:!0,message:b.first().closest(".verification-checkbox").attr("data-blocker-message")});
else{e.increaseCount("removeauijs23");if(!D("#spc-imb").find(".verification-checkbox").length)return;b=m.isSPP()?D("#spc-imb").find(".verification-checkbox input:not(:checked)"):D("#spc-imb").find(".verification-checkbox:not(:checked)");0<b.length&&(c={blocking:!0,message:m.isSPP()?b.first().closest(".spp-panel").hasClass("aok-hidden")?b.first().closest(".verification-checkbox").data("non-review-panel-blocker-msg"):b.first().closest(".verification-checkbox").data("blocker-message"):b.first().attr("data-blocker-message")})}g.isPyoClientSideInitiationEnabled()?
l(c):a.trigger("checkbox:primaryActionBlocker:blockingStateChanged",c)}function k(){var a=D("#wineNoticeCheckbox");a&&a.length&&(u?(a.attr("checked",""),w&&(a=a.siblings(".a-icon-touch-checkbox-inactive"))&&a.length&&(a.removeClass("a-icon-touch-checkbox-inactive"),a.addClass("a-icon-touch-checkbox-active"))):(a.removeAttr("checked",""),w&&(a=a.siblings(".a-icon-touch-checkbox-active"))&&a.length&&(a.removeClass("a-icon-touch-checkbox-active"),a.addClass("a-icon-touch-checkbox-inactive"))))}function c(){var a=
D("input[name\x3disINExpressCheckoutCC]");return a&&a.length?1===parseInt(a.val(),10):!1}function p(){g.isPyoClientSideInitiationEnabled()||k();D('[data-client-component\x3d"PrimaryActionBlockerCheckbox"]').length||(d(),g.isPyoClientSideInitiationEnabled()&&k());var a=r.P&&r.P.AUI_BUILD_DATE?'.verification-checkbox input[type\x3d"checkbox"]':"input.verification-checkbox";D("#spc-imb").find(a).unbind("change.verification-checkbox").bind("change.verification-checkbox",d)}var D=a.$,u,w=D("html").hasClass("a-touch"),
x=!m.isSPP()&&r.P&&r.P.AUI_BUILD_DATE,z=!0;if(!D("html").hasClass("a-ie6")){if(!g.isPyoClientSideInitiationEnabled())a.on("checkbox:primaryActionBlocker:blockingStateChanged",l);a.declarative("change-wine-notice-checkbox",["change"],function(a){u=a.$target.is(":checked")?1:0});a.on("checkout:reload:spc",p);a.on("checkout:reload:spclite",p);a.on("checkout:reload:spp-revieworder",p);a.on("checkout:reload:spp-collapsed",p);a.on("checkout:unload",function(){z=!0});a.on("checkout:afterReload",function(){z=
!1});return{verifyCheckboxes:d,updatePyo:l}}});"use strict";q.when("A","page-transition-controller","scroll-controller","ajax-utility","page-conductor","quantity-service","checkout-modal-popover","page-detector","checkout-general-utils","a-popover","client-side-metrics","weblab-helper").register("quantity-update-controller",function(a,m,n,e,g,l,h,b,d,k,c,p){function D(){W=U=!1;a.defer(function(){var a=G("#spc-orders");a.find("a.quantity-change-button-static").remove();"1"!==G("#spc-form-inputs").find("input[name\x3d'isQuantityInvariant']").val()&&
a.find("div.quantity-value-static").remove()});G(".lineitem").each(function(a,b){a=G(b);a.find(".no-js-quantity").remove();b=a.find(".quantity-dropdown");b.is(":visible")?(a.find(".js-select").prop("disabled",!1),b.removeClass("a-button-disabled")):(a=a.find(".quantity-input"),a.prop("disabled",!1),a.removeClass("a-form-disabled"))});var b=G("#pantry-mov-popover-content"),d=G("#pantry-mov-popover-placeholder");!b.length&&d.length&&(b=d.attr("data-device"),G.ajax({type:"GET",url:"/gp/pantry/checkout/mov/get-pantry-mov-popover-contents.html",
data:"device\x3d"+b,dataType:"text",async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(a,b,e){~a.indexOf("pantry-mov-popover-content")?d.append(a):c.increaseCount("checkout:pantry:pantry_mov_popover_contents:bad-content",1)},error:function(a,b,d){c.increaseCount("checkout:pantry:pantry_mov_popover_contents:"+d,1)}}))}function u(a,b){a=G('.update-quantity-error[data-itemid\x3d"'+a+'"]');a.find(".error-message").hide();a.find('.error-message[data-error-type\x3d"'+
b+'"]').show();a.find("i").show();a.find(".a-span12").show();a.show();b=a.closest(".item-details-right-column");b.find(".spc-quantity-dropdown-button").addClass("a-button-error");b.find(".spc-quantity-input").addClass("a-form-error");b=a.parents("div.update-quantity-error");a=b.siblings(".item-details");0<a.length&&(a.find(".a-input-text-wrapper").addClass("a-form-error"),a.removeClass("a-spacing-large"),a.find(".a-touch-select").addClass("a-input-text a-form-error"));b.show()}function w(a,b,f){var h=
f.getResponseHeader("x-amz-checkout-new-cart-quantity");d.updateCartByMash(h);if(f.getResponseHeader("x-amz-checkout-page"))g.ajaxUpdatePage(a,b,f,{pushNewFrame:"false"}),a=f.getResponseHeader("x-amz-checkout-updated-itemid"),f=f.getResponseHeader("x-amz-checkout-quantity-error"),a&&f&&u(a,f);else if(a=e.jsonify(a))if(a&&a.errors&&a.errors.pantry&&a.errors.pantry.mov)z(a.errors.pantry.showAddonInfo);else{if(a&&a.errors&&a.errors.addon&&(g.isSPP()&&c.increaseCount("checkout:spp-revieworder:addon_warn_pri",
1),f=a.errors.addon.type,b=a.errors.addon.asins,x(),G(".item-list").hide(),b.forEach(function(a){G('[data-asin\x3d"'+a+'"]').show()}),f=G("#addon-warning-"+f+"-launcher"),f.length)){G("input[name\x3duseLiveAUI]").length?k.get(f).attrs({$trigger:aa}).show():ha&&G("div.checkout.spc-mobile.aui-templatized").length?f.click():(c.increaseCount("removeauijs19"),a=G.Event("keyup",{triggerPositioningElement:aa,manualTrigger:!0}),f.trigger(a),0<G("div.spc-mobile").length&&(n.scrollToTop(),n.toggleScrollOff()));
m.hide();return}return g.redirect(a)}else g.redirect()}function x(){G("#a-popover-addon-warning-normal .select-address-title").hide();0<L?(G("#a-popover-addon-warning-normal .reduce-title").show(),G("#a-popover-addon-warning-normal .delete-title").hide()):(G("#a-popover-addon-warning-normal .delete-title").show(),G("#a-popover-addon-warning-normal .reduce-title").hide())}function z(a){var b=G("#pantry-mov-popover-launcher"),d=G(".pantry-mov-reduce-prompt"),e=G(".pantry-mov-delete-prompt"),f=G("#pantry-mov-addon-info-container");
b.length?(P()||c.increaseCount("checkout:pantry:pantry_mov_popover:non_spc",1),f.length&&f.empty(),a&&G("#addon-warning-normal-popover-content").length&&(x(),f.length||(f=G("\x3cdiv/\x3e",{id:"pantry-mov-addon-info-container"})),f.append('\x3chr class\x3d"a-divider-normal"\x3e').append(G("#addon-warning-normal-popover-content").html()).appendTo("#pantry-mov-popover-content")),0<L?(d.show(),e.hide()):(e.show(),d.hide()),b.length&&(b.click(),m.hide())):(c.increaseCount("checkout:pantry:pantry_mov_popover_contents:no-launcher",
1),g.redirect())}function f(a,b){m.show();var c={isClientTimeBased:G('input[name\x3d"useCtb"]').val(),fromAnywhere:G("input[name\x3dfromAnywhere]").val(),success:w};if(b)for(var d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);g.isSPP()?(c.ref="chk_ship_chg_qty_pri",b=G("#setOrderingPrefsCheckbox"),b.length&&b.is(":checked")&&(c.saveAsDefaultsSelected=1)):G(".spc-mobile.aui-templatized").length&&(c.ref="ox_spc_change_quantity");b=G("#addon-indicator")&&"true"===G("#addon-indicator").attr("data-has-addon-items");
d=G("#pantry-mov-indicator")&&"true"===G("#pantry-mov-indicator").attr("data-has-pantry-items");a||!b&&!d||(c.istrial=1);l.call(X,L,c);I?I.data("currentQuantity",L):T&&T.data("currentQuantity",L)}function t(){m.hide();r.location="/gp/aw/c/ref\x3dox_spc_deal_expired?app-action\x3dcart"}function J(a){var b=V;L=V;I&&q.when("a-dropdown").execute(function(a){I&&(a.getSelect(I).setValue(b.toString()),I.data("currentQuantity",L))});a===B.addOn&&n.toggleScrollOn();T&&(T.val(b),T.data("currentQuantity",L),
a=T.closest(".quantity-block"),a.find(".change-quantity-button").closest(".a-declarative").removeClass("hidden"),a.find(".quantity-display").removeClass("hidden"),a.find(".quantity-display-block-tablet").removeClass("hidden"),a.find(".dynamic-quantity-update").hasClass("stay-visible")||a.find(".dynamic-quantity-update").addClass("hidden").children().addClass("hidden"))}function v(a,b){var d=a.$currentTarget.is("a")?a.$currentTarget:a.$currentTarget.find("a");X=d.data("entityId");L=0;I=null;V=d.data("currentQuantity");
aa=G("a.quantity-delete-button[data-entity-id\x3d'"+X+"']");aa.length||(aa=a.$currentTarget);T=d.closest(".dynamic-quantity-update").find(".quantity-input");T.length||(T=null);d.data("isBundleDelete")?G("#pb-delete-trigger-"+d.data("bundleGroupId")).trigger("click"):p.isItemAssociationDeleteConfirmationPopoverForWirelessPlansEnabled()&&d.data("showItemAssocDeletePopover")?(c.increaseCount("checkout:item-association:delete:selected",1),setTimeout(function(){G("#ia-delete-trigger-"+d.data("itemAssocGroupId")).trigger("click")},
100)):(f(!1,b),h.hideById(d.closest(".a-popover").data("aPopoverId")))}function C(a){if(!d.protectAgainstDoubleAction("order-summary-update-quantity",200)){c.resetMetrics();var b=a.$currentTarget,e=b.closest(".lineitem"),g=b.find("select"),k=g.length?g:b;X=e.data("entityId");g=G('.update-quantity-error[data-itemid\x3d"'+X+'"]');T=I=null;k.is("select")?(I=b.find("select"),L=k.val()):(T=e.find(".quantity-input"),L=T.val());V!==L&&(aa=k.is("select")?I.parent():T,""===L?H(e):"Delete"===L||0===parseInt(L,
10)?(a.$event.preventDefault(),d.protectAgainstDoubleAction("delete-item")||(e=a.$currentTarget.closest(".lineitem"),X=e.data("entityId"),L=0,e.data("isBundleDelete")?G("#pb-delete-trigger-"+e.data("bundleGroupId")).trigger("click"):(f(!1,void 0),h.hideById(e.closest(".a-popover").data("aPopoverId"))))):(a=parseInt(G("#quantity-input-max-value").val(),10),d.validateNumber(L,0,a)?(g.hide(),e.blur(),e.data("isBundleDelete")?G("#pb-delete-trigger-"+e.data("bundleGroupId")).trigger("click"):f(!1)):u(X,
"changeQuantity_quantityNotInRange")))}}function A(a){var b=a.$currentTarget.closest(".quantity-text-field").find(".update-quantity-link"),c=a.$currentTarget.is("input")?a.$currentTarget.val():a.$currentTarget.find("input").val(),d=a.$currentTarget.find("input").data("currentQuantity");V=d;-1===parseInt(c,10)||""===c?("change"===a.type&&H(a.$currentTarget.closest(".lineitem")),b.hide()):parseInt(c,10)!==d?b.show():b.hide()}function H(a){a.find(".quantity-input").val(V)}function S(b,d,e){var f=d.data("itemAssocGroupId"),
g="a:sheet:beforeShow:ia-delete-mbs-"+f,k="a:sheet:afterHide:ia-delete-mbs-"+f;a.on(g,function N(b){b=b.sheet.getContentContainer();var c=G("#ia-delete-"+f).html();c&&(b.empty(),b.html(c));a.off(g,N)});q.when("a-dropdown").execute(function(d){a.on(k,function oa(){c.increaseCount("checkout:item-association:delete:canceled",1);G("#ia-delete-trigger-"+f).data("isItemAssocAlreadyDeleted")||(L=e,I.data("currentQuantity",e),d.getSelect(b).setValue(e));a.off(k,oa)})});G("#ia-delete-trigger-"+f).trigger("click")}
function P(){return g.isSPP()?G("#revieworder").hasClass("expanded")?!0:!1:0<G("div.spc").length?!0:!1}var G=a.$;if(!G("html").hasClass("a-ie6")){var L,V,X,I,T,U=!1,W=!1,aa,ha=r.P&&r.P.AUI_BUILD_DATE,B={addOn:"addOn",pantryMOV:"pantryMOV"};a.declarative("change-quantity",["click","touchend"],function(a){if(!d.protectAgainstDoubleAction("lock-update-quantity",200)){a=a.$currentTarget;var b=!0;a.addClass("hidden");a=a.closest(".quantity-block");a.find(".change-quantity").addClass("hidden");a.find(".quantity-display").addClass("hidden");
a.find(".quantity-display-block-tablet").addClass("hidden");a.find(".dynamic-quantity-update").removeClass("hidden").find(".hidden").each(function(){var a=G(this);a.removeClass("hidden");a.is("input")&&(a.focus(),a.select(),a.unbind("keydown.update-quantity-spc").bind("keydown.update-quantity-spc",function(a){13===a.which&&a.preventDefault()}),a.unbind("keyup.update-quantity-spc").bind("keyup.update-quantity-spc",function(a){13!==a.which||b||G(a.target).closest(".dynamic-quantity-update").find(".update-quantity-button").trigger("click")}))});
setTimeout(function(){b=!1},500)}});a.declarative("order-summary-get-quantity",["click","touchend"],function(a){d.protectAgainstDoubleAction("order-summary-get-quantity",200)||a.$currentTarget.find("select").length&&(V=a.$currentTarget.find("select").val())});a.declarative("order-summary-update-quantity",["change"],C);a.declarative("order-summary-update-quantity-text-field",["click","touchend"],C);a.declarative("order-summary-handle-text-input",["keydown"],function(a){13===a.$event.which?(a.$event.preventDefault(),
C(a)):d.limitInputToNumbers(a)});a.declarative("order-summary-show-update-button",["change","keyup"],A);a.declarative("trigger-update-quantity-button",["keydown"],function(a){13===a.$event.which&&(a.$event.preventDefault(),a.$currentTarget.closest(".quantity-block").find(".update-quantity-button").trigger("click"))});a.declarative("toggle-update-quantity-button",["change","keyup"],function(a){var b=a.$currentTarget.closest(".quantity-block").find(".update-quantity-button"),c=a.$currentTarget.find("input"),
d=c.val(),e=c.data("currentQuantity");""===d?("change"===a.type&&c.val(e),b.hide()):parseInt(d,10)!==e?b.show():b.hide()});a.declarative("update-quantity",["click","touchend"],function(a){c.resetMetrics();a=a.$currentTarget.is("a")?a.$currentTarget:a.$currentTarget.find("a");var b=a.closest(".quantity-block"),e=a.closest(".dynamic-quantity-update"),g=e.find(".quantity-input");e.length||(g=b.find(".quantity-input"));if(d.protectAgainstDoubleAction("lock-update-quantity",200))g.focus();else{var k=g.val();
X=a.data("entityId");var h=G('.update-quantity-error[data-itemid\x3d"'+X+'"]'),l=parseInt(G("#quantity-input-max-value").val(),10);d.validateNumber(k,0,l)?(h.hide(),e.find(".a-form-error").removeClass("a-form-error"),g.removeClass("a-form-error"),k=parseInt(k,10),T=g,V=T.data("currentQuantity"),V=parseInt(V,10),k===V?(b.find(".change-quantity-button").closest(".a-declarative").removeClass("hidden"),b.find(".quantity-display").removeClass("hidden"),b.find(".quantity-display-block-tablet").removeClass("hidden"),
e.addClass("hidden").children().addClass("hidden")):(L=k,aa=a,a.blur(),a.data("isBundleDelete")?G("#pb-delete-trigger-"+a.data("bundleGroupId")).trigger("click"):f(!1))):u(X,"changeQuantity_quantityNotInRange")}});G(document).delegate(".spc-quantity-dropdown","change",function(a){I=G(a.currentTarget);c.resetMetrics();ha?(a=I.next(),X=a.data("entityId"),V=a.data("currentQuantity")):(c.increaseCount("removeauijs21"),X=I.data("entityId"),V=I.data("currentQuantity"));a=I.find(":selected");L=parseInt(a.val(),
10);if(V!==L){var b=G("#toggleDropdownQuantityTrigger");b.length&&L===parseInt(b.val(),10)?(a=I.closest(".quantity-block"),a.find(".spc-quantity-dropdown-button").hide(),a.find(".quantity-input").show()):(aa=I.parent(),I.blur(),a&&a.data("isBundleDelete")?G("#pb-delete-trigger-"+a.data("bundleGroupId")).trigger("click"):p.isItemAssociationDeleteConfirmationPopoverForWirelessPlansEnabled()&&a&&a.data("showItemAssocDeletePopover")||f(!1))}});a.on("a:dropdown:select",function(a){if(p.isItemAssociationDeleteConfirmationPopoverForWirelessPlansEnabled()&&
(a=G(a.nativeItemNode))&&a.data("showItemAssocDeletePopover")){c.increaseCount("checkout:item-association:delete:selected",1);var b=a.closest("select"),d=ha?b.next().data("currentQuantity"):b.data("currentQuantity");S(b,a,d)}});a.declarative("item-assoc-delete-confirm",["click","touchend"],function(a){if(!d.protectAgainstDoubleAction("item-assoc-delete-confirm")){c.increaseCount("checkout:item-association:delete:confirmed",1);f(!1);var b=G(a.$target).data("itemAssocGroupId");G("#ia-delete-trigger-"+
b).data("isItemAssocAlreadyDeleted",1);q.when("a-sheet").execute(function(a){var c=a.get("ia-delete-mbs-"+b);c&&a.hideSheet(c)})}});a.declarative("item-assoc-delete-cancel",["click","touchend"],function(){d.protectAgainstDoubleAction("item-assoc-delete-cancel")||(c.increaseCount("checkout:item-association:delete:canceled",1),L=V)});a.declarative("dont-delete-item",["click","touchend"],function(a){a.$event.preventDefault();d.protectAgainstDoubleAction("dont-delete-item")||h.hideById(a.$currentTarget.closest(".a-popover").data("aPopoverId"))});
a.declarative("delete-item",["click","touchend"],function(a){a.$event.preventDefault();d.protectAgainstDoubleAction("delete-item")||v(a)});a.declarative("delete-prime-membership-item-confirm",["click","touchend"],function(a){a.$event.preventDefault();if(!d.protectAgainstDoubleAction("delete-prime-membership-item-confirm")){var b={additionalData:{deletePrimeMembership:1,primeMembershipASIN:(a.$currentTarget.is("a")?a.$currentTarget:a.$currentTarget.find("a")).data("asin")}};v(a,b)}});a.declarative("bundle-delete",
["click","touchend"],function(){d.protectAgainstDoubleAction("bundle-delete")||f(!1)});a.declarative("bundle-delete-action",["click","touchend"],function(a){d.protectAgainstDoubleAction("bundle-delete-action")||(q.when("a-popover-base").execute(function(b){b.get(a.data.popoverName).hide()}),f(!1))});a.declarative("egc-delete",function(a){X=a.entityId;L=0;f(!0)});a.declarative("bundle-dont-delete",["click","touchend"],function(){d.protectAgainstDoubleAction("bundle-dont-delete")||(L=V,q.when("a-dropdown").execute(function(a){I&&
(a.getSelect(I).setValue(V.toString()),I.data("currentQuantity",L))}))});a.declarative("pantry-return-to-cart-btn",["click","touchend"],function(){d.protectAgainstDoubleAction("pantry-return-to-cart-btn")||P()&&t()});a.declarative("pantry-delete-items-btn",["click","touchend"],function(){!d.protectAgainstDoubleAction("pantry-delete-items-btn")&&P()&&(W=!0,G(".a-button-close").trigger("click"),f(!0))});a.declarative("pantry-cancel-delete-btn",["click","touchend"],function(){d.protectAgainstDoubleAction("pantry-cancel-delete-btn")||
P()&&J(B.pantryMOV)});a.on("a:popover:hide:pantry-mov-popover",function(){P()&&(W||J(B.pantryMOV))});a.declarative("addon-return-to-cart",["click","touchend"],function(){d.protectAgainstDoubleAction("addon-return-to-cart")||P()&&t()});a.declarative("addon-delete-items",["click","touchend"],function(){d.protectAgainstDoubleAction("addon-delete-items")||(P()&&(U=!0,G(".a-button-close").trigger("click"),f(!0)),g.isSPP()&&c.increaseCount("checkout:spp-revieworder:addon_delete_pri",1))});a.declarative("addon-dont-delete",
["click","touchend"],function(){d.protectAgainstDoubleAction("addon-dont-delete")||(P()&&J(B.addOn),g.isSPP()&&c.increaseCount("checkout:spp-revieworder:addon_keep_pri",1))});a.on("a:popover:hide:addon-warning-normal",function(){0<G("div.spc-mobile").length?t():P()&&(U||J(B.addOn))});a.on("a:popover:hide:addon-warning-special",function(){P()&&(U||J(B.addOn))});a.on("checkout:reload:spc",D);a.on("checkout:reload:spp-revieworder",D)}});q.when("A","ready").execute(function(a){a.on("a:popover:beforeShow",
function(a){if(a.popover.$trigger.hasClass("quantity-dropdown-button")){var n=a.popover.$popover,e=n.closest("div.a-dropdown");e.length&&(a.popover.$iframe.css("max-height","260px"),n.css("max-height","260px"),n=e.find("div.a-popover-inner"),n.css({"max-height":"260px"}),a.popover.updatePosition(),n.css({"overflow-y":"scroll"}))}})});"use strict";q.when("A","page-transition-controller","page-conductor","ajax-utility").register("tax-exemption-controller",function(a,m,n,e){function g(a,d,g){return g.getResponseHeader("x-amz-checkout-page")?
n.ajaxUpdatePage(a,d,g,{pushNewFrame:"false"}):(a=e.jsonify(a))?n.redirect(a):n.redirect()}function l(a,d){var e=d.$target.data("entityId");if(e){m.show();var c={isClientTimeBased:h('input[name\x3d"useCtb"]').val(),fromAnywhere:h("input[name\x3dfromAnywhere]").val()},c=c||{};d={returnFullHTML:1,cachebuster:(new Date).getTime(),isClientTimeBased:0,hasWorkingJavascript:1};h.extend(d,c);d.entityId=e;d.optOut=a;a=n.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});h.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/tax-exemption-optout.html",
data:h.param(d),dataType:"text",async:!0,cache:!1,headers:a,success:g,error:n.ajaxRedirect})}else r.ueLogError&&r.ueLogError({name:"MissingData",message:"lineItemId is undefined, when trying to opt out from tax exemption",logLevel:"FATAL"})}var h=a.$;h("html").hasClass("a-ie6")||(a.declarative("tax-exemption-opt-out",["click","touchend"],function(a){l(!0,a)}),a.declarative("tax-exemption-opt-in",["click","touchend"],function(a){l(!1,a)}))});"use strict";q.when("A").execute(function(a){return{}});
"use strict";q.when("A","page-transition-controller","page-conductor").register("sns-subscription-controller",function(a,m,n){function e(){var b=h(document);b.delegate(".sns-option","click",function(a){a=h(this);l(a.closest(".sns-upsell"),a)});b.delegate(".sns-option-mobile","click",function(a){var b=h(this);a.target.name&&"snsSetCreateSubscription"===a.target.name&&l(b.closest(".sns-upsell-mobile"),b)});b.delegate(".sns-option-tablet","click",function(a){a=h(this);l(a.closest(".sns-upsell-tablet"),
a)});b.delegate(".sns-upsell-nextdelivery","change",function(){g(h(this))});a.declarative("sns-upsell-nextdelivery-dropdown","change",function(a){g(h(a.$target))});b.delegate(".sns-upsell-learn-more","click",function(a){var b=h(this);a=b.width();var c=b.height(),e=b.position(),b=b.find(".sns-upsell-popover-learn-more");b.removeClass("aok-hidden");var g=b.width();b.height();b.css({top:e.top+c,left:e.left-(g-a)/2,position:"absolute"})});b.delegate(".sns-upsell-learn-more-close","click",function(a){(a=
h(this))&&a.closest(".sns-upsell-popover-learn-more")&&a.closest(".sns-upsell-popover-learn-more").addClass("aok-hidden");return!1})}function g(a){var d=a.closest(".sns-upsell,.sns-upsell-mobile,.sns-upsell-tablet");if(a.length&&d.length){var e=d.data("index"),c=d.find("span.sns-change-delivery-txt");c&&c.text(a.find("option:selected").data("date"));c=a.find("option:selected").data("epoch");a=a.find("option:selected").val();d.find("input[type\x3d'hidden'][name\x3d'sns_nextDelivery"+e+"']").val(c);
d.find("input[type\x3d'hidden'][name\x3d'sns_frequency"+e+"']").val(a)}}function l(a,d){m.show();var e=a.data("index"),c=(new Date).getTime(),g=a.find("input[type\x3d'hidden'][name\x3d'sns_lineItemIdentifier"+e+"']").attr("value"),l=a.find("input[type\x3d'hidden'][name\x3d'sns_merchantId"+e+"']").attr("value"),r=a.find("input[type\x3d'hidden'][name\x3d'sns_asin"+e+"']").attr("value");a=a.find("input[type\x3d'hidden'][name\x3d'sns_frequency"+e+"']").attr("value");d=d.prop("checked")||d.find("[type\x3dcheckbox]").is(":checked");
c={returnpipedata:0,returnFullHTML:1,cachebuster:c,hasWorkingJavascript:1};c.lineItemIdentifier=g;c.isONMLSelected=d?1:0;c.merchantId=l;c.asin=r;c.frequency=a;g=n.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});h.ajax({type:"POST",url:"/gp/buy/spc/handlers/set-sns-options.html",data:h.param(c),dataType:"text",async:!0,cache:!1,headers:g,success:function(a,b,c){return n.ajaxUpdatePage(a,b,c)},error:function(a,b,c){n.ajaxRedirect(a,b,c)}})}var h=a.$;h("html").hasClass("a-ie6")||e()});"use strict";
q.when("A","page-detector","page-detector-current-page","page-conductor","page-transition-controller","ajax-utility","place-order-controller","client-side-metrics").execute(function(a,m,n,e,g,l,h,b){function d(a){"function"===typeof r.ues&&(r.ues("t0",a,new Date),r.ues("ctb",a,"1"));"function"===typeof r.uet&&r.uet("tc",a,{wb:1})}function k(a,b){"function"===typeof r.uet&&r.uet(a,b,{wb:1})}function c(a){r.ueLogError&&r.ueLogError({message:a},{logLevel:"WARN",attribution:"ajax-typ"})}function p(){var a=
C("span#typ-load").attr("data-typ-args");r.location.href="https://"+r.location.hostname+"/gp/buy/thankyou/handlers/display.html?"+a}function q(){k("cf","ajax-typ:place-your-order");if(I){var a=C("#typ-desktop-frame").contents(),c=I;if(c.deliveryestimates)for(var d in c.deliveryestimates)if(c.deliveryestimates.hasOwnProperty(d)){var e=a.find("span#"+d);e&&e.replaceWith(c.deliveryestimates[d])}c.autorip&&(a=a.find("#thank-you-rogue"))&&a.replaceWith(c.autorip)}c=C("#typ-desktop-frame").contents();a=
c.find("span#typ-rewrite-url");history&&history.pushState&&a&&0<a.length&&(history.pushState({},"",a.attr("data-url")),a.attr("data-view"));c=c.find("title").text();C("#checkoutDisplayPage").hide();C("#typ-desktop").show();document.title=c;g.hide();C("span#typ-load").attr("data-typ-args");k("be","ajax-typ:place-your-order");b.setmarker&&(c=b.getscope(),U&&b.setscope("ajax-typ"),b.setmarker("cf"),U&&b.setscope(c));U||(b.sendUEPageLoadStats(),"function"===typeof r.uex&&r.uex("ld","ajax-typ:place-your-order",
{wb:1}))}function u(a,b,d){a&&a.conductoraction&&a.conductoraction.url?e.redirect(a):(k("af","ajax-typ:place-your-order"),I=a,P?q():H?G=1:(c("No TYP data available after place-order, redirecting to static TYP"),p()))}function w(){if(!ha)if(aa&&clearTimeout(aa),3===W.readyState){var a;try{a=l.jsonify(W.responseText)}catch(b){a=null}null!==a?(ha=1,u(a)):aa=setTimeout(w,50)}else 4===W.readyState&&(ha=1,200===W.status?(a=l.jsonify(W.responseText),null!==a?u(a):(c("No results from place-order, calling ajaxRedirect"),
e.ajaxRedirect())):(c("Error calling place-order, calling ajaxRedirect"),e.ajaxRedirect()))}function x(){S=1;V&&clearTimeout(V);X&&clearTimeout(X);var a=C("#currencyChanged");0<a.length&&"true"===a.val()&&(a='\x3cinput type\x3d"hidden" name\x3d"checkoutCurrencySelection.'+C("#tfx-switch-currency-options").find("input:radio:checked").val()+'" /\x3e',C("#spc-form-inputs").append(a));C("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'placeYourOrder1' value\x3d'1' /\x3e");a=(new Date).getTime()-
B;C("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'waitingTime' value\x3d'"+a+"' /\x3e");C("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'returnjson' value\x3d'1' /\x3e");Y&&C("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'isAsyncTYPEnabled' value\x3d'1' /\x3e");var a=C("#spc-form").serialize(),b=C("#typ-desktop-frame").contents().find("input#cached-promise-data");0<b.length&&(a+="\x26cachedPromiseData\x3d"+b.val());if(T){if(r.XMLHttpRequest)W=new XMLHttpRequest;else if(r.ActiveXObject)try{W=
new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(d){W=null}if(!W){c("Can't get XMLHttpRequest for data stream, calling standard placeOrderController");S=1;h.placeOrderClick();return}W.open("POST","/gp/buy/spc/handlers/place-your-decoupled-order.html",!0);W.setRequestHeader("Content-type","application/x-www-form-urlencoded");W.setRequestHeader("Content-length",a.length);W.setRequestHeader("Connection","close");W.onreadystatechange=w;W.overrideMimeType("text/plain");W.send(a)}else C.ajax({type:"POST",
url:"/gp/buy/spc/handlers/place-your-decoupled-order.html",data:a,dataType:"text",async:!0,cache:!1,dataFilter:function(a){return l.jsonify(a)},success:function(a,b,d){null!==a?u(a,b,d):(c("No results from place-order, calling ajaxRedirect"),e.ajaxRedirect())},error:function(a,b,d){c("Error calling place-order, calling ajaxRedirect");e.ajaxRedirect(a,b,d)}});"function"===typeof r.uet&&r.uet("bb","ajax-typ:place-your-order",{wb:1})}function z(){P=H=L=0;C("div#typ-desktop").empty()}function f(a,c,e){L||
(L=1,clearTimeout(X),H=0,P=1,A++,(a=C("#typ-desktop-frame").contents().find("span#typ-rewrite-url"))&&0<a.length&&(a=a.attr("data-requestid"),d("ajax-typ:place-your-order"),U||(b.setAsyncRequestId(a),"function"===typeof r.ues&&r.ues("id","ajax-typ:place-your-order",a))),G?q():!S&&5>A&&(V=setTimeout(function(){z();t()},12E4)))}function t(){if(!(S||H||5<=A)){H=1;var a=C("span#typ-load").attr("data-typ-args");X=setTimeout(function(){z();G&&(c("Timed out waiting for TYP fetch after place-order, redirecting to static TYP"),
p())},45E3);C("\x3ciframe /\x3e",{name:"typ-desktop-frame",id:"typ-desktop-frame",width:"100%",height:"100%",frameborder:"0",src:"/gp/buy/thankyou/handlers/display.html?"+a}).appendTo("div#typ-desktop").load(f)}}function J(){f()}function v(){m.isSpc()&&0<C("span#typ-load").length&&(B=(new Date).getTime(),A=0,C("div#typ-desktop").length?z():C("body").append('\x3cdiv id\x3d"typ-desktop" style\x3d"position:absolute;left:0;right:0;bottom:0;top:0;display:none;"\x3e\x3c/div\x3e'),T=C("span#typ-load").attr("data-early-json-flush")&&
!C("html").hasClass("a-lt-ie10"),Y=0<C("span#async-typ-enabled").length,U=C("span#typ-load").attr("data-use-cds-stub"),C(document).undelegate("span.place-order-button-link","click"),C(document).delegate("span.place-order-button-link","click",function(a){a.preventDefault();U?(a=b.getscope(),b.setscope("ajax-typ"),b.setctb(),b.resetue(),b.setmarker("tc"),b.setscope(a)):(b.resetMetrics(),b.setmarker("tc"));H||P?(g.show(),x()):(S=1,h.placeOrderClick())}),t())}var C=a.$;if(!C("html").hasClass("a-ie6")){var A=
0,H=0,S=0,P=0,G=0,L=0,V,X,I,T=0,U=0,W,aa,ha=0,B=0,Y=0;a.on("ajax-typ-cf",J);a.on("checkout:reload:spc",v);a.on("checkout:reload:spp-revieworder",v);a.on("checkout:reload:spclite",v)}});"use strict";q.when("A","client-side-metrics").register("trialSignPrefetchCommon",function(a,m){function n(){e()&&(c().val(0),m.increaseCount("TrialSign:js:activated"),g(),q!==H&&k(),q=a.interval(d,5E4),w=0)}function e(){return 0!==c().length&&0!==p("input[name\x3d'purchaseID']").length}function g(){r!==H&&r.abort();
r=a.ajax("/gp/buy/spc/handlers/trigger-trial-sign.html",{method:"post",params:{purchaseId:p("input[name\x3d'purchaseID']").val()},success:l,error:h,abort:b})}function l(a,b,d){c().val(a.signPurchaseTrialId);r=H;m.increaseCount("TrialSign:js:success")}function h(a,b,c){k();r=H;m.increaseCount("TrialSign:js:failed")}function b(){k();r=H;m.increaseCount("TrialSign:js:aborted")}function d(){w++;10<w?k():(m.increaseCount("TrialSign:js:retry"),m.increaseCount("TrialSign:js:retry:"+w),g())}function k(){q!==
H&&(clearInterval(q),q=H)}function c(){return p("input[name\x3d'trialSignId']")}var p=a.$,r,q,w=0;a.on("checkout:reload:spc",n);a.on("checkout:reload:spclite",n);a.on("checkout:billing-address-update",n);return{makeTrialSignCall:g,trialSignCallSucceeded:l,isTrialSignActivated:e}});"use strict";q.when("A","page-transition-controller","client-side-metrics","page-conductor").register("recurring-delivery-line-item",function(a,m,n,e){function g(a,b,c){if("undefined"===typeof a)throw n.increaseCount("Checkout:B2B:RD:RecurrencePeriod:Update:JSFailure:VariableUndefined:"+
b,1),c.show(),Error("Provided variable is undefined");c.hide()}function l(a,k,c){g(a,"updateRecurrencePeriod",k);g(a.lineItemId,"updateRecurrencePeriod-lineItemId",k);var l=e.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"});h.ajax({type:"POST",url:"/gp/buy/spc/handlers/update-recurrence-period.html",data:{recurrencePeriod:b,encodedLineItemEntityId:a.lineItemId,relatedRequestId:a.relatedRequestId},dataType:"json",cache:!1,headers:l,success:function(a,b){n.increaseCount("Checkout:B2B:RD:RecurrencePeriod:Update:"+
b,1);h("#b2brd-frdd").text(a.firstRecurringDeliveryDate);c.hide();k.hide();m.hide()},error:function(b){n.increaseCount("Checkout:B2B:RD:RecurrencePeriod:Update:"+b,1);h("#b2brd-cadence-selector").find(".a-dropdown-prompt").text(a.selectedRecurrencePeriodDisplayString);c.hide();k.show();m.hide()}});m.show()}var h=a.$,b;a.declarative("b2brd-cadence-dropdown-change","change",function(a){var e=h("#update-recurrence-period-error"),c=h("#update-recurrence-period-link");g(a,"b2brd-cadence-dropdown-change",
e);a=a.$event.target.value;g(a,"handleDropdownChange",e);c.show();b=a});a.declarative("update-recurrence-period","click",function(a){var b=h("#update-recurrence-period-error"),c=h("#update-recurrence-period-link");g(a,"update-recurrence-period",b);l(a.data,b,c)});a.declarative("update-recurrence-period-mobile","change",function(a){var e=h("#update-recurrence-period-error"),c=h("#update-recurrence-period-link");g(a,"update-recurrence-period-mobile",e);var m=a.$event.target.value;g(m,"handleDropdownChange",
e);c.show();b=m;l(a.data,e,c)})});"use strict";q.when("A","client-side-metrics","ajax-utility","button-blocker","button-blocker-popover","spclite-items-viewer","fast-track-controller").register("get-final-results-update",function(a,m,n,e,g,l,h){function b(){for(var b=function(){a.trigger("checkout:spc:ordersummary:sizeChanged")},c=0;20>c;++c)setTimeout(b,100*c)}function d(a,c){setTimeout(function(){var d=l.prepare(a);d&&u("#spclite-items-operation").show();u("#spclite-items-header-dynamic").fadeIn(c?
0:300,function(){d&&u("#spclite-items-operation").find(".spclite-items-view-switch").each(function(){var a=u(this).attr("view-name");a&&u(this).find("a").click(function(){m.increaseCount("SPCLite:ClientSide:SwitchViewClick:"+a,1);l.switchToView(a);u("#spclite-items-operation").fadeOut(c?0:300);b()})})})},c?0:800)}function k(b,c,d){if(b&&u.isArray(b))for(var e=!1,g=0;g<b.length;g++){var k=b[g];if(k.identifier&&k.content){var h=u("#"+c+"-"+k.identifier);h&&0!==h.length?a.slideDown(h.html(k.content),
d?0:500,"ease-out",function(){}):(m.increaseCount("SPCLite:LazyContentPlaceHolderMissing:Item:"+c,1),e||(m.increaseCount("SPCLite:LazyContentPlaceHolderMissing:Page:"+c,1),e=!0))}}}function c(c,e){if(c.presentCVs&&0<c.presentCVs.countOfCVs)p();else{c.orderSummaryHTML&&(a.fadeOut(u("#order-summary-footer"),e?0:250,"ease-out"),a.fadeOut(u("#spc-order-summary"),e?0:250,"ease-out",function(){u("#spc-order-summary").replaceWith(c.orderSummaryHTML).hide();c.additionalOrderSummaryHTML&&u("#order-summary-footer").html(c.additionalOrderSummaryHTML);
a.fadeIn(u("#spc-order-summary"),e?0:400,"ease-out");a.fadeIn(u("#order-summary-footer"),e?0:400,"ease-out")}));c.freshDeliveryMessageHTML&&(u("#lazy-fresh-promise-delivery-message").html(c.freshDeliveryMessageHTML),a.slideDown(u("#lazy-fresh-promise-delivery-message"),e?0:500,"ease-out"),h.spcLiteLazyLoadFastTrack());k(c.itemToPrimeMembershipDelivery,"lazy-membership-delivery",e);k(c.itemToGiftContentMapping,"lazy-gift-options",e);k(c.itemToShipOfferingMapping,"lazy-ship-method",e);k(c.itemToPromise,
"lazy-promise",e);c.freshDeliverySlotInformationHTML&&(u("#lazy-fresh-delivery-slot-information").html(c.freshDeliverySlotInformationHTML),a.slideDown(u("#lazy-fresh-delivery-slot-information"),e?0:250,"ease-out"));c.freshDeliveryInstructionsHTML&&(u("#lazy-fresh-delivery-instructions").html(c.freshDeliveryInstructionsHTML),a.slideDown(u("#lazy-fresh-delivery-instructions"),e?0:250,"ease-out"));if(c.itemToPromoMapping&&u.isArray(c.itemToPromoMapping))for(var g=u("#items-block"),l=0;l<c.itemToPromoMapping.length;l++){var m=
c.itemToPromoMapping[l];"lightningdeal"===m.type?g.find(".lazy-lightning-promo-details-"+m.identifier).removeClass("aok-hidden"):"promotion"===m.type&&g.find(".lazy-promo-details-"+m.identifier).removeClass("aok-hidden")}c.freeShippingId&&u("#"+c.freeShippingId).removeClass("aok-hidden");u("input#isOrderSummaryReady").val(1);d(c.itemGroupData,e);b()}}function p(){var b=u("#spclite-block-order-place-message").html()||"";e.show("disabled-order-place",b);e.lock();g.create({name:"disabled-order-place",
content:b});g.lock();var c=e.getButtonBlocker().data("a-popover-id");a.on("checkout:beforeReload",function(){g.unlock();e.unlock();g.destroy();u("#a-popover-"+c).remove()})}function q(a){if(a&&a.data){var b;try{b=r.atob(a.data)}catch(c){return m.increaseCount("SPCLite:FinalResult:Base64Decode:Failure",1),null}if((b=n.jsonify(b))&&!u.isEmptyObject(b))return b}return null}var u=a.$,w,x=function(a,b){function c(){if(g&&0!==g.length){for(var a="",b=0;b<d%3+1;b++)a+=".";g.html(a);d++}}var d=0,e,g;this.start=
function(){b&&b.useTextAnimate&&(d=0,g=a.find(".spclite-loading-text .spclite-processing-indicator"),e=setInterval(c,800))};this.stop=function(){e&&(clearInterval(e),g&&0<g.length&&g.html(""),d=0);a.find(".spclite-loading-spinner").hide();b&&b.showTextAlways||a.find(".spclite-loading-text").hide()}};a.on("checkout:reload:spclite",function(){if("1"===u('script[type\x3d"spclite-encoding"]').attr("data-base64-encode-final-results")){var a=q(r.__spcliteFinalResultsData);if(a){c(a,!0);return}}else if(r.__spcliteFinalResultsData){c(r.__spcliteFinalResultsData,
!0);return}var a="",b=u("input#executionId").val();b&&(a+="executionId\x3d"+b);return u.ajax({type:"GET",url:"/gp/buy/spclite/handlers/get-final-results.html/ref\x3dox_spclite_get_final_results",data:a,dataType:"text",async:!0,beforeSend:function(a){w=new x(u("#spclite-order-summary-loading-indicator"),{showTextAlways:!0});w.start();r.uet&&r.uet("bb","SPCLite:ClientSide:Perf:FinalAjax",{wb:1})},success:function(a,b,d){a=n.jsonify(a);"1"===u('script[type\x3d"spclite-encoding"]').attr("data-base64-encode-final-results")?
(a=q(a))?c(a,!1):p():a&&!u.isEmptyObject(a)?c(a,!1):p()},error:function(a,b,c){p()},complete:function(a){w.stop();r.uex&&r.uex("ld","SPCLite:ClientSide:Perf:FinalAjax",{wb:1})},cache:!1})});a.on("checkout:beforeLoadPage",function(){r.__spcliteFinalResultsData=H})});"use strict";q.when("A","client-side-metrics").register("spclite-items-viewer",function(a,m){function n(){var a=g("#spclite-items-block").find(".spclite-item-detail");a&&0<a.length&&(h={},a.each(function(a){a=g(this).attr("entity-id");
h[a]=g("\x3cp\x3e\x3c/p\x3e").append(g(this).clone().removeClass("a-span-last")).html()}))}function e(a,d){if(!d||0===d.length)return null;a=g('\x3cdiv class\x3d"a-row spclite-item-view" view-type\x3d"order-by-delivery"\x3e\x3c/div\x3e');var e=d;d=[];for(var c=[],l=0;l<e.length;l++){var m=e[l];if("normal"!==m.type)c.push(m);else{for(var n=0;n<d.length;)if(m.data.destinationAddressId!==d[n].data.destinationAddressId)n++;else break;for(;n<d.length;)if(m.data.destinationAddressId===d[n].data.destinationAddressId&&
m.data.promise.starttime.dayepoch>d[n].data.promise.starttime.dayepoch)n++;else break;d.splice(n,0,m)}}for(e=0;e<c.length;e++)switch(m=c[e],m.type){case "primemembership":d.unshift(m);break;case "vas":case "digital":case "no-promise":case "exception":d.push(m);break;default:d.push(m)}for(c=0;c<d.length;c++){m=d[c];if(e=m.content)l='\x3cdiv class\x3d"row spclite-item-group-title"\x3e',e.destination&&(l+='\x3cdiv class\x3d"row destination"\x3e'+e.destination+"\x3c/div\x3e"),e.promise&&(l+='\x3cdiv class\x3d"row promise"\x3e'+
e.promise+"\x3c/div\x3e"),l+="\x3c/div\x3e",a.append(l);a:if(e=m.items,h&&e&&0!==e.length){l="";for(n=0;n<e.length;n++){0===n%2&&(l+='\x3cdiv class\x3d"a-row"\x3e');var r=e[n].identifier;if(!h[r]){e=null;break a}r=g(h[r]);1===n%2&&r.addClass("a-span-last");l+=g("\x3cp\x3e\x3c/p\x3e").append(r).html();1===n%2&&(l+="\x3c/div\x3e")}1===e.length%2&&(l+='\x3cdiv class\x3d"a-column a-span6 a-span-last"\x3e\x3c/div\x3e\x3c/div\x3e');e=l}else e=null;if(e)e=g(e),("no-promise"===m.type||"normal"===m.type&&
m.data&&m.data.promise&&"scheduled"!==m.data.promise.type)&&e.find(".spclite-promise").hide(),a.append(e);else return null;c<d.length-1&&a.append("\x3chr\x3e")}return a}var g=a.$,l,h;return{prepare:function(a){try{var d;a:{n();if(h){var g=e("order-by-delivery",a);if(g){l={"order-by-delivery":g};d=!0;break a}}d=!1}return d}catch(c){m.increaseCount("SPCLite:ClientSide:Exception:SwitchViewPrepare",1)}return!1},switchToView:function(a,d){var h;l&&l[a]?h=l[a]:(m.increaseCount("SPCLite:ClientSide:SwitchViewNoPrepared:"+
a,1),"order-by-delivery"===a&&(h=e(a,d)));if(h){var c=g("#spclite-items-block");c.find(".spclite-item-view").fadeOut(300,function(){c.empty();c.append(h.clone().hide());c.find(".spclite-item-view").fadeIn(500)})}}}});"use strict";q.when("A","loading-spinner-controller").register("cpf-controller",function(a,m){function n(a){var e,h,b;if(/^\d{11}$/.test(a)||/^\d{3}\.\d{3}\.\d{3}-\d{2}$/.test(a)){a=a.replace(/[^\w\s]|_/g,"");if(/(\d)\1{10}/.test(a))return!1;e=a.substring(0,9);h=a.substring(9);b=0;for(var d=
10;1<d;d--)b+=e.charAt(10-d)*d;if((2>b%11?0:11-b%11)!==h.charAt(0))return!1;e=a.substring(0,10);b=0;for(a=11;1<a;a--)b+=e.charAt(11-a)*a;return(2>b%11?0:11-b%11)!==h.charAt(1)?!1:!0}return!1}var e=a.$;a.on("checkout:reload:spp-taxid",function(){e("#useThresholdTaxIdService").length||e("#taxidForm").submit(function(){var a=e("#taxidregistration-imb");if(!n(e("#taxid-field").val()))return m.hideSpinner(e("#spinner-anchor"),!0),a.show(),!1;a.hide();return!0})})});"use strict";q.when("A","page-conductor",
"ready").register("taxid-threshold-controller",function(a,m){function n(){var a=e();m.isSPP()?a?(g("#taxid-continue-disabled").hide(),g("#taxid-continue-enabled").show()):(g("#taxid-continue-enabled").hide(),g("#taxid-continue-disabled").show()):a?g("span.#continue").removeClass("a-button-disabled").find('input[type\x3d"submit"]').removeAttr("disabled"):g("span.#continue").addClass("a-button-disabled").find('input[type\x3d"submit"]').attr("disabled","disabled")}function e(){var a=!0,e=g("#taxIdForm");
e.length&&e.find('input[type\x3d"text"]').each(function(){var b=g(this);if(!b.val()||7>b.val().length)b.parents(".taxid-form").find('input[type\x3d"checkbox"]').attr("checked")||(a=!1)});return a}var g=a.$;a.on("checkout:reload:spp-taxid",function(){if(g("#useThresholdTaxIdService").length){var a=g("#taxIdForm");a.length&&(a.find('input[type\x3d"text"]').keyup(n),a.find('input[type\x3d"checkbox"]').change(n));n()}})});"use strict";q.when("A","page-conductor","loading-spinner-controller","taxaddress-page-config",
"ready").register("taxaddress-controller",function(a,m,n,e){function g(){m.isSPP()&&(h(),b())}function l(){if(m.isSPP()){var a=c(q.taxregistrationnumberInputIdSelector).val();c(q.taxregistrationnumberInputIdSelector).val(a.replace(r,""));a=c(q.businesslegalnameInputIdSelector).val();c(q.businesslegalnameInputIdSelector).val(a.trim());h();b()}}function h(){if(q.isChewbaccaURL){var a=k(c(q.taxregistrationnumberInputIdSelector).val()),b=k(c(q.businesslegalnameInputIdSelector).val());a&&b?c(q.taxaddressFormIdSelector).attr("action",
q.formActionNonSifEncryptionUrl):c(q.taxaddressFormIdSelector).attr("action",q.formActionSifEncryptionUrl)}}function b(){var a=c("#taxid-continue-enabled"),b=c("#taxid-continue-disabled"),d;d=c(q.taxregistrationnumberInputIdSelector).val();var e=c(q.businesslegalnameInputIdSelector).val();if(k(d)&&k(e))d=!0;else{var e=!e||k(e.toString().trim()),g=k(c(q.taxaddressInputNameSelector).val());d=k(d)||!p.test(d)||e||g?!1:!0}d?(a.show(),b.hide()):(a.hide(),b.show());d=k(c(q.taxregistrationnumberInputIdSelector).val())&&
k(c(q.businesslegalnameInputIdSelector).val())?q.continueLabel:q.saveContinueLabel;a.find("span.a-button-text").text(d);b.find("span.a-button-text").text(d)}function d(){if(w)w=!1;else{var a=c(q.taxregistrationnumberInputIdSelector).val().trim(),b=c(q.businesslegalnameInputIdSelector).val().trim();if(!k(a)||!k(b)){var d={tax_registration_number:a,business_legal_name:b};c.ajax({type:"POST",url:q.sifEncryptionUrl,dataType:"json",data:d,success:function(a,b,e){k(d.tax_registration_number)?c(q.taxregistrationnumberInputIdSelector).val(""):
c(q.taxregistrationnumberInputIdSelector).val(a.sifEncryptedTaxId);k(d.business_legal_name)?c(q.businesslegalnameInputIdSelector).val(""):c(q.businesslegalnameInputIdSelector).val(a.sifEncryptedLegalName);w=!0;c(q.taxaddressFormIdSelector).submit()},error:function(a,b,c){console.log("[taxaddress-controller.js] Error while encrypting the input fields. Error Type: "+b+" tax_registration_number: "+d.tax_registration_number+" business_legal_name: "+d.business_legal_name)}});return!1}}}function k(a){return!a||
0===a.toString().length}var c=a.$,p=/^\d{11}$/,r=/\s+/g,q=e.getConfig(),w=!1;a.on("checkout:reload:spp-taxaddress",function(){c(q.taxregistrationnumberInputIdSelector).keyup(l).blur(l);c(q.businesslegalnameInputIdSelector).keyup(g).blur(l);c('input:radio[name\x3d"'+q.taxaddressInputName+'"]').each(function(){c(this).change(g)});q.isChewbaccaURL=-1!=q.formActionSifEncryptionUrl.indexOf("/checkout/p/p-");q.isChewbaccaURL||c(q.taxaddressFormIdSelector).submit(d);g()});return{getNewTaxAddressPopoverURL:function(){return q.newTaxAddressPopoverURL},
submitTaxAddressFormWithNewAddressId:function(a){c(q.newTaxaddressInputIdSelector).val(a);n.showSpinner(c(q.taxAddressPanelSelector),!1);c(q.taxaddressFormIdSelector).submit()}}});q.when("A","address-popovers","taxaddress-controller","ready").register("taxaddress-addresspopover-helper",function(a,m,n){m.actionRegisterTaxAddressController(n)});"use strict";q.when("A","page-spinner-controller","ajax-utility","page-conductor","client-side-metrics").execute(function(a,m,n,e,g){function l(){function d(a){if(!l)if(a.preventDefault(),
a=encodeURIComponent(h("#spc-deliverytipinput").val()),h("#tip-error").addClass("aok-hidden"),h("#tip-promo-success").addClass("aok-hidden"),h("#tip-success").addClass("aok-hidden"),h("#tip-ineligible").addClass("aok-hidden"),h("#tip-success").addClass("aok-hidden"),a&&0!==a.length)if(0>a)c("invalidDeliveryTip_NoAmount");else if(/^[0-9]*(\.[0-9]{1,2})?$/.test(a)){m.show();n=h("#spc-deliverytipnoticecheckbox").attr("checked")?1:0;var b=(new Date).getTime();a="tipamount\x3d"+a+"\x26isDefaultTip\x3d"+
n+"\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26hasWorkingJavascript\x3d1\x26fromAnywhere\x3d"+h("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+b;b=e.setAjaxTransitionHeader({"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":"spc"});h.ajax({type:"POST",url:"/gp/buy/spc/handlers/add-delivery-tip.html/ref\x3dox_tip_page_delivery_tip_add",data:a,headers:b,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",complete:function(){l=!1;m.hide()},
success:g,error:e.ajaxRedirect});l=!1}else c("invalidDeliveryTip_NoAmount");else c("addDeliveryTip_NoAmount")}function g(a,b,c){m.hide()}function c(a){m.hide();h("#tip-error").removeClass("aok-hidden");0<h("div.spc-desktop").length?h("#spc-deliverytipinput").addClass("a-form-error"):h("#spc-deliverytipinput").closest(".a-input-text-wrapper").addClass("a-form-error");h("#"+a).removeClass("aok-hidden")}var l=!1,n=0;b&&(a.declarative("tip-element",["click"],function(a){var b=a.data.click;b&&null!==b&&
d(a.$event)}),b=!1)}var h=a.$;if(!h("html").hasClass("a-ie6")){var b=!0;a.on("checkout:reload:spc",l);a.on("checkout:reload:spclite",l)}});"use strict";q.when("A","checkout-general-utils","page-conductor","loading-spinner-controller").register("checkout-feedback-controller",function(a,m,n,e){function g(){if(!h||"function"!==typeof h)return"";var a=h(),d="";if(a)for(var e in a)if("number"===typeof a[e]||"string"===typeof a[e]||"boolean"===typeof a[e])d+="\x26__pagedata_"+e+"\x3d"+a[e];return d}var l=
a.$,h;a.declarative("checkout-submit-feedback",["click","touchend"],function(a){if(!m.protectAgainstDoubleAction("checkout-submit-feedback",200)&&(a=l("#checkout-feedback-form"),a.length)){e.showSpinner(a,!1);var d=a.serialize(),d=d+g();l.ajax({type:"POST",url:a.attr("action"),data:d,dataType:"text",error:n.ajaxRedirect,success:function(a,b,d){b=d.getResponseHeader("checkout-feedback-submitted");l(".a-button-close").trigger("click");null!==b&&b!==H&&l("#checkout-feedback-banner").append(a)}})}});
return{registerPageDataCollecter:function(a){a&&"function"===typeof a&&(h=a)}}});"use strict";q.when("A","page-spinner-controller","scroll-controller","ajax-utility","page-conductor","checkout-modal-popover","page-detector-current-page","checkout-general-utils","a-popover","client-side-metrics").execute(function(a,m,n,e,g,l,h,b,d,k){function c(){function b(a){a=a.$currentTarget.closest(".delivery-instructions-block");a.find(".edit-delivery-instructions-link").addClass("aok-hidden");a.find(".delivery-instructions-display").addClass("aok-hidden");
var c=a.find(".dynamic-delivery-instructions-update").find(".delivery-instructions-input").attr("maxlength");a.find(".dynamic-delivery-instructions-update").removeClass("aok-hidden");p("#deliveryInstructions").focus();p("#deliveryInstructions").select();p("#deliveryInstructions").keydown(function(a){10===a.which&&a.preventDefault()});p("#deliveryInstructions").keyup(function(){p("#delivery-instructions-left-text").hasClass("aok-hidden")&&p("#delivery-instructions-left-text").removeClass("aok-hidden");
var a=c-p(this).val().length;0>a&&(a=0);p("#delivery-instructions-left").text(a)});setTimeout(function(){},500)}function c(a){m.show();a=a.$currentTarget;var b=p("#deliveryInstructions").val(),e=a.closest(".delivery-instructions-block"),k=a.closest(".dynamic-delivery-instructions-update");e.find(".edit-delivery-instructions-link").removeClass("aok-hidden");e.find(".delivery-instructions-display").removeClass("aok-hidden");k.addClass("aok-hidden");e=(new Date).getTime();b="deliveryInstructions\x3d"+
encodeURIComponent(b)+"\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26hasWorkingJavascript\x3d1\x26fromAnywhere\x3d"+p("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+e;e=g.setAjaxTransitionHeader({"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":h.getCurrentPage()});p.ajax({type:"POST",url:"/gp/buy/spc/handlers/add-delivery-instructions.html/ref\x3dox_instructions_page_delivery_instructions_update",data:b,headers:e,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
dataType:"text",complete:function(){m.hide()},success:d,error:g.ajaxRedirect});a.blur()}function d(a,b,c){(a=e.jsonify(a))&&!p.isEmptyObject(a)&&p("#deliveryInstructionsDisplay").html(a.deliveryInstructions);m.hide()}q&&(a.declarative("edit-delivery-instructions",["click"],b),a.declarative("update-delivery-instructions",["click"],c),q=!1)}var p=a.$;if(!p("html").hasClass("a-ie6")){var q=!0;a.on("checkout:reload:spc",c);a.on("checkout:reload:spclite",c);a.on("checkout:reload:spp-shipaddress",c);a.on("checkout:reload:spp-f3-sosp",
c);a.on("checkout:reload:spp-payment",c)}});"use strict";q.when("A","page-conductor","page-transition-controller").register("installments-service",function(a,m,n){var e=a.$;return{call:function(a,l,h){n.show();e.ajax({type:"POST",url:"/gp/buy/installments/handlers/set-item-installments.html/ref\x3dox_spc_inst_toggle",data:{itemId:a,programId:l},dataType:"text",async:!0,cache:!1,headers:m.setAjaxTransitionHeader(),success:h.success||null,error:h.error||null})},sendReftag:function(a){e.post("/gp/buy/spc/handlers/pmts-continue-widget.html/ref\x3d"+
a)}}});"use strict";q.when("A","page-transition-controller","page-conductor","page-detector","button-blocker","installments-service","client-side-metrics","widgets/installmentsModal/state","allow-installments-page-transition","weblab-helper").register("installments-controller",function(a,m,n,e,g,l,h,b,d,k){function c(){a.defer(q)}function p(a,b,c){d.isEnabled?n.ajaxUpdatePage(a,b,c,{pushNewFrame:"true"}):(m.hide(),n.ajaxUpdatePage(a,b,c,{pushNewFrame:"false"}))}function q(){var a=r("#installments-button-blocker");
1===a.length&&(a=a.data("blocker-message"),g.show("place-order-installments-blocker",a))}var r=a.$;a.declarative("installments-sync-state",["change"],function(a){var c=r("#trigger-installments-modal"),d;if(c.length)if(b.$target=a.$target,b.bundleAsin=a.data.bundleAsin,b.asin=a.data.asin,b.itemId=a.data.itemId,b.isChecked=b.$target.is(":checked"),b.programId=b.isChecked?a.data.programId:"",a={success:p,error:n.ajaxRedirect},b.handlerData=a,d=b.isChecked?"Checkout:Installments:UpdateOptIn":"Checkout:Installments:UpdateOptOut",
b.isChecked)c=b.asin,a=b.bundleAsin,l.call(b.itemId,b.programId,b.handlerData),a?l.sendReftag("installments_toggle_on_asin_"+c+"_bundle_asin_"+a):l.sendReftag("installments_toggle_on_asin_"+c);else{a=b.itemId;var e=b.programId,g=b.handlerData,k=b.asin,m=b.bundleAsin;m&&c.length?(l.sendReftag("installments_toggle_off_asin_"+k+"_bundle_asin_"+m),c.click()):(l.sendReftag("installments_toggle_off_asin_"+k),l.call(a,e,g))}else c=a.data.itemId,e=(d=a.$target.is(":checked"))?a.data.programId:"",a={success:p,
error:n.ajaxRedirect},d=d?"Checkout:Installments:UpdateOptIn":"Checkout:Installments:UpdateOptOut",l.call(c,e,a);h.increaseCount(d)});a.declarative("page-transit-invalidate-ric","click",function(a){if(!n.isAnimating()){a.$event.preventDefault();var b=a.$currentTarget.closest("div.spp-panel");m.shrinkPanel(b,!0);b={invalidate:!0,gurupaRicCSRFToken:r("#gurupaRicCSRFToken").val()};h.increaseCount("Checkout:RetailInstallmentContract:Invalidate");k.isInstallmentsInvalidateRicSetterEnabled()?n.ajaxUpdate("/checkout/p/p-"+
a.data.purchaseId+"/ihi/deleteretailinstallmentcontract?pipelineType\x3dChewbacca\x26referrer\x3dspc",b):r.ajax({type:"POST",url:"/gp/buy/retailinstallmentcontract/handlers/set-line-item-ric.html?_from\x3dgurupa",data:b,async:!0,cache:!1,headers:n.setAjaxTransitionHeader(),success:n.redirect,error:n.redirect})}});a.on("checkout:reload:spp-revieworder",c);a.on("checkout:reload:spc",c)});"use strict";q.when("A","page-conductor","checkout-modal-popover","page-transition-controller","ajax-utility","page-detector",
"payments-portal-common","ready").register("spc-payments-portal",function(a,m,n,e,g,l,h){function b(b,d){d={refTag:d,callbackBeforePageUpdate:function(){a.$("div.a-popover button.a-button-close").trigger("click")}};m.isSPP()&&(d.keepCachedPagesData=1);m.loadPage("spc",b,null,d)}function d(a,b,d){m.isSPP()?(e.blockAllActions(),e.showTransitionInContainer(k("#payment"))):e.show();a="/gp/buy/spc/handlers/pmts-continue-widget.html/ref\x3d"+a;var g=m.setAjaxTransitionHeader({"Cache-Control":"no-cache",
pragma:"no-cache","x-amz-checkout-page":"spc"});k.ajax({type:"POST",url:a,data:b,headers:g,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",success:function(a,b,c){c.getResponseHeader("x-amz-checkout-page")?m.ajaxUpdatePage(a,b,c):d(a)},error:m.ajaxRedirect})}var k=a.$;return{prepareDelegatedPopovers:function(b){function d(a,b){a=k(a);a.data("aCheckoutModalPopover",b);n.createModal({$declarativeParent:a},b)}a.on("pmts:retail:billing-address-popover",function(a){d(".pmts-change-address-link",
{header:b.billingAddressPopoverHeader,footer:"",name:"billing-address",allowScrollOnPage:!0})});a.on("pmts:retail:rewards-registration",function(a){d(".pmts-shop-with-points-learn-more-link",{header:b.rewardsRegistrationPopoverHeader,footer:"",name:"rewards-registration",allowScrollOnPage:!0})})},handleClaimCodeSubmittedEvent:function(a,b){var e={returnjson:"1",returnFullHTML:"1",hasWorkingJavascript:"1",fromAnywhere:k("input[name\x3dfromAnywhere]").val(),cachebuster:(new Date).getTime(),nextAction:"pipeline-dispatch",
embedOnlyData:"1"};a=k.param(a)+"\x26"+k.param(e);d("ox_pay_page_gc_add",a,function(a){h.claimCodePageUpdater(b,a)})},handleChangeBillingAddressRequestedEvent:function(){l.isDesktopSpc()?m.isSPP()?k("#pmts-change-billing-address-popover").trigger("click"):a.trigger("pmts:retail:billing-address-popover"):(e.show(),m.isPipeliningOn()&&b("billingaddressselect","ox_spc_change_ship_addr"))},handleChangePaymentInstrumentRequestedEvent:function(){e.show();m.isPipeliningOn()&&b("payselect","ox_spc_change_payment")},
handleRewardsAccountLearnMoreRequestedEvent:function(){a.trigger("pmts:retail:rewards-registration")},handlePointsAccountSubmittedEvent:function(a){var b={hasWorkingJavascript:"1",isClientTimeBased:k("input[name\x3duseCtb]").val(),nextAction:"dispatch"};a=k.param(a)+"\x26"+k.param(b);d("ox_spc_points_edit",a,function(a){a=g.jsonify(a);m.redirect(a)})}}});"use strict";q.when("ajax-utility","gc-redeem-controller","page-transition-controller","ready").register("payments-portal-common",function(a,m,n){return{claimCodePageUpdater:function(e,
g){g=a.jsonify(g);null!==g?g.widgetJsonData?(e.update(g.widgetJsonData),n.hide()):g.autohandlererror&&m.giftSystemErrorHandling(g.autohandlererror):n.hide()}}});"use strict";q.when("A","page-detector-current-page","a-button","a-meter").register("checkout-throttle-error",function(a,m,n,e){var g=a.$;a.on("checkout:reload:throttle",function(){if(g("#checkout-throttle-meter").length){var a=1E3*g('input[name\x3d"waiting-time"]').val()/100;n("#checkout-throttle-return-to-cart").disable();var h=e("#checkout-throttle-meter"),
b=0,d=setInterval(function(){h.percent(b);if(100>b)b+=1;else{clearInterval(d);var a=n("#checkout-throttle-return-to-cart");a.text(g("#checkout-throttle-primary-button-active-text").text());a.enable()}},a)}})});"use strict";q.when("A","weblab-helper").register("nav-bar-helper",function(a,m){function n(){try{q.register("navCF")}catch(a){if(-1===a.message.toLowerCase().indexOf("already registered"))throw a;}}if(m.isNavCFWeblabOn())a.on("checkout:reload",n)});"use strict";q.register("pipeline-dispatch-endpoint",
function(){return{get:function(a){return a}}});q.when("A").execute(function(a){a.declarative("remaining-customizations-action","click",function(a){a.$currentTarget.parent().find(".remaining_customization_info").removeClass("aok-hidden");a.$currentTarget.hide();a.$event.preventDefault()})});"use strict";q.when("A","checkout-federation-utilities","client-side-metrics").register("checkout-federation-wrapper",function(a,m,n){function e(a){for(var e=[],b=g;b<a.length;b++)e.push(a[b]);return e}var g=2;
return{wrap:function(a,g){try{return a.apply(null,e(arguments))}catch(c){var b=g,d=c,k;k=b;k=m.getExternalDependecies()[k];k=k!==H&&null!==k?k.cti:"Undefined";n.logError(d,"["+b+"] Javascript error thrown while executing wrapper",k,"FATAL");r.console&&r.console.error&&r.console.error(d,b,k)}}}});"use strict";q.when("A","jQuery","checkout-federation-utilities").register("checkout-federation-injector",function(a,m,n){function e(a){a=a.assetsModule;if(g[a]?0:0<m('script[type\x3d"checkout-asset-trigger"][data-checkout-asset-trigger\x3d"'+
a+'"]').length)g[a]=!0,q.register("trigger"+a,function(){})}var g={};a.on("checkout:reload",function(){var a=n.getExternalDependecies(),g;for(g in a)a.hasOwnProperty(g)&&e(a[g])})});"use strict";q.when("A","client-side-metrics").register("checkout-federation-utilities",function(a,m){return{getExternalDependecies:function(){var n=a.state("triggerExternalDependencies");Object&&Object.keys&&m.increaseCount("Checkout:ExternalDependencies:count:"+(n?Object.keys(n).length:"undefined"));return n===H||null===
n?{}:n}}});"use strict";q.register("allow-installments-page-transition",function(){return{isEnabled:!0}})});
/* ******** */
