(function(k){var m=window.AmazonUIPageJS||window.P,l=m._namespace||m.attributeErrors,d=l?l("CalendarWidgetCommonAssets",""):m;d.guardFatal?d.guardFatal(k)(d,window):d.execute(function(){k(d,window)})})(function(k,m,l){k.when("A").register("buttonUtil",function(d){return{setStatus:function(h,e,g){var n=h.find(e);h=[null,"normal","selected","disabled","error","inactive"];e=0>d.indexOfArray(h,g);var l="radio"===n.attr("role");if(e)return k.error(g+" is not a valid status"),!1;d.each(h,function(d){n.removeClass("a-button-"+
d)});n.children(".a-button-inner").children("button,input").prop("disabled","disabled"===g);n.attr("aria-checked",function(d,e){return l?"selected"===g:e});null!==g&&n.addClass("a-button-"+g);return this}}});"use strict";k.when("A","buttonUtil","ready").register("CalendarWidgetActions",function(d,h){var e=d.$,g=function(b,f,d,a){b.find(".dynamic-toggle").each(function(){var b=e(this),f=b.data("property"),c=b.data("value");a.currentSelection[f]&&(f=d.currentSelection[f],f!==l&&f===c?b.removeClass("aok-hidden"):
b.addClass("aok-hidden"))})},n=function(b,f,d){b.find(".dynamic-class").each(function(){var b=e(this),a=b.data("property"),c=b.data("value");if(d.currentSelection[a]){a=f.currentSelection[a];var q=b.data("selected"),g=b.data("unselected");a!==l&&a===c?(b.removeClass(g),b.addClass(q)):(b.removeClass(q),b.addClass(g))}})},k=function(b,f){f.hasOwnProperty("dateId")&&b.find(".a-declarative").each(function(){var b=e(this).find(".a-button-toggle");b&&!b.hasClass("a-button-disabled")&&(b=e(this).data("date-selected"),
b!==l&&b.dateId===f.dateId?h.setStatus(e(this),".calendar-widget-date","selected"):h.setStatus(e(this),".calendar-widget-date","normal"))})},r=function(b,f){f.hasOwnProperty("slotId")&&b.find(".a-declarative").each(function(){var b=e(this).find(".a-button-toggle");b&&!b.hasClass("a-button-disabled")&&(b=e(this).data("slot-selected"),b!==l&&b.slotId===f.slotId?h.setStatus(e(this),".calendar-slot","selected"):h.setStatus(e(this),".calendar-slot","normal"))})},p=function(b,f,a){for(var d=0;d<b.length;d++)if(b[d][f]===
a)return b[d];return l},m=function(b,f){var d=b.dateId;if(!d)return null;f=p(f,"id",d).slots;return(b=b.slotId)?p(f,"id",b):null},c=function(b,f,a){(a=m(f,a))&&null!==a&&d.trigger("calendar_widget_slot_selected",{widgetId:b,slotId:a.id,dateId:f.dateId,timeRange:a.timeRange,metadata:a.metadata})},a=function(b){var f={};d.each(e('script[type\x3d"a-state"]'),function(a,c){e(a).data("a-state").key===b&&(f=d.parseJSON(e(a).html()))});d.state(b,f);return f},t=function(b,a){return(b=(b=a||d.state(b))&&b.currentSelection?
b.currentSelection.slotId:null)&&null!==b?!0:!1},v=function(){var b=e(this),f=b.attr("id"),q=a(f);t(f,q)&&c(f,q.currentSelection,q.dates);d.state.bind(f,function(a,e){e.currentSelection&&(e.currentSelection.dateId&&(g(b,f,a,e),n(b,a,e),h.setStatus(b,".calendar-slot","normal"),k(b,a.currentSelection),d.trigger("calendar_widget_date_selected",{widgetId:f,dateId:a.currentSelection.dateId})),e.currentSelection.slotId&&a.currentSelection.slotId&&(c(a.id,a.currentSelection,a.dates),r(b,a.currentSelection)),
e.currentSelection.currentDatePage&&g(b,f,a,e))})};d.declarative("date-selected","click",function(b){var a=b.data;b=a.dateId;a=a.widgetId;var c=d.state(a);c.currentSelection.dateId=b;c.currentSelection.slotId=null;d.state(a,c)});d.declarative("slot-selected","click",function(b){var a=b.data;b=a.slotId;var c=a.dateId;a=a.widgetId;var e=d.state(a);e.currentSelection.widgetId=a;e.currentSelection.dateId=c;e.currentSelection.slotId=b;d.state(a,e)});d.declarative("previous-page","click",function(b){b=
b.data.widgetId;var a=d.state(b),c=a.currentSelection.currentDatePage;0!==c&&(a.currentSelection.currentDatePage=c-1,d.state(b,a))});d.declarative("next-page","click",function(a){a=a.data.widgetId;var b=d.state(a),c=b.currentSelection.currentDatePage;c!==b.config.lastPage&&(b.currentSelection.currentDatePage=c+1,d.state(a,b))});return{enableWidgetActions:function(a){e("#"+a).each(v)},isSlotSelected:t,getSelectedSlot:function(a){a=d.state(a);if(!a||null===a)return null;var b=a.currentSelection;return b&&
null!==b?m(b,a.dates):null},getFirstSlotForDate:function(a,c){c=d.state(c);if(!c||null===c)return null;a=p(c.dates,"id",a);if(!a||null===a)return null;a=a.slots;var b;a!==l&&0<a.length&&(b=a[0]);return b},getSlotById:function(a,c){c=d.state(c);if(!c||null===c)return null;c=c.dates.reduce(function(a,b){return a.concat(b.slots?b.slots:[])},[]);return 0===c.length?null:(a=p(c,"id",a))?a:null}}});"use strict";k.when("A","CalendarWidgetActions").register("CalendarWidget",function(d,h){return{createWidget:function(e,
g,h,l){d.$.ajax({url:e,type:"POST",dataType:"html",contentType:"application/json",data:JSON.stringify(g),success:function(d){h({payload:d})},error:function(d){l(d)}})},enableWidgetActions:h.enableWidgetActions,isSlotSelected:h.isSlotSelected,getSelectedSlot:h.getSelectedSlot,getFirstSlotForDate:h.getFirstSlotForDate,getSlotById:h.getSlotById}});"use strict";k.when("A","buttonUtil","SlotContainerWidgetConstants","ready").register("SlotContainerWidgetActions",function(d,h,e){var g=d.$,k=function(c,
a){if(c=c.id)a:{for(var d=0;d<a.length;d++)if(a[d].id===c){a=a[d];break a}a=l}else a=null;return a},m=function(c,a,e){e=k(a,e);a&&null!==a&&d.trigger("slot-container-slot-selected",{widgetId:c,slotId:e.id,pageType:a.pageType,callCaseForSDOverride:a.callCaseForSDOverride,metadata:e.metadata})},r=function(c){var a={};d.each(g('script[type\x3d"a-state"]'),function(e,b){g(e).data("a-state").key===c&&(a=d.parseJSON(g(e).html()))});if(a.selectedSlot&&a.selectedSlot.id){var e=g("#"+a.selectedSlot.id).find("[data-action]").data("slotContainerSlotSelected");
a.selectedSlot.pageType=e.pageType;a.selectedSlot.callCaseForSDOverride=e.callCaseForSDOverride;a.selectedSlot.widgetId=l}d.state(c)&&"replace"in d.state&&d.$.isFunction(d.state.replace)?d.state.replace(c,a):d.state(c,a);return a},p=function(c,a){return(c=(c=a||d.state(c))&&c.selectedSlot?c.selectedSlot.id:null)&&null!==c?!0:!1},u=function(){var c=g(this).attr("id"),a=r(c);a&&a.selectedSlot&&a.selectedSlot.pageType===e.SHIP_OPTION_SELECT_PAGE&&p(c,a)&&m(c,a.selectedSlot,a.slots);a=d.state(c+e.STATE_BIND_STATUS);
a&&a.isStateBinded||(d.state(c+e.STATE_BIND_STATUS,{isStateBinded:!0}),d.state.bind(c,function(a,c){a.slots&&a.selectedSlot&&m(a.selectedSlot.widgetId,a.selectedSlot,a.slots)}))};d.declarative("slot-container-slot-selected","click",function(c){var a=c.data;c=a.widgetId;var e=a.slotId,g=a.pageType;a=a.callCaseForSDOverride;var b=d.state(c);b.selectedSlot.widgetId=c;b.selectedSlot.id=e;b.selectedSlot.pageType=g;b.selectedSlot.callCaseForSDOverride=a;d.state(c,b)});d.declarative("open-expander","click",
function(c){var a=g("#"+c.data.widgetId);c=a.find("."+e.EXPANDER_HEADER_CLASS);a=a.find("."+e.HIDDEN_CLASS+"."+e.DYNAMIC_CLASS);c.addClass(e.HIDDEN_CLASS);a.each(function(){g(this).removeClass(e.HIDDEN_CLASS)})});d.declarative("open-expander-chewbacca-mdw","click",function(c){var a=g("#"+c.data.widgetId),d=a.find("."+e.EXPANDER_HEADER_CLASS);a=a.find("."+e.HIDDEN_CLASS+"."+e.DYNAMIC_CLASS);d.addClass(e.HIDDEN_CLASS);a.each(function(){g(this).removeClass(e.HIDDEN_CLASS)});c.$event.preventDefault();
c.$event.stopPropagation()});d.on("scheduled-delivery-mdw:select-slot",function(c){c=g("#"+c);h.setStatus(c,"."+e.SLOT_CLASS,"selected")});d.on("scheduled-delivery-mdw:deselect-slot",function(c){c=g("#"+c);h.setStatus(c,"."+e.SLOT_CLASS,"normal")});return{enableWidgetActions:function(c){g("#"+c).each(u)},isSlotSelected:p,getSelectedSlot:function(c){c=d.state(c);if(!c||null===c)return null;var a=c.selectedSlot;return a&&null!==a?k(a,c.slots):null}}});"use strict";k.when("A","SlotContainerWidgetActions").register("SlotContainerWidget",
function(d,h){return{createWidget:function(e,g,h,k){d.$.ajax({url:e,type:"POST",dataType:"html",contentType:"application/json",data:JSON.stringify(g),success:function(d){h({payload:d})},error:function(d){k(d)},timeout:11E3})},enableWidgetActions:h.enableWidgetActions,isSlotSelected:h.isSlotSelected,getSelectedSlot:h.getSelectedSlot}});"use strict";k.when("A").register("SlotContainerWidgetConstants",function(){return{HIDDEN_CLASS:"aok-hidden",DYNAMIC_CLASS:"dynamic-class",EXPANDER_HEADER_CLASS:"slot-container-expander-heading",
SLOT_CLASS:"slot-container-slot",STATE_BIND_STATUS:"-bind-status",SHIP_OPTION_SELECT_PAGE:"SOSP"}})});
/* ******** */
(function(a){var g=window.AmazonUIPageJS||window.P,h=g._namespace||g.attributeErrors,b=h?h("ServicesWidgetCommonAssets",""):g;b.guardFatal?b.guardFatal(a)(b,window):b.execute(function(){a(b,window)})})(function(a,g,h){a.when("A").register("ServicesWidgetConstants",function(){return{AJAX_CALL_URL:"/scheduleddelivery/widgets/services"}});"use strict";a.when("A","ready").register("ServicesWidgetActions",function(b){b.declarative("service-selected","change",function(e){var d="undefined"!==typeof e.$target.attr("checked"),
f=e.data;e=JSON.parse(f.metadata);var f=f.id,c=b.state(f);c||(c=[]);var k=e.service;if(d)a:{for(d=0;d<c.length;d++)if(c[d].serviceSymbol===k.serviceSymbol)break a;c.push(k)}else for(var d=c,c=[],a=0;a<d.length;a++)d[a].serviceSymbol!==k.serviceSymbol&&c.push(d[a]);b.state(f,c);b.trigger("services_widget_service_selected",{calendarWidgetId:e.calendarWidgetId,selectedServices:c,widgetIndex:e.widgetIndex,trimmedOrderId:e.trimmedOrderId,isAfn:e.isAfn})})});"use strict";a.when("A","ServicesWidgetConstants").register("ServicesWidget",
function(b,a){return{createWidget:function(d,f,c){b.$.ajax({url:a.AJAX_CALL_URL,type:"POST",dataType:"html",contentType:"application/json",data:JSON.stringify(d),success:function(a){f({payload:a})},error:function(a){c(a)}})}}})});
/* ******** */
(function(h){var y=window.AmazonUIPageJS||window.P,t=y._namespace||y.attributeErrors,f=t?t("ScheduledDeliveryDataTransformerJs",""):y;f.guardFatal?f.guardFatal(h)(f,window):f.execute(function(){h(f,window)})})(function(h,y,t){h.when("A","ready").register("SDTransformerConstants",function(){return{TRANSFORMER_OUTPUT_CACHE_KEY:"goldenTransformerOutputKey",SLOT_LIST_CACHE_KEY:"goldenCacheKey",RAP_SERVICE_URL:"/gp/product/features/scheduled-delivery/sd-get-slots-coral.html",NO_SERVICES_KEY:"",SD_RESERVATION_ID_FIELD_TYPE_DELIMITER:";",
SD_RESERVATION_ID_LIST_ITEM_DELIMITER:",",SD_RESERVATION_ID_CURRENCY_DELIMITER:"^",SD_RESERVATION_ID_COMPLEX_SERVICE_DELIMITER:"^",SD_RESERVATION_ID_BASIC_SERVICE_DELIMITER:"",SERVICE_IDS_TO_FILTER_FROM_DISPLAY:["AgeVerification:True","Saturday:true","TestService:Basic","Evening:true"],AJAX_FAILURE:"ajaxCallFailure",VALIDATION_FAILURE:"validationException",DATA_TRANSFORMATION_FAILURE:"dataTransformationException"}});"use strict";h.when("A","SDTransformerConstants","ready").register("GoldenCxDataTransformerUtil",
function(f,c){function d(b){return b===this.element}return{validateMandatoryFields:function(b,a){return b.map(function(b){return[b,a[b]!==t]}).reduce(function(b,a){var g=a[0];a[1]||b.push(Error(g+" is invalid"));return b},[])},arrayContainsAll:function(b,a){return a&&0!==a.length?a.every(function(a){return b.includes(a)}):!0},addElementToArray:function(b,a){a&&-1===b.findIndex(d,{element:a})&&b.push(a)},generateFailurePayload:function(b,a){return{type:b,data:a}}}});"use strict";h.when("A","RapServiceCall",
"GoldenCxDataTransformerUtil","SDTransformerConstants","GoldenCxDataTransformer","ready").register("GoldenCxRapServiceIntegration",function(f,c,d,b,a){var k="marketplace shipoption address lineItems widgetIndex client calendarWidgetId servicesWidgetId trimmedOrderId isAfn".split(" "),v="itemID merchantID merchantSKU inventoryAuthorityID offerListingID fulfillmentManagerID totalQuantity".split(" ");return{getWidgetInputParameters:function(a,E,l){var e;a:{var m=d.validateMandatoryFields(k,a);if(0<m.length)e=
m;else{for(e in a.lineItems)if(m=d.validateMandatoryFields(v,a.lineItems[e]),0<m.length){e=m;break a}e=[]}}if(0<e.length)return a=d.generateFailurePayload(b.VALIDATION_FAILURE,e),l(a);c.getSlots(a,E,l)},getCachedCalendarWidgetInputParameters:function(g,c,v){(g=a.getCalendarWidgetInputParametersFromCache(g))?c(g):(c=d.generateFailurePayload(b.DATA_TRANSFORMATION_FAILURE,"Unable to retrieve widget input parameters"),v(c))}}});"use strict";h.when("A","SDTransformerConstants","SDTransformerSlotQualityUtil",
"SDTransformerDefaultSlotUtil","SDTransformerRapSlotsMergeUtil","ready").register("GoldenCxDataTransformer",function(f,c,d,b,a){function k(c,g,k,l){c=a.getFilteredSlotsGroupedByTime(c,g,l.udsServiceCodes);var e=d.getSlotQuality(c.hasMultipleSlotsForADay),m=c.slots,f=[],x,C;for(C in m){var h=a.getMergedSlotsInformation(m[C],g,k),p;p=h;var z=l,w=e,r=p.timeRange,n=p.legacyTimeWindows,q=p.priceInformation,u={srsIds:p.srsSlotIdentifiers,reservationId:p.reservationId,reservationType:"RAP",carriers:p.carriers,
shortTimezone:p.shortTimezone,longTimezone:p.longTimezone,startTimeLocalTimezone:r.startTime,startTimeUTC:n.s,endTimeLocalTimezone:r.endTime,endTimeUTC:n.e,fss:p.fss},B=k?k.shipmentDates:t;B&&(u.minShipDate=B.startTime,u.maxShipDate=B.endTime);z.isAfn||(u.cutoffTimeUTC=n.c,u.cutOffTimeLocalTimezone=p.minCutoffTime);p={startTime:r.startTime,endTime:r.endTime,price:q.price,priceCurrency:q.priceCurrency,metadata:JSON.stringify({version:"1.0",widgetIndex:z.widgetIndex,trimmedOrderId:z.trimmedOrderId,
slotQuality:w,slotQualityDetail:"CUSTOMER_NOMINATED",slot:u})};x=b.getDefaultSlotInformationWithSelectedSlot(x,p,h.longTimezone,l.selectedSlot);f.push(p)}var D;x&&x.slot&&(x.slot.isDefault=!0,D=x.timezone);return{services:c.services,goldenCxSlots:f,timezone:D}}return{transform:function(b,g){var d={},l=b.rapSlotIntersections;if(!l||null===l||0===l.length)return d;var e=k(l,g.selectedServiceList,b.shippingProperties,g),l={widgetId:g.calendarWidgetId,client:g.client,timezone:e.timezone,marketplaceId:g.marketplace,
customerId:g.customerId,isPrimeCustomer:g.isPrimeCustomer,isAfn:g.isAfn,addressId:g.addressId,sessionId:g.sessionId,slots:e.goldenCxSlots,isSlotPreviouslySelected:g.isSlotPreviouslySelected};d.calendarInput=l;d.widgetIndex=g.widgetIndex;e=a.getServicesToDisplay(e.services,g.marketplace,g.udsServiceCodes);if(0<e.length){for(var m=[],A=0;A<e.length;A++){var x=e[A],h=x.charge.perUnitCharge,x={serviceSymbol:x.serviceSymbol,price:h.Value,priceCurrency:h.Unit,metadata:JSON.stringify({version:"1.0",widgetIndex:g.widgetIndex,
trimmedOrderId:g.trimmedOrderId,isAfn:g.isAfn,calendarWidgetId:g.calendarWidgetId,servicesWidgetId:g.servicesWidgetId,service:x})};m.push(x)}d.servicesInput={widgetId:g.servicesWidgetId,client:g.client,isSelectable:!0,marketplaceId:g.marketplace,customerId:g.customerId,sessionId:g.sessionId,services:m}}g=c.TRANSFORMER_OUTPUT_CACHE_KEY.concat(g.calendarWidgetId);f.state(g,{rapResponse:b,calendarWidgetInputParameters:l});return d},transformRaplessSlots:function(a,b){if(a&&a.availableSlots&&0<a.availableSlots.length){for(var c=
[],d=0;d<a.availableSlots.length;d++){var e=a.availableSlots[d],m=e.totalItemCharge+"^"+e.totalShipmentCharge+"^"+e.currencyCode,m=e.reservationIds.join()+";"+e.carrierNames.join()+";"+m+";",m={srsIds:e.reservationIds,reservationId:m,reservationType:"RAP",carriers:e.carrierNames,shortTimezone:a.deliveryTimeZoneShort,longTimezone:a.deliveryTimeZone,startTimeLocalTimezone:e.slotStartTime,startTimeUTC:e.slotStartTimeUTC,endTimeLocalTimezone:e.slotEndTime,endTimeUTC:e.slotEndTimeUTC,fss:e.fulfillmentServiceSubclass};
b.isAfn?(m.minShipDate=e.promiseMinShipmentDate,m.maxShipDate=e.promiseMaxShipmentDate):(m.cutOffTimeLocalTimezone=e.cutoffTime,m.cutoffTimeUTC=e.cutoffTimeUTC);e={startTime:Number(e.slotStartTime),endTime:Number(e.slotEndTime),price:Number(e.deliveryPrice),priceCurrency:e.currencyCode,metadata:JSON.stringify({version:"1.0",widgetIndex:b.widgetIndex,trimmedOrderId:b.trimmedOrderId,slotQuality:e.slotQuality,slotQualityDetail:e.slotQualityDetail,slot:m})};c.push(e)}if(0<c.length)a:{if((e=b.selectedSlot)&&
e.start&&e.end)for(d=parseInt(e.start),m=parseInt(e.end),e=0;e<c.length;e++){var k=c[e];if(k.startTime===d&&k.endTime===m){c[e].isDefault=!0;break a}}for(e=d=0;e<c.length;e++)c[e].startTime<c[d].startTime?d=e:c[e].startTime===c[d].startTime&&c[e].endTime<c[d].endTime&&(d=e);c[d].isDefault=!0}return{calendarInput:{widgetId:b.calendarWidgetId,client:b.client,timezone:a.deliveryTimeZone,marketplaceId:b.marketplace,customerId:b.customerId,isPrimeCustomer:b.isPrimeCustomer,isAfn:b.isAfn,sessionId:b.sessionId,
addressId:b.addressId,slots:c,isSlotPreviouslySelected:b.isSlotPreviouslySelected},widgetIndex:b.widgetIndex}}},getCalendarWidgetInputParametersFromCache:function(b){var a=c.TRANSFORMER_OUTPUT_CACHE_KEY.concat(b.calendarWidgetId);if(a=f.state(a)){var d=a.rapResponse;b=k(d.rapSlotIntersections,b.selectedServices,d.shippingProperties,b);a=a.calendarWidgetInputParameters;a.slots=b.goldenCxSlots;return{calendarInput:a}}}}});"use strict";h.when("A","SDTransformerConstants","GoldenCxDataTransformerUtil",
"GoldenCxDataTransformer","ready").register("RapServiceCall",function(f,c,d,b){return{getSlots:function(a,k,v){var g={marketplace:a.marketplace,shipoption:a.shipoption,address:a.address,lineItems:a.lineItems};a.path&&"Rapless"===a.path&&(g.path="Rapless");var h={widgetIndex:a.widgetIndex,calendarWidgetId:a.calendarWidgetId,servicesWidgetId:a.servicesWidgetId,trimmedOrderId:a.trimmedOrderId,client:a.client,marketplace:a.marketplace,selectedServiceList:a.selectedServiceList,sessionId:a.sessionId!==
t?a.sessionId:null,customerId:a.customerId!==t?a.customerId:null,isPrimeCustomer:!!a.isPrimeCustomer,addressId:a.address!==t?a.address:null,isAfn:1===a.isAfn?!0:!1,udsServiceCodes:a.udsServiceCodes,selectedSlot:a.selectedSlot!==t?a.selectedSlot:null,isSlotPreviouslySelected:a.isSlotPreviouslySelected};f.ajax(c.RAP_SERVICE_URL,{method:"post",dataType:"json",contentType:"application/x-www-form-urlencoded;charset\x3dUTF-8",params:{ajaxCallParams:JSON.stringify(g)},success:function(a){a=a.path&&"Rapless"===
a.path?b.transformRaplessSlots(a,h):b.transform(a,h);k(a)},error:function(){var a=d.generateFailurePayload(c.AJAX_FAILURE,g);v(a)},timeout:5E3,traditional:!0})}}});"use strict";h.when("A","SDTransformerConstants","SDTransformerServiceSymbolUtil","ready").register("SDReservationIdUtil",function(f,c,d){return{calculateReservationId:function(b,a,k,f,g,h){Array.isArray(b)&&(b=b.join(c.SD_RESERVATION_ID_LIST_ITEM_DELIMITER));Array.isArray(a)&&(a=a.join(c.SD_RESERVATION_ID_LIST_ITEM_DELIMITER));b=b+c.SD_RESERVATION_ID_FIELD_TYPE_DELIMITER+
a+c.SD_RESERVATION_ID_FIELD_TYPE_DELIMITER+k+c.SD_RESERVATION_ID_CURRENCY_DELIMITER+f+c.SD_RESERVATION_ID_CURRENCY_DELIMITER+g+c.SD_RESERVATION_ID_FIELD_TYPE_DELIMITER;if(h){if(Array.isArray(h)){a=[];k=[];f="";for(var l in h)g=h[l],d.isBasicService(g)?a.push(g):k.push(g);0<a.length&&(f=a.join(c.SD_RESERVATION_ID_BASIC_SERVICE_DELIMITER));0<a.length&&0<k.length&&(f+=c.SD_RESERVATION_ID_COMPLEX_SERVICE_DELIMITER);0<k.length&&(f+=k.join(c.SD_RESERVATION_ID_COMPLEX_SERVICE_DELIMITER));h=f}b+=h}return b}}});
"use strict";h.when("A","ready").register("SDTransformerDefaultSlotUtil",function(f){var c=function(c,b,a){return{slot:c,timezone:b,isSelectedSlot:a}};return{getDefaultSlotInformation:function(d,b,a){var k=d&&null!==d?d.slot:null;return!k||null===k||b.price<k.price||d.slot.price===b.price&&(b.startTime<k.startTime||b.startTime===k.startTime&&b.endTime<k.endTime)?c(b,a):d},getDefaultSlotInformationWithSelectedSlot:function(d,b,a,k){var f=d&&null!==d?d.slot:null;return d&&null!==d&&d.isSelectedSlot?
d:k&&null!==k&&b.startTime.toString()===k.start&&b.endTime.toString()===k.end&&a===k.tz?c(b,a,!0):!f||null===f||b.price<f.price||d.slot.price===b.price&&(b.startTime<f.startTime||b.startTime===f.startTime&&b.endTime<f.endTime)?c(b,a,!1):d}}});"use strict";h.when("A","ready").register("SDTransformerSlotQualityUtil",function(f){return{getSlotQuality:function(c){return c?"TIME":"DAY"}}});"use strict";h.when("A","ready").register("SDTransformerServiceSymbolUtil",function(f){var c={"Assembly:Basic":"A:B",
"Assembly:Complex":"A:C","Assembly:Moderate":"A:M","Assembly:Specialized":"A:S","Installation:BuiltInBasic":"I:B","Installation:BuiltInComplex":"I:C","Installation:BuiltInElectronics":"I:I","Installation:BuiltInModerate":"I:M","Installation:StandAloneBasic":"I:A","Installation:StandAloneElectronics":"I:E","Evening:true":"E","Haulaway:true":"H","Installation:true":"I","Recycling:true":"R","Unpack:true":"U","Saturday:true":"S","Delivery:RoomOfChoice":"D:R","Delivery:InsideEntryway":"D:E"},d=["E","H",
"I","R","S"];return{getServiceSymbol:function(b){return c[b]},isBasicService:function(b){return 0<=d.indexOf(b)}}});"use strict";h.when("A","ready").register("SDTransformerFssUtil",function(f){var c=["FAST_TRACK_SAME_DAY","FAST_TRACK_FUTURE_DAY","NOT_FAST_TRACK"];return{calculateFss:function(d,b){var a;d&&b&&(b=b.map(function(a){a=c.indexOf(d[a]);return-1===a?Infinity:a}),b=Math.min.apply(Math,b),a=Infinity===b?t:c[b]);return a}}});"use strict";h.when("A","SDTransformerServiceSymbolUtil","SDTransformerConstants",
"SDTransformerFssUtil","SDReservationIdUtil","GoldenCxDataTransformerUtil","SDTransformerPolyfill","ready").register("SDTransformerRapSlotsMergeUtil",function(f,c,d,b,a,k){function h(a){return a.serviceId===this.serviceId}var g=function(a){var b=c.getServiceSymbol(a.serviceId);return a.serviceSymbol=b},y=function(a){a=new Date(1E3*a);return a.getMonth()+"-"+a.getDate()},l=function(a,b){-1===a.findIndex(h,{serviceId:b.serviceId})&&a.push(b)},e=function(a){return a.map(function(a){return a.slotID})};
return{getFilteredSlotsGroupedByTime:function(a,b,c){var e={},f=!1,h=[],z=[],w=[];b?w=b.map(function(a){return a.serviceSymbol}):c&&(w=c);for(b=0;b<a.length;b++){c=a[b];for(var r=[],n=c.services,q=[],u=0;u<n.length;u++){var t=n[u],v=g(t);d.SERVICE_IDS_TO_FILTER_FROM_DISPLAY.includes(t.serviceId)?k.addElementToArray(r,v):(l(z,n[u]),k.addElementToArray(q,v))}c.invisibleServices=r;k.arrayContainsAll(q,w)&&(r=c.timeRange,n=r.startTime+"-"+r.endTime,(q=e[n])?q.push(c):(e[n]=[c],f||(c=y(r.startTime),f=
h[c]&&!0===h[c]?!0:!1,h[c]=!0)))}return{slots:e,hasMultipleSlotsForADay:f,services:z}},getMergedSlotsInformation:function(c,d,f){for(var g=c[0],h=g.carriers,p=g.srsSlotIdentifiers,l=g,w=g,r=1;r<c.length;r++){var n=c[r],h=h.concat(n.carriers),p=p.concat(n.srsSlotIdentifiers);l.minCutoffTime>=n.minCutoffTime||(l=n);w.charge.perShipmentCharge.Value>=n.charge.perShipmentCharge.Value||(w=n)}c=l.minCutoffTime;r=l.legacyTimeWindows;f=b.calculateFss(f?f.carrierFastTrackMap:t,h);var p=e(p),q=w.charge,w={};
w.price=q.perUnitCharge.Value+q.perShipmentCharge.Value;w.priceCurrency=q.perUnitCharge.Unit;var n=q.perUnitCharge.Value,q=q.perShipmentCharge.Value,u=[],u=u.concat(l.invisibleServices);if(d)for(l=0;l<d.length;l++){var v=d[l];k.addElementToArray(u,v.serviceSymbol);v=v.charge;n+=v.perUnitCharge.Value;q+=v.perShipmentCharge.Value}n=+n.toFixed(2);q=+q.toFixed(2);d=a.calculateReservationId(p,h,n,q,w.priceCurrency,u);return{srsSlotIdentifiers:p,minCutoffTime:c,legacyTimeWindows:r,reservationId:d,timeRange:g.timeRange,
shortTimezone:g.shortFormTz,longTimezone:g.timeZone,carriers:h,priceInformation:w,fss:f}},getServicesToDisplay:function(a,b,c){return c===t?a:[]}}});"use strict";h.when("A","ready").register("SDTransformerPolyfill",function(){Array.prototype.map||(Array.prototype.map=function(f){var c,d,b;if(null==this)throw new TypeError("this is null or not defined");var a=Object(this),k=a.length>>>0;if("function"!==typeof f)throw new TypeError(f+" is not a function");1<arguments.length&&(c=arguments[1]);d=Array(k);
for(b=0;b<k;){var h;b in a&&(h=a[b],h=f.call(c,h,b,a),d[b]=h);b++}return d});Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(f,c){if(null==this)throw new TypeError('"this" is null or not defined');var d=Object(this),b=d.length>>>0;if("function"!==typeof f)throw new TypeError("predicate must be a function");for(var a=0;a<b;){if(f.call(c,d[a],a,d))return a;a++}return-1},configurable:!0,writable:!0});Array.prototype.reduce||Object.defineProperty(Array.prototype,
"reduce",{value:function(f){if(null===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!==typeof f)throw new TypeError(f+" is not a function");var c=Object(this),d=c.length>>>0,b=0,a;if(2<=arguments.length)a=arguments[1];else{for(;b<d&&!(b in c);)b++;if(b>=d)throw new TypeError("Reduce of empty array with no initial value");a=c[b++]}for(;b<d;)b in c&&(a=f(a,c[b],b,c)),b++;return a}});Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",
{value:function(f,c){if(null==this)throw new TypeError('"this" is null or not defined');var d=Object(this),b=d.length>>>0;if(0===b)return!1;c|=0;for(c=Math.max(0<=c?c:b-Math.abs(c),0);c<b;){var a=d[c],h=f;if(a===h||"number"===typeof a&&"number"===typeof h&&isNaN(a)&&isNaN(h))return!0;c++}return!1}})})});
/* ******** */
(function(q){var r=window.AmazonUIPageJS||window.P,x=r._namespace||r.attributeErrors,c=x?x("ScheduledDeliveryCheckoutAssets",""):r;c.guardFatal?c.guardFatal(q)(c,window):c.execute(function(){q(c,window)})})(function(q,r,x){q.when("A").register("SDWidgetsConstants",function(){return{CALENDAR_AJAX_CALL_URL:"/scheduleddelivery/widgets/calendar",SD_NOT_AVAILABLE_ID_PREFIX:"#sd-not-available-",SD_NOTE_ID_PREFIX:"#sd-widget-note-",SD_CHANGE_LINK_ID_PREFIX:"#sd-widget-change-link-",SD_CALENDAR_WIDGET_PREFIX:"sd-calendar-widget-",
SD_WIDGETS_PREFIX:"sd-widgets-",SD_WIDGETS_SPINNER_PREFIX:"#sd-widget-spinner-",SD_WIDGETS_POPOVER_NAME_PREFIX:"scheduled-delivery-popover-name-",UPSELL_MESSAGE_PREFIX_COLON:": ",UPSELL_MESSAGE_PREFIX_HYPHEN:"- ",UPSELL_MESSAGE_PREFIX_DASH:"— ",SD_UPSELL_MESSAGE_PREFIX:"sd-upsell-messaging-",UPSELL_MESSAGE_CLASS:".upsell-messaging",SD_UDS_ERROR_MESSAGE:"UDS service code missing from hard coded map",SD_MDW_WIDGET_ROOT_CLASS:".sd-mdw-widget-root",SD_MDW_SLOT_CONTAINER_WIDGET_PREFIX:"sd-slot-container-widget-",
SD_CALENDAR_WIDGET_RENDER_ERROR_METRIC:"GoldenCXCalendarRenderErrorCount",SD_CALENDAR_WIDGET_RENDER_SUCCESS_METRIC:"GoldenCXCalendarRenderSuccessCount",SD_SERVICE_WIDGET_DISABLED:"GoldenCXServiceWidgetDisabled",SD_SERVICE_WIDGET_LOADED:"GoldenCXServiceWidgetLoaded",SD_SERVICE_WIDGET_RENDER_ERROR_METRIC:"GoldenCXServicesRenderErrorCount",SD_WIDGET_HAS_GVDGO_SLOTS_METRIC:"GoldenCXWidgetHasGvdgoSlots",SD_WIDGET_LOAD_ERROR_METRIC:"GoldenCXWidgetLoadErrorCount",SD_WIDGET_LOAD_INFORMATION_METRIC:"GoldenCXWidgetLoadInformation",
SD_WIDGET_NO_GVDGO_SLOTS_METRIC:"GoldenCXWidgetNoGvdgoSlots",SD_WIDGET_NO_SLOTS_METRIC:"GoldenCXWidgetNoSlots",SD_WIDGET_NO_SHIPOPTION_LEVEL_PRICE_METRIC:"GoldenCXWidgetNoShipoptionLevelPrice",SD_WIDGET_NO_SLOT_LEVEL_PRICE_METRIC:"GoldenCXWidgetNoSlotLevelPrice",SD_WIDGET_RAPLESS_ASYNC_METRIC:"GoldenCXWidgetRaplessAsync",SD_WIDGET_SHADOW_BOTH_SLOTS_EXIST_METRIC:"GoldenCXWidgetShadowBothSlotsExist",SD_WIDGET_SHADOW_BOTH_SLOTS_NOT_EXIST_METRIC:"GoldenCXWidgetShadowBothSlotsNotExist",SD_WIDGET_SHADOW_COMPARISON_METRIC:"GoldenCXWidgetShadowComparison",
SD_WIDGET_SHADOW_ONLY_HAS_GVDGO_SLOTS_METRIC:"GoldenCXWidgetShadowOnlyHasGvdgoSlots",SD_WIDGET_SHADOW_ONLY_HAS_RAP_SLOTS_METRIC:"GoldenCXWidgetShadowOnlyHasRapSlots",SD_WIDGET_SHADOW_RAP_TEN_PLUS_SLOTS_MORE_METRIC:"GoldenCXWidgetShadowRapTenPlusSlotsMore",SD_WIDGET_SHADOW_RAP_FIVE_PLUS_SLOTS_MORE_METRIC:"GoldenCXWidgetShadowRapFivePlusSlotsMore",SD_WIDGET_SHADOW_RAP_ONE_PLUS_SLOTS_MORE_METRIC:"GoldenCXWidgetShadowRapOnePlusSlotsMore",SD_WIDGET_SHADOW_RAP_ONE_SLOT_MORE_METRIC:"GoldenCXWidgetShadowRapOneSlotMore",
SD_WIDGET_SHADOW_GVDGO_TEN_PLUS_SLOTS_MORE_METRIC:"GoldenCXWidgetShadowGvdgoTenPlusSlotsMore",SD_WIDGET_SHADOW_GVDGO_FIVE_PLUS_SLOTS_MORE_METRIC:"GoldenCXWidgetShadowGvdgoFivePlusSlotsMore",SD_WIDGET_SHADOW_GVDGO_ONE_PLUS_SLOTS_MORE_METRIC:"GoldenCXWidgetShadowGvdgoOnePlusSlotsMore",SD_WIDGET_SHADOW_GVDGO_ONE_SLOT_MORE_METRIC:"GoldenCXWidgetShadowGvdgoOneSlotMore",SD_WIDGET_SHADOW_SLOTS_FADD_PRICE_MISMATCH_METRIC:"GoldenCXWidgetShadowSlotsFaddPriceMismatch",SD_WIDGET_SHADOW_SLOTS_FADD_TIME_MISMATCH_METRIC:"GoldenCXWidgetShadowSlotsFaddTimeMismatch",
SD_WIDGET_SHADOW_SLOTS_FADD_TIME_MISMATCH_GVDGO_START_LATE_METRIC:"GoldenCXWidgetShadowSlotsFaddTimeMismatchGvdgoStartLate",SD_WIDGET_SHADOW_SLOTS_FADD_TIME_MISMATCH_GVDGO_START_EARLY_METRIC:"GoldenCXWidgetShadowSlotsFaddTimeMismatchGvdgoStartEarly",SD_WIDGET_SHADOW_SLOTS_FADD_TIME_MISMATCH_GVDGO_END_LATE_METRIC:"GoldenCXWidgetShadowSlotsFaddTimeMismatchGvdgoEndLate",SD_WIDGET_SHADOW_SLOTS_FADD_TIME_MISMATCH_GVDGO_END_EARLY_METRIC:"GoldenCXWidgetShadowSlotsFaddTimeMismatchGvdgoEndEarly",SD_WIDGET_SHADOW_SLOTS_LENGTH_MISMATCH_METRIC:"GoldenCXWidgetShadowSlotsLengthMismatch",
SD_WIDGET_SHADOW_SLOTS_PRICE_MISMATCH_METRIC:"GoldenCXWidgetShadowSlotsPriceMismatch",SD_WIDGET_SHADOW_SLOTS_TIME_MISMATCH_METRIC:"GoldenCXWidgetShadowSlotsTimeMismatch",SD_CALENDAR_WIDGET_SLOT_CHANGE_TRIGGER_ERROR_METRIC:"GoldenCXSlotChangeNotificationErrorCount",SD_CALENDAR_WIDGET_NO_VAS_SHIP_GROUP_ID:"GoldenCXCalendarNoVASGroupIdErrorCount",SD_MDW_UPDATE_SDI_COUNT_METRIC:"MDWUpdateSDICallCount",SD_SHADOW_DUP_ERROR_METRIC:"GoldenCXDupShadowErrorCount",SD_SHADOW_REGISTER_METRIC:"GoldenCXShadowWidgetRegCount",
SD_SHADOW_LOAD_METRIC:"GoldenCXShadowLoadCount",CONTINUE_BUTTON_OWNER:"SD",SD_SLOT_CONTAINER_WIDGET_RENDER_SUCCESS_METRIC:"MdwSlotWidgetRenderSuccessCount",SD_SLOT_CONTAINER_WIDGET_RENDER_ERROR_METRIC:"MdwSlotWidgetRenderErrorCount",SD_MDW_DISABLE_SHIP_OPTION_METRIC:"MdwShipOptionDisableCount",SD_SLOT_CONTAINER_WIDGET_NO_SLOTS_METRIC:"MdwSlotWidgetNoSlotsCount",MDW_WIDGET_INTERACTION_DELIVERY_INFORMATION_EMIT_SUCCESS_METRIC:"MdwWidgetInteractionDeliveryInformationEmitSuccessful",MDW_WIDGET_INTERACTION_DELIVERY_INFORMATION_EMIT_FAIL_METRIC:"MdwWidgetInteractionDeliveryInformationEmitFailed",
MDW_GET_ORDER_ID_FROM_WIDGET_ID_FAILURE_METRIC:"MdwGetOrderIdFromWidgetIdFailed",MDW_GET_SHIP_SPEED_NAME_FROM_WIDGET_ELEMENT_FAILURE_METRIC:"MdwGetShipSpeedNameFromWidgetElementFailed",MDW_GET_SELECTED_SHIP_SPEED_NAME_FROM_WIDGET_ELEMENT_FAILURE_METRIC:"MdwGetSelectedShipSpeedNameFromWidgetElementFailed",MDW_GET_TIMEZONE_FROM_WIDGET_ID_FAILED_METRIC:"MdwGetTimezoneFromWidgetIdFailed",SLOT_CONTAINER_AJAX_CALL_URL:"/scheduleddelivery/widgets/slotcontainer",AOK_HIDDEN:"aok-hidden",SHIP_OPTION_SELECT_PAGE:"SOSP",
SINGLE_PAGE_CHECKOUT:"SPC",SLOT_CONTAINER_WIDGET_ROOT_PREFIX:"sd_widgets_"}});"use strict";q.when("A").register("SDDisableServiceWidget",function(c){return{enabled:!1}});"use strict";q.when("A").register("SDGoldenCXTransformer",function(c){return{transform:function(c){return{calendar:{widgetId:c.widgetIndex,timezone:"America/Los_Angeles",marketplaceId:"A1VC38T7YXB528",sessionId:"123",customerId:"Agatha",client:"SOSP",slots:[{startTime:1551362400,endTime:1551373200,isFree:!0,isDefault:!0},{startTime:1551373200,
endTime:1551384E3,isFree:!1,price:12.99,priceCurrency:"GBP"},{startTime:1551373200,endTime:1551384E3,isFree:!1,price:12.99,priceCurrency:"GBP"},{startTime:1551448800,endTime:1551459600,isFree:!1,price:10.99,priceCurrency:"GBP"},{startTime:1551621600,endTime:1551632400,isFree:!1,price:10.99,priceCurrency:"GBP"}]},services:{widgetId:c.widgetIndex,marketplaceId:"ATVPDKIKX0DER",sessionId:"session",customerId:"customer",client:"SOSP",isSelectable:!0,services:[{serviceSymbol:"R",price:12.99,priceCurrency:"USD",
isDefault:!1,isFree:!1},{serviceSymbol:"D:E",price:10.99,priceCurrency:"USD",isDefault:!0,isFree:!1},{serviceSymbol:"D:R",isDefault:!0,isFree:!0,metadata:"abc to send bla"}]}}}}});"use strict";q.register("sdLogger",function(){return{logMetric:function(c,h){if("undefined"!==typeof r.ue&&"undefined"!==typeof c&&"undefined"!==typeof r.ue.count){var e=r.ue.count(c)||0;r.ue.count(c,e+(h||1))}},logException:function(c,h){var e={logLevel:"ERROR",attribution:2<arguments.length&&arguments[2]!==x?arguments[2]:
"scheduled_delivery_golden_cx_widget",message:h};"undefined"!==typeof r.ueLogError&&r.ueLogError(c,e)}}});"use strict";q.when("A","page-detector","SDWidgetsConstants","ready").register("SDShipOptionHandler",function(c,h,e){function n(a){var u=d(a.currentTarget);a=u.find("input[type\x3d'radio']");u=k(u);a=a.attr("name");c.trigger("scheduled-delivery-mdw:ship-option-changed",{current:u,previous:b[a]});b[a]=u}function k(a){a=a.find(e.SD_MDW_WIDGET_ROOT_CLASS);return 0<a.length?a.attr("id"):null}function a(a){a=
d("#"+a).find("[id^\x3d"+e.SD_MDW_SLOT_CONTAINER_WIDGET_PREFIX+"]");if(!a&&!a.attr("id"))return null;a=a.attr("id");return(a=c.state(a))&&a.selectedSlot&&a.selectedSlot.id?a.selectedSlot.id:null}var d=c.$,b={},l=function(){b={};h.isMobile()?d("div.selectable-box input[type\x3d'radio']:checked").each(function(){var a=d(this),c=a.closest("div.selectable-box");(c=k(c))&&(b[a.attr("name")]=c)}):d("div.fake-label input[type\x3d'radio']:checked").each(function(){var a=d(this),c=a.closest("div.fake-label");
(c=k(c))&&(b[a.attr("name")]=c)})};c.on("checkout:reload:shipoptionselect",l);c.on("checkout:reload:spp-revieworder",l);h.isSosp()&&l();var t=!1;d(document).delegate(".ship-option.is-scheduled-delivery","mousedown",function(a){t=d(a.currentTarget).find("input[type\x3d'radio']").is(":checked")});d(document).delegate(".ship-option.is-scheduled-delivery","click",function(a){if(h.isSpc()){var b=d(a.target);if(!b.closest("a").hasClass("slot-container-expander-heading")){a=d(a.currentTarget);var u=a.find("input[type\x3d'radio']");
if(!b.closest("a").hasClass("sd-ship-option-selection-change")&&!u.attr("disabled")&&(u.is(":checked")||u.attr("checked",!0),!t)){u.closest(".shipping-speed").addClass("selected");var e;a:{if((e=a.find(".a-declarative"))&&(e=e.data("a-modal"))&&e.data&&(e=e.data,e.hasOwnProperty("widgetIndex"))){e=e.widgetIndex;break a}e=null}e?c.trigger("scheduled-delivery-ship-option-selected",u,e):b.closest("li").hasClass("slot-container-slot-item")||(b=k(a))&&c.trigger("slot-selected-update-sdi",b)}}}});d(document).delegate("div.fake-label",
"click",function(a){h.isSosp()&&!h.isMobile()&&n(a)});d(document).delegate("div.selectable-box","click",function(a){h.isSosp()&&h.isMobile()&&n(a)});c.on("scheduled-delivery-mdw:ship-option-changed",function(a){var b=a.current;a=a.previous;b&&b!==a&&c.trigger("scheduled-delivery-mdw:ship-option-selected",b);a&&b!==a&&c.trigger("scheduled-delivery-mdw:ship-option-deselected",a)});c.on("scheduled-delivery-mdw:ship-option-selected",function(b){(b=a(b))&&c.trigger("scheduled-delivery-mdw:select-slot",
b)});c.on("scheduled-delivery-mdw:ship-option-deselected",function(b){(b=a(b))&&c.trigger("scheduled-delivery-mdw:deselect-slot",b)});return{disableShipOption:function(a,b){a=d("#"+a);if(0!==a.length){if(h.isSpc())a=a.closest(".shipping-speed");else if(h.isSosp())a=h.isMobile()?a.closest("div.selectable-box.scheduled-delivery.a-box"):a.closest("div.fake-label.a-box");else return;var c=a.find("input[type\x3d'radio']");c.attr("disabled",!0);c.is(":checked")&&b&&(b=d("input[name\x3d"+c.attr("name")+
"]:radio:not(:disabled):first"),b.prop("checked",!0),b.trigger("change"));a.addClass("sd-ship-option-disabled");b=a.find(".sd-ship-option-selection-change");0!==b.length&&b.hide()}},disableMdwShipOption:function(a){a=d("#"+a);if(0!==a.length){if(h.isSpc())a=a.closest(".shipping-speed");else if(h.isSosp())a=h.isMobile()?a.closest("div.selectable-box.a-box"):a.closest("div.fake-label.a-box");else return;var b=a.find("input[type\x3d'radio']");b.attr("disabled",!0);b.is(":checked")&&(b=d("input[name\x3d"+
b.attr("name")+"]:radio:not(:disabled):first"),b.prop("checked",!0),b.trigger("change"));a.addClass("sd-ship-option-disabled")}}}});"use strict";q.when("A","page-detector","button-blocker","client-side-metrics").register("SDButtonBlockerController",function(c,h,e,n){function k(c,d){b[c]!==x&&b[c].state!==d&&(b[c].state=d,a())}function a(){var a;d.each(b,function(b,c){a=c.owner;if(c.state===u.DISABLE_CONTINUE)return e.show(a,t),l||(n.increaseCount("removeauijs12"),d(".continue-button-blocker").css("display",
"inline-block")),!1;e.hide(a)})}var d=c.$,b={},l=r.P&&r.P.AUI_BUILD_DATE,t="Please choose a time for your order",u={ENABLE_CONTINUE:"enableContinue",DISABLE_CONTINUE:"disableContinue"};c.on("checkout:beforeReload",function(){b={}});return{disableContinue:function(c,d){b[d]===x&&(b[d]!==x||(b[d]={state:u.ENABLE_CONTINUE,owner:c,toolTipMessage:t}),a());k(d,u.DISABLE_CONTINUE)},enableContinue:function(a){b[a]!==x&&k(a,u.ENABLE_CONTINUE)},setTooltipMessage:function(a){a&&(t=a)}}});"use strict";q.when("A").register("SDUpsellMessagePrefixConfig",
function(c){return{prefixType:"COLON"}});"use strict";q.when("A","CalendarWidget","SDWidgetsConstants","SDButtonBlockerController","sdLogger","SDShadowWidgetsHub","SDUpsellMessagePrefixConfig","page-detector","a-popover-base","ready").register("SDCalendarWidget",function(c,h,e,n,k,a,d,b,l){function t(a){c.on("active-shipment-changed",function(){y(a)});r.history&&m(r).bind("popstate",function(){y(a)});c.on("Shipping::ShipSpeed::Change",function(b){b.shipSpeedType&&"scheduledDelivery"===b.shipSpeedType?
y(a):n.enableContinue(a)})}function u(a,b,c){var f=b.slot;b&&(m("[name\x3dSD-OrderID-"+a+"]").val(b.trimmedOrderId),m("[name\x3dSD-SlotQuality-"+a+"]").val(b.slotQuality),m("[name\x3dSD-SlotQualityDetail-"+a+"]").val(b.slotQualityDetail));f&&(m("[name\x3dSD-SlotID-"+a+"]").val(f.srsIds),m("[name\x3dSD-ResID-"+a+"]").val(f.reservationId),m("[name\x3dSD-ResType-"+a+"]").val(f.reservationType),m("[name\x3dSD-Carriers-"+a+"]").val(f.carriers),m("[name\x3dSD-StartTime-"+a+"]").val(f.startTimeUTC),m("[name\x3dSD-EndTime-"+
a+"]").val(f.endTimeUTC),m("[name\x3dSD-CutoffTime-"+a+"]").val(f.cutOffTimeLocalTimezone),m("[name\x3dSD-Cutoff-"+a+"]").val(f.cutOffTimeUTC),m("[name\x3dSD-WindowTZ-"+a+"]").val(f.shortTimezone),m("[name\x3dSD-CutoffTZ-"+a+"]").val(f.shortTimezone),m("[name\x3dSD-SlotLongTZ-"+a+"]").val(f.longTimezone),m("[name\x3dD_MinShipDtUTC-"+a+"]").val(f.minShipDate),m("[name\x3dD_MaxShipDtUTC-"+a+"]").val(f.maxShipDate),m("[name\x3dSD-SlotStartLTZ-"+a+"]").val(f.startTimeLocalTimezone),m("[name\x3dSD-SlotEndLTZ-"+
a+"]").val(f.endTimeLocalTimezone),m("[name\x3dSD-Date-"+a+"]").val(f.startTimeLocalTimezone),m("[name\x3dSD-PromiseLFSS-"+a+"]").val(f.fss));c&&m("[name\x3dSD-ResID-"+a+"]").val(c.reservationId)}function q(a){if(a&&a.hasOwnProperty("popover")&&(g=a.popover,g.data&&g.data.widgetIndex)){a=e.SD_CALENDAR_WIDGET_PREFIX+g.data.widgetIndex;n.disableContinue(e.CONTINUE_BUTTON_OWNER,a);var b=C[a];if(b&&null!==b){var f={};f.widgetId=a;f.dateId=null;f.slotId=null;f.currentDatePage=0;var d=c.state(a);d.currentSelection=
f;c.state(a,d);d.currentSelection=b;c.state(a,d)}}}function E(a){a&&a.hasOwnProperty("popover")&&g&&(g.data||g.data.widgetIndex)&&n.enableContinue(e.SD_CALENDAR_WIDGET_PREFIX+g.data.widgetIndex)}function p(a){a=c.state(a);return a&&null!==a?(a=a.currentSelection)&&null!==a?a:null:null}function x(a){var b=m("#"+a).find('script[type\x3d"a-state"]');a=c.state(a);b.html(JSON.stringify(a))}var m=c.$,C={},f,g,y=function(a){m("#"+a).is(":visible")?h.isSlotSelected(a)?n.enableContinue(a):n.disableContinue(e.CONTINUE_BUTTON_OWNER,
a):n.enableContinue(a)},A=function(a,f){(a=h.getSelectedSlot(a))&&null!==a&&(a=a.fullDateLabel)&&null!==a&&""!==a&&(b.isSpc()?m("."+e.SD_UPSELL_MESSAGE_PREFIX+f).html(a):(f=m("#"+e.SD_WIDGETS_PREFIX+f).parent())&&null!==f&&(f=f.find(".upsell-messaging"))&&null!==f&&("HYPHEN"===d.prefixType?f.html(e.UPSELL_MESSAGE_PREFIX_HYPHEN+a):"DASH"===d.prefixType?f.html(e.UPSELL_MESSAGE_PREFIX_DASH+a):f.html(e.UPSELL_MESSAGE_PREFIX_COLON+a)))};c.on("calendar_widget_date_selected",function(a){y(a.widgetId);b.isSpc()&&
m(".sd-calendar-save-and-continue").addClass("a-button-disabled")});c.on("calendar_widget_slot_selected",function(c){if(b.isSpc()&&0>r.location.href.indexOf("shipoptionselect"))f=c,m(".sd-calendar-save-and-continue").removeClass("a-button-disabled");else{var d=c.metadata;if(d){d=JSON.parse(d);var g=d.widgetIndex;if(a.enabled()&&a.isShadowWidget(g)){var e=a.getMainWidgetInfo(g);e&&e.widgetIndex&&u(e.widgetIndex,d)}else u(g,d)}A(c.widgetId,g);y(c.widgetId)}});c.declarative("scheduled-delivery-modal-calendar-save",
"click",function(b){if(!b.$currentTarget.find(".sd-calendar-save-and-continue").hasClass("a-button-disabled")){var d=f.metadata;b=f.widgetId;if(d){d=JSON.parse(d);var e=d.widgetIndex;var t=m("#sd-option-td-"+e).closest(".shipping-speed").find("input[type\x3d'radio']");if(a.enabled()&&a.isShadowWidget(e)){var h=a.getMainWidgetInfo(e);h&&h.widgetIndex&&u(h.widgetIndex,d)}else u(e,d)}x(b);C[b]=p(b);g&&l.hide(g.id);c.trigger("scheduled-delivery-ship-option-selected",t,e)}});c.on("scheduled-delivery-ship-option-selected",
function(a,b){b=e.SD_WIDGETS_PREFIX+b;var f={};m("#"+b+" input[type\x3dhidden]").each(function(){var a=m(this),b=a.attr("key");a=a.attr("value");b&&(f[b]=a)});r.spcpage.scheduledDeliverySetSOCallbackWithTarget(a,f,b)});return{createWidget:function(a,f,d,g){h.createWidget(e.CALENDAR_AJAX_CALL_URL,f,function(d){var l=f.widgetId;m(e.SD_WIDGETS_SPINNER_PREFIX+a).addClass("aok-hidden");m("#"+l).replaceWith(d.payload);m("#"+l).addClass("hide-if-not-selected");h.enableWidgetActions(l);if(b.isSpc()){n.disableContinue(e.CONTINUE_BUTTON_OWNER,
l);C[l]=p(l);d=h.getSelectedSlot(l);u(a,JSON.parse(d.metadata),g);x(l);d="a:popover:show:"+e.SD_WIDGETS_POPOVER_NAME_PREFIX+a;var Q="a:popover:hide:"+e.SD_WIDGETS_POPOVER_NAME_PREFIX+a;c.off(d,q);c.off(Q,E);c.on(d,q);c.on(Q,E)}y(l);t(l);A(l,a);k.logMetric(e.SD_CALENDAR_WIDGET_RENDER_SUCCESS_METRIC,1)},function(a){k.logException(a,"Got an error while trying to create Calendar Widget");k.logMetric(e.SD_CALENDAR_WIDGET_RENDER_ERROR_METRIC,1);d(a)})},hide:function(a){m("#"+a).hide()}}});"use strict";
q.when("A","CalendarWidget","shipspeed-helper","SDWidgetsConstants","sdLogger","ready").register("SDSlotChangeVASNotifier",function(c,h,e,n,k){function a(a){try{var b=d("#"+n.SD_WIDGETS_PREFIX+a.widgetIndex).parent();if(b&&null!==b){var t=b.find('[data-speed-type\x3d"scheduled-delivery"]');var h=t&&0<t.length?t[0]:void 0}else h=void 0;if(h){var q;var E=(h.getAttribute("name")||"").match(/\d+/gi);null!==E&&0<E.length&&(q=E[0]);var p=q;if(!p)k.logMetric(n.SD_CALENDAR_WIDGET_NO_VAS_SHIP_GROUP_ID,1);
else if(!d.isEmptyObject(a)){var r=e.getShipSpeedDataByGroupId(p),m={slotQuality:a.slotQuality},C=a.slot;if(null!==C){m.slotStartTimeEpoch=C.startTimeLocalTimezone;m.slotEndTimeEpoch=C.endTimeLocalTimezone;m.timeZone=C.longTimezone;var f=C.srsIds;var g=f&&0<f.length?f[0]+"_SELECT":void 0}var y=d.extend({},{eventId:g,selectedSlotDetails:m},r);c.trigger("Shipping::ScheduledDelivery::Change",y)}}}catch(A){k.logException(A,"Got an error when trying to trigger an sd slot change notification event"),k.logMetric(n.SD_CALENDAR_WIDGET_SLOT_CHANGE_TRIGGER_ERROR_METRIC,
1)}}var d=c.$;c.on("calendar_widget_date_selected",function(b){if(b=h.getFirstSlotForDate(b.dateId,b.widgetId))b=JSON.parse(b.metadata),a(b)});c.on("calendar_widget_slot_selected",function(b){if(b=b.metadata)b=JSON.parse(b),a(b)})});"use strict";q.when("A","SlotContainerWidget","SDWidgetsConstants","SDButtonBlockerController","SDShipOptionHandler","sdLogger","ServicesCustomerIntentWeblab","ready").register("SDSlotContainerWidget",function(c,h,e,n,k,a,d){function b(a){c.on("active-shipment-changed",
function(){J(a)});r.history&&p(r).bind("popstate",function(){J(a)});c.on("Shipping::ShipSpeed::Change",function(b){b.shipSpeedType&&"scheduledDelivery"===b.shipSpeedType?J(a):n.enableContinue(a)})}function l(b){if(b.pageType&&b.pageType===e.SHIP_OPTION_SELECT_PAGE&&b.metadata.slot&&b.widgetId){var f=b.widgetId,d=b.metadata.slot;if(d)try{var l=p("#"+f),C=t(b.metadata.widgetId),h=u(l),m=E(b.metadata.widgetId),n=x(l),k={apptPrefs:[{startTimeInEpoch:d.startTimeUTC,endTimeInEpoch:d.endTimeUTC,timezone:m}],
orderId:C,shipSpeedName:h,serviceId:d.serviceId,selectedShipSpeedName:n};q.when("unifiedDeliveryData-dom-updation").execute(function(b){b&&!p.isEmptyObject(b)&&(c.trigger("slot::selected::change::common::event",k),a.logMetric(e.MDW_WIDGET_INTERACTION_DELIVERY_INFORMATION_EMIT_SUCCESS_METRIC,1))})}catch(N){a.logMetric(e.MDW_WIDGET_INTERACTION_DELIVERY_INFORMATION_EMIT_FAIL_METRIC,1),a.logException(N,"Exception occurred while trying to save customer intent for service line item creation in ssd mdw")}}}
function t(b){if(!b)return"";(b=p("[name\x3dSDV1-orderId-"+b+"]").attr("value")||"")||a.logMetric(e.MDW_GET_ORDER_ID_FROM_WIDGET_ID_FAILURE_METRIC,1);return b}function u(b){if(!b||!b.length)return"";var f=b.closest("div.selectable-box");f&&f.length||(f=b.closest("div.fake-label"));(b=f.find("input[type\x3d'radio']").attr("value")||"")||a.logMetric(e.MDW_GET_SHIP_SPEED_NAME_FROM_WIDGET_ELEMENT_FAILURE_METRIC,1);return b}function x(b){if(!b||!b.length)return"";var f=b.closest("div.one-shipment");f&&
f.length||(f=b.closest("div.one-shipment-options"));b=f.find("div.selectable-box.selected");f&&f.length||(b=f.find("div.fake-label.selected"));f=b.find("input[type\x3d'radio']").attr("value")||"";a.logMetric(e.MDW_GET_SELECTED_SHIP_SPEED_NAME_FROM_WIDGET_ELEMENT_FAILURE_METRIC,f&&0<f.length?0:1);return f}function E(b){if(!b)return"";(b=p("[name\x3dSDV1-timezone-"+b+"]").attr("value")||"")||a.logMetric(e.MDW_GET_TIMEZONE_FROM_WIDGET_ID_FAILED_METRIC,1);return b}var p=c.$,J=function(a){h.isSlotSelected(a)?
n.enableContinue(a):n.disableContinue(e.CONTINUE_BUTTON_OWNER,a)},m=function(a,b){p(e.SD_NOT_AVAILABLE_ID_PREFIX+a).removeClass(e.AOK_HIDDEN);p(e.SD_WIDGETS_SPINNER_PREFIX+a).addClass(e.AOK_HIDDEN);p("#"+b).hide();n.enableContinue(b);k.disableMdwShipOption(e.SLOT_CONTAINER_WIDGET_ROOT_PREFIX+a)};c.on("slot-container-slot-selected",function(a){var b=a.metadata;if(b){var g=a.pageType,h=b.widgetId;if(b=b.slot){p("[name\x3dSDV1-ResID-"+h+"]").val(b.reservationId);p("[name\x3dSDV1-startDeliveryTime-"+
h+"]").val(b.startTimeUTC);p("[name\x3dSDV1-endDeliveryTime-"+h+"]").val(b.endTimeUTC);var t=p("[name\x3dSDV1-isUnoGatingEnabled-"+h+"]");t.length&&"1"===t.val()&&p("[name\x3dSDV1-ServiceSecaId-"+h+"]").val(b.serviceSECAId);(t=p("[name\x3dSDV1-isMdwLatencyClawbackEnabled-"+h+"]"))&&"1"===t.val()&&(p("[name\x3dSDV1-carrierSet-"+h+"]").val(b.carrierSet),p("[name\x3dSDV1-promiseFulfillmentServiceSubclass-"+h+"]").val(b.promiseFulfillmentServiceSubclass),p("[name\x3dSDV1-promiseMaxShipmentDate-"+h+"]").val(b.promiseMaxShipmentDate),
p("[name\x3dSDV1-promiseMinShipmentDate-"+h+"]").val(b.promiseMinShipmentDate))}g===e.SINGLE_PAGE_CHECKOUT&&c.trigger("slot-container-slot-selected-on-spc",a);d.isCustomerIntentSaveEnabled()&&g===e.SHIP_OPTION_SELECT_PAGE&&l(a)}});return{createWidget:function(d,f,c){var g=function(f){p(e.SD_WIDGETS_SPINNER_PREFIX+d).addClass(e.AOK_HIDDEN);p("#"+c).replaceWith(f.payload);h.enableWidgetActions(c);J(c);b(c);a.logMetric(e.SD_SLOT_CONTAINER_WIDGET_RENDER_SUCCESS_METRIC,1)},l=function(b){if(f&&f.selectedSlotUpsellMessage){var g=
f.selectedSlotUpsellMessage;p(e.SD_WIDGETS_SPINNER_PREFIX+d).addClass(e.AOK_HIDDEN);var l=p("#"+c);l.addClass(e.AOK_HIDDEN);l.closest(e.SD_MDW_WIDGET_ROOT_CLASS).parent().find(e.UPSELL_MESSAGE_CLASS).html(g);n.enableContinue(c)}else m(d,c),a.logMetric(e.SD_MDW_DISABLE_SHIP_OPTION_METRIC,1);a.logException(b,"Got an error while trying to create slot container widget");a.logMetric(e.SD_SLOT_CONTAINER_WIDGET_RENDER_ERROR_METRIC,1)},t=f&&f.scheduleSlots&&f.scheduleSlots.availableSlots;t&&0<t.length?h.createWidget(e.SLOT_CONTAINER_AJAX_CALL_URL,
f,g,l):(m(d,c),a.logMetric(e.SD_SLOT_CONTAINER_WIDGET_NO_SLOTS_METRIC,1))}}});"use strict";q.when("A","CalendarWidget","SDWidgetsConstants","SDUpsellMessagePrefixConfig","page-detector").register("SDCalendarUtils",function(c,h,e,n,k){function a(a,d){if(k.isSpc())return b("."+e.SD_UPSELL_MESSAGE_PREFIX+d);if(a=b("#"+e.SD_WIDGETS_PREFIX+d).parent())return a.find(".upsell-messaging")}function d(b,d,c){var l=3<arguments.length&&arguments[3]!==x?arguments[3]:!1,h=a(b,d);if(h&&h.length)if(k.isSpc())h.html(c);
else{var t="";l||(t="HYPHEN"===n.prefixType?e.UPSELL_MESSAGE_PREFIX_HYPHEN:"DASH"===n.prefixType?e.UPSELL_MESSAGE_PREFIX_DASH:e.UPSELL_MESSAGE_PREFIX_COLON);h.html(t+c)}}var b=c.$;return{updateUpsellMessage:d,appendUpsellMessage:function(b,c,e){var l=a(b,c);l&&l.length&&d(b,c,l.html()+"\x3cbr /\x3e"+e,!0)}}});"use strict";q.when("A","ServicesWidget","SDWidgetsConstants","sdLogger","ready").register("SDServicesWidget",function(c,h,e,n){var k=c.$;return{createWidget:function(a){h.createWidget(a,function(d){var b=
a.widgetId;k("#"+b).replaceWith(d.payload);k("#"+b).addClass("hide-if-not-selected")},function(a){n.logException(a,"Got an error while trying to create Service Widget");n.logMetric(e.SD_SERVICE_WIDGET_RENDER_ERROR_METRIC,1)})},hide:function(a){k("#"+a).hide()}}});"use strict";q.when("A").register("SDShadowConfig",function(c){return{enabled:!1}});"use strict";q.when("A","SDWidgetsConstants","sdLogger").register("SDShadowInputTransformer",function(c,h,e){var n=[function(a,c,b){b.widgetIndex=a;b.calendarInput&&
(b.calendarInput.widgetId=c.calendarWidgetId);b.servicesInput&&(b.servicesInput.widgetId=c.servicesWidgetId);return b},function(a,d,b){b.calendarInput&&b.calendarInput.slots&&0<b.calendarInput.slots.length&&c.each(b.calendarInput.slots,function(b){if(b.metadata){var c=JSON.parse(b.metadata);c.widgetIndex=a;b.metadata=JSON.stringify(c)}});return b},function(a,d,b){b.servicesInput&&b.servicesInput.services&&0<b.servicesInput.services.length&&c.each(b.servicesInput.services,function(b){if(b.metadata){var c=
JSON.parse(b.metadata);c.widgetIndex=a;c.calendarWidgetId=d.calendarWidgetId;c.servicesWidgetId=d.servicesWidgetId;b.metadata=JSON.stringify(c)}});return b}],k={A1VC38T7YXB528:[function(a,d,b){b.calendarInput&&b.calendarInput.slots&&0<b.calendarInput.slots.length&&c.each(b.calendarInput.slots,function(a){a.price=0});return b}]};return{transform:function(a,d,b){var e=c.$.extend(!0,{},b);c.each(n,function(b){e=b(a,d,e)});b=d.marketplace;b in k&&c.each(k[b],function(b){e=b(a,d,e)});return e}}});"use strict";
q.when("A","SDWidgetsConstants","sdLogger","SDShadowInputTransformer","SDShadowConfig").register("SDShadowWidgetsHub",function(c,h,e,n,k){var a={},d={};c.on("sd_widget_input_loaded",function(b,d){c.each(a,function(a,e){a.mainWidgetIndex===b&&c.trigger("sd_shadow_widget_input_loaded",e,d)})});c.on("sd_shadow_widget_input_loaded",function(b,c){var l=a[b];if(l&&b in d){var k=d[b];k&&(b=n.transform(b,l,c),k(b),e.logMetric(h.SD_SHADOW_LOAD_METRIC,1))}});return{enabled:function(){return k.enabled},registerShadowWidget:function(b,
c,n){b in a||(a[b]=c,d[b]=n,e.logMetric(h.SD_SHADOW_REGISTER_METRIC,1))},isShadowWidget:function(b){return b in a},getShadowWidgetInfo:function(b){var d=null;c.each(a,function(a,c){d||a.mainWidgetIndex===b&&(d={widgetIndex:c,calendarWidgetId:a.calendarWidgetId,servicesWidgetId:a.servicesWidgetId})});return d},getMainWidgetInfo:function(b){if(!(b in a))return null;b=a[b];return{widgetIndex:b.mainWidgetIndex,calendarWidgetId:b.mainCalendarWidgetId,servicesWidgetId:b.mainServicesWidgetId}},processShadowCalendarInput:function(b,
c){return b in a?n.transform(b,a[b],c):c}}});"use strict";q.when("A","GoldenCxRapServiceIntegration","SDCalendarWidget","SDServicesWidget","SDShipOptionHandler","SDWidgetsConstants","sdLogger","SDButtonBlockerController","SDShadowWidgetsHub","page-detector","SDDisableServiceWidget","ready").register("ScheduledDeliveryWidgets",function(c,h,e,n,k,a,d,b,l,t,q){function u(a,b){if(b&&b.start&&b.end){var c=parseInt(b.start),d=parseInt(b.end);for(b=0;b<a.length;b++){var f=a[b];if(f.startTime===c&&f.endTime===
d)return a[b].isDefault=!0,a}}for(b=c=0;b<a.length;b++)a[b].startTime<a[c].startTime?c=b:a[b].startTime===a[c].startTime&&a[b].endTime<a[c].endTime&&(c=b);a[c].isDefault=!0;return a}var r=c.$,p=function A(c,d,h){r(a.SD_NOT_AVAILABLE_ID_PREFIX+c).removeClass("aok-hidden");r(a.SD_NOTE_ID_PREFIX+c).addClass("aok-hidden");r(a.SD_CHANGE_LINK_ID_PREFIX+c).addClass("aok-hidden");r(a.SD_WIDGETS_SPINNER_PREFIX+c).addClass("aok-hidden");n.hide(h);e.hide(d);b.enableContinue(d);k.disableShipOption(a.SD_WIDGETS_PREFIX+
c,!0);l.enabled()&&!l.isShadowWidget(c)&&(c=l.getShadowWidgetInfo(c))&&A(c.widgetIndex,c.calendarWidgetId,c.servicesWidgetId)},J=function(a){c.each(r('script[type\x3d"a-state"]'),function(b,c){r(b).data("a-state").key===a&&b.remove()})},m=function(a){e.createWidget(a.widgetIndex,a.calendarInput,function(b){p(a.widgetIndex,a.calendarWidgetId,a.servicesWidgetId)},a.selectedSlot)};c.on("sd_load_information",function(e,g,k,A){J(a.SD_CALENDAR_WIDGET_PREFIX+e);d.logMetric(a.SD_WIDGET_LOAD_INFORMATION_METRIC,
1);var f,v;b.setTooltipMessage(g.tooltipMessage);g.isSelected&&1===g.isSelected&&b.disableContinue(a.CONTINUE_BUTTON_OWNER,k);var y=function(b){d.logException(JSON.stringify(b),"Got an error while trying to load SD widgets");d.logMetric(a.SD_WIDGET_LOAD_ERROR_METRIC,1);b.type&&d.logMetric(b.type,1);p(e,k,A)},E=function(){function b(a,b){var c=JSON.parse(b.metadata).slot.reservationId.split(";"),d;3<=c.length&&(d=c[2]);a[""+b.startTime+b.endTime]=d}function c(a,b){a=a.split("^");b=b.split("^");return 3===
a.length&&3===b.length&&parseFloat(a[0])===parseFloat(b[0])&&parseFloat(a[1])===parseFloat(b[1])&&a[2]===b[2]?1:0}d.logMetric(a.SD_WIDGET_SHADOW_COMPARISON_METRIC,1);var e=0;v&&v.calendarInput&&v.calendarInput.slots&&0!==v.calendarInput.slots.length&&(e=1);var g=0;f&&f.calendarInput&&f.calendarInput.slots&&0!==f.calendarInput.slots.length&&(g=1);if(g||e)if(g&&!e)d.logMetric(a.SD_WIDGET_SHADOW_ONLY_HAS_GVDGO_SLOTS_METRIC,1);else if(!g&&e)d.logMetric(a.SD_WIDGET_SHADOW_ONLY_HAS_RAP_SLOTS_METRIC,1);
else{d.logMetric(a.SD_WIDGET_SHADOW_BOTH_SLOTS_EXIST_METRIC,1);e={};g={};var h=""+v.calendarInput.slots[0].startTime+v.calendarInput.slots[0].endTime,l=""+f.calendarInput.slots[0].startTime+f.calendarInput.slots[0].endTime;if("HB"===P)for(var k=0;k<v.calendarInput.slots.length;k++)b(e,v.calendarInput.slots[k]);else if("SP"===P){var m=v.calendarInput.slots[0].startTime+691200;for(k=0;k<v.calendarInput.slots.length;k++)v.calendarInput.slots[k].startTime<m&&b(e,v.calendarInput.slots[k])}for(k=0;k<f.calendarInput.slots.length;k++)b(g,
f.calendarInput.slots[k]);h!==l&&d.logMetric(a.SD_WIDGET_SHADOW_SLOTS_FADD_TIME_MISMATCH_METRIC,1);c(e[h],g[l])||d.logMetric(a.SD_WIDGET_SHADOW_SLOTS_FADD_PRICE_MISMATCH_METRIC,1);v.calendarInput.slots[0].startTime<f.calendarInput.slots[0].startTime?d.logMetric(a.SD_WIDGET_SHADOW_SLOTS_FADD_TIME_MISMATCH_GVDGO_START_LATE_METRIC,f.calendarInput.slots[0].startTime-v.calendarInput.slots[0].startTime):v.calendarInput.slots[0].startTime>f.calendarInput.slots[0].startTime&&d.logMetric(a.SD_WIDGET_SHADOW_SLOTS_FADD_TIME_MISMATCH_GVDGO_START_EARLY_METRIC,
v.calendarInput.slots[0].startTime-f.calendarInput.slots[0].startTime);v.calendarInput.slots[0].endTime<f.calendarInput.slots[0].endTime?d.logMetric(a.SD_WIDGET_SHADOW_SLOTS_FADD_TIME_MISMATCH_GVDGO_END_LATE_METRIC,f.calendarInput.slots[0].endTime-v.calendarInput.slots[0].endTime):v.calendarInput.slots[0].endTime>f.calendarInput.slots[0].endTime&&d.logMetric(a.SD_WIDGET_SHADOW_SLOTS_FADD_TIME_MISMATCH_GVDGO_END_EARLY_METRIC,v.calendarInput.slots[0].endTime-f.calendarInput.slots[0].endTime);h=Object.keys(e).length;
l=Object.keys(g).length;h!==l&&(d.logMetric(a.SD_WIDGET_SHADOW_SLOTS_LENGTH_MISMATCH_METRIC,1),10<h-l?d.logMetric(a.SD_WIDGET_SHADOW_RAP_TEN_PLUS_SLOTS_MORE_METRIC,1):5<h-l?d.logMetric(a.SD_WIDGET_SHADOW_RAP_FIVE_PLUS_SLOTS_MORE_METRIC,1):1<h-l?d.logMetric(a.SD_WIDGET_SHADOW_RAP_ONE_PLUS_SLOTS_MORE_METRIC,1):1===h-l?d.logMetric(a.SD_WIDGET_SHADOW_RAP_ONE_SLOT_MORE_METRIC,1):10<l-h?d.logMetric(a.SD_WIDGET_SHADOW_GVDGO_TEN_PLUS_SLOTS_MORE_METRIC,1):5<l-h?d.logMetric(a.SD_WIDGET_SHADOW_GVDGO_FIVE_PLUS_SLOTS_MORE_METRIC,
1):1<l-h?d.logMetric(a.SD_WIDGET_SHADOW_GVDGO_ONE_PLUS_SLOTS_MORE_METRIC,1):1===l-h&&d.logMetric(a.SD_WIDGET_SHADOW_GVDGO_ONE_SLOT_MORE_METRIC,1));for(var n in e)g.hasOwnProperty(n)?c(e[n],g[n])||d.logMetric(a.SD_WIDGET_SHADOW_SLOTS_PRICE_MISMATCH_METRIC,1):d.logMetric(a.SD_WIDGET_SHADOW_SLOTS_TIME_MISMATCH_METRIC,1)}else d.logMetric(a.SD_WIDGET_SHADOW_BOTH_SLOTS_NOT_EXIST_METRIC,1)},N=function(a){f=a;E()},F=function(a){v=a;L.path="Rapless";h.getWidgetInputParameters(L,N,y)},R=g.shadowMode,M=function(b){if(b&&
b.calendarInput&&b.calendarInput.slots&&0!==b.calendarInput.slots.length){if(b.selectedSlot=g.selectedSlot,m(b),q.enabled?(n.hide(A),d.logMetric(a.SD_SERVICE_WIDGET_DISABLED,1)):b.servicesInput?(n.createWidget(b.servicesInput),d.logMetric(a.SD_SERVICE_WIDGET_LOADED,1)):n.hide(A),l.enabled()&&!R){var f=r.extend(!0,{},b);c.trigger("sd_widget_input_loaded",e,f)}}else d.logMetric(a.SD_WIDGET_NO_SLOTS_METRIC,1),p(e,k,A);S&&(v=b,L.path="Rapless",h.getWidgetInputParameters(L,N,y))};r(a.SD_CHANGE_LINK_ID_PREFIX+
e).click(function(a){a.preventDefault()});if(l.enabled()&&R)g.calendarWidgetId=k,g.servicesWidgetId=A,l.registerShadowWidget(e,g,M);else{if(g.udsServiceCodes){if(-1===g.udsServiceCodes){y({type:a.SD_UDS_ERROR_MESSAGE,data:g.marketplace});b.disableContinue(a.CONTINUE_BUTTON_OWNER,k);return}for(var z=document.getElementsByName("order_"+g.trimmedOrderId+"_ShippingSpeed"),D=0;D<z.length;D++){var B=z[D];"hidden"===B.type&&B.remove()}}z=[];for(D=0;D<g.items.length;D++){B=g.items[D];var K={itemID:D,merchantID:B.merchantid,
merchantSKU:B.merchantsku,inventoryAuthorityID:B.asin,offerListingID:B.offerlistingid,fulfillmentManagerID:B.fulfillmentnetworkid,totalQuantity:B.quantity};g.isSdRaplessAsyncEnabled&&(K.lineItemId=B.lineItemId);z.push(K)}z={marketplace:g.marketplace,shipoption:g.shipoption,address:g.address,widgetIndex:e,client:"SOSP",trimmedOrderId:g.trimmedOrderId,servicesWidgetId:A,calendarWidgetId:k,sessionId:g.sessionId,customerId:g.customerId,isPrimeCustomer:!!g.isPrimeCustomer,isSlotPreviouslySelected:!!g.selectedSlot,
isAfn:g.isAfn,udsServiceCodes:g.udsServiceCodes,lineItems:z};z.client=t.isSosp()?"SOSP":"SPC";z.selectedSlot=g.selectedSlot;if(g.isSdRaplessAsyncEnabled&&"LAUNCH"===g.isSdRaplessAsyncEnabled)d.logMetric(a.SD_WIDGET_RAPLESS_ASYNC_METRIC,1),z.path="Rapless",h.getWidgetInputParameters(z,M,y);else if(g.isSdRaplessAsyncEnabled&&"SHADOW"===g.isSdRaplessAsyncEnabled&&!g.isSdWithoutRAPFeatureEnabled){if(g.sdRaplessAsyncUseCase)var P=g.sdRaplessAsyncUseCase;var L=JSON.parse(JSON.stringify(z));var S=1;h.getWidgetInputParameters(z,
M,y)}else if(g.isSdWithoutRAPFeatureEnabled)if(g.isSdRaplessAsyncEnabled&&"SHADOW"===g.isSdRaplessAsyncEnabled&&(g.sdRaplessAsyncUseCase&&(P=g.sdRaplessAsyncUseCase),L=JSON.parse(JSON.stringify(z)),h.getWidgetInputParameters(z,F,y)),"undefined"===typeof g.sdGoldenCXWidgetsParametersWithoutRAP.deliveryTimeZone||null===g.sdGoldenCXWidgetsParametersWithoutRAP.deliveryTimeZone||"undefined"===typeof g.sdGoldenCXWidgetsParametersWithoutRAP.availableSlots||0===g.sdGoldenCXWidgetsParametersWithoutRAP.availableSlots.length)d.logMetric(a.SD_WIDGET_NO_GVDGO_SLOTS_METRIC,
1),p(e,k,A);else{d.logMetric(a.SD_WIDGET_HAS_GVDGO_SLOTS_METRIC,1);var G;g.sdGoldenCXWidgetsParametersWithoutRAP.shipOptionLevelPrice&&g.sdGoldenCXWidgetsParametersWithoutRAP.shipOptionLevelPrice.CurrencyCode?G=g.sdGoldenCXWidgetsParametersWithoutRAP.shipOptionLevelPrice:d.logMetric(a.SD_WIDGET_NO_SHIPOPTION_LEVEL_PRICE_METRIC,1);D=0;F=[];B=g.sdGoldenCXWidgetsParametersWithoutRAP.deliveryTimeZone;for(K=0;K<g.sdGoldenCXWidgetsParametersWithoutRAP.availableSlots.length;K++){var w=g.sdGoldenCXWidgetsParametersWithoutRAP.availableSlots[K],
I={reservationId:w.reservationIds.join().concat(";;"),reservationType:"CASE",longTimezone:B,startTimeLocalTimezone:Number(w.slotStartTime),endTimeLocalTimezone:Number(w.slotEndTime)},H=x,O=x;w.totalItemCharge&&w.totalShipmentCharge&&w.deliveryPrice&&w.totalItemCharge.CurrencyAmount&&w.totalShipmentCharge.CurrencyAmount&&w.deliveryPrice.CurrencyAmount&&w.deliveryPrice.CurrencyCode?(H=w.totalItemCharge.CurrencyAmount.concat("^").concat(w.totalShipmentCharge.CurrencyAmount).concat("^").concat(w.deliveryPrice.CurrencyCode),
I.reservationId=I.reservationId.concat(H).concat(";"),H=Number(w.deliveryPrice.CurrencyAmount),O=w.deliveryPrice.CurrencyCode):(G?(H="0".concat("^").concat("0").concat("^").concat(G.CurrencyCode),I.reservationId=I.reservationId.concat(H).concat(";"),H=0,O=G.CurrencyCode):I.reservationId=I.reservationId.concat(";"),D=1);w={startTime:Number(w.slotStartTime),endTime:Number(w.slotEndTime),metadata:JSON.stringify({version:"1.0",widgetIndex:e,trimmedOrderId:g.trimmedOrderId,slot:I})};"undefined"!==typeof H&&
O&&(w.price=H,w.priceCurrency=O);F.push(w)}D&&d.logMetric(a.SD_WIDGET_NO_SLOT_LEVEL_PRICE_METRIC,1);0<F.length&&(F[0].isDefault=!0);G={widgetId:k,client:"SOSP",timezone:B,marketplaceId:g.marketplace,customerId:g.customerId,isPrimeCustomer:!!g.isPrimeCustomer,sessionId:g.sessionId,addressId:g.address,isSlotPreviouslySelected:!!g.selectedSlot,isAfn:g.isAfn,slots:F};F[0].isDefault=!1;G.slots=u(F,z.selectedSlot);G.client=t.isSosp()?"SOSP":"SPC";M({calendarInput:G,widgetIndex:e})}else h.getWidgetInputParameters(z,
M,y)}});c.on("services_widget_service_selected",function(a){var b=l.isShadowWidget(a.widgetIndex),c={calendarWidgetId:a.calendarWidgetId,selectedServices:a.selectedServices,widgetIndex:a.widgetIndex,trimmedOrderId:a.trimmedOrderId,isAfn:a.isAfn};if(l.enabled()&&b){var d=l.getMainWidgetInfo(c.widgetIndex);d&&(c.widgetIndex=d.widgetIndex,c.calendarWidgetId=d.calendarWidgetId)}h.getCachedCalendarWidgetInputParameters(c,function(c){l.enabled()&&b?m(l.processShadowCalendarInput(a.widgetIndex,c)):m(c)},
function(b){p(a.widgetIndex,a.calendarWidgetId,a.servicesWidgetId)})});c.on("checkout:reload:shipoptionselect",function(){})});"use strict";q.when("A","SDSlotContainerWidget","SDWidgetsConstants","sdLogger","ready").register("ScheduledDeliveryMdwWidgets",function(c,h,e,n){var k=c.$;c.on("sd-load-mdw-widget",function(a,c,b){h.createWidget(a,c,b)});c.on("slot-container-slot-selected-on-spc",function(a){a=k("#"+a.widgetId).closest(e.SD_MDW_WIDGET_ROOT_CLASS);0<a.length&&(a=a.attr("id"),c.trigger("slot-selected-update-sdi",
a));return null});c.on("slot-selected-update-sdi",function(a){var c={};k("#"+a+" input[type\x3dhidden]").each(function(){var a=k(this),b=a.attr("key");a=a.attr("value");b&&(c[b]=a)});var b=k("#"+a).closest(".shipping-speed").find("input[type\x3d'radio']");r.spcpage.scheduledDeliveryMdwSetSOCallback(b,c,a);n.logMetric(e.SD_MDW_UPDATE_SDI_COUNT_METRIC,1)})});"use strict";q.when("A","ready").register("ServicesCustomerIntentWeblab",function(c){return{isCustomerIntentSaveEnabled:function(){return!1}}})});
/* ******** */
