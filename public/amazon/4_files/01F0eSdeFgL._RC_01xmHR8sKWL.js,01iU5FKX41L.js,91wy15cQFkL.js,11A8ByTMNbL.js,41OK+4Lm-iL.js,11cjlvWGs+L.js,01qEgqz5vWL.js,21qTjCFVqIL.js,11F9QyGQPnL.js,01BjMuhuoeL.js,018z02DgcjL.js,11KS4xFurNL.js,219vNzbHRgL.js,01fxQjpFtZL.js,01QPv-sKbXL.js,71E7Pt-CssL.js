(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-PayAtStore","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/PayAtStoreComponent",["components/SimplePaymentOptionListItemComponent"],function(a){return a.extend({_getContainerElement:function(){return this.getDOMElement("pasContainer")}})})})()});
/* ******** */
(function(c){var a=window.AmazonUIPageJS||window.P,d=a._namespace||a.attributeErrors,b=d?d("APXWidgetsAssets@APXWidgets-PIX","APXWidgetsAssets"):a;b.guardFatal?b.guardFatal(c)(b,window):b.execute(function(){c(b,window)})})(function(c,a,d){(function(){var b=PaymentsPortal2.modules.define;b("components/PIXComponent",["events/InstrumentRowSelectedEvent","components/SimplePaymentOptionListItemComponent"],function(b,a){return a.extend({initialize:function(b,a){this.setDisabled(a.data.isPIXDisabled)},bindToEvents:function(){var a=
this;a.widget.on(b,a,function(b){b.instrumentId===a._getInstrumentId()?a._onInstrumentSelected():a._onInstrumentDeselected()})},_getContainerElement:function(){return this.getDOMElement("pixContainer")}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-PSE","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/PSEComponent",["component"],function(a){return a.extend({initialize:function(){console.log("PSEComponent initialized!")}})})})()});
/* ******** */
(function(C){var p=window.AmazonUIPageJS||window.P,r=p._namespace||p.attributeErrors,G=r?r("APXWidgetsAssets@PaymentsPortalWidgets2","APXWidgetsAssets"):p;G.guardFatal?G.guardFatal(C)(G,window):G.execute(function(){C(G,window)})})(function(C,p,r){(function(){function G(c){for(var d=document.querySelectorAll("div[data-a-input-name]"),f=1,h=1,g=1,a={},m=0,k=0;k<d.length;k++)for(var e=d[k].querySelectorAll("input"),b=0;b<e.length;b++)if(e[b].offsetParent&&!e[b].disabled){var n=e[b].value,q={},y=e[b].name;
if(n||"ppw-instrumentRowSelection"!==y){n=n.split("\x26");for(y=0;y<n.length;y++){var v=n[y].split("\x3d");q[v[0]]=v[1]}if("paymentMethod"in q)switch(q.paymentMethod){case "CC":if("EMI"===q.instrumentId||"AmazonCredit"===q.instrumentId){a[q.instrumentId]=f;f+=1;"AmazonCredit"===q.instrumentId&&(m+=1);continue}n=document.querySelectorAll("div[data-instrument-id\x3d'"+q.instrumentId+"']");if(n!==r&&null!==n&&0<n.length)n=n[0];else continue;n=n.getElementsByClassName("pmts-cc-issuer-name");if(n!==r&&
null!==n&&0<n.length)n=n[0].innerHTML,String(n).includes("Amazon Pay")&&(m+=1);else continue;n in a?(a[n+h]=f,h+=1):a[n]=f;f+=1;break;case "UnifiedPaymentsInterface":n=d[k].getAttribute("aria-label");if(null===n||n===r)continue;"Other UPI Apps"!==n&&(q=n.includes("*")?n.indexOf("*"):n.length,n="UPI-2P-".concat(n.substring(0,q)),m+=1);n in a?(a[n+g]=f,g+=1):a[n]=f;f+=1;break;case "NB":a.NB=f;f+=1;break;case "NetBanking":a.NB=f;f+=1;break;case "APB":a.APB=f;m+=1;f+=1;break;case "COD":a.COD=f;f+=1;break;
case "AmazonProductVoucher":a.AmazonProductVoucher=f,m+=1,f+=1}}else a["Other UPI Apps / NetBanking"]=f,f+=1}f=Object.keys(a).length;d=f-m;c.widget.publishSuccessSushiMetrics({ActionParentValueType:"DisplayedPaymentInstrumentsCount",ActionParentValue:f,ActionType:"LoadStartWidget",ActionValueType:"PaymentInstrumentsDisplayRank",ActionValue:a});c.widget.publishSuccessSushiMetrics({ActionValue:d,ActionValueType:"3PInstrumentsCount",ActionType:"LoadStartWidget"});c.widget.publishSuccessSushiMetrics({ActionValue:m,
ActionValueType:"APPInstrumentsCount",ActionType:"LoadStartWidget"})}var l=PaymentsPortal2.modules.define;l("TransitionMetricsConstants",[],function(){return{SEPARATOR:"-to-",ADD_NEW_PAYMENT_METHOD_LINK:"AddNewPaymentMethodLink",REGISTRATION_LANDING_VIEW:"RegistrationLandingView",CARD_REGISTRATION_FORM_VIEW:"CardRegistrationForm",ADD_PM_LINK_CLICK_STORAGE_KEY:"apx:spps:AddNewPaymentMethodLinkClicked:"}});l("components/AddAddressComponent","css-utils jQuery form-component lang AUI!P aui-helper".split(" "),
function(c,d,f,h,g,a){return f.extend({initialize:function(a,k){this._addressListSize=k.data.addressListSize;this._fieldsToDisable=k.data.fieldsToDisable},bindToElements:function(){this.getDOMElement("addAddressSubmitButton").closest("form").submit(h.bind(this.onAddAddressSubmitButton,this))},onAddAddressSubmitButton:function(a){return 0===this.form.validateForm().length},_fillForm:function(a){var k=this;a=d.parseJSON(a);h.forEachKeyValue(a,function(e,b){e&&b&&k.getDOMElement(e).val(b)})},bindToEvents:function(){var a=
this;a.widget.on("fillAddressForm",a,function(k){a._fillForm(k.addressJsonData)});0<a._fieldsToDisable.length&&(a._disableFieldsInList(),0===a._addressListSize&&a._hideFields(a._fieldsToDisable))},_hideFields:function(a){h.forEach(a,function(a){a=d("[id\x3d"+a+"]");c.hideElement(a)})},_disableFieldsInList:function(){c.hideElement(d("[name\x3d'ppw-postalCode']"));h.forEach(this._fieldsToDisable,function(a){a="ppw-".concat(a);a=d("[name\x3d"+a+"]");c.makeTextInputReadOnly(a)})}})});l("components/AddressUIAddAddressComponent",
["component","lang","jQuery"],function(c,d,f){return c.extend({bindToEvents:function(){var c=this;c.widget.onAui("addrui-widgets-addr-suggestion-event-edit-button-clicked",function(){var g=c.getDOMElement("addressUIAddAddressWidgetWrapperForm"),a=f("\x3cinput\x3e").attr({type:"hidden",name:"ppw-widgetEvent:AddressUIEditAddressEvent",value:"submit"});g.append(a)})}})});l("components/LookupAddressComponent",["css-utils","jQuery","form-component","lang"],function(c,d,f,h){return f.extend({initialize:function(c,
a){this._addressLiseSize=a.data.addressListSize},_fillAddressFormByLookupAddress:function(){var c=this.form.fields.lookupDropDown,c=this.form.getFormValues()[c.defaultParameterName];this.widget.trigger("fillAddressForm",{addressJsonData:c})},bindToElements:function(){c.showElement(d(this.getDOMElement("lookupAddressSection")));var g=this.form.fields.lookupDropDown,a=h.bind(this._fillAddressFormByLookupAddress,this);this.form.bindToParameter(g.defaultParameterName,"change",a);1>=this._addressLiseSize&&
c.hideElement(d("[data-a-class\x3d'ppw-lookup-mx-dropdown']"))}})});l("components/AddressSuggestionComponent",["component","lang"],function(c,d){return c.extend({})});l("components/AddAmazonPayCodeComponent",["events/form-submitted-event","form-component","lang","jQuery","css-utils"],function(c,d,f,h,g){return d.extend({initialize:function(a,c){this._action=c.data.action},bindToElements:function(){this.getDOMElement("pmts-add-amazon-paycode-continue-button").click(f.bind(this._handleFormSubmission,
this))},bindToEvents:function(){var a=this;this.widget.on(c,a,function(c){c.action===a._action&&a.getDOMElement("pmts-add-amazon-paycode-form").submit()})},_handleFormSubmission:function(a){if(0===this.form.validateForm().length){var g=this.getFormSubmissionParameters("pmts-add-amazon-paycode-container");this.widget.trigger(c,{submissionParameters:g,event:a,action:this._action})}else a.preventDefault()}})});l("components/AddAmazonPayCodeWorkflowComponent",["component"],function(c){return c});l("components/AddBancontactComponent",
["events/form-submitted-event","jQuery","form-component","lang","AUI!P"],function(c,d,f,h,g){return f.extend({initialize:function(a,c){this.$addBancontactPopover=this.getDOMElement(this.data.addBancontactPopoverJSBinding);this.$addBancontactSubmitButton=this.getDOMElement(this.data.addBancontactSubmitButtonJSBinding)},_initPopoverState:function(){this.data.hasErrors&&this.$addBancontactPopover.trigger("click")},bindToElements:function(){this.$addBancontactSubmitButton.click(h.bind(this._handleFormSubmission,
this))},bindToEvents:function(){var a=this;a.widget.on("componentsInitialized",a,function(a){this._initPopoverState()});a.widget.on(c,a,function(c){c.action===a.data.action&&a.getDOMElement(a.data.addBancontactFormJSBinding).submit()})},_handleFormSubmission:function(a){var g=this.getFormSubmissionParameters(this.data.addBancontactBodyJSBinding);this.closeAddBancontactPopover();this.widget.trigger(c,{event:a,submissionParameters:g,action:this.data.action})},closeAddBancontactPopover:function(){var a=
this.data.addBancontactPopoverName;g.when("a-modal").execute(function(c){c&&(c=c.get(a))&&c.hide()})}})});l("components/AddBankAccountComponent","css-utils jQuery form-component lang AUI!P clog modal-popover events/close-secure-container-event events/display-secure-container-event events/postToSecureIframeEvent events/secureIframeLoadedEvent AddPaymentInstrumentStorageConsentHelper".split(" "),function(c,d,f,h,g,a,m,k,e,b,n,q){var y=null;return f.extend(q,{_hasErrors:!1,_creatablePaymentMethods:[],
_isSecureRegistrationPageTriggerShown:!1,initialize:function(b,a){this._isDesktop="desktop"===b.options.deviceType;this._hasErrors=a.data.hasErrors;this._isAnyIBAN=!!a.data.isAnyIBAN;this._bankAccountCategory=a.data.bankAccountCategory;this._addButtonJSBinding=a.data.addButtonJSBinding;this._isAccountNumberPrefixRequired=a.data.isAccountNumberPrefixRequired;this._isTaxIdRequired=a.data.isTaxIdRequired;this._creatablePaymentMethods=a.data.creatablePaymentMethods;this._isSecureRegistrationPageTriggerShown=
a.data.isSecureRegistrationPageTriggerShown;this._isSecureRegistrationWidget=a.data.isSecureRegistrationWidget;this._isPersonalCheckingAccount=a.data.isPersonalCheckingAccount;this._action=a.data.action;this._disablePasteForAccountNumber=a.data.disablePasteForAccountNumber;this._disablePasteForBankCode=a.data.disablePasteForBankCode;this._disablePasteForBranchCode=a.data.disablePasteForBranchCode;this._disablePasteForTaxId=a.data.disablePasteForTaxId;this._accountNumberPaddingLength=a.data.accountNumberPaddingLength;
this._shouldRenderInPopover=a.data.shouldRenderInPopover;this._loadJPBankListFromAssetEnabled=a.data.loadJPBankListFromAssetEnabled;this._secureIframeName=a.data.secureIframeName;this._declarativeActionName=a.data.declarativeActionName;this._enableEnterBankAccountTwice=a.data.enableEnterBankAccountTwice;this._shouldFillRoutingNumberFromBankAndBranchCode=a.data.shouldFillRoutingNumberFromBankAndBranchCode;this._delimiterForFillingRoutingNumberFromBankCodeAndBranchCode=a.data.delimiterForFillingRoutingNumberFromBankCodeAndBranchCode;
this._shouldRenderInPopover&&(this.popover=new m(b,a,this))},_initPopoverState:function(){"true"===this._hasErrors&&(this.getDOMElement("bankAccountPopoverLink").trigger("click"),this.widget.trigger(e))},_maybeSetCountryCode:function(){if(this._isAnyIBAN){var b=this.getDOMElement("addBankAccountNumber").val().trim().substring(0,2);this.getDOMElement("countryCode").val(b)}},_stripHyphenTaxId:function(){if(this._isTaxIdRequired){var b=this.getDOMElement("addBankTaxIdentificationNumber").val();b&&(b=
b.replace(/-/g,""),this.getDOMElement("addBankTaxIdentificationNumber").val(b))}},_stripNonAlphaNumericFromRoutingNumber:function(){var b=this.getDOMElement("addBankAccountRoutingNumber").val();b&&(b=b.replace(/[\W_]/g,""),this.getDOMElement("addBankAccountRoutingNumber").val(b))},_prefixBankAccountNumber:function(){if(this._isAccountNumberPrefixRequired){var b="SAVINGS"===this.form.getAUITagHelperForParameter("accountType").val()?"1":"2",a=b+this.getDOMElement("addBankAccountNumber").val();this.getDOMElement("addBankAccountNumber").val(a);
b+=this.getDOMElement("confirmBankAccountNumber").val();this.getDOMElement("confirmBankAccountNumber").val(b)}},_padBankAccountNumber:function(){if(0<this._accountNumberPaddingLength){var b=this.getDOMElement("addBankAccountNumber").val(),b=h.leftPad(b,this._accountNumberPaddingLength,"0");this.getDOMElement("addBankAccountNumber").val(b);b=this.getDOMElement("confirmBankAccountNumber").val();b=h.leftPad(b,this._accountNumberPaddingLength,"0");this.getDOMElement("confirmBankAccountNumber").val(b)}},
handleAddBankAccountDOMEvent:function(){var b=this.form.validateForm();q.blameFormField.apply(this,[b]);if(0===b.length)this._maybeSetCountryCode(),this._padBankAccountNumber(),this._prefixBankAccountNumber(),this._stripHyphenTaxId(),this._stripNonAlphaNumericFromRoutingNumber(),b=this.getDOMElement(this._addButtonJSBinding).closest("form").serializeArray(),this.widget.trigger("newBankAccountFormSubmitted",{submissionParameters:b,bankAccountCategory:this._bankAccountCategory,action:this._action}),
this.closeAddBankAccountPopover({});else{var a=this;h.forEach(b,function(b){a.widget.publishFailureSushiMetrics({ActionType:"AddBankAccount",ActionValueType:"ErrorField",ActionValue:b.field})})}return!1},closeAddBankAccountPopover:function(b){this.widget.trigger(k,b);g.when("a-modal").execute(function(b){b&&(b=b.get("pmtsAddBankAccountPopover"))&&b.hide()})},bindToElements:function(){var b=this;c.showElement(d(this.getDOMElement("confirmAccountNumberSection")));this.getDOMElement(this._addButtonJSBinding).click(h.bind(this.handleAddBankAccountDOMEvent,
this));this.getDOMElement(this._addButtonJSBinding).click(function(){b.widget.publishSuccessSushiMetrics({ActionType:"AddBankAccount",ActionValueType:"AddMethod",ActionValue:"AddBankAccountButtonClicked"})});this.getDOMElement("newBankAccountCancelButton").click(function(){b.closeAddBankAccountPopover({force:!0});b.widget.publishSuccessSushiMetrics({ActionType:"CancelAddBankAccount",ActionValueType:"Click",ActionValue:"CancelButtonClicked",ActionParentValueType:"PurchaseDocument",ActionParentValue:b._purchaseId})});
this._enableEnterBankAccountTwice&&this.getDOMElement("addBankAccountNumber").bind("cut copy paste",function(b){b.preventDefault()});this._disablePasteForAccountNumber&&(this.getDOMElement("addBankAccountNumber").bind("paste",function(b){b.preventDefault()}),this.getDOMElement("confirmBankAccountNumber").bind("paste",function(b){b.preventDefault()}));this._disablePasteForTaxId&&(this.getDOMElement("addBankTaxIdentificationNumber").bind("paste",function(b){b.preventDefault()}),this.getDOMElement("confirmTaxIdNumber").bind("paste",
function(b){b.preventDefault()}));this._disablePasteForBankCode&&this.getDOMElement("bankCode").bind("paste",function(b){b.preventDefault()});this._disablePasteForBranchCode&&this.getDOMElement("branchCode").bind("paste",function(b){b.preventDefault()});this._loadJPBankListFromAssetEnabled&&d("[name\x3d'ppw-bankNameDropdown']").change(function(){b._changeBankCodeDropdown()});this._isSecureRegistrationPageTriggerShown?this._bindAddBankAccountTrigger():this._bindNonSecureAddBankAccountTrigger();q.bindToElements.apply(this)},
bindToEvents:function(){var b=this;g.when("A","ready").execute(function(a){a.on("a:button-group:accountTypeToggleGroup:toggle",function(a){b.getDOMElement("accountType").val(a.selectedButton.buttonName)})});this._loadJPBankListFromAssetEnabled&&(a.logCounterMetric({feature:"JPPersonalAddBankLoadSuccess",resource:"_Count"}),g.when("a-dropdown","jp-bank-list").execute(function(e,q){q=Object.entries(q.getTopBanks()).map(function(b){return{value:b[0],text:b[1]}});e.getSelect("pmts-bank-name-dropdown-native-id").addOptions(q,
0);c.hideElement(d("#bank-code-input-section"));c.showElement(b.getDOMElement("bankNameDropdown"));a.logCounterMetric({feature:"AddBankJPBankListAssetLoadSuccess",resource:"_Count"})}),g.when("jp-bank-list").execute(function(a){b.getDOMElement("bankName").keyup(function(){b._changeBankNameSuggestions(a.getAllBanks());d(".pmts-add-bank-account-bank-name-option").bind("click",function(a){b._selectBankFromSuggestion(this)})})}));b.widget.on("newBankAccountFormSubmitted",b,function(a){if(a.bankAccountCategory===
this._bankAccountCategory){a=d(b.getDOMElement(this._addButtonJSBinding)).closest("form");if(this._shouldFillRoutingNumberFromBankAndBranchCode){var e=d("\x3cinput\x3e").attr({type:"hidden",name:"addBankAccountRoutingNumber",value:this.getDOMElement("bankCode").val()+this._delimiterForFillingRoutingNumberFromBankCodeAndBranchCode+this.getDOMElement("branchCode").val()});a.append(e)}a.submit();this._addBankAccountFormSubmitMetric()}});b.widget.on("componentsInitialized",b,function(b){this._initPopoverState()});
this.widget.on(n,this,function(e){y&&e.data&&"BA"===e.data.paymentMethod&&(a.logCounterMetric({feature:"SecureRegistrationLoadSuccess_"+b._deviceType,resource:"_Count"}),a.logLatencyMetric({feature:"SecureRegistrationLoadTime",resource:"_Latency",startTime:y}),y=null);a.publishMetrics()});if(this._shouldRenderInPopover)this.widget.on("pmts-add-bank-js-popover-cancel-event",this,function(b){this.getDOMElement("pmts-add-bank-js-popover-cancel-form").submit()})},_bindAddBankAccountTrigger:function(){var e=
this,q=this._declarativeActionName;g.when("A").execute(function(c){c.declarative(q,"click",function(){y=(new Date).getTime();a.logCounterMetric({feature:"SecureRegistrationLinkClicked_"+e._deviceType,resource:"_Count"});e.widget.publishSuccessSushiMetrics({ActionType:"StartAddBankAccount",ActionValueType:"Click",ActionValue:"SecureAddBankAccountLinkClicked",ActionParentValueType:"PurchaseDocument",ActionParentValue:e._purchaseId});e.widget.trigger(b,{postData:{hideAddPaymentInstrumentHeader:!0,creatablePaymentMethods:e._creatablePaymentMethods,
iFrameName:e._secureIframeName}})})})},_changeBankCodeDropdown:function(){this.getDOMElement("bankCode").val("");var b=d("[name\x3d'ppw-bankNameDropdown']").val();"Other"===b?(c.hideElement(this.getDOMElement("bankNameDropdown")),c.showElement(this.getDOMElement("bankName")),c.showElement(this.getDOMElement("bankName").parent()),this.getDOMElement("bankName").focus()):this.getDOMElement("bankCode").val(b)},_changeBankNameSuggestions:function(b){this._clearBankSuggestions();var a=this.getDOMElement("bankName").val().toUpperCase();
if(""!==a){var e=0,q;for(q in b){var c=b[q];-1<c.toUpperCase().indexOf(a)&&(this._displayBankSuggestion(q,c),e++);if(5<=e)break}}},_clearBankSuggestions:function(){this.getDOMElement("bankCode").val("");d("#bank-name-options-box").children().first().html("");c.hideElement(d("#bank-name-options-box"))},_displayBankSuggestion:function(b,a){c.showElement(d("#bank-name-options-box"));var e=d("#bank-name-option-template").clone();e.removeAttr("id");e.removeClass("aok-hidden");e.html(a);e.attr("data-bankcode",
b);d("#bank-name-options-box").children().first().append(e)},_selectBankFromSuggestion:function(b){this._clearBankSuggestions();this.getDOMElement("bankCode").val(b.dataset.bankcode);this.getDOMElement("bankName").val(b.innerHTML)},_bindNonSecureAddBankAccountTrigger:function(){g.when("A").execute(function(b){b.declarative("a-modal","click",function(){a.logCounterMetric({feature:"NonSecureRegistrationLinkClicked",resource:"_Count"})})})},_addBankAccountFormSubmitMetric:function(){a.logCounterMetric({feature:this._isSecureRegistrationWidget?
"BA_SecureRegistrationFormSubmitted":"BA_NonSecureRegistrationFormSubmitted",resource:"_Count"})}})});l("components/AddBankAccountWorkflowComponent",["component","lang","AUI!P","mash-helper"],function(c,d,f,h){return c.extend({initialize:function(c,a){this._isSecureRegistrationWidget=a.data.isSecureRegistrationWidget;this._isRequestForMobileApp=a.data.isRequestForMobileApp;this._dispatcherSecurePaymentMethodAddedEvent=a.data.dispatcherSecurePaymentMethodAddedEvent},bindToEvents:function(){var c=this;
this.widget.on("WidgetAction",this,function(a){"add-payment-instrument"===a.widgetActionType&&"add-bank-account-workflow-complete"===a.widgetAction&&c._isSecureRegistrationWidget&&c._isRequestForMobileApp&&h.dispatchEvent(c._dispatcherSecurePaymentMethodAddedEvent,{paymentInstrumentId:a.paymentInstrumentId,widgetAction:a.widgetAction,walletId:a.walletId})})}})});l("components/AddConsumerInvoicingComponent",["events/form-submitted-event","form-component","lang","jQuery","css-utils"],function(c,d,f,
h,g){return d.extend({initialize:function(a,c){this._action=c.data.action;this._addConsumerInvoicingFormCssName=c.data.addConsumerInvoicingFormCssName;this._addConsumerInvoicingHiddenIsRequiredCssName=c.data.addConsumerInvoicingHiddenIsRequiredCssName;this._addConsumerInvoicingRequiredForCssName=c.data.addConsumerInvoicingRequiredForCssName;this._addConsumerInvoicingHiddenFieldCssName=c.data.addConsumerInvoicingHiddenFieldCssName;this.$addCiSubmitButton=this.getDOMElement("pmts-add-consumer-invoicing-continue-button");
this.$addCiSCountriesDropdown=this.getDOMElement("pmts-add-consumer-invoicing-countries-dropdown")},bindToElements:function(){var a=this;h("[name\x3d'ppw-birthDateDay']").change(function(){a.populateDateOfBirth()});h("[name\x3d'ppw-birthDateMonth']").change(function(){a.populateDateOfBirth()});h("[name\x3d'ppw-birthDateYear']").change(function(){a.populateDateOfBirth()});this.$addCiSubmitButton.click(f.bind(this._handleFormSubmission,this));this.$addCiSCountriesDropdown.change(f.bind(this._clickedDropdown,
this))},bindToEvents:function(){this.widget.on("componentsInitialized",this,function(a){this.$addCiSCountriesDropdown.change()});this.widget.on(c,this,function(a){a.action===this._action&&this.getDOMElement("pmts-add-consumer-invoicing-form").submit()})},_handleFormSubmission:function(a){if(0===this.form.validateForm().length){var g=this.getFormSubmissionParameters("pmts-add-consumer-invoicing-container");this.widget.trigger(c,{submissionParameters:g,event:a,action:this._action})}else a.preventDefault()},
_clickedDropdown:function(a){function c(b,a,e){e||(a?g.showElement(b):g.hideElement(b));b.each(function(){var b=h(this).find("."+k._addConsumerInvoicingHiddenIsRequiredCssName);b.length&&b.val(a)})}var k=this,e=k._addConsumerInvoicingRequiredForCssName+a.target.value;a=h("form."+k._addConsumerInvoicingFormCssName+" ."+e).not("."+k._addConsumerInvoicingHiddenFieldCssName);var b=h("form."+k._addConsumerInvoicingFormCssName+" ."+e).filter("."+k._addConsumerInvoicingHiddenFieldCssName),e=h("form."+k._addConsumerInvoicingFormCssName+
' [class*\x3d"'+k._addConsumerInvoicingRequiredForCssName+'"]').not("."+e);c(e,!1,!1);c(a,!0,!1);c(b,!0,!0)},populateDateOfBirth:function(){var a=this.formatDayAndMonth(h("[name\x3d'ppw-birthDateDay']").val()),c=this.formatDayAndMonth(h("[name\x3d'ppw-birthDateMonth']").val()),k=h("[name\x3d'ppw-birthDateYear']").val();a&&c&&k&&(a=a+"."+c+"."+k,h("[name\x3d__sif_encrypted_invoicing_date_of_birth]").val(a))},formatDayAndMonth:function(a){return a&&1===a.length?"0"+a:a}})});l("components/AddConsumerInvoicingWorkflowComponent",
"jQuery component aui-helper AUI!P clog events/close-secure-container-event events/postToSecureIframeEvent events/secureIframeLoadedEvent".split(" "),function(c,d,f,h,g,a,m,k){var e=null;return d.extend({_creatablePaymentMethods:[],_isSecureRegistrationEnabledForCI:!1,initialize:function(b,a){this.$addConsumerInvoicingPopoverTriggerLink=this.getDOMElement("addConsumerInvoicingPopoverTriggerLink");this.$UseSelectedAddressButtonSelector=a.data.useSelectedAddressCompactButtonSelector||"#addConsumerInvoicingPopoverId .pmts-use-selected-address";
this.$AddAddressButtonSelector=a.data.addAddressCompactButtonSelector||"#addConsumerInvoicingPopoverId .pmts-save-address";this.isExpanded=a.data.isExpanded||!1;this._isDesktop="desktop"===b.options.deviceType;this._creatablePaymentMethods=a.data.creatablePaymentMethods;this._isSecureRegistrationEnabledForCI=a.data.isSecureRegistrationEnabledForCI},_initPopoverState:function(){this.refreshAddConsumerInvoicingPopover();this.isExpanded&&this.widget.trigger("openAddConsumerInvoicingPopover")},bindToElements:function(){this._isSecureRegistrationEnabledForCI?
this._bindAddConsumerInvoicingTrigger():this._bindNonSecureAddConsumerInvoicingTrigger()},bindToEvents:function(){var b=this;b.widget.on("componentsInitialized",b,function(b){this._initPopoverState()});c(this.$AddAddressButtonSelector).click(function(a){b.closeAddConsumerInvoicingPopover()});c(this.$UseSelectedAddressButtonSelector).click(function(a){b.closeAddConsumerInvoicingPopover()});b.widget.on("showAddConsumerInvoicingSleeve",b,function(a){a=c(".pmts-add-consumer-invoicing-container");f.getExpanderHelper(a).isExpanded()||
a.find(".a-expander-header").click();b.widget.scrollToElement(a)});b.widget.on("openAddConsumerInvoicingPopover",b,function(a){b.$addConsumerInvoicingPopoverTriggerLink.trigger("click")});b.widget.on(k,this,function(a){e&&a.data&&"CI"===a.data.paymentMethod&&(g.logCounterMetric({feature:"SecureRegistrationLoadSuccess_"+b._deviceType,resource:"_Count"}),g.logLatencyMetric({feature:"SecureRegistrationLoadTime",resource:"_Latency",startTime:e}),e=null);g.publishMetrics()})},_bindAddConsumerInvoicingTrigger:function(){var b=
this;b._isDesktop&&h.when("A").execute(function(a){a.declarative("add-consumer-invoicing-action-name","click",function(){e=(new Date).getTime();g.logCounterMetric({feature:"SecureRegistrationLinkClicked_"+b._deviceType,resource:"_Count"});b.widget.trigger(m,{postData:{hideAddPaymentInstrumentHeader:!0,creatablePaymentMethods:b._creatablePaymentMethods}})})})},_bindNonSecureAddConsumerInvoicingTrigger:function(){h.when("A").execute(function(b){b.declarative("a-modal","click",function(){g.logCounterMetric({feature:"NonSecureRegistrationLinkClicked",
resource:"_Count"})})})},refreshAddConsumerInvoicingPopover:function(){h.when("a-modal").execute(function(b){b&&(b=b.get("addConsumerInvoicingPopover"))&&b.isActive()&&b.refresh()})},closeAddConsumerInvoicingPopover:function(){this._isSecureRegistrationEnabledForCI?this.widget.trigger(a):h.when("a-modal").execute(function(b){b&&(b=b.get("addConsumerInvoicingPopover"))&&b.hide()})}})});l("components/AddCreditCardComponent","css-utils jQuery form-component form-helper lang AUI!P clog mock-helper keyboard cc-spacing aui-helper events/form-submitted-event events/close-add-credit-card-form-event events/close-secure-container-event events/display-secure-container-event events/MPCIntegrationCompletedEvent events/MPCIntegrationInitializedEvent events/postToSecureIframeEvent events/secureIframeLoadedEvent events/CreditCardNumberResetEvent AddPaymentInstrumentStorageConsentHelper cvv-rate-limiting-inline-message-helper cc-validation-inline-message-helper cc-holder-name-validation-inline-message-helper validation-functions events/InstrumentRowSelectedEvent mash-helper TransitionMetricsConstants".split(" "),
function(c,d,f,h,g,a,m,k,e,b,n,q,y,v,t,I,u,l,w,E,A,x,B,F,z,D,Q,C){var G=/^[0-9]+$/,J=null;return f.extend(A,{_hasErrors:!1,_issuer:"",_isCombineAddCCAndDCEnabled:!1,_isCvvForMbcc:!1,_isMbcc:!1,_issuersRequirePostalCode:[],_issuersRequireSecurityToken:[],_issuersHaveNoExpiration:[],_ccScannerParams:r,_ccTapToAddParams:r,_debitCardConfiguration:r,_debitCardSBIMaestroValue:"",_creatablePaymentMethods:[],_isCCSyncVerificationEnabled:!1,_isCreditCardAdditionsBlocked:!1,_isCreditCardCVVVerificationFailed:!1,
_isSynchronousVerificationCardAdditionComplete:!1,_isRequestForMobileApp:!1,_clientId:"",_warningBrands:[],_warningCategory:"",_cardType:"",_isRenderBlockCardRegistrationIMB:!1,_isBlockCardRegistration:!1,_rateLimitDurationInSeconds:0,_selectedDebitCardIssuingBank:r,_isMCXRegistrationEnabled:!1,_isDynamicRateLimitMessage:!1,_tapToAddNullField:"NULL_FIELD",_brandRequiringCVVAuthenticationList:[],_isGPACVVEnabledForCardRegistrationOption:!1,initialize:function(b,a){this._deviceType=b.options.deviceType;
this._isDesktop="desktop"===b.options.deviceType;this.getDOMElement("warningMessagesBoxContainer")&&c.hideElement(this.getDOMElement("warningMessagesBoxContainer"));this._isCombineAddCCAndDCEnabled=a.data.isCombineAddCCAndDCEnabled;this._hasErrors=a.data.hasErrors;this._isCvvForMbcc=a.data.isCvvForMbcc;this._issuersRequirePostalCode=a.data.issuersRequirePostalCode;this._issuersRequireSecurityToken=a.data.issuersRequireSecurityToken;this._issuersHaveNoExpiration=a.data.issuersHaveNoExpiration;this._isMbcc=
a.data.isAddingMbcc;this.updateMbccFields(this._isMbcc);this._creatablePaymentMethods=a.data.creatablePaymentMethods;this._isSecureRegistrationPageTriggerShown=a.data.isSecureRegistrationPageTriggerShown;this._isSecureRegistrationWidget=a.data.isSecureRegistrationWidget;this._secureIframeName=a.data.secureIframeName;this._isMCXRegistrationEnabled=a.data.isMCXRegistrationEnabled||!1;this._addButtonJSBinding=a.data.addButtonJSBinding||"newCreditCardSubmitButton";this._addFormJSBinding=a.data.addFormJSBinding||
"pmts-add-creditcard-form";this._action=a.data.action||"add-credit-card";this._accountHolderNameBinding=a.data.addAccountHolderNameBinding||"accountHolderName";this._addNameOnAccountCheckboxBinding=a.data.addNameOnAccountCheckboxBinding||"getNameOnAccount";this._addCardNumberBinding=a.data.addCardNumberBinding||"addCreditCardNumber";this._addFormContainerJSBinding=a.data.addFormContainerJSBinding||"addCreditCardContainer";this._isINMarketplace=!!a.data.isINMarketplace;this._clearPrePopulatedAccountNameBinding=
a.data.clearPrePopulatedAccountNameBinding;this._secondaryFormFieldsJSBindElementReference=a.data.secondaryFormFieldsJSBindElementReference;this._hideSecondaryFormFields=a.data.hideSecondaryFormFields;this._showExpiryDateTextInputField=a.data.showExpiryDateTextInputField;this._expiryDateTextInputBinding=a.data.expiryDateTextInputBinding;this._showIssuerImageOnTextInputField=a.data.showIssuerImageOnTextInputField;this._blankIssuerImageURL=a.data.blankIssuerImageURL;this._debitCardConfiguration=a.data.debitCardConfiguration;
this._debitCardSBIMaestroValue=a.data.debitCardSBIMaestroValue;this._placementType=a.data.placementType;this._JsBindingExpirationDateLabel=a.data.JsBindingExpirationDateLabel;this._JsBindingExpirationMonthDropdown=a.data.JsBindingExpirationMonthDropdown;this._JsBindingExpirationYearDropdown=a.data.JsBindingExpirationYearDropdown;this._suppressExpirationForInternationalMaestro=a.data.suppressExpirationForInternationalMaestro;this.form.formModel.registerAdditionalData("issuerFn",g.bind(this.getIssuer,
this));this.form.formModel.registerAdditionalData("isMbccFn",g.bind(this.getIsMbcc,this));this.form.formModel.registerAdditionalData("isCvvForMbcc",this._isCvvForMbcc);this.form.formModel.registerAdditionalData("isSBIMaestroFn",g.bind(this.getIsSBIMaestro,this));this._isCCSyncVerificationEnabled=a.data.isCCSyncVerificationEnabled||!1;this._isCreditCardAdditionsBlocked=a.data.creditCardAdditionsBlocked||!1;this._isCreditCardCVVVerificationFailed=a.data.creditCardCVVVerificationFailed||!1;this._isSynchronousVerificationCardAdditionComplete=
a.data.synchronousVerificationCardAdditionComplete;this._isRequestForMobileApp=a.data.isRequestForMobileApp||!1;this._clientId=a.data.clientId;this._declarativeActionName=a.data.declarativeActionName;this._warningBrands=a.data.warningBrands;this._warningCategory=a.data.warningCategory;this._isRenderBlockCardRegistrationIMB=a.data.isRenderBlockCardRegistrationIMB;this._addCreditCardTurnOffIMBJSBinding=a.data.addCreditCardTurnOffIMBJSBinding;this._addPNCCardTurnOffIMBJSBinding=a.data.addPNCCardTurnOffIMBJSBinding;
this._rateLimitDurationInSeconds=a.data.rateLimitDurationInSeconds||0;this._isDynamicRateLimitMessage=a.data.isDynamicRateLimitMessage;this._brandRequiringCVVAuthenticationList=a.data.brandRequiringCVVAuthenticationList;this._isGPACVVEnabledForCardRegistrationOption=a.data.isGPACVVEnabledForCardRegistrationOption;this._isRequestForMobileApp&&this._isSecureRegistrationWidget&&Q.dispatchEvent("DisableCheckoutRefreshEvent",{})},_initPopoverState:function(){"true"!==this._hasErrors||this._isCreditCardAdditionsBlocked||
(this.getDOMElement("creditCardPopoverLink").trigger("click"),this.widget.trigger(t))},_isMPCIntegrationTypeSupported:function(b){return"cc_integ"===b},handleAddCardLikeDOMEvent:function(b){var e=this;if(this._isRenderBlockCardRegistrationIMB&&this._isBlockCardRegistration)return!1;if(this._isCCSyncVerificationEnabled){var c;d("img.pmts-loading-async-widget-spinner-viewport-centered")&&0!==d("img.pmts-loading-async-widget-spinner-viewport-centered").length?c=d("img.pmts-loading-async-widget-spinner-viewport-centered"):
d("img.pmts-loading-async-widget-spinner-centered")&&0!==d("img.pmts-loading-async-widget-spinner-centered").length?c=d("img.pmts-loading-async-widget-spinner-centered"):d("img.pmts-loading-async-spinner-small")&&0!==d("img.pmts-loading-async-spinner-small").length&&(c=d("img.pmts-loading-async-spinner-small"));if(c!==r){var k=c.attr("src");c.attr("src","https://images-na.ssl-images-amazon.com/images/G/01/payments-portal/r1/loading-verifying-your-card-spinner.gif");this.widget.on("submitFormAjaxCompleted",
this,function(){c.attr("src",k)})}}var n=this.form.validateForm();A.blameFormField.apply(this,[n]);this._isMCXRegistrationEnabled&&this._toggleAddCardButtonDisabled(0<n.length);0===n.length?(this._formSubmissionEventObj={submissionParameters:this.getFormSubmissionParameters(this._addFormContainerJSBinding),action:this._action,event:b},g.isDefined(this._formSubmissionEventObj.submissionParameters)&&g.isDefined(this._formSubmissionEventObj.submissionParameters[1])&&(this._formSubmissionEventObj.submissionParameters[1].value=
this._formSubmissionEventObj.submissionParameters[1].value.replace(/\s/g,"")),this._isMPCIntegrationRequired?a.when(this._mpcPopoverAction,"jQuery","ready").execute(function(b,a){(b=b.get(a("#"+e._mpcPopoverActionId)))?(m.logCounterMetric({feature:"MpcPromptClicked."+e._integrationType,resource:"_Count"}),e._mpcInitializedTime&&m.logLatencyMetric({feature:"MpcInitializationTilClickSpan."+e._integrationType,resource:"_Latency",startTime:e._mpcInitializedTime}),m.publishMetrics(),b.show()):e.widget.trigger(q,
e._formSubmissionEventObj)}):this.widget.trigger(q,this._formSubmissionEventObj)):g.forEach(n,function(b){e.widget.publishFailureSushiMetrics({ActionType:"AddCreditCard",ActionValueType:"ErrorField",ActionValue:b.field})});return!1},clearPrepopulatedAccountHolderName:function(){this.getDOMElement(this._accountHolderNameBinding).val("");this.getDOMElement(this._accountHolderNameBinding)[0].placeholder=this.widget.getLocalizedString("pmts_portal_add_credit_card_name_label")},closeAddCreditCardPopover:function(b){this.widget.trigger(v,
b);this.widget.trigger(y);this._isCCSyncVerificationEnabled&&this._isSecureRegistrationWidget&&p.parent.postMessage(JSON.stringify({event:{name:"apx:iframe:close",data:{iFrameName:this._secureIframeName}}}),"*")},generateValidCardNumber:function(b){b=b.replace(/\s/g,"").substring(0,8);for(var a=16-(b.length+1),e=0;e<a;e++)b=b.concat(Math.floor(10*Math.random()));for(var a=0,q=b.length-1;0<=q;q--)e=parseInt(b.charAt(q),10),0===q%2&&(e*=2,e=9<e?e-9:e),a+=e;return b=b.concat(10-a%10)},bindRealTimeErrorMessages:function(){for(var b=
0;b<this.form.formModel.constraints.length;b++){if(this.form.formModel.constraints[b].metaData.textChangeTrigger){var a=this.getDOMElement(this.form.formModel.constraints[b].metaData.inputFieldName),e=this.form.formModel.constraints[b].metaData;this.bindFieldToEventListener(a,e,"input",this)}this.form.formModel.constraints[b].metaData.focusChangeTrigger&&(a=this.getDOMElement(this.form.formModel.constraints[b].metaData.inputFieldName),e=this.form.formModel.constraints[b].metaData,this.bindFieldToEventListener(a,
e,"focusout",this))}},bindFieldToEventListener:function(b,a,e,q){b.bind(e,function(){for(var b=0;b<q.form.formModel.constraints.length;b++){var e=q.form.formModel.constraints[b].metaData;e.id===a.id?e.prioritized=!0:e.inputFieldName===a.inputFieldName&&(e.textChangeTrigger===a.textChangeTrigger||e.focusChangeTrigger===a.focusChangeTrigger?e.prioritized=!0:(e.prioritized=!1,q.form.clearLowPrioField(q.form.formModel.constraints[b].metaData)))}b=q.form.validateField(a);q._toggleAddCardButtonDisabled(b)})},
bindToElements:function(){var a=this;a.getDOMElement("addCardLearnMoreLink").click(function(){a.widget.publishSuccessSushiMetrics({ActionValue:"Click",ActionValueType:"LearnMorePopover",ActionParentValue:"LearnMoreOnAddCards",ActionParentValueType:"LearnMoreLinkPosition"})});this.getDOMElement(this._addButtonJSBinding).click(g.bind(this.handleAddCardLikeDOMEvent,this));this.getDOMElement(this._addButtonJSBinding).click(function(){a.widget.publishSuccessSushiMetrics({ActionType:"AddCreditCard",ActionValueType:"AddMethod",
ActionValue:"AddCreditCardButtonClicked"})});this.getDOMElement("newCreditCardCancelButton").click(function(){a.closeAddCreditCardPopover({force:!0});a.widget.publishSuccessSushiMetrics({ActionType:"CancelAddCreditCard",ActionValueType:"Click",ActionValue:"CancelButtonClicked",ActionParentValueType:"PurchaseDocument",ActionParentValue:a._purchaseId})});this._isSecureRegistrationPageTriggerShown?this._bindAddCreditCardTrigger():this._bindNonSecureAddCreditCardTrigger();this.getDOMElement(this._clearPrePopulatedAccountNameBinding).click(g.bind(this.clearPrepopulatedAccountHolderName,
this));var q=this.getDOMElement(this._accountHolderNameBinding),k=this.getDOMElement(this._addNameOnAccountCheckboxBinding),n=this.getDOMElement(this._addCardNumberBinding),y=this.getDOMElement(this._expiryDateTextInputBinding);this._showIssuerImageOnTextInputField&&c.setElementBackgroundImage(n,this._blankIssuerImageURL,"no-repeat 96% center");k.bind("change",function(b){d(this).is(":checked")?q.val(k.val()):q.val("")});this._secondaryFormFieldsJSBindElementReference&&this._hideSecondaryFormFields&&
n.focus(function(b){(b=a.getDOMElement(a._secondaryFormFieldsJSBindElementReference))&&c.showElement(b)});this.bindRealTimeErrorMessages();var t,m;n.keydown(function(b){t=this.value;m=this.selectionStart});this._isCombineAddCCAndDCEnabled||this._isMCXRegistrationEnabled?n.bind("paste",function(e){p.setTimeout(function(b){b=n.val().replace(/\s/g,"");G.test(b)&&8<=b.length&&(b=a.generateValidCardNumber(b),a.widget.trigger("creditCardNumberChanged",{creditCardNumber:b,placementType:a._placementType}))},
1);this.value=b.fixSpacing(this.value);c.hideElement(a.getDOMElement("CardScannerWrapperJSBinding"))}):n.change(function(e){a.widget.trigger("creditCardNumberChanged",{creditCardNumber:this.value,placementType:a._placementType});this.value=b.fixSpacing(this.value)});this._isMCXRegistrationEnabled&&(n.change(function(){if(8<this.value.length){var e=a.generateValidCardNumber(this.value);a.widget.trigger("creditCardNumberChanged",{creditCardNumber:e,placementType:a._placementType})}this.value=b.fixSpacing(this.value)}),
n.keyup(function(){0<this.value.length?c.hideElement(a.getDOMElement("CardScannerWrapperJSBinding")):(c.showElement(a.getDOMElement("CardScannerWrapperJSBinding")),a.widget.trigger("creditCardNumberChanged",{creditCardNumber:"",placementType:a._placementType}))}));n.keyup(function(e){"number"!==this.type&&this.value!==t&&(e=this.selectionStart,this.value=b.fixSpacing(this.value),e=b.fixCaret(e,this.value,t,m),this.setSelectionRange(e,e));e=n.val().replace(/\s/g,"");(a._isCombineAddCCAndDCEnabled||
a._isMCXRegistrationEnabled)&&G.test(e)&&8===e.length&&(e=a.generateValidCardNumber(this.value),a.widget.trigger("creditCardNumberChanged",{creditCardNumber:e,placementType:a._placementType}))});this._showExpiryDateTextInputField&&this._expiryDateTextInputBinding&&y.keydown(function(b){b.preventDefault();var a=b.keyCode;if(a<=e.keys.VK_NINE&&a>=e.keys.VK_ZERO||a===e.keys.VK_BACKSPACE||a===e.keys.VK_DELETE){var q=b.target.selectionStart,c=b.target.selectionEnd,k=this.value;a===e.keys.VK_BACKSPACE&&
q===c?k=2<q&&5>=q?k[0]+k.slice(2,k.length):k.slice(0,q-1)+k.slice(c,k.length):a!==e.keys.VK_BACKSPACE&&a!==e.keys.VK_DELETE||q===c?a!==e.keys.VK_BACKSPACE&&a!==e.keys.VK_DELETE&&(k=k.slice(0,q)+b.originalEvent.key+k.slice(c,k.length)):k=k.slice(0,q)+k.slice(c,k.length);k=k.replace(/\D/g,"");"1"<k[0]&&(k="0"+k);"1"===k[0]&&"2"<k[1]?k="3">k[2]?k[0]+k.slice(2,k.length):"3">k[3]?k[0]+k.slice(3,k.length):k[0]:"0"===k[0]&&"0"===k[1]&&(k="0"<k[2]?k[0]+k.slice(2,k.length):"0"<k[3]?k[0]+k.slice(3,k.length):
k[0]);2<=k.length&&(k=k.slice(0,2)+" / "+k.slice(2,4));this.value=k;y.trigger("input",{})}});q.bind("change",function(b){b=q.val();a.widget.trigger("accountHolderNameChange",{accountHolderName:b})});this._isCCSyncVerificationEnabled&&this._isSynchronousVerificationCardAdditionComplete&&this._isSecureRegistrationPageTriggerShown&&this.closeAddCreditCardPopover({});this._isCreditCardAdditionsBlocked&&this.widget.trigger("creditCardAdditionsBlockedEvent",{deviceType:this._deviceType,isSecureRegistration:this._isSecureRegistrationWidget||
this._isSecureRegistrationPageTriggerShown,isCreditCardCVVVerificationFailed:this._isCreditCardCVVVerificationFailed,rateLimitDurationInSeconds:this._rateLimitDurationInSeconds,isDynamicRateLimitMessage:this._isDynamicRateLimitMessage});this._isCCSyncVerificationEnabled&&this._isCreditCardCVVVerificationFailed&&this._setVerificationFailedErrorMessageHeader();A.bindToElements.apply(this)},_setVerificationFailedErrorMessageHeader:function(){var b=d(".pmts-add-credit-card-component-container");b&&(b=
b.find(".a-alert-error"))&&b.find(".a-alert-heading")&&1===b.find(".a-alert-heading").length&&b.find(".a-alert-heading").html(this.widget.getLocalizedString("pmts_portal_add_credit_card_verify_failed_heading"))},bindToEvents:function(){var b=this;this.widget.on(q,this,function(a){if(a.action===this._action){this._recordCCScannerMetrics(a.submissionParameters);a&&a.submissionParameters&&(this._recordCCTapToAddMetrics(a.submissionParameters),b._ccTapToAddParams=null);var e=d(this.getDOMElement(this._addButtonJSBinding)).closest("form");
this.getDOMElement(this._addButtonJSBinding).find("input").each(function(b,a){h.ensureWidgetEventInput(e,a.name)});a=e.find("input[type\x3d'hidden'][name\x3d'ppw-issuer']");0<a.length?a.val(this._issuer):e.append(this._buildHiddenInput("ppw-issuer",this._issuer));k.mocked(this,this._action,function(){e.submit()});this._isCCSyncVerificationEnabled||this.closeAddCreditCardPopover({});this._addCreditCardFormSubmitMetric()}});this.widget.on("accountHolderNameChange",this,function(a){var e=b.getDOMElement(b._addNameOnAccountCheckboxBinding);
a.accountHolderName.trim()!==e.val()?e.prop("checked",!1):e.prop("checked",!0)});b.widget.on("resetAccountHolderNameCheckbox",b,function(){b.getDOMElement(b._addNameOnAccountCheckboxBinding).prop("checked",!1);b.getDOMElement(b._accountHolderNameBinding).val("")});this.widget.on("creditCardIssuerDetermined",this,function(a){this._issuer=a.issuer;this._isMbcc="true"===a.isMbcc;this._cardType=a.cardType;this._isBlockCardRegistration="true"===a.isBlockCardRegistration;if(this._showIssuerImageOnTextInputField&&
a.issuerImage){var e=this.getDOMElement(this._addCardNumberBinding);c.setElementBackgroundImage(e,a.issuerImage)}-1!==d.inArray(this._issuer,this._warningBrands)&&'"CREDIT"'===this._cardType&&(c.showElement(d(".apx-add-payment-inline-warning-message")),b.widget.publishSuccessSushiMetrics({ActionType:this._warningCategory||"WarningCategoryUndefined",ActionValueType:"Messaging",ActionValue:"Add-PM"}));this._isCCSyncVerificationEnabled&&(a.cvvHelpPopoverDescriptionStringId&&(e=b.widget.getLocalizedString(a.cvvHelpPopoverDescriptionStringId),
this.getDOMElement("CardSecurityCodeHelpDescription").text(e)),a.cvvHelpPopoverImageURL&&this.getDOMElement("CardSecurityCodeHelpImage").attr("src",a.cvvHelpPopoverImageURL));this._updateCreditCardFields()});this.widget.on("cardTypeDetermined",this,function(b){b='"DEBIT"'===b;c.toggleElement(this.getDOMElement("warningMessagesBoxContainer"),b)});this.widget.on(E,this,function(b){this._issuer="";this._isBlockCardRegistration=this._isMbcc=!1;c.hideElement(d(".apx-add-payment-inline-warning-message"));
this._showIssuerImageOnTextInputField&&(b=this.getDOMElement(this._addCardNumberBinding),c.setElementBackgroundImage(b,this._blankIssuerImageURL));this._updateCreditCardFields()});this.widget.on("addCreditCardScannerInfo",this,function(a){this._ccScannerParams=a;a.accountHolderName&&this.getDOMElement("accountHolderName").val(a.accountHolderName);a.creditCardNumber&&(c.hideElement(b.getDOMElement("CardScannerWrapperJSBinding")),this._populateCreditCardNumber(a.creditCardNumber));a.expirationDate&&
this._populateCreditCardExpiryDate(a.expirationDate.month,a.expirationDate.year);this._isMCXRegistrationEnabled&&(a=this.form.validateForm(),A.blameFormField.apply(this,[a]),this._toggleAddCardButtonDisabled(0<a.length))});this.widget.on("addCreditCardTapInfo",this,function(b){this._ccTapToAddParams=b;this._validateInputForTapSuccessEvent(b)?(this._displayTapToAddAlert("warning",b.successAlertMessage),b.cardInfo.creditCardNumber!==this._tapToAddNullField&&this._populateCreditCardNumber(b.cardInfo.creditCardNumber),
b.cardInfo.cardHolderName!==this._tapToAddNullField&&this._populateCreditCardHolderName(b.cardInfo.cardHolderName),this._populateCreditCardExpiryDate(b.cardInfo.expirationMonth,b.cardInfo.expirationYear),this._publishLatencyMetricsForTapToAdd("CardTapped_Latency",b.startTimeAfterCardTapped,b.processIsolation),this._publishLatencyMetricsForTapToAdd("Overall_Latency",b.startTimeAtButtonClick,b.processIsolation),this._publishCounterMetricsForTapToAdd("CreditCardInfo_Populated",b.processIsolation)):this._publishCounterMetricsForTapToAdd("SuccessEventObjInvalid",
b.processIsolation);this._emitMetricsForTapSuccessEvent(b)});this.widget.on("tapToAddCardFailureEvent",this,function(b){b&&b.failureAlertMessage?this._displayTapToAddAlert("error",b.failureAlertMessage):this._publishCounterMetricsForTapToAdd("FailureEventObjInvalid",b.processIsolation);this._emitMetricsForTapFailureEvent(b)});this.widget.on("debitCardTypeSelected",this,function(b){this._selectedDebitCardIssuingBank=b.selectedBank;this._updateCreditCardFields()});this.widget.on("showAddConsumerInvoicingSleeve",
this,function(b){b=d(".pmts-mobile-add-credit-card-container");n.getExpanderHelper(b).isExpanded()&&b.find(".a-expander-header").click()});this.widget.on("componentsInitialized",this,function(b){this._initPopoverState();this._isMCXRegistrationEnabled&&this._toggleAddCardButtonDisabled(!0)});this.widget.on(y,this,function(){a.when("a-modal").execute(function(b){b&&(b=b.get("pmtsAddCreditCardPopover"))&&b.hide()})});this.widget.on(u,this,function(a){b._isMPCIntegrationTypeSupported(a.integType)&&(b._isMPCIntegrationRequired=
!0,b._integrationType=a.integType,b._mpcInitializedTime=a.initializedTime,b._mpcPopoverAction=a.mpcPopoverAction,b._mpcPopoverActionId=a.mpcPopoverActionId)});this.widget.on(I,this,function(a){b._isMPCIntegrationTypeSupported(a.integType)&&(b._isMPCIntegrationRequired=!1,b._formSubmissionEventObj&&this.widget.trigger(q,this._formSubmissionEventObj))});this.widget.on(w,this,function(a){a.data&&"CC"===a.data.paymentMethod&&(a.clickData&&a.clickData.startTimestamp&&a.clickData.startTimestampSource&&
m.logLatencyMetric({feature:a.clickData.startTimestampSource+C.SEPARATOR+C.CARD_REGISTRATION_FORM_VIEW,resource:"_Latency",startTime:a.clickData.startTimestamp}),m.logCounterMetric({feature:"SecureRegistrationLoadSuccess_"+b._deviceType,resource:"_Count"}),J&&(m.logLatencyMetric({feature:"SecureRegistrationLoadTime",resource:"_Latency",startTime:J}),J=null));m.publishMetrics()});this.widget.on("creditCardAdditionsBlockedEvent",this,function(b){this._displayCardAdditionsBlockedUI(b.isSecureRegistration,
b.deviceType,b.isCreditCardCVVVerificationFailed,b.rateLimitDurationInSeconds,b.isDynamicRateLimitMessage)});this.widget.on("triggerAddCardFlow",this,function(){b._isSecureRegistrationPageTriggerShown?this.getDOMElement("AddCreditCardContentTrigger").trigger("click"):(b.widget.trigger(D,{instrumentId:"SelectableAddCreditCard"}),d(".pmts-add-credit-card-component-container").get(0).scrollIntoView())})},_buildHiddenInput:function(b,a){return d("\x3cinput\x3e").attr({type:"hidden",name:b,value:a})},
_emitMetricsForTapFailureEvent:function(b){this._publishCounterMetricsForTapToAdd("FailureEventReceived",b.processIsolation);b?b.failureAlertMessage||this._publishCounterMetricsForTapToAdd("FailureEventAlertMessageNull",b.processIsolation):this._publishCounterMetricsForTapToAdd("FailureEventObjNull",b.processIsolation)},_validateInputForTapSuccessEvent:function(b){return b&&b.cardInfo&&b.cardInfo.creditCardNumber&&b.cardInfo.expirationMonth&&b.cardInfo.expirationYear&&b.cardInfo.cardHolderName&&b.successAlertMessage?
!0:!1},_emitMetricsForTapSuccessEvent:function(b){this._publishCounterMetricsForTapToAdd("SuccessEventReceived",b.processIsolation);b?(b.successAlertMessage||this._publishCounterMetricsForTapToAdd("SuccessEventAlertMessageNull",b.processIsolation),b.cardInfo||this._publishCounterMetricsForTapToAdd("SuccessEventObjCardInfoNull",b.processIsolation)):this._publishCounterMetricsForTapToAdd("SuccessEventObjNull",b.processIsolation)},_displayTapToAddAlert:function(b,e){c.showElement(this.getDOMElement("tapToAddAlert"));
a.when("a-alert").execute(function(a){a("#tap-to-add-alert-id").type(b).text(e).show()})},_publishCounterMetricsForTapToAdd:function(b,a){var e="AddCreditCard_TapToAdd_";a&&(e+="PI_");m.logCounterMetric({feature:e+b,resource:"_Count"});m.publishMetrics()},_publishLatencyMetricsForTapToAdd:function(b,a,e){var q="AddCreditCard_TapToAdd_";e&&(q+="PI_");m.logLatencyMetric({feature:q+b,resource:"_Latency",startTime:a});m.publishMetrics()},_populateCreditCardNumber:function(b){this.getDOMElement("addCreditCardNumber").val(b);
this.widget.trigger("creditCardNumberChanged",{creditCardNumber:b,placementType:self._placementType})},_populateCreditCardExpiryDate:function(b,a){this._showExpiryDateTextInputField&&this._expiryDateTextInputBinding?this.getDOMElement(this._expiryDateTextInputBinding).val(b+" / "+a%100):(this.form.getAUITagHelperForParameter("expirationDate_month").val(b),this.form.getAUITagHelperForParameter("expirationDate_year").val(a))},_populateCreditCardHolderName:function(b){this.getDOMElement(this._accountHolderNameBinding).val(b)},
_displayCardAdditionsBlockedUI:function(b,e,q,k,g){var y=this.widget.getLocalizedString("pm_add_card_rate_limit_and"),t=this.widget.getLocalizedString("pm_add_card_rate_limit_hours"),m=this.widget.getLocalizedString("pm_add_card_rate_limit_hour"),w=this.widget.getLocalizedString("pm_add_card_rate_limit_minute"),f=this.widget.getLocalizedString("pm_add_card_rate_limit_minutes");if(0<d(".pmts-add-credit-card-component-container").length){var h=d(".pmts-add-credit-card-component-container");0<h.find("form").length&&
c.hideElement(h.find("form"));if(this._isRequestForMobileApp&&b&&("YA:MPO"===this._clientId||"YA:OneClick"===this._clientId||"Checkout"===this._clientId||"YA:Wallet"===this._clientId)){0<k&&(g?x.displayTimer(k,y,t,m,w,f):x.display(k));var v=this;a.when("A","mash").execute(function(b,a){a.dispatchEvent({type:"BlockCardAdditionsEvent",detail:{isCreditCardCVVVerificationFailed:v._isCreditCardCVVVerificationFailed,rateLimitDurationInSeconds:k,andString:y,hoursString:t,hourString:m,minuteString:w,minutesString:f,
isDynamicRateLimitMessage:g}});(v._isCreditCardCVVVerificationFailed||v._isSecureRegistrationWidget)&&a.navstack.begin().back().end()})}else b?a.when("A","ready").execute(function(b){p.parent.postMessage(JSON.stringify({event:{name:"apx:add-payment-method:BlockCardAdditionsEvent",data:{iFrameName:this._secureIframeName,isCreditCardCVVVerificationFailed:q,rateLimitDurationInSeconds:k,andString:y,hoursString:t,hourString:m,minuteString:w,minutesString:f,isDynamicRateLimitMessage:g}}}),"*")}):("mobile"===
e&&0<d(".a-expander-header.pmts-mobile-add-credit-card-header").length?(b=d(".a-expander-header.pmts-mobile-add-credit-card-header"),n.getExpanderHelper(b).isExpanded()||b.click(),b.addClass("pmts-add-cc-link-disabled")):("desktop"===e||"tablet"===e)&&0<d(".a-expander-header.pmts-add-new-card").length&&(b=d(".a-expander-header.pmts-add-new-card"),n.getExpanderHelper(b).isExpanded()||b.click(),b.addClass("pmts-add-cc-link-disabled")),q?1===h.find(".pmts-add-cc-alert-container").length&&h.find(".pmts-add-cc-alert-container").removeClass("a-hidden aok-hidden"):
0<k?g?x.displayTimer(k,y,t,m,w,f):x.display(k):1===h.find(".pmts-add-cc-info-container").length&&h.find(".pmts-add-cc-info-container").removeClass("a-hidden aok-hidden"))}},_recordCCScannerMetrics:function(b){if(this._ccScannerParams){var a={};g.forEach(b,function(b,e){a[b.name]=d.trim(b.value)});a["ppw-accountHolderName"]===this._ccScannerParams.accountHolderName&&m.logCounterMetric({feature:"CreditCardScannerAccountHolderNameEvent",resource:"_SuccessCount"});a.addCreditCardNumber===this._ccScannerParams.creditCardNumber&&
m.logCounterMetric({feature:"CreditCardScannerPANEvent",resource:"_SuccessCount"});a["ppw-expirationDate_month"]===this._ccScannerParams.expirationDate.month&&a["ppw-expirationDate_year"]===this._ccScannerParams.expirationDate.year&&m.logCounterMetric({feature:"CreditCardScannerExpirationDateEvent",resource:"_SuccessCount"});this._ccScannerParams=null}},_isCCInfoModified:function(b,a,e){b===a?(this._publishCounterMetricsForTapToAdd(e+"_Accurate",this._ccTapToAddParams.processIsolation),b=!1):(this._publishCounterMetricsForTapToAdd(e+
"_Modified",this._ccTapToAddParams.processIsolation),b=!0);return b},_recordCCTapToAddMetrics:function(b){if(this._validateInputForTapSuccessEvent(this._ccTapToAddParams)&&b){var a={};g.forEach(b,function(b,e){a[b.name]=d.trim(b.value)});b=this._isCCInfoModified(a.addCreditCardNumber,this._ccTapToAddParams.cardInfo.creditCardNumber,"CreditCardNumber");var e=this._isCCInfoModified(a["ppw-expirationDate_month"],this._ccTapToAddParams.cardInfo.expirationMonth,"CreditCardExpiryMonth"),q=this._isCCInfoModified(a["ppw-expirationDate_year"],
this._ccTapToAddParams.cardInfo.expirationYear,"CreditCardExpiryYear");b||e||q?this._publishCounterMetricsForTapToAdd("CreditCardInfo_Modified",this._ccTapToAddParams.processIsolation):this._publishCounterMetricsForTapToAdd("CreditCardInfo_Accurate",this._ccTapToAddParams.processIsolation)}},_updateCreditCardFields:function(){this.toggleExpirationDates(this._issuer);this.toggleExpirationDatesWithNoExpiryInfo(this._issuer);this._isRenderBlockCardRegistrationIMB&&(this.toggleTurnOffIMB(this._isBlockCardRegistration),
c.toggleDisabledElement(this.getDOMElement(this._addButtonJSBinding),!this._isBlockCardRegistration));this.triggerBehaviourForElements(this._issuer);this.toggleExpiryMonthAndYearByIssuer(this._issuer);this.updateMbccFields(this._isMbcc);this._updateRealtimeValidation()},triggerBehaviourForElements:function(b){var a,e;"add-debit-card"===this._action?(a=this.form.fields.addCreditCardVerificationNumber_VDC.fieldRequiredParameterName,e=this.form.fields.addCreditCardPostalCode_VDC.fieldRequiredParameterName):
"add-emi-credit-card"===this._action?(a=this.form.fields.addCreditCardVerificationNumber_VCC.fieldRequiredParameterName,e=this.form.fields.addCreditCardPostalCode_EMI.fieldRequiredParameterName):(a=this.form.fields.addCreditCardVerificationNumber.fieldRequiredParameterName,e=this.form.fields.addCreditCardPostalCode.fieldRequiredParameterName);this._isINMarketplace&&(b||this._selectedDebitCardIssuingBank)?-1!==d.inArray(b,this._issuersRequirePostalCode)?(this.showPostalCodeRow(),this.hideCVVRow(),
this.form.getAUITagHelperForParameter(a).val(!1),this.form.getAUITagHelperForParameter(e).val(!0)):-1!==d.inArray(b,this._issuersRequireSecurityToken)?(this.hidePostalCodeRow(),this.showCVVRow(),this.form.getAUITagHelperForParameter(a).val(!0),this.toggleExpiryMonthAndYear(!0),this.form.getAUITagHelperForParameter(e).val(!1)):this._isCombineAddCCAndDCEnabled?(this.hideCVVRow(),this.form.getAUITagHelperForParameter(a).val(!1),"BFL"===b&&this.toggleExpiryMonthAndYear(!0)):"add-debit-card"===this._action&&
this._selectedDebitCardIssuingBank in this._debitCardConfiguration&&(this.toggleCVVRow(this._debitCardConfiguration[this._selectedDebitCardIssuingBank].showCvv),this.toggleExpiryMonthAndYear(this._debitCardConfiguration[this._selectedDebitCardIssuingBank].showExpiry)):this._isGPACVVEnabledForCardRegistrationOption&&(b&&-1==d.inArray(b,this._brandRequiringCVVAuthenticationList)?(this.hideCVVRow(),this.form.getAUITagHelperForParameter(a).val(!1)):b&&-1!==d.inArray(b,this._brandRequiringCVVAuthenticationList)&&
(this.showRequiredCVVRow(),this.form.getAUITagHelperForParameter(a).val(!0)))},showCVVRow:function(){null!=d(".addCreditCardVerificationNumberRow")&&c.showElement(d(".addCreditCardVerificationNumberRow"))},showRequiredCVVRow:function(){this._isMCXRegistrationEnabled&&null!=d(".mcx-cvv-input")?c.showElement(d(".mcx-cvv-input")):null!=d(".addCreditCardRequiredVerificationNumberRow")&&c.showElement(d(".addCreditCardRequiredVerificationNumberRow"))},hideCVVRow:function(){null!=d(".addCreditCardVerificationNumberRow")&&
c.hideElement(d(".addCreditCardVerificationNumberRow"));null!=d(".addCreditCardRequiredVerificationNumberRow")&&c.hideElement(d(".addCreditCardRequiredVerificationNumberRow"));null!=d(".mcx-cvv-input")&&c.hideElement(d(".mcx-cvv-input"))},toggleExpiryMonthAndYearByIssuer:function(b){"InternationalMaestro"===b&&this._suppressExpirationForInternationalMaestro&&this.toggleExpiryMonthAndYear(!1)},toggleExpiryMonthAndYear:function(b){c.toggleElement(this.getDOMElement(this._JsBindingExpirationDateLabel),
b);c.toggleElement(this.getDOMElement(this._JsBindingExpirationMonthDropdown),b);c.toggleElement(this.getDOMElement(this._JsBindingExpirationYearDropdown),b);var a,e;"add-debit-card"===this._action?(a=this.form.fields.expirationDate_VDC.monthParameterName,e=this.form.fields.expirationDate_VDC.yearParameterName):"add-credit-card"===this._action&&(a=this.form.fields.expirationDate.monthParameterName,e=this.form.fields.expirationDate.yearParameterName);b?(this.form.getAUITagHelperForParameter(a).val("01"),
this.form.getAUITagHelperForParameter(e).val((new Date).getUTCFullYear())):(this.form.getAUITagHelperForParameter(a).val("12"),this.form.getAUITagHelperForParameter(e).val((new Date).getUTCFullYear()+19))},toggleCVVRow:function(b){null!=d(".addCreditCardVerificationNumberRow")&&(c.toggleElement(d(".addCreditCardVerificationNumberRow"),b),this.form.getAUITagHelperForParameter(this.form.fields.addCreditCardVerificationNumber_VDC.fieldRequiredParameterName).val(b))},showPostalCodeRow:function(){null!=
d(".addCreditCardPostalCodeRow")&&c.showElement(d(".addCreditCardPostalCodeRow"))},hidePostalCodeRow:function(){null!=d(".addCreditCardPostalCodeRow")&&c.hideElement(d(".addCreditCardPostalCodeRow"))},updateMbccFields:function(b){var a=this.form.fields;this._isCvvForMbcc&&a.mobileNumber&&a.addCreditCardVerificationNumber&&(c.toggleElement(this.getDOMElement("addCreditCardMbccFields"),b),this.form.getAUITagHelperForParameter(a.mobileNumber.fieldRequiredParameterName).val(b),this.form.getAUITagHelperForParameter(a.addCreditCardVerificationNumber.fieldRequiredParameterName).val(b))},
toggleExpirationDates:function(b){var a=this;b=-1!==d.inArray(b,this._issuersHaveNoExpiration);d(".pmts-expiry-month").toggleClass("a-button-disabled",b);d("[name\x3d'ppw-expirationDate_month']").prop("disabled",b);d(".pmts-expiry-year").toggleClass("a-button-disabled",b);d("[name\x3d'ppw-expirationDate_year']").prop("disabled",b);d(".apx-expiry-combinedMonthYear").toggleClass("a-form-disabled",b);d("[name\x3d'ppw-expirationDate_combinedMonthYear']").prop("disabled",b);b&&(d('[name\x3d"addCreditCardNumber"]').trigger("click"),
g.forEach(a.form.formModel.constraints,function(b){"CreditCardExpirationConstraint"===b.validation&&a.form.formModel.constraints.splice(d.inArray(b,a.form.formModel.constraints),1)}))},toggleExpirationDatesWithNoExpiryInfo:function(b){b=-1!==d.inArray(b,this._issuersHaveNoExpiration);d("#add-credit-card-expiry-date-input-id").toggleClass("aok-hidden",b);d("#add-credit-card-no-expiry-date-info-id").toggleClass("aok-hidden",!b)},toggleTurnOffIMB:function(b){c.toggleElement(this.getDOMElement(this._addCreditCardTurnOffIMBJSBinding),
!b);c.toggleElement(this.getDOMElement(this._addPNCCardTurnOffIMBJSBinding),b)},getIssuer:function(){return this._issuer},getIsMbcc:function(){return this._isMbcc},getIsSBIMaestro:function(){if(this._selectedDebitCardIssuingBank)return this._selectedDebitCardIssuingBank===this._debitCardSBIMaestroValue},_bindAddCreditCardTrigger:function(){var b=this,e=b._isMCXRegistrationEnabled?"add-credit-card-mcx-action-name":this._declarativeActionName;a.when("A").execute(function(a){a.declarative(e,"click",
function(){J=(new Date).getTime();m.logCounterMetric({feature:"SecureRegistrationLinkClicked_"+b._deviceType,resource:"_Count"});b.widget.publishSuccessSushiMetrics({ActionType:"StartAddCreditCard",ActionValueType:"Click",ActionValue:"SecureAddCreditCardLinkClicked",ActionParentValueType:"PurchaseDocument",ActionParentValue:b._purchaseId});b.widget.trigger(l,{postData:{hideAddPaymentInstrumentHeader:!0,creatablePaymentMethods:b._creatablePaymentMethods,iFrameName:b._secureIframeName}})})})},_bindNonSecureAddCreditCardTrigger:function(){a.when("A").execute(function(b){b.declarative("a-modal",
"click",function(){m.logCounterMetric({feature:"NonSecureRegistrationLinkClicked",resource:"_Count"})})})},_addCreditCardFormSubmitMetric:function(){m.logCounterMetric({feature:this._isSecureRegistrationWidget?"CC_SecureRegistrationFormSubmitted":"CC_NonSecureRegistrationFormSubmitted",resource:"_Count"})},_toggleAddCardButtonDisabled:function(b){if(this._isMCXRegistrationEnabled){var a=this.getDOMElement(this._addButtonJSBinding);a.toggleClass("a-button-disabled",b);a.css("pointer-events",b?"none":
"auto")}},_updateRealtimeValidation:function(){if(this._isMCXRegistrationEnabled){this._toggleExpirationDateValidation(this._issuer);var b=this.form.validateForm(!0);this._toggleAddCardButtonDisabled(0<b.length)}},_toggleExpirationDateValidation:function(b){var a=this,e=a._issuersHaveNoExpiration.includes(b);g.forEach(a.form.formModel.constraints,function(b){a.form.isMCXValidationConstraint(b)&&"expirationDate"==b.field&&(b.metaData.disabled=e)})}})});l("components/AddCreditCardWorkflowComponent",
"css-utils jQuery component lang events/InstrumentRowSelectedEvent AUI!P mash-helper clog events/postToSecureIframeEvent mixins/secure-container-support".split(" "),function(c,d,f,h,g,a,m,k,e,b){return f.extend(b,{initialize:function(b,a){this._inPickAddressWorkflow=a.data.inPickAddressWorkflow;this.addCardIntermittentStepRemoved=a.data.addCardIntermittentStepRemoved;this._isSelectableTemplate=a.data.isSelectableTemplate;this._isSecureRegistrationWidget=a.data.isSecureRegistrationWidget;this._isRequestForMobileApp=
a.data.isRequestForMobileApp;this._listenerSecurePaymentMethodAddedEvent=a.data.listenerSecurePaymentMethodAddedEvent;this._dispatcherSecurePaymentMethodAddedEvent=a.data.dispatcherSecurePaymentMethodAddedEvent;this._isAddCreditCardWorkflowWidget=a.data.isAddCreditCardWorkflowWidget;this._secureIframeName=a.data.secureIframeName;this._isCCSyncVerificationEnabled=a.data.isCCSyncVerificationEnabled;this._dynamicContinueEnabled=a.data.dynamicContinueEnabled;this._shouldApplyRateLimitLogic=a.data.shouldAppendRateLimitAlertBox;
this._isDynamicRateLimitMessage=a.data.isDynamicRateLimitMessage;this._isNomenclatureWave2Enabled=a.data.isNomenclatureWave2Enabled;this._shouldProceedToSPC=a.data.shouldProceedToSPC;this._isSelectableTemplate&&!this._inPickAddressWorkflow&&(c.toggleElement(this.getDOMElement("selectableAddCreditCardWorkflowStateBody"),!1),c.toggleElement(this.getDOMElement("selectableAddDebitCardWorkflowStateBody"),!1),c.toggleElement(this.getDOMElement("selectableEmiAddCreditCardWorkflowStateBody"),!1));this.data.placementType!==
r?(this._isDebit="DebitCard"===this.data.placementType,this._isEmi="EmiCreditCard"===this.data.placementType):(this._isDebit=this.data.isDebit,this._isEmi=!1);this._creatablePaymentMethods=this._isDebit?"DC":"CC";var e=this;e._isRequestForMobileApp&&e._isAddCreditCardWorkflowWidget&&(m.addEventListener(e._listenerSecurePaymentMethodAddedEvent,function(b){e._addEventListenerAddCCWorkflowHandler(b)}),m.setBookmark("addccworkflow-widget"));e._isRequestForMobileApp&&(e._isCCSyncVerificationEnabled||this._shouldApplyRateLimitLogic)&&
m.addEventListener("BlockCardAdditionsEvent",function(b){var a;p.app&&p.app.willReappear&&(a=p.app.willReappear,delete p.app.willReappear);p.setTimeout(function(){p.app&&a&&(p.app.willReappear=a)},100);p.parent.postMessage(JSON.stringify({event:{name:"apx:add-payment-method:BlockCardAdditionsEvent",data:{iFrameName:e._secureIframeName,isCreditCardCVVVerificationFailed:b.detail.isCreditCardCVVVerificationFailed,rateLimitDurationInSeconds:b.detail.rateLimitDurationInSeconds,andString:b.detail.rateLimitAndString,
hoursString:b.detail.rateLimitHoursString,hourString:b.detail.rateLimitHourString,minuteString:b.detail.rateLimitMinuteString,minutesString:b.detail.rateLimitMinutesString,isDynamicRateLimitMessage:b.detail.isDynamicRateLimitMessage}}}),"*")})},_addEventListenerAddCCWorkflowHandler:function(b){this._dynamicContinueEnabled?this.addPaymentMethodRefreshContinue(b.detail.paymentInstrumentId,b.detail.widgetAction,b.detail.walletId):this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,
"ppw-widgetEvent":"AddPaymentMethodRefreshEvent","ppw-paymentMethodId":b.detail.paymentInstrumentId,"ppw-widgetAction":b.detail.widgetAction,"ppw-maybeWalletId":b.detail.walletId});m.backToBookmark("addccworkflow-widget")},bindToElements:function(){var b=this;b.getDOMElement("useECardLink").bind("click",function(a){b.widget.trigger("useECardEvent");c.showElement(d(b.getDOMElement("eCardHelp")));return!1})},bindToEvents:function(){this._isAddCreditCardWorkflowWidget&&this.widget.trigger(e,{postData:{hideAddPaymentInstrumentHeader:!0,
creatablePaymentMethods:this._creatablePaymentMethods,iFrameName:this._secureIframeName}});this.widget.on("componentsInitialized",this,function(){this._isSelectableTemplate&&this._inPickAddressWorkflow&&(this._isDebit?this._triggerSelectableAddDebitCardSelected():this._isEmi?this.widget.trigger("selectableAddEmiCardSelectedOnInitialize"):this.widget.trigger(g,{instrumentId:"SelectableAddCreditCard"}))});this.widget.on("selectableAddCreditCardSelected",this,function(){this.addCardIntermittentStepRemoved||
c.toggleElement(this.getDOMElement("selectableAddCreditCardWorkflowStateBody"),!0)});this.widget.on("selectableAddCreditCardDeselected",this,function(){c.toggleElement(this.getDOMElement("selectableAddCreditCardWorkflowStateBody"),!1)});this.widget.on("selectableAddDebitCardSelected",this,function(){this.addCardIntermittentStepRemoved||c.toggleElement(this.getDOMElement("selectableAddDebitCardWorkflowStateBody"),!0)});this.widget.on("selectableAddDebitCardDeselected",this,function(){c.toggleElement(this.getDOMElement("selectableAddDebitCardWorkflowStateBody"),
!1)});this.widget.on("selectableEmiAddCreditCardSelected",this,function(){this.addCardIntermittentStepRemoved||c.toggleElement(this.getDOMElement("selectableEmiAddCreditCardWorkflowStateBody"),!0)});this.widget.on("selectableEmiAddCreditCardDeselected",this,function(){c.toggleElement(this.getDOMElement("selectableEmiAddCreditCardWorkflowStateBody"),!1)});this.widget.on("selectableAddCreditCardSelected",this,function(){this._isNomenclatureWave2Enabled&&a.when("A","ready").execute(function(b){b=b.$;
b(".pmts-add-card-secondary-content-slot").toggleClass("pmts-add-card-secondary-content-slot-hidden",!1);this.addCardIntermittentStepRemoved||b(".pmts-add-card-secondary-content-slot").toggleClass("pmts-add-card-secondary-content-slot-shrunk",!1)})});this.widget.on("selectableAddCreditCardDeselected",this,function(){this._isNomenclatureWave2Enabled&&a.when("A","ready").execute(function(b){b=b.$;b(".pmts-add-card-secondary-content-slot").toggleClass("pmts-add-card-secondary-content-slot-hidden",!1);
this.addCardIntermittentStepRemoved||(b(".pmts-add-card-secondary-content-slot").toggleClass("pmts-add-card-secondary-content-slot-hidden",!0),b(".pmts-add-card-secondary-content-slot").toggleClass("pmts-add-card-secondary-content-slot-shrunk",!0))})});var b=this;this.widget.on("WidgetAction",this,function(a){"add-payment-instrument"===a.widgetActionType&&"add-credit-card-workflow-complete"===a.widgetAction&&b._isSecureRegistrationWidget&&b._isRequestForMobileApp&&(a.interstitialPageUrl?(console.log("Dispatching Update Everywhere event: interstitial URL [",
a.interstitialPageUrl,"]"),m.dispatchEvent("LaunchUpdateEverywhereEvent",{interstitialPageUrl:a.interstitialPageUrl})):this._shouldProceedToSPC?m.dispatchEvent(b._dispatcherSecurePaymentMethodAddedEvent,{paymentInstrumentId:a.paymentInstrumentId,widgetAction:a.widgetAction,walletId:a.walletId,instrumentRegistrationType:a.instrumentRegistrationType,paymentMethod:a.paymentMethod,canProceedToSPC:a.canProceedToSPC}):m.dispatchEvent(b._dispatcherSecurePaymentMethodAddedEvent,{paymentInstrumentId:a.paymentInstrumentId,
widgetAction:a.widgetAction,walletId:a.walletId}))})},_triggerSelectableAddDebitCardSelected:function(){this.widget.trigger("selectableAddDebitCardSelectedOnInitialize",{inPickAddressWorkflow:this._inPickAddressWorkflow})}})});l("components/AddDebitCardWorkflowComponent",["component"],function(c){return c.extend({})});l("events/CreditCardIssuerDeterminedEvent",["public-event-registry"],function(c){c.register("creditCardIssuerDetermined");return"creditCardIssuerDetermined"});l("events/CreditCardNumberResetEvent",
["public-event-registry"],function(c){c.register("creditCardNumberReset");return"creditCardNumberReset"});l("components/AddCardAuthComponent","events/form-submitted-event jQuery css-utils form-component mini-browser-helper lang clog AUI!P mash-helper modal-popover".split(" "),function(c,d,f,h,g,a,m,k,e,b){var n={width:600,height:650},q={event:{name:"apx:page:reload"}},y={event:{name:"apx:iframe:close"}};return h.extend({initialize:function(a,k){this._interstitialPageUrl=k.data.originUri+k.data.interstitialPageUrl;
this._isMiniBrowserEnabled=k.data.isMiniBrowserEnabled;this._instrumentId=k.data.instrumentId;this._widgetAction=k.data.widgetAction;this._isRequestForMobileApp=k.data.isRequestForMobileApp;this._iframeName=k.data.iframeName;this._clientReferenceId=k.data.clientReferenceId;this._walletId=k.data.walletId;this._walletVerificationEnabled=k.data.walletVerificationEnabled;this._executionStatus=k.data.executionStatus;this._retries=0;k.data.shouldRenderInPopover&&(this.popover=new b(a,k,this));"add-credit-card-workflow-complete"===
this._widgetAction?this._isRequestForMobileApp?this._sendCompleteContinueEvent():this._isMiniBrowserEnabled||(a={widgetAction:this._widgetAction,paymentMethodId:this._instrumentId,iFrameName:this._iframeName,walletId:this._walletId},console.log("Reload parent and close the data: "+a.iFrameName),k=d.extend({},q),k.event.data=a,p.parent.postMessage(JSON.stringify(k),"*"),k=d.extend({},y),k.event.data=a,p.parent.postMessage(JSON.stringify(k),"*")):"add-card-auth-start"===this._widgetAction?this._isMiniBrowserEnabled?
this._showPopoverModal():this._isRequestForMobileApp?e.setUrlInCurrentWebview(this._interstitialPageUrl):p.location.href=this._interstitialPageUrl:"add-card-auth-polling"===this._widgetAction&&("SUCCESS"===this._executionStatus?this._swapToSuccessSection():"FAILURE"===this._executionStatus?this._swapToFailureSection():(this._walletVerificationEnabled&&this._swapToSpinnerSection(),this._pollAuthenticationSourceForNextAction()))},bindToEvents:function(){this.widget.on("add-card-auth-popover-closed",
this,function(b){this.getDOMElement("pmts-add-card-auth-popover-cancel-form").submit()})},bindToElements:function(){var b=this;k.when("A","a-modal","ready").execute(function(a,e){b.getDOMElement("apx-add-card-auth-modal-go-button").click(function(){b._walletVerificationEnabled&&b._swapToSpinnerSection();b._openAddCardAuthMiniBrowserWindow(b._interstitialPageUrl)})});k.when("A","a-modal","ready").execute(function(a,e){b.getDOMElement("apx-add-card-post-auth-skip-button").click(function(){b._setAndCheckIsElementDisabled("apx-add-card-post-auth-skip-button")||
(b._hidePopoverModal(),b.widget.submitFormAJAX({"ppw-widgetState":b.widget.options.serializedState,"ppw-widgetEvent":"AddCardAuthCancelEvent","ppw-reason":"ManualClose","ppw-paymentMethodId":b._instrumentId,"ppw-widgetAction":b._widgetAction}))})});k.when("A","a-modal","ready").execute(function(a,e){b.getDOMElement("apx-add-card-post-auth-continue-button").click(function(){b._setAndCheckIsElementDisabled("apx-add-card-post-auth-continue-button")||(b._hidePopoverModal(),b.widget.submitFormAJAX({"ppw-widgetState":b.widget.options.serializedState,
"ppw-widgetEvent":"AddCardAuthCompleteEvent","ppw-paymentMethodId":b._instrumentId,"ppw-widgetAction":b._widgetAction}))})});k.when("A","a-modal").execute(function(b){b.on("a:popover:dismiss:apx-add-card-auth-modal",function(b){m.logCounterMetric({feature:"AddCardAuth.cardAuthenticationCancelled",resource:"_Count"});m.publishMetrics()})});b.getDOMElement("apx-add-card-auth-mobile-link").click(a.bind(this._handleAddCardAuthFormSubmission,this))},_showPopoverModal:function(){this.getDOMElement("apx-add-card-auth-modal-trigger").trigger("click")},
_setAndCheckIsElementDisabled:function(b){if(this.getDOMElement(b).attr("class")&&this.getDOMElement(b).attr("class").split(" ").includes("a-button-disabled"))return!0;this.getDOMElement(b).addClass("a-button-disabled");return!1},_hidePopoverModal:function(){k.when("a-modal").execute(function(b){b&&(b=b.get("apx-add-card-auth-modal"))&&b.hide()})},_swapToSuccessSection:function(){this._walletVerificationEnabled&&this._hideSpinnerSection();var b=this.getDOMElement("apx-add-card-auth-modal-content"),
a=this.getDOMElement("apx-add-card-post-auth-success-content");b&&f.hideElement(b);a&&f.showElement(a)},_swapToFailureSection:function(){this._walletVerificationEnabled&&this._hideSpinnerSection();var b=this.getDOMElement("apx-add-card-auth-modal-content"),a=this.getDOMElement("apx-add-card-post-auth-failure-content");b&&f.hideElement(b);a&&f.showElement(a)},_swapToSpinnerSection:function(){var b=this.getDOMElement("apx-add-card-auth-modal-content"),a=this.getDOMElement("AddCardAuthSpinner");b&&f.hideElement(b);
a&&f.showElement(a)},_hideSpinnerSection:function(){var b=this.getDOMElement("AddCardAuthSpinner");b&&f.hideElement(b)},_openAddCardAuthMiniBrowserWindow:function(b){this._add_card_auth_browser_window=g.openInMiniBrowser(b,"apx-add-card-auth-mini-window",n);this._add_card_auth_browser_window.focus();this._monitorAddCardAuthMinibrowserWindow()},_handleAddCardAuthFormSubmission:function(b){b=this.getDOMElement("apx-add-card-auth-form");var a=p.location.pathname+p.location.search;this.getDOMElement("apx-add-card-auth-client-page-url").val(a);
b.submit()},_monitorAddCardAuthMinibrowserWindow:function(){p.clearTimeout(this._add_card_auth_window_timer);!this._add_card_auth_browser_window||this._add_card_auth_browser_window.closed?this._pollAuthenticationSourceForNextAction():this._add_card_auth_window_timer=setTimeout(this._monitorAddCardAuthMinibrowserWindow.bind(this),100)},_sendCompleteContinueEvent:function(){this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"AddCardAuthCompleteEvent",
"ppw-paymentMethodId":this._instrumentId,"ppw-widgetAction":this._widgetAction})},_pollAuthenticationSourceForNextAction:function(){var b=this;b.widget.continueRequest({"ppw-widgetEvent":"AddCardAuthPollEvent","ppw-widgetState":b.widget.options.serializedState,"ppw-clientReferenceId":b._clientReferenceId},{success:function(e){e=e.additionalWidgetResponseData.additionalData;b._retries++;e&&"PENDING"===e.status&&5>b._retries?p.setTimeout(a.bind(b._pollAuthenticationSourceForNextAction(),b),200):e&&
"APPROVED"===e.status?b._swapToSuccessSection():b._swapToFailureSection()},error:function(a){b._hidePopoverModal();b._sendCompleteContinueEvent()}})}})});l("events/close-add-credit-card-form-event",["public-event-registry"],function(c){c.register("CloseAddCreditCardFormEvent");return"CloseAddCreditCardFormEvent"});l("components/AddMessageBasedDebitCardComponent",["jQuery","css-utils","component","AUI!P"],function(c,d,f,h){return f.extend({redirectUrl:null,additionalPostData:null,isAmazonApp:!1,initialize:function(c,
a){this.redirectUrl=a.data.redirectUrl;this.additionalPostData=a.data.additionalPostData;this.isAmazonApp=a.data.isAmazonApp},handleAddMBDCEvent:function(){var c=this;c.isAmazonApp?h.when("mash").execute(function(a){a.showEmbeddedBrowser({targetURL:c.redirectUrl,method:"POST",postParameters:c.additionalPostData,successCallback:function(){}})}):c.getDOMElement("addDebitCardRedirectionForm")[0].submit()},closeMBDCPopover:function(){function c(a){a&&(a=a.get("pmtsAddMessageBasedDebitCardPopover"))&&
a.hide()}h.when("a-modal").execute(function(a){c(a)});h.when("a-secondary-view").execute(function(a){c(a)})},bindToElements:function(){var c=this;this.widget.onAui("a:declarative:apx-display-add-mbdc-message:click",function(){d.hideElement(c.getDOMElement("addDebitCardRedirectionForm"));d.showElement(c.getDOMElement("addMbdcMessage"))});c.getDOMElement("addMessageBasedDebitCardButton").bind("click",function(a){c.handleAddMBDCEvent()});c.getDOMElement("addMBDCConfirmButton").bind("click",function(a){c.closeMBDCPopover()})}})});
l("components/AddElectronicBenefitTransferComponent","events/form-submitted-event jQuery form-component lang AUI!P clog events/close-secure-container-event events/display-secure-container-event events/postToSecureIframeEvent events/secureIframeLoadedEvent".split(" "),function(c,d,f,h,g,a,m,k,e,b){var n=null;return f.extend({_creatablePaymentMethods:[],_isSecureRegistrationEnabledForEBT:!1,initialize:function(b,a){this._isDesktop="desktop"===b.options.deviceType;this._action=a.data.action;this._hasErrors=
a.data.hasErrors;this.$accountHolderNameInput=this.getDOMElement("accountHolderName");this.$useNameOnAccountCheckbox=this.getDOMElement("getNameOnAccount");this.$addEbtSubmitButton=this.getDOMElement("new-EBT-submit-button");this.$addEbtPopoverTrigger=this.getDOMElement("EbtPopoverLink");this._creatablePaymentMethods=a.data.creatablePaymentMethods;this._isSecureRegistrationEnabledForEBT=a.data.isSecureRegistrationEnabledForEBT},bindToElements:function(){this.getDOMElement("new-EBT-cancel-button").click(h.bind(this.closeAddEbtPopover,
this));this.$addEbtSubmitButton.click(h.bind(this._handleFormSubmission,this));var b=this;this.$useNameOnAccountCheckbox.bind("change",function(a){a=this.checked?b.$useNameOnAccountCheckbox.val():"";b.$accountHolderNameInput.val(a)});this.$accountHolderNameInput.bind("change",function(a){b.widget.trigger("accountHolderNameChange",{accountHolderName:b.$accountHolderNameInput.val()})});this._isSecureRegistrationEnabledForEBT?this._bindAddEBTTrigger():this._bindNonSecureAddEBTTrigger()},bindToEvents:function(){this.widget.on("componentsInitialized",
this,function(){"true"===this._hasErrors&&(this.$addEbtPopoverTrigger.trigger("click"),this.widget.trigger(k))});this.widget.on(c,this,function(b){if(b.action===this._action){b=this.getDOMElement("pmts-add-ebt-form");var a=this._getRegistrationCount(),a=d("\x3cinput\x3e").attr({type:"hidden",name:"ppw-ebtRegistrationCount",value:a.toString()});b.append(a);a=d("\x3cinput\x3e").attr({type:"hidden",name:"ppw-widgetEvent:AddElectronicBenefitTransferEvent",value:"submit"});b.append(a);b.submit();this._addEBTFormSubmitMetric()}});
this.widget.on("accountHolderNameChange",this,function(b){b=b.accountHolderName.trim()===this.$useNameOnAccountCheckbox.val();this.$useNameOnAccountCheckbox.prop("checked",b)});this.widget.on(b,this,function(b){n&&b.data&&"EBT"===b.data.paymentMethod&&(a.logCounterMetric({feature:"SecureRegistrationLoadSuccess_"+self._deviceType,resource:"_Count"}),a.logLatencyMetric({feature:"SecureRegistrationLoadTime",resource:"_Latency",startTime:n}),n=null);a.publishMetrics()})},_getRegistrationCount:function(){var b;
try{var a=p.sessionStorage.getItem("ebtCount")||"0";b=parseInt(a,10)+1;p.sessionStorage.setItem("ebtCount",b.toString())}catch(e){b=0}return b},_handleFormSubmission:function(b){if(0===this.form.validateForm().length){var a=this.getFormSubmissionParameters("pmts-add-ebt-form-container");this.closeAddEbtPopover();this.widget.trigger(c,{submissionParameters:a,event:b,action:this._action})}else b.preventDefault()},closeAddEbtPopover:function(){this._isSecureRegistrationEnabledForEBT?this.widget.trigger(m):
g.when("a-modal").execute(function(b){b&&(b=b.get("pmtsAddEbtPopover"))&&b.hide()})},_bindAddEBTTrigger:function(){var b=this;b._isDesktop&&g.when("A").execute(function(k){k.declarative("add-ebt-action-name","click",function(){n=(new Date).getTime();a.logCounterMetric({feature:"SecureRegistrationLinkClicked_"+b._deviceType,resource:"_Count"});b.widget.trigger(e,{postData:{hideAddPaymentInstrumentHeader:!0,creatablePaymentMethods:b._creatablePaymentMethods}})})})},_bindNonSecureAddEBTTrigger:function(){g.when("A").execute(function(b){b.declarative("a-modal",
"click",function(){a.logCounterMetric({feature:"NonSecureRegistrationLinkClicked",resource:"_Count"})})})},_addEBTFormSubmitMetric:function(){a.logCounterMetric({feature:this._isSecureRegistrationEnabledForEBT?"EBT_SecureRegistrationFormSubmitted":"EBT_NonSecureRegistrationFormSubmitted",resource:"_Count"})}})});l("components/AddElectronicBenefitTransferWorkflowComponent",["component"],function(c){return c});l("components/AddHBAComponent","events/form-submitted-event form-component lang AUI!P jQuery cc-spacing clog events/close-secure-container-event events/display-secure-container-event events/postToSecureIframeEvent events/secureIframeLoadedEvent".split(" "),
function(c,d,f,h,g,a,m,k,e,b,n){var q=null;return d.extend({_creatablePaymentMethods:[],_isSecureRegistrationEnabledForHBA:!1,initialize:function(b,a){this._isDesktop="desktop"===b.options.deviceType;this.$accountHolderNameInput=this.getDOMElement("apx-js-bind-account-holder-name-input-healthbenefitscard");this.$useNameOnAccountCheckbox=this.getDOMElement("getNameOnAccount_HBA");this.$addHbaPopoverTrigger=this.getDOMElement("PopoverLinkhealthbenefitscard");this.$addCardNumberBinding=this.getDOMElement("addCreditCardNumber");
this._creatablePaymentMethods=a.data.creatablePaymentMethods;this._isSecureRegistrationEnabledForHBA=a.data.isSecureRegistrationEnabledForHBA},bindToElements:function(){var b=this;this.getDOMElement("apx-js-bind-cancel-add-card-button-healthbenefitscard").click(f.bind(this.closeAddHbaPopover,this));this.getDOMElement("apx-js-bind-add-card-button-healthbenefitscard").click(f.bind(this._handleFormSubmission,this));this.$useNameOnAccountCheckbox.bind("change",function(a){a=this.checked?b.$useNameOnAccountCheckbox.val():
"";b.$accountHolderNameInput.val(a)});this.$accountHolderNameInput.bind("change",function(a){b.$accountHolderNameInput.val().trim()!==b.$useNameOnAccountCheckbox.val()?b.$useNameOnAccountCheckbox.prop("checked",!1):b.$useNameOnAccountCheckbox.prop("checked",!0)});this._isSecureRegistrationEnabledForHBA?this._bindAddHBATrigger():this._bindNonSecureAddHBATrigger()},bindToEvents:function(){this.widget.on("componentsInitialized",this,function(){"true"===this.data.hasErrors&&(this.$addHbaPopoverTrigger.trigger("click"),
this.widget.trigger(e))});this.widget.on(c,this,function(b){if(b.action===this.data.action){b=this.getDOMElement("apx-js-bind-add-card-form-healthbenefitscard");var a=g("\x3cinput\x3e").attr({type:"hidden",name:"ppw-widgetEvent:AddHBAEvent",value:"submit"});b.append(a);b.submit();this._addHBAFormSubmitMetric()}});var b,k;this.$addCardNumberBinding.keydown(function(a){b=this.value;k=this.selectionStart});this.$addCardNumberBinding.change(function(b){this.value=a.fixSpacing(this.value)});this.$addCardNumberBinding.keyup(function(e){"number"!==
this.type&&this.value!==b&&(e=this.selectionStart,this.value=a.fixSpacing(this.value),e=a.fixCaret(e,this.value,b,k),this.setSelectionRange(e,e))});this.widget.on(n,this,function(b){q&&b.data&&"HBA"===b.data.paymentMethod&&(m.logCounterMetric({feature:"SecureRegistrationLoadSuccess_"+self._deviceType,resource:"_Count"}),m.logLatencyMetric({feature:"SecureRegistrationLoadTime",resource:"_Latency",startTime:q}),q=null);m.publishMetrics()})},_handleFormSubmission:function(b){if(0===this.form.validateForm().length){var a=
this.getFormSubmissionParameters("apx-js-bind-add-card-container-healthbenefitscard");this.closeAddHbaPopover();this.widget.trigger(c,{queryParameters:this.data.queryParams,submissionParameters:a,event:b,action:this.data.action})}else b.preventDefault()},closeAddHbaPopover:function(){this._isSecureRegistrationEnabledForHBA?this.widget.trigger(k):h.when("a-modal").execute(function(b){b&&(b=b.get("apx-add-card-popover-healthbenefitscard"))&&b.hide()})},_bindAddHBATrigger:function(){var a=this;a._isDesktop&&
h.when("A").execute(function(e){e.declarative("add-hba-action-name","click",function(){q=(new Date).getTime();m.logCounterMetric({feature:"SecureRegistrationLinkClicked_"+a._deviceType,resource:"_Count"});a.widget.trigger(b,{postData:{hideAddPaymentInstrumentHeader:!0,creatablePaymentMethods:a._creatablePaymentMethods}})})})},_bindNonSecureAddHBATrigger:function(){h.when("A").execute(function(b){b.declarative("a-modal","click",function(){m.logCounterMetric({feature:"NonSecureRegistrationLinkClicked",
resource:"_Count"})})})},_addHBAFormSubmitMetric:function(){m.logCounterMetric({feature:this._isSecureRegistrationEnabledForHBA?"HBA_SecureRegistrationFormSubmitted":"HBA_NonSecureRegistrationFormSubmitted",resource:"_Count"})}})});l("components/AddHBAWorkflowComponent",["component"],function(c){return c});l("components/AddIDealComponent","events/form-submitted-event jQuery form-component lang AUI!P events/ExpandIdealEvent clog".split(" "),function(c,d,f,h,g,a,m){return f.extend({_hasErrors:!1,initialize:function(a,
e){this._action=e.data.action;this._hasErrors=e.data.hasErrors},_initPopoverState:function(){"true"===this._hasErrors&&this.getDOMElement("iDealPopoverLink").trigger("click")},bindToElements:function(){this.getDOMElement("addIDealSubmitButton").click(h.bind(this._handleFormSubmission,this))},bindToEvents:function(){var k=this;k.widget.on("componentsInitialized",k,function(a){this._initPopoverState()});k.widget.on(a,k,function(a){a=d(k.getDOMElement("addIdealComponent"));a.length&&a.click();k._publishCounterMetricsForIdeal("ExpandIdealRegistrationSleeve");
k._publishBIMetricForIdeal("ExpandIdealRegistrationSleeve","Status","Success")});k.widget.on(c,k,function(a){a.action===k._action&&d(k.getDOMElement("addIDealForm")).submit()})},_handleFormSubmission:function(a){var e=this.form.validateForm(),b=this.getFormSubmissionParameters("addIDealFormContainer");0===e.length?(this.widget.trigger(c,{event:a,submissionParameters:b,action:this._action}),this.closeAddIDealPopover(),this._publishCounterMetricsForIdeal("AddIdealBankAdded"),this._publishBIMetricForIdeal("AddIdealBankAdded",
"Status","Success")):a.preventDefault()},closeAddIDealPopover:function(){g.when("a-modal").execute(function(a){a&&(a=a.get("pmtsAddIDealPopover"))&&a.hide()})},_publishCounterMetricsForIdeal:function(a){m.logCounterMetric({feature:a,resource:"_Count"});m.publishMetrics()},_publishBIMetricForIdeal:function(a,e,b){this.widget.publishSuccessSushiMetrics({ActionType:a,ActionValueType:e,ActionValue:b})}})});l("events/ExpandIdealEvent",["public-event-registry"],function(c){c.register("ExpandIdealEvent");
return"ExpandIdealEvent"});l("components/AdditionalLinkComponent",["component"],function(c){return c});l("components/AddP24Component",["events/form-submitted-event","jQuery","form-component","lang","AUI!P"],function(c,d,f,h,g){return f.extend({_hasErrors:!1,initialize:function(a,c){this._action=c.data.action;this._hasErrors=c.data.hasErrors},_initPopoverState:function(){"true"===this._hasErrors&&this.getDOMElement("addP24PopoverLink").trigger("click")},bindToElements:function(){this.getDOMElement("addP24SubmitButton").click(h.bind(this._handleFormSubmission,
this))},bindToEvents:function(){var a=this;a.widget.on("componentsInitialized",a,function(a){this._initPopoverState()});a.widget.on(c,a,function(c){c.action===a._action&&d(a.getDOMElement("addP24Form")).submit()})},_handleFormSubmission:function(a){var g=this.form.validateForm(),k=this.getFormSubmissionParameters("addP24FormContainer");0===g.length?(this.widget.trigger(c,{event:a,submissionParameters:k,action:this._action}),this.closeAddP24Popover()):a.preventDefault()},closeAddP24Popover:function(){g.when("a-modal").execute(function(a){a&&
(a=a.get("addP24Popover"))&&a.hide()})}})});l("components/AddPayerComponent","events/form-submitted-event form-component lang jQuery css-utils clog aui-helper".split(" "),function(c,d,f,h,g,a,m){return d.extend({formatDayAndMonth:function(a){return a&&1===a.length?"0"+a:a},populateBirthDate:function(){var a=this.formatDayAndMonth(h("[name\x3d'ppw-birthDateDay']").val()),e=this.formatDayAndMonth(h("[name\x3d'ppw-birthDateMonth']").val()),b=h("[name\x3d'ppw-birthDateYear']").val();a&&e&&b&&(a=b+"-"+
e+"-"+a,h("[name\x3d'ppw-birthDate']").val(a))},initialize:function(a,e){this._action=e.data.action;this._refundToAlternatePaymentMethodConsentRequired=e.data.refundToAlternatePaymentMethodConsentRequired},bindToElements:function(){var a=this;h("[name\x3d'ppw-birthDateDay']").change(function(){a.populateBirthDate()});h("[name\x3d'ppw-birthDateMonth']").change(function(){a.populateBirthDate()});h("[name\x3d'ppw-birthDateYear']").change(function(){a.populateBirthDate()});h(".pmts-add-amazon-paycode-header").click(f.bind(this.publishClickMetrics,
this));this._refundToAlternatePaymentMethodConsentRequired&&(this._disablePayerSubmitButton(),h("#pmts-refund-consent-checkbox").click(f.bind(this.togglePayerSubmitButton,this)));this.getDOMElement("pmts-payer-continue-button").click(f.bind(this._handleFormSubmission,this))},bindToEvents:function(){var a=this;this.widget.on(c,a,function(e){e.action===a._action&&a.getDOMElement("pmts-payer-form").submit()})},togglePayerSubmitButton:function(){h("#pmts-refund-consent-checkbox").is(":checked")?this._enablePayerSubmitButton():
this._disablePayerSubmitButton()},_disablePayerSubmitButton:function(){this.getDOMElement("pmts-payer-continue-button").attr("disabled","disabled");this.getDOMElement("pmts-payer-continue-button").addClass("a-button-disabled")},_enablePayerSubmitButton:function(){this.getDOMElement("pmts-payer-continue-button").removeAttr("disabled");this.getDOMElement("pmts-payer-continue-button").removeClass("a-button-disabled")},publishClickMetrics:function(c){c=h(c.currentTarget);c=m.getExpanderHelper(c);c.getContainer();
c.isExpanded()||(a.logCounterMetric({feature:"AddPayerFormExpandedEvent",resource:"_Count"}),a.publishMetrics(),this.widget.publishSuccessSushiMetrics({ActionType:"AddPayerFormExpandedEvent",ActionValueType:"AddPayerActionType",ActionValue:this._action}))},_handleFormSubmission:function(a){var e=this.form.validateForm();if(this._refundToAlternatePaymentMethodConsentRequired&&this.getDOMElement("pmts-payer-continue-button").hasClass("a-button-disabled"))a.preventDefault();else if(0===e.length){for(var e=
this.getFormSubmissionParameters("pmts-payer-form-container"),b=0;b<e.length;b++)"ppw-widgetEvent:ChangeAddressContEvent"===e[b].name&&(e[b].name="ppw-widgetEvent:PayerContButtonEvent");this.widget.trigger(c,{queryParameters:this.data.queryParams,submissionParameters:e,event:a,action:this._action})}else a.preventDefault()}})});l("components/AddPayerWorkflowComponent",["jQuery","component","aui-helper","AUI!P","clog"],function(c,d,f,h,g){return d.extend({initialize:function(){this.$addAmazonPayCodeButtonSelector=
"#addAmazonPayCodePopoverId .pmts-button-input"},bindToEvents:function(){var a=this;c(this.$addAmazonPayCodeButtonSelector).click(function(c){a.publishAddPaycodeWithoutPayerMetrics(c);a.continueAddAmazonPayCodePopover()})},continueAddAmazonPayCodePopover:function(){h.when("a-modal").execute(function(a){a&&(a=a.get("addAmazonPayCodePopover"))&&a.hide()})},publishAddPaycodeWithoutPayerMetrics:function(a){g.logCounterMetric({feature:"AddAmazonPayCodeWithoutPayerEvent",resource:"_Count"});g.publishMetrics();
this.widget.publishSuccessSushiMetrics({ActionType:"AddAmazonPayCodeWithoutPayerEvent",ActionValueType:"AddAmazonPayCodeWithoutPayerType",ActionValue:this._action})}})});l("components/AddPaymentInstrumentComponent","css-utils component mash-helper storage-helper mixins/secure-container-support events/postToSecureIframeEvent events/AddPaymentInstrumentLinkSelectedEvent events/ShowAddPaymentInstrumentPage TransitionMetricsConstants clog events/ExpandIdealEvent AUI!P".split(" "),function(c,d,f,h,g,a,
m,k,e,b,n,q){return d.extend(g,{_showSecondaryView:!1,_deviceType:"desktop",_creatablePaymentMethods:[],_isSkipAddCreditCardWeblabEnabled:!1,_includeAPX3Register:"none",_apx3RegisterSsnapUrl:"",_apx3RegisterHowToOpenSsnapUrl:"",initialize:function(b,a){this._showSecondaryView=a.data.showSecondaryView;this._deviceType=a.data.deviceType;this._mobileNonSecondaryView="mobile"===this._deviceType&&"false"===this._showSecondaryView;this._isRequestForMobileApp=a.data.isRequestForMobileApp;this._securePaymentMethodAddedEvent=
a.data.securePaymentMethodAddedEvent;this._isStandaloneAddPIWidget=a.data.isStandaloneAddPIWidget;this._dynamicContinueEnabled=a.data.dynamicContinueEnabled;this._shouldDisableAutoScreenShot=a.data.shouldDisableAutoScreenShot;this._creatablePaymentMethods=a.data.creatablePaymentMethods;this._isSkipAddCreditCardWeblabEnabled=a.data.isSkipAddCreditCardWeblabEnabled;this._secureIframeName=a.data.secureIframeName;this._includeAPX3Register=a.data.includeAPX3Register||"none";this._apx3RegisterSsnapUrl=
a.data.apx3RegisterSsnapUrl;this._apx3RegisterHowToOpenSsnapUrl=a.data.apx3RegisterHowToOpenSsnapUrl;this._apx3SecureAddPaymentInstrumentWeblabName=a.data.apx3SecureAddPaymentInstrumentWeblabName;this._apx3SecureAddPaymentInstrumentWeblabTreatment=a.data.apx3SecureAddPaymentInstrumentWeblabTreatment;var e=this;if(e._shouldDisableAutoScreenShot)try{f.disableAutoScreenShot()}catch(c){e.widget.publishFailureSushiMetrics({ActionType:"AddPaymentInstrument",ActionValueType:"DisableAutoScreenShot",ActionValue:"ErrorThrown"})}e._isRequestForMobileApp&&
e._isStandaloneAddPIWidget&&(f.addEventListener(e._securePaymentMethodAddedEvent,function(b){e._addEventListenerAddPIHandler(b)}),f.setBookmark("addpi-widget"))},_addEventListenerAddPIHandler:function(b){this._dynamicContinueEnabled?this.addPaymentMethodRefreshContinue(b.detail.paymentInstrumentId,b.detail.widgetAction,b.detail.walletId):this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"AddPaymentMethodRefreshEvent","ppw-paymentMethodId":b.detail.paymentInstrumentId,
"ppw-widgetAction":b.detail.widgetAction,"ppw-maybeWalletId":b.detail.walletId});f.backToBookmark("addpi-widget")},bindToElements:function(){var a=this;a.getDOMElement("add-new-payment-method").click(function(c){var g=Date.now(),n=a._apx3RegisterSsnapUrl;if(n){var n=new URL(n),m=n.searchParams.get("endpoint");n.searchParams.delete("endpoint");n.searchParams.append("startTimestamp",g);n.searchParams.append("startTimestampSource","AddNewPaymentMethodLink");n=n.href+"\x26endpoint\x3d"+m}h.putInSession(e.ADD_PM_LINK_CLICK_STORAGE_KEY+
a.widget.widgetInstanceId,{startTimestamp:g,startTimestampSource:"AddNewPaymentMethodLink"});f.publishCountMetrics("AddPaymentLinkClicked");if(a._apx3SecureAddPaymentInstrumentWeblabName&&a._apx3SecureAddPaymentInstrumentWeblabTreatment)try{p.ue&&p.ue.trigger?(p.ue.trigger(a._apx3SecureAddPaymentInstrumentWeblabName,a._apx3SecureAddPaymentInstrumentWeblabTreatment),b.logCounterMetric({feature:"ClientSideAPX3RegisterWeblabTrigger",resource:"_SuccessCount"})):b.logCounterMetric({feature:"ClientSideAPX3RegisterWeblabTrigger_MissingCSMIntegration",
resource:"_ErrorCount"}),b.publishMetrics()}catch(d){b.logCounterMetric({feature:"ClientSideAPX3RegisterWeblabTrigger",resource:"_ErrorCount"}),b.publishMetrics()}else f.publishCountMetrics("ClientSideAPX3RegisterWeblabTriggerNotEnabled");if("all"===a._includeAPX3Register){c.preventDefault();f.publishCountMetrics("NavigateToIrisRegistrationApp");try{"MashNavigate"===a._apx3RegisterHowToOpenSsnapUrl?f.navigateToUrl(n):"AssignHrefThenHidePageSpinner"===a._apx3RegisterHowToOpenSsnapUrl?(p.location.href=
n,q.when("page-spinner-controller").execute(function(b){b.hide()})):p.location.href=n}catch(d){f.publishCountMetrics("NavigateToIrisRegistrationFailed"),a.widget.trigger(k)}}else""!==a._apx3RegisterSsnapUrl&&f.publishCountMetrics("AddPaymentLinkClickedAfterAPX3NativeDisabled"),a.widget.trigger(k,{isForAPX3Register:"web"===a._includeAPX3Register||"all"===a._includeAPX3Register,startTimestamp:g,startTimestampSource:"AddNewPaymentMethodLink"}),a._mobileNonSecondaryView&&c.preventDefault()});"true"===
this._showSecondaryView&&this.registerSecondaryView("add-new-payment-method-declarative-action")},bindToEvents:function(){var q=this;q.widget.on(k,q,function(k){q._mobileNonSecondaryView&&(c.showElement(q.getDOMElement("add-payment-instrument-page")),c.hideElement(q.getDOMElement("add-new-payment-method")),c.hideElement(q.getDOMElement("mcx-paying-with-title")),q.widget.forceToScrollToTopOfThePage(),q.widget.trigger("RecordMaybeIneligiblePaymentMethodDisplayedMetricEvent"),b.logLatencyMetric({feature:k.startTimestampSource+
e.SEPARATOR+e.REGISTRATION_LANDING_VIEW,resource:"_Latency",startTime:k.startTimestamp}));if(q._isSkipAddCreditCardWeblabEnabled){var g=1===q._creatablePaymentMethods.length,m=q._creatablePaymentMethods.includes("CC");g&&m?(c.showElement(q.getDOMElement("add-new-payment-method")),c.hideElement(q.getDOMElement("add-payment-instrument-page")),q.widget.trigger(a,{postData:{hideAddPaymentInstrumentHeader:!0,creatablePaymentMethods:q._creatablePaymentMethods,iFrameName:q._secureIframeName}})):(c.hideElement(q.getDOMElement("add-new-payment-method")),
c.showElement(q.getDOMElement("add-payment-instrument-page")))}(k||{}).isForAPX3Register&&(c.showElement(q.getDOMElement("add-new-payment-method")),c.hideElement(q.getDOMElement("add-payment-instrument-page")),f.publishCountMetrics("NavigateToIrisRegistrationMobileWeb"),q.widget.trigger(a,{postData:{hideAddPaymentInstrumentHeader:!0,creatablePaymentMethods:["APX3"],iFrameName:q._secureIframeName,isForAPX3Register:!0,startTimestamp:k.startTimestamp,startTimestampSource:k.startTimestampSource}}));null!=
k&&null!=k.category&&"IDEAL"===k.category&&(c.showElement(q.getDOMElement("add-payment-instrument-page")),c.hideElement(q.getDOMElement("add-new-payment-method")),q.widget.trigger(n))});q.widget.on(m,q,function(b){c.hideElement(q.getDOMElement("add-payment-instrument-page"));c.showElement(q.getDOMElement("add-pm-full-page-"+b.paymentMethodIdentifier));q.widget.forceToScrollToTopOfThePage()})}})});l("events/AddPaymentInstrumentLinkSelectedEvent",["public-event-registry"],function(c){c.register("AddPaymentInstrumentLinkSelectedEvent");
return"AddPaymentInstrumentLinkSelectedEvent"});l("events/ShowAddPaymentInstrumentPage",["public-event-registry"],function(c){c.register("showAddPaymentInstrumentPage");return"showAddPaymentInstrumentPage"});l("components/AddStoreCardAdvertisementComponent",["component","jQuery","lang"],function(c){return c.extend({bindToElements:function(){var c=this;this.getDOMElement("AddStoreCardLearnMoreLink").click(function(){c.widget.publishSuccessSushiMetrics({ActionType:"RedirectLearnMoreStoreCard",ActionValueType:"Click",
ActionValue:"RedirectLearnMoreClicked"})})}})});l("components/AsyncWidgetSpinnerComponent",["components/SpinnerComponent","events/spinner-events"],function(c,d){return c.extend({widgetDone:!1,keepSpinnerOnWidgetDone:!1,initialize:function(c,d){this.keepSpinnerOnWidgetDone=d.data.keepSpinnerOnWidgetDone},bindToEvents:function(){this.widget.on("submitFormAjaxStarted",this,function(){this.widget.trigger(d.showSpinner)});this.widget.on(d.showSpinner,this,function(){this._show(this._spinnerName)});this.widget.on("submitFormAjaxCompleted",
this,function(){this.widgetDone&&this.keepSpinnerOnWidgetDone||this.widget.trigger(d.hideSpinner)});this.widget.on(d.hideSpinner,this,function(){this._hide(this._spinnerName)});this.widget.on("Done",this,function(){this.widgetDone=!0})}})});l("components/SpinnerComponent",["component","css-utils","lang"],function(c,d,f){var h=[];return c.extend({initialize:function(c,a){this._spinnerName=a.data.spinnerName;h.push(this)},spinnerInstance:function(c){var a=this,m=f.filter(h,function(k){return k.data.spinnerName===
c&&k.widget.widgetInstanceId===a.widget.widgetInstanceId});return(m&&m[m.length-1]||a).getDOMElement(a._spinnerName)},_show:function(c){d.showElement(this.spinnerInstance(c))},_hide:function(c){d.hideElement(this.spinnerInstance(c))},bindToEvents:function(){var c=this;c.widget.on("SpinnerChangeAppearanceEvent",c,function(a){a.spinnerName===c._spinnerName&&(a.display?c._show():c._hide())})}})});l("components/CVVAuthenticateComponent","css-utils jQuery form-component lang AUI!P clog ExecutionsWidgetUtils".split(" "),
function(c,d,f,h,g,a,m){return f.extend({initialize:function(a,e){this.isRegistrationUseCase=e.data.isRegistrationUseCase;this.cvvCocoonBlob=e.data.cvvCocoonBlob;this.authenticationSourceId=e.data.authenticationSourceId;this._clientId=e.data.clientId;this.dynamicContinueFormDescription=e.data.dynamicContinueFormDescription;this.maxCVVLength=e.data.maxCVVLength;this.isCvvAuthenticateEventNameDifferentiationEnabled=e.data.isCvvAuthenticateEventNameDifferentiationEnabled;this.retries=0;this.isRegistrationUseCase&&
this._initiateCVVAuthentication("CVVAuthenticateEvent");c.hideElement(this.getDOMElement("CVVAuthenticateSpinner"))},_handleFormSubmission:function(){a.logCounterMetric({feature:"CVVAuthenticateConfirmButtonClicked",resource:"_Count"});a.publishMetrics();0===this.form.validateForm().length&&this.widget.trigger("cvvAuthenticateFormSubmitted")},_handleCancelClick:function(){this.fireCVVAuthenticateCompleteEvent("CVVAuthenticateCancelEvent")},_pollCVVAuthenticationStatus:function(){this.isCvvAuthenticateEventNameDifferentiationEnabled?
this._initiateCVVAuthentication("CVVAuthenticatePollEvent"):this._initiateCVVAuthentication("CVVAuthenticateEvent")},_initiateCVVAuthentication:function(c){var e=this;c={addCreditCardVerificationNumber:e.form.getFormValues().addCreditCardVerificationNumber,"ppw-widgetEvent":c,"ppw-widgetState":e.widget.options.serializedState,"ppw-cvvCocoonBlob":e.cvvCocoonBlob};e.authenticationSourceId&&(c["ppw-authenticationSourceId"]=e.authenticationSourceId);e.widget.continueRequest(c,{success:function(b){b=b.additionalWidgetResponseData.additionalData;
e.retries++;15<=e.retries&&(a.logCounterMetric({feature:"CVVAuthenticateReachRetryLimit",resource:"_Count"}),a.publishMetrics());e.authenticationSourceId=b.authenticationSourceId;b&&("PENDING"===b.status||"UNSTARTED"===b.status)&&15>e.retries?p.setTimeout(h.bind(e._pollCVVAuthenticationStatus,e),200):(b&&"PENDING"===b.status?(e.showCVVErrorAndHideAuthenticationSpinner(),e.fireCVVAuthenticateCompleteEvent("CVVAuthenticatePendingEvent")):b&&"APPROVED"===b.status?e.fireCVVAuthenticateCompleteEvent("CVVAuthenticateApprovedEvent"):
(e.showCVVErrorAndHideAuthenticationSpinner(),e.fireCVVAuthenticateCompleteEvent("CVVAuthenticateDeclinedEvent")),delete e.authenticationSourceId)},error:function(b){e.showCVVErrorAndHideAuthenticationSpinner();e.fireCVVAuthenticateCompleteEvent("CVVAuthenticateDeclinedEvent")}})},fireCVVAuthenticateCompleteEvent:function(a){this.isRegistrationUseCase?this.widget.continueRequest({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":a},{success:this.widget.createAjaxContinueSuccessHandler()}):
m.dynamicContinueWithEvent(a,this.widget.options.serializedState,[{name:"ppw-authenticateSourceId",value:this.authenticationSourceId},{name:"ppw-clientId",value:this._clientId}],this.dynamicContinueFormDescription,this.widget.getRootDOMElements().last())},showCVVErrorAndHideAuthenticationSpinner:function(){},bindToElements:function(){var a=this,e=this.getDOMElement("cvv-authenticate-input-box"),b=this.getDOMElement("ConfirmCVVButton");this.getDOMElement("ConfirmCVVButton").click(h.bind(this._handleFormSubmission,
this));this.getDOMElement("cancel-confirm-CVV-button").click(h.bind(this._handleCancelClick,this));e.bind("input keyup",function(){e.val().length==a.maxCVVLength?b.removeClass("a-button-disabled"):b.addClass("a-button-disabled")})},bindToEvents:function(){var a=this;a.widget.on("cvvAuthenticateFormSubmitted",a,function(){c.showElement(this.getDOMElement("CVVAuthenticateSpinner"));a._initiateCVVAuthentication("CVVAuthenticateEvent")})}})});l("components/BackToCartComponent",["component"],function(c){return c.extend({_getBackToCartLink:function(){return this.getDOMElement("pmtsBackToCartLink")},
_makeTransition:function(c){p.location=c},bindToElements:function(){var c=this,f=c._getBackToCartLink();0<f.length&&f.click(function(){c.widget.trigger("BackToCartRequested");return!1})},bindToEvents:function(){var c=this;c.widget.on("BackToCartRequested",c,function(f){f=c._getBackToCartLink().attr("href");c._makeTransition(f)})}})});l("components/BankAccountAddressChallengeComponent","events/InstrumentRowSelectedEvent lang css-utils server jQuery form-component validation-functions keyboard public-event-registry events/PaymentMethodChallengedEvent attributes".split(" "),
function(c,d,f,h,g,a,m,k,e,b,n){return a.extend(n,{_addressChallenge:!0,_accountNumberTail:"",_instrumentId:"",_isStandalone:null,initialize:function(a,c){e.register(b.eventName);this._accountNumberTail=c.data.accountNumberTail;this._instrumentId=c.data.instrumentId;this._isStandalone=c.data.isStandalone;this.form.formModel.registerAdditionalData("accountNumberTail",this._accountNumberTail)},bindToElements:function(){var b=this;b.getDOMElement("bankAccountAddressChallengeVerifyButton").click(function(a){a.preventDefault();
b.verifyButtonClicked()});b.getDOMElement("addressChallengeBankRoutingNumber").keypress(function(a){a.which===k.keys.VK_RETURN&&(a.preventDefault(),b.verifyButtonClicked())})},bindToEvents:function(){this.widget.on("initializeRecommendedInstrument",this,function(b){this._toggleAddressChallengeFormOnInstrumentSelection(b)});this.widget.on(c,this,function(b){this._toggleAddressChallengeFormOnInstrumentSelection(b)})},verifyButtonClicked:function(){0===this.form.validateForm().length&&this._confirmInstrument()},
_toggleAddressChallengeFormOnInstrumentSelection:function(b){b.instrumentId===this._instrumentId&&this._addressChallenge?this._toggleAddressChallengeForm(!0):this._toggleAddressChallengeForm(!1)},_confirmInstrument:function(){var b=this;b.form.resetErrors();var a=b.form.getFormValues(),a={"ppw-widgetEvent":"ConfirmBankAccountEvent","ppw-instrumentId":b._instrumentId,addBankAccountNumber:a.addBankAccountNumber,addBankAccountRoutingNumber:a.addBankAccountRoutingNumber,"ppw-widgetState":b.widget.options.serializedState},
e={success:d.bind(b._onConfirmBankAccountSuccess,b),error:function(){b.widget.trigger(c,{instrumentId:b._instrumentId})},resumeContinueQueueOnError:!0};b.widget.submitFormAJAX(a,e)},_onConfirmBankAccountSuccess:function(b){b=b.additionalWidgetResponseData.additionalData;if("ok"===b.status)this._bankAccountAddressChallengePassed();else{b=b.errors?b.errors.split(","):[];var a=[];d.forEach(b,function(b){a.push({messageStringId:b})});this.form.renderErrorMessages(this.form._getLocalizedErrorMessages(a))}this.widget.trigger(c,
{instrumentId:this._instrumentId})},_bankAccountAddressChallengePassed:function(){this._addressChallenge=!1;this.widget.trigger(b.eventName,b.successStatus);this.form.clearValidationErrors();this._toggleAddressChallengeForm(!1);this.getDOMElement("addressChallengeBankAccountNumber").remove();this.getDOMElement("addressChallengeBankRoutingNumber").remove();this.widget.trigger("bankAccountAddressChallengePassed",{instrumentId:this.data.instrumentId})},_toggleAddressChallengeForm:function(a){f.toggleElement(this.getDOMElement("bankAccountAddressChallengeForm"),
a);a&&(this.widget.trigger(b.eventName,b.showStatus),this.widget.publishSuccessSushiMetrics({ActionType:"ShowBankAccountAddressChallenge",ActionValueType:"PaymentInstrument",ActionValue:this._instrumentId}))}})});l("components/BillingAddressComponent",["component"],function(c){return c.extend({_getChangeAddressLink:function(){return this.getDOMElement("pmtsChangeAddressLink")},_makeTransition:function(c){p.location=c},bindToElements:function(){var c=this,f=c._getChangeAddressLink();0<f.length&&f.click(function(){c.widget.trigger("ChangeBillingAddressRequested");
return!1})},bindToEvents:function(){var c=this;c.widget.on("ChangeBillingAddressRequested",c,function(f){f=c._getChangeAddressLink().attr("href");c._makeTransition(f)})}})});l("components/CardScanComponent","css-utils jQuery component lang clog scanner-helper".split(" "),function(c,d,f,h,g,a){return f.extend({bindToElements:function(){var c=this;c.getDOMElement("addCreditCardScanningButton").click(function(){c._countCreditCardScannerEvent();c.widget.publishSuccessSushiMetrics({ActionType:"AddCreditCard",
ActionValueType:"AddMethod",ActionValue:"CardScan"});a.handleCardScanDOMEvent(h.bind(c._addCreditCardSuccessCallback,c),h.bind(c._failureCallback,c),a.CARD_TYPE_CREDIT)});c.getDOMElement("addressChallengeScanningButton").click(function(){c._countCreditCardScannerEvent();a.handleCardScanDOMEvent(h.bind(c._challengeCreditCardSuccessCallback,c),h.bind(c._failureCallback,c),a.CARD_TYPE_CREDIT)})},_countCreditCardScannerEvent:function(){g.logCounterMetric({feature:"CreditCardScannerEvent",resource:"_Count"})},
_addCreditCardSuccessCallback:function(a){var c=this;c._sharedSuccessCallback(a,function(a){c._displayFailureMessages(a);c.widget.trigger("addCreditCardScannerInfo",a)})},_challengeCreditCardSuccessCallback:function(a){var k=this;k._sharedSuccessCallback(a,function(a){c.hideElement(k.getDOMElement("addressChallengeScanningButton"));k.widget.trigger("addressChallengeCreditCardInfo",a);k.widget.trigger("addressChallengeConfirmButtonClicked")})},_sharedSuccessCallback:function(a,c){this.widget.trigger("resetAccountHolderNameCheckbox");
a&&a.cardData&&(a=a.cardData,c({accountHolderName:this._processAccountHolderName(a),creditCardNumber:this._processCreditCardNumber(a),expirationDate:this._processExpirationDate(a)}))},_failureCallback:function(a){this.widget.log({creditCardScannerError:a});g.logCounterMetric({feature:"CreditCardScannerEvent",resource:"_ErrorCount"})},_processCreditCardNumber:function(a){if(d.isArray(a.number)&&a.number.length)return g.logCounterMetric({feature:"CreditCardScannerPANEvent",resource:"_Count"}),d.trim(a.number[0].value)},
_processAccountHolderName:function(a){if(d.isArray(a.name)&&a.name.length)return g.logCounterMetric({feature:"CreditCardScannerAccountHolderNameEvent",resource:"_Count"}),d.trim(a.name[0].value)},_processExpirationDate:function(a){if(d.isArray(a.expirationMonth)&&d.isArray(a.expirationYear)&&a.expirationMonth.length&&a.expirationYear.length){g.logCounterMetric({feature:"CreditCardScannerExpirationDateEvent",resource:"_Count"});var c=parseInt(a.expirationYear[0].value,10);100>c&&(c+=2E3);if(c>=(new Date).getFullYear())return{month:""+
parseInt(a.expirationMonth[0].value,10),year:""+c}}},_displayFailureMessages:function(a){var k=!1;a.accountHolderName||(c.showElement(d(this.getDOMElement("cardScanningMissingName"))),k=!0);a.creditCardNumber||(c.showElement(d(this.getDOMElement("cardScanningMissingNumber"))),k=!0);a.expirationDate||(c.showElement(d(this.getDOMElement("cardScanningMissingExpDate"))),k=!0);k&&c.showElement(d(this.getDOMElement("cardScanningFailureMessages")))}})});l("scanner-helper",["AUI!P"],function(c){return{CARD_TYPE_CREDIT:1,
CARD_TYPE_GIFT:2,handleCardScanDOMEvent:function(d,f,h){var g;p.app&&p.app.willReappear&&(g=p.app.willReappear,delete p.app.willReappear);var a=function(){p.setTimeout(function(){p.app&&g&&(p.app.willReappear=g)},100)};c.when("mash").execute(function(c){c.showCardScanner({cardTypes:[h],failCallback:function(){f();a()},successCallback:function(c){d(c);a()}})})}}});l("components/ChallengeInstrumentSelectComponent",["css-utils","jQuery","component","events/ShowAddPaymentInstrumentPage"],function(c,d,
f,h){return f.extend({_showSecondaryView:!1,_deviceType:"desktop",initialize:function(c,a){this._showSecondaryView=a.data.showSecondaryView;this._deviceType=c.options.deviceType},bindToEvents:function(){var g=this;g.widget.on("ContinueButtonClicked",g,function(a){g.widget.trigger("ManualFormSubmission")});g.widget.on("CompleteWidget",g,function(a){g.widget.trigger("ManualFormSubmission")});g.widget.on("SecondaryContinueButtonClicked",g,function(a){g.widget.trigger("ManualFormSubmission")});g.widget.on("ManualFormSubmission",
g,function(){g.getDOMElement("challenge-instrument-select-form-to-submit").append("\x3cinput name\x3dppw-widgetEvent value\x3dPreferencePaymentOptionSelectionEvent type\x3dhidden /\x3e").submit()});g.widget.on(h,g,function(a){"mobile"===g._deviceType&&"false"===g._showSecondaryView&&(c.hideElement(g.getDOMElement("payselect-title")),c.hideElement(g.getDOMElement("payment-option-list-page")),c.hideElement(g.getDOMElement("secondary-mobile-continue-button")))})}})});l("components/ChallengePaymentMethodComponent",
["component","jQuery"],function(c,d){return c.extend({paymentMethodId:"",initialize:function(c,d){this.paymentMethodId=d.data.paymentMethodId?d.data.paymentMethodId:""},bindToElements:function(){var c=this;c.getDOMElement("challengePaymentMethodMobileSubmitButton").click(function(d){d.preventDefault();c.triggerExpirationDateValidated()})},bindToEvents:function(){this.widget.on("addressChallengeValidate",this,function(){this.triggerExpirationDateValidated()})},triggerExpirationDateValidated:function(){this.widget.trigger("expirationDateValidated",
{instrumentId:this.paymentMethodId,isExpirationDateValid:!0})}})});l("components/OTPVerificationComponent","component lang jQuery AUI!P css-utils events/spinner-events clog".split(" "),function(c,d,f,h,g,a,m){return c.extend({initialize:function(){this.widgetContainerId=this.getDOMElement(this.data.cvfWidgetContainerJSElementBinding).attr("id");this.data.autoLoad&&(this.data.newOTPVerificationFlowEnabled!==r&&this.data.newOTPVerificationFlowEnabled?this.loadNewCVFWidget():this.loadOldCVFWidget())},
confirmNewCVFWorkflowCompletionClaimToken:function(c){var e=this;this.widget.trigger(a.showSpinner);this.widget.continueRequest({"ppw-claimToken":c,"ppw-widgetEvent":"OneTimePasswordVerifyClaimTokenEvent","ppw-widgetState":this.getWidgetState(this.data.cvfWidgetContainerJSElementBinding)},{success:d.bind(function(b){this.widget.trigger(a.hideSpinner);b=b.additionalWidgetResponseData.additionalData;"false"===b.verified?(e.data.requestToken=b.requestToken,e.loadNewCVFWidget()):e.widget.trigger("OTPVerificationSuccessful")},
this),error:d.bind(function(){e.widget.trigger(a.hideSpinner);e.toggleJSDisabledMessage(!0)},this)})},confirmOldCVFWorkflowCompletionClaimToken:function(c){var e=this;h.when("A").execute(function(b){e.widget.trigger(a.showSpinner)});this.widget.continueRequest({"ppw-claimToken":c,"ppw-widgetEvent":"OneTimePasswordVerifyClaimTokenEvent","ppw-widgetState":this.getWidgetState(this.data.cvfWidgetContainerJSElementBinding)},{success:function(b){b=b.additionalWidgetResponseData.additionalData;if("false"===
b.verified)switch(b.errorName){case "authentication_required":e.emitOTPVerificationFailedEvent("authentication");m.logCounterMetric({feature:"OTPVerificationFailedEventTypeAuthentication",resource:"_ErrorCount"});m.publishMetrics();break;case "temporarily_unavailable":e.emitOTPVerificationFailedEvent("connection");break;case "expired":e.emitOTPVerificationFailedEvent("expiration-or-excessive-attempts");break;case "verification_error":e.emitOTPVerificationFailedEvent("throttle");break;default:case "access_denied":case "invalid_request":e.emitOTPVerificationFailedEvent("implementation")}},
error:function(){e.emitOTPVerificationFailedEvent("connection")},complete:function(){h.when("A").execute(function(b){e.widget.trigger(a.hideSpinner)})}})},bindToEvents:function(){var a=this;this.widget.on("otpVerificationLoadWorkflow",this,function(e){e.identifier===a.data.otpVerificationComponentIdentifier&&(a.data.newOTPVerificationFlowEnabled!==r&&a.data.newOTPVerificationFlowEnabled?a.loadNewCVFWidget():a.loadOldCVFWidget())})},loadNewCVFWidget:function(){var a=this;h.when("A","cvf","ready").execute(function(e,
b){a.toggleJSDisabledMessage(!1);b.create({target:f("#"+a.widgetContainerId),requestToken:a.data.requestToken,onSuccess:d.bind(a.confirmNewCVFWorkflowCompletionClaimToken,a),onError:function(b){a.toggleJSDisabledMessage(!0)},autoStart:!1}).start()})},loadOldCVFWidget:function(){var c=this;h.when("A","cvf","ready").execute(function(e,b){b.create({target:f("#"+c.widgetContainerId),requestToken:c.data.requestToken,onSuccess:d.bind(c.confirmOldCVFWorkflowCompletionClaimToken,c),onError:function(b){c.emitOTPVerificationFailedEvent("connection")},
autoStart:!1}).start();if(c.data.disableContinueButtonDuringVerificationWorkflow){c.widget.trigger(a.showSpinner);var n=p.setInterval(function(){f(".cvf-widget-section-js").length&&(c.widget.trigger(a.hideSpinner),c._triggerBackingInstrumentSelectedEvent(),p.clearInterval(n))},0)}})},toggleJSDisabledMessage:function(a){g.toggleElement(f(this.getDOMElement("jsDisabledMessage")),a)},emitOTPVerificationFailedEvent:function(a){this.widget.trigger("otpVerificationFailed",{failureType:a,challengeType:this.data.challengeType})},
_triggerBackingInstrumentSelectedEvent:function(){var a=this.widget.getLocalizedString("pmts_portal_otp_required_for_cod");this.widget.trigger("backingInstrumentSelected",{errors:a?a:null})}})});l("components/DeleteInstrumentComponent",["modal-popover","component","AUI!P","lang"],function(c,d,f,h){return d.extend({initialize:function(g,a){var m=this;a.data.shouldRenderInPopover&&(m.popover=new c(g,a,m));a.data.isJPPersonalBankAccount&&f.when("A","jp-bank-list","ready").execute(function(a,e){a=e.getBankNameByCode(m.getDOMElement("delete-bank-name-field").attr("data-bankCode"));
a!==r&&(m.getDOMElement("delete-bank-name-field")[0].innerHTML=a)})},bindToEvents:function(){this.widget.on("mpo-delete-popover-closed",this,function(c){this.getDOMElement("pmts-mpo-js-delete-popover-cancel-form").submit()})}})});l("components/PopoverComponent",["modal-popover","component","jQuery"],function(c,d,f){return d.extend({initialize:function(d,g){g.data.isInPopover&&(this.popover=new c(d,g,this))},bindToEvents:function(){this.widget.on("pmts-popover-selected-popover-closed",this,function(c){this.getDOMElement("pmts-popover-component-js-popover-cancel-form").submit()})}})});
l("components/SetAddressLabelComponent",["component"],function(c){return c.extend({})});l("components/SetDeliveryOptionComponent",["css-utils","form-component","lang","jQuery"],function(c,d,f,h){return d.extend({initialize:function(c,a){},bindToElements:function(){this._getShippingMethodRows().click(f.bind(this._triggerShippingMethodRowSelectedEvent,this))},bindToEvents:function(){var c=this;c.widget.on("shippingMethodRowSelected",c,function(a){var m=c._getShippingMethodRows();f.forEach(m,function(k){c._shippingMethodRowSelected(h(k),
a.shippingMethodId)},c)})},_getShippingMethodRows:function(){return this.getDOMElementsByPrefix("shippingMethodSelectionRow-")},_triggerShippingMethodRowSelectedEvent:function(c){c=h(c.currentTarget).data("shipping-method-id");this.widget.trigger("shippingMethodRowSelected",{shippingMethodId:c})},_shippingMethodRowSelected:function(c,a){var m=c.data("shipping-method-id"),k=c.find("input[type\x3dradio]");a===m?this._updateStylingOfCurrentRow(c,"pmts-selected","pmts-box",k,!0):this._updateStylingOfCurrentRow(c,
"pmts-box","pmts-selected",k,!1)},_updateStylingOfCurrentRow:function(c,a,m,k,e){c.removeClass(m);c.hasClass(a)||c.addClass(a);k.prop("checked",e)}})});l("components/ContinueButtonComponent","css-utils jQuery lang continuable-component events/SelectablePaymentOptionEvents clog".split(" "),function(c,d,f,h,g,a){return h.extend({initialize:function(a,c){this.isOneClickReviewOrderMessage=c.data.isOneClickReviewOrderMessage;this.continueButton=(this.isSecondaryButton=c.data.isSecondaryButton)?"secondary-continue-button":
"continue-button";this.isUpiIssuanceEnabled=c.data.isUpiIssuanceEnabled;this.isPaylastEnabled=c.data.isPaylastEnabled;this.isViewDetailsPopoverEnabled=c.data.isViewDetailsPopoverEnabled},popoverMessage:"",popover:null,_handleClickEvent:function(c){c=this.isSecondaryButton?"SecondaryContinueButtonClicked":"ContinueButtonClicked";this.isViewDetailsPopoverEnabled&&this.widget.trigger("hideViewDetailsPopover");this.widget.log({eventName:!0});var k=0;f.forEach(d("input[type\x3dradio][name\x3dppw-instrumentRowSelection]"),
function(a){a.checked&&k++});0===k&&a.logCounterMetric({feature:"ContinueButtonClickedWithoutPaymentMethods",resource:"_Count"});a.logCounterMetric({feature:"ContinueButtonClicked",resource:"_Count"});a.publishMetrics();this.getContinuable()?this.widget.trigger(c):this.data.alwaysEnableContinueButtonOnMobile&&this.widget.trigger("ContinueButtonClickedWithInvalidPaymentPlanEvent",{message:this.popoverMessage});return!1},_handlePaymentPlanSelected:function(a,c){this.popoverMessage=c;this.popover.auiShow(!a,
{inlineContent:this.popoverMessage})},_toggleContinueButtonStyling:function(a){this.data.disableContinueButtonOnlyOnMouseover||this.data.alwaysEnableContinueButtonOnMobile||this._toggleContinueButtonStylingDefault(a)},_toggleContinueButtonStylingDefault:function(a){this.getDOMElement(this.continueButton).toggleClass("a-button-disabled",!a)},_handleMouseoverEvent:function(a){a=this.getContinuable();this._toggleContinueButtonStyling(a);this.popover.customShow(!a,{literalContent:this.popoverMessage})},
_handleMouseoutEvent:function(a){this.popover.customShow(!1,{literalContent:this.popoverMessage})},_handleMouseoverEventDisableOnlyOnHover:function(a){this.getDOMElement(this.continueButton).toggleClass("a-button-disabled",!this.getContinuable());this.popover.customShow(!this.getContinuable(),{literalContent:this.popoverMessage})},_handleMouseoutEventDisableOnlyOnHover:function(a){this.popover.customShow(!1,{literalContent:this.popoverMessage});this.getDOMElement(this.continueButton).removeClass("a-button-disabled")},
_handleFocusinEventDisableOnlyOnHover:function(a){this.popover.customShow(!this.getContinuable,{literalContent:this.popoverMessage})},_handleFocusoutEventDisableOnlyOnHover:function(a){this.popover.customShow(!1,{literalContent:this.popoverMessage})},_changeTextOnContinueButton:function(a){this.getDOMElement("ContinueButtonText")&&(this.getDOMElement("ContinueButtonText")[0].innerHTML=this.widget.getLocalizedString(a))},_changeTextOnContinueButtonWithParameters:function(a,c){this.getDOMElement("ContinueButtonText")&&
(this.getDOMElement("ContinueButtonText")[0].innerHTML=this.widget.getLocalizedString(a,c))},bindToElements:function(){this.getDOMElement(this.continueButton).click(f.bind(this._handleClickEvent,this));this.data.disableContinueButtonOnlyOnMouseover?(this.getDOMElement(this.continueButton).mouseover(f.bind(this._handleMouseoverEventDisableOnlyOnHover,this)),this.getDOMElement(this.continueButton).mouseout(f.bind(this._handleMouseoutEventDisableOnlyOnHover,this)),this.getDOMElement(this.continueButton).focusin(f.bind(this._handleFocusinEventDisableOnlyOnHover,
this)),this.getDOMElement(this.continueButton).focusout(f.bind(this._handleFocusoutEventDisableOnlyOnHover,this))):(this.getDOMElement(this.continueButton).mouseover(f.bind(this._handleMouseoverEvent,this)),this.getDOMElement(this.continueButton).mouseout(f.bind(this._handleMouseoutEvent,this)),this.getDOMElement(this.continueButton).focusin(f.bind(this._handleMouseoverEvent,this)),this.getDOMElement(this.continueButton).focusout(f.bind(this._handleMouseoutEvent,this)))},bindToEvents:function(){this.widget.on(g.PaymentPlanSelected,
this,function(a){"pmts-portal-mobile-continue-button"===this.getDOMElement(this.continueButton).find("input").data("button-id")?(this._toggleContinueButtonStyling(this.getContinuable()),this.popoverMessage=a.message):(this._toggleContinueButtonStyling(a.isValid),this._handlePaymentPlanSelected(a.isValid,a.message))});this.widget.on("selectableDebitCardSelectedDisableContinue",this,function(){this._toggleContinueButtonStyling(!1)});this.widget.on("selectableAddCreditCardSelected",this,function(){this._toggleContinueButtonStyling(!1)});
this.widget.on("apbSelectionChanged",this,function(){this.getContinuable()||""!==this.popoverMessage||(this.popoverMessage=this.widget.getLocalizedString("pmts_portal_payselect_empty_instrument_selection"))});this.widget.on("SetContinueButtonTextToPlaceOrder",this,function(){this.isPaylastEnabled&&this._changeTextOnContinueButton("apx_continue_text_place_order")});this.widget.on("SetContinueButtonTextToPlaceOrderAndPay",this,function(){this.isPaylastEnabled&&this._changeTextOnContinueButton("apx_continue_text_place_order_and_pay")});
this.widget.on("setContinueButtonText",this,function(a){a.stringId&&(a.parameters?this._changeTextOnContinueButtonWithParameters(a.stringId,a.parameters):this._changeTextOnContinueButton(a.stringId))});if(this.isOneClickReviewOrderMessage)this.widget.on("backingInstrumentSelected",this,function(a){c.toggleElement(this.getDOMElement("sidebarContinueButtonMessage"),!!a.isEligibleForTfx)});if(this.isUpiIssuanceEnabled){var a=this;this.widget.on("UpiRedirectionRequiredEvent",this,function(c){"pmts-portal-mobile-continue-button"===
a.getDOMElement(a.continueButton).find("input").data("button-id")?a._toggleContinueButtonStyling(a.getContinuable()):(a._toggleContinueButtonStyling(!0),a._handlePaymentPlanSelected(!0,null))})}}})});l("components/CreatePlanFromPreferencesComponent",["component","lang"],function(c,d){return c.extend({})});l("components/CVVVerifyComponent",["css-utils","jQuery","form-component","lang","AUI!P"],function(c,d,f,h,g){return f.extend({_hasErrors:!1,initialize:function(a,c){this._hasErrors=c.data.hasErrors;
this.declinedCount=0},handleCVVVerifyDOMEvent:function(){0===this.form.validateForm().length&&(this.getDOMElement("cvvVerifySubmitButton"),this.getDOMElement("pmts-cvv-verify-form"),this.widget.trigger("cvvVerifyFormSubmitted"));return!1},_pollForVerificationStatus:function(){var a=this,c=a.form.getFormValues(),c={"ppw-selectedInstrumentId":c.selectedInstrumentId,addCreditCardVerificationNumber:c.addCreditCardVerificationNumber,"ppw-widgetEvent":"CvvVerifyEvent","ppw-widgetState":a.widget.options.serializedState,
"ppw-declinedCount":a.declinedCount};a._verificationId&&(c["ppw-verificationId"]=a._verificationId);a.widget.trigger("submitFormAjaxStarted");a.widget.continueRequest(c,{success:function(c){c=c.additionalWidgetResponseData.additionalData;a.retries?a.retries++:a.retries=1;c&&"VerificationPending"===c.status&&5>a.retries?(a._verificationId=c.verificationId,p.setTimeout(h.bind(a._pollForVerificationStatus,a),2E3)):("VerificationDeclined"===c.status&&(a.declinedCount?a.declinedCount++:a.declinedCount=
1),delete a._verificationId,delete a.retries,a.widget.trigger("submitFormAjaxCompleted"),c.errors&&(c.errors=JSON.parse(c.errors),a.form.renderErrorMessages(c.errors)))}})},bindToElements:function(){this.getDOMElement("cvvVerifySubmitButton").click(h.bind(this.handleCVVVerifyDOMEvent,this))},bindToEvents:function(){var a=this;a.widget.on("cvvVerifyFormSubmitted",a,function(){a._pollForVerificationStatus()});a.widget.on("UpdateWidget",a,function(c){c&&(c=d.parseJSON(c),"CVVVerifyComponent"===c.componentName&&
a.form.renderErrorMessages(c.errors))})},buildHiddenInput:function(a,c){return d("\x3cinput\x3e").attr({type:"hidden",name:a,value:c})}})});l("components/DebugConsoleComponent",["jQuery","component","lang"],function(c,d,f){return d.extend({initialize:function(){this.eventCount=0;this.lastEventTime=r},bindToEvents:function(){var d=this,g=d.getDOMElement(d.data.javaScriptClearEventLogElementReference),a=d.getDOMElement(d.data.javaScriptForceContinueElementReference),m=d.getDOMElement(d.data.javaScriptEventSectionElementReference);
g.click(function(a){m.empty();d.lastEventTime=r;return!1});a.click(function(a){d.widget.trigger("ContinueButtonClicked");return!1});d.widget.on("all",d,function(a,e){var b=++this.eventCount;d.widget.clientSideEventsHandler(a,e);var b=f.leftPad(b,3,"0")+" "+a+" -\x3e "+JSON.stringify(e),n=c("\x3ca\x3e",{text:"[Replay]",href:"#",click:function(){d.widget.trigger(a,e);return!1}}),q=new Date;1E3<q-d.lastEventTime&&m.prepend("\x3cbr /\x3e");d.lastEventTime=q;m.prepend(" "+b+"\x3cbr /\x3e");m.prepend(n)})}})});
l("components/DeleteAndUpdateEverywhereComponent",["modal-popover","component","lang","css-utils","attributes"],function(c,d,f,h,g){return d.extend(g,{initialize:function(a,g){g.data.shouldRenderInPopover&&(this.popover=new c(a,g,this));this.set("removeAndUpdateButtonEnabledAttribute",!0);this.watch("removeAndUpdateButtonEnabledAttribute",this,function(a){this.widget.log({updateButtonEnabled:a});a?h.enableElement(this.getDOMElement("apx-delete-and-ue-remove-and-update-button")):h.disableElement(this.getDOMElement("apx-delete-and-ue-remove-and-update-button"))})},
bindToElements:function(){var a=this;a.getDOMElement("apx-delete-and-ue-remove-and-update-button").click(f.bind(a._handleClickReplaceAndUpdateEvent,a));a.getDOMElement("apx-delete-and-ue-cancel-button").click(function(){a.getDOMElement("apx-delete-and-ue-cancel-button-form").submit()});a.getDOMElement("apx-delete-and-skip-ue-button").click(function(){a.getDOMElement("apx-delete-and-skip-ue-button-form").submit()})},bindToEvents:function(){var a=this;a.widget.on("apx-delete-and-update-everywhere-popover-closed",
a,function(){a.getDOMElement("apx-delete-and-update-everywhere-popover-cancel-form").submit()});a.widget.on("componentsInitialized",a,function(){a.data&&a.data.recommendedInstrumentId?a._checkInstrumentErrorsAndUpdateButton({instrumentId:a.data.recommendedInstrumentId,errors:null}):a.set("removeAndUpdateButtonEnabledAttribute",!1)});a.widget.on("backingInstrumentSelected",this,function(c){c=c&&c.instrumentId?c:null;a._checkInstrumentErrorsAndUpdateButton(c)})},_checkInstrumentErrorsAndUpdateButton:function(a){a=
a?this._firstElement(a.errors):this.widget.getLocalizedString("pmts_portal_payselect_empty_instrument_selection");this.set("removeAndUpdateButtonEnabledAttribute",!a)},_handleClickReplaceAndUpdateEvent:function(){this.get("removeAndUpdateButtonEnabledAttribute")&&this.widget.trigger("submitSelectInstrumentForm")},_firstElement:function(a){return f.isArray(a)&&0<a.length?a[0]:null}})});l("components/ConfirmDeviceDataSourceComponent",["component"],function(c){return c.extend({bindToEvents:function(){var c=
this;this.widget.on("componentsInitialized",this,function(){p.parent.PaymentsPortal2&&p.parent.PaymentsPortal2.modules&&p.parent.PaymentsPortal2.modules.when(["events"],function(f){f.trigger("DeviceDataCollectionResponseConfirmed",c.data.deviceDataCollectionStatus)})})}})});l("components/GenerateDeviceDataCollectionUrlComponent",["component","ExecutionsWidgetUtils","events"],function(c,d,f){return c.extend({bindToEvents:function(){var c=this;this.widget.on("componentsInitialized",this,function(){d.continueRequestWithPolling({widget:c.widget,
inputData:{"ppw-widgetEvent":"GenerateDeviceDataCollectionUrlEvent","ppw-widgetState":c.widget.options.serializedState},isResponseExpectedFn:function(c){return c.deviceDataCollectionUrl!==r},onSuccessFn:function(g){d.buildContinueForm(g.redirectHttpMethod,g.deviceDataCollectionUrl,JSON.parse(g.redirectParameters),c.widget.getRootDOMElements().last()).attr("target","deviceDataCollectionIFrame").submit()},retryLimit:3,retryFailedFn:function(){c._triggerDeviceDataCollectionCompleteEvent("REJECTED")}})});
f.on("DeviceDataCollectionResponseConfirmed",this,function(g){c._triggerDeviceDataCollectionCompleteEvent(g)})},_triggerDeviceDataCollectionCompleteEvent:function(c){this.widget.submitFormAJAX({"ppw-widgetEvent":"ConfirmDeviceDataSourceCompleteEvent","ppw-widgetState":this.widget.options.serializedState,"ppw-status":c,"ppw-javaEnabled":p&&p.navigator&&p.navigator.javaEnabled(),"ppw-language":p&&p.navigator&&p.navigator.language,"ppw-screenColorDepth":p&&p.screen&&p.screen.colorDepth,"ppw-screenHeight":p&&
p.screen&&p.screen.height,"ppw-screenWidth":p&&p.screen&&p.screen.width,"ppw-timeZone":(new Date).getTimezoneOffset()})}})});l("components/DynamicSelectablePaymentOptionListComponent","css-utils continuable-component lang jQuery events/SelectablePaymentOptionEvents components/SelectablePaymentOptionListComponent".split(" "),function(c,d,f,h,g,a){return a.extend({initialize:function(a,c){}})});l("ExecutionsComponent","component jQuery ExecutionsWidgetUtils css-utils AUI!P mash-helper clog lang sdk-client events/spinner-events metrics-helper url-helper storage-helper".split(" "),
function(c,d,f,h,g,a,m,k,e,b,n,q,y){var v;return c.extend({POLLING_RETRY_LIMIT:15,POLLING_RETRY_DELAY:1E3,WEBSOCKET_CONNECTION_LIMIT_IN_MILLIS:15E3,DEFAULT_EXECUTION_PENDING_REASON:"pendingForProcessorResponse",initialize:function(b,a){this._isRequestForMobileApp=a.data.isRequestForMobileApp;this.canUseWebSocket=a.data.canUseWebSocket;this.wsConnectUrl=a.data.wsConnectUrl;this.paymentMethodMetricSuffix=[a.data.paymentMethodCategory,a.data.paymentMethodBrand].filter(Boolean).join(".");this.widgetStateFromJsData=
b.options.serializedState;this.dynamicContinueFormDescription=a.data.dynamicContinueFormDescription;this.pollForThirdPartyResponseStatus=a.data.pollForThirdPartyResponseStatus;this.thirdPartyResponseStatus=a.data.thirdPartyResponseStatus;this.pollingForResponse=a.data.pollingForResponse;this.useInline=a.data.useInline;this.deviceType=b.options.deviceType;this.showModal=a.data.showModal;this.openRedirectUrlInExternalBrowser=a.data.openRedirectUrlInExternalBrowser;this.isGatewayRedirectionHistoryCleared=
a.data.isGatewayRedirectionHistoryCleared;this.openRedirectUrlInThirdPartyApp=a.data.openRedirectUrlInThirdPartyApp;this.navigateToGatewayEnabled=a.data.navigateToGatewayEnabled;this.showMashRedirectFallbackTemplate=a.data.showMashRedirectFallbackTemplate;this.isCancelTransactionEventRequired=a.data.isCancelTransactionEventRequired;this.redirectUrl=a.data.redirectUrl;this.httpMethod=a.data.httpMethod;this.postData=a.data.postData;this.challengeRenderer=a.data.challengeRenderer;this.jwtToken=a.data.jwtToken;
this.canSkip3DRedirection=this.isSafeTrue(a.data.canSkip3DRedirection);this.shouldSkipRedirection=this.isSafeTrue(a.data.shouldSkipRedirection);this.isExternalRedirectionRequired=this.isSafeTrue(a.data.isExternalRedirectionRequired);this.showSpinnerPollingForResponseRedirectionTemplate=this.isSafeTrue(a.data.isExternalRedirectionRequired);this.pollingForResponseTimeout=a.data.pollingForResponseTimeout;this.executionStatusPollingLimit=parseInt(a.data.executionStatusPollingLimit,10);this.customerAbandonedTimeout=
parseInt(a.data.customerAbandonedTimeout,10);this.browserData={"ppw-javaEnabled":p&&p.navigator&&p.navigator.javaEnabled(),"ppw-language":p&&p.navigator&&p.navigator.language,"ppw-screenColorDepth":p&&p.screen&&p.screen.colorDepth,"ppw-screenHeight":p&&p.screen&&p.screen.height,"ppw-screenWidth":p&&p.screen&&p.screen.width,"ppw-timeZone":(new Date).getTimezoneOffset()};this.enableMfaSyncShadow=a.data.enableMfaSyncShadow||!1;this.mashShowEmbeddedBrowserEnabled=a.data.mashShowEmbeddedBrowserEnabled;
this.disableDeeplinkingInMashEmbeddedBrowser=a.data.disableDeeplinkingInMashEmbeddedBrowser;this.isSprintWeblabDialedUp=a.data.isSprintWeblabDialedUp;this.sdkFallbackPerformed=!1;this.setAsDefaultAfterTerminalStatus=a.data.setAsDefaultAfterTerminalStatus;this.enableLinkErrorPageAfterTerminalStatus=a.data.enableLinkErrorPageAfterTerminalStatus;this.showIncentiveMessagingIfToggleUnChecked=a.data.showIncentiveMessagingIfToggleUnChecked;this.terminalStatus=a.data.terminalStatus;this.reason=a.data.reason;
this.terminalStatusState=a.data.terminalStatusState;this.loadSetAsDefaultState=a.data.loadSetAsDefaultState;this.loadLinkErrorState=a.data.loadLinkErrorState;this.interstitialAbortedEmitted=this.cancelButtonClicked=!1},bindToElements:function(){var b=this;b._bindInterstitialCancelHandler();b.registerIframeLoadEvent();b.getDOMElement("apx-set-as-default-continue").click(function(){var a=[{name:"ppw-invokeSetAsDefault",value:d('[name\x3d"apx-set-as-default-toggle"]').is(":checked").toString()},{name:"ppw-terminalState",
value:b.terminalStatus},{name:"ppw-reason",value:b.reason}];f.dynamicContinueWithEvent("CompleteSetAsDefaultEvent",b.widgetStateFromJsData,a,b.dynamicContinueFormDescription,b.widget.getRootDOMElements().last())});if(b.showIncentiveMessagingIfToggleUnChecked)b.widget.onAui("a:switch:apx-set-as-default-toggle:flip",function(){d('[name\x3d"apx-set-as-default-toggle"]').is(":checked")?(h.toggleElement(b.getDOMElement("apx-set-as-default-incentive-message"),!1),m.logCounterMetric({feature:"hideToggleDisabledMessaging",
resource:"_Count"})):(h.toggleElement(b.getDOMElement("apx-set-as-default-incentive-message"),!0),m.logCounterMetric({feature:"showToggleDisabledMessaging",resource:"_Count"}));m.publishMetrics()});b.getDOMElement("apx-link-error-cancel").click(function(){f.dynamicContinueWithEvent("TerminalStatusEvent",b.widgetStateFromJsData,[{name:"ppw-terminalState",value:b.terminalStatus},{name:"ppw-reason",value:"customerCanceled"}],b.dynamicContinueFormDescription,b.widget.getRootDOMElements().last())});b.getDOMElement("pmts-executions-mash-fallback-cancel-button").click(function(){h.disableElement(b.getDOMElement("pmts-executions-mash-fallback-cancel-button"));
b._initiateCancelTransaction(b,"customerCancelledAppNotInstalled")})},_initiateCancelTransaction:function(b,a){b.isCancelTransactionEventRequired?f.dynamicContinueWithEvent("CancelTransactionEvent",b.widget.options.serializedState,[{name:"ppw-reason",value:a}],b.dynamicContinueFormDescription,b.widget.getRootDOMElements().last()):b.triggerWidgetActionWithStatus("FAILURE",a)},_handleCancelButtonClicked:function(b){this.cancelButtonClicked||this._thirdPartyInvoked()||!this.startTimeBeforeGru||(n.emitLatencyMetric("InterstitialCancelled",
this.startTimeBeforeGru,[this._getDeviceType(),this.paymentMethodMetricSuffix],!1),this.cancelButtonClicked=!0);h.disableElement(this.getDOMElement("apx-executions-redirection-cancel-button"));this._initiateCancelTransaction(this,"customerCanceled")},_thirdPartyInvoked:function(){return"true"===y.getFromSession(this._thirdPartyInvokedKey())},_thirdPartyInvokedKey:function(){return"ThirdPartyInvoked-"+q.getParameterFromCurrentURL("startWidgetContextId")},_emitMetricsWhenInterstitialAborted:function(){this.interstitialAbortedEmitted||
this._thirdPartyInvoked()||this.cancelButtonClicked||!this.startTimeBeforeGru||(n.emitLatencyMetric("InterstitialAborted",this.startTimeBeforeGru,[this._getDeviceType(),this.paymentMethodMetricSuffix],!1),this.interstitialAbortedEmitted=!0)},_handleInterstitialAborted:function(){this._emitMetricsWhenInterstitialAborted();v&&v()},_bindInterstitialCancelHandler:function(){this._isRequestForMobileApp?p.app&&!v&&(v=p.app.willDisappear,p.app.willDisappear=k.bind(this._handleInterstitialAborted,this)):
p.addEventListener("beforeunload",k.bind(this._handleInterstitialAborted,this));this.getDOMElement("apx-executions-redirection-cancel-button").click(k.bind(this._handleCancelButtonClicked,this))},bindToEvents:function(){var b=this;b.showModal&&b.loadModal();f.addHostedContinueWidgetHandler(b,"pmts-executions-inline-frame",function(a){b.thirdPartyResponseStatus?a(b.thirdPartyResponseStatus):b.pollForThirdPartyResponseStatus&&b.continueRequest({inputData:{"ppw-widgetEvent":"ThirdPartyResponseEvent",
"ppw-widgetState":b.widgetStateFromJsData},isResponseAsExpectedFn:function(b){return"undefined"!==typeof b.thirdPartyResponseStatus},onSuccessFn:function(b){a(b.thirdPartyResponseStatus)},onErrorFn:function(){a("FAILURE")}})},function(a){f.dynamicContinueWithEvent("MessageProcessedEvent",b.widgetStateFromJsData,[{name:"ppw-messageProcessedResponse",value:a}],b.dynamicContinueFormDescription,b.widget.getRootDOMElements().last())},function(a){b.messageProcessedContinue(a,b.showSpinnerPollingForResponseRedirectionTemplate)});
b.thirdPartyResponseStatus||b.pollForThirdPartyResponseStatus||b.loadSetAsDefaultState||b.loadLinkErrorState||(b.setAsDefaultAfterTerminalStatus&&b.terminalStatusState&&"SUCCESS"===b.terminalStatus?b.triggerDisplaySetAsDefault():b.enableLinkErrorPageAfterTerminalStatus&&b.terminalStatusState&&"FAILURE"===b.terminalStatus?b.triggerLinkErrorPage():b.redirectUrl?b.showThirdPartyPage():b.pollingForResponse?b.messageProcessedContinue("APPROVED",b.showSpinnerPollingForResponseRedirectionTemplate):b.triggerGetRedirectUrlEvent());
b.widget.on("WidgetAction",b,function(a){"execution"===a.widgetActionType&&"result-received"===a.widgetAction&&(b.setAsDefaultAfterTerminalStatus&&"SUCCESS"===a.executionStatus||b.enableLinkErrorPageAfterTerminalStatus&&"FAILURE"===a.executionStatus?b.widget.submitFormAJAX({"ppw-widgetState":b.widgetStateFromJsData,"ppw-widgetEvent":"TerminalStatusEvent","ppw-terminalState":a.executionStatus,"ppw-reason":null==a.reason?"":a.reason,"ppw-authenticationSourceId":a.sourceId}):(a=[{name:"ppw-terminalState",
value:a.executionStatus},{name:"ppw-reason",value:a.reason},{name:"ppw-authenticateSourceId",value:a.sourceId},{name:"ppw-clientId",value:a.clientId},{name:"ppw-maybeRemainingBalance",value:a.remainingBalance},{name:"ppw-maybeChargeIdempotencyKey",value:a.chargeIdempotencyKey}],"WebSDK"===this.challengeRenderer?(m.logCounterMetric({feature:"TerminalStatusContinueFormSubmittedForWebSDK",resource:"_Count"}),this.publishLatencyMetrics("GruEventToSdkTerminalEvent",b.startTimeBeforeGru)):this.publishLatencyMetrics("GruEventToExternalTerminalEvent",
b.startTimeBeforeGru),m.logCounterMetric({feature:"TerminalStatusContinueFormSubmitted",resource:"_Count"}),f.dynamicContinueWithEvent("TerminalStatusEvent",b.widgetStateFromJsData,a,b.dynamicContinueFormDescription,b.widget.getRootDOMElements().last())))})},triggerDisplaySetAsDefault:function(){f.dynamicContinueWithEvent("DisplaySetAsDefaultEvent",this.widgetStateFromJsData,[{name:"ppw-terminalState",value:this.terminalStatus},{name:"ppw-reason",value:this.reason}],this.dynamicContinueFormDescription,
this.widget.getRootDOMElements().last())},triggerLinkErrorPage:function(){this.isCustomerCanceledInTerminalStatusEventPage()||f.dynamicContinueWithEvent("customerCanceled"===this.reason?"TerminalStatusEvent":"DisplayLinkErrorEvent",this.widgetStateFromJsData,[{name:"ppw-terminalState",value:this.terminalStatus},{name:"ppw-reason",value:this.reason}],this.dynamicContinueFormDescription,this.widget.getRootDOMElements().last())},isCustomerCanceledInTerminalStatusEventPage:function(){try{var b=this.getCurrentLocation(),
a=b.origin+b.pathname,e=new URLSearchParams(b.search);return a===(new URL(this.dynamicContinueFormDescription.action)).href&&e.get("ppw-terminalState")===this.terminalStatus&&"customerCanceled"===e.get("ppw-reason")&&"TerminalStatusEvent"===e.get("ppw-widgetEvent")}catch(c){return!1}},getCurrentLocation:function(){return p&&p.location},triggerGetRedirectUrlEvent:function(){var b=this;m.logCounterMetric({feature:"GetRedirectUrl",resource:"_Count"});m.publishMetrics();b.startTimeBeforeGru=(new Date).getTime();
h.hideElement(b.getDOMElement("pmts-executions-entry-view-section"));h.hideElement(b.getDOMElement("pmts-executions-show-fallback"));h.showElement(b.getDOMElement("pmts-executions-async-spinner-polling-for-action"));b.continueRequest({inputData:{"ppw-widgetEvent":"GetRedirectUrlEvent","ppw-widgetState":b.widgetStateFromJsData},isResponseAsExpectedFn:function(a){a.widgetState&&(b.widgetStateFromJsData=a.widgetState);return a.redirectUrl||b.canSkip3DRedirection&&b.isSafeTrue(a.shouldSkipRedirection)||
!b.isExternalRedirectionRequired&&b.isSafeTrue(a.shouldSkipRedirection)||b._isTerminalStatus(a.executionStatus)},onErrorFn:function(){m.logCounterMetric({feature:"GetRedirectUrl",resource:"_ErrorCount"});m.publishMetrics();b.triggerFailureWidgetAction()},onSuccessFn:function(a){if(a.redirectUrl){n.emitLatencyMetric("ReceiveURLSinceGRU",b.startTimeBeforeGru,[b._getDeviceType(),b.paymentMethodMetricSuffix],!1);b.redirectUrl=a.redirectUrl;b.challengeRenderer=a.challengeRenderer;b.jwtToken=a.jwtToken;
b.triggerRedirectUrlAvailableEvent(a);b.httpMethod=a.httpMethod;a.postData&&(b.postData=JSON.parse(a.postData));if(a.additionalRedirectionDetails){b.additionalRedirectionDetails=JSON.parse(a.additionalRedirectionDetails);var e=b.getDOMElement("pmts-executions-inline-frame");e.css("height",b.additionalRedirectionDetails.height);e.css("width",b.additionalRedirectionDetails.width)}b.useInline=a.useInline;b.showThirdPartyPage()}else b.canSkip3DRedirection&&b.isSafeTrue(a.shouldSkipRedirection)?b.skipRedirection(b.showSpinnerPollingForResponseRedirectionTemplate):
!b.isExternalRedirectionRequired&&b.isSafeTrue(a.shouldSkipRedirection)&&b.skipRedirection(b.showSpinnerPollingForResponseRedirectionTemplate)},retryLimit:this.executionStatusPollingLimit,retryDelayFn:function(){return b.POLLING_RETRY_DELAY}})},createFreshLoadListenerForBrowserFlow:function(){this.getDOMElement("pmts-executions-inline-frame").unbind("load");this.registerIframeLoadEvent()},triggerAuthenticationFallback:function(){this.createFreshLoadListenerForBrowserFlow();var b=this;b.sdkFallbackPerformed?
(m.logCounterMetric({feature:"sdkFallbackCountExceeded",resource:"_Count"}),m.publishMetrics(),b.triggerWidgetActionWithStatus("FAILURE")):(b.sdkFallbackPerformed=!0,b.widget.continueRequest({"ppw-widgetEvent":"PrepareAuthenticationSourceForFallbackEvent","ppw-widgetState":this.widgetStateFromJsData},{success:function(){m.logCounterMetric({feature:"sdkFallbackTriggeredGRU",resource:"_Count"});b.triggerGetRedirectUrlEvent()},error:function(){m.logCounterMetric({feature:"sdkFallbackEventFailed",resource:"_Count"});
b.triggerWidgetActionWithStatus("FAILURE")}}))},triggerRedirectUrlAvailableEvent:function(b){this.isSprintWeblabDialedUp&&this.widget.trigger("redirectUrlAvailable",{continueWidgetResponse:b})},sdkIframeLoadingErrorAction:function(){m.logCounterMetric({feature:"sdkIframeLoadingError",resource:"_Count"});m.publishMetrics();this.SDKCallback.call(this,{status:"FallbackRequiredError"})},registerIframeLoadEvent:function(){var b=this;b.getDOMElement("pmts-executions-inline-frame").load(function(){if(b.startTimeBeforeBankPageRedirection){b.publishLatencyMetrics("GruEventToExternalBankPageLoad",
b.startTimeBeforeGru);m.logLatencyMetric({feature:"ThirdPartyPageLoad",resource:"_Latency",startTime:b.startTimeBeforeBankPageRedirection});var a=(new Date).getTime()-b.startTimeBeforeBankPageRedirection;m.publishMetrics();b.widget.publishSuccessSushiMetrics({ActionType:"ThirdPartyPageLoad",ActionValueType:"Latency_Milliseconds",ActionValue:a});b.startTimeBeforeBankPageRedirection=null}})},showThirdPartyPage:function(){var b=this;n.emitLatencyMetric("ShowThirdPartySinceGRU",b.startTimeBeforeGru,[b._getDeviceType(),
b.paymentMethodMetricSuffix],!1);var c=function(){a.navigateToUrl("/")};if("WebSDK"===this.challengeRenderer){m.logCounterMetric({feature:"sdkFlowTriggered",resource:"_Count"});m.publishMetrics();this.publishLatencyMetrics("GruEventForSdkFlow",this.startTimeBeforeGru);var q=this.getDOMElement("pmts-executions-inline-frame"),k=setTimeout(b.sdkIframeLoadingErrorAction.bind(b),5E3),g={showSdkHeader:!1,url:b.redirectUrl,token:b.jwtToken,intermediateStatusFilter:["ChallengeScreenRendered"]};q.load(function(){clearTimeout(k);
try{e.authenticate(g,b.SDKCallback.bind(b),q.get(0).contentWindow),m.logCounterMetric({feature:"sdkLibLoad",resource:"_Count"}),m.publishMetrics()}catch(a){m.logCounterMetric({feature:"sdkFlowError",resource:"_Count"}),m.publishMetrics(),b.SDKCallback.call(b,{status:"FallbackRequiredError"})}});q.attr("src",this.redirectUrl)}else if(this.openRedirectUrlInThirdPartyApp){var d="GET"===this.httpMethod?r:this.postData,c={openIn:r,httpMethod:this.httpMethod,additionalPostData:d},d=function(){};this.showMashRedirectFallbackTemplate?
(c.openIn="showFallbackTemplate",d=this.triggerRedirectionToFallbackPage):this.openRedirectUrlInExternalBrowser?c.openIn="externalBrowser":this.mashShowEmbeddedBrowserEnabled&&(c.openIn="embeddedBrowser");var f=function(){};this.navigateToGatewayEnabled&&(f=this.navigateToGateway);a.launchIntentURL(this.redirectUrl,c,f,this,d,this.paymentMethodMetricSuffix)}else this.openRedirectUrlInExternalBrowser?(this.isGatewayRedirectionHistoryCleared?a.openInExternalBrowser(this.redirectUrl,c,c):this.openInExternalBrowser(),
n.emitCounterMetric("showThirdPartyExternalPageRedirect",[this.paymentMethodMetricSuffix])):this.useInline?(this.publishLatencyMetrics("GruEventForExternalFlow",this.startTimeBeforeGru),this.submitForm("pmts-executions-inline-frame"),this.startTimeBeforeBankPageRedirection=(new Date).getTime(),h.hideElement(this.getDOMElement("pmts-executions-async-spinner-polling-for-action")),h.showElement(this.getDOMElement("pmts-executions-entry-view-section")),n.emitCounterMetric("showThirdPartyInLinePageRedirect",
[b._getDeviceType(),this.paymentMethodMetricSuffix])):this.mashShowEmbeddedBrowserEnabled?(n.emitCounterMetric("showEmbeddedBrowserForRedirect",[this.paymentMethodMetricSuffix]),d="GET"===this.httpMethod?r:this.postData,a.showEmbeddedBrowser(this.redirectUrl,this.httpMethod,d,function(){},function(){a.publishOpenBrowserFailureMetric(!0,this.paymentMethodMetricSuffix)},c,!this.disableDeeplinkingInMashEmbeddedBrowser)):(n.emitCounterMetric("formSubmitForRedirect",[b._getDeviceType(),this.paymentMethodMetricSuffix]),
this.submitForm());y.putInSession(b._thirdPartyInvokedKey(),"true");0<this.customerAbandonedTimeout&&(this.customerAbandonedTimeoutId=this.handleTimeout("FAILURE","customerAbandonedResponse",this.customerAbandonedTimeout))},_getDeviceType:function(){return this._isRequestForMobileApp?"mobileapp":this.deviceType},triggerRedirectionToFallbackPage:function(b){h.hideElement(b.getDOMElement("pmts-executions-async-spinner-polling-for-action"));h.showElement(b.getDOMElement("pmts-executions-show-fallback"));
m.logCounterMetric({feature:"showMashRedirectFallbackTemplateMetric",resource:"_Count"});m.publishMetrics()},enableEntryView:function(){h.hideElement(this.getDOMElement("pmts-executions-async-spinner-polling-for-action"));h.showElement(this.getDOMElement("pmts-executions-entry-view-section"))},SDKCallback:function(b){"ChallengeScreenRendered"===b.status?(m.logCounterMetric({feature:"sdkChallengeScreenLoaded",resource:"_Count"}),m.publishMetrics(),this.publishLatencyMetrics("GruEventToSdkChallengeScreenRendered",
this.startTimeBeforeGru),this.enableEntryView.call(this)):"AuthenticationSuccess"===b.status?(m.logCounterMetric({feature:"sdkTerminatedWithSuccess",resource:"_Count"}),m.publishMetrics(),this.publishLatencyMetrics("GruEventToSdkAuthNSuccess",this.startTimeBeforeGru),this.messageProcessedContinue("APPROVED",self.showSpinnerPollingForResponseRedirectionTemplate)):"AuthenticationFailure"===b.status?(m.logCounterMetric({feature:"sdkTerminatedWithFailure",resource:"_Count"}),m.publishMetrics(),this.publishLatencyMetrics("GruEventToSdkAuthNFailure",
this.startTimeBeforeGru),this.triggerWidgetActionWithStatus("FAILURE","incorrectPinCode")):"FallbackRequiredError"===b.status&&(m.logCounterMetric({feature:"sdkTriggeredFallback",resource:"_Count"}),m.publishMetrics(),this.triggerAuthenticationFallback())},openInExternalBrowser:function(){var b=this;g.when("mash").execute(function(a){a.openInExternalBrowser({url:b.redirectUrl,successCallback:function(){b.navigateToGateway()},failCallback:function(){b.navigateToGateway()}})})},navigateToGateway:function(){g.when("mash").execute(function(b){b.navstack.begin().replace({url:p.location.origin}).end()})},
submitForm:function(b){var a=f.buildContinueForm(this.httpMethod,this.redirectUrl,this.postData,this.widget.getRootDOMElements().last());b&&a.attr("target",b);this.isSprintWeblabDialedUp?a[0]&&a[0].submit():a.submit()},continueRequest:function(b){this.canUseWebSocket?this.continueRequestWithWebSocket(b):this.continueRequestWithPolling(b)},continueRequestWithWebSocket:function(b){var a=this;b.retryOnFail=!1;var e=new WebSocket(a.wsConnectUrl);e.onopen=function(){p.setTimeout(function(){e.close();b.retryOnFail=
!0;b.retryLimit=1;a.continueRequestWithPolling(b)},a.WEBSOCKET_CONNECTION_LIMIT_IN_MILLIS);a.continueRequestWithPolling(b)};e.onmessage=function(c){e.close();c=JSON.parse(c.data);a.triggerWidgetActionWithStatus(c.executionStatus);if(b.isResponseAsExpectedFn(c))b.onSuccessFn(c)}},continueRequestWithPolling:function(b){var a=this;d.extend(b.inputData,a.browserData);f.continueRequestWithPolling({widget:a.widget,inputData:b.inputData,retryOnFail:b.retryOnFail,isResponseExpectedFn:b.isResponseAsExpectedFn,
onSuccessFn:b.onSuccessFn,retryFailedFn:function(){a.enableMfaSyncShadow?a.triggerWidgetActionWithStatus("SUCCESS","MfaSyncShadowTimeoutGetRedirectUrl"):a.triggerWidgetActionWithStatus("FAILURE",a.DEFAULT_EXECUTION_PENDING_REASON);b.inputData.hasOwnProperty("ppw-widgetEvent")&&(m.logCounterMetric({feature:b.inputData["ppw-widgetEvent"]+"Timeout",resource:"_Count"}),m.publishMetrics())},onErrorFn:b.onErrorFn||d.proxy(a.triggerFailureWidgetAction,a),retryLimit:b.retryLimit,retryDelayFn:b.retryDelayFn})},
messageProcessedContinue:function(b,a){var e;this.pollingForResponseTimeout&&(e=this.handleTimeout("FAILURE",this.DEFAULT_EXECUTION_PENDING_REASON,this.pollingForResponseTimeout));this.customerAbandonedTimeoutId&&p.clearTimeout(this.customerAbandonedTimeoutId);this.isSafeTrue(a)&&(h.hideElement(this.getDOMElement("pmts-executions-entry-view-section")),h.hideElement(this.getDOMElement("pmts-executions-async-spinner-polling-for-action")),h.showElement(this.getDOMElement("pmts-executions-async-spinner-polling-for-response")));
this.continueRequest({inputData:{"ppw-widgetEvent":"MessageProcessedEvent","ppw-widgetState":this.widgetStateFromJsData,"ppw-messageProcessedResponse":b},isResponseAsExpectedFn:function(b){return b.executionStatus},onSuccessFn:function(){e&&p.clearTimeout(e)},retryLimit:this.executionStatusPollingLimit})},skipRedirection:function(b){this.isSafeTrue(b)&&h.hideElement(this.getDOMElement("pmts-executions-async-spinner-polling-for-action"));this.messageProcessedContinue("APPROVED",b)},handleTimeout:function(b,
a,e){var c=this;m.logCounterMetric({feature:"PollingThirdPartyResponseTimeout",resource:"_Count"});m.publishMetrics();return p.setTimeout(function(){c.triggerWidgetActionWithStatus(b,a)},e)},loadModal:function(){var b=this;"mobile"===b.deviceType?g.when("A","a-sheet","ready").execute(function(a,e){a.on("a:sheet:beforeHide:pmts-executions-bottom-sheet",function(a){b.triggerFailureWidgetAction()});b.getDOMElement("pmts-executions-bottom-sheet-trigger").click()}):g.when("A","a-modal","ready").execute(function(a,
e){a.on("a:popover:beforeHide:pmts-executions-popover",function(a){b.triggerFailureWidgetAction()});b.getDOMElement("pmts-executions-modal-trigger").click()})},triggerFailureWidgetAction:function(){this.triggerWidgetActionWithStatus("FAILURE")},triggerWidgetActionWithStatus:function(b,a){this.widget.widgetAction({widgetActionType:"execution",widgetAction:"result-received",executionStatus:b,reason:a})},_isTerminalStatus:function(b){return b&&-1!==["FAILURE","SUCCESS"].indexOf(b.toUpperCase())},isSafeTrue:function(b){return k.isDefined(b)&&
"true"===b.toString()},publishLatencyMetrics:function(b,a){a?m.logLatencyMetric({feature:b,resource:"_Latency",startTime:a}):m.logCounterMetric({feature:b+"_StartTimeNull",resource:"_Count"});m.publishMetrics()}})});l("ExecutionsWidgetUtils",["jQuery","lang"],function(c,d){var f={POLLING_FOR_ACTION_VIEW_EVENT:"pollingForActionViewEvent",POLLING_FOR_RESPONSE_VIEW_EVENT:"pollingForResponseViewEvent",ENTRY_VIEW_EVENT:"entryViewEvent",continueRequestWithPolling:function(c){this.widget=c.widget;this.inputData=
c.inputData;this.onErrorFn=c.onErrorFn||d.NOOP;this.onSuccessFn=c.onSuccessFn||d.NOOP;this.isResponseExpectedFn=c.isResponseExpectedFn||function(){return!0};this.retryFailedFn=c.retryFailedFn||c.onErrorFn;this.retryLimit=isNaN(c.retryLimit)?15:c.retryLimit;this.retryDelayFn=c.retryDelayFn||function(){return 1E3};this.retryOnFail=c.retryOnFail!==r?c.retryOnFail:!0;this.continueRequest(0)},continueRequest:function(c){var g=this;g.widget.continueRequest(g.inputData,{headers:{"executions-widget-ajax-continue-attempt-count":c},
retryDelayFn:g.retryDelayFn,success:function(a){var d=a.additionalWidgetResponseData.additionalData;if(g.isResponseExpectedFn(d))g.onSuccessFn(d);else g.retryOnFail&&(c<g.retryLimit?p.setTimeout(function(){var k=a.additionalWidgetResponseData.additionalData.widgetState;k&&(g.inputData["ppw-widgetState"]=k);g.continueRequest(++c)},g.retryDelayFn(c)):g.retryFailedFn(a))},error:g.onErrorFn})},addHostedContinueWidgetHandler:function(c,g,a,d,k){c.widget.on("componentsInitialized",c,function(){a(function(a){p.frameElement&&
p.frameElement.name===g?(p.parent.PaymentsPortal2.modules.when(["global-event-bus"],function(b){b.trigger("thirdPartyResponseStatusEvent",{status:a})}),p.parent.PaymentsPortal2.modules.when(["events"],function(b){b.trigger("thirdPartyResponseStatusEvent",{status:a})})):d(a)})});p.PaymentsPortal2.modules.when(["global-event-bus"],function(a){a.on("thirdPartyResponseStatusEvent",c,function(b){k(b.status)})})},dynamicContinueWithEvent:function(f,g,a,m,k,e){var b=this,n=c("\x3cform\x3e").attr({method:e?
e:"get",action:m.action,id:"pmts-dynamic-continue"});a.push({name:"ppw-widgetEvent",value:f},{name:"ppw-widgetState",value:g});d.forEach(m.inputs,function(b){a.push({name:b.name,value:b.value[0]})});d.forEach(a,function(a){n.append(b.buildHiddenInput(a.name,a.value))});k.append(n);n.submit()},buildContinueForm:function(d,g,a,m){d=c("\x3cform\x3e").attr({method:d,action:g,id:"pmts-form-continue"});for(var k in a)d.append(f.buildHiddenInput(k,a[k]));m.append(d);return d},buildHiddenInput:function(d,
g){return c("\x3cinput\x3e").attr({type:"hidden",name:d,value:g})}};return f});l("components/AuthorizePaymentMethodComponent",["ExecutionsComponent"],function(c){return c.extend({initialize:function(c,f){this.DEFAULT_EXECUTION_PENDING_REASON=f.data.defaultExecutionPendingReason;this.POLLING_RETRY_DELAY=f.data.pollingRetryDelay}})});l("components/AuthorizePaymentsComponent",["ExecutionsComponent"],function(c){return c});l("components/ChargeComponent",["PollingComponent"],function(c){return c});l("components/MfaComponent",
["ExecutionsComponent"],function(c){return c});l("PollingComponent",["component","jQuery","ExecutionsWidgetUtils"],function(c,d,f){var h=["APPROVED","FAILURE"];return c.extend({initialize:function(c,a){this.widgetStateFromJsData=c.options.serializedState;this.executionStatus=a.data.executionStatus;this.dynamicContinueFormDescription=a.data.dynamicContinueFormDescription;this.pollingForResponseTimeout=a.data.pollingForResponseTimeout||15E3},bindToEvents:function(){var c=this,a=p.setTimeout(function(){c.terminatePolling({executionStatus:"FAILURE",
reason:"timeout"})},c.pollingForResponseTimeout);h.includes(c.executionStatus.toUpperCase())?c.terminatePolling({executionStatus:c.executionStatus,widgetState:c.widgetStateFromJsData}):f.continueRequestWithPolling({widget:c.widget,inputData:{"ppw-widgetState":c.widgetStateFromJsData},isResponseExpectedFn:c.isResponseAsExpectedFn,onSuccessFn:function(d){c.terminatePolling(d,a)},retryFailedFn:function(d){c.terminatePolling(d,a)},onErrorFn:function(d){c.terminatePolling(d,a)},retryLimit:15,retryDelayFn:function(){return 1E3}})},
isResponseAsExpectedFn:function(c){return c.executionStatus&&h.includes(c.executionStatus.toUpperCase())},terminatePolling:function(c,a){a&&p.clearTimeout(a);f.dynamicContinueWithEvent("TerminalStatusEvent",c.widgetState||this.widgetStateFromJsData,[{name:"ppw-terminalState",value:c.executionStatus},{name:"ppw-reason",value:c.reason}],this.dynamicContinueFormDescription,this.widget.getRootDOMElements().last())}})});l("fetch-balance",[],function(){return{fetchBalance:function(c){this.widget=c.widget;
this.instrumentId=c.instrumentId;this.eventName=c.eventName;this.successView=c.successView;this.failureView=c.failureView;this.pendingView=c.pendingView;this.numberOfRetries=c.numberOfRetries||2;this.retryDelayInMs=c.retryDelayInMs||500;this.pendingView();this.fetchBalanceWithRetry(0)},fetchBalanceWithRetry:function(c){var d=this,f={"ppw-widgetEvent":d.eventName,"ppw-instrumentId":d.instrumentId,"ppw-widgetState":d.widget.options.serializedState};c++;d.widget.continueRequest(f,{success:function(f){d.handleSuccess(f,
c)},error:function(){d.failureView()}})},handleSuccess:function(c,d){var f=this,h=c.additionalWidgetResponseData.additionalData;f._balanceStatus=h.balanceStatus;var g=h.fetchedBalance,h=h.fetchedBalanceCurrency;d<f.numberOfRetries?"Success"===f._balanceStatus?f.successView(g,h):p.setTimeout(function(){var a=c.additionalWidgetResponseData.additionalData.widgetState;a&&(f.inputData["ppw-widgetState"]=a);f.fetchBalanceWithRetry(d)},f.retryDelayInMs):"Success"===f._balanceStatus?f.successView(g,h):f.failureView()}}});
l("components/IdentifyCreditCardComponent",["css-utils","component","lang"],function(c,d,f){return d.extend({bindToEvents:function(){if(this.data.enable)this.widget.on("creditCardNumberChanged",this,function(c){c.placementType===this.data.placementType&&this._resetAndValidate(c.creditCardNumber)&&this.widget.continueRequest({addCreditCardNumber:c.creditCardNumber,"ppw-widgetEvent":"IdentifyCreditCardEvent","ppw-widgetState":this.widget.options.serializedState},{success:f.bind(function(c){c=c.additionalWidgetResponseData.additionalData;
c.issuerImage&&c.issuerDisplayName&&(this.data.renderImagePlaceholder&&this._setAndShowIssuerLogo(c.issuerImage,c.issuerDisplayName),this.widget.trigger("creditCardIssuerDetermined",c));c.cardType&&"true"===c.debitCardWarningEnabled&&this.widget.trigger("cardTypeDetermined",c.cardType)},this),error:f.bind(function(c){this._hideIssuerLogo()},this)})})},_resetAndValidate:function(c){this._hideIssuerLogo();this.widget.trigger("creditCardNumberReset");return!!c},_setAndShowIssuerLogo:function(d,g){this.getDOMElement("addCCIssuerLogo").attr({src:d,
alt:g});c.showElement(this.getDOMElement("addCCIssuerLogo"))},_hideIssuerLogo:function(){c.hideElement(this.getDOMElement("addCCIssuerLogo"))}})});l("components/InlineContinueButtonComponent",["components/ContinueButtonComponent","tooltip"],function(c,d){return c.extend({initialize:function(c,h){this.popover=new d(this.getDOMElement("continue-button"),{position:"triggerTop",closeButton:!1},{position:"triggerTop"})}})});l("components/ManageBackupPaymentMethodsComponent",["component","css-utils","lang"],
function(c,d,f){return c.extend({initialize:function(c,g){d.showElement(this.getDOMElement("pmts-bpm-toggle"));d.hideElement(this.getDOMElement("pmts-bpm-nonjs-button"))},bindToElements:function(){var c=this;c.widget.onAui("a:switch:pmts-bpm-toggle:flip",function(d){c.getDOMElement("pmts-bpm-form").append("\x3cinput name\x3dppw-widgetEvent value\x3dUpdateBPMAccountLevelPreferenceEvent type\x3dhidden /\x3e").append("\x3cinput name\x3dppw-isBackupPaymentMethodEnabled value\x3d"+d.switchState.isOn.toString()+
" type\x3dhidden /\x3e").submit();c.widget.publishSuccessSushiMetrics({ActionType:"ToggleManageBackupPaymentMethods",ActionValueType:"EnableBPM",ActionValue:d.switchState.isOn.toString()})})}})});l("components/ManageOneClickComponent",["component","mash-helper","mixins/secure-container-support"],function(c,d,f){return c.extend(f,{initialize:function(c,g){this._isRequestForMobileApp=g.data.isRequestForMobileApp;this._securePaymentMethodAddedEvent=g.data.securePaymentMethodAddedEvent;this._dynamicContinueEnabled=
g.data.dynamicContinueEnabled;var a=this;a._isRequestForMobileApp&&(d.addEventListener(a._securePaymentMethodAddedEvent,function(c){a._addEventListenerOneClickHandler(c)}),d.setBookmark("oneclick-widget"))},_addEventListenerOneClickHandler:function(c){this._dynamicContinueEnabled?this.addPaymentMethodRefreshContinue(c.detail.paymentInstrumentId,c.detail.widgetAction):this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"AddPaymentMethodRefreshEvent",
"ppw-paymentMethodId":c.detail.paymentInstrumentId,"ppw-widgetAction":c.detail.widgetAction});d.backToBookmark("oneclick-widget")}})});l("components/ManageAllDevicesComponent",["component"],function(c){return c.extend({initialize:function(c,f){this.browserUbid=f.data.browserUbid},bindToElements:function(){var c=this;this.widget.onAui("a:switch:pmts-toggle-this-browser:flip",function(f){c.widget.submitFormAJAX({"ppw-ubid":c.browserUbid,"ppw-isOneClickEnabled":f.switchState.isOn.toString(),"ppw-widgetEvent":"UpdateBrowserOneClickStatusEvent",
"ppw-widgetState":c.widget.options.serializedState})})}})});l("components/ManageOneClickDevicesComponent",["component","css-utils","lang","jQuery"],function(c,d,f,h){return c.extend({bindToEvents:function(){this.getDOMElementsByPrefix("JsBindingTurnOffButton-").click(f.bind(this._turnOffButtonClicked,this))},_turnOffButtonClicked:function(c){var a=this,f=h(c.currentTarget).find("input"),k=f.data("ubid"),f=f.data("device-name");c.preventDefault();this.widget.submitFormAJAX({"ppw-ubid":k,"ppw-deviceName":f,
"ppw-widgetEvent":"DisableDeviceEvent","ppw-widgetState":a.widget.options.serializedState},{success:function(c){var b=c.additionalWidgetResponseData.additionalData;b&&c.additionalWidgetResponseData.additionalData.disabledDeviceUbid&&(c=a.getDOMElement("JsBindingTurnOffButton-".concat(b.disabledDeviceUbid)),b=a.getDOMElement("JsBindingDisabledUnit-".concat(b.disabledDeviceUbid)),d.hideElement(c),d.showElement(b))}})}})});l("components/OneClickListItemComponent",["component","jQuery"],function(c,d){return c.extend({initialize:function(c,
d){},bindToElements:function(){var c=this,d=c.getDOMElement("oneClickDropDownFormAddressId"),g=c.getDOMElement("pmts-change-dropdown-status-text");d.bind("change",function(){g&&(this.checked?g.removeClass("a-color-tertiary"):g.addClass("a-color-tertiary"));c.widget.continueRequest({"ppw-widgetEvent":"UpdateOneClickEnabledEvent","ppw-addressId":this.value,"ppw-isEnabled":this.checked.toString(),"ppw-widgetState":c.getWidgetState("oneClickDropDownFormAddressId")},{success:c.widget.createAjaxContinueSuccessHandler()})})}})});
l("events/ManagePaymentMethodsEvent",["public-event-registry"],function(c){c.register("ManagePaymentMethodsEvent");return"ManagePaymentMethodsEvent"});l("components/ManagePaymentMethodsComponent","workflow-component events/ManagePaymentMethodsEvent AddPaymentMethodTouchLinkSupport AUI!P mash-helper mixins/secure-container-support css-utils jQuery clog lang".split(" "),function(c,d,f,h,g,a,m,k,e,b){return c.extend(f,a,{initialize:function(b,a){this._isRequestForMobileApp=a.data.isRequestForMobileApp;
this._securePaymentMethodAddedEvent=a.data.securePaymentMethodAddedEvent;this._dynamicContinueEnabled=a.data.dynamicContinueEnabled;this._bulkRemovalFeatureEnabled=a.data.bulkRemovalFeatureEnabled;this._currentCardsSizeInInstrumentList=a.data.currentCardsSizeInInstrumentList;this._bulkRemovalUpperLimitSize=a.data.bulkRemovalUpperLimitSize;var c=this;c._isRequestForMobileApp&&(g.addEventListener(c._securePaymentMethodAddedEvent,function(b){c._addEventListenerMPMHandler(b)}),g.setBookmark("mpo-widget"))},
_addEventListenerMPMHandler:function(b){this._dynamicContinueEnabled?this.addPaymentMethodRefreshContinue(b.detail.paymentInstrumentId,b.detail.widgetAction):this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"AddPaymentMethodRefreshEvent","ppw-paymentMethodId":b.detail.paymentInstrumentId,"ppw-widgetAction":b.detail.widgetAction});g.backToBookmark("mpo-widget")},_addEventListenerBulkSelectCheckbox:function(b,a){var c=0;k.each(b,function(b,a){a.checked&&
c++});c===this._bulkRemovalUpperLimitSize&&a.currentTarget.checked&&k.each(b,function(b,a){a.checked||(a.disabled=!0)});c!==this._bulkRemovalUpperLimitSize-1||a.currentTarget.checked||k.each(b,function(b,a){a.checked||(a.disabled=!1)})},bindToEvents:function(){var a=this;c.prototype.bindToEvents.apply(this);if(a._bulkRemovalFeatureEnabled){var q=k("div.apx-mpo-bulk-removal-checkbox input[name*\x3d'bulkremovalselectedcheckbox']");0===q.length&&0<a._currentCardsSizeInInstrumentList&&(e.logCounterMetric({feature:"QueryBulkRemovalCheckboxesFailed",
resource:"_Count"}),e.publishMetrics());k.each(q,function(c,e){b.addEventListener(e,"click",function(b){a._addEventListenerBulkSelectCheckbox(q,b)})});a.getDOMElement("apx-mpo-bulk-removal-select-top-cards-event").bind("click",function(b){b.preventDefault();k.each(q,function(b,c){!c.checked&&!c.disabled&&b<a._bulkRemovalUpperLimitSize&&c.click()});m.hideElement(a.getDOMElement("apx-mpo-bulk-removal-select-top-cards-event"));m.showElement(a.getDOMElement("apx-mpo-bulk-removal-remove-top-top-event"))});
a.getDOMElement("apx-mpo-bulk-removal-remove-top-top-event").bind("click",function(b){b.preventDefault();k.each(q,function(b,a){a.checked&&a.click()});m.showElement(a.getDOMElement("apx-mpo-bulk-removal-select-top-cards-event"));m.hideElement(a.getDOMElement("apx-mpo-bulk-removal-remove-top-top-event"))});a.getDOMElement("apx-mpo-bulk-removal-submit-event").bind("click",function(b){var a=!0;k.each(q,function(b,c){c.checked&&(a=!1)});a&&b.preventDefault()})}if(null!=this.data.paymentMethodsManagementData)this.widget.on("componentsInitialized",
this,function(){a.widget.trigger(d,a.data.paymentMethodsManagementData)})},bindToElements:function(){f.bindToElements.apply(this)}})});l("components/CBCCRegistrationComponent",["component","server","AUI!P","lang"],function(c,d,f,h){return c.extend({handleApxClaimOwnershipLink:function(c){this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"StartClaimOwnershipEvent","ppw-instrumentId":c})},bindToEvents:function(){var c=this,a=c.data.instrumentId;c.getDOMElement("pmts-CBCCAPXClaimOwnership-link-id").bind("click",
function(d){c.handleApxClaimOwnershipLink(a)})}})});l("components/EditInstrumentComponent",["modal-popover","component","lang"],function(c,d,f){return d.extend({initialize:function(d,g){g.data.shouldRenderInPopover&&(this.popover=new c(d,g,this))},bindToEvents:function(){this.widget.on("mpo-edit-popover-closed",this,function(c){this.getDOMElement("pmts-mpo-js-edit-popover-cancel-form").submit()})}})});l("events/DeleteDisabledInfoLinkClickedEvent",[],function(){return"DeleteDisabledInfoLinkClicked"});
l("components/InstrumentListComponent",["component","lang"],function(c,d){return c.extend({})});l("components/InstrumentListItemComponent",["events/DeleteDisabledInfoLinkClickedEvent","public-event-registry","component","lang","metrics-helper"],function(c,d,f,h,g){return f.extend({initialize:function(a,g){d.register(c)},_triggerDeleteDisabledInfoLinkClickedEvent:function(){this.widget.trigger(c)},bindToElements:function(){var a=this,c=this.getDOMElement("deleteDisabledInfoLink");g.publishOnClickSuccessSushiMetrics(a,
[{JsBindElementId:"gc-reload-link",MetricsObject:{ActionType:"GCReloadLink"}},{JsBindElementId:"gc-redeem-link",MetricsObject:{ActionType:"GCRedeemLink"}}]);c&&c.click(h.bind(this._triggerDeleteDisabledInfoLinkClickedEvent,this));a.getDOMElement("ZipBalanceMPORefresh").find(".pmts-zip-balance-mpo-refresh-link").click(function(){a.widget.trigger("ZipBalanceMPORefresh")})},bindToEvents:function(){var a=this;a.widget.on("ZipBalanceMPORefresh",a,function(c){a.widget.submitFormAJAX({"ppw-widgetState":a.widget.options.serializedState,
"ppw-widgetEvent":"ZipBalanceMPORefreshEvent"})})}})});l("components/ViewMandateComponent",["modal-popover","component"],function(c,d){return d.extend({initialize:function(d,h){h.data.shouldRenderInPopover&&(this.popover=new c(d,h,this))},bindToEvents:function(){this.widget.on("dd-mandate-popover-closed",this,function(c){this.getDOMElement("js-mandate-popover-cancel").submit()})}})});l("events/MPCIntegrationCompletedEvent",["public-event-registry"],function(c){c.register("MPCIntegrationCompletedEvent");
return"MPCIntegrationCompletedEvent"});l("events/MPCIntegrationInitializedEvent",["public-event-registry"],function(c){c.register("MPCIntegrationInitializedEvent");return"MPCIntegrationInitializedEvent"});l("components/MobilePhoneCollectionComponent","css-utils jQuery component events/MPCIntegrationCompletedEvent events/MPCIntegrationInitializedEvent lang AUI!P clog aui-helper".split(" "),function(c,d,f,h,g,a,m,k,e){return f.extend({_integrationType:r,_mpcCVF:r,$mpcCVFContainer:null,$mpcContainer:null,
$mpcCVFVerificationResultsContainer:null,$mpcErrorSection:null,$mpcTouchlink:null,$mpcPromptTitle:null,$mpcSkipTouchlink:null,$isClosedBySkip:!1,initialize:function(b,a){this.$mpcCVFContainer=this.getDOMElement("mpc-cvf-container");this.$mpcCVFVerificationResultsContainer=this.getDOMElement("mpc-cvf-results-container");this.$mpcErrorSection=this.getDOMElement("mpc-error-section");this.$mpcTouchlink=this.getDOMElement("mpc-touchlink");this.$mpcPromptTitle=this.getDOMElement("mpc-link-prompt-title");
this.$mpcSkipTouchlink=this.getDOMElement("mpc-skip-touchlink");this._integrationType=a.data.integType;this._popoverAction=this.getDOMElement("collect-new-mobile-declarative-action").data("action");this._popoverActionId=this.getDOMElement("collect-new-mobile-declarative-action").attr("id");this._initializedTime=(new Date).getTime();"cc_nudge"!==this._integrationType&&"cc_integ"!==this._integrationType&&"pi_nudge"!==this._integrationType||this.startMobilePhoneCollectionCVFWidget()},getCvfCurrentState:function(){var b,
a;if(this.$mpcCVFContainer)b=this.$mpcCVFContainer.find("[name\x3d'cvf_phone_num']"),a=this.$mpcCVFContainer.find("[name\x3d'code']");else return"Init";return b&&b[0]&&(b[0].value||""===b[0].value)?"OnPhoneNum":a&&a[0]&&(a[0].value||""===a[0].value)?"OnOtp":"Unknown"},publishCvfExitMetric:function(b,a){switch(a){case "OnPhoneNum":k.logCounterMetric({feature:b+a+"."+this._integrationType,resource:"_Count"});break;case "OnOtp":k.logCounterMetric({feature:b+a+"."+this._integrationType,resource:"_Count"});
break;case "Unknown":k.logCounterMetric({feature:b+"Unknown."+this._integrationType,resource:"_Count"})}k.publishMetrics()},bindToElements:function(){var b=this;this.getDOMElement("mpc-close-button").click(function(){b.widget.trigger(h,{integType:b._integrationType})});this.getDOMElement("mpc-touchlink").click(function(){k.logCounterMetric({feature:"MpcPromptClicked."+b._integrationType,resource:"_Count"});b._initializedTime&&k.logLatencyMetric({feature:"MpcInitializationTilClickSpan."+b._integrationType,
resource:"_Latency",startTime:b._initializedTime});k.publishMetrics()});this.$mpcSkipTouchlink.click(function(){b.$isClosedBySkip=!0;b.publishCvfExitMetric("MpcCollectionSkipped.",b.getCvfCurrentState());b.widget.trigger(h,{integType:b._integrationType})})},bindToEvents:function(){var b=this;m.when("A","a-popover","ready").execute(function(a,c){a.on("a:popover:afterHide:collect-new-mobile-popover",function(){!1===b.$isClosedBySkip&&b.publishCvfExitMetric("MpcCollectionAbandoned.",b.getCvfCurrentState())})});
this.widget.on(g,this,function(a){"pi_nudge"!==b._integrationType&&"cc_nudge"!==b._integrationType||c.showElement(b.getDOMElement("mpc-touchlink"))});this.widget.on(h,this,function(){b.togglePopover(!1)})},togglePopover:function(b){var a=this;this._popoverAction&&m.when(this._popoverAction,"jQuery","ready").execute(function(c,e){(c=c.get(e("#"+a._popoverActionId)))&&(b?c.show():c.hide())})},onMobilePhoneCollectionOTPVerificationSuccess:function(b){k.logCounterMetric({feature:"MpcCollectionCompleted."+
this._integrationType,resource:"_Count"});k.publishMetrics();this.widget.trigger(h,{integType:this._integrationType});if("pi_nudge"===this._integrationType||"cc_nudge"===this._integrationType)c.hideElement(this.$mpcTouchlink),c.hideElement(this.$mpcPromptTitle)},onMobilePhoneCollectionOTPVerificationFailed:function(b){c.hideElement(this.$mpcCVFContainer);c.showElement(this.$mpcCVFVerificationResultsContainer);b&&this.$mpcErrorSection.find(".a-alert-content").text(b)},startMobilePhoneCollectionCVFWidget:function(){var b=
this;m.when("cvf","ready").execute(function(c){b._mpcCVF=c.create({target:b.$mpcCVFContainer,requestToken:b.data.requestToken,onSuccess:a.bind(b.onMobilePhoneCollectionOTPVerificationSuccess,b),onError:a.bind(b.onMobilePhoneCollectionOTPVerificationFailed,b),autoStart:!1});b._mpcCVF&&(b.widget.trigger(g,{integType:b._integrationType,initializedTime:b._initializedTime,mpcPopoverAction:b._popoverAction,mpcPopoverActionId:b._popoverActionId}),b._mpcCVF.start())})}})});l("components/OrderSummaryComponent",
["component","lang","css-utils"],function(c,d,f){var h=!1;return c.extend({initialize:function(c,a){h=a.data.isDynamicOrderSummaryEnabled},bindToEvents:function(){var c=this;this.widget.on("installmentOptionChanged",this,function(a){var d=c.getDOMElement("installmentSectionTitle"),k=c.getDOMElement("installmentSectionBreakdown");a&&a.summaryDisplay?(k.html(a.summaryDisplay),a=c.widget.getLocalizedString("apx_order_summary_installments_title"),d.html(a),f.showElement(d),f.showElement(k)):(d.html(""),
k.html(""),f.hideElement(d),f.hideElement(k))})},bindToElements:function(){this.getDOMElement("apx-order-summary-view-details").click(d.bind(this._handleOrderSummaryUpdate,this));this.getDOMElement("apx-order-summary-api-error-retry-button").click(d.bind(this._handleOrderSummaryUpdate,this))},_handleOrderSummaryUpdate:function(c){var a=this,d=a.getDOMElement("apx-order-summary-content"),k=a.getDOMElement("apx-order-summary-spinner"),e=a.getDOMElement("apx-order-summary-grand-total-section"),b=a.getDOMElement("apx-order-summary-api-error");
h&&(f.toggleElement(k,!0),f.toggleElement(d,!1),f.toggleElement(e,!1),f.toggleElement(b,!1),a.widget.continueRequest({"ppw-widgetState":a.widget.options.serializedState,"ppw-widgetEvent":"FetchOrderSummaryDataEvent"},{success:function(c){try{var q=JSON.parse(c.additionalWidgetResponseData.additionalData.subtotals),g=JSON.parse(c.additionalWidgetResponseData.additionalData.grandTotal),h=a.getDOMElement("apx-order-summary-subtotal-template").clone(!0);d.html(h);for(var t in q){var l=q[t].subTotalInfo.stringId,
u=h.clone(!0).attr("id",l),p=u.find(".apx-subtotal-label-text"),w=u.find(".apx-subtotal-amount-value");p.html(a.widget.getLocalizedString(l));"INR"===q[t].subTotalInfo.currency.unit?(f.toggleElement(u.find(".inr-currency-symbol"),!0),w.html(q[t].subTotalInfo.currency.value)):w.html(q[t].subTotalInfo.currency.displayString);f.toggleElement(u,!0);d.append(u)}var E=g.grandTotalInfo.stringId;a.getDOMElement(E+"_label").innerHTML=a.widget.getLocalizedString(E);"INR"===g.grandTotalInfo.currency.unit?(a.getDOMElement(E+
"_amount").innerHTML=g.grandTotalInfo.currency.value,a.getDOMElement("displayedOrderTotalAmount_amount").innerHTML=g.grandTotalInfo.currency.value):(a.getDOMElement(E+"_amount").innerHTML=g.grandTotalInfo.currency.displayString,a.getDOMElement("displayedOrderTotalAmount_amount").innerHTML=g.grandTotalInfo.currency.displayString);f.toggleElement(d,!0);f.toggleElement(e,!0);f.toggleElement(b,!1);f.toggleElement(k,!1)}catch(A){f.toggleElement(k,!1),f.toggleElement(b,!0),f.toggleElement(k,!1)}},error:function(){f.toggleElement(k,
!1);f.toggleElement(b,!0)}}))}})});l("components/PayerComponent",["events/form-submitted-event","form-component","lang","jQuery","css-utils"],function(c,d,f,h,g){return d.extend({formatDayAndMonth:function(a){return a&&1===a.length?"0"+a:a},populateBirthDate:function(){var a=this.formatDayAndMonth(h("[name\x3d'ppw-birthDateDay']").val()),c=this.formatDayAndMonth(h("[name\x3d'ppw-birthDateMonth']").val()),k=h("[name\x3d'ppw-birthDateYear']").val();a&&c&&k&&(a=k+"-"+c+"-"+a,h("[name\x3d'ppw-birthDate']").val(a))},
initialize:function(a,c){this._action=c.data.action},bindToElements:function(){var a=this;h("[name\x3d'ppw-birthDateDay']").change(function(){a.populateBirthDate()});h("[name\x3d'ppw-birthDateMonth']").change(function(){a.populateBirthDate()});h("[name\x3d'ppw-birthDateYear']").change(function(){a.populateBirthDate()});this.getDOMElement("pmts-payer-continue-button").click(f.bind(this._handleFormSubmission,this))},bindToEvents:function(){var a=this;this.widget.on(c,a,function(c){c.action===a._action&&
a.getDOMElement("pmts-payer-form").submit()})},_handleFormSubmission:function(a){if(0===this.form.validateForm().length){var d=this.getFormSubmissionParameters("pmts-payer-form-container");this.widget.trigger(c,{queryParameters:this.data.queryParams,submissionParameters:d,event:a,action:this._action})}else a.preventDefault()}})});l("components/PaymentInstrumentComponent",["component"],function(c){return c.extend({_getChangePaymentInstrument:function(){return this.getDOMElement("pmtsChangePaymentInstrument")},
_makeTransition:function(c){p.location=c},bindToElements:function(){var c=this,f=c._getChangePaymentInstrument();0<f.length&&f.click(function(){c.widget.trigger("ChangePaymentInstrumentRequested");return!1})},bindToEvents:function(){var c=this;c.widget.on("ChangePaymentInstrumentRequested",c,function(f){f=c._getChangePaymentInstrument().attr("href");c._makeTransition(f)})}})});l("components/PaymentLocationBaseWorkflowComponent",["component"],function(c){return c});l("components/PaymentMethodConsentWorkflowComponent",
["component"],function(c){return c});l("components/PaymentMethodStorageBlanketConsentComponent",["component","css-utils","jQuery","lang","clog"],function(c,d,f,h,g){return c.extend({bindToEvents:function(){f(".apx-mobile-storage-consent-blanket-view-learn-more-css-class").bind("click",function(){g.logCounterMetric({feature:"PaymentMethodStorageBlanketConsent.LearnMoreLinkClicked",resource:"_Count"});g.publishMetrics()})}})});l("components/PaymentMethodStorageSelectiveConsentComponent",["component",
"css-utils","jQuery","lang","clog"],function(c,d,f,h,g){return c.extend({bindToEvents:function(){var a=f("div.apx-pmts-storageconsent-checkbox input[name*\x3d'selectedcheckbox']");this.getDOMElement("payment-method-selective-consent-select-all-preferences").bind("click",function(c){c.preventDefault();f.each(a,function(a,c){c.checked||c.click()});g.logCounterMetric({feature:"PaymentMethodStorageSelectiveConsent.SelectAllClicked",resource:"_Count"});g.publishMetrics()});f(".apx-mobile-storage-consent-selective-view-learn-more-css-class").bind("click",
function(){g.logCounterMetric({feature:"PaymentMethodStorageSelectiveConsent.LearnMoreLinkClicked",resource:"_Count"});g.publishMetrics()})}})});l("components/PaymentStoreLocationComponent",["component","lang"],function(c,d){return c.extend({initialize:function(c,d){this._storeLinkWidgetEventName=d.data.storeLinkWidgetEventName;this._redirectUrl=d.data.redirectUrl;this._storeLocationId=d.data.storeLocationId},bindToElements:function(){this.getDOMElement("pmts-payments-store-link-"+this._storeLocationId).click(d.bind(this._onLinkClick,
this))},_onLinkClick:function(){this._storeLinkWidgetEventName?this.widget.trigger(this._storeLinkWidgetEventName,{redirectUrl:this._redirectUrl}):this.getCurrentLocation().href=this._redirectUrl},getCurrentLocation:function(){return p&&p.location}})});l("components/ViewMandatePayNowComponent",["component"],function(c){return c.extend({})});l("components/PointsAccountComponent",["css-utils","jQuery","form-component","lang"],function(c,d,f,h){return f.extend({pointsField:"points",initialize:function(d,
a){this._isDisplayingSubmitButton=!c.hasAUIHiddenClass(this.getDOMElement("pointsAccountSubmitButton"))&&c.hasAUIHiddenClass(this.getDOMElement("pointsAccountAppliedMessage"))},_validationToErrorMap:{IsNumberFieldConstraint:"pointsAccountErrorInvalidFormat",LessThanEqualFieldConstraint:"pointsAccountErrorGreaterThanEligible",GreaterThanEqualFieldConstraint:"pointsAccountErrorLessThanZero"},_getErrorMessageContainer:function(){return this.getDOMElement("errorMessages")},_resetFormErrorMessages:function(){var g=
this;c.hideElement(g._getErrorMessageContainer());c.hideElement(d(".pmts-points-account-server-message"));h.forEachKeyValue(g._validationToErrorMap,function(a,c){g.form.resetErrorMessage(g.pointsField,g.getDOMElement(c))},g)},_displayFormErrorMessages:function(d){0!==d.length&&(d=d[0],d.field===this.pointsField&&(d=this.getDOMElement(this._validationToErrorMap[d.validation]),this.form.displayErrorMessage(this.pointsField,d)),c.showElement(this._getErrorMessageContainer()))},_handlePointsAccountDOMEvent:function(){this._resetFormErrorMessages();
var c=this.form.validateForm();0===c.length?this.widget.trigger("PointsAccountSubmitted",{points:this.getDOMElement(this.pointsField).val(),submissionParameters:this.getDOMElement("pointsAccountSubmitButton").closest("form").serializeArray()}):this._displayFormErrorMessages(c);return!1},bindToElements:function(){var d=this;d.bindFormSubmissionHandler("pointsAccountSubmitButton",d.pointsField,d._handlePointsAccountDOMEvent);d.getDOMElement(d.pointsField).bind("change keyup",function(a){d._isDisplayingSubmitButton||
(c.hideElement(d.getDOMElement("pointsAccountAppliedMessage")),c.showElement(d.getDOMElement("pointsAccountSubmitButton")))})},bindToEvents:function(){var c=this;c.widget.on("PointsAccountSubmitted",c,function(a){d(c.getDOMElement("pointsAccountSubmitButton")).closest("form").submit()})}})});l("components/GenerateQrCodeComponent","component css-utils lang clog ExecutionsWidgetUtils events/QrCodeGeneratedEvent count-down-timer-helper".split(" "),function(c,d,f,h,g,a,m){return c.extend({initialize:function(a,
c){this.countdownTimerIntervalId=0;this.dynamicContinueFormDescription=c.data.dynamicContinueFormDescription;this.executionStatusPollingRetryLimit=parseInt(c.data.executionStatusPollingRetryLimit,10);this.pollingRetryDelay=parseInt(c.data.pollingRetryDelay,10);this.executionMetricsPrefix=c.data.executionMetricsPrefix;this.cancelTransactionEventEnabled=c.data.cancelTransactionEventEnabled},bindToEvents:function(){var c=this;this.widget.on("componentsInitialized",this,function(){d.showElement(c.getDOMElement("pmts-executions-async-spinner-polling-for-action"));
c.GENERATE_QR_CODE_START_TIME=(new Date).getTime();g.continueRequestWithPolling({widget:c.widget,inputData:{"ppw-widgetEvent":"GenerateQrCodeEvent","ppw-widgetState":c.widget.options.serializedState,"ppw-javaEnabled":p&&p.navigator&&p.navigator.javaEnabled(),"ppw-language":p&&p.navigator&&p.navigator.language,"ppw-screenColorDepth":p&&p.screen&&p.screen.colorDepth,"ppw-screenHeight":p&&p.screen&&p.screen.height,"ppw-screenWidth":p&&p.screen&&p.screen.width,"ppw-timeZone":(new Date).getTimezoneOffset()},
isResponseExpectedFn:function(a){return a.qrCodeUrl!==r||a.qrCodeImageBase64String!==r},onSuccessFn:function(e){c.widget.trigger(a);d.hideElement(c.getDOMElement("pmts-executions-async-spinner-polling-for-action"));c._publishLatencyMetric("GenerateQrCodePollingTime",c.GENERATE_QR_CODE_START_TIME);var b=c.getDOMElement("qr-code-text-copy-button");b&&d.showElement(b);e.qrCodeImageBase64String!==r&&(b=c.getDOMElement("qrCode-image"),b.attr("src","data:image/png;base64,"+e.qrCodeImageBase64String),d.showElement(b),
b=c.getDOMElement("qrCode-image-container"),d.showElement(b));if("CustomerPaymentReference"==e.category)c._hydrateCustomerPaymentReferenceFields(e);else{(b=c.getDOMElement("apx-qrcodeurl-text-display"))&&e.qrCodeUrl?b.val(e.qrCodeUrl):b&&e.customerPaymentReference&&b.val(e.customerPaymentReference);if(b=c.getDOMElement("qrCode-wallet-payment-link"))b.attr("href",e.qrCodeUrl),d.showElement(b);d.showElement(c.getDOMElement("qrCode-cancel-container"));e.expirationTimeInMillis!==r&&(e=parseInt(e.expirationTimeInMillis,
10),c.countdownTimerIntervalId=m.startCountDownTimer(c,e,c._triggerUpdateCountDownTimer,c._triggerTerminalEventOnCountDownTimerExpiry),e=c.getDOMElement("qrCode-count-down-timer-container"),d.showElement(e),c._publishCounterMetric("QrCodeCountDownTimerRenderedCount"));c.CONFIRM_QR_CODE_START_TIME=(new Date).getTime();p.setTimeout(f.bind(c._pollForFundingSourceStatus,c),1E4)}},retryFailedFn:function(){c._fireWidgetCompletedEvent("GenerateQrCodeUrlRetriesExhausted")},retryLimit:15})})},bindToElements:function(){var a=
this;this.getDOMElement("qr-code-text-copy-button").click(function(){var c=a.getDOMElement("apx-qrcodeurl-text-display"),b=c.val();1!=a.getDOMElement("qrCode-cpr-qr-base-64-text").length||"undefined"!==typeof b&&""!==b||(c=a.getDOMElement("qrCode-cpr-qr-base-64-text"),b=c.text());c.select();p&&p.navigator&&p.navigator.clipboard.writeText(b)});this.getDOMElement("qrCode-cancel-button").click(f.bind(a._fireWidgetCompletedEvent,a,"CustomerCancelledTransaction"))},_pollForFundingSourceStatus:function(){var a=
this;g.continueRequestWithPolling({widget:a.widget,inputData:{"ppw-widgetEvent":"ConfirmQrCodeEvent","ppw-widgetState":a.widget.options.serializedState},retryDelayFn:function(){return a.pollingRetryDelay},isResponseExpectedFn:function(a){return"true"===a.fundingSourceInTerminalState},onSuccessFn:function(){a._publishLatencyMetric("ConfirmQrCodePollingTime",a.CONFIRM_QR_CODE_START_TIME);clearInterval(a.countdownTimerIntervalId);a._fireConfirmQrCodeCompletedEvent("TerminalStateReached")},retryFailedFn:function(){clearInterval(a.countdownTimerIntervalId);
a._fireWidgetCompletedEvent("ConfirmQRCodeRetriesExhausted")},retryLimit:a.executionStatusPollingRetryLimit})},_fireWidgetCompletedEvent:function(a){this.cancelTransactionEventEnabled?this._fireCancelTransactionEvent(a):this._fireConfirmQrCodeCompletedEvent(a)},_fireConfirmQrCodeCompletedEvent:function(a){g.dynamicContinueWithEvent("ConfirmQrCodeCompletedEvent",this.widget.options.serializedState,[{name:"ppw-reason",value:a}],this.dynamicContinueFormDescription,this.widget.getRootDOMElements().last())},
_fireCancelTransactionEvent:function(a){d.hideElement(this.getDOMElement("qrCode-count-down-timer-container"));d.hideElement(this.getDOMElement("qrCode-image-container"));d.hideElement(this.getDOMElement("qrCode-cancel-container"));this.getDOMElement("qrCode-polling-connection-info-label").html(this.widget.getLocalizedString("apx_default_verify_payment_status_message"));d.showElement(this.getDOMElement("pmts-executions-async-spinner-polling-for-action"));g.dynamicContinueWithEvent("CancelTransactionEvent",
this.widget.options.serializedState,[{name:"ppw-reason",value:a}],this.dynamicContinueFormDescription,this.widget.getRootDOMElements().last())},_hydrateCustomerPaymentReferenceFields:function(a){var c=this.getDOMElement("qrCode-cpr-info-section");d.showElement(c);a.customerPaymentReferenceDueDate!==r&&this.getDOMElement("qrCode-cpr-due-date").text(a.customerPaymentReferenceDueDate);a.orderValue!==r&&this.getDOMElement("qrCode-cpr-order-value").text(a.orderValue);if(a.scanCodeType!==r)switch(c=this.getDOMElement("qrCode-cpr-qr-base-64-text"),
a.scanCodeType){case "BARCODE":a.customerPaymentReference!==r&&(c.text(a.customerPaymentReference),a=this.getDOMElement("qrCode-cpr-barcode-footer-images-section"),c=this.getDOMElement("qrCode-cpr-barcode-shop-footer-section"),d.showElement(a),d.showElement(c));break;default:a.qrCodeUrl!==r&&c.text(a.qrCodeUrl)}a=this.getDOMElement("qrCode-cpr-loading-box");d.hideElement(a);a=this.getDOMElement("qrCode-cpr-qr-section");d.showElement(a)},_triggerUpdateCountDownTimer:function(a,c){a.getDOMElement("qrCode-count-down-timer-label").html(c)},
_triggerTerminalEventOnCountDownTimerExpiry:function(a){a._fireWidgetCompletedEvent("CountDownTimerExpired")},_publishLatencyMetric:function(a,c){h.logLatencyMetric({feature:this._getMetricName(a),resource:"_Latency",startTime:c});h.publishMetrics()},_publishCounterMetric:function(a){h.logCounterMetric({feature:this._getMetricName(a),resource:"_Count"});h.publishMetrics()},_getMetricName:function(a){return[this.executionMetricsPrefix,a].join(".")}})});l("components/PayWithQrCodeComponent",["component",
"css-utils","events/QrCodeGeneratedEvent"],function(c,d,f){return c.extend({initialize:function(c,d){},bindToEvents:function(){var c=this;c.widget.on(f,c,function(){d.hideElement(c.getDOMElement("qrCode-box-header"))})}})});l("events/QrCodeGeneratedEvent",["public-event-registry"],function(c){c.register("QrCodeGeneratedEvent");return"QrCodeGeneratedEvent"});l("components/RedeemClaimCodeComponent","css-utils jQuery form-component lang clog scanner-helper AUI!P".split(" "),function(c,d,f,h,g,a,m){return f.extend({_scannedClaimCode:r,
initialize:function(a,c){this.giftCardRegex=c.data.giftCardRegex;this.scannerEnabled=c.data.scannerEnabled;this._shouldDisplayMCXModernFrame=c.data.shouldDisplayMCXModernFrame;this.claimCodeApplyPressed=c.data.claimCodeApplyPressed;this.$claimCode=this.getDOMElement("claimCode");this.$claimCodeSubmitButton=this.getDOMElement("claimCodeSubmitButton");this.$toggleSwitch=this.getDOMElement("claimCodeToggleSwitch");this.$claimCodeFormContainer=this.getDOMElement("claimCodeFormContainer");this.$errorMessageContainer=
this.getDOMElement("claimCodeErrorMessageContainer");this.$successMessageContainer=this.getDOMElement("claimCodeSuccessMessageContainer");this.$inputField=this.$claimCodeFormContainer.find("input");this.$arrowIcon=this.getDOMElement("mcx-arrow-submit-icon");this.$scanIcon=this.getDOMElement("mcx-camera-scan-icon");this.$toggleSwitchCheckbox=this.getDOMElement("claimCodeToggleSwitch").find("input").prop("name");this.scannerEnabled&&this._toggleSubmitButton();this._shouldDisplayMCXModernFrame&&this.$claimCode.val("")},
bindToElements:function(){var c=this;c.bindFormSubmissionHandler("claimCodeSubmitButton","claimCode",c.handleClaimCodeSubmission);c.scannerEnabled&&(c.$claimCode.bind("keyup change",h.bind(c._toggleSubmitButton,c)),c.getDOMElement("claim-code-scan-icon").click(function(b){b.preventDefault();c._countGiftCardScannerEvent();a.handleCardScanDOMEvent(h.bind(c._scannerSuccessCallback,c),h.bind(c._scannerFailureCallback,c),a.CARD_TYPE_GIFT)}));c.$claimCode.click(function(){c.widget.publishSuccessSushiMetrics({ActionType:"RedeemClaimCodeEvent",
ActionValueType:"Click",ActionValue:"RedeemClaimCodeBoxClicked"})});if(c._shouldDisplayMCXModernFrame){var e="a:switch:"+c.$toggleSwitchCheckbox+":flip";c.widget.offAui(e);c.widget.onAui(e,function(b){c._toggleClaimCodeCustomInputDisplay(b.switchState.isOn)});c.$inputField.bind("input",function(b){c._switchIcon()})}},bindToEvents:function(){var a=this;a.widget.on("ClaimCodeSubmitted",a,function(c){d(a.$claimCode).closest("form").submit();a._scannedClaimCode===c.claimCode&&g.logCounterMetric({feature:"GiftCardScannerClaimCodeEvent",
resource:"_SuccessCount"});a.widget.publishSuccessSushiMetrics({ActionType:"SubmitRedeemClaimCodeEvent",ActionValueType:"Click",ActionValue:"RedeemClaimCodeSubmitButtonClicked"})});a.widget.on("UpdateWidget",a,function(c){c&&(c=d.parseJSON(c),"RedeemClaimCodeComponent"===c.componentName&&a.form.renderErrorMessages(c.errors))})},_toggleClaimCodeCustomInputDisplay:function(a){c.toggleElement(this.$errorMessageContainer,a);c.toggleElement(this.$successMessageContainer,a);a||this._initializeInputField();
c.toggleElement(this.$claimCodeFormContainer,a)},_initializeInputField:function(){this.$claimCode.val("");this._switchIcon()},_switchIcon:function(){this.$claimCode.val()?(c.toggleElement(this.$scanIcon,!1),c.toggleElement(this.$arrowIcon,!0)):(c.toggleElement(this.$scanIcon,!0),c.toggleElement(this.$arrowIcon,!1))},_toggleSubmitButton:function(){0<d.trim(this.$claimCode.val()).length?c.toggleElement(this.$claimCodeSubmitButton,!0):c.hasAUIHiddenClass(this.$claimCodeSubmitButton)||c.toggleElement(this.$claimCodeSubmitButton,
!1)},_countGiftCardScannerEvent:function(){g.logCounterMetric({feature:"GiftCardScannerEvent",resource:"_Count"})},_scannerFailureCallback:function(a){this.widget.log({giftCardScannerError:a});g.logCounterMetric({feature:"GiftCardScannerEvent",resource:"_ErrorCount"})},_scannerSuccessCallback:function(a){a&&a.cardData&&a.cardData.number&&(g.logCounterMetric({feature:"GiftCardScannerClaimCodeEvent",resource:"_Count"}),this._scannedClaimCode=a=this._prettifyClaimCode(a.cardData.number),this.$claimCode.val(a),
this.$claimCodeSubmitButton.trigger("click"))},_prettifyClaimCode:function(a){return 14>a.length?a:a.replace(/^(.{4})(.{6})(.+)?$/,"$1-$2-$3")},handleClaimCodeSubmission:function(){if(0===this.form.validateForm().length)if(this.data.requiresInlineSubmission)this.widget.submitFormAJAX({"ppw-widgetEvent":"ClaimAnyCodeEvent","ppw-claimCode":this.form.getFormValues().claimCode,"ppw-widgetState":this.widget.options.serializedState});else{var a=this.$claimCodeSubmitButton.closest("form").serializeArray(),
c=this.$claimCode.val(),b=this._shouldDisplayMCXModernFrame?this.claimCodeApplyPressed:this.$claimCodeSubmitButton.find("input").attr("name");this.widget.triggerContinue("ClaimCodeSubmitted",{claimCode:c,claimType:this._resolveClaimType(c),ppwEventNameAttribute:b,submissionParameters:a})}return!1},_resolveClaimType:function(a){if(a)return a.replace(/[\s\-]/g,"").toUpperCase().match(new RegExp(this.giftCardRegex))?"GiftCard":"Promotion"}})});l("components/RewardsAccountComponent",["css-utils","jQuery",
"form-component","lang"],function(c,d,f,h){return f.extend({validationToErrorMap:{IsNumberFieldConstraint:"rewardsAccountErrorInvalidFormat",GreaterThanEqualFieldConstraint:"rewardsAccountErrorLessThanZero",LessThanEqualFieldConstraint:"rewardsAccountErrorGreaterThanEligible"},resetFormErrorMessages:function(){c.hideElement(this.getDOMElement("errorMessages"));c.hideElement(d(".pmts-rewards-account-server-message"));h.forEach(["rewardsAccountErrorInvalidFormat","GreaterThanEqualFieldConstraint","LessThanEqualFieldConstraint"],
function(c){this.form.resetErrorMessage("amount",this.getDOMElement(c))},this)},displayFormErrorMessages:function(d){0!==d.length&&(d=d[0],"amount"===d.field&&(d=this.getDOMElement(this.validationToErrorMap[d.validation]),this.form.displayErrorMessage("amount",d)),d=this.getDOMElement("errorMessages"),c.showElement(d))},handleRewardsAccountDOMEvent:function(){var c=this.getDOMElement("amount").val();this.resetFormErrorMessages();var a=this.form.validateForm();0===a.length?this.widget.trigger("RewardsAccountSubmitted",
{amount:c,submissionParameters:this.getDOMElement("rewardsAccountSubmitButton").closest("form").serializeArray()}):this.displayFormErrorMessages(a);return!1},bindToElements:function(){var c=this,a=c.getDOMElement("pmtsRewardsAccountLearnMoreLink");a!==r&&0<a.length&&a.click(function(){c.widget.trigger("RewardsAccountLearnMoreRequested");return!1});c.bindFormSubmissionHandler("rewardsAccountSubmitButton","amount",c.handleRewardsAccountDOMEvent)},bindToEvents:function(){var c=this;c.widget.on("RewardsAccountSubmitted",
c,function(){d(c.getDOMElement("amount")).closest("form").submit()})}})});l("components/RegisteredDPMRewardsAccountComponent",["css-utils","component"],function(c,d){return d.extend({showRewardsAccountSelection:function(){this.getDOMElement("rewardsAccountSelectionSection").removeClass("apx-js-hide");this._toggleRewardsAccountSelectionDisplay(!0)},hideRewardsAccountSelection:function(){this._toggleRewardsAccountSelectionDisplay(!1)},_toggleRewardsAccountSelectionDisplay:function(d){c.toggleElement(this.getDOMElement("rewardsAccountSelectionSection"),
d)},bindToEvents:function(){var c=this;c.widget.on("rewardsAccountSelected",c,function(d){d.instrumentId===c.data.instrumentId&&c.showRewardsAccountSelection()});c.widget.on("rewardsAccountDeselected",c,function(d){d.instrumentId===c.data.instrumentId&&c.hideRewardsAccountSelection()})}})});l("components/RegisteredRewardsAccountComponent","events/InstrumentRowSelectedEvent css-utils form-component lang aui-helper jQuery AUI!P number-format input-helper".split(" "),function(c,d,f,h,g,a,m,k,e){return f.extend({initialize:function(b,
a){this.$container=this.getDOMElement("rewardsAccountApplied");this._currencyToPointsConversionRatio=a.data.currencyToPointsConversionRatio;this._rewardsCurrencyCode=a.data.rewardsCurrencyCode;this._isStandaloneRewards=a.data.isStandaloneRewards;this._parentCreditCardInstrumentId=a.data.parentCreditCardInstrumentId;this._hasViolation=a.data.hasViolation;this._isEBTSelected=null;this._rewardsErrors=[];this._shouldCheckboxBeSelected=!1;this._shouldDisplayModernizedFrameCX=a.data.shouldDisplayMCXModernFrameWeblab;
this._modernizedPaymentArtGridCssClass=a.data.modernizedPaymentArtGridCssClass;this._disabledSectionCssClass=a.data.disabledSectionCssClass;this._maxUsableBalance=a.data.maxUsableBalance;b=a.data.countryCode||b.options.locale.substring(3);this._rewardsPointsNumberFormat=new k(b,{fixedDecimalPrecision:a.data.rewardsDecimalPlaces});this._rewardsCurrencyNumberFormat=new k(b,{currency:this._rewardsCurrencyCode});this._ebtAccountDescriptorId=a.data.ebtAccountDescriptorId;this._disabledByNotOwnedInstrument=
this._disabledByNonCC=this._disabledByHBA=!1;this.isABCrossCustomerMultiTenderSuppressionEnabled=a.data.isABCrossCustomerMultiTenderSuppressionEnabled},isRewardsAppliedChecked:function(){return this._shouldDisplayModernizedFrameCX?this.$toggleSwitch.find("input").prop("checked"):this.$checkbox.prop("checked")},showRewardsAccountSelection:function(){this.getDOMElement("rewardsAccountSelectionSection").removeClass("apx-js-hide");this._shouldCheckboxBeSelected&&(this._toggleRewardsAppliedValue(!0),this._triggerBalanceSelectionChangedEvent(!0));
this._toggleRewardsAccountSelectionDisplay(!0)},hideRewardsAccountSelection:function(){var b=this;this._shouldDisplayModernizedFrameCX?m.when("a-switch","jQuery").execute(function(a){a=a.getSwitch(b.$toggleSwitch);null!=a&&(a.isOn()?(b._shouldCheckboxBeSelected=!0,a.isOn(!1),b._triggerBalanceSelectionChangedEvent(!1)):b._shouldCheckboxBeSelected=!1)}):this.isRewardsAppliedChecked()?(this._shouldCheckboxBeSelected=!0,this._toggleRewardsAppliedValue(!1),this._triggerBalanceSelectionChangedEvent(!1)):
this._shouldCheckboxBeSelected=!1;this.getDOMElement("rewardsAccountSelectionChangeover").hide();this._toggleRewardsAccountSelectionDisplay(!1)},showRewardsAccountCustomInput:function(){this._toggleRewardsAccountCustomInputDisplay(!0)},hideRewardsAccountCustomInput:function(){this._toggleRewardsAccountCustomInputDisplay(!1)},showRewardsCustomAmountConversion:function(){this._toggleRewardsCustomAmountConversionDisplay(!0)},hideRewardsCustomAmountConversion:function(){this._toggleRewardsCustomAmountConversionDisplay(!1)},
showRewardsCustomAmountAppliedMessage:function(){this._toggleRewardsCustomAmountAppliedDisplay(!0)},hideRewardsCustomAmountAppliedMessage:function(){this._toggleRewardsCustomAmountAppliedDisplay(!1)},showRewardsCustomAmountErrorMessage:function(){this._toggleRewardsCustomAmountErrorMessageDisplay(!0)},hideRewardsCustomAmountErrorMessage:function(){this._toggleRewardsCustomAmountErrorMessageDisplay(!1)},_toggleSelectBackingCardMessage:function(b){d.toggleElement(this.getDOMElement("selectBackingCardMessage"),
b)},_toggleRewardsAppliedValue:function(b){this._shouldDisplayModernizedFrameCX?this._flipToggleSwitchState(b):this.$checkbox.prop("checked",b)},_flipToggleSwitchState:function(b){var a=this;m.when("a-switch","jQuery").execute(function(c){c=c.getSwitch(a.$toggleSwitch);null!=c&&c.isOn(b)})},_toggleCheckboxEditability:function(b){this.$checkbox.prop("disabled",!b);this._isEBTSelected||this._toggleRewardsAccountBalanceInfo(b)},_toggleRewardsAccountSelectionDisplay:function(b){d.toggleElement(this.getDOMElement("rewardsAccountSelectionSection"),
b)},_toggleRewardsCustomAmountConversionDisplay:function(b){d.toggleElement(this.getDOMElement("rewardsAccountCustomAmountPointsConversion"),b)},_toggleRewardsAccountCustomInputDisplay:function(b){d.toggleElement(this.getDOMElement("rewardsAccountCustomInput"),b)},_toggleRewardsCustomAmountAppliedDisplay:function(b){d.toggleElement(this.getDOMElement("rewardsAccountCustomAmountApplied"),b)},_toggleRewardsCustomAmountErrorMessageDisplay:function(b){d.toggleElement(this.getDOMElement("rewardsAccountCustomAmountErrorMessage"),
b)},_toggleRewardsWithEBTInfoMessage:function(b){d.toggleElement(this.getDOMElement("rewardsAccountEBTInfoMessage"),b)},_toggleRewardsAvailableBalanceInfo:function(b){d.toggleElement(this.getDOMElement("rewardsAvailableBalanceInfo"),b)},_toggleRewardsAccountSelection:function(b){if(this._shouldDisplayModernizedFrameCX){var a=this;this._isEBTSelected||this._toggleRewardsAccountBalanceInfo(b);m.when("a-switch","jQuery").execute(function(c){c=c.getSwitch(a.$toggleSwitch);null!=c&&(c.isOn()&&(c.isOn(b),
a._onRewardsAppliedChanged(!0)),c.enabled(b),a._toggleRewardsAccountCustomInputDisplay(c.isOn()),a._toggleRewardsAvailableBalanceInfo(!c.isOn()))});this.$container.find("."+this._modernizedPaymentArtGridCssClass).toggleClass(this._disabledSectionCssClass,!b)}else this._toggleCheckboxEditability(b),this._isStandaloneRewards||this._isEBTSelected||this._toggleRewardsAccountCustomInputDisplay(b),this.isRewardsAppliedChecked()&&(this._toggleRewardsAppliedValue(b),this._onRewardsAppliedChanged(!0))},_toggleRewardsAccountBalanceInfo:function(b){var a=
this.getDOMElement("rewardsAccountBalanceInfo");b?a.removeClass("a-color-tertiary"):a.addClass("a-color-tertiary")},_triggerBalanceSelectionChangedEvent:function(b){var a=this.getCustomRewardsAmount()||0;this.widget.trigger("balanceSelectionChanged",{paymentMethod:"RewardsAccount",instrumentId:this.data.instrumentId,isSelected:b,balance:a,isBackingInstrument:!1});b?this.widget.trigger("optionalInstrumentSelected",{instrumentId:this.data.instrumentId,paymentMethod:"RewardsAccount",parentInstrumentId:this._parentCreditCardInstrumentId,
errors:this._rewardsErrors}):this.widget.trigger("optionalInstrumentDeselected",{instrumentId:this.data.instrumentId})},getCustomRewardsAmount:function(){var b=this.form.getFormValues()[this.form.fields.rewardsAccountSelection.customAmountSelectionInput];return this._rewardsCurrencyNumberFormat.localizedParseNumber(b)},bindToElements:function(){var b=this,a=b.form.fields.rewardsAccountSelection,c="rewardsAccountToggleSwitch-"+b.data.instrumentId;this.$checkbox=this.getDOMElement("rewardsAccountApplied").find("input");
this.$toggleSwitch=this.getDOMElement(c);this.$toggleSwitchCheckboxName=this.$toggleSwitch.find("input").prop("name");this._shouldDisplayModernizedFrameCX&&null!=b.$toggleSwitchCheckboxName&&(this.$toggleSwitch.find("input").val(b._maxUsableBalance),this.$customInputField=this.getDOMElement("rewardsAccountCustomAmountInputField"),this.$customInputField.attr("inputmode","decimal"),c="a:switch:"+b.$toggleSwitchCheckboxName+":flip",b.widget.offAui(c),b.widget.onAui(c,function(a){b._onRewardsAppliedChanged(a.switchState.clicked)}),
e.limitToNumericInput(b.$customInputField),e.limitNumericInputDigits(b.$customInputField,2));c=h.bind(b._onRewardsAccountCustomAmountInputChanged,b);b.form.bindToParameter(a.customAmountSelectionInput,"keyup",c);b.getDOMElement("RewardsAccountBalanceRefresh").find(".pmts-rewards-account-balance-refresh-link").click(function(){b.widget.trigger("RewardsAccountBalanceRefresh");return!1});b.$checkbox.change(function(){b._shouldDisplayModernizedFrameCX||b._onRewardsAppliedChanged(!0)})},bindToEvents:function(){var b=
this;b.widget.on("rewardsAccountSelected",b,function(a){a.instrumentId===b.data.instrumentId&&b._onRewardsAccountSelected()});b.widget.on("rewardsAccountDeselected",b,function(a){a.instrumentId===b.data.instrumentId&&b._onRewardsAccountDeselected()});b.widget.on("RewardsAccountBalanceRefresh",b,function(a){b.widget.submitFormAJAX({"ppw-widgetState":b.widget.options.serializedState,"ppw-widgetEvent":"RewardsAccountBalanceRefreshEvent"})});b.widget.on("balanceSelectionChanged",b,function(a){"RewardsAccount"===
a.paymentMethod&&a.instrumentId===this.data.instrumentId&&b._shouldDisplayModernizedFrameCX&&b.widget.trigger("updateEstimatedTotal",{type:a.paymentMethod,status:a.isSelected,balance:a.balance,isValid:0===this._rewardsErrors.length,message:this._rewardsErrors,instrumentId:this.data.instrumentId});b._shouldDisplayModernizedFrameCX?m.when("a-switch","jQuery").execute(function(c){c=c.getSwitch(b.$toggleSwitch);null!=c&&"RewardsAccount"===a.paymentMethod&&a.instrumentId!==b.data.instrumentId&&a.isSelected&&
(c.isOn()||b._shouldCheckboxBeSelected)&&(c.isOn(!1),b._shouldCheckboxBeSelected=!1,b._isStandaloneRewards||!d.hasAUIHiddenClass(b.getDOMElement("rewardsAccountSelectionSection")))&&(b.getDOMElement("rewardsAccountSelectionChangeover").stop(!0,!0).fadeIn(200),p.setTimeout(function(){b.getDOMElement("rewardsAccountSelectionChangeover").fadeOut(200)},1E3))}):"RewardsAccount"===a.paymentMethod&&a.instrumentId!==this.data.instrumentId&&a.isSelected&&(b.isRewardsAppliedChecked()||b._shouldCheckboxBeSelected)&&
(b._toggleRewardsAppliedValue(!1),b._shouldCheckboxBeSelected=!1,b._onRewardsAppliedChanged(!1),this._isStandaloneRewards||!d.hasAUIHiddenClass(this.getDOMElement("rewardsAccountSelectionSection")))&&(b.getDOMElement("rewardsAccountSelectionChangeover").stop(!0,!0).fadeIn(200),p.setTimeout(function(){b.getDOMElement("rewardsAccountSelectionChangeover").fadeOut(200)},1E3))});b.widget.on(c,b,function(a){b._setDisabledByNotOwnedInstrument(a);b._onInstrumentSelected(a)});b.widget.on("initializeRecommendedInstrument",
b,function(a){b._onInstrumentSelected(a)});b.widget.on("optionalInstrumentRowSelected",b,function(a){a.descriptorId===b._ebtAccountDescriptorId&&b._onEBTSelectionChanged(!0)});b.widget.on("optionalInstrumentRowDeselected",b,function(a){a.descriptorId===b._ebtAccountDescriptorId&&b._onEBTSelectionChanged(!1)});b.widget.on("hbaCoverageChanged",b,function(a){b._onHBACoverageChanged(a.coversPurchaseTotal)});b.widget.on("componentsInitialized",b,function(){b.isRewardsAppliedChecked()?(b.showRewardsCustomAmountAppliedMessage(),
b._triggerBalanceSelectionChangedEvent(!0)):b.hideRewardsCustomAmountAppliedMessage()})},_setDisabledByNotOwnedInstrument:function(b){b=h.isDefined(b.isInstrumentOwned)&&!b.isInstrumentOwned;this._disabledByNotOwnedInstrument=this._isStandaloneRewards&&this.isABCrossCustomerMultiTenderSuppressionEnabled&&b},_onEBTSelectionChanged:function(b){b?(this._toggleRewardsAccountBalanceInfo(!1),this.hideRewardsAccountCustomInput(),this._toggleRewardsWithEBTInfoMessage(!0),this._isEBTSelected=!0):(this._toggleRewardsAccountBalanceInfo(!0),
this._shouldDisplayModernizedFrameCX||this.showRewardsAccountCustomInput(),this._toggleRewardsWithEBTInfoMessage(!1),this._isEBTSelected=!1)},_onHBACoverageChanged:function(b){this._disabledByHBA=b;this._hasViolation||this._toggleRewardsAccountSelection(!this._disabledByNonCC&&!this._disabledByHBA)},_onInstrumentSelected:function(b){this._disabledByNonCC="CC"!==b.paymentMethod;this._hasViolation||(this._toggleSelectBackingCardMessage(this._disabledByNonCC&&this._isStandaloneRewards),this._toggleRewardsAccountSelection(!this._disabledByNonCC&&
!this._disabledByHBA&&!this._disabledByNotOwnedInstrument))},_onRewardsAppliedChanged:function(b){var a=this;this._shouldDisplayModernizedFrameCX?m.when("a-switch","jQuery").execute(function(c){c=c.getSwitch(a.$toggleSwitch);null!=c&&(a._toggleRewardsAccountCustomInputDisplay(c.isOn()),a._toggleRewardsAvailableBalanceInfo(!c.isOn()),a._toggleRewardsCustomAmountAppliedDisplay(c.isOn()),b&&(a._validateSelection(),a._triggerBalanceSelectionChangedEvent(c.isOn())))}):(this._isStandaloneRewards&&this._toggleRewardsAccountCustomInputDisplay(this.isRewardsAppliedChecked()),
this._toggleRewardsCustomAmountAppliedDisplay(this.isRewardsAppliedChecked()),b&&(this._validateSelection(),this._triggerBalanceSelectionChangedEvent(this.isRewardsAppliedChecked())))},_onRewardsAccountSelected:function(){this.showRewardsAccountSelection()},_onRewardsAccountDeselected:function(){this.hideRewardsAccountSelection()},_onRewardsAccountCustomAmountInputChanged:function(){this._shouldDisplayModernizedFrameCX||this.isRewardsAppliedChecked()||this._toggleRewardsAppliedValue(!0);var b=this._validateSelection();
0===b.length?(this.hideRewardsCustomAmountErrorMessage(),this.showRewardsCustomAmountConversion(),this.showRewardsCustomAmountAppliedMessage(),b="0",b=this.form.getFormValues()[this.form.fields.rewardsAccountSelection.customAmountSelectionInput],b=this._rewardsCurrencyNumberFormat.localizedParseNumber(b)/this._currencyToPointsConversionRatio,b=this._rewardsPointsNumberFormat.format(b),this.getDOMElement("rewardsAccountCustomAmountPointsConversionContent").text(b)):(b=b.map(function(b){return b.localizedMessageString}),
this.hideRewardsCustomAmountConversion(),this.showRewardsCustomAmountErrorMessage(),this.getDOMElement("rewardsAccountCustomAmountErrorMessageContent").text(b[0]));this._triggerBalanceSelectionChangedEvent(!0)},_validateSelection:function(){var b=this.form.validateForm();this._rewardsErrors=b.map(function(b){return b.localizedMessageString});return b}})});l("components/SecureContainerComponent","jQuery component lang AUI!P events/postToSecureIframeEvent events/secureIframeLoadedEvent events/spinner-events mixins/secure-container-support cvv-rate-limiting-inline-message-helper block-add-credit-card-trigger-helper mash-helper storage-helper TransitionMetricsConstants".split(" "),
function(c,d,f,h,g,a,m,k,e,b,n,q,y){var v=/^\/[/.a-zA-Z0-9-]+/;return d.extend(k,{initialize:function(b,a){a.data.request?(this._request=a.data.request,this._returnUrl=a.data.returnUrl,this._clientId=a.data.clientId,this._usePopover=a.data.usePopover,this._maxAgeSeconds=a.data.maxAgeSeconds,this._iFrameName=a.data.iFrameName):(this._returnUrl=a.data.returnUrl,this._clientId=a.data.clientId,this._usePopover=a.data.usePopover,this._maxAgeSeconds=a.data.maxAgeSeconds);this._parentWidgetInstanceId=a.data.parentWidgetInstanceId;
this._deviceType=a.data.deviceType;this._iframeUri=a.data.iframeUri;this._iframeOrigin=a.data.iframeOrigin;this._secureFormTarget=a.data.secureFormTarget;this._requestFromMobileApp=a.data.requestFromMobileApp;this._inlineIframe=a.data.inlineIframe;this._secureIframe=this.getDOMElement("JsBindingApxSecureIFrame");this._dynamicContinueEnabled=a.data.dynamicContinueEnabled;b=a.data.addCardIntermittentStepRemoved;b===r&&(b=!1);this._addCardIntermittentStepRemoved=b;this._closeIframe();this._requestFromMobileApp&&
n.addEventListener("LaunchUpdateEverywhereEvent",function(b){v.test(b.detail.interstitialPageUrl)&&n.setUrlInCurrentWebview(b.detail.interstitialPageUrl)})},_showIframe:function(){this._secureIframe.css("display","inline")},_closeIframe:function(){this._secureIframe.css("display","none")},bindToElements:function(){var b=this;b._bindCrossDomainMessaging();b._secureIframe.load(function(){b.widget.trigger(m.hideSpinner)})},bindToEvents:function(){var b=this;b.widget.on(g,b,function(a){if(!b._inlineIframe||
a.postData.hasOwnProperty("iFrameName")&&a.postData.iFrameName===b._secureFormTarget)b.widget.trigger(m.showSpinner),b._postToIframe(a.postData)})},_bindCrossDomainMessaging:function(){var b=f.bind(this._processCrossDomainMessage,this);f.addEventListener(p,"message",b);this._inlineIframe&&(b=f.bind(this._sendWindowResizeMessage,this),f.addEventListener(p,"resize",b))},_sendWindowResizeMessage:function(){var b=document.getElementsByName(this._secureFormTarget)[0];b.contentWindow.postMessage(JSON.stringify({parentWidth:b.offsetWidth-
20}),"*")},_processCrossDomainMessage:function(d){var n;try{n=JSON.parse(d.data)}catch(f){return}var g=n&&n.event&&n.event.data&&n.event.data.hasOwnProperty("iFrameName")&&n.event.data.iFrameName===this._secureFormTarget,k=this._inlineIframe&&n&&n.hasOwnProperty("frameHeight")&&n.hasOwnProperty("iFrameName")&&n.iFrameName===this._secureFormTarget;if(g)if(g=n.event,"apx:iframe:close"===g.name)this._closeIframe(),this._addCardIntermittentStepRemoved&&this.widget.trigger("pmts-close-add-card-form");
else if("apx:iframe:display"===g.name)this._showIframe();else if("apx:iframe:redirect"===g.name)g.data&&d.origin===this._iframeOrigin&&v.test(g.data.interstitialPageUrl)&&(p.location.href=g.data.interstitialPageUrl);else if("apx:page:reload"===g.name)this._dynamicContinueEnabled?this.addPaymentMethodRefreshContinue(g.data.paymentMethodId,g.data.widgetAction,g.data.walletId):this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"AddPaymentMethodRefreshEvent",
"ppw-paymentMethodId":g.data.paymentMethodId,"ppw-widgetAction":g.data.widgetAction,"ppw-maybeWalletId":g.data.walletId,"ppw-maybeShouldRecordAPX3Metric":g.data.shouldRecordAPX3Metric});else if("apx:auth:timeout"===g.name)this.widget.trigger("AuthTimeout");else if("apx:secureWidget:ready"===g.name||"apx:secureWidget:unavailable"===g.name)this._showIframe(),d=q.getFromSession(y.ADD_PM_LINK_CLICK_STORAGE_KEY+this.widget.widgetInstanceId),this.widget.trigger(a,{data:g.data,clickData:d});k&&(document.getElementsByName(this._secureFormTarget)[0].style.height=
n.frameHeight+"px");try{if(n&&n.event&&"apx:add-payment-method:BlockCardAdditionsEvent"===n.event.name)if(this._closeIframe(),0<n.event.data.rateLimitDurationInSeconds)this.widget.trigger("DisableCreditCardRegistrationLinkEvent",{rateLimitDurationInSeconds:n.event.data.rateLimitDurationInSeconds}),n.event.data.isDynamicRateLimitMessage?e.displayTimer(n.event.data.rateLimitDurationInSeconds,n.event.data.andString,n.event.data.hoursString,n.event.data.hourString,n.event.data.minuteString,n.event.data.minutesString):
e.display(n.event.data.rateLimitDurationInSeconds),b();else{var w=c(".pmts-add-credit-card-component-container");1===w.length&&(w.addClass("pmts-disabled-add-credit-card-container"),1===w.find(".a-button.apx-secure-registration-content-trigger-js").length&&w.find(".a-button.apx-secure-registration-content-trigger-js").addClass("a-button-disabled"),1===w.find("a.apx-secure-registration-content-trigger-js").length&&w.find("a.apx-secure-registration-content-trigger-js").addClass("pmts-add-cc-link-disabled"),
n.event.data&&n.event.data.hasOwnProperty("isCreditCardCVVVerificationFailed")&&n.event.data.isCreditCardCVVVerificationFailed?1===w.find(".pmts-add-cc-alert-container").length&&w.find(".pmts-add-cc-alert-container").removeClass("a-hidden aok-hidden"):1===w.find(".pmts-add-cc-info-container").length&&w.find(".pmts-add-cc-info-container").removeClass("a-hidden aok-hidden"));c(".pmts-add-cc-default-trigger")&&1===c(".pmts-add-cc-default-trigger").length&&(c(".pmts-add-cc-default-trigger").addClass("pmts-disabled-add-credit-card-container"),
c(".pmts-add-cc-default-trigger").find(".pmts-add-cc-default-trigger-link").addClass("pmts-add-cc-link-disabled"),c("#apx-add-credit-card-action-test-id")&&1===c("#apx-add-credit-card-action-test-id").length&&(c("#apx-add-credit-card-action-test-id").removeClass("a-declarative"),c("#apx-add-credit-card-action-test-id").addClass("pmts-disabled-add-credit-card-container")));n.event.data&&n.event.data.hasOwnProperty("isCreditCardCVVVerificationFailed")&&n.event.data.isCreditCardCVVVerificationFailed&&
(c(".pmts-add-payment-link")&&c(".pmts-add-payment-link").click(),c(".pmts-add-payment-link")&&1===c(".pmts-add-payment-link").length&&c(".pmts-add-payment-link")[0].click())}}catch(f){}},_postToIframe:function(b){var a=this,e=c("\x3cform\x3e").attr({action:a._iframeUri,method:"POST",target:a._secureFormTarget});e.append(a.buildHiddenInput("widgetState",a.widget.options.serializedState));f.isDefined(a._request)&&e.append(a.buildHiddenInput("request",a._request));e.append(a.buildHiddenInput("returnUrl",
a._returnUrl));e.append(a.buildHiddenInput("clientId",a._clientId));e.append(a.buildHiddenInput("usePopover",a._usePopover));e.append(a.buildHiddenInput("maxAgeSeconds",a._maxAgeSeconds));e.append(a.buildHiddenInput("iFrameName",a._secureFormTarget));e.append(a.buildHiddenInput("parentWidgetInstanceId",a._parentWidgetInstanceId));f.forEachKeyValue(b,function(b,c){"iFrameName"!==b&&e.append(a.buildHiddenInput(b,c))});c("body").append(e);this._requestFromMobileApp?h.when("A","mash").execute(function(b,
c){c.navstack.begin().forward(b.$(e)).end();a.widget.trigger(m.hideSpinner)}):e.submit().remove()},buildHiddenInput:function(b,a){return c("\x3cinput\x3e").attr({type:"hidden",name:b,value:a})}})});l("events/postToSecureIframeEvent",["public-event-registry"],function(c){c.register("postToSecureIframeEvent");return"postToSecureIframeEvent"});l("events/secureIframeLoadedEvent",["public-event-registry"],function(c){c.register("secureIframeLoadedEvent");return"secureIframeLoadedEvent"});l("events/close-secure-container-event",
["public-event-registry"],function(c){c.register("CloseSecureContainerEvent");return"CloseSecureContainerEvent"});l("events/display-secure-container-event",["public-event-registry"],function(c){c.register("DisplaySecureContainerEvent");return"DisplaySecureContainerEvent"});l("mixins/secure-container-support",["jQuery","lang","ExecutionsWidgetUtils"],function(c,d,f){return{initialize:function(c,d){this._dynamicContinueFormDescription=d.data.dynamicContinueFormDescription},addPaymentMethodRefreshContinue:function(c,
d,a,m,k){this.widget.continueRequestAjaxSubstitutionEnabled||"undefined"===typeof this._dynamicContinueFormDescription?this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"AddPaymentMethodRefreshEvent","ppw-paymentMethodId":c,"ppw-widgetAction":d,"ppw-maybeWalletId":a,"ppw-maybeShouldRecordAPX3Metric":k}):f.dynamicContinueWithEvent("AddPaymentMethodRefreshEvent",this.widget.options.serializedState,[{name:"ppw-paymentMethodId",value:c},{name:"ppw-widgetAction",
value:d},{name:"ppw-maybeWalletId",value:a}],this._dynamicContinueFormDescription,this.widget.getRootDOMElements().last(),m?m:"post")}}});l("components/SecureFieldComponent","jQuery component lang AUI!P clog SecureFieldsInitializationConstants events/InitializeSecureFieldsEvent events/SecureFieldsInitializationStatusEvent events/CreateSecureFieldEvent events/RemoveSecureFieldEvent events/SecureFieldValidationEvent events/SecureFieldRemovedEvent".split(" "),function(c,d,f,h,g,a,m,k,e,b,n,q){return d.extend({initialize:function(b,
c){this.secureFieldId=c.data.secureFieldId;this.secureFieldName=c.data.secureFieldName;this.secureFieldType=c.data.secureFieldType;this.placeholder=c.data.placeholder;this.maxLength=c.data.maxLength;this.regularExpression=c.data.regularExpression;this.secureFieldCSS=this._parseJSON(c.data.secureFieldCSS);this.validations=this._parseJSON(c.data.validations);this.deviceType=c.data.deviceType;this.metricPrefix=(this.useStatic=c.data.useStatic)?"Static":"";this.initializationStatus=a.UNINITIALIZED;this.isFieldCreated=
!1;this.isValid=r;this.secureFieldJsBinding=c.data.secureFieldJsBinding;this.isFallbackEnabled=c.data.isFallbackEnabled;this.isAdditionalFallbackEnabled=c.data.isAdditionalFallbackEnabled;this.fallbackFieldName=c.data.fallbackFieldName;this.timeoutMs=c.data.timeoutMs;this.isFallbackRetryable=this.isFallbackTriggered=!1},_parseJSON:function(b){try{return b&&JSON.parse(b)}catch(a){}},_getFallbackField:function(b){var a={required:function(b){return!("undefined"===typeof b||""===b)}},c=document.createElement("input");
c.name=b.fallbackFieldName;c.type="password";b.maxLength&&(c.maxLength=b.maxLength);c.spellcheck=!1;var e=function(b,a){for(var c in a)b.style[c]=a[c]},q=function(c){for(var e=!0,q=0;q<b.validations.length;q++)"function"===typeof a[b.validations[q]]&&(e=e&&a[b.validations[q]](c));"undefined"!==typeof b.regularExpression&&(q=new RegExp(b.regularExpression),e=e&&q.test(c));c=e;c!==b.isValid&&(b.isValid=c,b.widget.trigger(n,{fieldId:b.secureFieldId,fieldName:b.secureFieldName,fieldType:b.secureFieldType,
fieldIsValid:b.isValid}))};b.placeholder&&(c.placeholder=b.placeholder);b.secureFieldCSS&&b.secureFieldCSS.cssDefault&&(e(c,b.secureFieldCSS.cssDefault),b.secureFieldCSS.cssFocus&&(c.onblur=function(){c.removeAttribute("style");e(c,b.secureFieldCSS.cssDefault)}));b.secureFieldCSS&&b.secureFieldCSS.cssFocus&&(c.onfocus=function(){e(c,b.secureFieldCSS.cssFocus)});c.oninput=function(b){b&&b.target&&q(b.target.value)};q(c.value);return c},_useFallbackField:function(b,a,c){b.isFallbackTriggered||(g.logCounterMetric({feature:c,
resource:"_Count"}),g.publishMetrics(),b._remove(),c=b.getDOMElement(b.secureFieldJsBinding),c.children().remove(),c.append(b._getFallbackField(b)),b.isFallbackTriggered=!0,b.isFieldCreated=!0,b.isFallbackRetryable=a)},_field:function(){var b=this,c=!1;b.isAdditionalFallbackEnabled&&b.timeoutMs&&0<b.timeoutMs&&p.setTimeout(function(){h.now("apx-secure-fields").execute(function(a){"undefined"===typeof a&&(c=!0,b._useFallbackField(b,!0,"SecureFieldNoSDKFallbackTriggered"))})},b.timeoutMs);var e=(new Date).getTime();
h.when("apx-secure-fields").execute(function(q){g.logLatencyMetric({feature:"SecureFieldSDKReady",resource:"_Latency",startTime:e});if(!c){b.initializationStatus===a.UNINITIALIZED&&(b.widget.trigger(m,q),g.logCounterMetric({feature:"CreateSecureFieldBeforeInit",resource:"_Count"}),g.publishMetrics());var d={name:b.secureFieldName,type:b.secureFieldType};b.placeholder&&(d.placeholder=b.placeholder);b.maxLength&&(d.maxLength=b.maxLength);b.regularExpression&&(d.regularExpression=b.regularExpression);
b.validations&&(d.validations=b.validations);b.secureFieldCSS&&(b.secureFieldCSS.cssDefault&&(d.cssDefault=b.secureFieldCSS.cssDefault),b.secureFieldCSS.cssInvalid&&(d.cssInvalid=b.secureFieldCSS.cssInvalid),b.secureFieldCSS.cssFocus&&(d.cssFocus=b.secureFieldCSS.cssFocus));b.isFallbackEnabled&&b.timeoutMs&&0<b.timeoutMs&&(d.timeout=b.timeoutMs);g.logCounterMetric({feature:b.metricPrefix+"SecureFieldRequested",resource:"_Count"});g.publishMetrics();var f=(new Date).getTime();q=q.field(b.secureFieldId,
d,function(a){var c={fieldId:b.secureFieldId,fieldName:b.secureFieldName,fieldType:b.secureFieldType,fieldIsValid:a.isValid};a.isValid!==b.isValid&&(b.isValid=a.isValid,g.logCounterMetric({feature:a.isValid?"SecureFieldsCvvValid":"SecureFieldsCvvInvalid",resource:"_Count"}),g.publishMetrics(),b.widget.trigger(n,c))},b.useStatic);b.isFieldCreated=!0;q.then(function(){g.logLatencyMetric({feature:b.metricPrefix+"SecureFieldLoaded"+b.deviceType,resource:"_Latency",startTime:f});g.publishMetrics()}).catch(function(a){b.isFallbackEnabled&&
b._useFallbackField(b,!0,b.metricPrefix+"SecureFieldFallbackTriggered");a&&"timeout"===a.message?g.logCounterMetric({feature:b.metricPrefix+"SecureFieldLoadingTimeout",resource:"_Count"}):(p.ueLogError&&p.ueLogError(a,{logLevel:"ERROR",attribution:"apx_secure_fields",message:"Secure Field Failed to Load: "}),g.logCounterMetric({feature:b.metricPrefix+"SecureFieldLoadingFailed",resource:"_Count"}));g.publishMetrics()})}})},_remove:function(){var b=this;b.isValid=r;b.isFieldCreated=!1;var a={fieldId:b.secureFieldId,
fieldName:b.secureFieldName,fieldType:b.secureFieldType,fieldIsValid:b.isValid};b.isFallbackTriggered?(b.getDOMElement(b.secureFieldJsBinding).children().remove(),b.isFallbackTriggered=!1,b.isFallbackRetryable=!1):h.now("apx-secure-fields").execute(function(a){"undefined"!==typeof a?(a.remove(b.secureFieldName,b.useStatic),b.widget.trigger(q,{secureFieldId:b.secureFieldId,secureFieldName:b.secureFieldName})):(g.logCounterMetric({feature:"Remove.SecureFieldsSDKUndefinedError",resource:"_Count"}),g.publishMetrics())});
b.widget.trigger(n,a)},bindToEvents:function(){var c=this;c.widget.on(k,c,function(b){b&&b.status&&(c.initializationStatus=b.status,b.status===a.FAILED&&c.isAdditionalFallbackEnabled&&c._useFallbackField(c,!1,c.metricPrefix+"SecureHandlerFallbackTriggered"))});c.widget.on(e,c,function(b){c.isFieldCreated||!b||b.secureFieldId!==c.secureFieldId||c.isFallbackTriggered&&!c.isFallbackRetryable||c._field()});c.widget.on(b,c,function(b){c.isFieldCreated&&b&&b.secureFieldId===c.secureFieldId&&(!c.isFallbackTriggered||
c.isFallbackRetryable)&&c._remove()})}})});l("events/CreateSecureFieldEvent",["public-event-registry"],function(c){c.register("CreateSecureFieldEvent");return"CreateSecureFieldEvent"});l("events/RemoveSecureFieldEvent",["public-event-registry"],function(c){c.register("RemoveSecureFieldEvent");return"RemoveSecureFieldEvent"});l("events/SecureFieldValidationEvent",["public-event-registry"],function(c){c.register("SecureFieldValidationEvent");return"SecureFieldValidationEvent"});l("events/SecureFieldRemovedEvent",
["public-event-registry"],function(c){c.register("SecureFieldRemovedEvent");return"SecureFieldRemovedEvent"});l("mixins/SecureFieldsFormComponent","jQuery component lang AUI!P clog SecureFieldsInitializationConstants events/SubmitSecureFieldDataEvent events/SecureFieldDataReadyEvent events/SecureFieldsInitializationStatusEvent events/InitializeSecureFieldsEvent events/SecureFieldRemovedEvent".split(" "),function(c,d,f,h,g,a,m,k,e,b,n){return{initialize:function(b,c){this.token=c.data.token;this.formJsBinding=
c.data.formJsBinding;this.secureFieldsEnabled=c.data.secureFieldsEnabled;this.prefetchSecureHandlerEnabled=c.data.prefetchSecureHandlerEnabled;this.initializationStatus=a.UNINITIALIZED;this.useStatic=c.data.useStatic;this.domain=c.data.domain;this.siegeProfileName=c.data.siegeProfileName;this.metricPrefix=this.useStatic?"Static":""},_create:function(b){var c=this;if(c.initializationStatus===a.UNINITIALIZED&&"undefined"!==typeof b){g.logCounterMetric({feature:c.metricPrefix+"SecureHandlerRequested",
resource:"_Count"});g.publishMetrics();c._setAndTriggerInitializationStatusEvent(c,a.PENDING);var e=(new Date).getTime();b.create(c.useStatic&&c.domain&&c.siegeProfileName?{domain:c.domain,siegeProfileName:c.siegeProfileName}:{token:c.token},r,c.useStatic).then(function(){g.logLatencyMetric({feature:c.metricPrefix+"SecureHandlerLoaded",resource:"_Latency",startTime:e});c._setAndTriggerInitializationStatusEvent(c,a.INITIALIZED);g.publishMetrics()}).catch(function(b){p.ueLogError&&p.ueLogError(b,{logLevel:"ERROR",
attribution:"apx_secure_fields",message:"Secure Handler Failed to Load: "});g.logCounterMetric({feature:c.metricPrefix+"SecureHandlerLoadingFailed",resource:"_Count"});c._setAndTriggerInitializationStatusEvent(c,a.FAILED);g.publishMetrics()})}},_setAndTriggerInitializationStatusEvent:function(b,a){b.initializationStatus=a;b.widget.trigger(e,{status:a})},bindToEvents:function(){var c=this;c.secureFieldsEnabled&&(c.token&&""!==c.token||c.useStatic&&c.domain&&c.siegeProfileName?c.prefetchSecureHandlerEnabled&&
h.now("apx-secure-fields").execute(function(b){"undefined"!==typeof b?c._create(b):(g.logCounterMetric({feature:"SecureFieldsSDKUnavailableOnInit",resource:"_Count"}),g.publishMetrics())}):(g.logCounterMetric({feature:"SecureFieldsInvalidToken",resource:"_Count"}),g.publishMetrics()),c.widget.on(b,c,function(b){c._create(b)}),c.widget.on(m,c,function(b){c.initializationStatus!==a.INITIALIZED?(g.logCounterMetric({feature:c.metricPrefix+"SecureFieldsSubmitError.SecureHandler."+c.initializationStatus,
resource:"_Count"}),c.widget.trigger(k,{contextId:b&&b.contextId,error:Error("SecureHandler is not loaded")}),g.publishMetrics()):h.when("apx-secure-fields").execute(function(a){a.submit(function(a){g.logCounterMetric({feature:c.metricPrefix+"SecureFieldsSubmitSuccess",resource:"_Count"});g.publishMetrics();if(a.data&&0!==Object.keys(a.data).length){var e=c.getDOMElement(c.formJsBinding),d;for(d in a.data){if(typeof a.data[d]===r||0===f.trim(a.data[d]).length)g.logCounterMetric({feature:c.metricPrefix+
"SecureFieldsSubmitEmpty",resource:"_Count"}),g.publishMetrics();var n=e.find("input[type\x3d'hidden'][name\x3d'apx-secure-field-"+d+"']");0<n.length?n.val(a.data[d]):e.append(c._buildHiddenInput(d,a.data[d]))}c.widget.trigger(k,{contextId:b&&b.contextId})}else g.logCounterMetric({feature:c.metricPrefix+"SecureFieldsSubmitEmpty",resource:"_Count"}),g.publishMetrics()},function(a){g.logCounterMetric({feature:c.metricPrefix+"SecureFieldsSubmitError",resource:"_Count"});g.publishMetrics();c.widget.trigger(k,
{contextId:b&&b.contextId,error:a})},c.useStatic)})}),c.widget.on(n,c,function(b){c.getDOMElement(c.formJsBinding).find("input[type\x3d'hidden'][name\x3d'apx-secure-field-"+b.secureFieldName+"']").remove()}))},_buildHiddenInput:function(b,a){return c("\x3cinput\x3e").attr({type:"hidden",name:"apx-secure-field-"+b,value:a})}}});l("events/SubmitSecureFieldDataEvent",["public-event-registry"],function(c){c.register("SubmitSecureFieldDataEvent");return"SubmitSecureFieldDataEvent"});l("events/SecureFieldDataReadyEvent",
["public-event-registry"],function(c){c.register("SecureFieldDataReadyEvent");return"SecureFieldDataReadyEvent"});l("events/SecureFieldsInitializationStatusEvent",["public-event-registry"],function(c){c.register("SecureFieldsInitializationStatusEvent");return"SecureFieldsInitializationStatusEvent"});l("events/InitializeSecureFieldsEvent",["public-event-registry"],function(c){c.register("InitializeSecureFieldsEvent");return"InitializeSecureFieldsEvent"});l("SecureFieldsInitializationConstants",[],
function(){return{UNINITIALIZED:"Uninitialized",PENDING:"Pending",INITIALIZED:"Initialized",FAILED:"Failed"}});l("mixins/b2b-cross-wallet-mixin",["lang"],function(c){var d=["GC","JPPoints","ProductVoucher","PROMO"],f={matchByDescriptorId:function(a,d){return c.isArray(d)&&c.isDefined(a.instrumentId)&&c.some(d,function(d){return c.isString(d)&&0<=a.instrumentId.indexOf(d)})}},h={InstrumentRowSelected:function(a,d){var g=c.isDefined(a.instrumentId);a=!1!==a.isInstrumentOwned;return!0===g&&a!==d.isCurrentPaymentMethodOwnedByOrderingCustomer()},
balanceSelectionChanged:function(a,g){var f=!1!==a.isInstrumentOwned;return!0===(!0===a.isSelected&&!a.isBackingInstrument)&&0<=c.indexOf(d,a.paymentMethod)&&f!==g.isCurrentPaymentMethodOwnedByOrderingCustomer()}},g=function(a,d){return c.isDefined(a)&&c.isDefined(d._b2bMultitenderRules)&&c.isDefined(d._b2bMultitenderRules.disablingRules)&&c.some(c.keys(d._b2bMultitenderRules.disablingRules),function(g){return c.isFunction(f[g])?f[g](a,d._b2bMultitenderRules.disablingRules[g]):!1})};return c.extend({},
{initialize:function(a,c){this._isB2BCrossWalletMultitenderEnforcementEnabled=!0===c.data.isB2BCrossWalletMultitenderEnforcementEnabled;this._b2bMultitenderRules=c.data.b2bMultitenderRules||{}},shouldBeDisabledPerB2BMultitenderRules:function(a){return!0!==this._isB2BCrossWalletMultitenderEnforcementEnabled?!1:g(a,this)},shouldBeDeselectedPerB2BMultitenderRules:function(a,d){return!0!==this._isB2BCrossWalletMultitenderEnforcementEnabled?!1:c.isDefined(a)&&c.isDefined(d)&&c.isDefined(this)&&c.isFunction(h[a])&&
h[a](d,this)},isCurrentPaymentMethodOwnedByOrderingCustomer:function(){return!1!==this.data.isOwned}})});l("events/InstallmentOfferRowSelectedEvent",[],function(){return"InstallmentOfferRowSelectedEvent"});l("events/InstrumentRowSelectedEvent",["public-event-registry"],function(c){c.register("InstrumentRowSelected");return"InstrumentRowSelected"});l("components/RecommendedPaymentMethodCombinationComponent","css-utils continuable-component lang jQuery events/SelectablePaymentOptionEvents components/SelectablePaymentOptionListComponent".split(" "),
function(c,d,f,h,g,a){return a.extend({initialize:function(a,c){}})});l("components/SelectablePaymentMethodListItemComponent",["components/POAInstrumentListItemComponent"],function(c){return c});l("events/SelectablePaymentOptionEvents",["public-event-registry"],function(c){c.register("PaymentPlanSelected");return{paymentPlanSelectedPrepare:"paymentPlanSelectedPrepare",PaymentPlanSelected:"PaymentPlanSelected"}});l("components/SelectablePaymentOptionListComponent","css-utils continuable-component lang clog jQuery events/SelectablePaymentOptionEvents events/ShowAddPaymentInstrumentPage".split(" "),
function(c,d,f,h,g,a,m){var k=["EbtSnap","HealthBenefitsCard"],e=["EbtSnap"];return d.extend({_selectedBackingInstrument:null,_selectedOptionalInstruments:{},_eligibleBackingMethods:[],initialize:function(b,a){this.paymentMethodMap=g.parseJSON(a.data.paymentMethodMap);this.allowGCOnly=a.data.allowGCOnly;this.hasPurchaseTotal="undefined"!==typeof a.data.purchaseTotal;this.purchaseTotal=parseFloat(a.data.purchaseTotal);this.isGCOptionalPaymentInstrument=a.data.isGCOptionalPaymentInstrument;this.showFloatingContinueBarOnNonPaylastPspWithViewDetails=
a.data.showFloatingContinueBarOnNonPaylastPspWithViewDetails},_selectBackingInstrument:function(b){this._selectedBackingInstrument=b&&b.instrumentId?b:null;this._updatePaymentPlanState()},_selectOptionalInstrument:function(b){var a=this;f.forEachKeyValue(a._selectedOptionalInstruments,function(c,e){b&&e&&(a._isOptionalBackingInstrument(e.paymentMethodCode)||"RewardsAccount"===e.paymentMethod)&&e.paymentMethodCode===b.paymentMethodCode&&delete a._selectedOptionalInstruments[c]},a);a._selectedOptionalInstruments[b.instrumentId]=
b;b.eligibleBackingMethods&&(a._eligibleBackingMethods=b.eligibleBackingMethods);a._updatePaymentPlanState()},_deselectOptionalInstrument:function(b){delete this._selectedOptionalInstruments[b.instrumentId];delete this._eligibleBackingMethods;this._updatePaymentPlanState()},_triggerInitializeRecommendedInstrumentEvent:function(b,a){this.widget.trigger("initializeRecommendedInstrument",{instrumentId:b,paymentMethod:a});this._recordRecommendedInstrumentActionMetric(b)},_triggerPaymentPlanSelectedEvent:function(b,
c,e,d,g){c={isValid:b,message:c,notValidReason:e,paymentMethod:d,instrumentId:g,selectedOptionalInstruments:this._selectedOptionalInstruments};this.widget.trigger(a.paymentPlanSelectedPrepare,c);this.setContinuable(b);this.widget.trigger(a.PaymentPlanSelected,c);this.widget.log({event:a.PaymentPlanSelected,details:c})},_triggerUpiRedirectionRequiredEvent:function(){this.setContinuable(!0);this.widget.trigger("UpiRedirectionRequiredEvent")},_triggerAPPRedirectionRequiredEvent:function(){this.setContinuable(!0);
this.widget.trigger("APPRedirectionRequiredEvent")},_updatePaymentPlanState:function(){var b=null;if(this._isBackingEligible())if(this._selectedBackingInstrument)(b=this._firstElement(this._selectedBackingInstrument.errors))||(b=this._findOptionalInstrumentError());else if(this._hasOptionalBackingInstrument()){var a=0,c=!1,d;for(d in this._selectedOptionalInstruments)if(this._selectedOptionalInstruments.hasOwnProperty(d)){var g=this._selectedOptionalInstruments[d],c=c||-1!==e.indexOf(g.paymentMethodCode),
f=this._firstElement(g.errors);if(f){b=f;break}g=parseFloat(g.balance);g=isNaN(g)?0:g;a=this._add(a,g)}null==b&&!c&&this.hasPurchaseTotal&&(isNaN(this.purchaseTotal)||a<this.purchaseTotal)&&(b=this.widget.getLocalizedString("pmts_portal_payselect_empty_instrument_selection"))}else b=this._findOptionalInstrumentError(),null==b&&(b=this.widget.getLocalizedString("pmts_portal_payselect_empty_instrument_selection"));else b=this.widget.getLocalizedString("pmts_portal_require_backing_error_message",{paymentMethod:this._generateTooltipOfEligibleMethod()});
a=null;this._selectedBackingInstrument&&this._selectedBackingInstrument.paymentMethod&&(a=this._selectedBackingInstrument.paymentMethod);d=null;this._selectedBackingInstrument&&this._selectedBackingInstrument.instrumentId&&(d=this._selectedBackingInstrument.instrumentId);null==b?this._selectedBackingInstrument&&this._selectedBackingInstrument.isUpiRedirectionRequired?this._triggerUpiRedirectionRequiredEvent():this._selectedBackingInstrument&&this._selectedBackingInstrument.isAPPInstrumentRedirectionRequired?
this._triggerAPPRedirectionRequiredEvent():this._triggerPaymentPlanSelectedEvent(!0,null,null,a,d):this._triggerPaymentPlanSelectedEvent(!1,b,null,a,d)},_precision:function(b){if("number"!==typeof b||!isFinite(b))return 0;for(var a=1,c=0;Math.round(b*a)/a!==b;)a*=10,c++;return c},_add:function(b,a){if("number"!==typeof b||"number"!==typeof a)return 0;var c=Math.max(this._precision(b),this._precision(a));return parseFloat((b+a).toFixed(c))},_generateTooltipOfEligibleMethod:function(){var b="";if(this._eligibleBackingMethods&&
0<this._eligibleBackingMethods.length){for(var a=0,c=this._eligibleBackingMethods.length;a<c-1;a++)b+=this.widget.getLocalizedString(this.paymentMethodMap[this._eligibleBackingMethods[a]]),b+=",";b+=this.widget.getLocalizedString(this.paymentMethodMap[this._eligibleBackingMethods[c-1]])}return b},_isBackingEligible:function(){var b=this._selectedBackingInstrument&&"GC"===this._selectedBackingInstrument.paymentMethod;return!(this._eligibleBackingMethods&&0<this._eligibleBackingMethods.length&&b)},
_hasOptionalBackingInstrument:function(){for(var b in this._selectedOptionalInstruments)if(this._selectedOptionalInstruments.hasOwnProperty(b)){var a=this._selectedOptionalInstruments[b];if(a&&this._isOptionalBackingInstrument(a.paymentMethodCode,a.requireBackingInstrument))return!0}return!1},_findOptionalInstrumentError:function(){var b=null,a;for(a in this._selectedOptionalInstruments)if(this._selectedOptionalInstruments.hasOwnProperty(a)){var c=this._selectedOptionalInstruments[a],b=this._firstElement(c.errors);
if(null!==b)break;if("RewardsAccount"===c.paymentMethod&&(b=this._getRewardsAccountError(c),null!==b))break;if("FPS"===c.paymentMethod&&(b=this._getFPSError(),null!==b))break}return b},_isOptionalBackingInstrument:function(b,a){return this.allowGCOnly&&!1===a?!0:"GC"===b?!0===this.isGCOptionalPaymentInstrument:-1<f.indexOf(k,b)},_getFPSError:function(){return this._selectedBackingInstrument&&"CC"!==this._selectedBackingInstrument.paymentMethod?this.widget.getLocalizedString("apx_payselect_require_cc_for_fps"):
null},_getRewardsAccountError:function(b){return!this._selectedBackingInstrument||"CC"!==this._selectedBackingInstrument.paymentMethod||f.isDefined(b.parentInstrumentId)&&b.parentInstrumentId!==this._selectedBackingInstrument.instrumentId?this.widget.getLocalizedString("apx_child_rewards_account_credit_card_error"):null},_recordTogglePaymentMethodActionMetric:function(b){b&&b.instrumentId&&this.widget.publishSuccessSushiMetrics({ActionType:"toggle-payment-method",ActionValueType:"PaymentInstrument",
ActionValue:b.instrumentId})},_recordRecommendedInstrumentActionMetric:function(b){this.widget.publishSuccessSushiMetrics({ActionType:"recommended-instrument",ActionValueType:"PaymentInstrument",ActionValue:b})},_firstElement:function(b){return f.isArray(b)&&0<b.length?b[0]:null},_defaultInitialization:function(){this._triggerPaymentPlanSelectedEvent(!1,this.widget.getLocalizedString("pmts_portal_payselect_empty_instrument_selection"),"initial_widget_load_no_recommended_instrument")},bindToElements:function(){var b=
this;this.getDOMElement("apx-jigsaw-other-payment-instruments-expander").click(function(){h.logCounterMetric({feature:"JigsawOtherPaymentInstrumentsExpanderClicked",resource:"_Count"});h.publishMetrics()});b.getDOMElement("add-new-payment-method").click(function(a){b.widget.trigger(m)})},bindToEvents:function(){var b=this;b.widget.on("componentsInitialized",b,function(){b.data&&b.data.recommendedInstrumentId?(b._isOptionalBackingInstrument(b.data.recommendedInstrumentPaymentMethodCode,null)||(b._selectedBackingInstrument=
{instrumentId:b.data.recommendedInstrumentId,errors:null}),b.data.blockInitializeRecommendedInstrumentEvent||b._triggerInitializeRecommendedInstrumentEvent(b.data.recommendedInstrumentId,b.data.recommendedInstrumentPaymentMethodCode)):b._hasOptionalBackingInstrument()?b._updatePaymentPlanState():b._defaultInitialization();b.widget.trigger("preselectAPB")});b.widget.on("backingInstrumentSelected",b,function(a){b._selectBackingInstrument(a)});b.widget.on("backingInstrumentDeselected",b,function(a){b._selectBackingInstrument(a)});
b.widget.on("optionalInstrumentSelected",b,function(a){b._selectOptionalInstrument(a)});b.widget.on("optionalInstrumentDeselected",b,function(a){b._deselectOptionalInstrument(a)});b.widget.on("APBPreselected",b,function(b){this._triggerPaymentPlanSelectedEvent(!0,null,null)});b.widget.on("SuppressedZipOptionSelected",b,function(a){this._triggerPaymentPlanSelectedEvent(!1,b.widget.getLocalizedString("pmts_portal_zp_error_insufficient_popover"),null)});b.widget.on("SuppressedNetBankingOptionSelected",
b,function(a){b._triggerPaymentPlanSelectedEvent(!1,b.widget.getLocalizedString("payselect_bankTemporarilyNotAvailable"))});b.widget.on("ValidNetBankingOptionSelected",b,function(b){this._triggerPaymentPlanSelectedEvent(!0)});b.widget.on("NoNetBankingOptionSelected",b,function(a){this._triggerPaymentPlanSelectedEvent(!1,b.widget.getLocalizedString("pmts_portal_payselect_empty_netbanking_selection"))});b.widget.on("InstrumentRowSelected",b,function(b){this._recordTogglePaymentMethodActionMetric(b)});
if(this.data.paylastOrderSummaryEnabled||this.showFloatingContinueBarOnNonPaylastPspWithViewDetails)b.widget.on("apbSelectionChanged",b,function(a){b._selectedBackingInstrument&&b._selectedBackingInstrument.paymentMethod&&("CC"===b._selectedBackingInstrument.paymentMethod||"UPI"===b._selectedBackingInstrument.paymentMethod||b._selectedBackingInstrument.instrumentType&&"CashOnDelivery"===b._selectedBackingInstrument.instrumentType)||this._updatePaymentPlanState()});if((this.data.paylastOrderSummaryEnabled||
this.showFloatingContinueBarOnNonPaylastPspWithViewDetails)&&!this.data.skipFormValidation)b.widget.on("installmentOptionChanged",b,function(b){this._updatePaymentPlanState()});f.forEach(["selectableAddCreditCardSelected","selectableAddDebitCardSelected","selectableDebitCardSelectedDisableContinue"],function(a){b.widget.on(a,b,function(a){b._triggerPaymentPlanSelectedEvent(!1,b.widget.getLocalizedString("pmts_portal_payselect_empty_card_selection"))})})}})});l("components/SimplePaymentOptionListItemComponent",
"events/InstrumentRowSelectedEvent css-utils form-component lang continuable mixins/disable-component".split(" "),function(c,d,f,h,g,a){return f.extend(g,a,{isPaymentOptionEditable:!0,bindToElements:function(){var a=this;a.isPaymentOptionEditable&&a._getContainerElement().click(function(){var c=h.isDefined(a.data.isSuppressed)?a.data.isSuppressed:!1;a._isInstrumentSelected()||a.isDisabled()||c||a._triggerInstrumentRowSelectedEvent()})},bindToEvents:function(){var a=this;h.forEach(["initializeRecommendedInstrument",
c],function(c){a.widget.on(c,a,function(c){c.instrumentId===a._getInstrumentId()?a._onInstrumentSelected():a._onInstrumentDeselected()})});this.widget.on("APBPreselected",this,function(a){this._onInstrumentDeselected()})},_getContainerElement:function(){return this.getDOMElement("instrumentContainer")},_isInstrumentSelected:function(){return this._getContainerElement().hasClass("pmts-selected")},_getInstrumentSelectionInputElement:function(){return this.getDOMElement("instrumentRowSelection-"+this._getInstrumentId())},
_getInstrumentId:function(){return this.data.instrumentId},_getInstrumentType:function(){return this.data.instrumentType},_getPaymentMethodCode:function(){return this.data.paymentMethod},_getIsOwned:function(){return h.isDefined(this._isOwned)?this._isOwned:!0},_getIsRecurringChargePaymentMethod:function(){return this.data.isRecurringChargePaymentMethod},_triggerInstrumentRowSelectedEvent:function(a){this.widget.trigger(c,{instrumentId:this._getInstrumentId(),instrumentType:this._getInstrumentType(),
isInstrumentOwned:this._getIsOwned(),isRecurringChargePaymentMethod:this._getIsRecurringChargePaymentMethod(),paymentMethod:this._getPaymentMethodCode()})},_triggerBackingInstrumentSelectedEvent:function(a){this.widget.trigger("backingInstrumentSelected",{instrumentId:this._getInstrumentId(),instrumentType:this._getInstrumentType(),errors:a,paymentMethod:this.data.paymentMethod})},_onInstrumentSelected:function(){this._getContainerElement().addClass("pmts-selected");this._getInstrumentSelectionInputElement().prop("checked",
!0);this._triggerBackingInstrumentSelectedEvent(this._getDisplayableErrors(this.form.validateForm(!0)))},_onInstrumentDeselected:function(){this._getContainerElement().removeClass("pmts-selected");this._getInstrumentSelectionInputElement().prop("checked",!1)},_getDisplayableErrors:function(a){if(0===a.length)return null;var c=[];h.forEach(a,function(a){c.push(a.localizedMessageString)});return c},_updateBackingInstrumentState:function(){this._isInstrumentSelected()&&(this._onInstrumentDeselected(),
this.widget.trigger(c,{}),this.widget.trigger("backingInstrumentSelected",{}))},onDisabledChange:function(a){a&&this._isInstrumentSelected()&&(this._getInstrumentSelectionInputElement().prop("checked",!1),this.widget.trigger(c,{}))}})});l("components/PaymentMethodListComponent",["component"],function(c){return c.extend({bindToEvents:function(){var c=this;c.widget.on("componentsInitialized",c,function(){c.data&&c.data.recommendedInstrumentId&&c._triggerInitializeRecommendedInstrumentEvent(c.data.recommendedInstrumentId)});
c.widget.on("submitSelectInstrumentForm",c,function(){c.getDOMElement("apx-select-instrument-form").submit()})},_triggerInitializeRecommendedInstrumentEvent:function(c){this.widget.trigger("initializeRecommendedInstrument",{instrumentId:c})}})});l("components/SelectableAddCreditCardComponent",["lang","component","css-utils","events/InstrumentRowSelectedEvent","components/SimplePaymentOptionListItemComponent"],function(c,d,f,h,g){return g.extend({addCardIntermittentStepRemoved:!1,initialize:function(a,
c){this.addCardIntermittentStepRemoved=c.data.addCardIntermittentStepRemoved;this._isMShop=c.data.isMShop;this._containerBinding=c.data.selectableCardContainerBinding;this._isDebit="DebitCard"===this.data.placementType;this.isPaylastEligible=c.data.isPaylastEligible;this.showFloatingContinueBarOnNonPaylastPSP=c.data.showFloatingContinueBarOnNonPaylastPSP;self=this;C.when("A","ready").execute(function(a){self._isInlineAddCardEnabled=0===a.$("#apx-add-credit-card-action-test-id").length})},_onInstrumentSelected:function(){this._getContainerElement().addClass("pmts-selected");
this._getInstrumentSelectionInputElement().prop("checked",!0);this._isDebit?this.widget.trigger("selectableAddDebitCardSelected"):this.widget.trigger("selectableAddCreditCardSelected");(this.isPaylastEligible||this.showFloatingContinueBarOnNonPaylastPSP)&&this._resetOrderTotalComputation();if(this.addCardIntermittentStepRemoved){var a=this.getDOMElement("addCardButtonBinding");null!==a&&a.trigger("click");if(!this._isInlineAddCardEnabled)if(this._isMShop)this._delay(this).then(this._resetAddCardInstrument);
else this.widget.on("pmts-close-add-card-form",this,this._resetAddCardInstrument)}},_onInstrumentDeselected:function(){this._getContainerElement().removeClass("pmts-selected");this._getInstrumentSelectionInputElement().prop("checked",!1);this._isDebit?this.widget.trigger("selectableAddDebitCardDeselected"):this.widget.trigger("selectableAddCreditCardDeselected");this.addCardIntermittentStepRemoved&&!this._isMShop&&this.widget.off("pmts-close-add-card-form",this,this._resetAddCardInstrument)},_resetAddCardInstrument:function(a){a||
(a=this);a.widget.trigger(h,{})},_delay:function(a){return new Promise(function(c,d){setTimeout(function(){c(a)},1E3)})},_getContainerElement:function(){return this.getDOMElement(this._containerBinding)},_resetOrderTotalComputation:function(){this.widget.trigger("UpdateOrderTotalForIBDEvent",{ibdAmountDisplayed:0});this.widget.trigger("UpdateOrderTotalForNoCostEMIDiscount",{noCostEMIValue:0})},bindToEvents:function(){var a=this;c.forEach(["initializeRecommendedInstrument",h],function(c){a.widget.on(c,
a,function(c){c.instrumentId===this._getInstrumentId()?a._onInstrumentSelected():a._onInstrumentDeselected()})})}})});l("components/SelectablePayCodeListComponent",["form-component"],function(c){return c});l("components/SelectablePayCodeListItemComponent",["components/SelectableDPMInstrumentListItemComponent","events/InstrumentRowSelectedEvent","clog"],function(c,d,f){return c.extend({initialize:function(c,d){this.isPayCodeMultiTenderEnabled=d.data.isPayCodeMultiTenderEnabled;this.paymentMethod=d.data.paymentMethod},
poaInstrumentClicked:function(c){this.widget.trigger(d,{instrumentId:c,isPayCodeMultiTenderEnabled:this.isPayCodeMultiTenderEnabled,paymentMethod:this.paymentMethod});f.logCounterMetric({feature:"AmazonPayCodeMultiTender"+(this.isPayCodeMultiTenderEnabled?".Enabled":".Disabled"),resource:"_Count"});f.publishMetrics()}})});l("components/APBListItemComponent","events/InstrumentRowSelectedEvent jQuery css-utils component mixins/disable-component lang clog".split(" "),function(c,d,f,h,g,a,m){var k=!1;
return h.extend(g,{initialize:function(c,b){this.$wave2=b.data.wave2Enabled;this.apbBalance=b.data.apbBalance;this.apbTotalBalance=b.data.apbTotalBalance;this.isClientGiftCardEligible=null==b.data.isClientGiftCardEligible?!0:b.data.isClientGiftCardEligible;this.isRadioButtonDisplay=b.data.canCoverPurchase;this.apbId=b.data.apbId;this.svaId=b.data.svaId;this.gcId=b.data.gcId;this.preselectApb=b.data.selectApbAtStart;this.isPaylastEligible=b.data.isPaylastEligible;this.showFloatingContinueBarOnNonPaylastPSP=
b.data.showFloatingContinueBarOnNonPaylastPSP;this.isCODAPBToggleEnabled=b.data.isCODAPBToggleEnabled;this.isAPBContainerWhenAPVIsSelectedRequired=b.data.isAPBContainerWhenAPVIsSelectedRequired;this.storedValueId=b.data.storedValueId;this.giftCardId=b.data.giftCardId;this.isTurbo=b.data.isTurbo;this.apbNomenclatureWave1WeblabEnabled=this.getDOMElement("wave1WeblabEnabled");this.apbPaymentMethodCategory=b.data.apbPaymentMethodCategory;this.$checkbox=this.getDOMElement("APBSelection");this.$checkboxContainer=
this.getDOMElement("apbCheckboxDisplay");this.$radioButton=this.getDOMElement("instrumentRowSelection-"+this.apbId);this.$radioButtonContainer=this.getDOMElement("apbRadioButtonDisplay");this.$apbSubContainer=this.getDOMElement("apbSubContainer");this.$container=this.getDOMElement("apbContainer");this.$apbContainerWhenAPVIsSelectedForWave2=this.getDOMElement("apbWhenAPVSelectedContainerJS");this.$apbContainerWhenAPVIsSelected=this.getDOMElement("apbContainerWhenAPVIsSelected");this.$apbRadioButtonWhenAPVIsSelected=
this.getDOMElement("instrumentRowSelection-APBWhenAPVIsSelected");this._setApb(this.preselectApb);k=a.isDefined(b.data.isSuppressed)&&b.data.isSuppressed},_checkFormInput:function(a){this._getIsRadioButtonDisplay()?this._getRadioButton().prop("checked",a):this.$checkbox.prop("checked",a)},_toggleOptionalApb:function(){if(!this.$checkbox.prop("disabled")){var a=this.$checkbox.prop("checked");this._setApb(!a)}},_toggleApbRowIfRadioButton:function(a){this.$wave2&&this.$apbContainerWhenAPVIsSelectedForWave2.toggleClass("pmts-selected",
a);this.$container.toggleClass("pmts-selected",a);var b=this._getActiveContainer().find(".a-touch-radio .a-icon");b.toggleClass("a-icon-radio-active",a);b.toggleClass("a-icon-radio-inactive",!a)},_toggleApbRowIfCheckbox:function(a){(this.apbNomenclatureWave1WeblabEnabled||this.isTurbo)&&this.$container.toggleClass("pmts-selected",a)},_setApb:function(a){a?this._selectApb():this._unSelectApb()},_unSelectApb:function(){this._checkFormInput(!1);this._getIsRadioButtonDisplay()?(this._toggleApbRowIfRadioButton(!1),
(this.isPaylastEligible||this.showFloatingContinueBarOnNonPaylastPSP)&&this.widget.trigger("UpdateOrderTotalForAPBEvent",{isApbSelected:!1,apbBalance:this.apbBalance})):(this._toggleApbRowIfCheckbox(!1),this._setCheckboxSelectedAttribute(!1),this._triggerApbSelectionChangedEvent(!1))},_selectApb:function(){this._checkFormInput(!0);this._getIsRadioButtonDisplay()?(this._toggleApbRowIfRadioButton(!0),this._triggerBackingInstrumentSelectedEvent(this.apbId,null),(this.isPaylastEligible||this.showFloatingContinueBarOnNonPaylastPSP)&&
this.widget.trigger("UpdateOrderTotalForAPBEvent",{isApbSelected:!0,apbBalance:this.apbBalance})):(this._toggleApbRowIfCheckbox(!0),this._setCheckboxSelectedAttribute(!0),this._triggerApbSelectionChangedEvent(!0))},_toggleRadioButtonDisplay:function(a){f.toggleElement(this.$radioButtonContainer,a);f.toggleElement(this.$checkboxContainer,!a)},_triggerApbSelectionChangedEvent:function(a){this.widget.trigger("apbSelectionChanged",{isSelected:a,isCODAPBToggleEnabled:this.isCODAPBToggleEnabled,canCoverPurchaseStandalone:this.isRadioButtonDisplay,
giftCardId:this.giftCardId,storedValueId:this.storedValueId});(this.isPaylastEligible||this.showFloatingContinueBarOnNonPaylastPSP)&&this.widget.trigger("UpdateOrderTotalForAPBEvent",{isApbSelected:a,apbBalance:this.apbBalance})},_setCheckboxSelectedAttribute:function(a){this.widget.set("apbCheckboxSelected",a)},_triggerOptionalInstrumentSelectedEvent:function(){var a=this.widget.getLocalizedString("pmts_portal_payselect_empty_instrument_selection");this.widget.trigger("optionalInstrumentSelected",
{instrumentId:this.apbId,errors:a})},_triggerOptionalInstrumentDeselectedEvent:function(){this.widget.trigger("optionalInstrumentDeselected",{instrumentId:this.apbId})},_triggerBackingInstrumentSelectedEvent:function(a,b){this.widget.trigger("backingInstrumentSelected",{instrumentId:a,errors:b,paystationPaymentMethodCategory:this.apbPaymentMethodCategory,storedValueId:this.storedValueId,giftCardId:this.giftCardId,redeemableAPBBalance:this.apbBalance,totalAPBBalance:this.apbTotalBalance})},_triggerInstrumentRowSelectedEvent:function(){this.widget.trigger(c,
{instrumentId:this.apbId})},_isApbSelectedAsInstrument:function(){return this._getActiveContainer().hasClass("pmts-selected")},_toggleBetweenDefaultAndAPBContainerWhenAPVIsSelected:function(a){this.isAPBContainerWhenAPVIsSelectedRequired&&(f.toggleElement(this.$apbContainerWhenAPVIsSelected,a),f.toggleElement(this.$apbSubContainer,!a))},_getActiveContainer:function(){return this._isAPBContainerWhenAPVIsSelectedActive()?this.$wave2?this.$apbContainerWhenAPVIsSelectedForWave2:this.$apbContainerWhenAPVIsSelected:
this.$container},_getRadioButton:function(){return this._isAPBContainerWhenAPVIsSelectedActive()?this.$apbRadioButtonWhenAPVIsSelected:this.$radioButton},_isAPBContainerWhenAPVIsSelectedActive:function(){return this.isAPBContainerWhenAPVIsSelectedRequired?this.$wave2?!f.hasAUIHiddenClass(this.$apbContainerWhenAPVIsSelectedForWave2):!f.hasAUIHiddenClass(this.$apbContainerWhenAPVIsSelected):!1},_getIsRadioButtonDisplay:function(){return this._isAPBContainerWhenAPVIsSelectedActive()?!0:this.isRadioButtonDisplay},
_isAPBInputButtonChecked:function(){return this.isRadioButtonDisplay?this.$radioButton.prop("checked"):this.$checkbox.prop("checked")},_resetAPBContainerWhenAPVIsSelected:function(){this.isAPBContainerWhenAPVIsSelectedRequired&&this.$apbRadioButtonWhenAPVIsSelected.prop("checked",!1)},_toggleAPBInputButton:function(a){this.isRadioButtonDisplay?this.$radioButton.prop("checked",a):this.$checkbox.prop("checked",a)},_renderAPBContainerWhenAPVIsSelected:function(){if(this.isAPBContainerWhenAPVIsSelectedRequired){var a=
this._isAPBInputButtonChecked();this.$apbRadioButtonWhenAPVIsSelected.prop("checked",a);this.$container.toggleClass("pmts-selected",a);this._toggleAPBInputButton(!1);this._toggleBetweenDefaultAndAPBContainerWhenAPVIsSelected(!0);a&&!this.isRadioButtonDisplay&&(this._setApb(!0),this._triggerInstrumentRowSelectedEvent())}},_renderAPBContainerWhenAPVIsSelectedWhenWave2IsEnabled:function(){if(this.isAPBContainerWhenAPVIsSelectedRequired){var a=this._isAPBInputButtonChecked();this.$apbRadioButtonWhenAPVIsSelected.prop("checked",
a);this.$apbContainerWhenAPVIsSelectedForWave2.toggleClass("pmts-selected",a);this._toggleAPBInputButton(!1);f.toggleElement(this.$apbContainerWhenAPVIsSelectedForWave2,!0);f.toggleElement(this.$container,!1);a&&(this._setApb(!0),this._triggerInstrumentRowSelectedEvent())}},_renderAPBContainerWhenAPVIsDeselected:function(){if(this.isAPBContainerWhenAPVIsSelectedRequired){var a=this.$apbRadioButtonWhenAPVIsSelected.prop("checked");this._toggleAPBInputButton(a);this.isRadioButtonDisplay||this.$container.toggleClass("pmts-selected",
!1);this._resetAPBContainerWhenAPVIsSelected();this._toggleBetweenDefaultAndAPBContainerWhenAPVIsSelected(!1);a&&!this.isRadioButtonDisplay&&this._triggerBackingInstrumentSelectedEvent(null,null)}},_renderAPBContainerWhenAPVIsDeselectedWhenWave2IsEnabled:function(){if(this.isAPBContainerWhenAPVIsSelectedRequired){var a=this.$apbRadioButtonWhenAPVIsSelected.prop("checked");this._toggleAPBInputButton(a);this._resetAPBContainerWhenAPVIsSelected();f.toggleElement(this.$apbContainerWhenAPVIsSelectedForWave2,
!1);f.toggleElement(this.$container,!0);a&&!this.isRadioButtonDisplay&&this._triggerBackingInstrumentSelectedEvent(null,null)}},bindToElements:function(){var a=this;k||(this.$wave2&&a.$apbContainerWhenAPVIsSelectedForWave2.click(function(b){a._getIsRadioButtonDisplay()?a._isApbSelectedAsInstrument()||a.isDisabled()||a._triggerInstrumentRowSelectedEvent():"a"!==b.target.tagName.toLowerCase()&&(b.preventDefault(),a._toggleOptionalApb())}),a.$container.click(function(b){a._getIsRadioButtonDisplay()?
a._isApbSelectedAsInstrument()||a.isDisabled()||a._triggerInstrumentRowSelectedEvent():"a"!==b.target.tagName.toLowerCase()&&(b.preventDefault(),a._toggleOptionalApb())}),a.$checkbox.click(function(b){var c=a.$checkbox.prop("checked");a._setApb(c);b.stopPropagation()}));this._isDesktop?(a.getDOMElement("APBRecommendationMessageLink").mouseover(function(){a.widget.publishSuccessSushiMetrics({ActionValue:"APBRecommendationMessagePopover",ActionValueType:"Mouseover"})}),a.getDOMElement("APBRecommendationMessageLinkWhenAPVIsSelected").mouseover(function(){a.widget.publishSuccessSushiMetrics({ActionValue:"APBRecommendationMessageLinkWhenAPVIsSelected",
ActionValueType:"Mouseover"})})):(a.getDOMElement("APBRecommendationMessageLink").click(function(){a.widget.publishSuccessSushiMetrics({ActionValue:"APBRecommendationMessagePopover",ActionValueType:"Click"})}),a.getDOMElement("APBRecommendationMessageLinkWhenAPVIsSelected").click(function(){a.widget.publishSuccessSushiMetrics({ActionValue:"APBRecommendationMessageLinkWhenAPVIsSelected",ActionValueType:"Click"})}));a.getDOMElement("APBRadioButtonAddMoneyLink").click(function(){a.widget.publishSuccessSushiMetrics({ActionValue:"APBRadioButtonAddMoneyLink",
ActionValueType:"Click"});m.logCounterMetric({feature:"APBRadioButtonAddMoneyLinkClicked",resource:"_Count"});m.publishMetrics()});a.getDOMElement("APBCheckboxAddMoneyLink").click(function(){a.widget.publishSuccessSushiMetrics({ActionValue:"APBCheckboxAddMoneyLink",ActionValueType:"Click"});m.logCounterMetric({feature:"APBCheckboxAddMoneyLinkClicked",resource:"_Count"});m.publishMetrics()});a.getDOMElement("APBNomenclatureAddMoneyLink").click(function(){a.widget.publishSuccessSushiMetrics({ActionValue:"APBNomenclatureAddMoneyLink",
ActionValueType:"Click"});m.logCounterMetric({feature:"APBNomenclatureAddMoneyLinkClicked",resource:"_Count"});m.publishMetrics()})},_deselectAPBCheckbox:function(){var a=!this.$checkbox.prop("disabled"),b=this.$checkbox.prop("checked");a&&b&&(this.$checkbox.prop("checked",!1),this._setApb(!1))},bindToEvents:function(){var a=this;a.widget.on(c,a,function(b){a._getIsRadioButtonDisplay()?a._setApb(b.instrumentId===a.apbId):a.$checkbox.prop("disabled",!this.isClientGiftCardEligible||k)});if(a.isCODAPBToggleEnabled)a.widget.on("codSelectionEvent",
a,function(b){if(!a._getIsRadioButtonDisplay()){b=!a.$checkbox.prop("disabled");var c=a.$checkbox.prop("checked");b&&c&&(a._unSelectApb(),a.widget.trigger("apbDeselectMessageEventOnCodSelection"))}});a.widget.on("initializeRecommendedInstrument",a,function(b){b.instrumentId!==a.gcId&&b.instrumentId!==a.svaId&&b.instrumentId!==a.apbId&&b.instrumentId!==a.storedValueId&&b.instrumentId!==a.giftCardId||a._triggerInstrumentRowSelectedEvent()});a.widget.on("preselectAPB",a,function(b){b=a.data.isPreselectionEnabled!==
r?a.data.isPreselectionEnabled:!1;this._getIsRadioButtonDisplay()&&!b&&this.widget.trigger("APBPreselected")});a.widget.on("componentsInitialized",a,function(){if(!a._getIsRadioButtonDisplay()){var b=a.widget.get("apbCheckboxSelected");b!==r&&a._setApb(b);a.$checkbox.prop("checked")&&a._triggerBackingInstrumentSelectedEvent(null,null)}});a.widget.on("apvSelectionChanged",a,function(b){a.isAPBContainerWhenAPVIsSelectedRequired?b.isSelected&&!a._isAPBContainerWhenAPVIsSelectedActive()?this.$wave2?a._renderAPBContainerWhenAPVIsSelectedWhenWave2IsEnabled():
a._renderAPBContainerWhenAPVIsSelected():!b.isSelected&&a._isAPBContainerWhenAPVIsSelectedActive()&&(this.$wave2?a._renderAPBContainerWhenAPVIsDeselectedWhenWave2IsEnabled():a._renderAPBContainerWhenAPVIsDeselected()):b.isSelected&&b.canCoverPurchaseStandalone&&(a._getIsRadioButtonDisplay()||a._deselectAPBCheckbox())})}})});l("events/BalanceInfoEvent",["public-event-registry"],function(c){c.register("BalanceInfoEvent");return"BalanceInfoEvent"});l("components/FPSListItemComponent",["events/InstrumentRowSelectedEvent",
"component"],function(c,d){return d.extend({initialize:function(c,d){this.instrumentId=d.data.instrumentId;this.paymentMethod=d.data.paymentMethod;this.$container=this.getDOMElement("fpsContainer");this.$checkbox=this.getDOMElement("fpsSelection")},bindToElements:function(){var c=this;c.$container.click(function(c){c.preventDefault();c=this.$checkbox.prop("checked");this._setFPS(!c)});c.$checkbox.click(function(d){var g=c.$checkbox.prop("checked");c._setFPS(g);d.stopPropagation()})},_setFPS:function(c){c?
this._selectFPS():this._deselectFPS()},_selectFPS:function(){this.widget.trigger("optionalInstrumentSelected",{instrumentId:this.instrumentId,paymentMethod:this.paymentMethod});this.$checkbox.prop("checked",!0)},_deselectFPS:function(){this.widget.trigger("optionalInstrumentDeselected",{instrumentId:this.instrumentId});this.$checkbox.prop("checked",!1)}})});l("components/GiftCardListItemComponent","events/InstrumentRowSelectedEvent jQuery css-utils component lang post-pay-utils clog events/BalanceInfoEvent mixins/b2b-cross-wallet-mixin digital-wallet-utils AUI!P".split(" "),
function(c,d,f,h,g,a,m,k,e,b,n){return h.extend(e,{_isProductVoucherSelected:!1,_isPromoBalanceSelected:!1,_isPostPaySelected:!1,_isNotOwnedInstrumentSelected:!1,initialize:function(a,b){this.canCoverThePurchaseWithNonStandaloneProductVoucherAndPromo=b.data.canCoverThePurchaseWithNonStandaloneProductVoucherAndPromo;this.canCoverThePurchaseWithNonStandaloneProductVoucher=b.data.canCoverThePurchaseWithNonStandaloneProductVoucher;this.canCoverThePurchaseWithNonStandalonePromo=b.data.canCoverThePurchaseWithNonStandalonePromo;
this.canCoverThePurchaseStandalone=b.data.canCoverThePurchaseStandalone;this.canCoverPurchaseWithOutPromo=b.data.canCoverPurchaseWithOutPromo;this.canCoverPurchaseWithNonStandalonePromo=b.data.canCoverThePurchaseWithNonStandalonePromo;this.promoCanCoverPurchaseWithOutGC=b.data.promoCanCoverPurchaseWithOutGC;this.giftCardBalance=b.data.giftCardBalance;this.giftCardBalanceValue=b.data.giftCardBalanceValue;this.displayablePurchaseTotal=b.data.displayablePurchaseTotal;this.displayableAdjustedPurchaseTotal=
b.data.displayableAdjustedPurchaseTotal;this.requireBackingInstrument=b.data.requireBacking;this.eligibleBackingMethods=b.data.eligibleBackingMethods;this.promoIdentifier=b.data.promoIdentifier;this.productVoucherIdentifier=b.data.productVoucherIdentifier;this.isClientGiftCardEligible=null==b.data.isClientGiftCardEligible?!0:b.data.isClientGiftCardEligible;this.isRadioButtonDisplay=(this.canCoverPurchaseWithOutPromo||this.canCoverThePurchaseWithNonStandaloneProductVoucherAndPromo)&&this.isClientGiftCardEligible;
this.isMultiTenderDisabledWithCashOnDelivery=b.data.isMultiTenderDisabledWithCashOnDelivery;this.giftCardId=b.data.giftCardId;this.disableGCWithMCB=b.data.disableGCWithMCB;this.isMultitenderDisabledWithPostPay=b.data.isMultitenderDisabledWithPostPay;this.isMultiTenderEnabledWithZip=b.data.isMultiTenderEnabledWithZip;this.isMultiTenderEnabledWithPayLaterAccount=b.data.isMultiTenderEnabledWithPayLaterAccount;this.disallowAutoSelectionWhenConvertingToCheckbox=b.data.disallowAutoSelectionWhenConvertingToCheckbox;
this.isABCrossCustomerMultiTenderSuppressionEnabled=b.data.isABCrossCustomerMultiTenderSuppressionEnabled;this.incompatibleMultitenderInstrumentIds=b.data.incompatibleMultitenderInstrumentIds;this.$consumerInvoicingGCWarningMessage=this.getDOMElement("gcWarningMessageDisplayWithConsumerInvoicing");this.isGCOverauthEligible=b.data.isGCOverauthEligible;this.giftCardToggleSwitchId=b.data.giftCardToggleSwitchId;this.giftCardToggleSwitchNativeId=b.data.giftCardToggleSwitchNativeId;this.giftCardSelectionFormName=
b.data.giftCardSelectionFormName;this.giftCardSelectionFormValue=b.data.giftCardSelectionFormValue;this.isComplianceViolationPresent=b.data.isComplianceViolationPresent;this.$checkbox=this.getDOMElement("giftCardSelection");this.$checkboxContainer=this.getDOMElement("gcCheckboxDisplay");this.$radioButton=this.getDOMElement("instrumentRowSelection-"+this.giftCardId);this.$radioButtonContainer=this.getDOMElement("gcRadioButtonDisplay");this.$modernizedPaymentArtGrid=this.getDOMElement("modernizedPaymentArtGridReference");
this.$toggleSwitch=this.getDOMElement(this.giftCardToggleSwitchId);this.$warningMessage=this.getDOMElement("gcWarningMessageDisplay");this.$container=this.getDOMElement("giftCardContainer");this.$gcOnlyOverauthMessage=this.getDOMElement("gcOnlyOverauthInfoMessageDisplay");this.$multitenderOverauthMessage=this.getDOMElement("gcMultiTenderOverauthInfoMessageDisplay");this.$gcComplianceWarningMessage=this.getDOMElement("gcComplianceWarningMessageDisplay");this._setTitleAttributeToElement(this.$checkbox);
this._setTitleAttributeToElement(this.$radioButton);this._setTitleAttributeToElement(this.$toggleSwitch);this.$bankRedirectGCWarningMessage=this.getDOMElement("gcWarningMessageDisplayWithBankRedirect");this.$payAgentGCWarningMessage=this.getDOMElement("gcWarningMessageDisplayWithPayAgent");this.$payOnPickupGCWarningReference=this.getDOMElement("gcWarningMessageDisplayWithPayOnPickup");this.$postPayGCWarningMessage=this.getDOMElement("gcWarningMessageDisplayWithPP");this.$digitalWalletGCWarningMessage=
this.getDOMElement("gcWarningMessageDisplayWithDigitalWallet");this.$defaultGCWarningMessage=this.getDOMElement("gcWarningMessageDisplayWithSelectedPaymentMethod");this.$abSharedPayGCWarningMessage=this.getDOMElement("gcWarningMessageDisplayWithABSharedInstrument");this._shouldDisplayModernizedPaymentArtCX=b.data.shouldDisplayModernizedPaymentArtCX;this._shouldDisplayModernizedFrameCX=b.data.shouldDisplayModernizedFrameCX;this._modernizedPaymentArtGridCssClass=b.data.modernizedPaymentArtGridCssClass;
this._disabledSectionCssClass=b.data.disabledSectionCssClass;this.disableGCWithMCB&&(b.data.disableGcAtStart?this._updateOptionalGiftCardEnabled(!1):f.toggleElement(this.$warningMessage),this.$warningMessage.removeClass("apx-js-hide"));this.isComplianceViolationPresent&&this.$gcComplianceWarningMessage.removeClass("apx-js-hide");this.widget.trigger(k,{category:"GiftCard",balanceValue:this.giftCardBalanceValue,currencyCode:b.data.giftCardBalanceCurrencyCode})},_setTitleAttributeToElement:function(a){a.length&&
this.getDOMElement("gcMsgWithPromo")&&this.getDOMElement("gcMsgWithPromo")[0]&&a.attr({title:this.getDOMElement("gcMsgWithPromo")[0].textContent})},_checkFormInput:function(a){this.isRadioButtonDisplay?this.$radioButton.prop("checked",a):this._updateOptionalGiftCardSelected(a)},_toggleOptionalGiftCard:function(){this._isOptionalGiftCardEnabled()&&this._setGiftCard(!this._isOptionalGiftCardSelected())},_toggleGiftCardRowIfRadioButton:function(a){this.$container.toggleClass("pmts-selected",a);var b=
this.$container.find(".a-touch-radio .a-icon");b.toggleClass("a-icon-radio-active",a);b.toggleClass("a-icon-radio-inactive",!a)},_setGiftCard:function(a){a?this._selectGiftCard():this._unselectGiftCard()},_unselectGiftCard:function(){this.isRadioButtonDisplay?this._toggleGiftCardRowIfRadioButton(!1):this._triggerOptionalInstrumentDeselectedEvent(null);this._checkFormInput(!1);this._triggerBalanceSelectionChangedEvent(!1);f.toggleElement(this.$gcOnlyOverauthMessage,!1);f.toggleElement(this.$multitenderOverauthMessage,
!1)},_selectGiftCard:function(){this.isRadioButtonDisplay?(this._toggleGiftCardRowIfRadioButton(!0),this._triggerBackingInstrumentSelectedEvent(this.giftCardId,null),f.toggleElement(this.$gcOnlyOverauthMessage,this.isGCOverauthEligible)):(this.requireBackingInstrument?this._triggerOptionalInstrumentSelectedEvent(null,this.eligibleBackingMethods):this._triggerOptionalInstrumentSelectedEvent(null),f.toggleElement(this.$multitenderOverauthMessage,this.isGCOverauthEligible));this._checkFormInput(!0);
this._triggerBalanceSelectionChangedEvent(!0)},_deselectCurrentDisplay:function(){!0===this.isRadioButtonDisplay&&this.$radioButton.prop("checked")?(this._unselectGiftCard(),this.widget.trigger(c,{}),this._triggerBackingInstrumentSelectedEvent(null,null)):!1===this.isRadioButtonDisplay&&this._isOptionalGiftCardSelected()&&this._unselectGiftCard()},_setDisplayToRadioButton:function(){this.isRadioButtonDisplay||(this._isOptionalGiftCardSelected()&&this._unselectGiftCard(),this.isRadioButtonDisplay=
!0,this._toggleRadioButtonDisplay(this.isRadioButtonDisplay))},_setDisplayToCheckBoxOrToggleSwitch:function(){this.isRadioButtonDisplay&&(this.$radioButton.prop("checked")&&(this._unselectGiftCard(),this._triggerBackingInstrumentSelectedEvent(null,null)),this.isRadioButtonDisplay=!1,!0===this._isB2BCrossWalletMultitenderEnforcementEnabled?!0!==this.disallowAutoSelectionWhenConvertingToCheckbox&&this._selectGiftCard():this.isABCrossCustomerMultiTenderSuppressionEnabled&&this._isNotOwnedInstrumentSelected||
this._selectGiftCard(),this._toggleRadioButtonDisplay(this.isRadioButtonDisplay))},_toggleRadioButtonDisplay:function(a){f.toggleElement(this.$radioButtonContainer,a);this._shouldDisplayModernizedFrameCX&&this.$toggleSwitch?(f.toggleElement(this.$toggleSwitch,!a),this._updatePaymentArtEnabledState(a?!0:this._isOptionalGiftCardEnabled())):!this._shouldDisplayModernizedFrameCX&&this.$checkboxContainer&&f.toggleElement(this.$checkboxContainer,!a);this._shouldDisplayModernizedPaymentArtCX&&!this._shouldDisplayModernizedFrameCX&&
this.$modernizedPaymentArtGrid&&f.toggleElement(this.$modernizedPaymentArtGrid,a)},_updatePaymentArtEnabledState:function(a){this.$container.find("."+this._modernizedPaymentArtGridCssClass).toggleClass(this._disabledSectionCssClass,!a)},_handleSelectionChange:function(){this._changeGiftCardMessageDisplay();var a=this._canCoverPurchaseWithCurrentSelection();this.isClientGiftCardEligible&&a?this._setDisplayToRadioButton():this._setDisplayToCheckBoxOrToggleSwitch()},_canCoverPurchaseWithCurrentSelection:function(){return this._isProductVoucherSelected&&
this._isPromoBalanceSelected?this.canCoverThePurchaseWithNonStandaloneProductVoucherAndPromo:this._isProductVoucherSelected&&!this._isPromoBalanceSelected?this.canCoverThePurchaseWithNonStandaloneProductVoucher:!this._isProductVoucherSelected&&this._isPromoBalanceSelected?this.canCoverThePurchaseWithNonStandalonePromo:this.canCoverThePurchaseStandalone},_changeGiftCardMessageDisplay:function(){var a=this.getDOMElement("gcMsgWithoutPromo"),b=this.getDOMElement("gcMsgWithPromo"),c=this.getDOMElement("gcMsgWithPV"),
e=this.getDOMElement("gcMsgWithPVAndPromo");this.getDOMElement("gcOverauthInfoMessageDisplay");var d=!this._isProductVoucherSelected&&!this._isPromoBalanceSelected,g=!this._isProductVoucherSelected&&this._isPromoBalanceSelected,n=this._isProductVoucherSelected&&!this._isPromoBalanceSelected,w=this._isProductVoucherSelected&&this._isPromoBalanceSelected;f.toggleElement(a,d);f.toggleElement(b,g);f.toggleElement(c,n);f.toggleElement(e,w);f.toggleElement(this.getDOMElement("gcMsgWithoutPromoWithCheckbox"),
d);f.toggleElement(this.getDOMElement("gcMsgWithPromoWithCheckbox"),g);f.toggleElement(this.getDOMElement("gcMsgWithPVWithCheckbox"),n);f.toggleElement(this.getDOMElement("gcMsgWithPVAndPromoWithCheckbox"),w)},_triggerBalanceSelectionChangedEvent:function(a){this.widget.trigger("balanceSelectionChanged",{paymentMethod:this.data.paymentMethod,isSelected:a,balance:this.giftCardBalanceValue,isBackingInstrument:this.isRadioButtonDisplay})},_triggerInstrumentRowSelectedEvent:function(){this.widget.trigger(c,
{instrumentId:this.giftCardId})},_triggerBackingInstrumentSelectedEvent:function(a,b){this.widget.trigger("backingInstrumentSelected",{instrumentId:a,errors:b,paymentMethod:this.data.paymentMethod})},_triggerOptionalInstrumentSelectedEvent:function(a,b){this.widget.trigger("optionalInstrumentSelected",{instrumentId:this.giftCardId,paymentMethod:this.data.paymentMethod,errors:a,eligibleBackingMethods:b,requireBackingInstrument:this.requireBackingInstrument,balance:this.giftCardBalanceValue})},_triggerOptionalInstrumentDeselectedEvent:function(){this.widget.trigger("optionalInstrumentDeselected",
{instrumentId:this.giftCardId,paymentMethod:this.data.paymentMethod})},_isGiftCardSelectedAsInstrument:function(){return this.$container.hasClass("pmts-selected")},isPaycodeSelected:function(a){return g.isDefined(a.instrumentId)&&-1!==a.instrumentId.indexOf("amzn1.pm.pma.pag")},isPayOnPickupMultiTenderDisabled:function(a){return!(g.isDefined(a.isPayOnPickupMultiTenderEnabled)&&a.isPayOnPickupMultiTenderEnabled)},isPayOnPickupSelected:function(a){return g.isDefined(a.instrumentId)&&-1!==a.instrumentId.indexOf("amzn1.pm.pma.cop")},
_getToggleSwitchAuiElement:function(){var a=this,b=null;n.now("a-switch","jQuery").execute(function(c,e){c!==r&&e!==r&&(b=c.getSwitch(a.$toggleSwitch))});return b},_isOptionalGiftCardSelected:function(){if(this._shouldDisplayModernizedFrameCX){var a=this._getToggleSwitchAuiElement();return a&&a.isOn()}return this.$checkbox.prop("checked")},_updateOptionalGiftCardSelected:function(a){if(this._shouldDisplayModernizedFrameCX){var b=this._getToggleSwitchAuiElement();if(b&&this._isOptionalGiftCardSelected()!==
a){var c=!this._isOptionalGiftCardEnabled();c&&this._updateOptionalGiftCardEnabled(!0);b.isOn(a);c&&this._updateOptionalGiftCardEnabled(!1)}}else return this.$checkbox.prop("checked",a)},_isOptionalGiftCardEnabled:function(){if(this._shouldDisplayModernizedFrameCX){var a=this._getToggleSwitchAuiElement();return a&&a.enabled()}return!this.$checkbox.prop("disabled")},_updateOptionalGiftCardEnabled:function(a){if(this._shouldDisplayModernizedFrameCX){var b=this._getToggleSwitchAuiElement();b&&(this._isOptionalGiftCardEnabled()!==
a&&b.enabled(a),this._updatePaymentArtEnabledState(this.isRadioButtonDisplay?!0:a))}else return this.$checkbox.prop("disabled",!a)},bindToElements:function(){var a=this;a.$container.click(function(b){a.isRadioButtonDisplay?a._isGiftCardSelectedAsInstrument()||a._triggerInstrumentRowSelectedEvent():a._shouldDisplayModernizedFrameCX||(b.preventDefault(),a._toggleOptionalGiftCard())});a.$checkbox.click(function(b){a._setGiftCard(a._isOptionalGiftCardSelected());b.stopPropagation()});if(this._shouldDisplayModernizedFrameCX&&
(a.$toggleSwitch.find("#"+a.giftCardToggleSwitchNativeId).val(a.giftCardSelectionFormValue),a.giftCardSelectionFormName)){var b="a:switch:"+this.giftCardSelectionFormName+":flip";this.widget.offAui(b);this.widget.onAui(b,function(b){a._setGiftCard(b.switchState.isOn)})}},bindToEvents:function(){var e=this;e.widget.on(c,e,function(d){this._isNotOwnedInstrumentSelected=g.isDefined(d.isInstrumentOwned)&&!d.isInstrumentOwned;if(e.isRadioButtonDisplay)(d.instrumentId===e.giftCardId||e._isGiftCardSelectedAsInstrument())&&
e._setGiftCard(d.instrumentId===e.giftCardId);else{e._isPostPaySelected=a.isInstrumentSelection(d,this.isMultitenderDisabledWithPostPay);var n=g.isDefined(d.instrumentId)&&-1!==d.instrumentId.indexOf("amzn1.poa.poda.MCB"),k="CashOnDelivery"===d.instrumentType,h=g.isDefined(d.instrumentId)&&-1!==d.instrumentId.indexOf("amzn1.pm.pma.brd"),m=b.isInstrumentSelectionWithoutMultitender(d),l=e.isPaycodeSelected(d),w=e.isPayOnPickupSelected(d),E=e.isPayOnPickupMultiTenderDisabled(d),p=d.paymentMethod===e.productVoucherIdentifier,
r=g.isDefined(d.instrumentId)&&-1!==d.instrumentId.indexOf("amzn1.pm.pma.zip"),B=g.isDefined(d.instrumentId)&&-1!==d.instrumentId.indexOf("amzn1.pm.pma.pla"),F=g.isDefined(d.isPayCodeMultiTenderEnabled)&&d.isPayCodeMultiTenderEnabled,z=g.isDefined(d.isConsumerInvoicingOrderTFXEnabaled)&&d.isConsumerInvoicingOrderTFXEnabaled,D=g.isDefined(d.instrumentId)&&-1!==d.instrumentId.indexOf("amzn1.pm.pma.inv"),z=z&&D,D=-1===this.incompatibleMultitenderInstrumentIds.indexOf(d.instrumentId);!0===e._isB2BCrossWalletMultitenderEnforcementEnabled?
e.shouldBeDeselectedPerB2BMultitenderRules(c,d)&&e._unselectGiftCard():this.isABCrossCustomerMultiTenderSuppressionEnabled&&this._isNotOwnedInstrumentSelected&&this._unselectGiftCard();this._updateOptionalGiftCardEnabled(!(d.instrumentId===e.promoIdentifier||p||this.disableGCWithMCB&&n||this.isMultiTenderDisabledWithCashOnDelivery&&k||!this.isClientGiftCardEligible||h||!F&&l||m||e._isPostPaySelected||r&&!e.isMultiTenderEnabledWithZip||z||w&&E||B&&!e.isMultiTenderEnabledWithPayLaterAccount||!D));this.disableGCWithMCB&&
f.toggleElement(this.$warningMessage,n);f.toggleElement(this.$gcComplianceWarningMessage,this.isComplianceViolationPresent);f.toggleElement(this.$bankRedirectGCWarningMessage,h);F||f.toggleElement(this.$payAgentGCWarningMessage,l);E&&f.toggleElement(this.$payOnPickupGCWarningReference,w);f.toggleElement(this.$consumerInvoicingGCWarningMessage,z);f.toggleElement(this.$postPayGCWarningMessage,this._isPostPaySelected);f.toggleElement(this.$digitalWalletGCWarningMessage,m);f.toggleElement(this.$defaultGCWarningMessage,
!D)}});e.widget.on("deselectGiftCardCheckbox",e,function(a){a.paymentMethod===this.productVoucherIdentifier?e._updateOptionalGiftCardEnabled(!1):"Zip"!==a.paymentMethod||e.isMultiTenderEnabledWithZip?"FoodVoucherCard"===a.paymentMethod&&e._unselectGiftCard():(e._isOptionalGiftCardSelected()&&e._unselectGiftCard(),e._updateOptionalGiftCardEnabled(!1))});e.widget.on("balanceSelectionChanged",e,function(a){"GC"===a.paymentMethod&&e._shouldDisplayModernizedFrameCX&&e.widget.trigger("updateEstimatedTotal",
{type:a.paymentMethod,status:a.isSelected,balance:a.balance,isValid:!0});e.shouldBeDeselectedPerB2BMultitenderRules("balanceSelectionChanged",a)&&e._deselectCurrentDisplay();a.paymentMethod===this.productVoucherIdentifier?(e._isProductVoucherSelected=a.isSelected,e._handleSelectionChange()):a.paymentMethod===this.promoIdentifier&&(e._isPromoBalanceSelected=a.isSelected,e._handleSelectionChange())});e.widget.on("componentsInitialized",e,function(){e.isRadioButtonDisplay||(e._isOptionalGiftCardSelected()?
(e._triggerOptionalInstrumentSelectedEvent(null,e.eligibleBackingMethods),e._triggerBalanceSelectionChangedEvent(!0)):e._triggerOptionalInstrumentDeselectedEvent())});e.widget.on("initializeRecommendedInstrument",e,function(a){a.instrumentId===e.giftCardId&&e.isRadioButtonDisplay&&e._triggerInstrumentRowSelectedEvent()});e.widget.on("backingInstrumentSelected",e,function(a){null!==a&&"CashOnDelivery"===a.instrumentType&&!e.isRadioButtonDisplay&&e.isMultiTenderDisabledWithCashOnDelivery&&e._updateOptionalGiftCardEnabled(!1)})}})});
l("components/PromoBalanceListItemComponent","events/InstrumentRowSelectedEvent jQuery lang clog css-utils component post-pay-utils mixins/b2b-cross-wallet-mixin digital-wallet-utils AUI!P".split(" "),function(c,d,f,h,g,a,m,k,e,b){var n;return a.extend(k,{_isPostPaySelected:!1,_isDigitalWalletSelected:!1,initialize:function(a,b){this.canCoverPurchaseStandalone=b.data.canCoverPurchaseStandalone;this.promoIdentifier=b.data.promoIdentifier;this.disableUserSelection=b.data.disableUserSelection;this.promoBalance=
b.data.promoBalance;this.isPaylastEligible=b.data.isPaylastEligible;this.showFloatingContinueBarOnNonPaylastPSP=b.data.showFloatingContinueBarOnNonPaylastPSP;this.isMultitenderDisabledWithPostPay=b.data.isMultitenderDisabledWithPostPay;this.isABCrossCustomerMultiTenderSuppressionEnabled=b.data.isABCrossCustomerMultiTenderSuppressionEnabled;this._shouldDisplayModernizedFrameCX=b.data.shouldDisplayModernizedFrameCX;this._modernizedPaymentArtGridCssClass=b.data.modernizedPaymentArtGridCssClass;this._disabledSectionCssClass=
b.data.disabledSectionCssClass;this._promoBalanceToggleSwitchName=b.data.promoBalanceToggleSwitchName;this._promoBalanceToggleSwitchValue=b.data.promoBalanceToggleSwitchValue;this.$radioButton=this.getDOMElement("instrumentRowSelection-"+this.promoIdentifier);this.$checkbox=this.getDOMElement("promoBalanceSelection");this.$toggleSwitch=this.getDOMElement(this._promoBalanceToggleSwitchName);this.$container=this.getDOMElement("promoBalanceContainer");this.$promoBalanceSelectableAreaContainer=this.getDOMElement("promoBalanceSelectableArea");
this.$promoBalanceSelectionHiddenInput=this.getDOMElement("promoBalanceSelection");this.$revampedPromoBalanceContainer=this.getDOMElement("promoBalanceMobileContainer");this._setTitleAttributeToElement(this.$checkbox);this.$toggleSwitchInput=this.$toggleSwitch.find("input");this.$toggleSwitchInput.val(this._promoBalanceToggleSwitchValue)},_setTitleAttributeToElement:function(a){a.length&&this.getDOMElement("promoBalanceMessage")&&this.getDOMElement("promoBalanceMessage")[0]&&a.attr({title:this.getDOMElement("promoBalanceMessage")[0].textContent})},
_triggerBalanceSelectionChangedEvent:function(){var a=0<this.$container.length&&(this.$checkbox.prop("checked")||this.$toggleSwitchInput.prop("checked"))||0<this.$revampedPromoBalanceContainer.length&&!this.$promoBalanceSelectionHiddenInput.prop("disabled");this.widget.trigger(a?"optionalInstrumentSelected":"optionalInstrumentDeselected",{instrumentId:this.promoIdentifier,balance:this.promoBalance});(this.isPaylastEligible||this.showFloatingContinueBarOnNonPaylastPSP)&&this.widget.trigger("UpdateOrderTotalForPromoBalanceEvent",
{paymentMethod:this.promoIdentifier,isSelected:a,promoBalance:this.promoBalance,isBackingInstrument:this.canCoverPurchaseStandalone});this.widget.trigger("balanceSelectionChanged",{paymentMethod:this.promoIdentifier,isSelected:a,balance:this.promoBalance,isBackingInstrument:this.canCoverPurchaseStandalone})},_toggleCheckbox:function(){this.$checkbox.prop("checked",!this.$checkbox.prop("checked"))},_deselectCheckbox:function(){this.$checkbox.prop("checked",!1)},_getToggleSwitchAuiElement:function(){var a=
this,c=null;b.now("a-switch","jQuery").execute(function(b,e){b!==r&&e!==r&&(c=b.getSwitch(a.$toggleSwitch))});return c},_deselectToggleSwitch:function(){var a=this._getToggleSwitchAuiElement();null!=a&&a.isOn(!1)},_deselectPromoBalance:function(){this._isPromoSelectedAsInstrument()&&this.$radioButton.prop("checked")?(this.$radioButton.prop("checked",!1),this.widget.trigger(c,{}),this.widget.trigger("backingInstrumentSelected",{})):!1===this.canCoverPurchaseStandalone&&(0<this.$revampedPromoBalanceContainer.length&&
!this.$promoBalanceSelectionHiddenInput.prop("disabled")?this._deselectPromoBalanceSelectionHiddenInput():0<this.$container.length&&this.$checkbox.prop("checked")?this._deselectCheckbox():0<this.$container.length&&this._shouldDisplayModernizedFrameCX&&this.$toggleSwitchInput.prop("checked")&&this._deselectToggleSwitch(),this._triggerBalanceSelectionChangedEvent())},_isPromoSelectedAsInstrument:function(){return this.$container.hasClass("pmts-selected")},_triggerInstrumentRowSelectedEvent:function(){this.widget.trigger(c,
{instrumentId:this.promoIdentifier})},bindToElements:function(){var a=this;if(0<a.$revampedPromoBalanceContainer.length)a.$promoBalanceSelectableAreaContainer.click(function(b){a.disableUserSelection||a._isPostPaySelected||a._isDigitalWalletSelected||(a._togglePromoBalanceSelectionHiddenInput(),a._togglePromoBalanceDisplayStrings(),a._triggerBalanceSelectionChangedEvent(),a.publishPromoBalanceSelectionMetrics())});else if(a._shouldDisplayModernizedFrameCX&&!a.canCoverPurchaseStandalone){var b="a:switch:"+
a._promoBalanceToggleSwitchName+":flip";a.widget.offAui(b);a.widget.onAui(b,function(b){b.switchState.clicked&&a._triggerBalanceSelectionChangedEvent()})}else a.$container.click(function(b){a.disableUserSelection||a._isPostPaySelected||a._isDigitalWalletSelected?b.preventDefault():a.canCoverPurchaseStandalone?a._isPromoSelectedAsInstrument()||a._triggerInstrumentRowSelectedEvent():(b.preventDefault(),a._toggleCheckbox(),a._triggerBalanceSelectionChangedEvent())}),a.$checkbox.click(function(b){a.disableUserSelection||
a._isPostPaySelected||a._isDigitalWalletSelected||a._triggerBalanceSelectionChangedEvent();b.stopPropagation()})},_changeCheckboxEditability:function(a){this.$checkbox.prop("disabled",a)},_changeToggleSwitchEditability:function(a){var b=this._getToggleSwitchAuiElement();null!=b&&(b.enabled()&&a&&b.isOn(!1),b.enabled(!a))},_togglePromoBalanceSelectionHiddenInput:function(){this.$promoBalanceSelectionHiddenInput.prop("disabled",!this.$promoBalanceSelectionHiddenInput.prop("disabled"))},_togglePromoBalanceDisplayStrings:function(){n=
!this.$promoBalanceSelectionHiddenInput.prop("disabled");g.toggleElement(this.getDOMElement("promoBalanceAvailable"),!n);g.toggleElement(this.getDOMElement("promoBalanceApplied"),n);g.toggleElement(this.getDOMElement("promoBalanceApplyLink"),!n);g.toggleElement(this.getDOMElement("promoBalanceRemoveLink"),n);n?(this.$revampedPromoBalanceContainer.removeClass("promo-balance-mobile-container-background-change"),this.getDOMElement("promoBalanceMobileSelectionChangeover").show()):this.$revampedPromoBalanceContainer.addClass("promo-balance-mobile-container-background-change")},
_deselectPromoBalanceSelectionHiddenInput:function(){this.$promoBalanceSelectionHiddenInput.prop("disabled",!0);this._togglePromoBalanceDisplayStrings()},_togglePromoBalanceSelectionEditability:function(a){a?(this.$promoBalanceSelectionHiddenInput.prop("disabled",a),this.$revampedPromoBalanceContainer.addClass("promo-mobile-container-disable-css-class")):this.$revampedPromoBalanceContainer.removeClass("promo-mobile-container-disable-css-class")},publishPromoBalanceSelectionMetrics:function(a){(n=
!this.$promoBalanceSelectionHiddenInput.prop("disabled"))?h.logCounterMetric({feature:"PromoBalanceSelected",resource:"_Count"}):h.logCounterMetric({feature:"PromoBalanceDeselected",resource:"_Count"});h.publishMetrics()},bindToEvents:function(){var a=this;a.widget.on(c,a,function(b){b.instrumentId===a.promoIdentifier?(a.widget.trigger("backingInstrumentSelected",{instrumentId:a.promoIdentifier,errors:null}),a.$container.addClass("pmts-selected"),a.getDOMElement("instrumentRowSelection-"+a.promoIdentifier).prop("checked",
!0),this.widget.trigger("balanceSelectionChanged",{paymentMethod:this.promoIdentifier,isSelected:!0,balance:this.promoBalance,isBackingInstrument:!0})):a._isPromoSelectedAsInstrument()&&"HealthBenefitsCard"!==b.paymentMethod&&(a.$container.removeClass("pmts-selected"),this.widget.trigger("balanceSelectionChanged",{paymentMethod:this.promoIdentifier,isSelected:!1,balance:this.promoBalance,isBackingInstrument:!1}));if(b.instrumentId!==a.promoIdentifier&&!a.canCoverPurchaseStandalone)if(!0===a._isB2BCrossWalletMultitenderEnforcementEnabled)!0===
a.shouldBeDeselectedPerB2BMultitenderRules(c,b)&&a._deselectPromoBalance();else{var d=f.isDefined(b.isInstrumentOwned)&&!b.isInstrumentOwned;this.isABCrossCustomerMultiTenderSuppressionEnabled&&d&&(0<this.$revampedPromoBalanceContainer.length?a._deselectPromoBalanceSelectionHiddenInput():a._shouldDisplayModernizedFrameCX?a._deselectToggleSwitch():a._deselectCheckbox(),a._triggerBalanceSelectionChangedEvent())}a.canCoverPurchaseStandalone||(a._isPostPaySelected=m.isInstrumentSelection(b,this.isMultitenderDisabledWithPostPay),
a._isDigitalWalletSelected=e.isInstrumentSelectionWithoutMultitender(b),b=a._isPostPaySelected||a._isDigitalWalletSelected,0<this.$revampedPromoBalanceContainer.length?a._togglePromoBalanceSelectionEditability(b):a._shouldDisplayModernizedFrameCX?a._changeToggleSwitchEditability(b):a._changeCheckboxEditability(b),this._shouldDisplayModernizedFrameCX&&this.$container.find("."+this._modernizedPaymentArtGridCssClass).toggleClass(this._disabledSectionCssClass,!!b))});a.widget.on("balanceSelectionChanged",
a,function(b){"PROMO"===b.paymentMethod&&a._shouldDisplayModernizedFrameCX&&a.widget.trigger("updateEstimatedTotal",{type:b.paymentMethod,status:b.isSelected,balance:b.balance,isValid:!0});!0===a.shouldBeDeselectedPerB2BMultitenderRules("balanceSelectionChanged",b)&&a._deselectPromoBalance()});a.widget.on("initializeRecommendedInstrument",a,function(b){b.instrumentId===a.promoIdentifier&&a.canCoverPurchaseStandalone&&a._triggerInstrumentRowSelectedEvent()});a.widget.on("componentsInitialized",a,function(){!a.canCoverPurchaseStandalone&&
(0<a.$checkbox.length&&a.$checkbox.is(":checked")||0<a.$toggleSwitch.length&&a.$toggleSwitchInput.prop("checked")||0<a.$revampedPromoBalanceContainer.length&&!this.$promoBalanceSelectionHiddenInput.prop("disabled"))&&a._triggerBalanceSelectionChangedEvent()});a.widget.on("deselectPromoBalanceInstrument",a,function(b){a._isPromoSelectedAsInstrument()&&(a.$container.removeClass("pmts-selected"),this.widget.trigger("balanceSelectionChanged",{paymentMethod:this.promoIdentifier,isSelected:!1,balance:this.promoBalance,
isBackingInstrument:!1}))})}})});l("components/SelectableBalanceListComponent",["component","lang"],function(c,d){return c.extend({})});l("components/JPPointsListItemComponent","events/InstrumentRowSelectedEvent jQuery lang css-utils form-component post-pay-utils mixins/b2b-cross-wallet-mixin digital-wallet-utils".split(" "),function(c,d,f,h,g,a,m,k){var e="jpPointsBalanceSelection instrumentRowSelection-jpPoints jpPointsBalanceSelection_pointsSelection-max jpPointsBalanceSelection_pointsSelection-partial jpPointsBalanceSelection_partialPointsAmount jpPointsBalanceSelection_partialCurrencyAmount".split(" ");
return g.extend(m,{_maxPointsApplicable:0,_canUseMaxPointsWithoutBackingInstrument:!1,_isUsingMaxPointsWithoutBackingInstrument:!1,_isGiftCardSelected:!1,_isProductVoucherSelected:!1,_isPromoBalanceSelected:!1,_isNonPointsInstrumentSelected:!1,_isPostPaySelected:!1,_isDigitalWalletSelected:!1,_isMCBSelected:!1,_shouldBeDisabledPerB2BMultitenderRules:!1,_currencyToPointsRate:0,_usePartialCurrencyAmountElement:!1,_isJPPointsForPreference:!1,initialize:function(a,c){f.has(c.data,"defaultMaxPoints")&&
(this._maxPointsApplicable=c.data.defaultMaxPoints.points);this._currencyToPointsRate=c.data.currencyToPointsRate;this._usePartialCurrencyAmountElement=c.data.usePartialCurrencyAmountElement;this._canUseMaxPointsWithoutBackingInstrument=c.data.canCoverPurchaseTotalStandalone;this.isMultitenderDisabledWithPostPay=c.data.isMultitenderDisabledWithPostPay;this.isABCrossCustomerMultiTenderSuppressionEnabled=c.data.isABCrossCustomerMultiTenderSuppressionEnabled;this._isJPPointsForPreference=c.data.isJPPointsForPreference;
this.$preferenceCheckbox=this.getDOMElement("JPPointsPreferenceSelection");this._isJPPointsForPreference&&(this._pointsInstrumentId=c.data.pointsInstrumentId,this.requireBackingInstrument=c.data.requireBackingInstrument,this.eligibleBackingMethods=c.data.eligibleBackingMethods,this.pointsAccountSelectionFormValue=c.data.pointsAccountSelectionFormValue,this.$mcbWarningMessage=this.getDOMElement("jpPointsWarningMessageDisplayWithMCB"),this.$postPayWarningMessage=this.getDOMElement("jpPointsWarningMessageDisplayWithPostPay"),
this.$digitalWalletWarningMessage=this.getDOMElement("jpPointsWarningMessageDisplayWithDigitalWallet"))},_setMaxPointsValue:function(a,c){this._maxPointsApplicable=a.points;this._canUseMaxPointsWithoutBackingInstrument=c;c=this.getDOMElement("jpPointsContainer");c.find(".pmts-jppoints-value-in-points").text(a.points);c.find(".pmts-jppoints-value-in-currency").text(a.currency)},_setPointsToApplyValue:function(a){this.getDOMElement("jpPointsBalanceSelection").val(a);a=0<Number(a);this.getDOMElement("jpPointsBalanceSelection_instrumentId").prop("disabled",
!a)},_resolveElement:function(a){if(f.isString(a))return this.getDOMElement(a);if(f.isArray(a)){for(var c=[],e=0;e<a.length;e++){var g=this._resolveElement(a[e]);g&&0<g.length&&c.push(g[0])}return d(c)}return a},_isBoxChecked:function(a){return this._resolveElement(a).is(":checked")},_shouldBeDisabledByIncompatiblePaymentMethods:function(){return this._isPostPaySelected||this._shouldBeDisabledPerB2BMultitenderRules||this._isDigitalWalletSelected},_toggleCheckableBox:function(a,c){a=this._resolveElement(a);
"undefined"===typeof c&&(c=!a.prop("checked"));a.prop("checked",c)},_toggleControlEditability:function(a,c){a=this._resolveElement(a);"undefined"===typeof c&&(c=a.prop("disabled"));a.prop("disabled",!c)},_toggleContainerHighlighting:function(a){this.getDOMElement("jpPointsContainer").toggleClass("pmts-selected",a)},_resolvePointsBalanceChange:function(){0<this._maxPointsApplicable?(this._enablePoints(),this._isBoxChecked("jpPointsBalanceSelection_pointsSelection-max")?this._canUseMaxPointsWithoutBackingInstrument?
this._useMaxPointsWithoutBackingInstrument():this._useMaxPointsWithBackingInstrument():this._isBoxChecked("jpPointsBalanceSelection_pointsSelection-partial")&&(this._usePartialCurrencyAmountElement?this._parseAndValidatePartialCurrencyAmountFromField(this):this._parseAndValidatePartialPointsAmountFromField(this))):this._disablePoints()},_disablePoints:function(){this._useNoPoints();this._toggleControlEditability(e,!1)},_enablePoints:function(){this._toggleControlEditability(e,!0)},_useNoPoints:function(){this._toggleCheckableBox(["jpPointsBalanceSelection",
"instrumentRowSelection-jpPoints","jpPointsBalanceSelection_pointsSelection-max"],!1);this._toggleContainerHighlighting(!1);this._clearPartialPoints();this._setPointsToApplyValue("0");this._isUsingMaxPointsWithoutBackingInstrument&&!this._isNonPointsInstrumentSelected?this._triggerBackingInstrumentSelectedEvent(!1,null):this._isUsingMaxPointsWithoutBackingInstrument=!1;this._triggerOptionalInstrumentDeselectedEvent();this._triggerBalanceSelectionChangedEvent(!1,0,!1)},_useMaxPointsWithoutBackingInstrument:function(){this._toggleCheckableBox(["jpPointsBalanceSelection",
"instrumentRowSelection-jpPoints","jpPointsBalanceSelection_pointsSelection-max"],!0);this._isNonPointsInstrumentSelected=!1;this._toggleContainerHighlighting(!0);this._clearPartialPoints();this._setPointsToApplyValue(this._maxPointsApplicable);this._triggerInstrumentRowSelectedEvent(null);this._triggerBackingInstrumentSelectedEvent(!0,null);this._triggerOptionalInstrumentDeselectedEvent();this._triggerBalanceSelectionChangedEvent(!0,this._maxPointsApplicable,!0)},_useMaxPointsWithBackingInstrument:function(){this._toggleCheckableBox(["jpPointsBalanceSelection",
"jpPointsBalanceSelection_pointsSelection-max"],!0);this._toggleCheckableBox("instrumentRowSelection-jpPoints",!1);this._toggleContainerHighlighting(!1);this._clearPartialPoints();this._setPointsToApplyValue(this._maxPointsApplicable);this._isUsingMaxPointsWithoutBackingInstrument&&this._triggerBackingInstrumentSelectedEvent(!1,null);this._isNonPointsInstrumentSelected?this._triggerOptionalInstrumentSelectedEvent(null):this._triggerOptionalInstrumentSelectedEvent([this.widget.getLocalizedString("pmts_portal_payselect_jppoints_error_insufficient_balance")]);
this._triggerBalanceSelectionChangedEvent(!0,this._maxPointsApplicable,!1)},_usePartialPoints:function(a){this._toggleCheckableBox(["jpPointsBalanceSelection","jpPointsBalanceSelection_pointsSelection-partial"],!0);this._toggleCheckableBox("instrumentRowSelection-jpPoints",!1);this._toggleContainerHighlighting(!1);a&&(this._usePartialCurrencyAmountElement?this.getDOMElement("jpPointsBalanceSelection_partialCurrencyAmount").focus():this.getDOMElement("jpPointsBalanceSelection_partialPointsAmount").focus());
this._setPointsToApplyValue("0");this._isUsingMaxPointsWithoutBackingInstrument&&this._triggerBackingInstrumentSelectedEvent(!1,null);this._isNonPointsInstrumentSelected?this._triggerOptionalInstrumentSelectedEvent(null):this._triggerOptionalInstrumentSelectedEvent([this.widget.getLocalizedString("pmts_portal_payselect_jppoints_error_insufficient_balance")])},_clearPartialPoints:function(){this.form.clearValidationErrors();this._toggleCheckableBox("jpPointsBalanceSelection_pointsSelection-partial",
!1);this.getDOMElement("jpPointsBalanceSelection_partialPointsAmount").val("");this.getDOMElement("jpPointsBalanceSelection_partialCurrencyAmount").val("");this._updatePartialAmountPointsConversion(0);this._togglePartialPointsError(!1)},_togglePartialPointsError:function(a){h.toggleElement(this.getDOMElement("jpPointsErrorPartialExceededBalance"),a);h.toggleElement(this.getDOMElement("abRewardsPartialAmountPointsConversion"),!a)},_updatePartialAmountPointsConversion:function(a){a=this.widget.getLocalizedString("pmts_portal_payselect_ab_rewards_redeem_partial_points_conversion",
{value_in_points:a});var c=this.getDOMElement("abRewardsPartialAmountPointsConversion")[0];c!==r&&(c.innerHTML=a)},_validatePartialPoints:function(a){var c=Number(this._maxPointsApplicable);this._triggerBalanceSelectionChangedEvent(!0,a,!1);a<=c?(this.form.clearValidationErrors(),this._togglePartialPointsError(!1),this._setPointsToApplyValue(a.toString()),this._isNonPointsInstrumentSelected?this._triggerOptionalInstrumentSelectedEvent(null):a===c&&this._canUseMaxPointsWithoutBackingInstrument?(this._toggleCheckableBox("instrumentRowSelection-jpPoints",
!0),this._triggerBackingInstrumentSelectedEvent(!0,null),this._triggerOptionalInstrumentDeselectedEvent()):(this._isUsingMaxPointsWithoutBackingInstrument&&(this._toggleCheckableBox("instrumentRowSelection-jpPoints",!1),this._triggerBackingInstrumentSelectedEvent(!1,null)),this._triggerOptionalInstrumentSelectedEvent([this.widget.getLocalizedString("pmts_portal_payselect_jppoints_error_insufficient_balance")]))):(this._isUsingMaxPointsWithoutBackingInstrument&&(this._toggleCheckableBox("instrumentRowSelection-jpPoints",
!1),this._triggerBackingInstrumentSelectedEvent(!1,null)),this._togglePartialPointsError(!0),this._triggerOptionalInstrumentSelectedEvent([this.widget.getLocalizedString("pmts_portal_payselect_jppoints_error_exceeded_balance_continue")]),this._setPointsToApplyValue("0"),this.form.blameFormField("jpPointsBalanceSelection",!0))},_convertCurrencyToPoints:function(a){return Math.round(a*this._currencyToPointsRate)},_triggerInstrumentRowSelectedEvent:function(){this.widget.trigger(c,{instrumentId:this.data.pointsInstrumentId})},
_triggerBalanceSelectionChangedEvent:function(a,c,e){this.widget.trigger("balanceSelectionChanged",{paymentMethod:"JPPoints",isSelected:a,instrumentId:this.data.pointsInstrumentId,isInstrumentOwned:this.data.isOwned,balance:c,isBackingInstrument:e})},_triggerBackingInstrumentSelectedEvent:function(a,c){this._isUsingMaxPointsWithoutBackingInstrument=a;var e=null;a&&(e={instrumentId:this.data.pointsInstrumentId,errors:c,paymentMethod:this.data.paymentMethod});this.widget.trigger("backingInstrumentSelected",
e)},_triggerOptionalInstrumentSelectedEvent:function(a){this.widget.trigger("optionalInstrumentSelected",{instrumentId:this.data.pointsInstrumentId,errors:a})},_triggerOptionalInstrumentDeselectedEvent:function(){this.widget.trigger("optionalInstrumentDeselected",{instrumentId:this.data.pointsInstrumentId})},_toggleJPPointsSectionDisplay:function(a){h.toggleElement(this.getDOMElement("jpPointsCollapsibleSection"),a)},_handleSelectionChange:function(){this._isGiftCardSelected&&this._isProductVoucherSelected&&
this._isPromoBalanceSelected?this._setMaxPointsValue(this.data.maxPointsWithGiftCardAndProductVoucherAndPromo,this.data.canCoverPurchaseTotalAfterGiftCardAndProductVoucherAndPromo):!this._isGiftCardSelected&&this._isProductVoucherSelected&&this._isPromoBalanceSelected?this._setMaxPointsValue(this.data.maxPointsWithProductVoucherAndPromo,this.data.canCoverPurchaseTotalAfterProductVoucherAndPromo):this._isGiftCardSelected&&this._isProductVoucherSelected&&!this._isPromoBalanceSelected?this._setMaxPointsValue(this.data.maxPointsWithGiftCardAndProductVoucher,
this.data.canCoverPurchaseTotalAfterGiftCardAndProductVoucher):this._isGiftCardSelected&&!this._isProductVoucherSelected&&this._isPromoBalanceSelected?this._setMaxPointsValue(this.data.maxPointsWithGiftCardAndPromo,this.data.canCoverPurchaseTotalAfterGiftCardAndPromo):this._isGiftCardSelected||this._isProductVoucherSelected||!this._isPromoBalanceSelected?this._isGiftCardSelected||!this._isProductVoucherSelected||this._isPromoBalanceSelected?!this._isGiftCardSelected||this._isProductVoucherSelected||
this._isPromoBalanceSelected?this._setMaxPointsValue(this.data.maxPointsStandalone,this.data.canCoverPurchaseTotalStandalone):this._setMaxPointsValue(this.data.maxPointsWithGiftCard,this.data.canCoverPurchaseTotalAfterGiftCard):this._setMaxPointsValue(this.data.maxPointsWithProductVoucher,this.data.canCoverPurchaseTotalAfterProductVoucher):this._setMaxPointsValue(this.data.maxPointsWithPromo,this.data.canCoverPurchaseTotalAfterPromo);this._shouldBeDisabledByIncompatiblePaymentMethods()||this._resolvePointsBalanceChange()},
_parseAndValidatePartialPointsAmountFromField:function(a){var c=a.getDOMElement("jpPointsBalanceSelection_partialPointsAmount"),e=c.val().replace(/[^0-9]/g,"");"0"===e&&(e="");c.val(e);a._validatePartialPoints(""!==e?Number(e):0)},_parseAndValidatePartialCurrencyAmountFromField:function(a){var c=a.getDOMElement("jpPointsBalanceSelection_partialCurrencyAmount"),e=c.val().match(/[\d]+[\.]?[\d]{0,2}/),e=null===e?"":e[0];c.val(e);c=a._convertCurrencyToPoints(Number(e));a._validatePartialPoints(c);a._updatePartialAmountPointsConversion(c)},
_handleRowSelectionEventForSetPaymentPlanSelection:function(b,e){b._isPostPaySelected=a.isInstrumentSelection(e,this.isMultitenderDisabledWithPostPay);b._isDigitalWalletSelected=k.isInstrumentSelectionWithoutMultitender(e);b._shouldBeDisabledPerB2BMultitenderRules=b.shouldBeDisabledPerB2BMultitenderRules(e);b._isNonPointsInstrumentSelected=!0;b._isMCBSelected=f.isDefined(e.instrumentId)&&-1!==e.instrumentId.indexOf("amzn1.poa.poda.MCB");this._shouldBeDisabledByIncompatiblePaymentMethods()?this._disablePoints():
this._enablePoints();!0===this._isB2BCrossWalletMultitenderEnforcementEnabled?!0===this.shouldBeDeselectedPerB2BMultitenderRules(c,e)&&this._useNoPoints():!0===this.isABCrossCustomerMultiTenderSuppressionEnabled&&f.isDefined(e.instrumentId)&&(!f.isDefined(e.isInstrumentOwned)||e.isInstrumentOwned)!==this.data.isOwned&&this._useNoPoints();this._isBoxChecked("jpPointsBalanceSelection_pointsSelection-partial")?this._isUsingMaxPointsWithoutBackingInstrument?(this._isUsingMaxPointsWithoutBackingInstrument=
!1,this._toggleCheckableBox("instrumentRowSelection-jpPoints",!1),this._triggerOptionalInstrumentSelectedEvent(null)):this._resolvePointsBalanceChange():this._isBoxChecked("jpPointsBalanceSelection_pointsSelection-max")&&(this._isUsingMaxPointsWithoutBackingInstrument?this._useNoPoints():this._resolvePointsBalanceChange())},_setPointsAccountCheckBox:function(a){a?this._selectPointsAccountCheckBox():this._unselectPointsAccountCheckBox()},_selectPointsAccountCheckBox:function(){this.requireBackingInstrument?
this._triggerOptionalPointsAccountInstrumentCheckBoxSelectedEvent(null,this.eligibleBackingMethods):this._triggerOptionalPointsAccountInstrumentCheckBoxSelectedEvent(null);this._updateOptionalPointsAccountCheckBoxSelected(!0)},_unselectPointsAccountCheckBox:function(){this._triggerOptionalPointsAccountInstrumentCheckBoxDeselectedEvent();this._updateOptionalPointsAccountCheckBoxSelected(!1)},_updateOptionalPointsAccountCheckBoxSelected:function(a){return this.$preferenceCheckbox.prop("checked",a)},
_triggerOptionalPointsAccountInstrumentCheckBoxSelectedEvent:function(a,c){this.widget.trigger("optionalInstrumentSelected",{instrumentId:this._pointsInstrumentId,paymentMethod:this.data.paymentMethod,errors:a,eligibleBackingMethods:c,requireBackingInstrument:this.requireBackingInstrument})},_triggerOptionalPointsAccountInstrumentCheckBoxDeselectedEvent:function(){this.widget.trigger("optionalInstrumentDeselected",{instrumentId:this._pointsInstrumentId,paymentMethod:this.data.paymentMethod})},_toggleOptionalPointsAccountCheckBox:function(){this._isOptionalPointsAccountCheckBoxEnabled()&&
this._setPointsAccountCheckBox(!this._isOptionalPointsAccountCheckBoxSelected())},_toggleJPPointsCheckboxDisplay:function(a){h.toggleElement(this.getDOMElement("JPPointsPreferenceSelection"),a)},_isOptionalPointsAccountCheckBoxEnabled:function(){return!this.$preferenceCheckbox.prop("disabled")},_isOptionalPointsAccountCheckBoxSelected:function(){return this.$preferenceCheckbox.prop("checked")},_handleRowSelectionEventForSetPaymentPreference:function(b,c){b._isPostPaySelected=a.isInstrumentSelection(c,
this.isMultitenderDisabledWithPostPay);b._isDigitalWalletSelected=k.isInstrumentSelectionWithoutMultitender(c);b._isMCBSelected=f.isDefined(c.instrumentId)&&-1!==c.instrumentId.indexOf("amzn1.poa.poda.MCB");this._updateOptionalPointsAccountCheckBoxEnabled(!(b._isMCBSelected||b._isDigitalWalletSelected||b._isPostPaySelected));h.toggleElement(this.$mcbWarningMessage,b._isMCBSelected);h.toggleElement(this.$digitalWalletWarningMessage,b._isDigitalWalletSelected);h.toggleElement(this.$postPayWarningMessage,
b._isPostPaySelected)},_updateOptionalPointsAccountCheckBoxEnabled:function(a){this._toggleControlEditability("JPPointsPreferenceSelection",a)},bindToElements:function(){var a=this;a.getDOMElement("jpPointsBalanceSelection").change(function(c){c.target.checked?(a._toggleJPPointsSectionDisplay(!0),a._canUseMaxPointsWithoutBackingInstrument?a._useMaxPointsWithoutBackingInstrument():a._useMaxPointsWithBackingInstrument()):(a._toggleJPPointsSectionDisplay(!1),a._useNoPoints())});a.getDOMElement("jpPointsBalanceSelection_pointsSelection-max").change(function(c){c.target.checked&&
(a._canUseMaxPointsWithoutBackingInstrument?a._useMaxPointsWithoutBackingInstrument():a._useMaxPointsWithBackingInstrument())});a.getDOMElement("jpPointsBalanceSelection_pointsSelection-partial").change(function(c){c.target.checked&&a._usePartialPoints(!0)});var c=a.getDOMElement("jpPointsBalanceSelection_partialPointsAmount");c.click(function(){a._isBoxChecked("jpPointsBalanceSelection_pointsSelection-partial")||a._usePartialPoints(!1)});c.keyup(function(){a._parseAndValidatePartialPointsAmountFromField(a)});
c=a.getDOMElement("jpPointsBalanceSelection_partialCurrencyAmount");c.click(function(){a._isBoxChecked("jpPointsBalanceSelection_pointsSelection-partial")||a._usePartialPoints(!1)});c.keyup(function(){a._parseAndValidatePartialCurrencyAmountFromField(a)});a.$preferenceCheckbox.click(function(c){a._setPointsAccountCheckBox(a._isOptionalPointsAccountCheckBoxSelected())})},bindToEvents:function(){var a=this;a.widget.on(c,a,function(c){c.instrumentId!==a.data.pointsInstrumentId&&(a._isJPPointsForPreference?
a._handleRowSelectionEventForSetPaymentPreference(a,c):a._handleRowSelectionEventForSetPaymentPlanSelection(a,c))});a.widget.on("balanceSelectionChanged",a,function(c){if(!a._isJPPointsForPreference){var e=!0===c.isSelected&&"JPPoints"===c.paymentMethod&&c.instrumentId!==a.data.pointsInstrumentId;!0!==a.shouldBeDeselectedPerB2BMultitenderRules("balanceSelectionChanged",c)&&!0!==e||a._useNoPoints();"GC"===c.paymentMethod?(a._isGiftCardSelected=c.isSelected,a._handleSelectionChange()):"ProductVoucher"===
c.paymentMethod?(a._isProductVoucherSelected=c.isSelected,a._handleSelectionChange()):"PROMO"===c.paymentMethod&&(a._isPromoBalanceSelected=c.isSelected,a._handleSelectionChange())}});a.widget.on("initializeRecommendedInstrument",a,function(c){c.instrumentId===a._pointsInstrumentId&&this._isJPPointsForPreference&&a._triggerInstrumentRowSelectedEvent()});a.widget.on("componentsInitialized",a,function(){this._isJPPointsForPreference&&(a._isOptionalPointsAccountCheckBoxSelected()?a._triggerOptionalPointsAccountInstrumentCheckBoxSelectedEvent(null,
a.eligibleBackingMethods):a._triggerOptionalInstrumentDeselectedEvent())})}})});l("components/SelectableBancontactListComponent",["form-component"],function(c){return c});l("components/BankAccountListItemComponent",["css-utils","components/SimplePaymentOptionListItemComponent","lang","events/InstrumentRowSelectedEvent"],function(c,d,f,h){var g=["GC","JPPoints","ProductVoucher","PROMO"];return d.extend({_getContainerElement:function(){return this.getDOMElement("bankAccountContainer")},initialize:function(a,
c){this._isAddressChallenged=c.data.isAddressChallenged;this._isOwned=c.data.isOwned;this._isABCrossCustomerMultiTenderSuppressionEnabled=c.data.isABCrossCustomerMultiTenderSuppressionEnabled},bindToEvents:function(){f.bind(d.prototype.bindToEvents,this).apply();this.widget.on("bankAccountAddressChallengePassed",this,function(a){a.instrumentId===this._getInstrumentId()&&(this._isAddressChallenged=!1,this._updateContinueButton(),c.showElement(this.getDOMElement("bankAccountHolderName")))});this.widget.on("balanceSelectionChanged",
this,function(a){this._isABCrossCustomerMultiTenderSuppressionEnabled&&!this._getIsOwned()&&!a.isBackingInstrument&&a.isSelected&&g.includes(a.paymentMethod)&&this._updateBackingInstrumentState()});this.widget.on("initializeRecommendedInstrument",this,function(a){a.instrumentId===this._getInstrumentId()&&this._triggerInstrumentRowSelectedEvent()})},_onInstrumentSelected:function(){this._getContainerElement().addClass("pmts-selected");this._getInstrumentSelectionInputElement().prop("checked",!0);this._updateContinueButton();
this._toggleRecurringPaymentEligibilityBAMessage(!0);this._isAddressChallenged?c.hideElement(this.getDOMElement("bankAccountHolderName")):c.showElement(this.getDOMElement("bankAccountHolderName"))},_onInstrumentDeselected:function(){this._getContainerElement().removeClass("pmts-selected");this._getInstrumentSelectionInputElement().prop("checked",!1);this._toggleRecurringPaymentEligibilityBAMessage(!1);c.showElement(this.getDOMElement("bankAccountHolderName"))},_toggleRecurringPaymentEligibilityBAMessage:function(a){this.widget.trigger("toggleRecurringPaymentEligibilityMessage",
{instrumentId:this.data.instrumentId,isSelected:a})},_updateContinueButton:function(){var a=null;this._isAddressChallenged&&(a="pmts_portal_payselect_blocked_continue_address_challenge");a=a?[this.widget.getLocalizedString(a)]:null;this._triggerBackingInstrumentSelectedEvent(a)}})});l("components/SelectableBankAccountListComponent",["component","lang"],function(c,d){return c.extend({})});l("components/SelectableConsumerInvoicingListComponent",["form-component"],function(c){return c});l("components/SelectableConsumerInvoicingListItemComponent",
["components/SelectableDPMInstrumentListItemComponent","events/InstrumentRowSelectedEvent","jQuery"],function(c,d,f){return c.extend({initialize:function(c,d){this.isConsumerInvoicingOrderTFXEnabaled=d.data.isConsumerInvoicingOrderTFXEnabaled},poaInstrumentClicked:function(c){this.widget.trigger(d,{instrumentId:c,isConsumerInvoicingOrderTFXEnabaled:this.isConsumerInvoicingOrderTFXEnabaled})},bindToElements:function(){if(this.instrumentSpecificHelper)this.instrumentSpecificHelper.bindToElements();
else{var c=this;c.getDOMElementsByPrefix("POAInstrumentContainer").click(function(d){f(d.currentTarget).data("disabled")||c.poaInstrumentClicked(c._instrumentId)});c.widget.on("initializeRecommendedInstrument",c,function(d){d.instrumentId!==c._instrumentId||c.getDOMElementsByPrefix("POAInstrumentContainer").data("disabled")||(c._poaInstrumentSelected(),c.poaInstrumentClicked(c._instrumentId))})}}})});l("components/CreditCardListItemComponent","events/InstrumentRowSelectedEvent events/CreateSecureFieldEvent events/RemoveSecureFieldEvent events/SubmitSecureFieldDataEvent events/SecureFieldDataReadyEvent css-utils form-component lang clog aui-helper jQuery keyboard continuable mixins/tfx-currency-mixin AUI!P".split(" "),
function(c,d,f,h,g,a,m,k,e,b,n,q,l,v,t){var I,u={pmts_portal_payselect_cc_address_challenge_error_no_match:"-noMatch",pmts_portal_payselect_cc_address_challenge_error_security_code_invalid:"-securityCodeInvalid",pmts_portal_payselect_cc_address_challenge_error_unknown:"-unknown",pmts_portal_payselect_selectedPaymentMethodExpired:"-expirationDateInvalid"},H=["GC","JPPoints","ProductVoucher","PROMO"];return m.extend(v,l,{EXPIRATION_DATE_FIELD_NAME:"expirationDate",CURRENCY_SELECTION_FIELD_NAME:"currencySelection",
CREDIT_CARD_POSTAL_CODE_FIELD_NAME:"postalCode",INSTALLMENT_OPTION_CHANGED_EVENT:"installmentOptionChanged",isExpired:!1,requiresCurrency:!1,isCreditCardVerificationRequired:!1,isCreditCardPostalCodeRequired:!1,hasUpdatedExpired:!1,isEmiMessagingEnabled:!1,showPCIComplianceComponent:!1,isInactiveCupMbcc:!1,orderSummaryFired:!1,acceptanceData:{accepted:!0},isInstallmentsEligible:!0,isAPBSelected:!1,isCardSelected:!1,isAPBWithEMIEnabled:!1,isDownPaymentEnabled:!1,installmentOfferBOs:[],installmentOfferBOsWithAPB:[],
isEMIAvailable:!1,appliedNoCostEMIDiscount:null,isEligibleForFxInstallments:!1,isGiftCardCheckboxSelected:!1,initialSelectedFixupInstrumentId:null,showAuthorizationFailureAlert:!1,shouldDecoupleCardsFromSavedCardsSection:!1,selectedInstrumentId:null,bindTokenisationConsentConfirmationToClick:!0,bindTokenisationConsentRevokedToClick:!0,fixExpiredCardUpdation:!1,isDecoratePayStationBOAndLegacyBOEnabled:!1,isInvalidCVVErrorMessagingEnabled:!1,showSuppressionMessagingUpfront:!1,shouldDisplayNomenclatureWave1Changes:!1,
scrollAfterAddCardEvent:!1,initialize:function(b,c){this._isDesktop="desktop"===b.options.deviceType;this.isExpired=c.data.isExpired;this.isEligibleForTfx=c.data.isEligibleForTfx;this.requiresCurrency=c.data.requiresCurrencySelection;this.isCreditCardVerificationRequired=c.data.isCreditCardVerificationRequired;this.isCreditCardPostalCodeRequired=c.data.isCreditCardPostalCodeRequired;this.cvvFieldName=c.data.cvvFieldName;this.cvvSecureFieldId=c.data.cvvSecureFieldId;this.isPaySelectCvvSecureFieldEnabled=
c.data.isPaySelectCvvSecureFieldEnabled;this.isSecureFieldsEnabledForPrefetch=c.data.isSecureFieldsEnabledForPrefetch;this.externalTokenCustomerConsentFieldName=c.data.externalTokenCustomerConsentFieldName;this.expirationDateFieldName=c.data.expirationDateFieldName;this.hasFinancialOffer=c.data.hasFinancialOffer;this.hasInstallmentOffer=c.data.hasInstallmentOffer;this.hasVisibleInstallmentOffer=c.data.hasVisibleInstallmentOffer;this.isEmiMessagingEnabled=c.data.isEmiMessagingEnabled;this.showPCIComplianceComponent=
c.data.showPCIComplianceComponent;this.isInactiveCupMbcc=c.data.isInactiveCupMbcc;this.isAddressChallenged=c.data.isAddressChallenged||!1;this.useNewAddressChallengeFormat=c.data.useNewAddressChallengeFormat||!1;this.hasPurchaseFinancingOffer=c.data.hasPurchaseFinancingOffer;this.isAPBWithEMIEnabled=c.data.isAPBWithEMIEnabled;this.isDownPaymentEnabled=c.data.isDownPaymentEnabled;this.installmentOfferBOs=c.data.installmentOfferBOs;this.installmentOfferBOsWithAPB=c.data.installmentOfferBOsWithAPB;this.isEMIAvailable=
this.installmentOfferBOs!==r&&0!==this.installmentOfferBOs.length||this.installmentOfferBOsWithAPB!==r&&0!==this.installmentOfferBOsWithAPB.length;this.isPaylastEligible=c.data.isPaylastEligible;this.isDynamicOrderSummaryEnabled=c.data.isDynamicOrderSummaryEnabled;this.showFloatingContinueBarOnNonPaylastPSP=c.data.showFloatingContinueBarOnNonPaylastPSP;this.isEligibleForFxInstallments=c.data.isEligibleForFxInstallments;this.isOwned=c.data.isOwned;this.useUpdatedCardExpirationCx=c.data.useUpdatedCardExpirationCx||
!1;this.isEMISuppressed=c.data.isEMISuppressed;this.acceptanceData=c.data.acceptanceData||{accepted:!0};this.initialSelectedFixupInstrumentId=c.data.initialSelectedFixupInstrumentId;this.showAuthorizationFailureAlert=c.data.showAuthorizationFailureAlert;this.shouldDecoupleCardsFromSavedCardsSection=c.data.shouldDecoupleCardsFromSavedCardsSection;this.isABCrossCustomerMultiTenderSuppressionEnabled=c.data.isABCrossCustomerMultiTenderSuppressionEnabled;this.isDebitCardDegraded=c.data.isDebitCardDegraded;
this.shouldDisplayInlineMsgForMultiTender=c.data.shouldDisplayInlineMsgForMultiTender;this.shouldDisplayModernizedFrameCX=c.data.shouldDisplayModernizedFrameCX;this._onCreditCardDeselected();this.$consentCheckboxDomElement=this.getDOMElement("externalTokenCustomerConsentCheckbox").find("input[type\x3dcheckbox]").first();a.hideElement(this.getDOMElement("emiMessagingSlot"));this.$explicitConsentBottomsheet=null;this.fixExpiredCardUpdation=c.data.fixExpiredCardUpdation;this.payStationId=c.data.payStationId;
this.isDecoratePayStationBOAndLegacyBOEnabled=c.data.isDecoratePayStationBOAndLegacyBOEnabled;this.isInvalidCVVErrorMessagingEnabled=c.data.isInvalidCVVErrorMessagingEnabled;this.showSuppressionMessagingUpfront=c.data.showSuppressionMessagingUpfront;this.invalidCvv=this.isPaySelectCvvSecureFieldEnabled&&this.isCreditCardVerificationRequired;this.shouldDisplayNomenclatureWave1Changes=c.data.shouldDisplayNomenclatureWave1Changes;this.isNomenclatureWave2Enabled=c.data.isNomenclatureWave2Enabled;this.scrollAfterAddCardEvent=
c.data.scrollAfterAddCardEvent;this.scrollAfterAddCardEvent!==r&&!0===this.scrollAfterAddCardEvent&&this.widget.scrollToElementWithCompensation(this.getDOMElement("creditCardContainer-"+this.data.instrumentId))},showTFXCurrencyOptions:function(){this._toggleTFXCurrencyOptionsDisplay(!0)},hideTFXCurrencyOptions:function(){this._toggleTFXCurrencyOptionsDisplay(!1)},showCreditCardPaymentDetail:function(){this._toggleCreditCardPaymentDetailDisplay(!0)},hideCreditCardPaymentDetail:function(){this._toggleCreditCardPaymentDetailDisplay(!1)},
showCreditCardVerification:function(){this._toggleCreditCardVerificationDisplay(!0)},hideCreditCardVerification:function(){this._toggleCreditCardVerificationDisplay(!1)},hideInvalidCvvErrorMessage:function(){this.isInvalidCVVErrorMessagingEnabled&&a.hideElement(this.getDOMElement("invalidCvvErrorMessagingSlot"))},showPaymentMethodInlineMessage:function(){this._togglePaymentMethodInlineMessage(!0)},hidePaymentMethodInlineMessage:function(){this._togglePaymentMethodInlineMessage(!1)},showPageInlineWarningMessage:function(){this._togglePageInlineWarningMessage(!0)},
hidePageInlineWarningMessage:function(){this._togglePageInlineWarningMessage(!1)},showCreditCardPostalCode:function(){this._toggleCreditCardPostalCodeDisplay(!0)},hideCreditCardPostalCode:function(){this._toggleCreditCardPostalCodeDisplay(!1)},showPCardNumber:function(){this._togglePCardNumberDisplay(!0)},hidePCardNumber:function(){this._togglePCardNumberDisplay(!1)},_getIsOwned:function(){return k.isDefined(this.isOwned)?this.isOwned:!0},_toggleTFXCurrencyOptionsDisplay:function(b){this.data.hasPreferredCurrency&&
a.toggleElement(this.getDOMElement("tfxJSHeader"),!b);a.toggleElement(this.getDOMElement("tfxCurrencyOptions"),b)},showUpdateExpiryDateDropdown:function(){this._toggleUpdateExpiryDateDropdownDisplay(!0)},enableExpiredCreditCardDetail:function(){this.shouldDisplayModernizedFrameCX||(this.getDOMElement("accountHolderName").removeClass("a-color-secondary").addClass("a-color-base"),this.getDOMElement("issuerNumberTail").removeClass("a-color-secondary").addClass("a-color-base"))},disableExpiredCreditCardDetail:function(){this.shouldDisplayModernizedFrameCX||
(this.getDOMElement("accountHolderName").removeClass("a-color-base").addClass("a-color-secondary"),this.getDOMElement("issuerNumberTail").removeClass("a-color-base").addClass("a-color-secondary"))},hideUpdateExpiryDateDropdown:function(){this._toggleUpdateExpiryDateDropdownDisplay(!1)},_toggleEMIAvailableText:function(b){this.isAPBWithEMIEnabled&&(this.isAPBSelected&&0===this.installmentOfferBOsWithAPB.length||!this.isAPBSelected&&0===this.installmentOfferBOs.length)?a.toggleElement(this.getDOMElement("installmentEMIAvailable"),
!1):a.toggleElement(this.getDOMElement("installmentEMIAvailable"),b)},_changeEMIMessageSpacing:function(a,b){a?this.getDOMElement(b).removeClass("a-spacing-top-mini"):this.getDOMElement(b).addClass("a-spacing-top-mini")},_toggleEMISuppressionText:function(b){a.toggleElement(this.getDOMElement(this.data.JsReferenceEMISuppressionMessage),b);b&&(this._toggleEMIAvailableText(!1),this._toggleEMINotAvailableText(!1),this._toggleNCEAvailableText(!1),this._toggleNCENotAvailableText(!1),a.toggleElement(this.getDOMElement("IBDWithAPB"),
!1),a.toggleElement(this.getDOMElement("IBDWithoutAPB"),!1),a.toggleElement(this.getDOMElement("IBDWithAPBIsEmpty"),!1),a.toggleElement(this.getDOMElement("IBDWithAPBAsZero"),!1),a.toggleElement(this.getDOMElement("IBDv1Message"),!1))},_togglePaymentMethodDegradedText:function(b){a.toggleElement(this.getDOMElement("CCPaymentMethodDegradedText"),b)},_toggleInlinePaymentMessaging:function(b){this.shouldDisplayInlineMsgForMultiTender||a.toggleElement(this.getDOMElement("targetedPaymentMethodInlineMessage"),
b)},_toggleNCEAvailableText:function(b){this.isAPBWithEMIEnabled&&(this.isAPBSelected&&0===this.installmentOfferBOsWithAPB.length||!this.isAPBSelected&&0===this.installmentOfferBOs.length)?a.toggleElement(this.getDOMElement("installmentNCEAvailable"),!1):a.toggleElement(this.getDOMElement("installmentNCEAvailable"),b)},_toggleEMINotAvailableText:function(b){a.toggleElement(this.getDOMElement("installmentEMINotAvailable"),b);a.toggleElement(this.getDOMElement("installmentEMINotAvailablePopoverContent"),
b)},_toggleNCENotAvailableText:function(b){a.toggleElement(this.getDOMElement("installmentNCENotAvailable"),b)},_toggleInstallmentsNotAvailableText:function(b){a.toggleElement(this.getDOMElement("installmentsNotAvailable"),!this.hasVisibleInstallmentOffer||b)},_toggleNCEAvailableTextWithAPB:function(b){this.isAPBWithEMIEnabled&&(this.isAPBSelected&&0===this.installmentOfferBOsWithAPB.length||!this.isAPBSelected&&0===this.installmentOfferBOs.length)?a.toggleElement(this.getDOMElement("nceAvailableTextWithAPB"),
!1):a.toggleElement(this.getDOMElement("nceAvailableTextWithAPB"),b)},_toggleEMIMessage:function(b,c,e){this.isAPBWithEMIEnabled&&(this.isAPBSelected&&0===this.installmentOfferBOsWithAPB.length||!this.isAPBSelected&&0===this.installmentOfferBOs.length)?a.toggleElement(this.getDOMElement(b),!1):(a.toggleElement(this.getDOMElement(b),c),this.isNomenclatureWave2Enabled||this._changeEMIMessageSpacing(e,b))},displayEMIMessages:function(a){this.isEmiMessagingEnabled&&(this.isAPBSelected?this.isAPBWithEMIEnabled?
this.emiHelpTextOnAPBDeselected(a):this.emiHelpTextOnAPBSelected(a):this.emiHelpTextOnAPBDeselected(a))},emiHelpTextOnAPBSelected:function(a){this._toggleEMIAvailableText(!1);this._toggleEMINotAvailableText(!0);this._toggleNCEAvailableText(!1);this._toggleNCENotAvailableText(!0)},emiHelpTextOnAPBDeselected:function(a){this.shouldDisplayNomenclatureWave1Changes&&!this.isNomenclatureWave2Enabled?this._toggleEMIMessage("installmentEMIAvailable",!0,a):this._toggleEMIAvailableText(!a);this._toggleEMINotAvailableText(!1);
this.displayNCEHelpText(a);this._toggleNCENotAvailableText(!1)},displayNCEHelpText:function(a){this.isAPBWithEMIEnabled&&this.isAPBSelected?this.shouldDisplayNomenclatureWave1Changes?(this._toggleEMIMessage("nceAvailableTextWithAPB",!0,a),this._toggleEMIMessage("installmentNCEAvailable",!1,a)):(this._toggleNCEAvailableTextWithAPB(!0),this._toggleNCEAvailableText(!1)):this.shouldDisplayNomenclatureWave1Changes?(this._toggleEMIMessage("nceAvailableTextWithAPB",!1,a),this._toggleEMIMessage("installmentNCEAvailable",
!0,a)):(this._toggleNCEAvailableTextWithAPB(!1),this._toggleNCEAvailableText(!0))},showInstallmentOffers:function(){this._toggleInstallmentOffers(!0);this.displayEMIMessages(!0)},hideInstallmentOffers:function(){this._toggleInstallmentOffers(!1);this.displayEMIMessages(!1)},_toggleRewardsBalanceAvailableMessage:function(b){a.toggleElement(this.getDOMElement("rewardsBalanceAvailableMessage"),b)},_toggleUpdateExpiryDateDropdownDisplay:function(b){this.useUpdatedCardExpirationCx?a.toggleElement(this.getDOMElement("updateExpiryDateLink"),
!b):(a.toggleElement(this.getDOMElement("updateExpiryDateJSHeader"),!b),a.toggleElement(this.getDOMElement("expiryDate"),!b));a.toggleElement(this.getDOMElement("updateExpiryDate"),b);a.toggleElement(this.getDOMElement("updateExpiryDateDropDown"),b);this.useUpdatedCardExpirationCx&&(a.toggleElement(this.getDOMElement("updateExpiryDateButton"),b),this.isExpired&&!this.hasUpdatedExpired&&this._toggleUpdateExpiryDateButtonDisplay(!1))},_toggleUpdateExpiryDateButtonDisplay:function(b){a.toggleDisabledElement(this.getDOMElement("updateExpiryDateButton"),
b)},_toggleCreditCardPaymentDetailDisplay:function(b){a.toggleElement(this.getDOMElement("creditCardPaymentDetail"),b)},_toggleCreditCardVerificationDisplay:function(b){a.toggleElement(this.getDOMElement("creditCardVerification"),b)},_togglePaymentMethodInlineMessage:function(b){a.toggleElement(this.getDOMElement("paymentMethodInlineMessage"),b)},_togglePageInlineWarningMessage:function(b){a.toggleElement(this.getDOMElement("pageInlineWarningMessage"),b)},_toggleCreditCardPostalCodeDisplay:function(b){a.toggleElement(this.getDOMElement("creditCardPostalCode"),
b)},_togglePCardNumberDisplay:function(b){a.toggleElement(this.getDOMElement("pcardNumberField"),b)},_togglePCIComplianceComponentDisplay:function(b){a.toggleElement(this.getDOMElement("pciComponentContainer"),b)},_toggleExternalTokenCustomerConsentSection:function(b){a.toggleElement(this.getDOMElement("externalTokenCustomerConsentSection"),b)},_toggleCardTokenAboutToExpireMessageSection:function(b){a.toggleElement(this.getDOMElement("externalTokenAboutToExpireMessageSection"),b)},_toggleCardTokenExpiredMessageSection:function(b){a.toggleElement(this.getDOMElement("externalTokenExpiredMessageSection"),
b)},_toggleInstallmentOffers:function(b){this._toggleInstallmentsAvailableMessage(b);a.toggleElement(this.getDOMElement("installmentSelections"),b);a.toggleElement(this.getDOMElement("installmentsItemIneligible"),b)},_toggleInstallmentsAvailableMessage:function(b){b=this.isEligibleForFxInstallments?this.isGiftCardCheckboxSelected:b;b=this.isInstallmentsEligible&&!this.isAddressChallenged&&!b;a.toggleElement(this.getDOMElement("installmentsAvailable"),b)},_toggleInstallmentActivationExpander:function(b){a.toggleElement(this.getDOMElement("creditCardInstallmentActivationExpander"),
b)},_toggleFinancialOffers:function(a){this.hasFinancialOffer&&this.widget.trigger("toggleFinancialOffer",{instrumentId:this.data.instrumentId,isSelected:a,isAddressChallenged:this.isAddressChallenged})},_togglePurchaseFinancingOffers:function(a){this.hasPurchaseFinancingOffer&&this.widget.trigger("togglePurchaseFinancingOffers",{instrumentId:this.data.instrumentId,isSelected:a})},_getCreditCardRow:function(a){return this.getDOMElement("creditCardContainer-"+a)},_triggerInstrumentRowSelectedEvent:function(a,
b,e){this.widget.trigger(c,{instrumentId:a,isRecurringChargePaymentMethod:b,paymentMethod:"CC",isInstrumentOwned:e})},_instrumentRowSelected:function(a){n(this.getDOMElement("instrumentRowSelection-"+a)).prop("checked",!0);var b=this._getCreditCardRow(a);this.showAuthorizationFailureAlert&&this.initialSelectedFixupInstrumentId===a?b.addClass("pmts-fixup-selected"):b.addClass("pmts-selected");this._triggerCreditCardRowSelectedEvent(a);this._createSecureFieldFrame(a)},_instrumentRowDeselected:function(){this._deselectingInstrument();
this._onCreditCardDeselected()},_createSecureFieldFrame:function(a){this.isPaySelectCvvSecureFieldEnabled&&this.widget.trigger(d,{secureFieldId:"secureFieldsCVV-"+a})},_removeSecureFieldFrame:function(a){this.isPaySelectCvvSecureFieldEnabled&&this.widget.trigger(f,{secureFieldId:"secureFieldsCVV-"+a})},_confirmButtonClicked:function(a){this.isCardSelected&&this.widget.trigger("confirmButtonClicked",{instrumentId:this.data.instrumentId})},_triggerCreditCardRowSelectedEvent:function(b,c){var e=this.getDOMElement("instrumentRowSelection-"+
b).val();a.showElement(n(this.getDOMElement("creditCardInstallmentActivationRetryExceededAlert-"+b)));this.widget.trigger("creditCardRowSelected",{instrumentId:b,instrumentSelectionValue:e,isInstrumentOwned:c})},_deselectingInstrument:function(){this._removeSecureFieldFrame(this.data.instrumentId);this.getDOMElement("instrumentRowSelection-"+this.data.instrumentId).prop("checked",!1);var b=this._getCreditCardRow(this.data.instrumentId);b.removeClass("pmts-selected");this.showAuthorizationFailureAlert&&
b.removeClass("pmts-fixup-selected");a.hideElement(this.getDOMElementsByPrefix("addressChallengeMessages-"));a.hideElement(this.getDOMElementsByPrefix("addressChallengeMobileConfirmButtons-"));a.hideElement(this.getDOMElementsByPrefix("addressChallengeScan-"));a.hideElement(this.getDOMElementsByPrefix("creditCardInstallmentActivationExpander-"));a.hideElement(this.getDOMElementsByPrefix("creditCardInstallmentActivationRetryExceededAlert-"));a.hideElement(this.getDOMElementsByPrefix("inactiveMbccMessages-"))},
_creditCardRowClicked:function(a){var b=n(a.currentTarget);a=b.data("instrument-id");var c=b.data("co-brand"),d=b.data("disabled"),g=b.data("is-owned"),b=b.data("is-recurring-charge");"AmazonVisaSignature"===c&&e.logCounterMetric({feature:"selected-cbcc",resource:"_Count"});"AmazonVisaSignature"===I&&"AmazonVisaSignature"!==c&&e.logCounterMetric({feature:"deselected-cbcc",resource:"_Count"});I=c;d||!a||this.isCardSelected||this._triggerInstrumentRowSelectedEvent(a,b,g)},_showAddressChallengeErrors:function(b){var c=
this;0<b.errorMessages.length&&(k.forEach(b.errorMessages,function(e){a.showElement(c.getDOMElement(c._getJsRefForErrorMessage(b.instrumentId,e)))}),a.showElement(c.getDOMElement("addressChallengeErrors-"+b.instrumentId)))},_getJsRefForErrorMessage:function(a,b){b=u[b.messageStringId];"undefined"===typeof b&&(b="-unknown");return"addressChallengeError-"+a+b},_selectConsentCheckbox:function(){this.form.getAUITagHelperForParameter(this.externalTokenCustomerConsentFieldName).getControlElement().val(!0);
this.$consentCheckboxDomElement.prop("checked",!0);this.updateContinueButton()},_deselectConsentCheckbox:function(){this.form.getAUITagHelperForParameter(this.externalTokenCustomerConsentFieldName).getControlElement().val(!1);this.$consentCheckboxDomElement.prop("checked",!1);this.updateContinueButton()},_showConsentConfirmationPopover:function(){this.getDOMElement("apx-customer-tokenization-consent-confirmation-bottomsheet").length&&this.getDOMElement("apx-customer-tokenization-consent-confirmation-bottomsheet").click();
this.getDOMElement("apx-customer-tokenization-consent-confirmation-popover").length&&this.getDOMElement("apx-customer-tokenization-consent-confirmation-popover").click();this.$explicitConsentBottomsheet=this.getDOMElement("apx-customer-tokenization-consent-confirmation-bottomsheet")},_hideConsentConfirmationBottomSheet:function(){var a=this;t.when("a-sheet").execute("consent-sheet-events",function(b){b&&(b=b.get("apx-customer-tokenization-consent-confirmation-bottomsheet"+a.data.instrumentId))&&b.hide()})},
_hideConsentConfirmationModal:function(){var a=this;t.when("a-modal").execute("consent-modal-events",function(b){b?(b=b.get("apx-customer-tokenization-consent-confirmation-popover"+a.data.instrumentId))&&b.hide():a.tokenizationConsentPopoverReference&&(b=n(a.tokenizationConsentPopoverReference.find("button[data-action]\x3da-popover-close")[0]))&&b.trigger("click")})},_onTokenisationConsentApprovedButtonClick:function(a){this._selectConsentCheckbox();this.$explicitConsentBottomsheet.length&&this._hideConsentConfirmationBottomSheet();
this.getDOMElement("apx-customer-tokenization-consent-confirmation-popover").length&&this._hideConsentConfirmationModal();this.widget.trigger("ConsentPopoverContinueButtonClicked");a.stopPropagation()},_onTokenisationConsentRevokedButtonClick:function(a){this._deselectConsentCheckbox();this.$explicitConsentBottomsheet.length&&this._hideConsentConfirmationBottomSheet();this.getDOMElement("apx-customer-tokenization-consent-confirmation-popover").length&&this._hideConsentConfirmationModal();this.widget.trigger("ConsentPopoverContinueButtonClicked");
a.stopPropagation()},_bindClickEventsToTokenisationConsentButtons:function(a,b,c){a.bindTokenisationConsentConfirmationToClick&&(n(b).bind("click",function(b){a._onTokenisationConsentApprovedButtonClick(b)}),a.bindTokenisationConsentConfirmationToClick=!1);a.bindTokenisationConsentRevokedToClick&&(n(c).bind("click",function(b){a._onTokenisationConsentRevokedButtonClick(b)}),a.bindTokenisationConsentRevokedToClick=!1)},bindToElements:function(){var a=this;this._isDesktop?(a.getDOMElement("CVVHelpMessageLink").mouseover(function(){a.widget.publishSuccessSushiMetrics({ActionValue:"CVVHelpMessagePopover",
ActionValueType:"Mouseover"})}),a.getDOMElement("CardRecommendationMessageLink").mouseover(function(){a.widget.publishSuccessSushiMetrics({ActionValue:"CardRecommendationMessagePopover",ActionValueType:"Mouseover"})}),a.getDOMElement("CBCCRecommendationMessageLink").mouseover(function(){a.widget.publishSuccessSushiMetrics({ActionValue:"CBCCCardRecommendationMessagePopover",ActionValueType:"Mouseover"})})):(a.getDOMElement("CVVHelpMessageLink").click(function(){a.widget.publishSuccessSushiMetrics({ActionValue:"CVVHelpMessagePopover",
ActionValueType:"Click"})}),a.getDOMElement("CardRecommendationMessageLink").click(function(){a.widget.publishSuccessSushiMetrics({ActionValue:"CardRecommendationMessagePopover",ActionValueType:"Click"})}),a.getDOMElement("CBCCRecommendationMessageLink").click(function(){a.widget.publishSuccessSushiMetrics({ActionValue:"CBCCCardRecommendationMessagePopover",ActionValueType:"Click"})}));a.getDOMElement("CardSuppressionMessageLink").click(function(){a.widget.publishSuccessSushiMetrics({ActionValue:"CardSuppressionMessagePopover",
ActionValueType:"Click"})});var b=a.form.fields.currencySelection,c=this.fixExpiredCardUpdation?a.form.fields[a.expirationDateFieldName]:a.form.fields.expirationDate;a.getDOMElement("updateExpiryDateButton").click(function(b){a.widget.trigger("RemoveSetPaymentPlanSelectContinueEvent")});a.getDOMElement("tfxShowCurrencyOptionsLink").click(function(c){a.showTFXCurrencyOptions();a.triggerInstrumentRowSelectedEvent();a.form.getAUITagHelperForParameter(b.radioButtonName).isChecked()&&a.disableTFXCurrencyDropdown();
c.preventDefault()});a.isPaySelectCvvSecureFieldEnabled||a.getDOMElement("creditCardVerification").keypress(function(b){b.which===q.keys.VK_RETURN&&(b.preventDefault(),a.checkCreditCardVerificationCode(),k.isDefined(a.getErrorStringId())?a.updateContinueButton():a.widget.trigger("ContinueButtonClicked"))});a.getDOMElement("creditCardVerification").click(function(b){a.widget.publishSuccessSushiMetrics({ActionType:"CreditCardVerificationEvent",ActionValueType:"Click",ActionValue:"CreditCardVerificationBoxClicked",
ActionParentValueType:"PaymentInstrument",ActionParentValue:a.data.instrumentId})});a.getDOMElement("tfxPreferredCurrency").click(function(c){!1===a.isEligibleForFxInstallments&&(a.updateTFXCurrencyHeader(a.form.getAUITagHelperForParameter(b.radioButtonName).val()),a.disableTFXCurrencyDropdown());a.widget.trigger("tfxPreferredCurrencySelected",{instrumentId:a.data.instrumentId})});a.getDOMElement("tfxSelectCurrency").click(function(c){!1===a.isEligibleForFxInstallments&&(c.preventDefault(),c=a.form.getAUITagHelperForParameter(a.form.fields.currencySelection.dropdownName).isEnabled(),
a.requiresCurrency||!c)&&(a.enableTFXCurrencyDropdown(),p.setTimeout(function(){a.form.getAUITagHelperForParameter(b.dropdownName).getControlElement().trigger("change")},100));a.widget.trigger("tfxSelectCurrencySelected",{instrumentId:a.data.instrumentId})});a.getDOMElement("apx-card-token-expired-update-button").click(function(b){b={"ppw-widgetEvent":"DeleteExpiredCardTokenInstrumentEvent","ppw-widgetState":a.widget.options.serializedState,"ppw-instrumentId":a.data.instrumentId,"ppw-payStationId":a.payStationId};
a.isCardInstrumentDeleted=!0;a.updateContinueButton();a.widget.continueRequest(b,{success:function(){e.logCounterMetric({feature:"DeleteExpiredCardTokenInstrumentEventSuccess",resource:"_Count"})},error:function(){e.logCounterMetric({feature:"DeleteExpiredCardTokenInstrumentEventFailure",resource:"_Count"})},complete:function(){e.publishMetrics()}});a.widget.trigger("triggerAddCardFlow");return!1});a.getDOMElement("updateExpiryDateLink").click(function(b){a.isExpired&&a.useUpdatedCardExpirationCx&&
a.enableExpiredCreditCardDetail();a.useNewAddressChallengeFormat&&a.isAddressChallenged||a.showUpdateExpiryDateDropdown();a.triggerInstrumentRowSelectedEvent();a.hidePCardNumber();b.preventDefault()});var d=k.bind(a.checkExpirationDate,a);a.form.bindToParameter(c.monthParameterName,"change",d);a.form.bindToParameter(c.yearParameterName,"change",d);a.form.bindToParameter(b.radioButtonName,"change",k.bind(a.checkCurrencySelection,a));a.form.bindToParameter(b.dropdownName,"change",function(c){a.form.getAUITagHelperForParameter(b.radioButtonName).getControlElement().filter("[value\x3d]").prop("checked",
!0);a.updateTFXCurrencyHeader();a.checkCurrencySelection()});this.isCreditCardVerificationRequired&&!this.isPaySelectCvvSecureFieldEnabled&&n(this.getDOMElement(this.cvvFieldName)).bind("input",function(){a.checkCreditCardVerificationCode();a.updateContinueButton()});this.$consentCheckboxDomElement.length&&n(this.$consentCheckboxDomElement).bind("click",function(b){a.$consentCheckboxDomElement.prop("checked")?a._selectConsentCheckbox():a._deselectConsentCheckbox();b.stopPropagation()});t.when("A",
"a-sheet","ready").execute(function(b){b.on("a:sheet:beforeShow:apx-customer-tokenization-consent-confirmation-bottomsheet"+a.data.instrumentId,function(){var b=a.getDOMElement("apx-tokenization-consent-approved-button"),c=a.getDOMElement("apx-tokenization-consent-revoked-button");a._bindClickEventsToTokenisationConsentButtons(a,b,c)})});t.when("A","a-modal","ready").execute(function(b){b.on("a:popover:beforeShow:apx-customer-tokenization-consent-confirmation-popover"+a.data.instrumentId,function(b){b.popover&&
(a.tokenizationConsentPopoverReference=b.popover.$popover);b=a.getDOMElement("apx-tokenization-consent-approved-button");var c=a.getDOMElement("apx-tokenization-consent-revoked-button");a._bindClickEventsToTokenisationConsentButtons(a,b,c)})});this.isCreditCardPostalCodeRequired&&n(this.getDOMElement(this.data.instrumentId+"_postalCode")).bind("input",function(){a.checkCreditCardPostalCode();a.updateContinueButton()});a.shouldDecoupleCardsFromSavedCardsSection&&(a.getDOMElementsByPrefix("creditCardContainer-").click(k.bind(this._creditCardRowClicked,
this)),a.getDOMElementsByPrefix("addressChallengeMobileConfirmButtons-").click(k.bind(this._confirmButtonClicked,this)),a.getDOMElementsByPrefix("installmentActivationMobileConfirmButtons-").click(k.bind(this._confirmButtonClicked,this)));v.bindToElements.apply(this)},bindToEvents:function(){var b=this;b.widget.on("initializeRecommendedInstrument",b,function(a){if(a.instrumentId===b.data.instrumentId||b.isDecoratePayStationBOAndLegacyBOEnabled&&a.instrumentId===b.payStationId)if(this.isCardSelected=
!0,this.orderSummaryFired=!1,b.shouldDecoupleCardsFromSavedCardsSection){b.showAuthorizationFailureAlert&&!b.initialSelectedFixupInstrumentId&&(b.initialSelectedFixupInstrumentId=b.data.instrumentId);var c=b._getCreditCardRow(b.data.instrumentId);null!==c&&1===c.length&&null!==c[0].attributes&&(a="true"===c[0].attributes.getNamedItem("data-is-recurring-charge").value,c=this.isABCrossCustomerMultiTenderSuppressionEnabled&&null!==c[0].attributes.getNamedItem("data-is-owned")&&"false"===c[0].attributes.getNamedItem("data-is-owned").value?
!1:!0,b._triggerInstrumentRowSelectedEvent(b.data.instrumentId,a,c))}else b._onCreditCardSelected();else this.isCardSelected=!1,b._onCreditCardDeselected()});if(this.isDynamicOrderSummaryEnabled)b.widget.on("componentsInitialized",b,function(){var a=document.getElementsByName("ppw-"+b.data.instrumentId+"_instrumentOrderTotalBalance")[0];a&&(a.value=JSON.stringify({}))});b.widget.on("DisplayConsentPopover"+b.data.instrumentId,b,function(a){b._showConsentConfirmationPopover()});b.widget.on("validateConsentCheckBoxStatus"+
b.data.instrumentId,b,function(a){a=!0;b.$consentCheckboxDomElement.length&&(a=b.$consentCheckboxDomElement.prop("checked"));this.widget.trigger("updateConsentCheckBoxStatus",{consentCheckBoxStatus:a,isCardSelected:this.isCardSelected})});b.widget.on("creditCardRowSelected",b,function(a){a.instrumentId===b.data.instrumentId?(this.isCardSelected=!0,this.orderSummaryFired=!1,b._onCreditCardSelected()):(this.isCardSelected=!1,b._onCreditCardDeselected())});b.widget.on(c,b,function(a){b.shouldDecoupleCardsFromSavedCardsSection&&
(b.data.instrumentId===a.instrumentId?(this.isCardSelected=!0,b._instrumentRowSelected(a.instrumentId)):(this.isCardSelected=!1,b._instrumentRowDeselected()))});b.widget.on("resetSelectedPaymentMethod",b,function(a){b.shouldDecoupleCardsFromSavedCardsSection&&b.isCardSelected&&(this._deselectingInstrument(b.data.instrumentId),b.isCardSelected=!1,this.setContinuable(!1),a=a.isInstallmentPlansAvailable?b.widget.getLocalizedString("apx_payselect_apb_plus_emi_feature_emi_plan_change_message"):b.widget.getLocalizedString("apx_payselect_apb_plus_emi_feature_deselect_apb_to_view_emi_options_message"),
this.widget.trigger("PaymentPlanSelected",{isValid:!1,message:a}),this.widget.trigger("ChangeInAPBSelectionAfterInstallmentPlanSelectionEvent",{message:a}))});b.widget.on("showInstallmentActivation",b,function(c){b.shouldDecoupleCardsFromSavedCardsSection&&c.instrumentId===b.data.instrumentId&&a.showElement(b.getDOMElement("creditCardInstallmentActivationExpander-"+c.instrumentId))});b.widget.on("APBPreselected",b,function(a){b._onCreditCardDeselected()});b.widget.on("showAddressChallenge",b,function(c){c.instrumentId===
b.data.instrumentId&&(this.useNewAddressChallengeFormat||b.hideCreditCardPaymentDetail(),b._toggleRewardsBalanceAvailableMessage(!1),b.setAddressChallenged(!0),b._toggleFinancialOffers(!0),b._togglePurchaseFinancingOffers(!0),b.shouldDecoupleCardsFromSavedCardsSection&&(a.showElement(b.getDOMElement("addressChallengeMessages-"+c.instrumentId)),a.showElement(b.getDOMElement("addressChallengeMobileConfirmButtons-"+c.instrumentId)),a.showElement(b.getDOMElement("addressChallengeScan-"+c.instrumentId))))});
b.widget.on("showAddressChallengeErrors",b,function(a){b.shouldDecoupleCardsFromSavedCardsSection&&a.instrumentId===b.data.instrumentId&&b._showAddressChallengeErrors(a)});b.widget.on("hideAddressChallengeErrors",b,function(c){b.shouldDecoupleCardsFromSavedCardsSection&&c.instrumentId===b.data.instrumentId&&(a.hideElement(b.getDOMElementsByPrefix("addressChallengeError-"+c.instrumentId)),a.hideElement(b.getDOMElement("addressChallengeErrors-"+c.instrumentId)))});b.widget.on("addressChallengePassed",
b,function(c){c.instrumentId===b.data.instrumentId&&(b.shouldDecoupleCardsFromSavedCardsSection&&(a.hideElement(b.getDOMElement("addressChallengeMessages-"+c.instrumentId)),a.hideElement(b.getDOMElement("addressChallengeMobileConfirmButtons-"+c.instrumentId)),a.hideElement(b.getDOMElement("addressChallengeScan-"+c.instrumentId))),b.showCreditCardPaymentDetail(),b.hideUpdateExpiryDateDropdown(),b.showPCardNumber(),a.toggleElement(this.getDOMElement("tfxCurrencyDetails"),!0),a.toggleElement(this.getDOMElement("rewardsAccountDetails"),
!0),b._toggleRewardsBalanceAvailableMessage(!1),b.setAddressChallenged(!1),b.data.childRewardsAccountInstrumentId&&b.checkRewardsAccountSelection(),b.updateContinueButton(),b._toggleFinancialOffers(!0),b._togglePurchaseFinancingOffers(!0),b.showInstallmentOffers())});b.widget.on("addressChallengeValidate",b,function(a){if(a.instrumentId===b.data.instrumentId){a=[];var c=this.fixExpiredCardUpdation?this.form.fields[this.expirationDateFieldName]:this.form.fields.expirationDate,e=this.fixExpiredCardUpdation?
this.expirationDateFieldName:this.EXPIRATION_DATE_FIELD_NAME;b.data.isExpired&&(b.form.clearValidationErrors(),a=this._validateFormField(e),0<a.length&&(k.forEach(a,function(a){b.form.blameFormField(a.field,!0)}),b.widget.trigger("showAddressChallengeErrors",{instrumentId:b.data.instrumentId,errorMessages:a})));b.widget.trigger("expirationDateValidated",{instrumentId:b.data.instrumentId,isExpirationDateValid:0===a.length,expMonth:b.form.getFormValues()[c.monthParameterName],expYear:b.form.getFormValues()[c.yearParameterName]})}});
b.widget.on("creditCardUpdated",b,function(c){if(c.instrumentId===b.data.instrumentId){var e=c.newExpMonth;c=c.newExpYear;b.getDOMElement("expiryDate").text(b.makeExpirationDateString(e,c));a.hideElement(b.getDOMElement("updateExpiryDateLink"))}});b.widget.on("installmentsEligibilityChanged",b,function(a){b.isInstallmentsEligible=a.isEligible;this._toggleInstallmentOffers(this.isCardSelected)});if(this.isPaylastEligible||this.showFloatingContinueBarOnNonPaylastPSP)b.widget.on("UpdateOrderTotalForNoCostEMIDiscount",
b,function(a){b.appliedNoCostEMIDiscount=a&&0<a.noCostEMIValue?parseFloat(a.noCostEMIValue):0});b.widget.on("apbSelectionChanged",b,function(c){this.isAPBSelected=c.isSelected;if(this.isCardSelected){if(b.orderSummaryFired=!1,b._onCreditCardSelected(),b.shouldDecoupleCardsFromSavedCardsSection){var e=b._getCreditCardRow(b.data.instrumentId).hasClass("pmts-selected");b.widget.get("apbCheckboxSelected")!==r&&e&&this.widget.trigger("toggleInstallmentDropDown",{isAPBSelected:c.isSelected,instrumentId:b.data.instrumentId})}}else b._onCreditCardDeselected();
if(this.isAPBWithEMIEnabled){c="";var e=!1,d=b.getDOMElement("emiMessagingSlot");a.hideElement(d);this.shouldDecoupleCardsFromSavedCardsSection&&this.isCardSelected&&this.widget.trigger("apbSelectionChangedForAPBWithEMIFeature",{selectedInstrumentId:b.data.instrumentId});this.isAPBSelected?0===this.installmentOfferBOsWithAPB.length&&(e=!0,c=b.widget.getLocalizedString("apx_payselect_apb_plus_emi_feature_deselect_apb_to_view_emi_options_message")):0===this.installmentOfferBOs.length&&(e=!0,c=b.widget.getLocalizedString("apx_payselect_apb_plus_emi_feature_select_apb_to_view_emi_options_message"));
this.isEMIAvailable&&e&&(this._toggleEMIAvailableText(!1),this._toggleNCEAvailableText(!1),this._toggleNCEAvailableTextWithAPB(!1),this.shouldDisplayNomenclatureWave1Changes?d[0].getElementsByClassName("a-size-small")[0].textContent=c:d[0].getElementsByClassName("a-alert-content")[0].textContent=c,a.showElement(d))}});b.widget.on("balanceSelectionChanged",b,function(a){if(this.isCardSelected&&this.data.skipFormValidation){if(b.shouldDecoupleCardsFromSavedCardsSection){var c=0<=k.indexOf(H,a.paymentMethod);
this.isABCrossCustomerMultiTenderSuppressionEnabled&&c&&!a.isBackingInstrument&&a.isSelected&&this._updateBackingInstrumentState(a)}this.updateContinueButton()}});b.widget.on("resetSelectedPaymentMethod",b,function(a){b._onCreditCardDeselected()});b.widget.on("installmentsAvailabilityChanged",b,function(a){this._toggleInstallmentsNotAvailableText(!a.isInstallmentsAvailable)});b.widget.on("installmentOptionChanged",b,function(a){this.data.skipFormValidation&&this.isCardSelected&&this.widget.trigger("fetchOrderSummary",
{fetchCompleteOrderSummary:this._shouldFetchOrderSummary(),fetchOSTriggeredByViewDetails:!1})});b.widget.on("optionalInstrumentSelected",b,function(a){"GC"===a.paymentMethod&&b._toggleInlinePaymentMessaging(!1);b.isEligibleForFxInstallments&&"GC"===a.paymentMethod&&(b.isGiftCardCheckboxSelected=!0,b._toggleInstallmentsAvailableMessage())});b.widget.on("optionalInstrumentDeselected",b,function(a){"GC"===a.paymentMethod&&b._toggleInlinePaymentMessaging(!0);b.isEligibleForFxInstallments&&"GC"===a.paymentMethod&&
(b.isGiftCardCheckboxSelected=!1,b._toggleInstallmentsAvailableMessage())});b.widget.on("inactiveMbccSelected",b,function(c){b.shouldDecoupleCardsFromSavedCardsSection&&c.instrumentId===b.data.instrumentId&&a.showElement(b.getDOMElementsByPrefix("inactiveMbccMessages-"+c.instrumentId))});b.widget.on("SecureFieldValidationEvent",b,function(a){b.updateCvvValidationState(a.fieldId,a.fieldIsValid)});if(b.isSecureFieldsEnabledForPrefetch)b.widget.on(g,b,function(a){a.contextId!==this.cvvSecureFieldId||
this.invalidCvv||(e.logCounterMetric({feature:"SecureFieldsPaySelectCVVPrefetchReady",resource:"_Count"}),this.updateContinueButton())});b.widget.on("ContinueButtonClickedWithInvalidPaymentPlanEvent",b,function(c){this.isInvalidCVVErrorMessagingEnabled&&this.isCardSelected&&c.message===b.widget.getLocalizedString("pmts_portal_add_instrument_credit_card_error_security_code_invalid")&&a.showElement(b.getDOMElement("invalidCvvErrorMessagingSlot"))});v.bindToEvents.apply(this)},_updateBackingInstrumentState:function(a){var b=
this._getCreditCardRow(this.data.instrumentId);a=!1!==a.isInstrumentOwned;var e=!1!==b.data("is-owned");b.hasClass("pmts-selected")&&e!==a&&(this._deselectingInstrument(b.data("instrument-id")),this.widget.trigger(c,{}),this.widget.trigger("backingInstrumentSelected",{}))},_onCreditCardSelected:function(){var b=this;this.data.hasPreferredCurrency&&!this.data.isEligibleForFxInstallments||this.showTFXCurrencyOptions();this.showPCIComplianceComponent?this._togglePCIComplianceComponentDisplay(!0):(this.isAddressChallenged?
(this.hidePCardNumber(),this.hideInstallmentOffers(),this.data.expiryDateSelectionDisplayed&&(this.useNewAddressChallengeFormat?(this.useUpdatedCardExpirationCx?a.toggleElement(this.getDOMElement("updateExpiryDateLink"),!1):a.toggleElement(this.getDOMElement("updateExpiryDateJSHeader"),!1),a.toggleElement(this.getDOMElement("expiryDate"),!0)):this.showUpdateExpiryDateDropdown()),this._triggerInstallmentOptionDeselected()):(this.data.childRewardsAccountInstrumentId&&this.checkRewardsAccountSelection(),
this.showPCardNumber(),this.showInstallmentOffers(),this.hasInstallmentOffer||this._triggerInstallmentOptionDeselected()),this.isCreditCardVerificationRequired&&(this.showCreditCardVerification(),this.checkCreditCardVerificationCode()),this.isCreditCardPostalCodeRequired&&(this.showCreditCardPostalCode(),this.checkCreditCardPostalCode()),!this.isExpired&&this.hasUpdatedExpired&&this.showUpdateExpiryDateDropdown(),this.isExpired&&this._triggerInstallmentOptionDeselected());this.isInactiveCupMbcc&&
this._triggerInactiveMbccSelectedEvent();this.data.isSuppressed&&a.showElement(this.getDOMElement(this.data.JsReferenceSavedCardsSuppressionMessage));this.updateContinueButton();this.hideInvalidCvvErrorMessage();this._toggleFinancialOffers(!0);this._togglePurchaseFinancingOffers(!0);this._toggleInstallmentActivationExpander(!0);(this.isPaylastEligible||this.showFloatingContinueBarOnNonPaylastPSP)&&p.setTimeout(function(){b.getDOMElement("installmentSelections")[0]&&b.getDOMElement("installmentSelections")[0].innerText&&
-1!==b.getDOMElement("installmentSelections")[0].innerText.indexOf("No Cost")?b.widget.trigger("GetNoCostEMISelectionDiscountValue",{instrumentId:b.data.instrumentId}):b.widget.trigger("UpdateOrderTotalForNoCostEMIDiscount",{noCostEMIValue:0})},0);this.isEMISuppressed&&this._toggleEMISuppressionText(!0);this.isDebitCardDegraded&&this._togglePaymentMethodDegradedText(!0);this.getDOMElement("paymentMethodInlineMessage")[0]&&this.showPaymentMethodInlineMessage();this.getDOMElement("pageInlineWarningMessage")[0]&&
this.showPageInlineWarningMessage();this._toggleExternalTokenCustomerConsentSection(!0);this._toggleCardTokenAboutToExpireMessageSection(!0);this._toggleCardTokenExpiredMessageSection(!1);this.widget.trigger("UpdateSelectedCardData",{instrumentId:this.data.instrumentId});this.isNomenclatureWave2Enabled&&(this.getDOMElement("cardTitleSlotDecorationContentJsBinding").removeClass("pmts-ellipsis-nomenclature"),this.getDOMElement("installmentEMIAvailable").addClass("hide-element"),this.getDOMElement("nceAvailableTextWithAPB").removeClass("yellow-text-box"),
this.getDOMElement("installmentNCEAvailable").removeClass("yellow-text-box"),this.getDOMElement("installmentEMIAvailableRowJsBinding").removeClass("a-spacing-top-mini"),this.getDOMElement("installmentNCEMIWithAPBAvailableRowJsBinding").removeClass("a-spacing-top-mini"),this.getDOMElement("installmentNCEMIAvailableRowJsBinding").removeClass("a-spacing-top-mini"),this.getDOMElement("installmentNCEMIWithAPBAvailableRowJsBinding").removeClass("pmts-ncemi-row-height-when-unselected"))},_onCreditCardDeselected:function(){this.isNomenclatureWave2Enabled&&
(this.isAPBSelected?(this.getDOMElement("installmentNCEMIWithAPBAvailableRowJsBinding").removeClass("pmts-ncemi-row-height-when-unselected"),this.getDOMElement("installmentNCEMIWithAPBAvailableRowJsBinding").addClass("a-spacing-top-mini"),this.getDOMElement("installmentNCEMIAvailableRowJsBinding").removeClass("a-spacing-top-mini")):(this.getDOMElement("installmentNCEMIAvailableRowJsBinding").addClass("a-spacing-top-mini"),this.getDOMElement("installmentNCEMIWithAPBAvailableRowJsBinding").removeClass("a-spacing-top-mini"),
this.getDOMElement("installmentNCEMIWithAPBAvailableRowJsBinding").addClass("pmts-ncemi-row-height-when-unselected")),this.getDOMElement("installmentEMIAvailableRowJsBinding").addClass("a-spacing-top-mini"),this.getDOMElement("cardTitleSlotDecorationContentJsBinding").addClass("pmts-ellipsis-nomenclature"),this.getDOMElement("installmentEMIAvailable").removeClass("hide-element"),this.getDOMElement("nceAvailableTextWithAPB").addClass("yellow-text-box"),this.getDOMElement("installmentNCEAvailable").addClass("yellow-text-box"));
this.hideTFXCurrencyOptions();this.showCreditCardPaymentDetail();this.data.expiryDateSelectionDisplayed&&this.hideUpdateExpiryDateDropdown();this.isExpired&&this.useUpdatedCardExpirationCx&&this.disableExpiredCreditCardDetail();this.hideCreditCardVerification();this.hideInvalidCvvErrorMessage();this.hideCreditCardPostalCode();this._onRewardsAccountDeselected();this.hidePCardNumber();this.isCardSelected=!1;this.hideInstallmentOffers();this._toggleFinancialOffers(!1);this._togglePurchaseFinancingOffers(!1);
this._toggleInstallmentActivationExpander(!1);this._togglePCIComplianceComponentDisplay(!1);this.data.showSuppressionMessagingUpfront?a.showElement(this.getDOMElement(this.data.JsReferenceSavedCardsSuppressionMessage)):a.hideElement(this.getDOMElement(this.data.JsReferenceSavedCardsSuppressionMessage));this._toggleEMISuppressionText(!1);this.isDebitCardDegraded&&this._togglePaymentMethodDegradedText(!1);this.getDOMElement("paymentMethodInlineMessage")[0]&&this.hidePaymentMethodInlineMessage();this.getDOMElement("pageInlineWarningMessage")[0]&&
this.showPageInlineWarningMessage();this._toggleExternalTokenCustomerConsentSection(!1);this._toggleCardTokenAboutToExpireMessageSection(!1);this._toggleCardTokenExpiredMessageSection(!0)},checkRewardsAccountSelection:function(){this.isExpired||(this.widget.trigger("rewardsAccountSelected",{instrumentId:this.data.childRewardsAccountInstrumentId}),this._toggleRewardsBalanceAvailableMessage(!1))},_onRewardsAccountDeselected:function(){this.data.childRewardsAccountInstrumentId&&(this.widget.trigger("rewardsAccountDeselected",
{instrumentId:this.data.childRewardsAccountInstrumentId}),this._toggleRewardsBalanceAvailableMessage(!0))},triggerInstrumentRowSelectedEvent:function(){this.widget.trigger(c,{instrumentId:this.data.instrumentId,paymentMethod:"CC",isInstrumentOwned:this._getIsOwned()})},checkExpirationDate:function(){this.setExpired(0<this._validateFormField(this.fixExpiredCardUpdation?this.expirationDateFieldName:this.EXPIRATION_DATE_FIELD_NAME).length)},setExpired:function(a){this.useUpdatedCardExpirationCx?(this._toggleUpdateExpiryDateButtonDisplay(!a),
this.hasUpdatedExpired=!a,this.data.childRewardsAccountInstrumentId&&this.checkRewardsAccountSelection()):(this.isExpired=a,this.data.childRewardsAccountInstrumentId&&this.checkRewardsAccountSelection(),this.hasUpdatedExpired=!a,this.updateContinueButton())},checkCurrencySelection:function(){this.setRequiresCurrency(0<this._validateFormField(this.CURRENCY_SELECTION_FIELD_NAME).length)},enableTFXCurrencyDropdown:function(){this._toggleTFXCurrencyOptionsDropdown(!1)},disableTFXCurrencyDropdown:function(){this._toggleTFXCurrencyOptionsDropdown(!0)},
_toggleTFXCurrencyOptionsDropdown:function(a){this.form.getAUITagHelperForParameter(this.form.fields.currencySelection.dropdownName).toggleDisabled(a)},updateTFXCurrencyHeader:function(a){var b=this.form.fields.currencySelection;0===arguments.length&&(a=this.form.getFormValues()[b.dropdownName]);if(a){var b=this.getSelectTextUsingValue(a),c=this.getDOMElement("tfxJSHeader").find("[class\x3d'pmts-tfx-preselected-currency-code']");b&&0!==c.length&&(c[0].innerHTML=b)}},getSelectTextUsingValue:function(a){return this.form.getAUITagHelperForParameter(this.form.fields.currencySelection.dropdownName).getOptionTextForValue(a)},
setRequiresCurrency:function(a){this.requiresCurrency=a;this.updateContinueButton()},setAddressChallenged:function(a){this.isAddressChallenged=a},checkCreditCardVerificationCode:function(){this.showPCIComplianceComponent||this.isPaySelectCvvSecureFieldEnabled||(this.invalidCvv=0<this._validateFormField(this.cvvFieldName).length)},updateCvvValidationState:function(a,b){a!==this.cvvSecureFieldId||this.showPCIComplianceComponent||(this.invalidCvv=!b,!this.isSecureFieldsEnabledForPrefetch||this.invalidCvv?
this.updateContinueButton():this.widget.trigger(h,{contextId:a}))},checkCreditCardPostalCode:function(){this.invalidPostalCode=0<this._validateFormField(this.CREDIT_CARD_POSTAL_CODE_FIELD_NAME).length},_validateFormField:function(a){return k.filter(this.form.validateForm(),function(b){return b.field===a})},updateContinueButton:function(){var a=this.getErrorStringId(),a=a?this.widget.getLocalizedString(a):null;this._triggerBackingInstrumentSelectedEvent(a);this.data.skipFormValidation&&!this.orderSummaryFired&&
(this.orderSummaryFired=!0,this.widget.trigger("fetchOrderSummary",{fetchCompleteOrderSummary:this._shouldFetchOrderSummary(),fetchOSTriggeredByViewDetails:!1}))},_shouldFetchOrderSummary:function(){var a=this.form.getFormValues()[this.cvvFieldName];return this.data.isSuppressed||this.isInactiveCupMbcc||this.isAddressChallenged||this.showPCIComplianceComponent||this.isExpired||this.requiresCurrency||!this.acceptanceData.accepted?!1:this.invalidCvv&&a&&0<a.length?!1:!0},getErrorStringId:function(){var a=
null;this.data.isSuppressed?a=this.data.suppressionStringId:this.acceptanceData.accepted?this.isInactiveCupMbcc?a="pmts_portal_payselect_blocked_continue_inactive_mbcc":this.showPCIComplianceComponent?a="pmts_portal_card_verification_required":this.isAddressChallenged?a="pmts_portal_payselect_blocked_continue_address_challenge":this.isExpired?a="pmts_portal_payselect_blocked_continue_instrument_expired":this.requiresCurrency?(a="pmts_portal_payselect_blocked_continue_currency_required",e.logCounterMetric({feature:"PaySelectContinueBlockedCurrencyRequired",
resource:"_Count"})):this.invalidCvv?a="pmts_portal_add_instrument_credit_card_error_security_code_invalid":this.invalidPostalCode?a="pmts_portal_add_instrument_credit_card_error_postal_code_invalid":this.isCardInstrumentDeleted&&(a="pmts_portal_token_expired_instrument_deleted"):a=this.acceptanceData.notAcceptedButtonTooltip;e.publishMetrics();return a},_triggerBackingInstrumentSelectedEvent:function(a){this.widget.trigger("backingInstrumentSelected",{instrumentId:this.data.instrumentId,errors:a?
[a]:null,paymentMethod:this.data.paymentMethod,isEligibleForTfx:this.isEligibleForTfx})},_triggerInstallmentOptionDeselected:function(){this.widget.trigger(this.INSTALLMENT_OPTION_CHANGED_EVENT)},makeExpirationDateString:function(a,b){return(2>a.length?"0"+a:a)+"/"+b},_triggerInactiveMbccSelectedEvent:function(){this.widget.trigger("inactiveMbccSelected",{instrumentId:this.data.instrumentId})}})});l("components/CreditCardListItemInstallmentsComponent","events/InstallmentOfferRowSelectedEvent events/InstrumentRowSelectedEvent form-component jQuery AUI!P css-utils lang InstallmentOptionsAccordionHelper".split(" "),
function(c,d,f,h,g,a,m,k){return f.extend({selectedInstallmentOfferCategory:null,currentInstrumentId:null,categorizedInstallmentOffers:{},isAPBWithEMIEnabled:!1,isDownPaymentEnabled:!1,previouslySelectedInstallmentPlanId:null,installmentOfferBOs:[],installmentOfferBOsWithAPB:[],isPaylastEligible:!1,isEligibleForFxInstallments:!1,isMarketplaceCurrencySelected:!1,initialize:function(a,b){this.currentInstrumentId=b.data.instrumentId;this.isSingleInstallmentRow=b.data.isSingleInstallmentRow;this.installmentOffers=
b.data.installmentOffers;this.installmentOffersWithAPB=b.data.installmentOffersWithAPB;this.touchLinkDisplayStrings=b.data.touchLinkDisplayStrings;this.installmentsOneTimePaymentOfferCategoryName=b.data.installmentsOneTimePaymentOfferCategoryName;this.installmentsAvailableString=b.data.installmentsAvailableString;this.touchLinkDisplayStrings=b.data.touchLinkDisplayStrings;this.isAPBWithEMIEnabled=b.data.isAPBWithEMIEnabled;this.isDownPaymentEnabled=b.data.isDownPaymentEnabled;this.isDownPaymentWithAPBSelectionFixEnabled=
b.data.isDownPaymentWithAPBSelectionFixEnabled;this.isAccordionViewForDesktopEnabled=b.data.isAccordionViewForDesktopEnabled;this.isAccordionViewForMobileEnabled=b.data.isAccordionViewForMobileEnabled;this.isInstallmentsCarouselView=b.data.isInstallmentsCarouselView;this.isInstallmentsWithFeeInfoPopoverViewEnabled=b.data.isInstallmentsWithFeeInfoPopoverViewEnabled;this.dropdownSelectedIndex=-1;this.installmentOptionSelectionHiddenInputValue="";this.isMultiTenderDisabledWithGiftCard=b.data.isMultiTenderDisabledWithGiftCard;
this.isGiftCardCheckboxSelected=!1;this.maxAllowedOtherPaymentMethodAmount=this.selectedPromoAmount=this.selectedGCAmount=this.selectedJPPoints=this.selectedRewardsAmount=0;this.useInstallmentsBalanceEligibility=!1;b.data.maxAllowedOtherPaymentMethodAmount&&(this.maxAllowedOtherPaymentMethodAmount=b.data.maxAllowedOtherPaymentMethodAmount.value,this.useInstallmentsBalanceEligibility=!0);b.data.fxInstallmentsDisplayData&&(this.isEligibleForFxInstallments=!0,this.isMarketplaceCurrencySelected=b.data.fxInstallmentsDisplayData.cardCurrencyMatchesMarketplaceCurrency);
this.$dropdownPrompt=this.getDOMElement("creditCardListItemInstallmentOptionDropdownPrompt-INSTALLMENT")[0];this.$installmentOptionSelectionHiddenInput=this._getCreditCardInstallmentSelectionHiddenInput(this.currentInstrumentId);this.isInstallmentsCarouselView?(this.$carouselInstallmentOptionSelectionHiddenInput=this._getCreditCardInstallmentCarouselHiddenInput(this.currentInstrumentId),this._initializeCarouselInstallmentOptionSelectionHiddenInputValue(),this._initializeInstallmentCarouselFaster()):
this.isInstallmentsWithFeeInfoPopoverViewEnabled?this._initializeInstallmentsWithFeeInfoPopoverView():(this._initializeSelectedIndex(),this._initializeInstallmentOptionSelectionHiddenInputValue());this._initializeSelectedInstallmentOffer();this._initializeCategorizedInstallmentOffers();this.installmentOfferBOs=b.data.installmentOfferBOs;this.installmentOfferBOsWithAPB=b.data.installmentOfferBOsWithAPB;this.isPaylastEligible=b.data.isPaylastEligible;this.isDynamicOrderSummaryEnabled=b.data.isDynamicOrderSummaryEnabled;
this.showFloatingContinueBarOnNonPaylastPSP=b.data.showFloatingContinueBarOnNonPaylastPSP;this.installmentOptionsAccordionHelper=new k(this);this.mustHideMaxInstallments=""!==this.$installmentOptionSelectionHiddenInput.val();this._hideMaxInstallmentCount(this.currentInstrumentId)},_mobileView:function(){return"mobile"===this.widget.options.deviceType},_isAmazonPayBalanceSelected:function(){return!!this.widget.get("apbCheckboxSelected")},_shouldSuppressInstallments:function(){return this._isAmazonPayBalanceSelected()||
this.isMultiTenderDisabledWithGiftCard&&this.isGiftCardCheckboxSelected||!this._mobileView()&&this.isEligibleForFxInstallments&&this.isMarketplaceCurrencySelected},isInstallmentsEligible:function(){return!this._shouldSuppressInstallments()||this.isAPBWithEMIEnabled},isInstallmentsBalanceEligible:function(){return this.maxAllowedOtherPaymentMethodAmount>=this.selectedJPPoints+this.selectedGCAmount+this.selectedPromoAmount+this.selectedRewardsAmount},_initializeSelectedIndex:function(){this.$dropdownPrompt&&
(this.dropdownSelectedIndex=this.$dropdownPrompt.selectedIndex)},_initializeInstallmentOptionSelectionHiddenInputValue:function(){this._mobileView()&&(this.installmentOptionSelectionHiddenInputValue=this.$installmentOptionSelectionHiddenInput.val(),this.previouslySelectedInstallmentPlanId=this.$installmentOptionSelectionHiddenInput.val())},_initializeCarouselInstallmentOptionSelectionHiddenInputValue:function(){this._mobileView()?(this.installmentOptionSelectionHiddenInputValue=this.$carouselInstallmentOptionSelectionHiddenInput.val(),
this.previouslySelectedInstallmentPlanId=this.$carouselInstallmentOptionSelectionHiddenInput.val()):this.previouslySelectedInstallmentPlanId=this.installmentOptionSelectionHiddenInputValue=this.$carouselInstallmentOptionSelectionHiddenInput.value},_initializeInstallmentCarouselFaster:function(){g.when("a-carousel-framework").execute("init-faster",function(a){a.createAll();a.initializeAll()})},_initializeInstallmentsWithFeeInfoPopoverView:function(){var a=this;a.installmentOptionSelectionHiddenInputValue=
a.$installmentOptionSelectionHiddenInput.val();a.previouslySelectedInstallmentPlanId=a.$installmentOptionSelectionHiddenInput.val();g.when("A","ready").execute(function(b){b.on("a:accordion:creditCardListItemInstallmentPopoverAccordion-"+a.currentInstrumentId+":select",a._installmentsWithFeeInfoPopoverAccordionRowSelectedHandler(a));b.on("a:popover:hide:creditCardInstallmentsPopover-"+a.currentInstrumentId,a._installmentsWithFeeInfoPopoverHideHandler(a))})},_syncMaxInstallmentsText:function(a){var b=
this.getDOMElement("creditCardListItemInstallmentPopoverAccordionRow-"+a).data("maxinstallmentsdisplay");this.getDOMElement("creditCardListItemMaxInstallmentsText-"+a).find("span").text(b)},_hasMonthlyFee:function(a){return a?0!==Number(a.replace(/[^0-9]/g,"")):!1},_installmentsWithFeeInfoPopoverAccordionRowSelectedHandler:function(c){return function(b){a.toggleElement(c.getDOMElement("creditCardInstallmentPopoverAccordionFeeDisclaimerLine-"+c.currentInstrumentId),""!==c.getDOMElement(b.selectedRow.rowName).data("totalfeedisplay"));
a.toggleElement(c.getDOMElement("creditCardInstallmentPopoverAccordionFeeDisclaimerLine-"+c.currentInstrumentId),c._hasMonthlyFee(c.getDOMElement(b.selectedRow.rowName).data("totalfeedisplay")));c.mustHideMaxInstallments=""===c.getDOMElement(b.selectedRow.rowName).data("maxinstallmentsdisplay");c._syncMaxInstallmentsText(c.currentInstrumentId);var d=c.getDOMElement(b.selectedRow.rowName);b=c.getDOMElement(b.selectedRow.accordionName);b.data("selectedfinancialofferid",d.data("financialofferid"));b.data("selectiondisplay",
d.data("selectiondisplay"));b.data("summarydisplay",d.data("summarydisplay"));b.data("selectiondetaildisplay",d.data("selectiondetaildisplay"));b.data("currencyselection",d.data("currencyselection"))}},_installmentsWithFeeInfoPopoverHideHandler:function(a){return function(){var b=a.getDOMElement("creditCardListItemInstallmentPopoverAccordion-"+a.currentInstrumentId),c=b.data("previouslyselectedfinancialofferid");b.data("selectedfinancialofferid")!==c&&(b.data("selectedfinancialofferid",c),a.getDOMElement("creditCardListItemInstallmentPopoverAccordionRow-"+
a.currentInstrumentId+c).find("a").click())}},_initializeSelectedInstallmentOffer:function(a){var b=this;b.isInstallmentsCarouselView?this._toggleCarouselInstallmentOptionsDisplay(a,"creditCardListItemInstallmentCarousel-",this.currentInstrumentId):b.isInstallmentsWithFeeInfoPopoverViewEnabled?b._toggleInstallmentPopoverButtonDisplay(a,this.currentInstrumentId):b.isSingleInstallmentRow?b._toggleInstallmentDropdownDisplay(a,"INSTALLMENT"):b.getDOMElementsByPrefix("creditCardInstallmentOfferRadioButton-").find("input").get().forEach(function(a,
c){c=b._getCategorizedInstallmentOffersByIndex(c)[0];a.checked&&(b.selectedInstallmentOfferCategory=c);b._toggleInstallmentDropdownDisplay(a.checked&&1<b._getNumInstallmentOptionsInCategory(c),c)})},_initializeSelectedInstrument:function(a){var b=a.instrumentId===this.currentInstrumentId;this._initializeSelectedInstallmentOffer(b);this._mobileView()&&!this.isInstallmentsCarouselView&&this._toggleInstallmentMobileTouchLinkDisplay(b,a.instrumentId)},_initializeCategorizedInstallmentOffers:function(){var a=
this;this.installmentOffers.forEach(function(b){a.categorizedInstallmentOffers[b[0]]=b[1]})},_toggleInstallmentDisplay:function(a,b){b===this.currentInstrumentId&&(this.isInstallmentsCarouselView?this._toggleCarouselInstallmentOptionsDisplay(a,"creditCardListItemInstallmentCarousel-",b):this.isInstallmentsWithFeeInfoPopoverViewEnabled?(this._toggleInstallmentPopoverButtonDisplay(a,b),this._toggleInstallmentSelectionDetailDisplay(a,"INSTALLMENT")):this.isSingleInstallmentRow&&(this._mobileView()?this._toggleInstallmentMobileTouchLinkDisplay(a,
b):this._toggleInstallmentDropdownDisplay(a,"INSTALLMENT"),this._toggleInstallmentSelectionDetailDisplay(a,"INSTALLMENT")))},_toggleInstallmentDropdownDisplay:function(c,b){this._isAmazonPayBalanceSelected()?this.isAPBWithEMIEnabled&&c&&0===this.installmentOfferBOsWithAPB.length&&(c=!1):this.isAPBWithEMIEnabled&&c&&0===this.installmentOfferBOs.length&&(c=!1);a.toggleElement(this.getDOMElement("creditCardListItemInstallmentOptionDropdownSelection-"+b),c&&this.isInstallmentsEligible())},_toggleInstallmentPopoverButtonDisplay:function(c,
b){this._isAmazonPayBalanceSelected()?this.isAPBWithEMIEnabled&&c&&0===this.installmentOfferBOsWithAPB.length&&(c=!1):this.isAPBWithEMIEnabled&&c&&0===this.installmentOfferBOs.length&&(c=!1);a.toggleElement(this.getDOMElement("creditCardListItemInstallmentsPopoverButton-"+b),c&&this.isInstallmentsEligible())},_toggleInstallmentOptionsDisplay:function(c,b,d){c=this._showInstallmentOptions(c);a.toggleElement(this.getDOMElement(b+d),c&&this.isInstallmentsEligible());c&&this._initializeInstallmentCarouselFaster()},
_toggleInstallmentOptionsMobileDisplay:function(c,b,d){c=this._showInstallmentOptions(c);a.toggleElement(this.getDOMElement(b+d).add(this.getDOMElement(b)),c&&this.isInstallmentsEligible());c&&this._initializeInstallmentCarouselFaster()},_showInstallmentOptions:function(a){return this._isAmazonPayBalanceSelected()&&this.isAPBWithEMIEnabled&&a&&0===this.installmentOfferBOsWithAPB.length||!this._isAmazonPayBalanceSelected()&&this.isAPBWithEMIEnabled&&a&&0===this.installmentOfferBOs.length?!1:a},_toggleCarouselInstallmentOptionsDisplay:function(a,
b,c){this._mobileView()?this._toggleInstallmentOptionsMobileDisplay(a,b,c):this._toggleInstallmentOptionsDisplay(a,b,c)},_toggleInstallmentMobileTouchLinkDisplay:function(c,b){this._isAmazonPayBalanceSelected()?this.isAPBWithEMIEnabled&&c&&0===this.installmentOfferBOsWithAPB.length&&(c=!1):this.isAPBWithEMIEnabled&&c&&0===this.installmentOfferBOs.length&&(c=!1);a.toggleElement(this.getDOMElement("creditCardListItemInstallmentsMobileTouchLink-"+b).add(this.getDOMElement("creditCardListItemInstallmentsMobileTouchLink-")),
c&&this.isInstallmentsEligible())},_toggleInstallmentSelectionDetailDisplay:function(c,b){a.toggleElement(this.getDOMElement("creditCardListItemInstallmentOptionSelectionDetailText-"+b),this.isInstallmentsEligible()&&c)},_toggleInstallmentsBalanceEligibility:function(c){a.toggleElement(this.getDOMElement("creditCardInstallmentErrorExceededOtherBalance"),!c);a.toggleElement(this.getDOMElement("creditCardInstallmentInfoMessage"),c);this._triggerInstallmentsEligibilityChangedEvent(c);this.isInstallmentsCarouselView?
this._toggleCarouselInstallmentOptionsDisplay(c,"creditCardListItemInstallmentCarousel-",this.currentInstrumentId):this._mobileView()?this._toggleInstallmentMobileTouchLinkDisplay(c,this.currentInstrumentId):this.isInstallmentsWithFeeInfoPopoverViewEnabled?this._toggleInstallmentPopoverButtonDisplay(c,this.currentInstrumentId):(this.getDOMElementsByPrefix("creditCardInstallmentOfferRadioButton-").find("input").get().forEach(function(a,d){c?(a.disabled=!1,a.nextSibling.nextSibling.classList.remove("a-color-tertiary")):
0<d?(a.disabled=!0,a.nextSibling.nextSibling.classList.add("a-color-tertiary")):a.checked=!0}),c||this._installmentOfferRowSelected(h(this.getDOMElementsByPrefix("creditCardInstallmentOfferRadioButton-")[0])))},_triggerInstallmentOfferRowSelectedEvent:function(a){this.widget.trigger(c,{installmentOfferCategory:a,instrumentId:this.currentInstrumentId})},_triggerInstallmentOptionChangedEvent:function(a,b){this.widget.trigger("installmentOptionChanged",{summaryDisplay:a,isInstallmentOfferSelected:b,
instrumentId:this.currentInstrumentId})},_triggerInstallmentsEligibilityChangedEvent:function(a){this.widget.trigger("installmentsEligibilityChanged",{isEligible:a})},_triggerResetSelectedPaymentMethodEvent:function(){var a=!0;this._isAmazonPayBalanceSelected()?0===this.installmentOfferBOsWithAPB.length&&(a=!1):0===this.installmentOfferBOs.length&&(a=!1);this.widget.trigger("resetSelectedPaymentMethod",{isInstallmentPlansAvailable:a})},_selectionDetailDisplayContentChanged:function(a){this.getDOMElement("creditCardListItemInstallmentOptionSelectionDetailText-INSTALLMENT").html(a)},
_getSelectedInstallmentOptionSummaryDisplay:function(a){var b;this.isInstallmentsCarouselView?(b=this._getCreditCardCarouselInstallmentSelectedOfferId(a),b=this.getDOMElement("creditCardInstallmentOfferOptionCarouselRadioButton-"+b).data("summarydisplay")):this.isInstallmentsWithFeeInfoPopoverViewEnabled?b=this.getDOMElement("creditCardListItemInstallmentsPopoverButton-"+a).find("input").data("summarydisplay"):this._mobileView()?b=this._getCreditCardInstallmentMobileTouchLink(a).find("input").data("summarydisplay"):
(a=this.getDOMElement("creditCardListItemInstallmentOptionDropdownSelection-INSTALLMENT"))&&this.$dropdownPrompt&&0<=this.$dropdownPrompt.selectedIndex&&(b=a.data(this.$dropdownPrompt.options[this.$dropdownPrompt.selectedIndex].value));return b},_getSelectedInstallmentOptionSelectionDetailDisplay:function(a){var b;this._mobileView()?b=this._getCreditCardInstallmentMobileTouchLink(a).find("input").data("selectiondetaildisplay"):(a=this.getDOMElement("creditCardListItemInstallmentOptionDropdownSelection-INSTALLMENT"))&&
this.$dropdownPrompt&&0<=this.$dropdownPrompt.selectedIndex&&(b=a.data(this.$dropdownPrompt.options[this.$dropdownPrompt.selectedIndex].value+"selectiondetaildisplay"));return b},_installmentOfferRowSelected:function(a){(a=a.data("installment-offer-category"))&&this.selectedInstallmentOfferCategory!==a&&this._triggerInstallmentOfferRowSelectedEvent(a)},_getCategorizedInstallmentOffersByIndex:function(a){if(0<=a&&a<this.installmentOffers.length)return this.installmentOffers[a]},_getNumInstallmentOptionsInCategory:function(a){return this.categorizedInstallmentOffers[a]?
this.categorizedInstallmentOffers[a].length:0},closeCreditCardInstallmentsSecondaryPopover:function(a){g.when("a-secondary-view").execute(function(b){b&&(b=b.get("creditCardInstallmentsSecondaryPopover-"+a))&&b.hide()})},creditCardInstallmentsPopoverContinueButtonClick:function(a){a=this.currentInstrumentId;this._updateTouchLinkContent(a);this.closeCreditCardInstallmentsSecondaryPopover(a)},_creditCardInstallmentPopoverAccordionButtonClickHandler:function(c){c=this.getDOMElement("creditCardListItemInstallmentPopoverAccordionRow-"+
this.currentInstrumentId+this.installmentOptionSelectionHiddenInputValue).data("totalfeedisplay");a.toggleElement(this.getDOMElement("creditCardInstallmentPopoverAccordionFeeDisclaimerLine-"+this.currentInstrumentId),this._hasMonthlyFee(c))},_creditCardInstallmentPopoverAccordionContinueButtonClickHandler:function(a){function b(a){a&&(a=a.get("creditCardInstallmentsPopover-"+d))&&a.hide()}var c=this,d=this.currentInstrumentId;a=this.getDOMElement("creditCardListItemInstallmentPopoverAccordion-"+d);
this._refreshCreditCardInstallmentPopoverButtonText(a,d);var f=a.data("previouslyselectedfinancialofferid");this._getCreditCardInstallmentSelectionHiddenInput(d).val(f);this.installmentOptionSelectionHiddenInputValue=f;var k=a.data("summarydisplay");this.getDOMElement("creditCardListItemInstallmentsPopoverButton-"+d).find("input").data("summarydisplay",k);this._triggerInstallmentOptionChangedEvent(k,f&&0<f.length);f=a.data("selectiondetaildisplay");this.getDOMElement("creditCardListItemInstallmentsPopoverButton-"+
d).find("input").data("selectiondetaildisplay",f);this._selectionDetailDisplayContentChanged(f);!0===this.isEligibleForFxInstallments&&(a=a.data("currencyselection"),this._updateCreditCardSelectionCurrency(a));g.when("a-modal").execute(function(a){if(a)b(a);else{a=c._mobileView();var e=h('div[id^\x3d"a-popover-"]');e&&!a&&e.hide();a=c._mobileView();(e=h('iframe[id^\x3d"a-popover-"]'))&&!a&&e.hide()}});g.when("a-secondary-view").execute(function(a){b(a)})},_hideMaxInstallmentCount:function(c){(c=this.getDOMElement("creditCardListItemMaxInstallmentsText-"+
c))&&this.isInstallmentsWithFeeInfoPopoverViewEnabled&&(this.mustHideMaxInstallments?a.hideElement(c):a.showElement(c))},_refreshCreditCardInstallmentPopoverButtonText:function(a,b){var c=this.getDOMElement("creditCardListItemInstallmentsPopoverButtonText-"+b);a.data("previouslyselectedfinancialofferid",a.data("selectedfinancialofferid"));var d=a.data("selectiondisplay");c.text(d);this._hideMaxInstallmentCount(b);return a},_updateTouchLinkContent:function(a){var b=this._getCreditCardInstallmentMobileTouchLink(a);
b.find("input").remove();var c=this._getCreditCardInstallmentMobilePopover(a),c=this._extractInputs(c);this._appendHiddenInput(c,b);if(a=this._getSelectedFinancialOfferId(c,a))a=this.selectedInstallmentOfferCategory===this.installmentsOneTimePaymentOfferCategoryName?this.installmentsAvailableString:this.touchLinkDisplayStrings[a],b.find("span").text(a)},_appendHiddenInput:function(a,b){m.forEachKeyValue(a,function(a,c){h('\x3cinput type\x3d"hidden"\x3e').attr({name:a,value:c}).appendTo(b)})},_getSelectedFinancialOfferId:function(a,
b){return a["ppw-"+b+"_installmentsSelection_dropdown_"+a["ppw-"+b+"_installmentCategory"]]},creditCardInstallmentsOptionClick:function(a){var b=this.currentInstrumentId;a=h(a.currentTarget);if(b===a.data("instrumentid").toString()){var c=a.data("summarydisplay"),d=this.isInstallmentOfferSelected(this);if(this.isAccordionViewForMobileEnabled)this.getDOMElement("installmentOfferMobileDropdownMonthlyBreakdown").html(c),this.getDOMElement("installmentOfferMobileDropdownTotalCost").html(a.data("installmentoptiontotalamountdisplay"));
else{this.getDOMElementsByPrefix("creditCardListItemInstallmentOption-").removeClass("a-active");a.addClass("a-active");var g=this._getPrimaryViewButtonDisplay(b),f=a.find(".a-section").html();g.html(f)}g=this._getCreditCardInstallmentSelectionHiddenInput(b);g.val(a.data("financialofferid"));this.installmentOptionSelectionHiddenInputValue=g.val();this._getCreditCardInstallmentMobileTouchLink(b).find("input").data("summarydisplay",c);this._triggerInstallmentOptionChangedEvent(c,d);c=a.data("selectiondetaildisplay");
this._getCreditCardInstallmentMobileTouchLink(b).find("input").data("selectiondetaildisplay",c);this._selectionDetailDisplayContentChanged(c);!0===this.isEligibleForFxInstallments&&(b=a.data("currencyselection"),this._updateCreditCardSelectionCurrency(b))}},creditCardCarouselInstallmentsOptionEventHandler:function(a){var b=this.currentInstrumentId,c=h(a.currentTarget);if(b===c.data("instrumentid").toString()&&this.isInstallmentsCarouselView){var d=this._getCreditCardCarouselInstallmentSelectedOfferId(b);
this._toggleCarouselCardSelection(this.getDOMElement("creditCardInstallmentOfferOptionCarouselRadioButton-"+d),!1);this._toggleCarouselCardSelection(c,!0);d=c.data("financialofferid");this._setCreditCardCarouselInstallmentSelectedOfferId(b,d);this.installmentOptionSelectionHiddenInputValue=this._getCreditCardCarouselInstallmentSelectedOfferId(b);b=c.data("summarydisplay");this._triggerInstallmentOptionChangedEvent(b,a.target.checked);a=c.data("selectiondetaildisplay");this._selectionDetailDisplayContentChanged(a);
!0===this.isEligibleForFxInstallments&&(c=c.data("currencyselection"),this._updateCreditCardSelectionCurrency(c))}},_toggleCarouselCardSelection:function(a,b){b?a.removeClass("installments-carousel-not-selected-card").addClass("installments-carousel-selected-card"):a.removeClass("installments-carousel-selected-card").addClass("installments-carousel-not-selected-card")},_getCreditCardInstallmentCarouselHiddenInput:function(a){return this._mobileView()?this.getDOMElement("creditCardListItemInstallmentsCarouselSelectionHiddenInput-"+
a).add(this.getDOMElement("creditCardListItemInstallmentsCarouselSelectionHiddenInput-")):this.getDOMElement("creditCardListItemInstallmentsCarouselSelectionHiddenInput-"+a)[0]},_getCreditCardCarouselInstallmentSelectedOfferId:function(a){return(a=this._getCreditCardInstallmentCarouselHiddenInput(a))?this._mobileView()?a.val():a.value:""},_getCreditCardInstallmentSelectedOfferId:function(a){return(a=this._getCreditCardInstallmentSelectionHiddenInput(a))?a.val():""},_setCreditCardCarouselInstallmentSelectedOfferId:function(a,
b){if(a=this._getCreditCardInstallmentCarouselHiddenInput(a))this._mobileView()?a.val(b):a.value=b},_extractInputs:function(a){var b={},c=this;a.find("input").each(function(a,e){e&&e.type&&e.name&&e.value&&"radio"===e.type&&e.checked&&(b[e.name]=e.value,c.getDOMElement("creditCardListItemInstallmentOptionDropdown-"+e.value).first().find("select").each(function(a,c){c&&c.name&&c.options&&0<=c.selectedIndex&&0<=c.selectedIndex&&c.selectedIndex<c.options.length&&(b[c.name]=c.options[c.selectedIndex].value)}))});
return b},_getPrimaryViewButtonDisplay:function(a){return this.getDOMElement("creditCardListItemInstallmentOfferButtonText-"+a).add(this.getDOMElement("creditCardListItemInstallmentOfferButtonText-"))},_getCreditCardInstallmentMobileTouchLink:function(a){return this.getDOMElement("creditCardListItemInstallmentsMobileTouchLink-"+a).add(this.getDOMElement("creditCardListItemInstallmentsMobileTouchLink-"))},_getCreditCardInstallmentMobilePopover:function(a){return this.getDOMElement("creditCardListItemInstallmentsMobilePopover-"+
a).add(this.getDOMElement("creditCardListItemInstallmentsMobilePopover-"))},_getCreditCardInstallmentMobileHiddenInput:function(a){return this._getCreditCardInstallmentSelectionHiddenInput(a)},_getCreditCardInstallmentSelectionHiddenInput:function(a){return this.getDOMElement("creditCardListItemInstallmentsSelectionHiddenInput-"+a).add(this.getDOMElement("creditCardListItemInstallmentsSelectionHiddenInput-"))},_getCreditCardInstallmentMobileHiddenTfxSelectionInput:function(a){return this.getDOMElement("creditCardListItemInstallmentsCurrencySelectionHiddenInput-"+
a).add(this.getDOMElement("creditCardListItemInstallmentsCurrencySelectionHiddenInput-"))},_updateCreditCardSelectionCurrency:function(a){this._getCreditCardInstallmentMobileHiddenTfxSelectionInput(this.currentInstrumentId).val(a)},_getCreditCardInstallmentDownPaymentValueHiddenInput:function(a){return this.getDOMElement("creditCardListItemDownPaymentValueSelectionHiddenInput-"+a).add(this.getDOMElement("creditCardListItemDownPaymentValueSelectionHiddenInput-"))},_getCreditCardInstallmentDownPaymentCurrencyHiddenInput:function(a){return this.getDOMElement("creditCardListItemDownPaymentCurrencySelectionHiddenInput-"+
a).add(this.getDOMElement("creditCardListItemDownPaymentCurrencySelectionHiddenInput-"))},displaySelectedInstallmentOfferDropdown:function(){var a=this;a.data.installmentOffers.forEach(function(b){b=b[0];a._toggleInstallmentDropdownDisplay(b===a.selectedInstallmentOfferCategory&&1<a._getNumInstallmentOptionsInCategory(b),b)})},getInstallmentOfferDisplayString:function(a){return a[1][0].selectionDisplayStrings[0]},getInstallmentOfferId:function(a){return a[1][0].financialOfferId},bindToElements:function(){var a=
this;this.getDOMElementsByPrefix("creditCardInstallmentOfferRadioButton-").change(function(b){b.target.checked&&a._installmentOfferRowSelected(h(b.currentTarget))});this.getDOMElementsByPrefix("creditCardListItemInstallmentsMobileTouchLink-").click(function(b){a.widget.publishSuccessSushiMetrics({ActionValueType:"Click",ActionValue:"CardInstallmentSelectionButton"})});this.getDOMElementsByPrefix("installmentOptionsMobileAccordionRow-").change(function(b){b.target.selected&&a._installmentOfferRowSelected(h(b.currentTarget))});
this._mobileView()&&(this.getDOMElement("creditCardListItemInstallmentsPrimaryContinueButton").click(m.bind(this.creditCardInstallmentsPopoverContinueButtonClick,this)),this.getDOMElement("creditCardListItemInstallmentsSecondaryContinueButton").click(m.bind(this.creditCardInstallmentsPopoverContinueButtonClick,this)),this.getDOMElementsByPrefix("installmentOptionsMobileAccordionRowContinueButton").click(m.bind(this.creditCardInstallmentsPopoverContinueButtonClick,this)),this.getDOMElementsByPrefix("creditCardListItemInstallmentOption-").click(m.bind(this.creditCardInstallmentsOptionClick,
this)),this.getDOMElementsByPrefix("installmentOptionsMobileAccordionRow-").click(m.bind(this.creditCardInstallmentsOptionClick,this)),this.getDOMElementsByPrefix("creditCardInstallmentOfferOptionCarouselRadioButton-").click(m.bind(this.creditCardCarouselInstallmentsOptionEventHandler,this)));if(this.isInstallmentsWithFeeInfoPopoverViewEnabled){this.getDOMElementsByPrefix("creditCardListItemInstallmentsPopoverButton-").click(m.bind(this._creditCardInstallmentPopoverAccordionButtonClickHandler,this));
this.getDOMElementsByPrefix("creditCardInstallmentPopoverAccordionContinueButton-").click(m.bind(this._creditCardInstallmentPopoverAccordionContinueButtonClickHandler,this));for(var b=document.querySelectorAll('input[name^\x3d"creditCardInstallmentPopoverAccordionContinueButton-"]'),c=0;c<b.length;c++)b[c].addEventListener("click",function(b){a._creditCardInstallmentPopoverAccordionContinueButtonClickHandler(b)})}this.getDOMElementsByPrefix("creditCardInstallmentOfferOptionCarouselRadioButton-").change(m.bind(this.creditCardCarouselInstallmentsOptionEventHandler,
this));this.getDOMElement("creditCardListItemInstallmentOptionDropdownPrompt-INSTALLMENT").change(function(){a._initializeSelectedIndex();var b=a._getSelectedInstallmentOptionSummaryDisplay();a._triggerInstallmentOptionChangedEvent(b,0<a.dropdownSelectedIndex);b=a._getSelectedInstallmentOptionSelectionDetailDisplay();a._selectionDetailDisplayContentChanged(b)})},bindToEvents:function(){var a=this;a.widget.on(c,a,function(b){b.instrumentId===a.currentInstrumentId&&(a.selectedInstallmentOfferCategory=
b.installmentOfferCategory,a.displaySelectedInstallmentOfferDropdown())});(this._mobileView()||this.isAccordionViewForDesktopEnabled)&&this.installmentOptionsAccordionHelper.bindToEvents();a.widget.on("toggleInstallmentDropDown",a,function(b){a._toggleInstallmentDisplay(!b.isAPBSelected||this.isAPBWithEMIEnabled,b.instrumentId)});a.widget.on("apbSelectionChanged",a,function(b){this.widget.trigger("updateIBDonAPBSelectionEvent",{fosId:a.isInstallmentsCarouselView?a.$carouselInstallmentOptionSelectionHiddenInput.val():
a.$installmentOptionSelectionHiddenInput.val(),instrumentId:a.currentInstrumentId})});a.widget.on("optionalInstrumentSelected",a,function(b){a.isMultiTenderDisabledWithGiftCard&&"GC"===b.paymentMethod&&(a.isGiftCardCheckboxSelected=!0,a.isInstallmentsCarouselView?a._setCreditCardCarouselInstallmentSelectedOfferId(a.currentInstrumentId,""):a._mobileView()?a.$installmentOptionSelectionHiddenInput.val(""):a.$dropdownPrompt.selectedIndex=-1,a._toggleInstallmentDisplay(!1,a.currentInstrumentId),this.widget.trigger("installmentsAvailabilityChanged",
{isInstallmentsAvailable:!1}))});a.widget.on("optionalInstrumentDeselected",a,function(b){a.isMultiTenderDisabledWithGiftCard&&"GC"===b.paymentMethod&&(a.isGiftCardCheckboxSelected=!1,a.isInstallmentsEligible()&&(a.isInstallmentsCarouselView?(a._initializeInstallmentCarouselFaster(),a._setCreditCardCarouselInstallmentSelectedOfferId(a.currentInstrumentId,a.installmentOptionSelectionHiddenInputValue)):a._mobileView()?a.$installmentOptionSelectionHiddenInput.val(a.installmentOptionSelectionHiddenInputValue):
a.$dropdownPrompt.selectedIndex=this.dropdownSelectedIndex,a._toggleInstallmentDisplay(!0,a.currentInstrumentId),this.widget.trigger("installmentsAvailabilityChanged",{isInstallmentsAvailable:!0})))});a.widget.on("tfxPreferredCurrencySelected",a,function(b){b.instrumentId===a.currentInstrumentId&&!0===a.isEligibleForFxInstallments&&(a.isMarketplaceCurrencySelected=!1,a.isInstallmentsEligible()&&(a.$dropdownPrompt.selectedIndex=this.dropdownSelectedIndex,a._toggleInstallmentDisplay(!0,a.currentInstrumentId)))});
a.widget.on("tfxSelectCurrencySelected",a,function(b){b.instrumentId===a.currentInstrumentId&&!0===a.isEligibleForFxInstallments&&(a.isMarketplaceCurrencySelected=!0,a.$dropdownPrompt.selectedIndex=-1,a._toggleInstallmentDisplay(!1,a.currentInstrumentId))});this.widget.on("installmentOptionsAccordionChanged",this,function(b){if(b.instrumentId===this.currentInstrumentId){this._getCreditCardInstallmentSelectionHiddenInput(b.instrumentId).val(b.financialofferid);var c=a.isInstallmentOfferSelected(a);
this._triggerInstallmentOptionChangedEvent(b.summaryDisplay,c)}});this.widget.on("updatePrimaryButtonDisplayString",this,function(a){if(this.currentInstrumentId===a.instrumentId){var c=this._getPrimaryViewButtonDisplay(this.currentInstrumentId),d=this._getCreditCardInstallmentSelectionHiddenInput(a.instrumentId);this.previouslySelectedInstallmentPlanId=d[0].value;""===a.displayString&&(this._isAmazonPayBalanceSelected()&&0<this.installmentOffersWithAPB.length?(a.displayString=this.getInstallmentOfferDisplayString(this.installmentOffersWithAPB[0]),
a.installmentPlanId=this.getInstallmentOfferId(this.installmentOffersWithAPB[0])):!this._isAmazonPayBalanceSelected()&&0<this.installmentOffers.length&&(a.displayString=this.getInstallmentOfferDisplayString(this.installmentOffers[0]),a.installmentPlanId=this.getInstallmentOfferId(this.installmentOffers[0])));c.html(a.displayString);d.val(a.installmentPlanId);this.isDownPaymentWithAPBSelectionFixEnabled&&a.downPaymentAmount!==r&&""!==a.downPaymentAmount&&(c=this._getCreditCardInstallmentDownPaymentValueHiddenInput(a.instrumentId),
d=this._getCreditCardInstallmentDownPaymentCurrencyHiddenInput(a.instrumentId),a=JSON.parse(a.downPaymentAmount),c.val(a.amount),d.val(a.currency))}});a.widget.on("apbSelectionChangedForAPBWithEMIFeature",a,function(a){a.selectedInstrumentId===this.currentInstrumentId&&""!==this.previouslySelectedInstallmentPlanId&&this._triggerResetSelectedPaymentMethodEvent()});if(a.useInstallmentsBalanceEligibility)a.widget.on("balanceSelectionChanged",a,function(b){"JPPoints"===b.paymentMethod?a.selectedJPPoints=
b.isSelected&&!b.isBackingInstrument?parseFloat(b.balance):0:"GC"===b.paymentMethod?a.selectedGCAmount=b.isSelected&&!b.isBackingInstrument?parseFloat(b.balance):0:"PROMO"===b.paymentMethod?a.selectedPromoAmount=b.isSelected&&!b.isBackingInstrument?parseFloat(b.balance):0:"RewardsAccount"===b.paymentMethod&&(a.selectedRewardsAmount=b.isSelected&&!b.isBackingInstrument?parseFloat(b.balance):0);a._toggleInstallmentsBalanceEligibility(a.isInstallmentsBalanceEligible())});a.widget.on(d,a,function(b){var c=
b.instrumentId===this.currentInstrumentId;a._initializeSelectedInstallmentOffer(c);this._mobileView()&&!a.isInstallmentsCarouselView&&this._toggleInstallmentMobileTouchLinkDisplay(c&&this.isInstallmentsBalanceEligible(),b.instrumentId);c&&(c=a.isInstallmentOfferSelected(a),b=this._getSelectedInstallmentOptionSummaryDisplay(b.instrumentId),this._triggerInstallmentOptionChangedEvent(b,c))});a.widget.on("initializeRecommendedInstrument",a,m.bind(this._initializeSelectedInstrument,this));g.when("A","a-popover",
"ready").execute(function(a,c){var d=a.$;d(document).delegate(".a-popover-wrapper","keydown",function(a){d("li.selected-card-installment-suppressed-dropdown-option").unbind("keydown").keydown(function(a){if(13===a.keyCode)return a.preventDefault(),!1})})})},isInstallmentOfferSelected:function(a){a=a.isInstallmentsCarouselView?(a=a._getCreditCardCarouselInstallmentSelectedOfferId(a.currentInstrumentId))&&0<a.length:a.isInstallmentsWithFeeInfoPopoverViewEnabled?(a=a._getCreditCardInstallmentSelectedOfferId(a.currentInstrumentId))&&
0<a.length:0<a.dropdownSelectedIndex;return a}})});l("components/SelectableCreditCardListComponent","events/InstrumentRowSelectedEvent events/CreateSecureFieldEvent events/RemoveSecureFieldEvent css-utils component lang clog jQuery continuable mixins/b2b-cross-wallet-mixin".split(" "),function(c,d,f,h,g,a,m,k,e,b){var n,q=["GC","JPPoints","ProductVoucher","PROMO"],l={pmts_portal_payselect_cc_address_challenge_error_no_match:"-noMatch",pmts_portal_payselect_cc_address_challenge_error_security_code_invalid:"-securityCodeInvalid",
pmts_portal_payselect_cc_address_challenge_error_unknown:"-unknown",pmts_portal_payselect_selectedPaymentMethodExpired:"-expirationDateInvalid"};return g.extend(e,b,{selectedInstrumentId:null,initialSelectedFixupInstrumentId:null,showAuthorizationFailureAlert:!1,isAPBWithEMIEnabled:!1,shouldDecoupleCardsFromSavedCardsSection:!1,scrollAfterAddCardEvent:!1,cardInstrumentId:"",initialize:function(a,b){this.isAPBWithEMIEnabled=b.data.isAPBWithEMIEnabled;this.showAuthorizationFailureAlert=b.data.showAuthorizationFailureAlert;
this.initialSelectedFixupInstrumentId=b.data.initialSelectedFixupInstrumentId;this.isABCrossCustomerMultiTenderSuppressionEnabled=b.data.isABCrossCustomerMultiTenderSuppressionEnabled;this.shouldDecoupleCardsFromSavedCardsSection=b.data.shouldDecoupleCardsFromSavedCardsSection;this.isPaySelectCvvSecureFieldEnabled=b.data.isPaySelectCvvSecureFieldEnabled;this.scrollAfterAddCardEvent=b.data.scrollAfterAddCardEvent;this.cardInstrumentId=b.data.cardInstrumentId;this.scrollAfterAddCardEvent!==r&&!0===
this.scrollAfterAddCardEvent&&this.widget.scrollToElementWithCompensation(this.getDOMElement("creditCardContainer-"+this.cardInstrumentId))},_instrumentRowSelected:function(a,b){this._deselectingInstrument(b);this._removeSecureFieldFrame(b);this.getDOMElement("instrumentRowSelection-"+a).prop("checked",!0);b=this._getCreditCardRow(a);this.showAuthorizationFailureAlert&&this.initialSelectedFixupInstrumentId===a?b.addClass("pmts-fixup-selected"):b.addClass("pmts-selected");this._triggerCreditCardRowSelectedEvent(a);
this._createSecureFieldFrame(a)},_deselectingInstrument:function(a){this.getDOMElement("instrumentRowSelection-"+a).prop("checked",!1);a=this._getCreditCardRow(a);a.removeClass("pmts-selected");this.showAuthorizationFailureAlert&&a.removeClass("pmts-fixup-selected");h.hideElement(this.getDOMElementsByPrefix("addressChallengeMessages-"));h.hideElement(this.getDOMElementsByPrefix("addressChallengeMobileConfirmButtons-"));h.hideElement(this.getDOMElementsByPrefix("addressChallengeScan-"));h.hideElement(this.getDOMElementsByPrefix("creditCardInstallmentActivationExpander-"));
h.hideElement(this.getDOMElementsByPrefix("creditCardInstallmentActivationRetryExceededAlert-"));h.hideElement(this.getDOMElementsByPrefix("inactiveMbccMessages-"))},_creditCardRowClicked:function(a){var b=k(a.currentTarget);a=b.data("instrument-id");var c=b.data("co-brand"),d=b.data("disabled"),e=b.data("is-owned"),b=b.data("is-recurring-charge");"AmazonVisaSignature"===c&&m.logCounterMetric({feature:"selected-cbcc",resource:"_Count"});"AmazonVisaSignature"===n&&"AmazonVisaSignature"!==c&&m.logCounterMetric({feature:"deselected-cbcc",
resource:"_Count"});n=c;!d&&a&&this.selectedInstrumentId!==a&&this._triggerInstrumentRowSelectedEvent(a,b,e)},_showAddressChallengeErrors:function(b){var c=this;0<b.errorMessages.length&&(a.forEach(b.errorMessages,function(a){h.showElement(c.getDOMElement(c._getJsRefForErrorMessage(b.instrumentId,a)))}),h.showElement(c.getDOMElement("addressChallengeErrors-"+b.instrumentId)))},_getJsRefForErrorMessage:function(a,b){b=l[b.messageStringId];"undefined"===typeof b&&(b="-unknown");return"addressChallengeError-"+
a+b},_getCreditCardRow:function(a){return this.getDOMElement("creditCardContainer-"+a)},_getAllCreditCardRows:function(){return this.getDOMElementsByPrefix("creditCardContainer-")},_triggerInstrumentRowSelectedEvent:function(a,b,d){this.widget.trigger(c,{instrumentId:a,isRecurringChargePaymentMethod:b,paymentMethod:"CC",isInstrumentOwned:d})},_confirmButtonClicked:function(a){this.widget.trigger("confirmButtonClicked",{instrumentId:this.selectedInstrumentId})},_triggerCreditCardRowSelectedEvent:function(a,
b){var c=this.getDOMElement("instrumentRowSelection-"+a).val();h.showElement(this.getDOMElement("creditCardInstallmentActivationRetryExceededAlert-"+a));this.widget.trigger("creditCardRowSelected",{instrumentId:a,instrumentSelectionValue:c,isInstrumentOwned:b})},isCurrentPaymentMethodOwnedByOrderingCustomer:function(){return!1!==this._getCreditCardRow(this.selectedInstrumentId).data("is-owned")},_deselectCreditCardInstrumentRow:function(){var a=this._getCreditCardRow(this.selectedInstrumentId);a.hasClass("pmts-selected")&&
(this._deselectingInstrument(a.data("instrument-id")),this.selectedInstrumentId="",this.widget.trigger(c,{}),this.widget.trigger("backingInstrumentSelected",{}))},_updateBackingInstrumentState:function(a){var b=this._getCreditCardRow(this.selectedInstrumentId);a=!1!==a.isInstrumentOwned;var c=!1!==b.data("is-owned");b.hasClass("pmts-selected")&&c!==a&&this._deselectCreditCardInstrumentRow()},_createSecureFieldFrame:function(a){this.isPaySelectCvvSecureFieldEnabled&&this.widget.trigger(d,{secureFieldId:"secureFieldsCVV-"+
a})},_removeSecureFieldFrame:function(a){this.isPaySelectCvvSecureFieldEnabled&&this.widget.trigger(f,{secureFieldId:"secureFieldsCVV-"+a})},bindToElements:function(){var b=this;this.shouldDecoupleCardsFromSavedCardsSection||(b.getDOMElementsByPrefix("creditCardContainer-").click(a.bind(this._creditCardRowClicked,this)),b.getDOMElementsByPrefix("addressChallengeMobileConfirmButtons-").click(a.bind(this._confirmButtonClicked,this)),b.getDOMElementsByPrefix("installmentActivationMobileConfirmButtons-").click(a.bind(this._confirmButtonClicked,
this)));b.getDOMElement("CardListLearnMoreLink").click(function(){b.widget.publishSuccessSushiMetrics({ActionValue:"Click",ActionValueType:"LearnMorePopover",ActionParentValue:"LearnMoreOnSavedCards",ActionParentValueType:"LearnMoreLinkPosition"})})},bindToEvents:function(){var b=this;b.widget.on("initializeRecommendedInstrument",b,function(a){if(!this.shouldDecoupleCardsFromSavedCardsSection){b.selectedInstrumentId=a.instrumentId;b.showAuthorizationFailureAlert&&!b.initialSelectedFixupInstrumentId&&
(b.initialSelectedFixupInstrumentId=a.instrumentId);var c=b._getCreditCardRow(a.instrumentId);if(null!==c&&1===c.length&&null!==c[0].attributes){var d="true"===c[0].attributes.getNamedItem("data-is-recurring-charge").value?!0:!1,c=this.isABCrossCustomerMultiTenderSuppressionEnabled&&null!==c[0].attributes.getNamedItem("data-is-owned")&&"false"===c[0].attributes.getNamedItem("data-is-owned").value?!1:!0;b._triggerInstrumentRowSelectedEvent(a.instrumentId,d,c)}}});b.widget.on("showInstallmentActivation",
b,function(a){this.shouldDecoupleCardsFromSavedCardsSection||h.showElement(b.getDOMElement("creditCardInstallmentActivationExpander-"+a.instrumentId))});b.widget.on(c,b,function(a){if(!this.shouldDecoupleCardsFromSavedCardsSection){var c=b.selectedInstrumentId;b.selectedInstrumentId=a.instrumentId;b._instrumentRowSelected(a.instrumentId,c)}});b.widget.on("showAddressChallenge",b,function(a){this.shouldDecoupleCardsFromSavedCardsSection||(h.showElement(b.getDOMElement("addressChallengeMessages-"+a.instrumentId)),
h.showElement(b.getDOMElement("addressChallengeMobileConfirmButtons-"+a.instrumentId)),h.showElement(b.getDOMElement("addressChallengeScan-"+a.instrumentId)))});b.widget.on("addressChallengePassed",b,function(a){this.shouldDecoupleCardsFromSavedCardsSection||(h.hideElement(b.getDOMElement("addressChallengeMessages-"+a.instrumentId)),h.hideElement(b.getDOMElement("addressChallengeMobileConfirmButtons-"+a.instrumentId)),h.hideElement(b.getDOMElement("addressChallengeScan-"+a.instrumentId)))});b.widget.on("showAddressChallengeErrors",
b,function(a){this.shouldDecoupleCardsFromSavedCardsSection||b._showAddressChallengeErrors(a)});b.widget.on("hideAddressChallengeErrors",b,function(a){this.shouldDecoupleCardsFromSavedCardsSection||(h.hideElement(b.getDOMElementsByPrefix("addressChallengeError-"+a.instrumentId)),h.hideElement(b.getDOMElement("addressChallengeErrors-"+a.instrumentId)))});b.widget.on("apbSelectionChanged",b,function(a){if(!this.shouldDecoupleCardsFromSavedCardsSection){var c=b._getCreditCardRow(b.selectedInstrumentId).hasClass("pmts-selected");
b.widget.get("apbCheckboxSelected")!==r&&c&&this.widget.trigger("toggleInstallmentDropDown",{isAPBSelected:a.isSelected,instrumentId:b.selectedInstrumentId});b.isAPBWithEMIEnabled&&this.widget.trigger("apbSelectionChangedForAPBWithEMIFeature",{selectedInstrumentId:b.selectedInstrumentId})}});b.widget.on("resetSelectedPaymentMethod",b,function(a){this.shouldDecoupleCardsFromSavedCardsSection||(this._deselectingInstrument(b.selectedInstrumentId),b.selectedInstrumentId="",this.setContinuable(!1),a=a.isInstallmentPlansAvailable?
b.widget.getLocalizedString("apx_payselect_apb_plus_emi_feature_emi_plan_change_message"):b.widget.getLocalizedString("apx_payselect_apb_plus_emi_feature_deselect_apb_to_view_emi_options_message"),this.widget.trigger("PaymentPlanSelected",{isValid:!1,message:a}),this.widget.trigger("ChangeInAPBSelectionAfterInstallmentPlanSelectionEvent",{message:a}))});b.widget.on("inactiveMbccSelected",b,function(a){this.shouldDecoupleCardsFromSavedCardsSection||h.showElement(b.getDOMElementsByPrefix("inactiveMbccMessages-"+
a.instrumentId))});b.widget.on("balanceSelectionChanged",b,function(c){if(!this.shouldDecoupleCardsFromSavedCardsSection){var d=0<=a.indexOf(q,c.paymentMethod);!0===b._isB2BCrossWalletMultitenderEnforcementEnabled?!0===b.shouldBeDeselectedPerB2BMultitenderRules("balanceSelectionChanged",c)&&b._deselectCreditCardInstrumentRow():this.isABCrossCustomerMultiTenderSuppressionEnabled&&d&&!c.isBackingInstrument&&c.isSelected&&this._updateBackingInstrumentState(c)}})}})});l("components/CreditCardAddressChallengeComponent",
"lang css-utils server jQuery form-component validation-functions keyboard public-event-registry events/PaymentMethodChallengedEvent attributes cc-spacing".split(" "),function(c,d,f,h,g,a,m,k,e,b,n){return g.extend(b,{addressChallenge:!0,installmentActivation:!1,_issuer:"",_creditCardTail:"",_instrumentSelectionValue:"",isStandalone:!1,initialize:function(a,b){k.register(e.eventName);this._issuer=b.data.issuer;this._creditCardTail=b.data.cardNumberTail;this.isStandalone=b.data.isStandalone;this.installmentActivation=
b.data.installmentActivation||this.installmentActivation;this.useNewAddressChallengeFormat=b.data.useNewAddressChallengeFormat||!1;this.form.formModel.registerAdditionalData("issuerFn",this._issuer);this.form.formModel.registerAdditionalData("creditCardTail",this._creditCardTail);b.data.disableConfirmButton&&d.disableElement(this.getDOMElement("addressChallengeConfirmButton"));this.set("ConfirmButtonEnabledAttribute",!b.data.disableConfirmButton);this.watch("ConfirmButtonEnabledAttribute",this,function(a){this.widget.log({confirmButtonEnabled:a});
a?d.enableElement(this.getDOMElement("addressChallengeConfirmButton")):d.disableElement(this.getDOMElement("addressChallengeConfirmButton"))})},bindToElements:function(){var a=this;a.getDOMElement("addressChallengeConfirmButton").click(function(b){b.preventDefault();a.confirmButtonClicked()});a.getDOMElement("addressChallengeCreditCardNumber").keypress(function(b){b.which===m.keys.VK_RETURN&&(b.preventDefault(),a.confirmButtonClicked())});var b,c;a.getDOMElement("addressChallengeCreditCardNumber").keydown(function(a){b=
this.value;c=this.selectionStart});a.getDOMElement("addressChallengeCreditCardNumber").keyup(function(a){"number"!==this.type&&this.value!==b&&(a=this.selectionStart,this.value=n.fixSpacing(this.value),a=n.fixCaret(a,this.value,b,c),this.setSelectionRange(a,a))})},bindToEvents:function(){var a=this;a.widget.on("creditCardRowSelected",a,function(b){var c=!1;if(a.data.instrumentId===b.instrumentId){a._instrumentSelectionValue=b.instrumentSelectionValue;if(a.addressChallenge)a.installmentActivation?
a.widget.trigger("showInstallmentActivation",{instrumentId:b.instrumentId}):a.widget.trigger("showAddressChallenge",{instrumentId:b.instrumentId});else return;c=!0}a.toggleAddressChallengeForm(c)});a.widget.on("confirmButtonClicked",a,function(b){a.data.instrumentId===b.instrumentId&&a.confirmButtonClicked()});a.widget.on("addressChallengePassed",a,function(b){a.data.instrumentId===b.instrumentId&&(a.widget.trigger(e.eventName,e.successStatus),a.addressChallenge=!1,a.toggleAddressChallengeForm(!1),
a.getDOMElement("addressChallengeCreditCardNumber").remove(),a.getDOMElement("addressChallengeCreditCardVerificationNumber").remove())});a.widget.on("addressChallengeCreditCardInfo",a,function(b){b.creditCardNumber&&a.getDOMElement("addressChallengeCreditCardNumber").val(b.creditCardNumber)});a.widget.on("addressChallengeConfirmButtonClicked",a,function(b){a.confirmButtonClicked()});a.widget.on("hideAddressChallengeErrors",a,function(b){a.data.instrumentId===b.instrumentId&&a.form.clearValidationErrors()});
a.widget.on("expirationDateValidated",a,function(b){a.data.instrumentId===b.instrumentId&&a.validateAddressChallengeForm(b.isExpirationDateValid,b.expMonth,b.expYear)})},confirmInstrument:function(a,b){var d=this,e=d.form.getFormValues(),g=d.data.instrumentId,e={"ppw-widgetEvent":d.isStandalone?"ConfirmCreditCardEvent":"ConfirmAndUpdateCreditCardEvent","ppw-instrumentId":g,"ppw-installmentActivation":d.installmentActivation.toString(),"ppw-refreshView":d.installmentActivation.toString(),addCreditCardNumber:e.addCreditCardNumber,
addCreditCardVerificationNumber:e.addCreditCardVerificationNumber,"ppw-instrumentRowSelection":d._instrumentSelectionValue,"ppw-widgetState":d.widget.options.serializedState};d.useNewAddressChallengeFormat||(e["ppw-expirationDate_month"]=a,e["ppw-expirationDate_year"]=b);a={success:c.bind(d.onConfirmCreditCardSuccess,d),error:function(){d._showAddressChallengeErrors(g,[{messageStringId:"pmts_portal_payselect_cc_address_challenge_error_unknown"}])},resumeContinueQueueOnError:!0};d.widget.submitFormAJAX(e,
a)},onConfirmCreditCardSuccess:function(a){a=a.additionalWidgetResponseData.additionalData;if("ok"===a.status)this.widget.trigger("addressChallengePassed",{instrumentId:this.data.instrumentId});else{"true"===a.retryExceeded&&this.set("ConfirmButtonEnabledAttribute",!1);var b=a.errors?a.errors.split(","):[],d=[];c.forEach(b,function(a){d.push({messageStringId:a})});this.useNewAddressChallengeFormat&&this.form.renderErrorMessages(this.form._getLocalizedErrorMessages(d));this._showAddressChallengeErrors(this.data.instrumentId,
d)}this.useNewAddressChallengeFormat||"ok"!==a.updateCreditCardStatus||this.widget.trigger("creditCardUpdated",{instrumentId:this.data.instrumentId,newExpMonth:a.newExpMonth,newExpYear:a.newExpYear})},_showAddressChallengeErrors:function(a,b){this.widget.trigger(e.eventName,e.failureStatus);this.widget.trigger("showAddressChallengeErrors",{instrumentId:a,errorMessages:b})},toggleAddressChallengeForm:function(a){d.toggleElement(this.getDOMElement("addressChallengeForm"),a);a&&(this.widget.trigger(e.eventName,
e.showStatus),this.widget.publishSuccessSushiMetrics({ActionType:"ShowCreditCardAddressChallenge",ActionValueType:"PaymentInstrument",ActionValue:this.data.instrumentId}))},validateAddressChallengeForm:function(a,b,c){var d=this.form.validateForm();0<d.length?this._showAddressChallengeErrors(this.data.instrumentId,d):this.useNewAddressChallengeFormat?this.confirmInstrument():a&&this.confirmInstrument(b,c)},confirmButtonClicked:function(){this.get("ConfirmButtonEnabledAttribute")&&(this.widget.trigger("hideAddressChallengeErrors",
{instrumentId:this.data.instrumentId}),this.useNewAddressChallengeFormat?this.validateAddressChallengeForm():this.widget.trigger("addressChallengeValidate",{instrumentId:this.data.instrumentId}))}})});l("events/PaymentMethodChallengedEvent",[],function(){return{eventName:"PaymentMethodChallengedEvent",showStatus:"SHOW",successStatus:"SUCCESS",failureStatus:"FAILURE"}});l("components/FinancialOfferComponent","css-utils component lang clog jQuery AUI!P".split(" "),function(c,d,f,h,g,a){var m;a.when("A").execute(function(a){a.on("a:dropdown:pmts-financial-offers-dropdown-native-id:select",
function(a){var b=m.filter(function(b){if(b.financialOfferId===a.value&&"Financing"===b.offerCategory)return b});1===b.length?h.logCounterMetric({feature:"equal-pay-financing-selected",resource:"_Count"}):console.log((1<b.length?"Duplicate":"No matching")+" financial offer detected.")})});return d.extend({initialize:function(a,c){this.instrumentId=c.data.instrumentId;this.isMobile="mobile"===a.options.deviceType;this.financialOfferDisplayStringsMap=c.data.financialOfferDisplayStringsMap;m=c.data.financialOfferBOs},
bindToEvents:function(){this.widget.on("toggleFinancialOffer",this,function(a){this.instrumentId===a.instrumentId&&this._toggleFinancialOffers(a.isSelected,a.isAddressChallenged)})},bindToElements:function(){this.getDOMElement("financialOffersContinueButton").click(f.bind(this._financialOfferContinueButtonClicked,this))},_toggleFinancialOffers:function(a,d){var b=this.getDOMElement("financialOffers-Mobile"),g=this.getDOMElement("financialOffers-Desktop"),f=this.getDOMElement("financialOfferTermsAndConditions-"+
this.instrumentId),h=this.getDOMElement("deferredPaymentsWarning-Desktop"),m=this.getDOMElement("deferredPaymentsWarning-Mobile"),l=this.getDOMElement("financialOfferMessages-Desktop"),p=this.getDOMElement("financialOfferMessages-Mobile"),u=this.getDOMElement("financialOffersMobileButtonContainer-"+this.instrumentId);c.toggleElement(b,!(a&&(this.isMobile||d)));c.toggleElement(m,a&&this.isMobile&&!d);c.toggleElement(g,a&&!d);a=a&&!d;c.toggleElement(f,a);c.toggleElement(u,a);c.toggleElement(h,a);c.toggleElement(l,
a);c.toggleElement(p,a&&this.isMobile)},_financialOfferContinueButtonClicked:function(){this._updateFinancialOfferMobileButtonContent(this.instrumentId);this._closeFinancialOfferSecondaryPopover(this.instrumentId)},_updateFinancialOfferMobileButtonContent:function(a){var c=this.getDOMElement("financialOffersMobileButton-"+a);c.find("input").remove();var b=this.getDOMElement("financialOffersMobilePopover-"+a);if(b=this._getSelectedFinancialOfferId(b))this._appendHiddenInput(b,c),this._updateButtonDisplayText(b,
c),a=this.getDOMElement("financialOfferDisplayString-"+a),this._updateFinancialOfferDisplayText(b,a)},_updateFinancialOfferDisplayText:function(a,c){c.text(this.financialOfferDisplayStringsMap[a])},_updateButtonDisplayText:function(a,c){c.find("span").find("span").text(this.financialOfferDisplayStringsMap[a])},_appendHiddenInput:function(a,c){g('\x3cinput type\x3d"hidden"\x3e').attr({name:"ppw-"+this.instrumentId+"_financialOfferId",value:a}).appendTo(c)},_getSelectedFinancialOfferId:function(a){var c=
"";a.find("input").each(function(a,d){d&&d.type&&d.name&&d.value&&"radio"===d.type&&d.checked&&(c=d.value)});return c},_closeFinancialOfferSecondaryPopover:function(c){a.when("a-secondary-view").execute(function(a){a&&(a=a.get("financialOffersSecondaryPopover-"+c))&&a.hide()})}})});l("mixins/tfx-currency-mixin",["events/InstrumentRowSelectedEvent","clog"],function(c,d){var f=!1,h,g,a,m=null,k=!1,e=!1;return{initialize:function(b,c){this.isEligibleForTfxRevise=c.data.isEligibleForTfxRevise;this.isTfxReviseJsImprovementsWeblabEnabled=
c.data.isTfxReviseJsImprovementsWeblabEnabled;this.isEligibleForTfxRevise&&(f=!0,h=c.data.tfxReviseEligibleCurrencyCode,g=c.data.tfxReviseEligibleCurrencyCodeFormatted,a=c.data.marketplaceCurrencyCode)},bindToEvents:function(){var a=this,e=a.form.fields.currencySelection;if(a.isTfxReviseJsImprovementsWeblabEnabled)a.widget.on(c,a,function(c){c.instrumentId===a.data.instrumentId?((c=a.form.getFormValues()[e.radioButtonName])||(c=a.form.getFormValues()[e.dropdownName]),a._updateTfxComponentsForRevise(c),
k=!0):m||(m=p.setTimeout(function(){k||a._updateTfxComponentsForRevise();k=!1;m=null},100));d.publishMetrics()})},bindToElements:function(){var a=this,c=a.form.fields.currencySelection;a.isTfxReviseJsImprovementsWeblabEnabled&&(a.form.bindToParameter(c.radioButtonName,"change",function(e){a._updateTfxComponentsForRevise(a.form.getFormValues()[c.radioButtonName],a.marketplaceCurrency);d.logCounterMetric({feature:"CurrencySelectionFieldRadioButtonChanged",resource:"_Count"});d.publishMetrics()}),a.form.bindToParameter(c.dropdownName,
"change",function(e){a._updateTfxComponentsForRevise(a.form.getFormValues()[c.dropdownName],a.marketplaceCurrency);d.logCounterMetric({feature:"CurrencySelectionFieldDropdownChanged",resource:"_Count"});d.publishMetrics()}))},_updateTfxComponentsForRevise:function(b){f&&(this.isEligibleForTfxRevise&&b===h?(this._changeTextOnContinueButton("pmts_portal_continue_button_with_tfx_currency",{currencyCode:b}),this._updateRevisePaymentErrorMessage("revisepayment_tfxPaymentRevisionEnabled_title_success",
"revisepayment_tfxPaymentRevisionEnabled_body_success",{currencyCode:g},"success"),d.logCounterMetric({feature:"TfxRevisePaymentValidSelection",resource:"_Count"})):(b?this._changeTextOnContinueButton("pmts_portal_continue_button_with_tfx_currency",{currencyCode:a}):this._changeTextOnContinueButton("pmts_portal_select_instrument_box_side_button_continue"),this._updateRevisePaymentErrorMessage("revisepayment_tfxPaymentRevisionEnabled_title_failure","revisepayment_tfxPaymentRevisionEnabled_body_failure",
{currencyCode:g,marketplaceCurrencyCode:a},"warning"),d.logCounterMetric({feature:"TfxRevisePaymentInvalidSelection",resource:"_Count"})))},_changeTextOnContinueButton:function(a,c){this.widget.trigger("setContinueButtonText",{stringId:a,parameters:c})},_updateRevisePaymentErrorMessage:function(a,c,d,g){e?this.widget.trigger("updateRevisePaymentErrorMessage",{titleStringId:a,bodyStringId:c,parameters:d,notificationType:g}):e=!0}}});l("components/SelectableDPMInstrumentListItemComponent",["components/SelectablePaymentMethodListItemComponent"],
function(c){return c});l("components/SelectableHBAListComponent",["css-utils","jQuery","form-component"],function(c,d,f){return f.extend({initialize:function(c,g){this._showModernFrameCx=g.data.showModernFrameCx;this._descriptorId=g.data.descriptorId;this._toggleSwitchName=g.data.toggleSwitchName;this._multipleHBAEligibleSubtotalJsBinding=g.data.multipleHbaEligibleSubtotal;this._multipleHBAEligibleSubtotalExcludePromoJsBinding=g.data.multipleHbaEligibleSubtotalExcludePromo;this.$instrumentItemListContent=
this.getDOMElement("instrumentItemListContent");this.$hbaListSelection=this._showModernFrameCx?d("input[name\x3d"+this._toggleSwitchName+"]"):this.getDOMElement("hbaListSelection")},_handleSelectionChange:function(d){c.toggleElement(this.$instrumentItemListContent,d);this.widget.trigger("optionalInstrumentListSelectionChanged",{paymentMethodCode:"HealthBenefitsCard",selected:d})},bindToElements:function(){var c=this;if(this._showModernFrameCx){C.when("a-switch","jQuery").execute(function(){c.$hbaListSelection.val(c._descriptorId)});
var g="a:switch:"+this._toggleSwitchName+":flip";this.widget.offAui(g);this.widget.onAui(g,function(a){c._handleSelectionChange(a.switchState.isOn)})}else this.$hbaListSelection.change(function(){var a=d(this).is(":checked");c._handleSelectionChange(a)})},bindToEvents:function(){this.widget.on("componentsInitialized",this,function(){this.$hbaListSelection.length&&!this.$hbaListSelection.is(":checked")&&this._handleSelectionChange(!1)});this.widget.on("balanceSelectionChanged",this,function(c){"PROMO"===
c.paymentMethod&&this._onPromoSelected(c.isSelected)})},_onPromoSelected:function(d){"amzn1.poa.poda.HealthBenefitsCard"===this._descriptorId&&(c.toggleElement(this.getDOMElement(this._multipleHBAEligibleSubtotalJsBinding),d),c.toggleElement(this.getDOMElement(this._multipleHBAEligibleSubtotalExcludePromoJsBinding),!d))}})});l("components/SelectableHBAListItemComponent",["components/SelectablePaymentMethodListItemComponent"],function(c){return c});l("SelectableHbaListItemHelper",["css-utils","jQuery",
"events/InstrumentRowSelectedEvent"],function(c,d,f){return function(h){function g(a){return"apx-".concat(t._paymentMethodCode).concat("-"+a)}function a(a){F=a;x?(c.toggleElement(t.getDOMElement(g("eligible-amount-details")),!0),c.toggleElement(t.getDOMElement(g("amount-field")),a)):B?(u.prop("checked",a),c.toggleElement(t.getDOMElement(g("eligible-amount-details")),!0),c.toggleElement(t.getDOMElement(g("amount-field")),a),z[a?"addClass":"removeClass"]("pmts-selected")):(u.prop("checked",a),c.toggleElement(t.getDOMElement(g("eligible-amount-details")),
a));m(a?"optionalInstrumentSelected":"optionalInstrumentDeselected",t.data.errors)}function m(a,c){t.widget.trigger(a,{instrumentId:t._instrumentId,errors:c,paymentMethodCode:t._paymentMethodCode,balance:b()})}function k(a){E===a.instrumentId&&F&&(m("optionalInstrumentSelected",t._getDisplayableErrors(a.errors)),e(!0))}function e(a){if(a){a=parseFloat(t.data.purchaseTotal);var c=b()+H;c>=a?n():w>=t.data.purchaseTotal||c+w>=a&&n()}else q(!1)}function b(){var a=d("[data-pmts-component-id\x3d"+t.id+
"] .apx-hba-requested-amount-input input");return a.length?parseFloat(a.val())+parseFloat(t.data.taxExcludedFromEligibleSubtotal):parseFloat(t.data.eligibleSubtotal)+parseFloat(t.data.taxExcludedFromEligibleSubtotal)}function n(){t.widget.trigger(f,{paymentMethod:t._paymentMethodCode,instrumentId:t._instrumentId});t.widget.trigger("backingInstrumentDeselected",{});q(!0)}function q(a){t.widget.trigger("hbaCoverageChanged",{coversPurchaseTotal:a})}function l(a){C.when("a-switch","jQuery").execute(function(b){b=
b.getSwitch(A);null!=b&&b.isOn(a)})}function p(b){x?l(b):(a(b),e(b))}var t=h,r=t.data.index,u=t.getDOMElementsByPrefix("hbaCardSelection"),H=0,w=0,E=t._instrumentId.replace("HealthBenefitsCard","HBA"),A=d("input[name\x3d"+t.data.toggleSwitchName+"]"),x=t._shouldDisplayModernizedFrame&&"radio"!==u.prop("type"),B=t._shouldDisplayModernizedFrame&&"radio"===u.prop("type"),F=x?A.is(":checked"):u.is(":checked"),z=t.getDOMElementsByPrefix("pmts-modern-hba-box");return{bindToEvents:function(){t.widget.on("componentsInitialized",
t,function(){p(F)});t.widget.on("UserRequestedUpperAmountLimitValidated",t,k);t.widget.on("optionalInstrumentListSelectionChanged",t,function(a){a.paymentMethodCode===this._paymentMethodCode&&(a=a.selected&&0===r,a!==F&&p(a))});t.widget.on("optionalInstrumentSelected",t,function(b){b.paymentMethodCode===t._paymentMethodCode&&b.instrumentId!==t._instrumentId&&F&&a(!1)});t.widget.on("balanceSelectionChanged",t,function(a){if("GC"===a.paymentMethod||"PROMO"===a.paymentMethod)"GC"===a.paymentMethod?w=
a.isSelected?parseFloat(a.balance):0:"PROMO"===a.paymentMethod&&(H=a.isSelected?parseFloat(a.balance):0,c.toggleElement(t.getDOMElement("pmts-hba-eligible-subtotal-text"),a.isSelected),c.toggleElement(t.getDOMElement("pmts-hba-eligible-subtotal-exclude-promo-text"),!a.isSelected)),F&&(a=b()>=parseFloat(t.data.purchaseTotal)-H-w,q(a))})},bindToElements:function(){if(x){C.when("a-switch","jQuery").execute(function(){F=A.is(":checked");A.val(t._instrumentId)});var b="a:switch:"+t.data.toggleSwitchName+
":flip";t.widget.offAui(b);t.widget.onAui(b,function(b){a(b.switchState.isOn);e(b.switchState.isOn)})}else B&&z.click(function(a){d(a.currentTarget).data("disabled")||p(!0)}),u.change(function(){var a=u.is(":checked");p(a)})}}}});l("components/SelectableIdealListComponent",["form-component"],function(c){return c});l("components/SelectableIdealListItemComponent",["components/SelectablePaymentMethodListItemComponent","jQuery"],function(c,d){return c.extend({bindToElements:function(){if(this.instrumentSpecificHelper)this.instrumentSpecificHelper.bindToElements();
else{var c=this;c.getDOMElementsByPrefix("POAInstrumentContainer").click(function(h){d(h.currentTarget).data("disabled")||c.poaInstrumentClicked(c._instrumentId)});c.widget.on("initializeRecommendedInstrument",c,function(d){d.instrumentId!==c._instrumentId||c.getDOMElementsByPrefix("POAInstrumentContainer").data("disabled")||(c._poaInstrumentSelected(),c.poaInstrumentClicked(c._instrumentId))})}}})});l("components/SelectableOtherPaymentMethodListComponent",["component","lang"],function(c,d){return c.extend({})});
l("components/CashOnDeliveryListComponent",["component"],function(c){return c.extend({})});l("components/CashOnDeliveryListItemComponent","continuable css-utils components/SimplePaymentOptionListItemComponent lang events/InstrumentRowSelectedEvent mixins/b2b-cross-wallet-mixin".split(" "),function(c,d,f,h,g,a){var m=["GC","JPPoints","ProductVoucher","PROMO"];return f.extend(c,a,{containerName:null,initialize:function(a,c){this.isPaymentOptionEditable=!0===c.data.isEditable;this.containerName=c.data.cashOnDeliveryContainerName;
this.isSuppressed=c.data.isSuppressed;this.isMultiTenderDisabledWithGiftCard=c.data.isMultiTenderDisabledWithGiftCard;this.isPaylastEligible=c.data.isPaylastEligible;this.showFloatingContinueBarOnNonPaylastPSP=c.data.showFloatingContinueBarOnNonPaylastPSP;this._shouldDisplayModernizedFrameCX=c.data.shouldDisplayModernizedFrameCX;this._modernizedPaymentArtGridCssClass=c.data.modernizedPaymentArtGridCssClass;this._disabledSectionCssClass=c.data.disabledSectionCssClass;this.paystationInstrumentId=c.data.paystationInstrumentId;
this._toggleOTPVerificationComponent(!1);this.$apbDeselectMessage=this.getDOMElement("apbDeselectMessageOnCodSelection");this.data.isValid!==r&&(this.isValid=this.data.isValid);this.data.newOTPVerificationFlowEnabled!==r&&(this.newOTPVerificationFlowEnabled=this.data.newOTPVerificationFlowEnabled);this.isAPVEnabledForCustomer=c.data.isAPVEnabledForCustomer},_getContainerElement:function(){return this.getDOMElement(this.containerName)},bindToEvents:function(){var a=this,c=!this._shouldDisplayModernizedFrameCX;
h.bind(f.prototype.bindToEvents,this).apply();a.widget.on("apbSelectionChanged",a,function(b){a.widget.get("apbCheckboxSelected")!==r&&(this._isInstrumentSelected()&&b.isSelected&&(this.setContinuable(!1),a.widget.trigger("PaymentPlanSelected",{isValid:!1})),b.isCODAPBToggleEnabled?this.isSuppressed?this.setDisabled(!0,c):b.isSelected&&this._onInstrumentDeselected(b):this.setDisabled(b.isSelected||this.isSuppressed,c));this._toggleOTPVerificationComponent(!1)});if(this.isAPVEnabledForCustomer)a.widget.on("apvSelectionChanged",
a,function(b){b&&!b.canCoverPurchaseStandalone&&b.isSelected&&this._isInstrumentSelected()&&(this.setContinuable(!1),a.widget.trigger("PaymentPlanSelected",{isValid:!1,message:this.widget.getLocalizedString("apx_checkout_disable_conitnue_when_apv_selected_after_cod")}),this._onInstrumentDeselected(b))});a.widget.on("OTPVerificationSuccessful",a,function(){this._triggerBackingInstrumentSelectedEvent()});a.widget.on("initializeRecommendedInstrument",a,function(b){b.instrumentId===a.data.paystationInstrumentId&&
this._onInstrumentSelected()});a.widget.on("optionalInstrumentSelected",a,function(b){a.isMultiTenderDisabledWithGiftCard&&"GC"===b.paymentMethod&&this.setDisabled(!0,c)});a.widget.on("optionalInstrumentDeselected",a,function(b){a.isMultiTenderDisabledWithGiftCard&&"GC"===b.paymentMethod&&this.setDisabled(this.isSuppressed,c)});a.widget.on("apbDeselectMessageEventOnCodSelection",a,function(b){d.showElement(a.getDOMElement("apbDeselectMessageOnCodSelection"))});a.widget.on("balanceSelectionChanged",
a,function(b){var c=!1!==b.isInstrumentOwned,d=!1!==a._getIsOwned();!0===a._isB2BCrossWalletMultitenderEnforcementEnabled?!0===a.shouldBeDeselectedPerB2BMultitenderRules("balanceSelectionChanged",b)&&a._updateBackingInstrumentState():a.data.isABCrossCustomerMultiTenderSuppressionEnabled&&0<=h.indexOf(m,b.paymentMethod)&&d!==c&&!b.isBackingInstrument&&b.isSelected&&this._updateBackingInstrumentState()})},onDisabledChange:function(a){this._shouldDisplayModernizedFrameCX&&this._getContainerElement().find("."+
this._modernizedPaymentArtGridCssClass).toggleClass(this._disabledSectionCssClass,!!a)},_onInstrumentSelected:function(){this._getContainerElement().addClass("pmts-selected");this._getInstrumentSelectionInputElement().prop("checked",!0);if(!this.isValid&&this.newOTPVerificationFlowEnabled){this._toggleOTPVerificationComponent(!0);var a=[this.widget.getLocalizedString("pmts_portal_otp_required_for_cod")];this._triggerBackingInstrumentSelectedEvent(a)}else this.widget.trigger("selectableCashOnDeliverySelected"),
this._triggerBackingInstrumentSelectedEvent(null);this.showFloatingContinueBarOnNonPaylastPSP||this.widget.trigger("SetContinueButtonTextToPlaceOrder");(this.isPaylastEligible||this.showFloatingContinueBarOnNonPaylastPSP)&&this._resetOrderTotalComputation();this.widget.trigger("codSelectionEvent")},_onInstrumentDeselected:function(a){this._getContainerElement().removeClass("pmts-selected");this._getInstrumentSelectionInputElement().prop("checked",!1);this.widget.trigger("selectableCashOnDeliveryDeselected");
!this.isValid&&this.newOTPVerificationFlowEnabled&&this._toggleOTPVerificationComponent(!1);this.widget.trigger("SetContinueButtonTextToPlaceOrderAndPay");d.hasAUIHiddenClass(this.$apbDeselectMessage)||d.hideElement(this.getDOMElement("apbDeselectMessageOnCodSelection"))},_triggerBackingInstrumentSelectedEvent:function(a){this.widget.trigger("backingInstrumentSelected",{instrumentId:this._getInstrumentId(),instrumentType:this._getInstrumentType(),errors:a,paymentMethod:this.data.paymentMethod})},
_toggleOTPVerificationComponent:function(a){d.toggleElement(this.getDOMElement("OTPComponent"),a)},_resetOrderTotalComputation:function(){this.widget.trigger("UpdateOrderTotalForIBDEvent",{ibdAmountDisplayed:0});this.widget.trigger("UpdateOrderTotalForNoCostEMIDiscount",{noCostEMIValue:0})}})});l("components/ConvenienceStorePaymentListItemComponent",["events/InstrumentRowSelectedEvent","css-utils","components/SimplePaymentOptionListItemComponent","lang","mixins/b2b-cross-wallet-mixin"],function(c,
d,f,h,g){return f.extend(g,{initialize:function(a,c){this.isPaymentOptionEditable=!0===c.data.isEditable},bindToEvents:function(){var a=this;h.forEach(["initializeRecommendedInstrument",c],function(c){a.widget.on(c,a,function(c){c.instrumentId===a._getInstrumentId()?a._onInstrumentSelected():a._onInstrumentDeselected()})});a.widget.on("balanceSelectionChanged",a,function(c){!0===a.shouldBeDeselectedPerB2BMultitenderRules("balanceSelectionChanged",c)&&a._updateBackingInstrumentState()})},_getContainerElement:function(){return this.getDOMElement("cvsBalanceContainer")}})});
l("components/DebitCardListItemComponent",["component","events/InstrumentRowSelectedEvent","css-utils","components/SimplePaymentOptionListItemComponent","lang"],function(c,d,f,h,g){return h.extend({initialize:function(a,c){this._fundingSourceIds=c.data.fundingSourceIds||[];this._inPickAddressWorkflow=!1;this._isRecommended=c.data.isRecommended||!1;this._initiallySelectedBank=c.data.initiallySelectedBank||"";this._creatableDebitCards=c.data.creatableDebitCards||[];this._debitCardDropdown=this.getDOMElement("indiaDebitCardDropdown");
this.isPaymentOptionEditable=!0===c.data.isEditable;this._toggleMobileContentWrapper(!1);this._disableAllDropdownMessages()},_onInstrumentSelected:function(){var a=this._debitCardDropdown.val();this._getContainerElement().addClass("pmts-selected");this._getInstrumentSelectionInputElement().prop("checked",!0);this._disableAllDropdownMessages();this._toggleMobileContentWrapper(!0);this._disableContinueButton(a);this._inPickAddressWorkflow||-1!==this._creatableDebitCards.indexOf(a)?this._enableAddDebitCardFormWorkflow(a):
this._isRecommended?this._enableAddDebitCardFormWorkflow(this._initiallySelectedBank):a&&this._enableContinueButtonWorkflow(a)},_onInstrumentDeselected:function(){this._toggleSelectedDropdownMessage(!1);this._getContainerElement().removeClass("pmts-selected");this._disableAllDropdownMessages();this._toggleMobileContentWrapper(!1);this.widget.trigger("selectableAddDebitCardDeselected")},bindToElements:function(){var a=this;g.bind(h.prototype.bindToElements,this).apply();a.getDOMElement("indiaDebitCardDropdown").change(function(){a.widget.trigger(d,
{instrumentId:a._getInstrumentId(),instrumentType:a._getInstrumentType()})})},_disableAllDropdownMessages:function(){var a=this;g.forEach(this._fundingSourceIds,function(c){a._toggleSelectedDropdownMessage(c,!1)})},_getContainerElement:function(){return this.getDOMElement("indiaDebitCardContainer")},bindToEvents:function(){var a=this;g.forEach(["initializeRecommendedInstrument",d],function(c){a.widget.on(c,a,function(c){c.instrumentId===this._getInstrumentId()?a._onInstrumentSelected():a._onInstrumentDeselected()})});
this.widget.on("selectableAddDebitCardSelectedOnInitialize",this,function(a){this._inPickAddressWorkflow=a.inPickAddressWorkflow;this._onInstrumentSelected();a.inPickAddressWorkflow&&(a=this.getDOMElement("indiaDebitCardDropdown").closest("div"),f.hideElement(a))})},_toggleMobileContentWrapper:function(a){0<this.getDOMElement("mobileContentWrapper").length&&f.toggleElement(this.getDOMElement("mobileContentWrapper"),a)},_toggleSelectedDropdownMessage:function(a,c){f.toggleElement(this.getDOMElement(a),
c)},_enableContinueButtonWorkflow:function(a){this.widget.trigger("selectableAddDebitCardDeselected");this._toggleSelectedDropdownMessage(a,!0);this._triggerBackingInstrumentSelectedEvent()},_enableAddDebitCardFormWorkflow:function(a){this._toggleSelectedDropdownMessage(a,!1);this.widget.trigger("selectableAddDebitCardSelected");this.widget.trigger("debitCardTypeSelected",{selectedBank:a})},_disableContinueButton:function(a){a&&-1===this._creatableDebitCards.indexOf(a)||this.widget.trigger("selectableDebitCardSelectedDisableContinue")}})});
l("components/ExternalPaymentListComponent",["component"],function(c){return c.extend({})});l("components/ExternalPaymentListItemComponent",["events/InstrumentRowSelectedEvent","css-utils","components/SimplePaymentOptionListItemComponent","lang"],function(c,d,f,h){return f.extend({containerName:null,externalPaymentDropdownJSBinding:null,initialize:function(c,a){this.isPaymentOptionEditable=!0===a.data.isEditable;this.containerName=a.data.externalPaymentContainerName;this.externalPaymentDropdownJSBinding=
a.data.externalPaymentDropdownJSBinding},bindToElements:function(){var d=this;h.bind(f.prototype.bindToElements,this).apply();d.getDOMElement(d.externalPaymentDropdownJSBinding).change(function(){d.widget.trigger(c,{instrumentId:d._getInstrumentId(),instrumentType:d._getInstrumentType()})})},bindToEvents:function(){h.bind(f.prototype.bindToEvents,this).apply();this.widget.on("initializeRecommendedInstrument",this,function(c){-1!==h.indexOf(this.data.fundingSourceIds,c.instrumentId)&&this._triggerBackingInstrumentSelectedEvent(this._getDisplayableErrors(this.form.validateForm(!0)))});
this.widget.on(c,this,function(c){c.instrumentId===this.data.instrumentId?(this._toggleInstallmentOffers(!0),""===this.getDOMElement("installmentSelections")[0].innerHTML&&this._triggerInstallmentDetails()):this._toggleInstallmentOffers(!1)})},_getContainerElement:function(){return this.getDOMElement(this.containerName)},_toggleInstallmentOffers:function(c){d.toggleElement(this.getDOMElement("installmentSelections"),c)},_triggerInstallmentDetails:function(){this.widget.trigger("installmentOptionChanged")}})});
l("components/NetBankingListItemComponent",["events/InstrumentRowSelectedEvent","css-utils","components/SimplePaymentOptionListItemComponent","lang"],function(c,d,f,h){var g={SUPPRESSED:"SuppressedNetBankingOptionSelected",ACTIVE:"ValidNetBankingOptionSelected",EMPTY_SELECTION:"NoNetBankingOptionSelected"};return f.extend({initialize:function(a,c){this.isPaymentOptionEditable=!0===c.data.isEditable;this.isPaylastEligible=c.data.isPaylastEligible;this.showFloatingContinueBarOnNonPaylastPSP=c.data.showFloatingContinueBarOnNonPaylastPSP;
this._toggleMobileNetBankingContentWrapper(!1);this.NB_InstrumentId=c.data.instrumentId;this.isNomenclatureWave2Enabled=c.data.isNomenclatureWave2Enabled},_getContainerElement:function(){return this.getDOMElement("netBankingContainer")},bindToElements:function(){var a=this;h.bind(f.prototype.bindToElements,this).apply();a.widget.on("initializeRecommendedInstrument",a,function(a){a.instrumentId===this.NB_InstrumentId&&this._toggleMobileNetBankingContentWrapper(!0)});this._isDesktop?a.getDOMElement("NetBankingRecommendationLink").mouseover(function(){a.widget.publishSuccessSushiMetrics({ActionValue:"NetBankingRecommendationPopover",
ActionValueType:"Mouseover"})}):a.getDOMElement("NetBankingRecommendationLink").click(function(){a.widget.publishSuccessSushiMetrics({ActionValue:"NetBankingRecommendationPopover",ActionValueType:"Click"})});a.getDOMElement("netBankingDropDown").change(function(){a.widget.trigger(c,{instrumentId:a._getInstrumentId(),instrumentType:a._getInstrumentType()})});a.widget.on(c,a,function(c){this.isNomenclatureWave2Enabled&&a._toggleNetbankingDropdown(c&&c.instrumentId===a._getInstrumentId());a.getDOMElement("mobileNetbankingContentWrapper").length&&
(c&&c.instrumentId===a._getInstrumentId()?a._toggleMobileNetBankingContentWrapper(!0):a._toggleMobileNetBankingContentWrapper(!1));a._toggleNudgeMessage(c&&c.instrumentId===a._getInstrumentId());a._disableContinueIfSuppressed(c);(this.isPaylastEligible||this.showFloatingContinueBarOnNonPaylastPSP)&&c&&c.instrumentId===a._getInstrumentId()&&a._resetOrderTotalComputation()})},_resetOrderTotalComputation:function(){this.widget.trigger("UpdateOrderTotalForIBDEvent",{ibdAmountDisplayed:0});this.widget.trigger("UpdateOrderTotalForNoCostEMIDiscount",
{noCostEMIValue:0})},_disableContinueIfSuppressed:function(a){if(a.instrumentId!==this.NB_InstrumentId)this._showNBSuppressionMessage(!1);else{a="EMPTY_SELECTION";var c=this.getDOMElement("netBankingDropdownSelect")[0].value,d;d=c&&0<=c.indexOf(" ")?c.substr(0,c.indexOf(" ")):c;if(this.data.suppressedFsIdMap&&-1!==h.keys(this.data.suppressedFsIdMap).indexOf(d)&&""!==d){if(c=this.getDOMElement("netBankingSuppressionMsg")[0])a=this.data.suppressedFsIdMap[d],this.data.isNomenclatureWave2Enabled?c.textContent=
a+" "+this.widget.getLocalizedString("apx_netbanking_bank_unavailable_message"):c.getElementsByClassName("a-alert-content")[0].textContent=a+" "+this.widget.getLocalizedString("payselect_bankTemporaryUnavailableInline"),this._showNBSuppressionMessage(!0),a="SUPPRESSED"}else this._showNBSuppressionMessage(!1),a=""!==d?"ACTIVE":"EMPTY_SELECTION";this._toggleContinueButtonForSuppressedNB(a)}},_showNBSuppressionMessage:function(a){d.toggleElement(this.getDOMElement("netBankingSuppressionMsgContainer"),
a)},_toggleContinueButtonForSuppressedNB:function(a){this.widget.trigger(g[a])},_toggleMobileNetBankingContentWrapper:function(a){d.toggleElement(this.getDOMElement("mobileNetbankingContentWrapper"),a)},_toggleNudgeMessage:function(a){d.toggleElement(this.getDOMElement("netBankingNudgeMsg"),a)},_toggleNetbankingDropdown:function(a){d.toggleElement(this.getDOMElement("netBankingDropDown"),a)}})});l("components/SelectablePaymentFinanceListComponent",["component","lang"],function(c,d){return c.extend({})});
l("components/SelectablePaymentServiceListComponent",["component","lang"],function(c,d){return c.extend({})});l("components/SelectablePOAInstrumentListComponent",["css-utils","form-component","lang","jQuery"],function(c,d,f,h){return d.extend({initialize:function(d,a){this._descriptorId=a.data.descriptorId;this._showModernFrameCx=a.data.showModernFrameCx;this._preSelectedInstrumentId=a.data.preSelectedInstrumentId;this._firstUsableInstrumentId=a.data.firstUsableInstrumentId;this._toggleSwitchElementName=
a.data.toggleSwitchElementName;this._multipleEBTEligibleSubtotalJsBinding=a.data.multipleEBTEligibleSubtotal;this._multipleEBTEligibleSubtotalExcludePromoJsBinding=a.data.multipleEBTEligibleSubtotalExcludePromo;this.$poaListSelection=this._showModernFrameCx?h("input[name\x3d"+this._toggleSwitchElementName+"]"):this.getDOMElementsByPrefix("ebtListSelection");this.$instrumentItemListContent=this.getDOMElement("instrumentItemListContent");c.toggleElement(this.$instrumentItemListContent,!1)},bindToElements:function(){var c=
this;if(this._showModernFrameCx){this.$poaListSelection.val(c._descriptorId);var a="a:switch:"+this._toggleSwitchElementName+":flip";this.widget.offAui(a);this.widget.onAui(a,function(a){a.switchState.clicked&&c._onToggleSwitchFlippedAppliedChange(a.switchState.isOn)})}else c.$poaListSelection.change(function(){c.$poaListSelection.prop("checked")?c._selectOptionalInstrumentRow():c._deselectOptionalInstrumentRow()})},bindToEvents:function(){var d=this;d.widget.on("optionalInstrumentRowSelected",d,
function(a){d._descriptorId===a.descriptorId&&c.toggleElement(this.$instrumentItemListContent,!0)});d.widget.on("balanceSelectionChanged",d,function(a){"RewardsAccount"===a.paymentMethod&&d._onRewardsAccountSelected(a.isSelected);"PROMO"===a.paymentMethod&&d._onPromoSelected(a.isSelected)})},_triggerEvent:function(c,a){this.widget.trigger(c,{instrumentId:a,descriptorId:this._descriptorId})},_onPromoSelected:function(d){"amzn1.poa.poda.EBTSNAP"===this._descriptorId&&(c.toggleElement(this.getDOMElement(this._multipleEBTEligibleSubtotalJsBinding),
d),c.toggleElement(this.getDOMElement(this._multipleEBTEligibleSubtotalExcludePromoJsBinding),!d))},_onRewardsAccountSelected:function(c){if("amzn1.poa.poda.EBTSNAP"===this._descriptorId&&f.isDefined(this._firstUsableInstrumentId)&&f.isDefined(this.$poaListSelection)){var a=this.getDOMElement("poaCheckboxText");this._showModernFrameCx||this.$poaListSelection.prop("disabled",c);c?(this._showModernFrameCx?(this._changeToggleSwitchEditability(!1),this._onToggleSwitchFlippedAppliedChange(!1)):this.$poaListSelection.prop("checked")&&
(this.$poaListSelection.prop("checked",!1),this._deselectOptionalInstrumentRow()),a.removeClass("a-color-base"),a.addClass("a-color-tertiary")):(this._showModernFrameCx&&this._changeToggleSwitchEditability(!0),a.addClass("a-color-base"),a.removeClass("a-color-tertiary"))}},_changeToggleSwitchEditability:function(c){var a=this;C.when("a-switch","jQuery").execute(function(d){var f=d.getSwitch(a.$poaListSelection);if(null!=f){var e=function(b){c||f.enabled(!1);a.widget.offAui("a:switch:"+a._toggleSwitchElementName+
":off",e)};f.enabled(!0);a.widget.onAui("a:switch:"+a._toggleSwitchElementName+":off",e);f.isOn(!1)}})},_onToggleSwitchFlippedAppliedChange:function(c){c?this._selectOptionalInstrumentRow():this._deselectOptionalInstrumentRow()},_selectOptionalInstrumentRow:function(){this._triggerEvent("optionalInstrumentRowSelected",this._preSelectedInstrumentId?this._preSelectedInstrumentId:this._firstUsableInstrumentId)},_deselectOptionalInstrumentRow:function(){this._triggerEvent("optionalInstrumentRowDeselected");
c.toggleElement(this.$instrumentItemListContent,!1)}})});l("EbtInstrumentListItemHelper",["jQuery","css-utils","lang","events/spinner-events","AUI!P"],function(c,d,f,h,g){c(document).ready(function(){c(".pmts-portal-list-item-ebt-balance-check-last-updated-time-reference").map(function(a,c){a=(new Date(c.textContent)).toLocaleString("UTC",{timeZoneName:"short"});c.textContent=a})});return function(a){function m(a){return"apx-".concat(u._paymentMethodCode).concat(a)}function k(a){u._shouldDisplayModernizedFrame&&
x?r(a):B.prop("checked",a);d.toggleElement(u.getDOMElement(m("-subtotal")),a);d.toggleElement(u.getDOMElement(m("-amount-field")),a);d.toggleElement(u.getDOMElement(m("-balance-check")),a)}function e(a,b){u.widget.trigger(a,{instrumentId:u._instrumentId,errors:b,paymentMethodCode:u._paymentMethodCode})}function b(a){u.widget.trigger(a,{instrumentId:u._instrumentId,descriptorId:u._descriptorId})}function n(a){u._instrumentId===a.instrumentId&&e("optionalInstrumentSelected",u._getDisplayableErrors(a.errors))}
function l(a){g.when("a-switch","jQuery").execute(function(b){var c=b.getSwitch(B);if(null!=c){var d=function(b){a||c.enabled(!1);u.widget.offAui("a:switch:"+u._toggleSwitchName+":off",d)};c.enabled(!0);u.widget.onAui("a:switch:"+u._toggleSwitchName+":off",d);c.isOn(!1)}})}function r(a){g.when("a-switch","jQuery").execute(function(b){b=b.getSwitch(B);null!=b&&b.isOn(a)})}function v(a){a.descriptorId===u._descriptorId&&(k(!1),e("optionalInstrumentDeselected"))}function t(){u.widget.submitFormAJAX({"ppw-widgetState":u.widget.options.serializedState,
"ppw-widgetEvent":"ViewBalanceEvent","ppw-iid":u._instrumentId,"ppw-accountType":"ElectronicBenefitTransfer","ppw-redirectUri":p.location.pathname},{success:function(a){a=a.additionalWidgetResponseData.additionalData;"true"===a.authorizationRequired&&null!=a.interstitialPageUrl&&(p.location.href=a.interstitialPageUrl)}})}function I(a){a.preventDefault();a=c(".pmts-select-payment-instrument-form");u.widget.trigger(h.showSpinner);c.ajax({type:a.get(0).method,url:a.get(0).action,data:a.serialize(),contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
dataType:"text",success:t,error:t})}var u=a,H=u.data.EBTEligibleSubtotal,w=u.data.EBTEligibleSubtotalExcludePromo,E=u.getDOMElement("pmts-portal-list-item-ebt-balance-check-link-reference"),A=u.getDOMElementsByPrefix("pmts-modern-ebt-box-"),x=A.hasClass("single-ebt-row"),B=u._shouldDisplayModernizedFrame&&x?c("input[name\x3d"+u._toggleSwitchName+"]"):u.getDOMElementsByPrefix("ebtCardSelection");return{bindToEvents:function(){if(u._shouldDisplayModernizedFrame&&x){var a="a:switch:"+u._toggleSwitchName+
":flip";u.widget.offAui(a);u.widget.onAui(a,function(a){a.switchState.clicked&&(a.switchState.isOn?b("optionalInstrumentRowSelected"):b("optionalInstrumentRowDeselected"))})}u.widget.on("optionalInstrumentRowSelected",u,function(a){if(!x){var b=a.instrumentId,c=u._instrumentId;b===c?u.getDOMElement("pmts-modern-ebt-box-"+b).addClass("pmts-selected"):u.getDOMElement("pmts-modern-ebt-box-"+c).removeClass("pmts-selected")}k(u._instrumentId===a.instrumentId)});u.widget.on("optionalInstrumentRowDeselected",
u,v);u.widget.on("UserRequestedUpperAmountLimitValidated",u,n);u.widget.on("balanceSelectionChanged",u,function(a){"PROMO"===a.paymentMethod&&(d.toggleElement(this.getDOMElement(H),a.isSelected),d.toggleElement(this.getDOMElement(w),!a.isSelected))});u.widget.on("balanceSelectionChanged",u,function(a){if("RewardsAccount"===a.paymentMethod&&(this.getDOMElement("POAInstrumentContainer").prop("disabled",a.isSelected),a=a.isSelected,f.isDefined(B)))if(u._shouldDisplayModernizedFrame&&x?l(!a):B.prop("disabled",
a),a&&b("optionalInstrumentRowDeselected"),u._shouldDisplayModernizedFrame)u.getDOMElement("pmts-modern-ebt-box-"+u._instrumentId).find("."+u._modernizedPaymentArtGridCssClass).toggleClass(u._disabledSectionCssClass,!!a);else{var c=u.getDOMElementsByPrefix("poaCheckbox");a?(c.removeClass("a-color-base"),c.addClass("a-color-tertiary")):(c.addClass("a-color-base"),c.removeClass("a-color-tertiary"))}});u.widget.on("componentsInitialized",u,function(a){if(u._isPreselected||u._poaInstrumentRecommended)u._shouldDisplayModernizedFrame&&
x?r(!0):B.prop("checked",!0),b("optionalInstrumentRowSelected")})},bindToElements:function(){u._shouldDisplayModernizedFrame?x?B.val(u._instrumentId):A.click(function(a){c(a.currentTarget).data("disabled")||b("optionalInstrumentRowSelected")}):B.change(function(){B.prop("checked")?b("optionalInstrumentRowSelected"):b("optionalInstrumentRowDeselected")});E.click(f.bind(I,this))}}}});l("components/POAInstrumentListItemComponent","events/InstrumentRowSelectedEvent css-utils components/SimplePaymentOptionListItemComponent lang jQuery EbtInstrumentListItemHelper SelectableHbaListItemHelper mixins/b2b-cross-wallet-mixin".split(" "),
function(c,d,f,h,g,a,m,k){var e=["amzn1.pm.puma.TG9hbjpHbG9iYWxJbnN0YWxsbWVudExlbmRpbmdDcmVkaXRDYXJk","amzn1.pm.puma.TG9hbjpHbG9iYWxJbnN0YWxsbWVudExlbmRpbmdCYW5rQWNjb3VudA\x3d\x3d","amzn1.pm.puma.TG9hbjpHbG9iYWxJbnN0YWxsbWVudExlbmRpbmdDcmVkaXRMaW5l"],b=["GC","JPPoints","ProductVoucher","PROMO"];return f.extend(k,{initialize:function(b,c){this._paymentMethodCode=c.data.paymentMethod;this._descriptorId=c.data.descriptorId;this._isPoaAccountUsable=c.data.isPoaAccountUsable;this._isPreselected=c.data.isPreselected;
this._paymentMethodCodeInLowerCase=c.data.paymentMethod?c.data.paymentMethod.toLowerCase():r;this._instrumentId=c.data.instrumentId;this._deviceType=c.data.deviceType;this._showAlertsAndButtons=c.data.showAlertsAndButtons;this._requireRegistrationForPOAInstruments=c.data.requireRegistrationForPOAInstruments;this._poaInstrumentRecommended=c.data.poaInstrumentRecommended;this._isOwned=c.data.isOwned;this._isABCrossCustomerMultiTenderSuppressionEnabled=c.data.isABCrossCustomerMultiTenderSuppressionEnabled;
this._modernizedPaymentArtGridCssClass=c.data.modernizedPaymentArtGridCssClass;this._disabledSectionCssClass=c.data.disabledSectionCssClass;this._shouldDisplayModernizedFrame=c.data.shouldDisplayModernizedFrame;this._toggleSwitchName=c.data.toggleSwitchName;this._poaInstrumentRecommended||this._poaInstrumentUnselected();this._updateRegistrationStatus(c.data.registrationStatus);"amzn1.poa.poda.EBTSNAP"===this._descriptorId&&this._isPoaAccountUsable?this.instrumentSpecificHelper=new a(this):"amzn1.poa.poda.HealthBenefitsCard"===
this._descriptorId&&this._isPoaAccountUsable&&(this.instrumentSpecificHelper=new m(this))},_updateRegistrationStatus:function(a){this._registrationStatus=a;a=this.getDOMElement("poa-pending-status");var b=this.getDOMElement("poa-approved-status");0<a.length&&0<b.length&&("Approved"===this._registrationStatus?(d.showElement(b),d.hideElement(a)):(d.showElement(a),d.hideElement(b)),"Pending"===this._registrationStatus&&p.setTimeout(h.bind(this._pollForRegistrationStatus,this),1E4))},_pollForRegistrationStatus:function(){var a=
this;a.widget.continueRequest({"ppw-widgetEvent":"PollForRegistrationStatusEvent","ppw-instrumentId":a._instrumentId,"ppw-widgetState":a.widget.options.serializedState},{success:function(b){(b=b.additionalWidgetResponseData.additionalData)&&b[a._instrumentId]&&a._updateRegistrationStatus(b[a._instrumentId])}})},_getContainerElement:function(){var a="POAInstrumentContainer-".concat(this._instrumentId);return this.getDOMElement(a)},_showAlert:function(){this._toggleAlert(!0)},_showButtons:function(){this._toggleButtons(!0)},
_showStatus:function(){this._toggleStatus(!0)},_showExpandedStatus:function(){this._toggleExpandedStatus(!0)},_hideAlert:function(){this._toggleAlert(!1)},_hideStatus:function(){this._toggleStatus(!1)},_hideButtons:function(){this._toggleButtons(!1)},_hideExpandedStatus:function(){this._toggleExpandedStatus(!1)},_makeSelector:function(a){return"pmts-".concat(this._paymentMethodCodeInLowerCase).concat(a)},_toggleAlert:function(a){d.toggleElement(this.getDOMElement(this._makeSelector("-alert")),a)},
_toggleButtons:function(a){d.toggleElement(this.getDOMElement(this._makeSelector("-buttons")),a)},_toggleStatus:function(a){d.toggleElement(this.getDOMElement(this._makeSelector("-status")),a)},_toggleExpandedStatus:function(a){d.toggleElement(this.getDOMElement(this._makeSelector("-status-expanded")),a)},_toggleDisplayAdditionalText:function(a){d.toggleElement(this.getDOMElement("displayAdditionalText"),a)},_toggleRecurringPaymentEligibilityMessage:function(a){this.widget.trigger("toggleRecurringPaymentEligibilityMessage",
{instrumentId:this._instrumentId,isSelected:a})},_poaInstrumentSelected:function(){this._onInstrumentSelected();this._showAlert();this._showButtons();"Declined"===this._registrationStatus&&"desktop"===this._deviceType&&this._showAlertsAndButtons&&this._hideStatus();this._maybeTriggerInvalidRegistrationMessage();this._showExpandedStatus();this._toggleDisplayAdditionalText(!0);this._checkIneligibleItemsInCart();this._toggleRecurringPaymentEligibilityMessage(!0)},_maybeTriggerInvalidRegistrationMessage:function(){var a=
this._registrationStatusErrorStrings[this._registrationStatus];(a=a?[this.widget.getLocalizedString(a)]:null)&&this._triggerBackingInstrumentSelectedEvent(a)},_checkIneligibleItemsInCart:function(){for(var a in e)if(this._instrumentId&&-1<this._instrumentId.search(e[a])){this.widget.trigger("gilCheckIneligibleItemsInCartEvent");break}},_poaInstrumentUnselected:function(){this._onInstrumentDeselected();this._hideAlert();this._hideButtons();"Declined"===this._registrationStatus&&"desktop"===this._deviceType&&
this._showStatus();this._hideExpandedStatus();this._toggleDisplayAdditionalText(!1);this._toggleRecurringPaymentEligibilityMessage(!1)},poaInstrumentClicked:function(a){this.widget.trigger(c,{instrumentId:a,isInstrumentOwned:this._getIsOwned(),paymentMethod:this._paymentMethodCode})},_instrumentRowSelected:function(a){a===this._instrumentId?this._poaInstrumentSelected():this._poaInstrumentUnselected()},bindToEvents:function(){if(this.instrumentSpecificHelper)this.instrumentSpecificHelper.bindToEvents();
else{var a=this;a.widget.on("poaInstrumentRowSelected",a,function(b){a._instrumentRowSelected(b.instrumentId)});a.widget.on(c,a,function(b){a._instrumentRowSelected(b.instrumentId)});a.widget.on("gilIneligibleItemsInCartEvent",a,function(b){a._triggerBackingInstrumentSelectedEvent([b])});a.widget.on("balanceSelectionChanged",this,function(c){var d=!1!==c.isInstrumentOwned,e=!1!==this._getIsOwned();!0===a._isB2BCrossWalletMultitenderEnforcementEnabled?!0===a.shouldBeDeselectedPerB2BMultitenderRules("balanceSelectionChanged",
c)&&a._updateBackingInstrumentState():this._isABCrossCustomerMultiTenderSuppressionEnabled&&0<=h.indexOf(b,c.paymentMethod)&&e!==d&&!c.isBackingInstrument&&c.isSelected&&this._updateBackingInstrumentState()})}},bindToElements:function(){if(this.instrumentSpecificHelper)this.instrumentSpecificHelper.bindToElements();else{var a=this;a.getDOMElementsByPrefix("POAInstrumentContainer").click(function(b){g(b.currentTarget).data("disabled")||a.poaInstrumentClicked(a._instrumentId)});a.widget.on("initializeRecommendedInstrument",
a,function(b){b.instrumentId===a._instrumentId&&(a.getDOMElementsByPrefix("POAInstrumentContainer").data("disabled")||a._poaInstrumentSelected())});a.getDOMElement("activateCimarronPopoverButton").click(function(b){b.preventDefault();a.widget.submitFormAJAX({"ppw-widgetState":a.widget.options.serializedState,"ppw-widgetEvent":"BusinessInvoicingActivationStartEvent"})});a.getDOMElement("activateCimarronTooltipContentButton").click(function(b){b.preventDefault();a.widget.submitFormAJAX({"ppw-widgetState":a.widget.options.serializedState,
"ppw-widgetEvent":"BusinessInvoicingActivationStartEvent"})})}},_registrationStatusErrorStrings:{Unstarted:"pmts_portal_registration_method_failure_unstarted",Pending:"pmts_portal_registration_method_failure_pending",Declined:"pmts_portal_registration_method_failure_declined"}})});l("components/UserRequestedUpperAmountLimitComponent",["css-utils","form-component","lang","input-helper"],function(c,d,f,h){return d.extend({field:"UAL",initialize:function(c,a){this._instrumentId=a.data.instrumentId;this._userRequestInitialAmount=
a.data.userRequestInitialAmount;this._excludePromoAmount=a.data.excludePromoAmount;this._showMCXModernFrame=a.data.showMCXModernFrame;this._subtotalInputAppendedTextJSBinding=a.data.upperAmountLimitSubtotalText;this._subtotalInputAppendedExcludePromoTextJSBinding=a.data.upperAmountLimitSubtotalExcludePromoText;c=this._instrumentId.concat("_").concat("UAL");this.$userRequestedUpperAmountInput=this.getDOMElement(c);this._showMCXModernFrame&&this.$userRequestedUpperAmountInput.attr("inputmode","decimal")},
bindToElements:function(){var c=this;this._showMCXModernFrame&&(h.limitToNumericInput(c.$userRequestedUpperAmountInput),h.limitNumericInputDigits(c.$userRequestedUpperAmountInput,2));c.$userRequestedUpperAmountInput.change(function(){c._validateAndTriggerUserRequestedUpperAmountLimitValidatedEvent()})},bindToEvents:function(){var d=this;d.widget.on("optionalInstrumentRowSelected",d,function(a){d._instrumentId===a.instrumentId&&d._validateAndTriggerUserRequestedUpperAmountLimitValidatedEvent()});d.widget.on("balanceSelectionChanged",
d,function(a){"PROMO"===a.paymentMethod&&(d.$userRequestedUpperAmountInput[0].value=a.isSelected?this._userRequestInitialAmount:this._excludePromoAmount,null!=this._subtotalInputAppendedTextJSBinding&&null!=this._subtotalInputAppendedExcludePromoTextJSBinding&&(c.toggleElement(d.getDOMElement(this._subtotalInputAppendedTextJSBinding),a.isSelected),c.toggleElement(d.getDOMElement(this._subtotalInputAppendedExcludePromoTextJSBinding),!a.isSelected)),d._validateAndTriggerUserRequestedUpperAmountLimitValidatedEvent())})},
_validateAndTriggerUserRequestedUpperAmountLimitValidatedEvent:function(){this._resetFormErrorMessages();var c=this.form.validateForm();0<c.length&&this._displayFormErrorMessages(c);this.widget.trigger("UserRequestedUpperAmountLimitValidated",{instrumentId:this._instrumentId,errors:c})},_validationToErrorMap:{apx_non_numeric_input_error_message:"FailureNonNumericInput",apx_exceeds_balance_or_eligible_subtotal:"FailureExceedsEligibleSubtotal",apx_exceeds_balance:"FailureExceedsBalance",apx_non_positive_input_error_message:"FailureNonPositiveInput"},
_getErrorMessageContainer:function(){return this.getDOMElement("errorMessages")},_resetFormErrorMessages:function(){var d=this;c.hideElement(d._getErrorMessageContainer());f.forEachKeyValue(d._validationToErrorMap,function(a,c){d.form.resetErrorMessage(d.field,d.getDOMElement(c))},d)},_displayFormErrorMessages:function(d){0!==d.length&&(d=d[0],d.field===this.field&&(d=this.getDOMElement(this._validationToErrorMap[d.messageStringId]),this.form.displayErrorMessage(this.field,d)),c.showElement(this._getErrorMessageContainer()))}})});
l("components/SwipeACardListItemComponent",["css-utils","components/SimplePaymentOptionListItemComponent"],function(c,d){return d.extend({initialize:function(c,d){this.isPaymentOptionEditable=!0===d.data.isEditable},_getContainerElement:function(){return this.getDOMElement("swipeACardContainer")}})});l("components/SelectAddressComponent","css-utils form-component form-helper lang jQuery events/form-submitted-event".split(" "),function(c,d,f,h,g,a){return d.extend({initialize:function(a,d){this._action=
d.data.action;this.$useSelectedAddress=this.getDOMElement("useSelectedAddress");this.defaultSelectedAddressID=d.data.defaultId;if("mobile"===d.data.deviceType){a=this.getDOMElementsByPrefix("addressSelectButton-");c.hideElement(a);c.hideElement(g(".pmts-address-phoneNumber-field"));var e=this;a=this._getAddressRows();h.forEach(a,function(a){e._addressRowSelected(g(a),d.data.defaultId)},e)}},bindToElements:function(){this._getAddressRows().click(h.bind(this._triggerAddressRowSelectedEvent,this));this.$useSelectedAddress.click(h.bind(this._handleFormSubmission,
this))},bindToEvents:function(){var c=this;c.widget.on("addressRowSelected",c,function(a){var d=c._getAddressRows();h.forEach(d,function(b){c._addressRowSelected(g(b),a.addressId)},c)});this.widget.on(a,this,function(a){if(a.action===this._action){var c=this.getDOMElement("useSelectedAddress").closest("form");this.getDOMElement("useSelectedAddress").find("input").each(function(a,d){f.ensureWidgetEventInput(c,d.name)});c.submit()}});c.widget.on("componentsInitialized",c,function(){this.widget.trigger("sendDefaultAddressRowSelected",
{addressId:this.defaultSelectedAddressID})})},_getAddressRows:function(){return this.getDOMElementsByPrefix("addressSelectionRow-")},_triggerAddressRowSelectedEvent:function(a){a=g(a.currentTarget).data("address-id");this.widget.trigger("addressRowSelected",{addressId:a})},_addressRowSelected:function(a,d){var e=a.data("address-id"),b=a.find("input[type\x3dradio]"),f=a.find(".pmts-select-this-address"),g=a.find(".pmts-address-phoneNumber-field");d===e?(a.addClass("pmts-selected"),b.prop("checked",
!0),0<f.length&&c.showElement(f),0<g.length&&c.showElement(g)):(a.removeClass("pmts-selected"),b.prop("checked",!1),0<f.length&&c.hideElement(f,!1),0<g.length&&c.hideElement(g))},_handleFormSubmission:function(c){var d=this.getDOMElement("useSelectedAddress").closest("form"),d=this.getFormSubmissionParameters(d,this.$useSelectedAddress);this.widget.trigger(a,{submissionParameters:d,event:c,action:this._action});return!1}})});l("components/SetPaymentPlanComponent",["component","lang"],function(c,d){return c.extend({})});
l("events/AwaitInstrumentPreparedEvent",["public-event-registry"],function(c){c.register("AwaitInstrumentPrepared");return"AwaitInstrumentPrepared"});l("AwaitingEventStatusConstants",[],function(){return{Pending:"Pending",Success:"Success",Failure:"Failure",TimedOut:"TimedOut",UnknownFailure:"UnknownFailure",NotRequired:"NotRequired"}});l("events/InstrumentPreparedEvent",["public-event-registry"],function(c){c.register("InstrumentPrepared");return"InstrumentPrepared"});l("events/PreparedInstrumentContinueErrorEvent",
["public-event-registry"],function(c){c.register("PreparedInstrumentContinueError");return"PreparedInstrumentContinueError"});l("SetPaymentPlanOrderSummary","jQuery lang form-helper css-utils clog form-constants events/SetPaymentPlanTrial events/SetPaymentPlanSelectContinueEvent".split(" "),function(c,d,f,h,g,a,m,k){function e(a){h.showElement(c(".apx-order-summary-api-error"));h.showElement(c(".apx-order-summary-api-error-desktop"));a?(h.hideElement(c(".apx-order-summary-api-error-retry")),h.showElement(c(".apx-order-summary-api-error-retry-failed"))):
(h.showElement(c(".apx-order-summary-api-error-retry")),h.hideElement(c(".apx-order-summary-api-error-retry-failed")))}function b(b){var c=a.WIDGET_EVENT_KEY+a.KEY_VALUE_SEPARATOR,d=b.find("input[type\x3d'hidden'][name^\x3d'"+c+k+"']")[0];b=f.serializeObject(b);d&&delete b[d.name];b[c+m]="";return b}var l=null,q=null,r=!1;return{fetchOrderSummary:function(a,d,k,m){var p=(new Date).getTime();k||(k=0);d=d.closest("form");if(a&&l)c(".apx-order-summary-content").html(l),c(".apx-order-summary-content-desktop")&&
c(".apx-order-summary-content-desktop").html(l);else{var w="/gp/buy/cricket/payments/payLast/ordersummary/display.html?showIncompleteOrderSummary\x3d0";a&&(w="/gp/buy/cricket/payments/payLast/ordersummary/display.html?showIncompleteOrderSummary\x3d1");m?c.ajax({type:"POST",url:w,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",headers:{"x-amz-checkout-transition":"ajax"},dataType:"text",data:f.serializeObject(d),async:!0,success:function(a){g.logLatencyMetric({feature:"PaylastOrderSummaryApiLoad",
resource:"_Latency",startTime:p});g.logCounterMetric({feature:"PaylastOrderSummaryApiLoadSuccess",resource:"_Count"});l=a},error:function(){g.logLatencyMetric({feature:"PaylastOrderSummaryApiLoad",resource:"_Latency",startTime:p});g.logCounterMetric({feature:"PaylastOrderSummaryApiLoadError",resource:"_ErrorCount"});h.hideElement(c(".apx-order-summary-spinner"));h.hideElement(c(".apx-order-summary-spinner-desktop"))}}):(q=c.ajax({type:"POST",url:w,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
headers:{"x-amz-checkout-transition":"ajax"},dataType:"text",data:b(d),async:!0,beforeSend:function(){null!=q&&(q.abort(),g.logCounterMetric({feature:"PaylastOrderSummaryApiLoadRequestAborted",resource:"_Count"}));h.hideElement(c(".apx-order-summary-api-error"));h.hideElement(c(".apx-order-summary-api-error-desktop"));h.showElement(c(".apx-order-summary-spinner"));c(".apx-order-summary-content").html("");c(".apx-order-summary-content-desktop")&&c(".apx-order-summary-content-desktop").html("");h.showElement(c(".apx-order-summary-spinner-desktop"))},
success:function(b){g.logLatencyMetric({feature:"PaylastOrderSummaryApiLoad",resource:"_Latency",startTime:p});g.logCounterMetric({feature:"PaylastOrderSummaryApiLoadSuccess",resource:"_Count"});if(0<c(b).find("#sc-active-cart").length||c(b).find("#activeCartViewForm")[0]&&"undefined"!==c(b).find("#activeCartViewForm")[0].action&&(c(b).find("#activeCartViewForm")[0].action.includes("/gp/aw/c/")||c(b).find("#activeCartViewForm")[0].action.includes("/gp/cart/view.html")))r=!0,b="",e(!0);c(".apx-order-summary-content").html(b);
c(".apx-order-summary-content-desktop")&&c(".apx-order-summary-content-desktop").html(b);h.hasAUIHiddenClass(c(".apx-order-summary-content-desktop"))||(c(".apx-order-total-label")&&h.hideElement(c(".apx-order-total-label")),c(".apx-order-total-divider")&&h.hideElement(c(".apx-order-total-divider")));null==l&&a&&(l=b);h.hideElement(c(".apx-order-summary-spinner"));h.hideElement(c(".apx-order-summary-spinner-desktop"))},error:function(a){g.logLatencyMetric({feature:"PaylastOrderSummaryApiLoad",resource:"_Latency",
startTime:p});g.logCounterMetric({feature:"PaylastOrderSummaryApiLoadError",resource:"_ErrorCount"});h.hideElement(c(".apx-order-summary-spinner"));h.hideElement(c(".apx-order-summary-spinner-desktop"));e(k)},cache:!1}),g.publishMetrics())}},redirectToCart:function(a,b){if(r||a)p.location.href=b},getFormData:b}});l("components/SetPaymentPlanSelectComponent","AUI!P events/InstrumentRowSelectedEvent events/SetPaymentPlanSelectContinueEvent events/SelectablePaymentOptionEvents events/SetPaymentPlanTrial events/ValidateInstrumentPreparationEvent events/AwaitInstrumentPreparedEvent events/InstrumentPreparedEvent events/PreparedInstrumentContinueErrorEvent events/spinner-events events/js-continue-failure-event events/SubmitSecureFieldDataEvent events/SecureFieldDataReadyEvent css-utils jQuery component lang form-helper ExecutionsWidgetUtils components/SetPaymentPlanSelectComponent/validators SetPaymentPlanOrderSummary clog AddPaymentMethodTouchLinkSupport RentalUtils AwaitingEventStatusConstants mash-helper mixins/secure-container-support form-constants mixins/SecureFieldsFormComponent events/ShowAddPaymentInstrumentPage events/ShowMessageOnContinueButton".split(" "),
function(c,d,f,h,g,a,m,k,e,b,l,q,y,v,t,I,u,H,w,E,A,x,B,F,z,D,C,M,N,J,R){var O=!1,L=!1,K=!1,P=4500;return I.extend(B,F,C,N,{showSecondaryView:!1,adjustedOrderTotalAmount:0,appliedIbdAmount:0,appliedApbBalance:0,appliedPromoBalance:0,appliedNoCostEMIDiscount:0,fetchCompleteOrderSummary:!1,isPaymentPlanComplete:!1,numberOfTimesPaymentMethodChanged:0,adjustedDisplayOrderTotalString:r,countryCode:r,DECIMAL_PLACES:2,isJigsawEligible:!1,isCardSelected:!1,consentCheckBoxStatus:!1,selectedInstrumentId:r,displayExplicitConsentPopover:!1,
isMCXModernizedFrameEnabled:!1,isPromoBalanceSelected:!1,isProductVoucherSelected:!1,isGiftCardSelected:!1,isRewardsAccountSelected:!1,appliedRewardsValue:0,appliedTotalValue:0,totalBeforeSpecialString:"",totalBeforeSpecialValue:0,localStringFormat:"en-US",shippingDiscountValue:0,currentRA:"",delegateUpiProcessing:!1,bypassContinueWidgetCall:!1,isSkipContinueWithSameFormWeblabEnabled:!1,upiInstrumentId:r,selectedPaystationInstrumentId:r,selectedPaystationPaymentMethodCategory:r,maybeInstallmentsOfferIds:r,
maybeSelectedInstallmentsOfferId:r,totalAPBBalance:r,redeemableAPBBalance:r,availableAPLBalance:r,deviceSignatureCheckStatus:"Pending",isINMarketplace:r,initialize:function(a,b){this.showSecondaryView=b.data.showSecondaryView;this.isJigsawEligible=b.data.isJigsawEligible;this.isSkipContinueWithSameFormWeblabEnabled=b.data.isSkipContinueWithSameFormWeblabEnabled;this.ajaxSubstitutionEnabled=b.data.ajaxSubstitutionEnabled;this.orderSummaryHeaderEnabled=b.data.orderSummaryHeaderEnabled;b.data.showFloatingContinueBarOnNonPaylastPSP&&
(this.showFloatingContinueBarOnNonPaylastPSP=b.data.showFloatingContinueBarOnNonPaylastPSP);b.data.showFloatingContinueBarOnNonPaylastPspWithViewDetails&&(this.showFloatingContinueBarOnNonPaylastPspWithViewDetails=b.data.showFloatingContinueBarOnNonPaylastPspWithViewDetails);b.data.paylastOrderSummaryEnabled&&(L=b.data.paylastOrderSummaryEnabled);b.data.trialPrefetchEnabled&&(O=b.data.trialPrefetchEnabled);b.data.optimiseFetchOrderSummaryCalls&&(K=b.data.optimiseFetchOrderSummaryCalls);if((this.isOrderTotalDisplayedInFloatingCTAContainer=
b.data.isOrderTotalDisplayedInFloatingCTAContainer)||this.showFloatingContinueBarOnNonPaylastPSP)this.adjustedOrderTotalAmount=b.data.adjustedOrderTotalAmount||0,this.adjustedDisplayOrderTotalString=b.data.adjustedDisplayOrderTotalString||r,this.countryCode=b.data.countryCode||r;var c=this.getDOMElement("payment-plan-select-form-to-submit");this.isPaylastEnabledForDesktop=b.data.isPaylastEnabledForDesktop;this.isStickyContinueButtonDesktopEnabled=b.data.isStickyContinueButtonDesktopEnabled;this.isDesktop=
"desktop"===a.options.deviceType;c.append(w.buildHiddenInput("ppw-jsEnabled","true"));this.isUpiIssuanceEnabled=b.data.isUpiIssuanceEnabled;this.isAPPIssuanceEnabled=b.data.isAPLInlineIssuanceEnabled;this.hideSpinner=b.data.hideSpinner;this.isWaitAtContinueEnabled=b.data.isWaitAtContinueEnabled;this.isAPPInstrumentRedirectionRequired=this.isUpiRedirectionRequired=!1;this.awaitingEventStatuses={};this.awaitingEventStatuses[k]=z.NotRequired;this.awaitingEventStatuses[y]=z.NotRequired;this.widgetDoneOnJSFailure=
b.data.widgetDoneOnContinueFailures;this.isRequestForMobileApp=b.data.isRequestForMobileApp;this._securePaymentMethodAddedEvent=b.data.securePaymentMethodAddedEvent;this._mobileAppSecureRegistrationTreatment=b.data.mobileAppSecureRegistrationTreatment;this._dynamicContinueEnabled=b.data.dynamicContinueEnabled;this.isPaySelectCvvSecureFieldEnabled=b.data.paySelectCvvSecureFieldEnabled;this.isMCXModernizedFrameEnabled=b.data.isMCXModernizedFrameEnabled;this.isModernizedSetPaymentPlanSelectOptimizationEnabled=
b.data.isModernizedSetPaymentPlanSelectOptimizationEnabled;this.totalBeforeSpecialString=b.data.totalBeforeSpecialString||"";this.shippingDiscountValue=parseFloat(b.data.shippingDiscountValue)||0;this.totalBeforeSpecialValue=parseFloat(b.data.totalBeforeSpecialValue)+this.shippingDiscountValue||0;this.supportedPaymentMethods=b.data.supportedPaymentMethods;this.isSkipAddCreditCardWeblabEnabled=b.data.isSkipAddCreditCardWeblabEnabled;this.mcxFloatingFooterElement=this.getDOMElement("mcx-floating-footer");
this.isEstimatedTotalEnabled=b.data.isEstimatedTotalEnabled;this.paymentsPageAdvertisementHTMLElement=this.getDOMElement("payments-page-advertisement-reference");this.paymentsPageAdvertisementWrapperHTMLElement=this.getDOMElement("payments-page-advertisement-wrapper-reference");this.paymentsPageAdvertisementHTMLContent=b.data.maybePaymentsPageAdvertisementHTMLContent;this.delegateUpiProcessing=b.data.delegateUpiProcessing;this.bypassContinueWidgetCall=b.data.bypassContinueWidgetCall;this.isINMarketplace=
b.data.isINMarketplace;var d=this;d.isRequestForMobileApp&&(console.log("listener.securePaymentMethodAddedEvent: "+d._securePaymentMethodAddedEvent),D.addEventListener(d._securePaymentMethodAddedEvent,function(a){d._addEventListenerSPPSHandler(a,"0")}),D.addEventListener("APX3RegisterSuccessEvent",function(a){d._addEventListenerSPPSHandler(a,"1")}),D.addEventListener("APX3RegisterFallbackEvent",function(a){d._addEventListenerAPX3RegisterFallbackEvent(a)}),D.addEventListener("DisableCheckoutRefreshEvent",
function(a){d._addEventListenerSPPSDisableRefresh(a)}),D.setBookmark("spps-widget"));this.isEstimatedTotalEnabled&&(this.$displayedEstimatedTotalAmountContainer=r,0<this.getDOMElement("estimated-total-value").length?this.$displayedEstimatedTotalAmountContainer=this.getDOMElement("estimated-total-value")[0]:this.$displayedEstimatedTotalAmountContainer=null,null!=this.$displayedEstimatedTotalAmountContainer&&d._updateEstimatedTotal(0));this.widget.trigger(R,{shouldShowMessageOnContinueButton:this.isINMarketplace});
G(this)},_addEventListenerSPPSHandler:function(a,b){a.detail.canProceedToSPC?this._triggerContinueButtonWithSelectedInstrument(a.detail.paymentInstrumentId,a.detail.paymentMethod,a.detail.instrumentRegistrationType):(D.backToBookmark("spps-widget"),this._disableSPPSRefreshEvent(),this._dynamicContinueEnabled?this.addPaymentMethodRefreshContinue(a.detail.paymentInstrumentId,a.detail.widgetAction,a.detail.walletId,b):this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,
"ppw-widgetEvent":"AddPaymentMethodRefreshEvent","ppw-paymentMethodId":a.detail.paymentInstrumentId,"ppw-widgetAction":a.detail.widgetAction,"ppw-maybeWalletId":a.detail.walletId,"ppw-maybeShouldRecordAPX3Metric":b}))},_addEventListenerAPX3RegisterFallbackEvent:function(a){console.log("APX3Register fallback to APX2");D.publishCountMetrics("APX3RegisterNativeFallbackEvent");this._triggerShowAddPaymentInstrumentPageEvent()},_addEventListenerSPPSDisableRefresh:function(a){console.log("Disable refresh when entering auth");
this._disableSPPSRefreshEvent()},_updatePMDetails:function(a){"Completed"===a.getPMS2SCallStatus?(this.getPMS2SCallStatus=a.getPMS2SCallStatus,this.issuingPsp=a.issuingPsp,this.responseClientContext=a.responseClientContext,this.bankTail=a.bankTail,this.mPinLength=a.mPinLength,this.paymentMethodIdVersion=a.paymentMethodIdVersion,this.deviceSignature=a.deviceSignature,this.npciKey=a.npciKey,this.customerVpa=a.customerVpa,this.bankAccountUniqueId=a.bankAccountUniqueId,this.customerMobileNumber=a.customerMobileNumber,
this.bankName=a.bankName,this.upiInstrumentId=a.instrumentId):this.getPMS2SCallStatus=a.getPMS2SCallStatus},_removePMDetails:function(){this.bankName=this.customerMobileNumber=this.bankAccountUniqueId=this.customerVpa=this.npciKey=this.deviceSignature=this.paymentMethodIdVersion=this.mPinLength=this.bankTail=this.responseClientContext=this.issuingPsp=this.getPMS2SCallStatus=null},bindToElements:function(){var a=this;if(a.isOrderTotalDisplayedInFloatingCTAContainer||a.showFloatingContinueBarOnNonPaylastPspWithViewDetails)a.getDOMElement("apx-order-total-container").click(function(b){a.widget.trigger("hideViewDetailsPopover");
a._toggleOrderSummaryFloatingContainer();"mobile"===a.widget.options.deviceType?A.redirectToCart(!1,"/gp/aw/c"):A.redirectToCart(!1,"/gp/cart/view.html")}),a.getDOMElement("apx-close-order-summary-icon").click(function(b){a._toggleOrderSummaryFloatingContainer()}),a.getDOMElement("apx-order-summary-overlay-container").click(function(b){a._toggleOrderSummaryFloatingContainer()}),c.when("A","ready").execute(function(b){b.delay(function(){a.widget.trigger("hideViewDetailsPopover")},1E4)});a.isPaylastEnabledForDesktop&&
(a.getDOMElement("order-summary-view-details-desktop").click(function(b){b=a.getDOMElement("apx-order-summary-content-desktop");var c=a.getDOMElement("apxOrderTotalLabelDesktop"),d=a.getDOMElement("apxOrderTotalDivider"),e=a.getDOMElement("apx-order-summary-error-message-desktop-container"),f=a.getDOMElement("apx-order-summary-and-error-container-desktop");b&&f&&b.hasClass("a-hidden")&&a.getDOMElement("order-summary-view-details-desktop")[0]?(a.getDOMElement("order-summary-view-details-desktop")[0].innerHTML=
a.widget.getLocalizedString("apx_order_total_hide_details"),K&&a.widget.trigger("fetchOrderSummary",{fetchCompleteOrderSummary:a.isPaymentPlanComplete,fetchOSTriggeredByViewDetails:!0}),v.toggleElement(f,!0),v.toggleElement(b,!0),""!==b[0].innerHTML&&(v.toggleElement(c,!1),v.toggleElement(d,!1)),!a.fetchCompleteOrderSummary&&e?v.showElement(e):v.hideElement(e)):(a.getDOMElement("order-summary-view-details-desktop")[0].innerHTML=a.widget.getLocalizedString("apx_order_total_view_details"),v.toggleElement(b,
!1),v.toggleElement(f,!1),v.toggleElement(c,!0),v.toggleElement(d,!0),v.hideElement(a.getDOMElement("apx-order-summary-error-message-desktop-container")))}),t(p).scroll(function(a){if(t(p)){a=t(p).scrollTop();var b=t(".pmts-payment-instruments-container-classic");b&&(b=b.offset().top,a>b?t(".apx-desktop-sticky-continue-button").addClass("apx-stick-to-top"):t(".apx-desktop-sticky-continue-button").removeClass("apx-stick-to-top"));1200>t(p).width()?t(".apx-desktop-sticky-continue-button").addClass("apx-stick-to-right"):
t(".apx-desktop-sticky-continue-button").removeClass("apx-stick-to-right")}}));a.isDesktop&&!a.isPaylastEnabledForDesktop&&a.isStickyContinueButtonDesktopEnabled&&t(p).scroll(function(a){if(t(p)){a=t(p).scrollTop();var b=t(".pmts-payment-instruments-container-classic");b&&(b=b.offset().top,a>b?t(".apx-sticky-continue-button-container-desktop").addClass("apx-desktop-stick-to-top"):t(".apx-sticky-continue-button-container-desktop").removeClass("apx-desktop-stick-to-top"))}});B.bindToElements.apply(a);
F.bindToElements.apply(a);if(L||this.showFloatingContinueBarOnNonPaylastPspWithViewDetails)a.getDOMElement("apx-order-summary-api-error-retry-button").click(function(b){var c=a.getDOMElement("payment-plan-select-form-to-submit");A.fetchOrderSummary(b.isValid,c,1)}),a.getDOMElement("apx-order-summary-api-error-retry-failed-button").click(function(b){"mobile"===a.widget.options.deviceType?A.redirectToCart(!0,"/gp/aw/c"):A.redirectToCart(!0,"/gp/cart/view.html")});a.getDOMElement("mcx-registration-touch-link").click(function(){a.widget.trigger("showRegistrationEvent")})},
bindToEvents:function(){var a=this,c={grepIdentifier:"multipleInitiateChargeInvocations",customerId:this.widget.options.customerId,widgetInstanceId:this.widget.options.widgetInstanceId,sessionId:this.widget.options.sessionId};u.forEach(["ContinueButtonClicked","SecondaryContinueButtonClicked","CompleteWidget"],function(b){a.widget.on(b,a,function(a){c.eventName=b;x.log(c);this._closeViewDetailsPopover();u.every(E,function(a){return a()})&&this._showExplicitConsentPopover()})});if(!O&&a.data.prefetchEnabled)a.widget.on(h.paymentPlanSelectedPrepare,
a,function(b){b=a.getDOMElement("payment-plan-select-form-to-submit");H.ensureWidgetEventInput(b,f)});this.widget.on("ConsentPopoverContinueButtonClicked",this,function(a){this._continueButtonClicked()});this.widget.on("UpdateSelectedCardData",this,function(a){this.selectedInstrumentId=a.instrumentId});this.widget.on("updateConsentCheckBoxStatus",this,function(a){this.consentCheckBoxStatus=a.consentCheckBoxStatus;this.isCardSelected=a.isCardSelected});this.widget.on("RemoveSetPaymentPlanSelectContinueEvent",
this,function(b){var c=a.getDOMElement("payment-plan-select-form-to-submit"),d=M.WIDGET_EVENT_KEY+M.KEY_VALUE_SEPARATOR+f;b=function(){return c.find("input[type\x3d'hidden'][name^\x3d'"+d+"']")};b().length&&b().remove()});this.widget.on(h.PaymentPlanSelected,this,function(b){this.isAPPInstrumentRedirectionRequired=this.isUpiRedirectionRequired=!1;!L&&!this.showFloatingContinueBarOnNonPaylastPspWithViewDetails||a.data.skipFormValidation&&b.paymentMethod&&"CC"===b.paymentMethod||this.widget.trigger("fetchOrderSummary",
{fetchCompleteOrderSummary:b.isValid,fetchOSTriggeredByViewDetails:!1})});this.widget.on("fetchOrderSummary",this,function(b){var c=a.getDOMElement("payment-plan-select-form-to-submit"),d=[{name:"ppw-dummyPostalCode",value:"000000"},{name:"addCreditCardVerificationNumber99",value:"123"}],e=c.closest("form");e&&e[0]&&u.forEach(d,function(a){e[0].elements[a.name]||e.append(w.buildHiddenInput(a.name,a.value))});if(this.showFloatingContinueBarOnNonPaylastPspWithViewDetails&&!b.fetchOSTriggeredByViewDetails)this.isPaymentPlanComplete=
b.fetchCompleteOrderSummary;else{if(!this.showFloatingContinueBarOnNonPaylastPspWithViewDetails&&K)if(this.isPaymentPlanComplete=b.fetchCompleteOrderSummary,b.fetchOSTriggeredByViewDetails)if(6<this.numberOfTimesPaymentMethodChanged)A.fetchOrderSummary(!b.fetchCompleteOrderSummary,c);else return;else if(b.fetchCompleteOrderSummary&&(this.numberOfTimesPaymentMethodChanged+=1),6>=this.numberOfTimesPaymentMethodChanged)A.fetchOrderSummary(!b.fetchCompleteOrderSummary,c);else return;else A.fetchOrderSummary(!b.fetchCompleteOrderSummary,
c);b.fetchCompleteOrderSummary?this.widget.trigger("HideOrderSummaryIncompletePaymentPlanErrorMessageEvent"):this.widget.trigger("ShowOrderSummaryIncompletePaymentPlanErrorMessageEvent");this.isPaylastEnabledForDesktop&&(this.fetchCompleteOrderSummary=b.fetchCompleteOrderSummary)}});a.widget.on(f,a,function(b){c.eventName=f;x.log(c);var d=a.getDOMElement("payment-plan-select-form-to-submit");b=[{name:"ppw-javaEnabled",value:p&&p.navigator&&p.navigator.javaEnabled()},{name:"ppw-language",value:p&&
p.navigator&&p.navigator.language},{name:"ppw-screenColorDepth",value:p&&p.screen&&p.screen.colorDepth},{name:"ppw-screenHeight",value:p&&p.screen&&p.screen.height},{name:"ppw-screenWidth",value:p&&p.screen&&p.screen.width},{name:"ppw-timeZone",value:(new Date).getTimezoneOffset()}];u.forEach(b,function(a){d.append(w.buildHiddenInput(a.name,a.value))});a.widget.widgetFormData=JSON.stringify(d.serializeArray());d.submit()});a.widget.on(d,a,function(b){a.orderSummaryHeaderEnabled&&a._updateOrderSummaryHeaderPaymentMethod(b.instrumentId);
var c=a.getDOMElement("redeem-claim-mobile");c.length&&(b&&"CashOnDelivery"===b.instrumentType?v.hideElement(c):v.showElement(c));v.hideElement(a.getDOMElementsByPrefix("apx-invalid-payment-plan-error-message-floating-container"));v.hideElement(a.getDOMElementsByPrefix("apx-invalid-payment-plan-error-message-container"));v.hideElement(a.getDOMElementsByPrefix("apx-emi-specific-info-message-content"));v.hideElement(a.getDOMElement("apx-order-summary-floating-container"));v.hideElement(a.getDOMElement("apx-order-summary-overlay-container"));
v.hideElement(a.getDOMElement("apx-order-summary-content"));a.isPaylastEnabledForDesktop&&a._collapseOrderSummaryContainerDesktop()});a.isPaySelectCvvSecureFieldEnabled&&N.bindToEvents.apply(a);a.widget.on("useECardEvent",a,function(b){v.showElement(this.getDOMElement("order-summary-wrapper"));a.getDOMElement("top-sidebar-wrapper").addClass("a-box-group")});a.widget.on("ShowOrderSummaryIncompletePaymentPlanErrorMessageEvent",a,function(b){a.getDOMElement("apx-order-summary-content").addClass("apx-height-55pct");
a.getDOMElement("apx-order-summary-content").removeClass("apx-height-70pct");a.getDOMElement("apx-order-summary-api-error").addClass("apx-height-55pct");a.getDOMElement("apx-order-summary-api-error").removeClass("apx-height-70pct");v.showElement(this.getDOMElement("apx-order-summary-error-message-container"))});a.widget.on("HideOrderSummaryIncompletePaymentPlanErrorMessageEvent",a,function(b){a.getDOMElement("apx-order-summary-content").removeClass("apx-height-55pct");a.getDOMElement("apx-order-summary-content").addClass("apx-height-70pct");
a.getDOMElement("apx-order-summary-api-error").removeClass("apx-height-55pct");a.getDOMElement("apx-order-summary-api-error").addClass("apx-height-70pct");v.hideElement(this.getDOMElement("apx-order-summary-error-message-container"))});a.widget.on(J,a,function(b){"mobile"!==a.widget.options.deviceType||"false"!==a.showSecondaryView||a._isOnlyCcAvailableWeblabGated()||(b||{}).isForAPX3Register||a._hideSPPS()});a.widget.on("showRegistrationEvent",a,function(b){"mobile"===a.widget.options.deviceType&&
(v.showElement(a.getDOMElement("mcx-registration-wrapper")),v.hideElement(a.getDOMElement("mcx-registration-touch-link")),a._hideSPPS())});if(a.isEstimatedTotalEnabled&&null!=this.$displayedEstimatedTotalAmountContainer)a.widget.on("updateEstimatedTotal",a,function(b){"RewardsAccount"===b.type?a._updateEstimatedTotalForRewardsAccount(b.status,b.balance,b.instrumentId,b.isValid):"ProductVoucher"===b.type?a._updateEstimatedTotalForProductVoucher(b.status,b.balance):"GC"===b.type?a._updateEstimatedTotalForGiftCard(b.status,
b.balance):"PROMO"===b.type&&a._updateEstimatedTotalForPromoBalance(b.status,b.balance)});if(this.isOrderTotalDisplayedInFloatingCTAContainer||this.showFloatingContinueBarOnNonPaylastPSP)a.widget.on("UpdateOrderTotalForIBDEvent",a,function(a){this.appliedIbdAmount=a&&a.ibdAmountDisplayed?parseFloat(a.ibdAmountDisplayed):0;this._updateDisplayedOrderTotal()}),a.widget.on("UpdateOrderTotalForAPBEvent",a,function(a){this.appliedApbBalance=a&&a.isApbSelected&&a.apbBalance?parseFloat(a.apbBalance.replace(/[^\d\.]/g,
"")):0;this._updateDisplayedOrderTotal()}),a.widget.on("UpdateOrderTotalForNoCostEMIDiscount",a,function(a){this.appliedNoCostEMIDiscount=a&&a.noCostEMIValue?parseFloat(a.noCostEMIValue):0;this._updateDisplayedOrderTotal()}),a.widget.on("UpdateOrderTotalForPromoBalanceEvent",a,function(a){this.appliedPromoBalance=a&&a.isSelected&&a.promoBalance?"string"===typeof a.promoBalance?parseFloat(a.promoBalance.replace(/[^\d\.]/g,"")):parseFloat(a.promoBalance):0;this._updateDisplayedOrderTotal()});a.widget.on("ContinueButtonClickedWithInvalidPaymentPlanEvent",
a,function(b){if("mobile"===a.widget.options.deviceType){v.hideElement(a.getDOMElementsByPrefix("apx-emi-specific-info-message-content"));var c=a.getDOMElementsByPrefix("apx-invalid-payment-plan-error-message-container");b.message||(b.message=a.widget.getLocalizedString("pmts_portal_payselect_empty_instrument_selection"));v.showElement(a.getDOMElementsByPrefix("apx-invalid-payment-plan-error-message-floating-container"));v.showElement(c);"undefined"!==typeof c[0]&&(c[0].getElementsByClassName("a-alert-content")[0].textContent=
b.message);"undefined"!==typeof c[1]&&(c[1].getElementsByClassName("a-alert-content")[0].textContent=b.message);a.isOrderTotalDisplayedInFloatingCTAContainer&&(v.hideElement(a.getDOMElement("apx-order-summary-floating-container")),v.hideElement(a.getDOMElement("apx-order-summary-overlay-container")),v.hideElement(a.getDOMElement("apx-order-summary-content")),a._toggleTextOnOrderTotalsDisplay(!1))}});a.widget.on("ChangeInAPBSelectionAfterInstallmentPlanSelectionEvent",a,function(b){if("mobile"===a.widget.options.deviceType){v.hideElement(a.getDOMElementsByPrefix("apx-invalid-payment-plan-error-message-container"));
var c=a.getDOMElementsByPrefix("apx-emi-specific-info-message-content");b.message||(b.message=a.widget.getLocalizedString("pmts_portal_payselect_empty_instrument_selection"));1<c.length&&(v.showElement(c),c[0].getElementsByClassName("a-alert-content")[0].textContent=b.message,c[1].getElementsByClassName("a-alert-content")[0].textContent=b.message)}});a.widget.on("storePaymentMethodDetailsResponse",a,function(b){a._updatePMDetails(b)});a.widget.on("removePaymentMethodDetailsResponse",a,function(b){this.upiInstrumentId===
b.instrumentId&&a._removePMDetails()});a.widget.on("updateDeviceSignatureCheckStatus",a,function(a){this.deviceSignatureCheckStatus=a.deviceSignatureCheckStatus});a.widget.on(m,a,function(a){this.awaitingEventStatuses[k]=z.Pending;a&&a.errorMessage&&(this.errorMessage=a.errorMessage)});a.widget.on(k,a,function(a){if(a){var c=this.awaitingEventStatuses[k]===z.Pending;this.awaitingEventStatuses[k]=a.instrumentPreparationStatus;this.isUpiRedirectionRequired=a.isUpiRedirectionRequired;this.isAPPInstrumentRedirectionRequired=
a.isAPPInstrumentRedirectionRequired;this.failureReason=a.failureReason;this.errorMessage=a.errorMessage;c&&(p.clearTimeout(this.awaitInstrumentPrepareTimeoutFunction),this.hideSpinner||this.widget.trigger(b.hideSpinner),this.awaitingEventStatuses[k]===z.Success?this.isPaySelectCvvSecureFieldEnabled?this._proceedWithContinueAfterEvents():this._proceedWithContinue():this._handleInstrumentPreparationFailure(this.failureReason));x.logCounterMetric({feature:"InstrumentPreparedEvent:"+a.instrumentPreparationStatus,
resource:"_Count"});x.publishMetrics()}else this._handleInstrumentPreparationFailure(z.UnknownFailure);x.logCounterMetric({feature:"InstrumentPreparedEvent",resource:"_Count"});x.publishMetrics()});a.widget.on(y,a,function(b){b.contextId===this.id&&(x.logCounterMetric({feature:"SecureFieldDataReadySuccess",resource:"_Count"}),x.publishMetrics(),a.awaitingEventStatuses[y]=z.Success,this._proceedWithContinueAfterEvents())});if(this.isUpiIssuanceEnabled)this.widget.on("UpiRedirectionRequiredEvent",this,
function(a){this.isUpiRedirectionRequired=!0});if(this.isAPPIssuanceEnabled)this.widget.on("APPRedirectionRequiredEvent",this,function(a){this.isAPPInstrumentRedirectionRequired=!0});if(this.showFloatingContinueBarOnNonPaylastPspWithViewDetails)this.widget.on("componentsInitialized",this,function(a){a=this.getDOMElement("payment-plan-select-form-to-submit");A.fetchOrderSummary(!0,a,0,!0)});if(this.showFloatingContinueBarOnNonPaylastPspWithViewDetails||this.paylastOrderSummaryEnabled)this.widget.on("UpiRedirectionRequiredEvent",
this,function(a){this.isPaymentPlanComplete=!1});a.widget.on("hideViewDetailsPopover",this,function(){this._closeViewDetailsPopover()});a.widget.on("updateRevisePaymentErrorMessage",this,function(a){a.titleStringId&&a.bodyStringId&&a.parameters&&a.notificationType&&(this._changeTextOnRevisePaymentErrorMessage(a.titleStringId,a.bodyStringId,a.parameters),this._changeNotificationTypeOnRevisePaymentErrorMessage(a.notificationType))});a.widget.on("backingInstrumentSelected",this,function(a){if(a!==r){var b=
a.paystationPaymentMethodCategory,c=a.instrumentId;this.redeemableAPBBalance=this.totalAPBBalance=this.maybeInstallmentsOfferIds=this.maybeSelectedInstallmentsOfferId=this.availableAPLBalance=r;if("AmazonPay"===b)c=a.giftCardId||a.storedValueId,this.totalAPBBalance=a.totalAPBBalance,this.redeemableAPBBalance=a.redeemableAPBBalance;else if("AmazonCredit"===b&&(this.availableAPLBalance=a.availableAPLBalance,a.installmentOfferBOsWithoutAPB!==r)){var d=a.installmentOfferBOsWithoutAPB.filter(function(a){return 1===
a.numberOfInstallments});d!==r&&0<d.length&&(this.maybeSelectedInstallmentsOfferId=d[0].financialOfferId);this.maybeInstallmentsOfferIds=a.installmentOfferBOsWithoutAPB.map(function(a){return a.financialOfferId})}this.selectedPaystationInstrumentId=c;this.selectedPaystationPaymentMethodCategory=b}});0!==this.mcxFloatingFooterElement.length&&p.chrome&&addEventListener("resize",function(){var b="0px"===a.mcxFloatingFooterElement.css("bottom")?"0.001px":"0px";a.mcxFloatingFooterElement.css("bottom",
b)});this.isRequestForMobileApp&&this.isMCXModernizedFrameEnabled&&D.hideAppOverlays();this.isModernizedSetPaymentPlanSelectOptimizationEnabled&&this.paymentsPageAdvertisementHTMLContent&&0!==this.paymentsPageAdvertisementHTMLElement.length&&0!==this.paymentsPageAdvertisementWrapperHTMLElement.length&&this.renderAdvertisementContentAfterPageLoad()},_proceedWithContinueAfterEvents:function(){Object.values(this.awaitingEventStatuses).every(function(a){return a===z.NotRequired||a===z.Success})&&this._proceedWithContinue()},
_changeTextOnRevisePaymentErrorMessage:function(a,b,c){var d=this.getDOMElement("revise-payment-error-message");d&&(d.find(".a-alert-heading")[0].innerHTML=this.widget.getLocalizedString(a,c),d.find(".a-alert-content")[0].innerHTML=this.widget.getLocalizedString(b,c))},_changeNotificationTypeOnRevisePaymentErrorMessage:function(a){var b=this.getDOMElement("revise-payment-error-message");if(b)switch(a){case "warning":b.removeClass("a-alert-success");b.addClass("a-alert-warning");break;case "success":b.removeClass("a-alert-warning"),
b.addClass("a-alert-success")}},getSecureRegistrationMobileAppTreatment:function(a){return this._mobileAppSecureRegistrationTreatment.toUpperCase()===a.toUpperCase()},_updateOrderSummaryHeaderPaymentMethod:function(a){var b=t("div[data-instrument-id\x3d'"+a+"']");a=b.find(".pmts-cc-issuer-name").data("issuer-name-short");var c=b.find(".pmts-cc-number").data("number"),b=b.find(".pmts-ba-account-tail").data("account-tail"),d=this.getDOMElement("issuer-and-tail"),e="";c!==r?e=a===r||a.isEmpty||""===
a?this.widget.getLocalizedString("apx_order_summary_header_credit_card_number_tail",{number_tail:c}):this.widget.getLocalizedString("apx_order_summary_header_payment_method_number_tail",{number_tail:c,issuer:a}):b!==r&&(e=this.widget.getLocalizedString("apx_order_summary_header_bank_account_number_tail",{number_tail:b}));d.html(e)},_showExplicitConsentPopover:function(){this.widget.trigger("validateConsentCheckBoxStatus"+this.selectedInstrumentId);this.isCardSelected&&!this.consentCheckBoxStatus?
this.widget.trigger("DisplayConsentPopover"+this.selectedInstrumentId):this._continueButtonClicked()},_shouldProceedWithContinueAfterEvents:function(){this.isPaySelectCvvSecureFieldEnabled&&(this.awaitingEventStatuses[y]=z.Pending);return this.isWaitAtContinueEnabled&&this._shouldWaitForInstrumentPreparation()||this._shouldWaitForSecureFieldData()},_shouldWaitForSecureFieldData:function(){return this.isPaySelectCvvSecureFieldEnabled&&this.widget.trigger(q,{contextId:this.id})},_continueButtonClicked:function(){this._shouldProceedWithContinueAfterEvents()||
this._proceedWithContinue()},_proceedWithContinue:function(){var a=this.getDOMElement("payment-plan-select-form-to-submit");u.isDefined(this.ajaxSubstitutionEnabled)&&this.widget.setAjaxSubstitutionEnabled(a,this.ajaxSubstitutionEnabled);if(this.widget.widgetFormData===JSON.stringify(a.serializeArray())){x.logCounterMetric({feature:"DuplicateContinueWidgetCallWithSameForm",resource:"_Count"});x.publishMetrics();if(this.isSkipContinueWithSameFormWeblabEnabled&&this.widget.processingContinueRequest)return x.logCounterMetric({feature:"DuplicateContinueWidgetCallWithSameFormRejected",
resource:"_Count"}),x.publishMetrics(),this.widget.log({multipleContinueWidgetCallsWithSameFormRejected:!0}),!1;this.widget.log({multipleContinueWidgetCallsWithSameFormAllowed:!0})}if(this.isUpiRedirectionRequired||this.isAPPInstrumentRedirectionRequired)this.widget.widgetFormData=JSON.stringify(a.serializeArray());if(this.isUpiIssuanceEnabled&&this.isUpiRedirectionRequired)return x.logCounterMetric({feature:"UpiRedirectionContinueEvent",resource:"_Count"}),x.publishMetrics(),this.widget.publishSuccessSushiMetrics({ActionType:"UpiRedirectionContinueEvent"}),
this.widget.trigger("UpiRedirectionContinueEvent"),!1;if(this.isAPPIssuanceEnabled&&this.isAPPInstrumentRedirectionRequired)return x.logCounterMetric({feature:"APPRedirectionContinueEvent",resource:"_Count"}),x.publishMetrics(),this.widget.publishSuccessSushiMetrics({ActionType:"AppRedirectionContinueEvent"}),this.widget.trigger("APPRedirectionContinueEvent"),!1;if(this.bypassContinueWidgetCall)return a={bypassContinueWidgetCall:!0},this.delegateUpiProcessing&&"Completed"===this.getPMS2SCallStatus?
(a.delegateUPIProcessing=!0,a.upiPMDetails={getPMS2SCallStatus:this.getPMS2SCallStatus,issuingPsp:this.issuingPsp,responseClientContext:this.responseClientContext,bankTail:this.bankTail,mPinLength:this.mPinLength,paymentMethodIdVersion:this.paymentMethodIdVersion,deviceSignature:this.deviceSignature,npciKey:this.npciKey,customerVpa:this.customerVpa,bankAccountUniqueId:this.bankAccountUniqueId,customerMobileNumber:this.customerMobileNumber,bankName:this.bankName,instrumentId:this.upiInstrumentId}):
(a.delegateUPIProcessing=!1,a.selectedPMDetails={selectedPaystationPaymentMethodCategory:this.selectedPaystationPaymentMethodCategory,selectedPaystationInstrumentId:this.selectedPaystationInstrumentId,availableAPLBalance:this.availableAPLBalance,totalAPBBalance:this.totalAPBBalance,redeemableAPBBalance:this.redeemableAPBBalance,maybeInstallmentsOfferIds:this.maybeInstallmentsOfferIds,maybeSelectedInstallmentsOfferId:this.maybeSelectedInstallmentsOfferId}),this.widget.publishSuccessSushiMetrics({ActionType:"SetPaymentPlanSelectContinueEvent"}),
this.widget.trigger(f,a),this.widget.trigger("Done",{WidgetResponseStatusCode:"200",delegatedPaymentMethodProcessing:!0}),!1;H.ensureWidgetEventInput(a,f);x.logLatencyMetric({feature:this.isJigsawEligible?"TimeSpentOnSteeringPSP":"TimeSpentOnRegularPSP",resource:"_Latency",startTime:PaymentsPortal2.widgetStartTime});x.publishMetrics();this.widget.publishSuccessSushiMetrics({ActionType:"SetPaymentPlanSelectContinueEvent"});this.widget.trigger(f)},_shouldWaitForInstrumentPreparation:function(){this.awaitingEventStatuses[k]=
z.NotRequired;this.failureReason=this.errorMessage=null;this.widget.trigger(a);if(this.awaitingEventStatuses[k]===z.NotRequired||this.awaitingEventStatuses[k]===z.Success)return!1;if(this.awaitingEventStatuses[k]===z.Failure)return this._firePreparedInstrumentContinueError(this.failureReason),!0;if(this.awaitingEventStatuses[k]===z.Pending){this.hideSpinner||this.widget.trigger(b.showSpinner);var c=this;c.delegateUpiProcessing&&c.awaitingEventStatuses[k]!==z.Pending&&"Pending"!==c.deviceSignatureCheckStatus&&
(P=2E3);c.awaitInstrumentPrepareTimeoutFunction=p.setTimeout(function(){c.awaitingEventStatuses[k]===z.Pending&&"Pending"===c.deviceSignatureCheckStatus?c._handleInstrumentPreparationFailure(z.TimedOut):(c.awaitingEventStatuses[k]===z.Pending&&"Pending"===c.getPMS2SCallStatus&&(c.getPMS2SCallStatus="TimedOut"),c._proceedWithContinue());c.hideSpinner||c.widget.trigger(b.hideSpinner)},P);return!0}return!1},_handleInstrumentPreparationFailure:function(a){this.awaitingEventStatuses[k]=z.Failure;this._firePreparedInstrumentContinueError(a)},
_firePreparedInstrumentContinueError:function(a){this.widget.trigger(e,{reason:a});this.widgetDoneOnJSFailure&&this.widget.trigger(l);this.errorMessage&&this.widget.trigger("ContinueButtonClickedWithInvalidPaymentPlanEvent",{message:this.errorMessage})},_toggleOrderSummaryFloatingContainer:function(){var a=this.getDOMElement("apx-order-summary-content"),b=this.getDOMElement("apx-order-summary-floating-container"),c=this.getDOMElement("apx-order-summary-overlay-container"),d=!1;b.hasClass("a-hidden")&&
(d=!0,x.logCounterMetric({feature:"PaylastOrderSummaryApiLoadView",resource:"_Count"}));v.toggleElement(b,d);v.toggleElement(a,d);v.toggleElement(c,d);v.toggleElement(this.getDOMElement("apx-invalid-payment-plan-error-message-floating-container"),!d);this._toggleTextOnOrderTotalsDisplay(d);x.publishMetrics()},_toggleTextOnOrderTotalsDisplay:function(a){a&&this.getDOMElement("apx-order-summary-view-details")[0]?(this.getDOMElement("apx-order-summary-view-details")[0].innerHTML=this.widget.getLocalizedString("apx_order_total_hide_details"),
(K||this.showFloatingContinueBarOnNonPaylastPspWithViewDetails)&&this.widget.trigger("fetchOrderSummary",{fetchCompleteOrderSummary:this.isPaymentPlanComplete,fetchOSTriggeredByViewDetails:!0})):this.getDOMElement("apx-order-summary-view-details")[0].innerHTML=this.widget.getLocalizedString("apx_order_total_view_details")},_updateEstimatedTotalForPromoBalance:function(a,b){this._updateAppliedTotalValueAndToggleStatus("promoBalance",a,b)},_updateEstimatedTotalForGiftCard:function(a,b){this._updateAppliedTotalValueAndToggleStatus("giftCard",
a,b)},_updateEstimatedTotalForProductVoucher:function(a,b){(b=b.match(/[\d]*[.]{0,1}[\d]+/))&&this._updateAppliedTotalValueAndToggleStatus("productVoucher",a,b[0])},_updateAppliedTotalValueAndToggleStatus:function(a,b,c){"promoBalance"===a?b&&!this.isPromoBalanceSelected?(this.isPromoBalanceSelected=!0,this.appliedTotalValue+=parseFloat(c)):!b&&this.isPromoBalanceSelected&&(this.isPromoBalanceSelected=!1,this.appliedTotalValue-=parseFloat(c)):"giftCard"===a?b&&!this.isGiftCardSelected?(this.isGiftCardSelected=
!0,this.appliedTotalValue+=parseFloat(c)):!b&&this.isGiftCardSelected&&(this.isGiftCardSelected=!1,this.appliedTotalValue-=parseFloat(c)):"productVoucher"===a&&(b&&!this.isProductVoucherSelected?(this.isProductVoucherSelected=!0,this.appliedTotalValue+=parseFloat(c)):!b&&this.isProductVoucherSelected&&(this.isProductVoucherSelected=!1,this.appliedTotalValue-=parseFloat(c)));this._updateEstimatedTotal(this.appliedTotalValue)},_updateEstimatedTotalForRewardsAccount:function(a,b,c,d){d&&a&&!this.isRewardsAccountSelected?
(this.isRewardsAccountSelected=!0,this.currentRA=c,this.appliedRewardsValue=parseFloat(b),this.appliedTotalValue+=this.appliedRewardsValue,this._updateEstimatedTotal(this.appliedTotalValue)):a&&this.isRewardsAccountSelected?this.currentRA===c&&d?(this.appliedTotalValue-=this.appliedRewardsValue,this.appliedRewardsValue=parseFloat(b),this.appliedTotalValue+=this.appliedRewardsValue,this._updateEstimatedTotal(this.appliedTotalValue)):this.currentRA!==c&&(d?(this.currentRA=c,this.appliedTotalValue-=
this.appliedRewardsValue,this.appliedRewardsValue=parseFloat(b),this.appliedTotalValue+=this.appliedRewardsValue,this._updateEstimatedTotal(this.appliedTotalValue)):(this.currentRA=c,this.appliedTotalValue-=this.appliedRewardsValue,this._updateEstimatedTotal(this.appliedTotalValue),this.appliedRewardsValue=0)):!a&&this.isRewardsAccountSelected&&this.currentRA===c&&(this.isRewardsAccountSelected=!1,this.appliedTotalValue-=this.appliedRewardsValue,this._updateEstimatedTotal(this.appliedTotalValue),
this.appliedRewardsValue=0,this.currentRA="")},_updateEstimatedTotal:function(a){a=this.totalBeforeSpecialValue-a;0>a&&(a=0);this.$displayedEstimatedTotalAmountContainer.innerHTML=this._getAdjustedEstimatedTotalCurrency(a)},_getAdjustedEstimatedTotalCurrency:function(a){a=a.toLocaleString(this.localStringFormat,{minimumFractionDigits:this.DECIMAL_PLACES,maximumFractionDigits:this.DECIMAL_PLACES});return this.totalBeforeSpecialString.replace(/[,.]/g,"").replace(/\d+/g,a)},_updateDisplayedOrderTotal:function(){var a=
this.adjustedOrderTotalAmount-this.appliedIbdAmount-this.appliedApbBalance-this.appliedPromoBalance-this.appliedNoCostEMIDiscount;0>a&&(a=0);var a=this._getDisplayedOrderCurrency(a),b=this.getDOMElement("apx-order-total-container")[0],c=this.getDOMElement("apxOrderTotalLabelDesktop")[0];b&&(b.getElementsByClassName("apx-order-total-currency-container")[0].innerHTML=a);c&&(c.getElementsByClassName("apx-order-total-currency-container")[0].innerHTML=a,this._collapseOrderSummaryContainerDesktop())},_getDisplayedOrderCurrency:function(a){if("IN"===
this.countryCode||!this.adjustedDisplayOrderTotalString)return" "+Math.round(a).toLocaleString("en-IN");a=a.toFixed(this.DECIMAL_PLACES);return this.adjustedDisplayOrderTotalString.replace(/[,.]/g,"").replace(/\d+/g,a)},_collapseOrderSummaryContainerDesktop:function(){var a=this.getDOMElement("apx-order-summary-content-desktop"),b=this.getDOMElement("apxOrderTotalLabelDesktop"),c=this.getDOMElement("order-summary-view-details-desktop"),d=this.getDOMElement("apxOrderTotalDivider"),e=this.getDOMElement("apx-order-summary-error-message-desktop-container"),
f=this.getDOMElement("apx-order-summary-and-error-container-desktop");c&&(c[0].innerHTML=this.widget.getLocalizedString("apx_order_total_view_details"));a&&v.toggleElement(a,!1);b&&v.toggleElement(b,!0);d&&v.toggleElement(d,!0);e&&v.hideElement(e);f&&v.hideElement(f)},_closeViewDetailsPopover:function(){var a=this.getDOMElement("apx-view-order-summary-popover"),b=this.getDOMElement("apx-view-order-summary-popover-down-arrow");a&&(v.toggleElement(a,!1),v.toggleElement(b,!1))},_hideSPPS:function(){v.hideElement(this.getDOMElement("payment-option-list-alert-messages"));
v.hideElement(this.getDOMElement("payselect-title"));v.hideElement(this.getDOMElement("payment-option-list-page"));v.hideElement(this.getDOMElement("balances-and-secondary-button"));v.hideElement(this.getDOMElement("mcx-floating-footer"))},_isOnlyCcAvailableWeblabGated:function(){if(!this.isSkipAddCreditCardWeblabEnabled)return!1;var a=this.supportedPaymentMethods.filter(this.filterPaymentMethods),b=1===a.length,a=a.includes("CC");return b&&a},_disableSPPSRefreshEvent:function(){if(!t("#stop-mash-reappear").length){var a=
document.createElement("div");a.id="stop-mash-reappear";t("body").append(a)}},_triggerShowAddPaymentInstrumentPageEvent:function(){this.widget.trigger(J)},filterPaymentMethods:function(a){return"GC"!==a&&"DC"!==a},renderAdvertisementContentAfterPageLoad:function(){var a=this;c.when("jQuery","load").execute(function(){a.paymentsPageAdvertisementHTMLElement.html(a.paymentsPageAdvertisementHTMLContent);v.showElement(a.paymentsPageAdvertisementWrapperHTMLElement)})},_triggerContinueButtonWithSelectedInstrument:function(a,
b,c){this._upsertSelectedPaymentInForm(a,b,c);this._attachSPCTransitionObservers();this.widget.trigger(f,{})},_upsertSelectedPaymentInForm:function(a,b,c){var d=this.getDOMElement("payment-plan-select-form-to-submit");Array.from(d[0].elements).forEach(function(a){"ppw-instrumentRowSelection"===a.name&&"radio"===a.type&&(a.checked=!1)});a=this._buildEncodedInstrumentRowSelection(a,b);d.append(w.buildHiddenInput("ppw-instrumentRowSelection",a));d.append(w.buildHiddenInput("ppw-instrumentRegistrationType",
c))},_buildEncodedInstrumentRowSelection:function(a,b){return"instrumentId\x3d"+a+"\x26"+("paymentMethod\x3d"+b)},_attachSPCTransitionObservers:function(){(new MutationObserver(function(a,b){a.forEach(function(a){Array.from(a.addedNodes).forEach(function(a){1===a.nodeType&&0<a.querySelectorAll("#address-select, #checkout-payment-option-block").length&&(D.backToBookmark("spps-widget"),b.disconnect())})})})).observe(document.body,{attributes:!1,childList:!0,subtree:!0})}})});l("components/SetPaymentPlanSelectComponent/validators",
[],function(){return[]});l("events/SetPaymentPlanSelectContinueEvent",["public-event-registry"],function(c){c.register("SetPaymentPlanSelectContinueEvent");return"SetPaymentPlanSelectContinueEvent"});l("events/SetPaymentPlanTrial",["public-event-registry"],function(c){c.register("SetPaymentPlanTrialEvent");return"SetPaymentPlanTrialEvent"});l("events/ShowMessageOnContinueButton",["public-event-registry"],function(c){c.register("ShowMessageOnContinueButton");return"ShowMessageOnContinueButton"});l("events/ValidateInstrumentPreparationEvent",
["public-event-registry"],function(c){c.register("ValidateInstrumentPreparation");return"ValidateInstrumentPreparation"});l("components/SetPaymentPlanSelectWorkflowComponent",["workflow-component"],function(c){return c.extend()});l("components/SetPaymentPreferenceComponent",["workflow-component","lang","mash-helper","mixins/secure-container-support"],function(c,d,f,h){return c.extend(h,{initialize:function(c,a){this._isRequestForMobileApp=a.data.isRequestForMobileApp;this._securePaymentMethodAddedEvent=
a.data.securePaymentMethodAddedEvent;this._dynamicContinueEnabled=a.data.dynamicContinueEnabled;var d=this;d._isRequestForMobileApp&&(f.addEventListener(d._securePaymentMethodAddedEvent,function(a){d._addEventListenerSPPHandler(a)}),f.setBookmark("spp-widget"))},_addEventListenerSPPHandler:function(c){this._dynamicContinueEnabled?this.addPaymentMethodRefreshContinue(c.detail.paymentInstrumentId,c.detail.widgetAction):this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,
"ppw-widgetEvent":"AddPaymentMethodRefreshEvent","ppw-paymentMethodId":c.detail.paymentInstrumentId,"ppw-widgetAction":c.detail.widgetAction});f.backToBookmark("spp-widget")}})});l("components/PaymentPreferenceSummaryComponent",["lang","continuable-component","public-event-registry","events/SelectedInstrumentIdsEvent","events/SelectedBillingAddressIdEvent"],function(c,d,f,h,g){return d.extend({_selectedInstrumentIds:[],_selectedBillingAddressId:r,initialize:function(a,c){this._selectedInstrumentIds=
c.data.selectedInstrumentIds;this._selectedBillingAddressId=c.data.selectedBillingAddressId;f.register(h);f.register(g)},bindToEvents:function(){var a=this;a.widget.on("componentsInitialized",a,function(){a.setContinuable(!0);a.widget.trigger(h,{instrumentIds:a._selectedInstrumentIds});a._selectedBillingAddressId!==r?a.widget.trigger(g,{billingAddressId:a._selectedBillingAddressId,error:null}):a.widget.trigger(g,{billingAddressId:a._selectedBillingAddressId,error:"Failed to get billing addressId"})});
a.widget.on(a.data.eventCompleteWidget,a,function(){a.widget.continueRequest({"ppw-widgetState":a.widget.options.serializedState,"ppw-widgetEvent":a.data.savePreferenceEvent},{success:a.widget.createAjaxContinueSuccessHandler()})})}})});l("events/SelectedBillingAddressIdEvent",[],function(){return"SelectedBillingAddressIdEvent"});l("events/SelectedInstrumentIdsEvent",[],function(){return"SelectedInstrumentIdsEvent"});l("components/SetPaymentPreferenceSelectComponent","css-utils form-helper jQuery component lang AddPaymentMethodTouchLinkSupport events/ShowAddPaymentInstrumentPage".split(" "),
function(c,d,f,h,g,a,m){return h.extend(a,{_showSecondaryView:!1,_deviceType:"desktop",initialize:function(a,c){this._showSecondaryView=c.data.showSecondaryView;this._deviceType=a.options.deviceType},bindToEvents:function(){var a=this;a.widget.on("ContinueButtonClicked",a,function(c){a.widget.trigger("ManualFormSubmission")});a.widget.on("SecondaryContinueButtonClicked",a,function(c){a.widget.trigger("ManualFormSubmission")});a.widget.on("CompleteWidget",a,function(c){a.widget.trigger("ManualFormSubmission")});
a.widget.on("ManualFormSubmission",a,function(){var c=a.getDOMElement("payment-preference-select-form-to-submit");d.ensureWidgetEventInput(c,"PreferencePaymentOptionSelectionEvent");c.submit()});a.widget.on(m,a,function(d){"mobile"===a._deviceType&&"false"===a._showSecondaryView&&(c.hideElement(a.getDOMElement("payselect-title")),c.hideElement(a.getDOMElement("payment-option-list-page")),c.hideElement(a.getDOMElement("balances-and-secondary-button")))})}})});l("components/SetPayNowInstrumentSelectComponent",
"css-utils form-helper jQuery component lang AddPaymentMethodTouchLinkSupport events/InstrumentRowSelectedEvent events/ShowAddPaymentInstrumentPage".split(" "),function(c,d,f,h,g,a,m,k){return h.extend(a,{_showSecondaryView:!1,_deviceType:"desktop",_enableDisclaimer:!0,_arvatoDisclaimerDisplayablePaymentMethodCodesArray:[],_paymentMethodCode:null,_isDisclaimerHidden:!1,_addedInstrumnetEvent:!1,_addInstrumnetEvent:!1,_isIdealSameBankAccountErrorEnabled:!1,initialize:function(a,b){this._showSecondaryView=
b.data.showSecondaryView;this._deviceType=a.options.deviceType;this._arvatoDisclaimerDisplayablePaymentMethodCodesArray=b.data.arvatoDisclaimerDisplayableArray;if(this._isIdealSameBankAccountErrorEnabled=b.data.isIdealSameBankAccountErrorEnabled)this._addedInstrumnetEvent=b.data.addedInstrumnetEvent,this._addInstrumnetEvent=b.data.addInstrumnetEvent},_displayDisclaimer:function(){var a=this.getDOMElement("pay-now-arvato-disclaimer-checkbox");this._enableDisclaimer?c.showElement(a):c.hideElement(a);
this._setIsDisclaimerHidden()},bindToElements:function(){var a=this;this.$checkbox=this.getDOMElement("pay-now-arvato-disclaimer-checkbox").find("input");a.$checkbox.change(function(){this._isDisclaimerHidden||f(".pmts-arvato-disclaimer input[type\x3dcheckbox]").is(":checked")?a._enableContinueButton():a._disableContinueButton()});this._isIdealSameBankAccountErrorEnabled&&"mobile"===this._deviceType&&!0===this._addInstrumnetEvent&&!1===this._addedInstrumnetEvent&&a._idealDuplicateInstrumentError()},
_checkPaymentMethodCode:function(){this._enableDisclaimer=this._paymentMethodCode&&this._arvatoDisclaimerDisplayablePaymentMethodCodesArray&&0!==this._arvatoDisclaimerDisplayablePaymentMethodCodesArray.length?this._arvatoDisclaimerDisplayablePaymentMethodCodesArray.includes(this._paymentMethodCode):!0},_onInstrumentSelected:function(){this._checkPaymentMethodCode();this._displayDisclaimer();this._arvatoDisclaimerCheckBoxChecked=f(".pmts-arvato-disclaimer input[type\x3dcheckbox]").is(":checked");this._isDisclaimerHidden||
this._arvatoDisclaimerCheckBoxChecked?this._enableContinueButton():this._disableContinueButton()},_setIsDisclaimerHidden:function(){this._isDisclaimerHidden=c.hasAUIHiddenClass(this.getDOMElement("pay-now-arvato-disclaimer-checkbox"))},bindToEvents:function(){var a=this;a.widget.on("ContinueButtonClicked",a,function(b){a.widget.trigger("ManualFormSubmission")});a.widget.on("ManualFormSubmission",a,function(){var b=a.getDOMElement("pay-now-instrument-select-form-to-submit");d.ensureWidgetEventInput(b,
"PayNowInstrumentSelectionEvent");b.submit()});a.widget.on(k,a,function(b){"mobile"===a._deviceType&&"false"===a._showSecondaryView&&(c.hideElement(a.getDOMElement("payselect-title")),c.hideElement(a.getDOMElement("payment-option-list-page")))});g.forEach(["initializeRecommendedInstrument",m],function(b){a.widget.on(b,a,function(b){a._paymentMethodCode=b.paymentMethod;a._onInstrumentSelected()})})},_disableContinueButton:function(){if("mobile"!==this._deviceType)f(".pmts-sidebar-wrapper .a-box-inner").css("pointer-events",
"none"),f(".pmts-sidebar-wrapper .a-box-inner").addClass("a-button-disabled");else{var a="#"+this._elementReferences["pay-now-mobile-instrument-select-continue-button"]+" .pmts-portal-component";f(a).css("pointer-events","none");f(a).addClass("a-button-disabled")}},_idealDuplicateInstrumentError:function(){this.widget.trigger(k)},_enableContinueButton:function(){if("mobile"!==this._deviceType)f(".pmts-sidebar-wrapper .a-box-inner").css("pointer-events",""),f(".pmts-sidebar-wrapper .a-box-inner").removeClass("a-button-disabled");
else{var a="#"+this._elementReferences["pay-now-mobile-instrument-select-continue-button"]+" .pmts-portal-component";f(a).css("pointer-events","");f(a).removeClass("a-button-disabled")}}})});l("components/SidebarContinueButtonComponent",["components/ContinueButtonComponent","popover","clog","lang"],function(c,d,f,h){return c.extend({initialize:function(c,a){this.metricName=a.data.metricName;this.popover=new d(this.getDOMElement(this.continueButton),{position:"triggerLeft",closeButton:!1},{position:"triggerLeft"})},
bindToElements:function(){var d=this;h.bind(c.prototype.bindToElements,d).apply();d.getDOMElement("apx-verify-later-button").click(function(){d.metricName!==r&&null!==d.metricName&&""!==d.metricName&&(f.logCounterMetric({feature:d.metricName+".VerifyLater",resource:"_Count"}),f.publishMetrics())})}})});l("components/PayNowComponent",["component","css-utils"],function(c,d){return c.extend({bindToElements:function(){var c=this;c.getDOMElement("changePaymentMethod").click(function(){c.widget.trigger("changePaymentMethodEvent")})},
bindToEvents:function(){var c=this;c.widget.on("changePaymentMethodEvent",c,function(d){c.widget.submitFormAJAX({"ppw-widgetEvent":"SelectPayNowPaymentMethodEvent","ppw-widgetState":c.widget.options.serializedState})});c.widget.on("componentsInitialized",c,function(h){d.showElement(c.getDOMElement("payNowSummaryContainer"))})}})});l("components/PayNowSelectedIDealComponent",["component","css-utils"],function(c,d){return c.extend({})});l("components/PayNowSelectedSepaDDComponent",["component","css-utils"],
function(c,d){return c.extend({})});l("components/StatementDetailsComponent",["component","css-utils"],function(c,d){return c.extend({bindToElements:function(){var c=this;c.getDOMElement("printInvoiceLink").click(function(){var d=[c.getDOMElement("payNowComponent"),c.getDOMElement("beneficiaryExpander"),c.getDOMElement("invoicePaymentMethodDivider"),c.getDOMElement("headerAlerts"),c.getDOMElement("mandateDetails"),c.getDOMElement("faqSection")];c.hideElementsIfExists(d);p.print();c.unhideElementsIfExists(d)})},
bindToEvents:function(){var c=this;c.widget.on("componentsInitialized",c,function(h){d.hideElement(c.getDOMElement("statementDetailsAsyncSpinner"))})},hideElementsIfExists:function(c){c.filter(Boolean).forEach(function(c){c.css("display","none")})},unhideElementsIfExists:function(c){c.filter(Boolean).forEach(function(c){c.css("display","block")})}})});l("components/StickyContinueButtonAndOrderSummaryComponent","component jQuery css-utils events/InstrumentRowSelectedEvent form-constants form-helper ExecutionsWidgetUtils lang events/SetPaymentPlanSelectContinueEvent events/SelectablePaymentOptionEvents clog".split(" "),
function(c,d,f,h,g,a,m,k,e,b,l){var q=null,r="",v="",t="",C={};return c.extend({initialize:function(a,b){this.isStickyContinueButtonEnabled=b.data.isStickyContinueButtonEnabled;this.isAddOrderSummaryToStickyContinueButtonEnabled=b.data.isAddOrderSummaryToStickyContinueButtonEnabled;this.isDynamicOrderSummaryEnabled=b.data.isDynamicOrderSummaryEnabled;this.grandTotalCurrencySymbol=b.data.grandTotalCurrencySymbol;this.isDesktop="desktop"===a.options.deviceType;this.isMobile="mobile"===a.options.deviceType;
this.isPaymentPlanComplete=!1;this.stickyOrderSummaryHideDetailsString=a.getLocalizedString("apx_order_total_hide_details");this.stickyOrderSummaryViewDetailsString=a.getLocalizedString("apx_order_total_view_details");this.invalidPaymentPlanEventErrorMessage=a.getLocalizedString("pmts_portal_payselect_empty_instrument_selection");this.enterCVVMessages=[a.getLocalizedString("pmts_portal_add_instrument_credit_card_error_security_code_invalid"),a.getLocalizedString("emi_invalid_verification_error")];
this.staticOrderTotal=parseFloat(b.data.staticOrderTotal)},bindToEvents:function(){var a=this;a.isDesktop&&a.isStickyContinueButtonEnabled&&d(p).scroll(function(a){if(d(p)){a=d(p).scrollTop();var b=d(".pmts-payment-instruments-container-classic");b&&(b=b.offset().top,a>b?d(".sticky-continue-button-and-order-summary-container-desktop").addClass("desktop-stick-to-top-right"):d(".sticky-continue-button-and-order-summary-container-desktop").removeClass("desktop-stick-to-top-right"))}});a.isMobile&&a.isStickyContinueButtonEnabled&&
(a.widget.on("ContinueButtonClickedWithInvalidPaymentPlanEvent",a,function(b){var c=a.getDOMElement("apx-invalid-payment-plan-error-message-container");b.message||(b.message=a.invalidPaymentPlanEventErrorMessage);f.showElement(c);"undefined"!==typeof c[0]&&(c[0].getElementsByClassName("a-alert-content")[0].textContent=b.message)}),a.widget.on(h,a,function(b){f.hideElement(a.getDOMElement("apx-invalid-payment-plan-error-message-container"))}));a.isDynamicOrderSummaryEnabled&&(a.widget.on(b.PaymentPlanSelected,
a,function(b){t=b.instrumentId;C=b.selectedOptionalInstruments;var c=b.isValid,d=a.isInstrumentSelectionChanged(b.instrumentId);if("CC"!==b.paymentMethod||null!==b.message&&!a.enterCVVMessages.includes(b.message))v="";else if(d)c=!0;else return;a.widget.trigger("FetchOrderSummaryDataEvent",{isPaymentPlanComplete:c})}),a.widget.on("installmentOptionChanged",a,function(){a.widget.trigger("FetchOrderSummaryDataEvent",{isPaymentPlanComplete:!0})}),k.forEach(["UpiRedirectionRequiredEvent","APPRedirectionRequiredEvent"],
function(b){a.widget.on(b,a,function(b){a.widget.trigger("FetchOrderSummaryDataEvent",{isPaymentPlanComplete:!1});v=""})}),a.widget.on("FetchOrderSummaryDataEvent",a,function(b){a.updateEstimatedOrderTotal();(a.isPaymentPlanComplete=b.isPaymentPlanComplete)?(a.toggleIncompletePaymentPlanContainer(!1),a.fetchOrderSummaryData()):(q&&(q.abort(),l.logCounterMetric({feature:"FetchOrderSummaryDataRequestAborted",resource:"_Count"})),a.toggleIncompletePaymentPlanContainer(!0),a.toggleOrderSummaryContent(!1),
a.toggleOrderSummaryRetryContainer(!1),a.toggleOrderSummarySpinner(!1));l.publishMetrics()}))},bindToElements:function(){var a=this;a.isMobile&&a.isAddOrderSummaryToStickyContinueButtonEnabled&&(a.getDOMElement("apx-sticky-order-total-and-view-details-mobile").click(function(){a.toggleStickyOrderSummaryContainer();l.logCounterMetric({feature:"OrderSummaryViewDetailsClicked",resource:"_Count"});l.publishMetrics()}),a.getDOMElement("apx-sticky-order-summary-close-icon").click(function(){a.toggleStickyOrderSummaryContainer()}),
a.getDOMElement("apx-sticky-order-summary-overlay-container").click(function(){a.toggleStickyOrderSummaryContainer()}));a.isDynamicOrderSummaryEnabled&&(a.getDOMElement("apx-sticky-order-summary-retry-button").click(function(){a.widget.trigger("FetchOrderSummaryDataEvent",{isPaymentPlanComplete:a.isPaymentPlanComplete});l.logCounterMetric({feature:"FetchOrderSummaryDataRequestRetry",resource:"_Count"})}),l.publishMetrics())},updateEstimatedOrderTotal:function(){var a=this;if("undefined"==typeof t||
"undefined"==typeof C)var b=a.staticOrderTotal.toLocaleString("en-IN",{useGrouping:!0,minimumFractionDigits:2});else{var b=a._getInstrumentHiddenInputValue(t),c=0;k.forEachKeyValue(C,function(b,d){b&&d&&d.instrumentId&&(c+=a._getInstrumentHiddenInputValue(b))});b=parseFloat(b)+parseFloat(c);b=(0>a.staticOrderTotal+b?0:a.staticOrderTotal+b).toLocaleString("en-IN",{useGrouping:!0,minimumFractionDigits:2})}this.updateGrandTotalAmount(b,a.grandTotalCurrencySymbol+b)},_getInstrumentHiddenInputValue:function(a){a=
document.getElementsByName("ppw-"+a+"_instrumentOrderTotalBalance")[0];var b=0;try{var c=a&&a.value?a.value.toString():JSON.stringify({}),d=JSON.parse(c),e;for(e in d)b+=parseFloat(d[e])}catch(f){console.log(f)}finally{return b}},toggleStickyOrderSummaryContainer:function(a){var b=this.getDOMElement("apx-sticky-order-summary-container"),c=this.getDOMElement("apx-sticky-order-summary-overlay-container"),d=this.getDOMElement("apx-invalid-payment-plan-error-message-container");"undefined"===typeof a&&
b.hasClass("a-hidden")&&(a=!0);f.toggleElement(b,a);f.toggleElement(c,a);f.toggleElement(d,!1);this.toggleTextOnOrderTotalsDisplay(a)},toggleTextOnOrderTotalsDisplay:function(a){var b=this.getDOMElement("apx-sticky-order-summary-view-details")[0];b&&(b.innerHTML=a?this.stickyOrderSummaryHideDetailsString:this.stickyOrderSummaryViewDetailsString)},toggleOrderSummarySpinner:function(a){var b=this.getDOMElement("apx-sticky-order-summary-spinner");f.toggleElement(b,a)},toggleIncompletePaymentPlanContainer:function(a){var b=
this.getDOMElement("apx-sticky-order-summary-incomplete-payment-plan");f.toggleElement(b,a)},toggleOrderSummaryRetryContainer:function(a){var b=this.getDOMElement("apx-sticky-order-summary-retry-container");f.toggleElement(b,a)},toggleOrderSummaryContent:function(a){var b=this.getDOMElement("apx-sticky-order-summary-content");f.toggleElement(b,a)},fetchOrderSummaryData:function(){var a=this,b=(new Date).getTime(),c=a.getPaymentPlanSelectionFormData(),d=a.getDOMElement("apx-sticky-order-summary-purchase-category");
c["ppw-purchaseCategory"]=d?d.val():"";q=a.widget.asyncContinueRequest(c,{beforeSend:function(){q&&(q.abort(),l.logCounterMetric({feature:"FetchOrderSummaryDataRequestAborted",resource:"_Count"}));a.toggleOrderSummarySpinner(!0);a.toggleOrderSummaryRetryContainer(!1);a.toggleOrderSummaryContent(!1)},success:function(c){try{var d=JSON.parse(c.additionalWidgetResponseData.additionalData.subtotals),e=JSON.parse(c.additionalWidgetResponseData.additionalData.grandTotal);a.updateOrderSummaryData(e,d);a.toggleOrderSummaryRetryContainer(!1);
l.logCounterMetric({feature:"FetchOrderSummaryDataRequestSuccessful",resource:"_Count"});l.logLatencyMetric({feature:"FetchOrderSummaryDataRequestSuccessful",resource:"_Latency",startTime:b})}catch(f){l.logCounterMetric({feature:"FetchOrderSummaryDataRequestException",resource:"_Count"}),l.logLatencyMetric({feature:"FetchOrderSummaryDataRequestException",resource:"_Latency",startTime:b}),a.toggleOrderSummaryRetryContainer(!0),a.toggleOrderSummaryContent(!1)}finally{a.toggleOrderSummarySpinner(!1)}},
error:function(){a.toggleOrderSummaryRetryContainer(!0);a.toggleOrderSummaryContent(!1);a.toggleOrderSummarySpinner(!1);l.logCounterMetric({feature:"FetchOrderSummaryDataRequestError",resource:"_Count"});l.logLatencyMetric({feature:"FetchOrderSummaryDataRequestError",resource:"_Latency",startTime:b})},retryLimit:0})},updateOrderSummaryData:function(a,b){var c=Object.keys(b).length,d=parseFloat(a.grandTotal.currency.value).toLocaleString("en-IN",{useGrouping:!0,minimumFractionDigits:2});a=a.grandTotal.currency.displayString;
var e=this.getDOMElement("apx-sticky-order-summary-line-items"),f=e.children().first().clone();e.children().remove();for(var g in b)if(!(2<c&&"itemDiscount"===g)){var h=b[g].maybeStringIdParams,k=this.widget.getLocalizedString(b[g].stringId);h&&(k=this.widget.getLocalizedString(b[g].stringId,h));h=b[g].currency.displayString;h.includes("-")&&(h="-"+h.replace("-",""));var m=f.clone(),p=m.find(".sticky-subtotal-label-text"),q=m.find(".sticky-subtotal-amount-value");p.html(k);q.html(h);e.append(m)}this.toggleOrderSummaryContent(!0);
(b=this.getDOMElement("apx-sticky-order-total-amount")[0])&&a!==b.innerHtml&&l.logCounterMetric({feature:"FetchOrderSummaryDataGrandTotalMismatch",resource:"_Count"});this.updateGrandTotalAmount(d,a)},updateGrandTotalAmount:function(a,b){var c=this.getDOMElement("apx-sticky-order-total-amount-mobile")[0],e=this.getDOMElement("apx-sticky-order-total-amount")[0],f=d(".continue-button-text")[0];c&&(c.innerHTML=this.widget.getLocalizedString("apx_currency_symbol_and_amount_with_space",{currency_symbol:this.grandTotalCurrencySymbol,
amount:a}));f&&this.isDesktop&&(f.innerHTML=this.widget.getLocalizedString("apx_continue_button_text_pay_with_amount",{order_total:b}));e&&(e.innerHTML=b)},getPaymentPlanSelectionFormData:function(){var b=d(".pmts-select-payment-instrument-form").closest("form");b.append(m.buildHiddenInput("addCreditCardVerificationNumber99","123"));var c=b.find("input[type\x3d'hidden'][name^\x3d'"+(g.WIDGET_EVENT_KEY+g.KEY_VALUE_SEPARATOR)+e+"']")[0],b=a.serializeObject(b);c&&delete b[c.name];b[g.WIDGET_EVENT_KEY]=
"FetchOrderSummaryDataEvent";return b},isInstrumentSelectionChanged:function(b){var c=d(".pmts-select-payment-instrument-form").closest("form").clone().find("input[type\x3d'checkbox'][name^\x3d'ppw']"),e=a.serializeObject(c),c="",f;for(f in e)c+=e[f];f=c!==r||b!==v;r=c;v=b;return f}})});l("components/TrustedBeneficiaryComponent",["component"],function(c){return c.extend({bindToElements:function(){var c=this;if(this.data.paymentMethodId)this.widget.onAui("a:switch:trusted-beneficiary-toggle-switch:"+
this.data.paymentMethodId+":flip",function(f){c.widget.submitFormAJAX({"ppw-widgetEvent":"UpdateTrustedBeneficiaryStatusEvent","ppw-paymentMethodId":c.data.paymentMethodId,"ppw-optInTrustedBeneficiary":f.switchState.isOn.toString(),"ppw-widgetState":c.widget.options.serializedState})})}})});l("components/PerformUpdateEverywhereWorkflowComponent",["modal-popover","component"],function(c,d){return d.extend({initialize:function(d,h){h.data.showInPopover&&(this.popover=new c(d,h,this))},bindToEvents:function(){this.widget.on("ue-cancelClicked",
this,function(c){this.getDOMElement("pmts-ue-js-popover-cancel-form").submit()})}})});l("components/UpdateEverywhereConfirmationComponent",["component","lang"],function(c,d){return c.extend({})});l("components/UpdateEverywhereFixInstrumentComponent","events/InstrumentRowSelectedEvent css-utils component lang jQuery attributes".split(" "),function(c,d,f,h,g,a){return f.extend(a,{selectedInstrumentId:null,initialize:function(a,c){this.set("UpdateButtonEnabledAttribute",!0);this.watch("UpdateButtonEnabledAttribute",
this,function(a){this.widget.log({updateButtonEnabled:a});a?d.enableElement(this.getDOMElement("pmts-ue-js-credit_card_fixup-update-button")):d.disableElement(this.getDOMElement("pmts-ue-js-credit_card_fixup-update-button"))})},_instrumentRowSelected:function(a){this._getAllCreditCardRows().removeClass("pmts-selected");this._getCreditCardRow(a).addClass("pmts-selected");this.getDOMElement("instrumentRowSelection-"+a).prop("checked",!0);var c=this.getDOMElement("instrumentRowSelection-"+a).val();this._triggerCreditCardRowSelectedEvent(a,
c)},_creditCardRowClicked:function(a){(a=g(a.currentTarget).data("instrument-id"))&&this.selectedInstrumentId!==a&&this._triggerInstrumentRowSelectedEvent(a)},_getCreditCardRow:function(a){return this.getDOMElement("creditCardContainer-"+a)},_getAllCreditCardRows:function(){return this.getDOMElementsByPrefix("creditCardContainer-")},_triggerInstrumentRowSelectedEvent:function(a,d){this.widget.trigger(c,{instrumentId:a,errors:d})},_triggerCreditCardRowSelectedEvent:function(a,c){this.widget.trigger("creditCardRowSelected",
{instrumentId:a,instrumentSelectionValue:c})},_selectBackingInstrument:function(a){a=a&&a.instrumentId?a:null;this._updatePaymentPlanState(a)},_updatePaymentPlanState:function(a){a=a?this._firstElement(a.errors):this.widget.getLocalizedString("pmts_portal_payselect_empty_instrument_selection");this.set("UpdateButtonEnabledAttribute",!a)},_firstElement:function(a){return h.isArray(a)&&0<a.length?a[0]:null},_initFixupView:function(){this.getDOMElementsByPrefix("creditCardContainer-").trigger("click")},
_handleClickEvent:function(a){this.get("UpdateButtonEnabledAttribute")&&this.getDOMElement("pmts-ue-js-credit_card_fixup-cc-list-item-form").submit()},bindToElements:function(){var a=this;a.getDOMElementsByPrefix("creditCardContainer-").click(h.bind(this._creditCardRowClicked,this));a.getDOMElement("pmts-ue-js-credit_card_fixup-update-button").click(h.bind(this._handleClickEvent,a));a.getDOMElement("pmts-ue-js-credit_card_fixup-cancel-button").click(function(c){a.getDOMElement("pmts-ue-js-credit_card_fixup-cancel-button-form").submit()})},
bindToEvents:function(){var a=this;this.widget.on("initializeRecommendedInstrument",this,function(a){this.selectedInstrumentId=a.instrumentId});a.widget.on("componentsInitialized",a,function(){this._initFixupView()});a.widget.on(c,a,function(c){a.selectedInstrumentId=c.instrumentId;a._instrumentRowSelected(c.instrumentId)});a.widget.on("backingInstrumentSelected",this,function(c){a._selectBackingInstrument(c)})}})});l("components/PerformUpdateEverywhereComponent",["component","lang"],function(c,d){return c.extend({})});
l("components/UpdateEverywhereSelectInstrumentComponent",["component","css-utils","jQuery","lang","attributes"],function(c,d,f,h,g){return c.extend(g,{initialize:function(a,c){(this._forDeleteAndUpdateEverywhere=c.data.forDeleteAndUpdateEverywhere)||this._initializeUESelectInstrumentComponent(this)},bindToElements:function(){this._forDeleteAndUpdateEverywhere||this._bindToElementsUESelectInstrumentComponent(this)},bindToEvents:function(){this._forDeleteAndUpdateEverywhere||this._bindToEventsSelectInstrumentComponent(this)},
_initializeUESelectInstrumentComponent:function(a){a.set("UpdateButtonEnabledAttribute",!0);a.watch("UpdateButtonEnabledAttribute",a,function(c){a.widget.log({updateButtonEnabled:c});c?d.enableElement(a.getDOMElement("pmts-ue-select-instrument-update-button")):d.disableElement(a.getDOMElement("pmts-ue-select-instrument-update-button"))})},_bindToElementsUESelectInstrumentComponent:function(a){a.getDOMElement("pmts-ue-select-instrument-update-button").click(h.bind(this._handleClickEvent,a));a.getDOMElement("pmts-ue-select-instrument-cancel-button").click(function(){a.getDOMElement("pmts-ue-select-instrument-cancel-button-form").submit()})},
_bindToEventsSelectInstrumentComponent:function(a){a.widget.on("componentsInitialized",a,function(){a.data&&a.data.recommendedInstrumentId?(a._checkInstrumentErrorsAndUpdateButton({instrumentId:a.data.recommendedInstrumentId,errors:null}),a._triggerInitializeRecommendedInstrumentEvent(a.data.recommendedInstrumentId)):a.set("UpdateButtonEnabledAttribute",!1)});a.widget.on("backingInstrumentSelected",this,function(c){a._selectBackingInstrument(c)})},_selectBackingInstrument:function(a){a=a&&a.instrumentId?
a:null;this._checkInstrumentErrorsAndUpdateButton(a)},_handleClickEvent:function(){this.get("UpdateButtonEnabledAttribute")&&this.getDOMElement("pmts-ue-select-instrument-cc-list-form").submit()},_triggerInitializeRecommendedInstrumentEvent:function(a){this.widget.trigger("initializeRecommendedInstrument",{instrumentId:a})},_checkInstrumentErrorsAndUpdateButton:function(a){a=a?this._firstElement(a.errors):this.widget.getLocalizedString("pmts_portal_payselect_empty_instrument_selection");this.set("UpdateButtonEnabledAttribute",
!a)},_firstElement:function(a){return h.isArray(a)&&0<a.length?a[0]:null}})});l("components/UpdateEverywhereConfirmCancelComponent",["component","lang"],function(c,d){return c.extend({})});l("AddPaymentMethodTouchLinkSupport",["events/spinner-events","events/StartAddInstrumentEvent"],function(c,d){return{bindToElements:function(){var f=this;f.getDOMElement("pmts-mobile-add-payment-method-touchlink").click(function(h){h.preventDefault();f.widget.trigger(c.showSpinner);f.widget.continueRequest({"ppw-widgetState":f.widget.options.serializedState,
"ppw-widgetEvent":d},{success:f.widget.createAjaxContinueSuccessHandler(),complete:function(){f.widget.trigger(c.hideSpinner)}})})}}});l("block-add-credit-card-trigger-helper",["jQuery"],function(c){return function(){var d=c(".pmts-add-credit-card-content-trigger-row-common");0<d.length&&(d.addClass("pmts-disabled-add-credit-card-content-trigger-row-common"),0<d.find(".a-button.apx-secure-registration-content-trigger-js").length&&d.find(".a-button.apx-secure-registration-content-trigger-js").addClass("a-button-disabled"),
0<d.find("a.apx-secure-registration-content-trigger-js").length&&d.find("a.apx-secure-registration-content-trigger-js").addClass("pmts-disabledadd-add-credit-card-link"),0<d.find(".pmts-add-cc-default-trigger-link").length&&d.addClass("pmts-disabledadd-add-credit-card-link"))}});l("cc-validation-inline-message-helper",["jQuery"],function(c){return{display:function(){var d=c(".pmts-add-credit-card-component-container");1===d.find(".pmts-add-cc-number-validation").length&&d.find(".pmts-add-cc-number-validation").removeClass("a-hidden aok-hidden");
1===d.find(".pmts-account-Number").length&&d.find(".pmts-account-Number").addClass("a-form-warning")},hide:function(){var d=c(".pmts-add-credit-card-component-container");1===d.find(".pmts-add-cc-number-validation").length&&d.find(".pmts-add-cc-number-validation").addClass("a-hidden aok-hidden");1===d.find(".pmts-account-Number").length&&d.find(".pmts-account-Number").removeClass("a-form-warning")}}});l("cc-holder-name-validation-inline-message-helper",["jQuery"],function(c){return{display:function(){var d=
c(".pmts-add-credit-card-component-container");1===d.find(".pmts-add-cc-holder-name-validation").length&&d.find(".pmts-add-cc-holder-name-validation").removeClass("a-hidden aok-hidden");1===d.find(".apx-add-credit-card-account-holder-name-input").length&&d.find(".apx-add-credit-card-account-holder-name-input").addClass("a-form-error")},hide:function(){var d=c(".pmts-add-credit-card-component-container");1===d.find(".pmts-add-cc-holder-name-validation").length&&d.find(".pmts-add-cc-holder-name-validation").addClass("a-hidden aok-hidden");
1===d.find(".apx-add-credit-card-account-holder-name-input").length&&d.find(".apx-add-credit-card-account-holder-name-input").removeClass("a-form-error")}}});l("cvv-rate-limiting-inline-message-helper",["jQuery"],function(c){var d={},f=c(".pmts-add-credit-card-component-container"),h=f.find(".pmts-add-cc-rate-limiting-sentence-string");d.display=function(d){var a=c(".pmts-add-credit-card-component-container");0<a.find(".pmts-add-cc-rate-limiting-container").length&&(a.find(".pmts-add-cc-rate-limiting-container").removeClass("a-hidden aok-hidden"),
900<=d?0<a.find(".pmts-add-cc-rate-limiting-24hrs-string").length&&a.find(".pmts-add-cc-rate-limiting-24hrs-string").removeClass("a-hidden aok-hidden"):0<a.find(".pmts-add-cc-rate-limiting-15mins-string").length&&a.find(".pmts-add-cc-rate-limiting-15mins-string").removeClass("a-hidden aok-hidden"))};d.displayTimer=function(c,a,d,k,e,b){function l(f){var n="";rateLimitDurationInHours=Math.floor(c/3600);1<rateLimitDurationInHours?n=d+" ":1==rateLimitDurationInHours&&(n=k+" ");k=n.replace("{}",String(rateLimitDurationInHours));
rateLimitDurationInMinutes=Math.floor(c%3600/60);e=(1==rateLimitDurationInMinutes?" "+e:" "+b).replace("{}",String(rateLimitDurationInMinutes));n=a;k&&e||(n="");a=n;h.text(f.replace("{} {} {}",k+a+e));c-=60}function p(a){setTimeout(function(){clearInterval(a);0<f.find(".pmts-add-cc-rate-limiting-container").length&&f.find(".pmts-add-cc-rate-limiting-container").addClass("a-hidden aok-hidden")},1E3*c)}(function(){if(0<f.find(".pmts-add-cc-rate-limiting-container").length&&(f.find(".pmts-add-cc-rate-limiting-container").removeClass("a-hidden aok-hidden"),
0<h.length)){var a=h.text();l(a);a=setInterval(l,6E4,a);h.removeClass("a-hidden aok-hidden");p(a)}})()};return d});l("digital-wallet-utils",["lang"],function(c){return{isInstrumentSelectionWithoutMultitender:function(d){return null!=d&&c.isDefined(d.instrumentId)&&c.isDefined(d.instrumentCategory)&&c.isDefined(d.isMultiTenderEnabled)&&c.isDefined(d.isAuthenticationRetryEnabled)&&"DigitalWallet"===d.instrumentCategory&&(!d.isMultiTenderEnabled||d.isAuthenticationRetryEnabled)}}});l("mock-helper",[],
function(){var c={"add-credit-card":function(c){c.widget.trigger("WidgetAction",{widgetActionType:"add-payment-instrument",widgetAction:"add-credit-card-workflow-complete",paymentInstrumentId:"MockPaymentInstrumentId"})}};return{mocked:function(d,f,h){var g;d.widget.options.isMock&&(g=c[f]);g?g(d):h()}}});l("post-pay-utils",["lang"],function(c){return{isInstrumentSelection:function(d,f){return f&&null!=d&&c.isDefined(d.instrumentId)&&-1!==d.instrumentId.indexOf("amzn1.pm.pma.pop")}}});l("RentalUtils",
["jQuery","lang"],function(c,d){return{bindToElements:function(){c("#rentals-ineligible-items-trigger").click(d.bind(this.rentalsModifyCartLinkClicked,this))},rentalsModifyCartLinkClicked:function(c){c.preventDefault();this.widget.trigger("RentalsModifyCartLinkClicked")}}});l("events/StartAddInstrumentEvent",["public-event-registry"],function(c){c.register("StartAddInstrumentEvent");return"StartAddInstrumentEvent"});l("AddPaymentInstrumentStorageConsentHelper",["css-utils","lang","clog","jQuery"],
function(c,d,f,h){return{initialize:function(c,a){this._isStorageConsentRequired=a.data.isStorageConsentRequired||!1;this._storageConsentOptInRadioButtonBinding=a.data.storageConsentOptInRadioButtonBinding;this._storageConsentOptOutRadioButtonBinding=a.data.storageConsentOptOutRadioButtonBinding;this._storageConsentOptInBlameElementBinding=a.data.storageConsentOptInBlameElementBinding;this._storageConsentOptOutBlameElementBinding=a.data.storageConsentOptOutBlameElementBinding;this._performUpdateEverywhereEnabled=
a.data.performUpdateEverywhereEnabled||!1;this._updateEverywhereContainerBinding=a.data.updateEverywhereContainerBinding;this._setBuyingPreferenceEnabled=a.data.setBuyingPreferenceEnabled||!1;this._setBuyingPreferenceContainerBinding=a.data.setBuyingPreferenceContainerBinding;this._paymentMethodCategory=a.data.paymentMethodCategory;this._purchaseId=a.data.purchaseId},bindToElements:function(){var f=this;if(f._isStorageConsentRequired){var a=this.getDOMElement(this._storageConsentOptInRadioButtonBinding),
l=this.getDOMElement(this._storageConsentOptOutRadioButtonBinding),k=this._performUpdateEverywhereEnabled,e=this.getDOMElement(this._updateEverywhereContainerBinding),b=this._setBuyingPreferenceEnabled,n=this.getDOMElement(this._setBuyingPreferenceContainerBinding);a.click(function(a){a=c.showElement;k&&d.isDefined(e)&&a(e);a=c.showElement;b&&d.isDefined(n)&&a(n)});l.click(function(a){a=c.hideElement;k&&d.isDefined(e)&&a(e);a=c.hideElement;b&&d.isDefined(n)&&a(n)});h(".apx-storage-consent-learn-more-"+
f._paymentMethodCategory).bind("click",function(){f.widget.publishSuccessSushiMetrics({ActionType:"Add"+f._paymentMethodCategory,ActionValueType:"AddMethod",ActionValue:"StorageConsentLearnMoreLinkClicked",ActionParentValueType:"PurchaseDocument",ActionParentValue:f._purchaseId})})}},blameFormField:function(c){if(this._isStorageConsentRequired){(c=0<d.filter(c,function(a){return"storageConsent"===a.field}).length)&&this.widget.publishFailureSushiMetrics({ActionType:"Add"+this._paymentMethodCategory,
ActionValueType:"ErrorField",ActionValue:"StorageConsentSelectionRequiredError",ActionParentValueType:"PurchaseDocument",ActionParentValue:this._purchaseId});var a=this.getDOMElement(this._storageConsentOptInBlameElementBinding),f=this.getDOMElement(this._storageConsentOptOutBlameElementBinding);a.toggleClass("storage-consent-form-error",c);f.toggleClass("storage-consent-form-error",c)}}}});l("components/VerifyInstrumentComponent",["component"],function(c){return c.extend({_verifyingInstrumentId:null,
_spinnerName:null,initialize:function(c,f){this._verifyingInstrumentId=f.data.verifyingInstrumentId;this._spinnerName=f.data.spinnerName},triggerSpinnerChangeAppearanceEvent:function(c){this.widget.trigger("SpinnerChangeAppearanceEvent",{spinnerName:this._spinnerName,display:c})},bindToEvents:function(){var c=this;if(c._verifyingInstrumentId)c.widget.on("componentsInitialized",c,function(){c.triggerSpinnerChangeAppearanceEvent(!0);p.setTimeout(function(){c.widget.continueRequest({"ppw-widgetState":c.widget.options.serializedState,
"ppw-widgetEvent":"VerifyInstrumentEvent","ppw-instrumentId":c._verifyingInstrumentId},{success:c.widget.createAjaxContinueSuccessHandler(),complete:function(){c.triggerSpinnerChangeAppearanceEvent(!1)}})},2500)})}})});l("components/VerifyInstrumentSpinnerComponent",["components/SpinnerComponent"],function(c){return c.extend({})});l("events/ViewOneClickPreferredPaymentMethodEvent",["public-event-registry"],function(c){c.register("ViewOneClickPreferredPaymentMethodEvent");return"ViewOneClickPreferredPaymentMethodEvent"});
l("components/ViewOneClickComponent",["component","events/ViewOneClickPreferredPaymentMethodEvent"],function(c,d){return c.extend({bindToEvents:function(){var c=this;this.widget.on("CompleteWidget",this,function(){c.widget.submitFormAJAX({"ppw-widgetState":c.widget.options.serializedState,"ppw-widgetEvent":"RefreshEvent"})});this.widget.on("componentsInitialized",this,function(){c.widget.trigger(d,{preferredPaymentMethodId:c.data.preferredPaymentMethodId})})}})})})()});
/* ******** */
(function(f){var e=window.AmazonUIPageJS||window.P,g=e._namespace||e.attributeErrors,a=g?g("APXWidgetsAssets@APXWidgets-FusePartnerBilling","APXWidgetsAssets"):e;a.guardFatal?a.guardFatal(f)(a,window):a.execute(function(){f(a,window)})})(function(f,e,g){(function(){var a=PaymentsPortal2.modules.define;a("components/AddFusePartnerBillingComponent",["form-component","events/form-submitted-event","lang","jQuery"],function(a,b,c,h){return a.extend({initialize:function(a,b){this.addFPBSubmitButton=b.data.addFPBSubmitButton;
this.addFPBForm=b.data.addFPBForm;this.addFPBAction=b.data.addFPBAction},bindToElements:function(){this.getDOMElement(this.addFPBSubmitButton).click(c.bind(this.handleCreate,this));this.getDOMElement("pmpt-add-fpb-send-otp-button-js").click(c.bind(this.handleSendOTP,this))},handleCreate:function(a){var d=this.form.validateForm(),c=this.getFormSubmissionParameters(this.addFPBForm);0===d.length?this.widget.trigger(b,{action:this.addFPBAction,event:a,submissionParameters:c}):a.preventDefault()},handleSendOTP:function(a){var d=
h("select[name\x3dppw-fuseOTPCountryCode] option").filter(":selected").val(),c=this.getDOMElement("pmpt-add-fpb-phone-number-input-js").val();this.getDOMElement("pmpt-add-fpb-hidden-form-field-js").val(d+c);d=this.form.validateForm();c=this.getFormSubmissionParameters(this.addFPBForm);0===d.length?this.widget.trigger(b,{action:this.addFPBAction,event:a,submissionParameters:c}):a.preventDefault()}})});a("components/FusePartnerBillingDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport",
"jQuery"],function(a,b,c){return a.extend(b,{initialize:function(a,b){this._paymentMethodId=b.data.paymentMethodId;this._paymentMethodType=b.data.paymentMethodType},bindToElements:function(){this._bindEditPMLink()}})});a("components/FusePartnerBillingEditComponent",["component","EditComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,d){b._initializePopover(a,d,this)},bindToEvents:function(){b._bindPopoverCloseButtonClickedEvent(this)}})});a("components/SelectableFusePartnerBillingListComponent",
["form-component"],function(a){return a});a("components/SelectableFusePartnerBillingListItemComponent",["components/SelectableDPMInstrumentListItemComponent","events/InstrumentRowSelectedEvent"],function(a,b){return a.extend({bindToEvents:function(){if(this._isPreselected)this.widget.on("componentsInitialized",this,function(){this.widget.trigger(b,{instrumentId:this._instrumentId})});this.widget.on(b,this,function(a){this._instrumentRowSelected(a.instrumentId)})}})});a("components/FusePartnerBillingSleeveItemSlotComponent",
["component","PaymentMethodSleeveItemSlotComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,b){this._instrumentId=b.data.instrumentId}})})})()});
/* ******** */
(function(f){var g=window.AmazonUIPageJS||window.P,e=g._namespace||g.attributeErrors,d=e?e("APXWidgetsAssets@APXWidgets-Rewards","APXWidgetsAssets"):g;d.guardFatal?d.guardFatal(f)(d,window):d.execute(function(){f(d,window)})})(function(f,g,e){(function(){var d=PaymentsPortal2.modules.define;d("components/CreditCardListItemRewardsComponent","events/InstrumentRowSelectedEvent css-utils component lang aui-helper jQuery keyboard clog".split(" "),function(d,c,f,k,l,m,n,h){return f.extend({isAPBSelected:!1,
isIBDMessagingEnabled:!1,isIBDOnFullPayment:!1,isIBDOnEMIAndFullPayment:!1,isIBDOnEMIOnly:!1,isDifferentialIBDPromotionSupportedForPaylast:!1,instantBankOfferMap:{},balanceWithAPB:null,balanceWithoutAPB:null,isPaylastEligible:!1,showIBDToastMessage:!1,isAPBWithEMIEnabled:!1,isCardSelected:!1,ibdAmountDisplayed:null,isEMISelected:!1,rewardsMessageStringMapping:{},isIBDOnEMIAvailable:!1,isTotalRewardsAvailable:!1,showAggregatedIBDAndCBCCRewards:!1,isAccordionEnabled:!1,fullPaymentBalanceWithAPB:null,
fullPaymentBalanceWithoutAPB:null,maxEmiBalanceWithAPB:null,maxEmiBalanceWithoutAPB:null,isTotalRewardsAvailableWithAPB:!1,isIBDOnEMIAvailableWithAPB:!1,inlineMessagingForCashBackTreatment:"C",cashbackWithAPB:null,cashbackWithoutAPB:null,showCashbackAndIBDRewards:!1,instrumentType:"",isMultiTenderWithAPBEnabled:!0,isIBDOnSpecificEMITenureEnabled:!1,fosIdToInstantBankDiscountMapWithAPB:{},fosIdToInstantBankDiscountMapWithoutAPB:{},initialize:function(a,b){this._isDesktop="desktop"===a.options.deviceType;
this.isIBDMessagingEnabled=b.data.isIBDMessagingEnabled;this.isIBDOnFullPayment=b.data.isIBDOnFullPayment;this.isIBDOnEMIAndFullPayment=b.data.isIBDOnEMIAndFullPayment;this.isIBDOnEMIOnly=b.data.isIBDOnEMIOnly;this.isDifferentialIBDPromotionSupportedForPaylast=b.data.differentialIBDPromotionEnabledForPaylast;this.instantBankOfferMap=b.data.instantBankOfferMap;this.balanceWithAPB=b.data.balanceWithAPB;this.balanceWithoutAPB=b.data.balanceWithoutAPB;this.isPaylastEligible=b.data.isPaylastEligible;this.showIBDToastMessage=
b.data.showIBDToastMessage;this.isAPBWithEMIEnabled=b.data.isAPBWithEMIEnabled;this.ibdAmountDisplayed=b.data.balanceWithoutAPB;this.isDynamicOrderSummaryEnabled=b.data.isDynamicOrderSummaryEnabled;this.showAggregatedIBDAndCBCCRewards=b.data.showAggregatedIBDAndCBCCRewards;this.isAccordionEnabled=b.data.isAccordionEnabled;this.fullPaymentBalanceWithAPB=b.data.fullPaymentBalanceWithAPB;this.fullPaymentBalanceWithoutAPB=b.data.fullPaymentBalanceWithoutAPB;this.maxEmiBalanceWithAPB=b.data.maxEmiBalanceWithAPB;
this.maxEmiBalanceWithoutAPB=b.data.maxEmiBalanceWithoutAPB;this.inlineMessagingForCashBackTreatment=b.data.inlineMessagingForCashBackTreatment;this.cashbackWithAPB=b.data.cashbackWithAPB;this.cashbackWithoutAPB=b.data.cashbackWithoutAPB;this.showCashbackAndIBDRewards=b.data.showCashbackAndIBDRewards;this.instrumentType=b.data.instrumentType;this.isMultiTenderWithAPBEnabled=b.data.isMultiTenderWithAPBEnabled;this.isIBDOnSpecificEMITenureEnabled=b.data.isIBDOnSpecificEMITenureEnabled;this.fosIdToInstantBankDiscountMapWithAPB=
b.data.fosIdToInstantBankDiscountMapWithAPB;this.fosIdToInstantBankDiscountMapWithoutAPB=b.data.fosIdToInstantBankDiscountMapWithoutAPB;this.showAggregatedIBDAndCBCCRewards&&(this.rewardsMessageStringMapping=b.data.rewardsMessageStringMapping,this.isIBDOnEMIAvailable=b.data.isIBDOnEMIAvailable,this.isTotalRewardsAvailable=b.data.isTotalRewardsAvailable,this.isTotalRewardsAvailableWithAPB=b.data.isTotalRewardsAvailableWithAPB,this.isIBDOnEMIAvailableWithAPB=b.data.isIBDOnEMIAvailableWithAPB)},displayIBDMessages:function(){this.showAggregatedIBDAndCBCCRewards||
this.showCashbackAndIBDRewards?this.toggleRewards():this.toggleRewardsDisplayMessage()},toggleRewardsDisplayMessage:function(){this.isIBDMessagingEnabled&&(!this.isAPBSelected||this.shouldDisplayMessageWithAPB()?this._toggleIBDAmount(this.isAPBSelected):this.isMultiTenderWithAPBEnabled&&0!==this.balanceWithAPB||"APB"===this.instrumentType?"APB"!==this.instrumentType&&this.displayEmptyCaseString(this.isAPBSelected):this.displayZeroCaseString(this.isAPBSelected))},toggleRewards:function(){this.toggleRewardsPopupIcons();
this.toggleRewardsPopupText(this.isAPBSelected);var a=this.isIBDOnEMIAvailable&&this.isEMISelected||this.isTotalRewardsAvailable&&!this.isEMISelected,b=this.isIBDOnEMIAvailableWithAPB&&this.isEMISelected||this.isTotalRewardsAvailableWithAPB&&!this.isEMISelected,a=this.isAPBSelected?b:a;c.toggleElement(this.getDOMElement("IconForRewardsMessage"),this.isCardSelected&&a);this.toggleRewardsDisplayMessage()},toggleRewardsPopupIcons:function(){var a=this.isCardSelected&&!this.isEMISelected,b=this.isCardSelected&&
this.isEMISelected;c.toggleElement(this.getDOMElement("FullPaymentWithoutAPBExpanderIcon"),a);c.toggleElement(this.getDOMElement("EMIWithoutAPBExpanderIcon"),b);c.toggleElement(this.getDOMElement("FullPaymentWithoutAPBContentIcon"),a);c.toggleElement(this.getDOMElement("EMIWithoutAPBContentIcon"),b);c.toggleElement(this.getDOMElement("FullPaymentWithAPBExpanderIcon"),a);c.toggleElement(this.getDOMElement("EMIWithAPBExpanderIcon"),b);c.toggleElement(this.getDOMElement("FullPaymentWithAPBContentIcon"),
a);c.toggleElement(this.getDOMElement("EMIWithAPBContentIcon"),b)},toggleRewardsPopupText:function(a){c.toggleElement(this.getDOMElement("FullPaymentWithoutAPBExpander"),!a);c.toggleElement(this.getDOMElement("EMIWithoutAPBExpander"),!a);c.toggleElement(this.getDOMElement("FullPaymentWithoutAPBContent"),!a);c.toggleElement(this.getDOMElement("EMIWithoutAPBContent"),!a);c.toggleElement(this.getDOMElement("FullPaymentWithAPBExpander"),a);c.toggleElement(this.getDOMElement("EMIWithAPBExpander"),a);c.toggleElement(this.getDOMElement("FullPaymentWithAPBContent"),
a);c.toggleElement(this.getDOMElement("EMIWithAPBContent"),a);this.showCashbackAndIBDRewards&&(c.toggleElement(this.getDOMElement("CashbackWithoutAPBContent"),!a),c.toggleElement(this.getDOMElement("CashbackWithAPBContent"),a))},getRewardsMappingKey:function(){var a=this.isAPBSelected?"WithAPB":"WithoutAPB";return this.isCardSelected?(this.isEMISelected?"EMISelected":"FullPaymentSelected")+"#"+a:"CardDeselected#"+a},_toggleIBDAmount:function(a){this.ibdAmountDisplayed=a?this.balanceWithAPB:this.balanceWithoutAPB;
c.toggleElement(this.getDOMElement("IBDWithAPB"),a);c.toggleElement(this.getDOMElement("IBDWithoutAPB"),!a);c.toggleElement(this.getDOMElement("IBDWithAPBIsEmpty"),!1);c.toggleElement(this.getDOMElement("IBDWithAPBAsZero"),!1);c.toggleElement(this.getDOMElement("DetailRewardsInlineMessaging"),!0)},displayZeroCaseString:function(a){this.ibdAmountDisplayed=this.balanceWithoutAPB;c.toggleElement(this.getDOMElement("IBDWithAPB"),!1);c.toggleElement(this.getDOMElement("IBDWithoutAPB"),!a);c.toggleElement(this.getDOMElement("IBDWithAPBIsEmpty"),
!1);c.toggleElement(this.getDOMElement("IBDWithAPBAsZero"),a);c.toggleElement(this.getDOMElement("DetailRewardsInlineMessaging"),!a);"T2"===this.inlineMessagingForCashBackTreatment&&(c.toggleElement(this.getDOMElement("SavingsWithoutAPBDeselected"),!a),c.toggleElement(this.getDOMElement("SavingsWithAPBDeselected"),!a))},displayEmptyCaseString:function(a){this.ibdAmountDisplayed=a?null:this.balanceWithoutAPB;c.toggleElement(this.getDOMElement("IBDWithAPB"),!1);c.toggleElement(this.getDOMElement("IBDWithoutAPB"),
!a);c.toggleElement(this.getDOMElement("IBDWithAPBIsEmpty"),a);c.toggleElement(this.getDOMElement("IBDWithAPBAsZero"),!1);c.toggleElement(this.getDOMElement("DetailRewardsInlineMessaging"),!a);"T2"===this.inlineMessagingForCashBackTreatment&&(c.toggleElement(this.getDOMElement("SavingsWithoutAPBDeselected"),!a),c.toggleElement(this.getDOMElement("SavingsWithAPBDeselected"),!a))},toggleCreditCardSelection:function(a,b){a===b&&"APB"!==this.instrumentType?(this.isCardSelected=!0,this.performActionOnCreditCardSelection()):
"APB"!==this.instrumentType?(this.isCardSelected=!1,this.performActionOnCreditCardDeselection()):this.toggleAPBRewardsMessage(this.isAPBSelected||a===b)},toggleAPBRewardsMessage:function(a){a||"T1"===this.inlineMessagingForCashBackTreatment?(this.toggleSelectedCardMessage(!0),this.toggleRewardsPopupText(!0)):(this.toggleUnSelectedCardMessage(!a),this.toggleRewardsPopupText(!a))},shouldDisplayMessageWithAPB:function(){return this.isAPBSelected&&this.isMultiTenderWithAPBEnabled&&(0<this.balanceWithAPB||
this.showCashbackAndIBDRewards&&0<this.cashbackWithAPB)},getTermsAndConditionsLinkElements:function(){return[this.getDOMElement("TurboPSPTermsAndConditionsLink"),this.getDOMElement("TurboPSPTermsAndConditionsLink-IBDWithAPB"),this.getDOMElement("TurboPSPTermsAndConditionsLink-IBDWithoutAPB"),this.getDOMElement("TurboPSPTermsAndConditionsLink-IBDWithAPBIsEmpty"),this.getDOMElement("TurboPSPTermsAndConditionsLink-SavingsWithoutAPBDeselected"),this.getDOMElement("TurboPSPTermsAndConditionsLink-SavingsWithAPBDeselected"),
this.getDOMElement("TurboPSPTermsAndConditionsLink-IBDWithAPBAsZero")]},getDetailsPopoverElements:function(){return[this.getDOMElement("DetailsPopover-IBDWithAPB"),this.getDOMElement("DetailsPopover-IBDWithoutAPB"),this.getDOMElement("DetailsPopover-IBDWithAPBIsEmpty"),this.getDOMElement("DetailsPopover-InfluencingMessage"),this.getDOMElement("DetailsPopover-IBDWithCBCC")]},getDetailsBottomSheetElements:function(){return[this.getDOMElement("DetailsBottomsheet-IBDWithCBCC"),this.getDOMElement("DetailsBottomsheet-DetailRewardsInlineMessaging")]},
bindTurboPSPTermsAndConditionsLinkElements:function(a,b){a.click(function(){h.logCounterMetric({feature:"TurboPSPTermsAndConditionsLinkClicked",resource:"_Count"});h.publishMetrics();b.widget.publishSuccessSushiMetrics({ActionValue:"Click",ActionValueType:"TurboPSPTermsAndConditionsLink"})})},bindDetailsPopoverElements:function(a,b){b._isDesktop?a.mouseover(function(){b.widget.publishSuccessSushiMetrics({ActionParentValue:"Popover",ActionValue:"Mouseover",ActionValueType:"DetailsLink"})}):a.click(function(){b.widget.publishSuccessSushiMetrics({ActionParentValue:"Popover",
ActionValue:"Click",ActionValueType:"DetailsLink"})})},bindDetailsBottomsheetElements:function(a,b){a.click(function(){b.widget.publishSuccessSushiMetrics({ActionParentValue:"Bottomsheet",ActionValue:"Click",ActionValueType:"DetailsLink"})})},bindToElements:function(){var a=this;a.getTermsAndConditionsLinkElements().forEach(function(b){a.bindTurboPSPTermsAndConditionsLinkElements(b,a)});a.getDetailsPopoverElements().forEach(function(b){a.bindDetailsPopoverElements(b,a)});a.getDetailsBottomSheetElements().forEach(function(b){a.bindDetailsBottomsheetElements(b,
a)})},bindToEvents:function(){var a=this;k.forEach(["initializeRecommendedInstrument","creditCardRowSelected"],function(b){a.widget.on(b,a,function(b){this.toggleCreditCardSelection(b.instrumentId,a.data.instrumentId);this.isDynamicOrderSummaryEnabled&&a.widget.trigger("UpdateOrderTotalHiddenInputForIBD",{fosId:"",instrumentId:b.instrumentId})})});if(this.showAggregatedIBDAndCBCCRewards||this.showCashbackAndIBDRewards)a.widget.on(d,a,function(b){this.toggleCreditCardSelection(b.instrumentId,a.data.instrumentId)});
a.widget.on("addressChallengePassed",a,function(b){b.instrumentId===a.data.instrumentId&&a.displayIBDMessages()});a.widget.on("installmentPlanChanged",a,function(b){a.showAggregatedIBDAndCBCCRewards&&a.isCardSelected&&(a.isEMISelected=b.instrumentId===a.data.instrumentId&&!!b.installmentPlanId,a.toggleRewards())});if(!this.isAccordionEnabled&&this.showAggregatedIBDAndCBCCRewards)a.widget.on("installmentOptionChanged",a,function(b){this.isCardSelected&&(this.isEMISelected=b!==e&&b.isInstallmentOfferSelected&&
b.instrumentId===a.data.instrumentId,this.toggleRewards())});if(this.isPaylastEligible||this.showIBDToastMessage)a.widget.on("UpdateOrderTotalForIBDonEMIOnly",a,function(b){if(b.instrumentId===a.data.instrumentId||b.instrumentId==="EMI-"+a.data.instrumentId)this.isDifferentialIBDPromotionSupportedForPaylast&&b.emiOptionSelected&&a.updateIBDValueForEMI(b.fosId),a.updateOrderTotalForIBD(a.isIBDOnFullPayment&&!b.emiOptionSelected||(a.isAPBWithEMIEnabled||!a.isAPBSelected)&&a.isIBDOnEMIOnly&&b.emiOptionSelected)});
if(this.isDynamicOrderSummaryEnabled)a.widget.on("UpdateOrderTotalHiddenInputForIBD",a,function(b){var c=""!==b.fosId;if(b.instrumentId===a.data.instrumentId||b.instrumentId==="EMI-"+a.data.instrumentId)this.isDifferentialIBDPromotionSupportedForPaylast&&c?a.updateIBDValueForEMI(b.fosId):a.updateIBDValueForFullPayment(),(a.isIBDOnFullPayment&&!c||(a.isAPBWithEMIEnabled||!a.isAPBSelected)&&a.isIBDOnEMIOnly&&c)&&a.updateOrderTotalHiddenInputForIBD(b.fosId,b.instrumentId)});a.widget.on("apbSelectionChanged",
a,function(b){this.isAPBSelected=b.isSelected;"APB"===this.instrumentType?a.toggleAPBRewardsMessage(this.isAPBSelected):this.isCardSelected?a.performActionOnCreditCardSelection():a.performActionOnCreditCardDeselection()});if(this.showAggregatedIBDAndCBCCRewards||this.showCashbackAndIBDRewards)a.widget.on("updatePrimaryButtonDisplayString",a,function(b){b.instrumentId===a.data.instrumentId&&(this.isEMISelected=!!b.installmentPlanId,this.toggleRewards())});a.widget.on("resetSelectedPaymentMethod",a,
function(b){(this.showAggregatedIBDAndCBCCRewards||this.showCashbackAndIBDRewards)&&this.isCardSelected&&(this.isCardSelected=!1);a.performActionOnCreditCardDeselection()});a.widget.on("UpdateIBDAmount",a,function(b){(this.isPaylastEligible||this.showIBDToastMessage)&&this.isDifferentialIBDPromotionSupportedForPaylast?b.instrumentId===a.data.instrumentId&&(a.updateIBDValue(b.fosId),a.updateOrderTotalForIBD(!0)):this.isDynamicOrderSummaryEnabled&&b.instrumentId===a.data.instrumentId&&(a.updateIBDValue(b.fosId),
a.updateOrderTotalHiddenInputForIBD(b.fosId,b.instrumentId))});a.widget.on("updateIBDonAPBSelectionEvent",this,function(b){(this.isPaylastEligible||this.showIBDToastMessage)&&this.isDifferentialIBDPromotionSupportedForPaylast?b.instrumentId===a.data.instrumentId&&a.updateIBDValue(b.fosId):this.isDynamicOrderSummaryEnabled&&b.instrumentId===a.data.instrumentId&&(a.updateIBDValue(b.fosId),a.updateOrderTotalHiddenInputForIBD(b.fosId,b.instrumentId))})},updateIBDValue:function(a){""===a?this.updateIBDValueForFullPayment():
this.updateIBDValueForEMI(a)},updateOrderTotalHiddenInputForIBD:function(a,b){a=this.ibdAmountDisplayed?-1*this.ibdAmountDisplayed:0;try{var c=document.getElementsByName("ppw-"+b+"_instrumentOrderTotalBalance")[0],d=JSON.parse(c&&c.value?c.value.toString():"{}");d&&0!==Object.keys(d).length?d.ibdDiscount=a:d={ibdDiscount:a};c&&(c.value=JSON.stringify(d))}catch(e){console.log(e)}},updateIBDValueForFullPayment:function(){this.fullPaymentBalanceWithAPB!==e&&this.fullPaymentBalanceWithoutAPB!==e?(this.balanceWithoutAPB=
this.ibdAmountDisplayed=this.fullPaymentBalanceWithoutAPB,this.balanceWithAPB=this.fullPaymentBalanceWithAPB,this.isIBDOnFullPayment=!0):(this.ibdAmountDisplayed=0,this.isIBDOnFullPayment=!1);this.isIBDOnEMIOnly=!1},updateIBDValueForEMI:function(a){var b,c;this.isIBDOnSpecificEMITenureEnabled?null!==a&&(b=this.fosIdToInstantBankDiscountMapWithAPB.get(a),c=this.fosIdToInstantBankDiscountMapWithoutAPB.get(a)):(b=this.maxEmiBalanceWithAPB,c=this.maxEmiBalanceWithoutAPB);c!==e&&b!==e?(this.balanceWithoutAPB=
this.ibdAmountDisplayed=c,this.balanceWithAPB=b,this.isIBDOnEMIOnly=!0):(this.ibdAmountDisplayed=0,this.isIBDOnEMIOnly=!1);this.isIBDOnFullPayment=!1},toggleSelectedCardMessage:function(a){c.toggleElement(this.getDOMElement("IBDWithAPB"),a);c.toggleElement(this.getDOMElement("IBDWithoutAPB"),!a);c.toggleElement(this.getDOMElement("IBDWithAPBIsEmpty"),!1);c.toggleElement(this.getDOMElement("IBDWithAPBAsZero"),!1);c.toggleElement(this.getDOMElement("SavingsWithoutAPBDeselected"),!1);c.toggleElement(this.getDOMElement("SavingsWithAPBDeselected"),
!1);c.toggleElement(this.getDOMElement("DetailRewardsInlineMessaging"),!0)},toggleUnSelectedCardMessage:function(a){c.toggleElement(this.getDOMElement("IBDWithAPB"),!1);c.toggleElement(this.getDOMElement("IBDWithoutAPB"),!1);c.toggleElement(this.getDOMElement("IBDWithAPBIsEmpty"),!1);c.toggleElement(this.getDOMElement("IBDWithAPBAsZero"),!1);c.toggleElement(this.getDOMElement("SavingsWithoutAPBDeselected"),!a);c.toggleElement(this.getDOMElement("SavingsWithAPBDeselected"),a);c.toggleElement(this.getDOMElement("DetailRewardsInlineMessaging"),
!0)},performActionOnCreditCardSelection:function(){var a=this;this.showPCIComplianceComponent||this.displayIBDMessages();!this.showCashbackAndIBDRewards||"T2"!==this.inlineMessagingForCashBackTreatment||this.isAPBSelected&&!this.shouldDisplayMessageWithAPB()||this.toggleSelectedCardMessage(this.isAPBSelected);(this.isPaylastEligible||this.showIBDToastMessage)&&g.setTimeout(function(){var b=a.getDOMElement("installmentSelections")[0]&&a.getDOMElement("installmentSelections")[0].innerText&&-1!==a.getDOMElement("installmentSelections")[0].innerText.indexOf("EMI");
a.updateOrderTotalForIBD(a.isIBDOnFullPayment&&!b||(a.isAPBWithEMIEnabled||!a.isAPBSelected)&&a.isIBDOnEMIOnly&&b)},0)},performActionOnCreditCardDeselection:function(){!this.showCashbackAndIBDRewards||"T2"!==this.inlineMessagingForCashBackTreatment||this.isAPBSelected&&!this.shouldDisplayMessageWithAPB()?this.displayIBDMessages():this.toggleUnSelectedCardMessage(this.isAPBSelected)},updateOrderTotalForIBD:function(a){a&&0<this.ibdAmountDisplayed?(this.widget.trigger("UpdateOrderTotalForIBDEvent",
{ibdAmountDisplayed:this.ibdAmountDisplayed}),this.displayToastMessageForIBD()):this.widget.trigger("UpdateOrderTotalForIBDEvent",{ibdAmountDisplayed:0})},displayToastMessageForIBD:function(){this.data.displayToastMessageForIBDOffer&&0<this.getDOMElement("toastMessageContainer").size()&&(this.getDOMElement("toastMessageContainer")[0].querySelector(".a-size-medium").innerHTML="\x3cspan\x3e\x26#8377 \x3c/span\x3e"+this.ibdAmountDisplayed+this.widget.getLocalizedString("apx_toast_ibd_discount_applied"),
c.toggleElement(this.getDOMElement("toastMessageContainer"),!0))}})})})()});
/* ******** */
(function(e){var c=window.AmazonUIPageJS||window.P,d=c._namespace||c.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-PAGE","APXWidgetsAssets"):c;a.guardFatal?a.guardFatal(e)(a,window):a.execute(function(){e(a,window)})})(function(e,c,d){(function(){var a=PaymentsPortal2.modules.define;a("components/DiscoveryUpsellComponent",["component","jQuery","events/ShowAddPaymentInstrumentPage","AUI!P","clog"],function(a,g,e,f,d){return a.extend({initialize:function(){},_hideDiscoveryUpsellBottomSheet:function(){f.when("a-sheet").execute("hide-bottom-sheet",
function(b){var a=b.get("discovery-upsell-bottomsheet");a&&b.hideSheet(a)})},_onAddPaymentMethodBottomSheetButtonClick:function(b){this._hideDiscoveryUpsellBottomSheet();this._triggerShowAddPaymentInstrumentPageEvent()},_triggerShowAddPaymentInstrumentPageEvent:function(){this.widget.trigger(e,{category:"IDEAL"});this._publishCounterMetricsForDiscoveryUpsell("DiscoveryUpsellAddIdealClicked");this._publishBIMetricForDiscoveryUpsell("DiscoveryUpsellAddIdealClicked","Status","Success")},_onNotNowBottomSheetButtonClick:function(b){this._hideDiscoveryUpsellBottomSheet();
this._publishCounterMetricsForDiscoveryUpsell("DiscoveryUpsellNotNowClicked");this._publishBIMetricForDiscoveryUpsell("DiscoveryUpsellNotNowClicked","Status","Success")},_onDontShowAgainButtonClick:function(b){this._hideDiscoveryUpsellBottomSheet();this.widget.trigger("DiscoveryUpsellCustomerOptOut");this._publishCounterMetricsForDiscoveryUpsell("DiscoveryUpsellDontShowAgainClicked");this._publishBIMetricForDiscoveryUpsell("DiscoveryUpsellDontShowAgainClicked","Status","Success")},_showDiscoveryUpsellBottomSheet:function(){this.getDOMElement("discovery-upsell-bottomsheet-trigger-id").length&&
g(".pmts-add-payment-link.pmts-portal-component").is(":visible")&&(this.getDOMElement("discovery-upsell-bottomsheet-trigger-id").click(),this._publishCounterMetricsForDiscoveryUpsell("DiscoveryUpsellBottomsheetShown"),this._publishBIMetricForDiscoveryUpsell("DiscoveryUpsellBottomsheetShown","Status","Success"))},_publishCounterMetricsForDiscoveryUpsell:function(b){d.logCounterMetric({feature:b,resource:"_Count"});d.publishMetrics()},_publishBIMetricForDiscoveryUpsell:function(b,a,h){this.widget.publishSuccessSushiMetrics({ActionType:b,
ActionValueType:a,ActionValue:h})},bindToEvents:function(){var b=this;b.widget.on("DiscoveryUpsellCustomerOptOut",b,function(a){b.widget.asyncContinueRequest({"ppw-widgetEvent":"DiscoveryUpsellCustomerOptOutEvent","ppw-widgetState":b.widget.options.serializedState},{success:function(b){},error:function(){}})})},bindToElements:function(){var b=this;f.when("A","a-sheet","ready").execute(function(a){a.on("a:sheet:beforeShow:discovery-upsell-bottomsheet",function(){var a=b.getDOMElement("discovery-upsell-bottomsheet-button");
g(a).bind("click",function(a){b._onAddPaymentMethodBottomSheetButtonClick(a)});a=b.getDOMElement("not-now-bottomsheet-button");g(a).bind("click",function(a){b._onNotNowBottomSheetButtonClick(a)});a=b.getDOMElement("discovery-upsell-do-not-show-again");g(a).bind("click",function(a){b._onDontShowAgainButtonClick(a)})});a.on("a:sheet:afterHide:discovery-upsell-bottomsheet",function(){f.when("a-sheet").execute("destroy-bottom-sheet",function(a){(a=a.get("discovery-upsell-bottomsheet"))&&a.destroy()})});
b._showDiscoveryUpsellBottomSheet()});f.when("mash").execute(function(a){c.amazon&&c.amazon.mash&&c.addEventListener("popstate",function(a){a=a.state;"hide"==a.action&&"a-sheet-web"==a.component||f.when("a-sheet").execute("hide-bottom-sheet",function(a){var b=a.get("discovery-upsell-bottomsheet");b&&a.hideSheet(b)})})})}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-BankAccountVerification","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/BankAccountVerificationComponent",["component","metrics-helper","lang","jQuery"],function(a,b,c,d){return a.extend({initialize:function(a,b){this._continueButton=this.getDOMElement(b.data.jsBindingContinueButtonId)},
bindToElements:function(){var a=this;a._continueButton.click(function(){a._triggerClick()})},_triggerClick:function(){}})})})()});
/* ******** */
(function(f){var d=window.AmazonUIPageJS||window.P,g=d._namespace||d.attributeErrors,c=g?g("APXWidgetsAssets@APXWidgets-PurchaseFinancing","APXWidgetsAssets"):d;c.guardFatal?c.guardFatal(f)(c,window):c.execute(function(){f(c,window)})})(function(f,d,g){(function(){var c=PaymentsPortal2.modules.define;c("components/PurchaseFinancingOfferComponent","css-utils lang component components/SetPaymentPlanSelectComponent/validators jQuery AUI!P".split(" "),function(c,e,d,f,g,h){return d.extend({initialize:function(a,
b){this.instrumentId=b.data.instrumentId;this.isDisplayable=b.data.isDisplayable;this.financialOfferDisplayStringsMap=b.data.financialOfferDisplayStringsMap;this.isMobile="mobile"===a.options.deviceType;this.isPurchaseFinancingPopoverShown=this.shouldShowPurchaseFinancingPopover=!1;this.defaultPurchaseFinancingOffer=this.highlightedPurchaseFinancingOffer=this.selectedPurchaseFinancingOffer=b.data.maybeSelectedOfferId;f.push(e.bind(this._validator,this));this.eventRegistryCompleted=this.isCardSelected=
!1},bindToElements:function(){this.getDOMElementsByPrefix("purchaseFinancingMobileTouchLink-").click(e.bind(this._handleTouchLinkClick,this))},bindToEvents:function(){this.widget.on("togglePurchaseFinancingOffers",this,function(a){this.isDisplayable&&this.instrumentId===a.instrumentId&&(this._selectDefaultOffer(),this._togglePurchaseFinancingOffers(a.isSelected))})},bindToDesktopPopUpElements:function(){this.getDOMElement("purchaseFinancingAcceptButton-"+this.instrumentId).click(e.bind(this._handleOnClickAccept,
this));this.getDOMElement("purchaseFinancingDeclineButton-"+this.instrumentId).click(e.bind(this._handleOnClickDecline,this))},bindToMobilePopUpElements:function(){var a=this;h.when("A","a-popover","ready").execute(function(b,c){a.getDOMElement("purchaseFinancingAcceptButton-"+a.instrumentId).click(e.bind(a._handleOnClickAccept,a));a.getDOMElement("purchaseFinancingDeclineButton-"+a.instrumentId).click(e.bind(a._handleOnClickDecline,a));a.getDOMElementsByPrefix("purchaseFinancingOfferRadioButton-").click(function(b){a._purchaseFinancingOfferSelected(g(b.currentTarget))})})},
_togglePurchaseFinancingOffers:function(a){var b=this.getDOMElement("financialOfferViolationsPF");c.toggleElement(b,a);this.isCardSelected=a;b=this.getDOMElement(this.isMobile?"purchaseFinancingMobileTouchLink-"+this.instrumentId:"purchaseFinancingOffers");c.toggleElement(b,a);this.widget.trigger("toggleFinancialOffer",{instrumentId:this.instrumentId,isSelected:!0,isAddressChallenged:!0})},_handleOnClickAccept:function(){if(this.isCardSelected){if(this.isMobile)this.selectedPurchaseFinancingOffer=
this.highlightedPurchaseFinancingOffer,this.getDOMElement("selectedPurchaseFinancingOfferText-"+this.instrumentId).text(this.financialOfferDisplayStringsMap[this.selectedPurchaseFinancingOffer]),this.getDOMElement("hiddenFinancialOfferIdInput"+this.instrumentId).val(this.selectedPurchaseFinancingOffer),this._updateSelectedOffer(this.selectedPurchaseFinancingOffer);else{this.shouldShowPurchaseFinancingPopover=!1;this.isPurchaseFinancingPopoverShown=!0;var a=this.getDOMElement("purchaseFinancingDropDownSelector-"+
this.instrumentId)[0];this._updateSelectedOffer(a.options[a.selectedIndex].value);this.widget.trigger("ContinueButtonClicked")}this._closePopover()}},_handleOnClickDecline:function(){if(this.isCardSelected){if(this.isMobile)this.selectedPurchaseFinancingOffer=this.defaultPurchaseFinancingOffer,this.getDOMElement("selectedPurchaseFinancingOfferText-"+this.instrumentId).text(this.financialOfferDisplayStringsMap[this.selectedPurchaseFinancingOffer]),this.getDOMElement("hiddenFinancialOfferIdInput"+this.instrumentId).val(this.selectedPurchaseFinancingOffer);
else{var a=this.instrumentId,b=this.defaultPurchaseFinancingOffer;h.when("a-dropdown").execute(function(c){c.setValue("pmts-financial-offer-dropdown-native-id-"+a,b)});this.isPurchaseFinancingPopoverShown=this.shouldShowPurchaseFinancingPopover=!1}this._updateSelectedOffer(this.defaultPurchaseFinancingOffer);this._closePopover()}},_validator:function(){if(!this.isCardSelected)return!0;var a=this.getDOMElement("purchaseFinancingDropDownSelector-"+this.instrumentId)[0];!this.isPurchaseFinancingPopoverShown&&
a&&a.selectedIndex&&1<a.selectedIndex&&(this.getDOMElement("purchaseFinancingPopover-"+this.instrumentId).click(),this.eventRegistryCompleted||(this.bindToDesktopPopUpElements(),this.eventRegistryCompleted=!0),this.shouldShowPurchaseFinancingPopover=!0);!this.isPurchaseFinancingPopoverShown&&a&&a.selectedIndex&&1===a.selectedIndex&&this._handleOnClickAccept();this.isMobile?this._updateSelectedOffer(this.selectedPurchaseFinancingOffer):a&&a.selectedIndex?this._updateSelectedOffer(a.options[a.selectedIndex].value):
this._updateSelectedOffer(this.defaultPurchaseFinancingOffer);return!this.shouldShowPurchaseFinancingPopover},_purchaseFinancingOfferSelected:function(a){var b=a.data("financial-offer-id");b&&this.highlightedPurchaseFinancingOffer!==b&&(this.getDOMElement("purchaseFinancingOfferRadioButton-"+this.highlightedPurchaseFinancingOffer).removeClass("pmts-selected"),a.addClass("pmts-selected"),a.find("input[type\x3dradio]").prop("checked",!0),this.highlightedPurchaseFinancingOffer=b)},_updateSelectedOffer:function(a){this.isMobile?
document.getElementsByName("ppw-"+this.instrumentId+"_financialOfferId").forEach(function(b){"hidden"===b.type&&(b.value=a)}):h.when("a-dropdown").execute(function(b){try{b.setValue("pmts-financial-offers-dropdown-native-id",a)}catch(c){}})},_handleTouchLinkClick:function(){this.eventRegistryCompleted||(this.bindToMobilePopUpElements(),this.eventRegistryCompleted=!0);var a=this.getDOMElement("purchaseFinancingOfferRadioButton-"+this.selectedPurchaseFinancingOffer),b=a.find("input[type\x3dradio]");
a.addClass("pmts-selected");b.prop("checked",!0);this.selectedPurchaseFinancingOffer!==this.highlightedPurchaseFinancingOffer&&(a=this.getDOMElement("purchaseFinancingOfferRadioButton-"+this.highlightedPurchaseFinancingOffer),b=a.find("input[type\x3dradio]"),a.removeClass("pmts-selected"),b.prop("checked",!1),this.highlightedPurchaseFinancingOffer=this.selectedPurchaseFinancingOffer)},_selectDefaultOffer:function(){if(!this.isMobile){var a=this.instrumentId,b=this.defaultPurchaseFinancingOffer;h.when("a-dropdown").execute(function(c){c.setValue("pmts-financial-offer-dropdown-native-id-"+
a,b)})}},_closePopover:function(){this.getDOMElement("close-purchaseFinancingAcceptButton-"+this.instrumentId).click()}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-Card","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/CardDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport","jQuery","lang","clog"],function(a,b,c,f,e){return a.extend(b,{initialize:function(a,b){this._paymentMethodId=b.data.paymentMethodId;
this._paymentMethodType=b.data.paymentMethodType;this._foregroundColor=b.data.foregroundColor;this._isDefault=b.data.isDefault;this._cardTail=b.data.cardTail},bindToElements:function(){this.getDOMElement("walletAuthVerifyLink").click(f.bind(this._verifyAuthLinkClicked,this));this._bindEditPMLink();c(".apx-wallet-card-art-foreground-color").css("color",this._foregroundColor)},_verifyAuthLinkClicked:function(){e.logCounterMetric({feature:"VerifyAuthLinkClicked",resource:"_Count"});e.publishMetrics();
this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"LaunchAddCardAuthEvent","ppw-instrumentId":this._paymentMethodId,"ppw-cardTail":this._cardTail})}})});a("components/CardSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(a,c){var d=c.bindToElements;return a.extend(c,{initialize:function(b,a){this._instrumentId=a.data.instrumentId;this._isLydiaDebitCard=a.data.isLydiaDebitCard;this._isRequestForApp=a.data.isRequestForApp;
this._isLydiaFinancialAccount=a.data.isLydiaFinancialAccount},bindToElements:function(){this._isLydiaDebitCard&&this._isRequestForApp&&this._isLydiaFinancialAccount?this._ingressToLydiaDashboard():d.call(this)},_ingressToLydiaDashboard:function(){var a="/debit/account/dashboard?ingressSource\x3dwallet\x26preSelectedPaymentMethodId\x3d"+this._instrumentId;this.getDOMElement("walletSelectablePMTab").click(function(){b.location.href=a});this.getDOMElement("walletSelectablePMButton").click(function(){b.location.href=
a})}})})})()});
/* ******** */
(function(d){var c=window.AmazonUIPageJS||window.P,e=c._namespace||c.attributeErrors,a=e?e("APXWidgetsAssets@APXWidgets-GiftCard","APXWidgetsAssets"):c;a.guardFatal?a.guardFatal(d)(a,window):a.execute(function(){d(a,window)})})(function(d,c,e){(function(){var a=PaymentsPortal2.modules.define;a("components/AddGiftCardComponent",["component","clog"],function(a,b){return a.extend({bindToElements:function(){this.getDOMElement("WalletAddBalanceRedeemGCBalance").bind("click",function(){b.logCounterMetric({feature:"WalletAddBalanceRedeemGCBalance",
resource:"_Count"});b.publishMetrics()});this.getDOMElement("WalletAddBalanceReloadGCBalance").bind("click",function(){b.logCounterMetric({feature:"WalletAddBalanceReloadGCBalance",resource:"_Count"});b.publishMetrics()})}})});a("components/GiftCardDetailsSlotComponent",["component","metrics-helper","clog"],function(a,b,c){return a.extend({initialize:function(a,b){this._paymentMethodId=b.data.paymentMethodId},_publishWalletGCViewActivityMetrics:function(){this.getDOMElement("gc-view-activity-link").bind("click",
function(){c.logCounterMetric({feature:"WalletGCViewActivity",resource:"_Count"});console.log("add count");c.publishMetrics()})},bindToElements:function(){this._publishWalletGCViewActivityMetrics();b.publishOnClickSuccessSushiMetrics(this,[{JsBindElementId:"gc-reload-link",MetricsObject:{ActionType:"GCReloadLink"}},{JsBindElementId:"gc-redeem-link",MetricsObject:{ActionType:"GCRedeemLink"}}])}})});a("components/GiftCardSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],
function(a,b){return a.extend(b,{initialize:function(a,b){this._instrumentId=b.data.instrumentId}})})})()});
/* ******** */
(function(b){var c=window.AmazonUIPageJS||window.P,d=c._namespace||c.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-BankAccount","APXWidgetsAssets"):c;a.guardFatal?a.guardFatal(b)(a,window):a.execute(function(){b(a,window)})})(function(b,c,d){(function(){var a=PaymentsPortal2.modules.define;a("components/BankAccountDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport","events/spinner-events"],function(a,c,b){return a.extend(c,{initialize:function(e,a){this._paymentMethodId=
a.data.paymentMethodId;this._paymentMethodType=a.data.paymentMethodType;this._instrumentId=a.data.instrumentId},bindToElements:function(){var a=this;a._bindEditPMLink();a.getDOMElement("apx-wallet-direct-debit-view-mandate-id").click(function(){a._triggerViewMandateEvent()})},_triggerViewMandateEvent:function(){var a=this;a.widget.trigger(b.showSpinner);a.widget.continueRequest({"ppw-widgetState":a.widget.options.serializedState,"ppw-widgetEvent":"ViewMandateEvent","ppw-instrumentId":a._instrumentId},
{success:a.widget.createAjaxContinueSuccessHandler(),complete:function(){a.widget.trigger(b.hideSpinner)}})}})});a("components/BankAccountSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,b){this._instrumentId=b.data.instrumentId}})})})()});
/* ******** */
(function(e){var d=window.AmazonUIPageJS||window.P,f=d._namespace||d.attributeErrors,b=f?f("APXWidgetsAssets@APXWidgets-PbBA","APXWidgetsAssets"):d;b.guardFatal?b.guardFatal(e)(b,window):b.execute(function(){e(b,window)})})(function(e,d,f){(function(){var b=PaymentsPortal2.modules.define;b("components/AddPbBAComponent",["events/form-submitted-event","jQuery","form-component","lang","AUI!P"],function(b,d,e,f,g){return e.extend({_hasErrors:!1,initialize:function(a,c){this.addPbBAPopover=this.getDOMElement(this.data.addPbBAPopoverJSBinding);
this._action=c.data.action;this._hasErrors=c.data.hasErrors;this._isSIPTreatmentEnabled=c.data.isSIPTreatmentEnabled;this._interstitialPageUrl=c.data.interstitialPageUrl},_initPopoverState:function(){this.data.hasErrors&&this.addPbBAPopover.trigger("click")},bindToElements:function(){var a=this;this._isSIPTreatmentEnabled?this.getDOMElement("addPbBASubmitButton").click(f.bind(this._handleFormSubmission,this)):g.when("A","a-modal","ready").execute(function(c,b){a.getDOMElement("apx-add-pbba-modal-continue-button").click(function(){a._hidePopoverModal()})})},
bindToEvents:function(){var a=this;a.widget.on("componentsInitialized",a,function(c){a._isSIPTreatmentEnabled?this._initPopoverState():a._interstitialPageUrl&&a._showPopoverModal()});a.widget.on(b,a,function(c){c.action===a._action&&d(a.getDOMElement("addPbBAForm")).submit()})},_showPopoverModal:function(){this.getDOMElement("apx-add-pbba-modal-trigger").trigger("click")},_hidePopoverModal:function(){g.when("a-modal").execute(function(a){a&&(a=a.get("apx-add-pbba-modal"))&&a.hide()})},_handleFormSubmission:function(a){var c=
this.form.validateForm(),d=this.getFormSubmissionParameters("addPbBAFormContainer");this.closeAddPbBAPopover();0===c.length?this.widget.trigger(b,{event:a,submissionParameters:d,action:this._action}):a.preventDefault()},closeAddPbBAPopover:function(){var a=this.data.addPbBAPopoverName;g.when("a-modal").execute(function(c){c&&(c=c.get(a))&&c.hide()})}})});b("components/SelectablePbBAListComponent",["form-component"],function(b){return b});b("components/SelectablePbBAListItemComponent",["components/SelectableDPMInstrumentListItemComponent",
"events/InstrumentRowSelectedEvent"],function(b,d){return b.extend({bindToEvents:function(){if(this._isPreselected)this.widget.on("componentsInitialized",this,function(){this.widget.trigger(d,{instrumentId:this._instrumentId})});this.widget.on(d,this,function(b){this._instrumentRowSelected(b.instrumentId)})}})})})()});
/* ******** */
(function(f){var d=window.AmazonUIPageJS||window.P,e=d._namespace||d.attributeErrors,c=e?e("APXWidgetsAssets@APXWidgets-AggregatedAmazonProductVouchers","APXWidgetsAssets"):d;c.guardFatal?c.guardFatal(f)(c,window):c.execute(function(){f(c,window)})})(function(f,d,e){(function(){var c=PaymentsPortal2.modules.define;c("components/AggregatedAmazonProductVoucherComponent","events/InstrumentRowSelectedEvent jQuery css-utils component mixins/disable-component lang".split(" "),function(c,d,f,e,g,h){return e.extend(g,
{initialize:function(a,b){this.productVoucherId=b.data.productVoucherId;this.productVoucherIdentifier=b.data.productVoucherIdentifier;this.productVoucherBalance=b.data.productVoucherBalance;this.isRadioButtonDisplay=b.data.canCoverPurchaseStandalone;this.productVoucherInstrumentIdPrefix=b.data.productVoucherInstrumentIdPrefix;this.isAPVPreselected=b.data.isAPVPreselected;this.isSuppressed=h.isDefined(b.data.isSuppressed)&&b.data.isSuppressed;this.$container=this.getDOMElement("apvContainer");this.$radioButton=
this.getDOMElement("instrumentRowSelection-"+this.productVoucherId);this.$checkbox=this.getDOMElement("productVoucherBalanceSelection");this.apvwave1WeblabEnabled=this.getDOMElement("wave1WeblabEnabled")},_setProductVoucher:function(a){a?this._selectProductVoucher():this._unselectProductVoucher()},_selectProductVoucher:function(){this.isRadioButtonDisplay?(this.$container.toggleClass("pmts-selected",!0),this.$radioButton.prop("checked",!0),this._triggerBackingInstrumentSelectedEvent(this.productVoucherId),
this._triggerInstrumentRowSelectedEvent()):(this.apvwave1WeblabEnabled&&this.$container.toggleClass("pmts-selected",!0),this.$checkbox.prop("checked",!0),this._triggerOptionalInstrumentSelectedEvent());this._triggerAPVSelectionChangedEvent(!0)},_unselectProductVoucher:function(){this.$container.toggleClass("pmts-selected",!1);this.isRadioButtonDisplay?this.$radioButton.prop("checked",!1):(this.$checkbox.prop("checked",!1),this._triggerOptionalInstrumentDeselectedEvent());this._triggerAPVSelectionChangedEvent(!1)},
_toggleOptionalProductVoucher:function(){var a=this.$checkbox.prop("checked");this._setProductVoucher(!a)},_handleAPVRowSelectedEvent:function(){this.isRadioButtonDisplay?this._isAPVSelected()||this._setProductVoucher(!0):this._toggleOptionalProductVoucher()},_isAPVSelected:function(){return this.isRadioButtonDisplay&&this.$container.hasClass("pmts-selected")||!this.isRadioButtonDisplay&&this.$checkbox.prop("checked")},_triggerInstrumentRowSelectedEvent:function(){this.widget.trigger(c,{instrumentId:this.productVoucherId,
paymentMethod:this.productVoucherIdentifier})},_triggerOptionalInstrumentSelectedEvent:function(){this.widget.trigger("optionalInstrumentSelected",{instrumentId:this.productVoucherId,paymentMethod:this.productVoucherIdentifier})},_triggerBackingInstrumentSelectedEvent:function(a){this.widget.trigger("backingInstrumentSelected",{instrumentId:a,paymentMethod:this.productVoucherIdentifier})},_triggerAPVSelectionChangedEvent:function(a){this.widget.trigger("apvSelectionChanged",{isSelected:a,canCoverPurchaseStandalone:this.isRadioButtonDisplay})},
_triggerOptionalInstrumentDeselectedEvent:function(){this.widget.trigger("optionalInstrumentDeselected",{instrumentId:this.productVoucherId,paymentMethod:this.productVoucherIdentifier})},bindToEvents:function(){var a=this;a.widget.on(c,a,function(b){b.instrumentId===a.productVoucherId?a._handleAPVRowSelectedEvent():a.isRadioButtonDisplay?a._isAPVSelected()&&a._setProductVoucher(!1):a.$checkbox.prop("disabled",this.isSuppressed)});a.widget.on("codSelectionEvent",a,function(b){this._isAPVSelected()&&
a._setProductVoucher(!1)});a.widget.on("initializeRecommendedInstrument",a,function(b){b.instrumentId.startsWith(this.productVoucherInstrumentIdPrefix)&&a._setProductVoucher(!0)});a.widget.on("componentsInitialized",a,function(){a._setProductVoucher(this.isAPVPreselected)});a.widget.on("apbSelectionChanged",a,function(b){b.isSelected&&!b.canCoverPurchaseStandalone&&this.isRadioButtonDisplay&&this._isAPVSelected()&&a._setProductVoucher(!1)})},bindToElements:function(){var a=this;a.$container.click(function(b){a.isRadioButtonDisplay||
b.preventDefault();a.isSuppressed||a._handleAPVRowSelectedEvent()});a.$checkbox.click(function(b){b.stopPropagation();b=a.$checkbox.prop("checked");a._setProductVoucher(b)})}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-LineOfCredit","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/LineOfCreditDetailsSlotComponent",["component"],function(a){return a.extend({initialize:function(a,b){}})});a("components/LineOfCreditSleeveItemSlotComponent",["component"],function(a){return a.extend({_triggerFallbackToMPO:!1,
initialize:function(a,b){this._triggerFallbackToMPO=b.data.triggerFallbackToMPO},bindToEvents:function(){var a=this;a.widget.on("componentsInitialized",a,function(){a._triggerFallbackToMPO&&a.widget.trigger("triggerFallbackToMPO")})}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-DigitalCurrency","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/SelectableDigitalCurrencyListComponent",["component"],function(a){return a.extend({})});a("components/SelectableDigitalCurrencyListItemComponent",["component","events/InstrumentRowSelectedEvent",
"lang","jQuery"],function(a,b,c,d){return a.extend({initialize:function(e,a){this._instrumentId=a.data.instrumentId},bindToEvents:function(){var a=this;a.widget.on(b,a,function(b){b.instrumentId===a._instrumentId?(this.getDOMElement("instrumentRowSelection-"+a._instrumentId).prop("checked",!0),this.getDOMElement("digitalCurrencyItemContainer-"+a._instrumentId).addClass("pmts-selected")):(this.getDOMElement("instrumentRowSelection-"+a._instrumentId).prop("checked",!1),this.getDOMElement("digitalCurrencyItemContainer-"+
a._instrumentId).removeClass("pmts-selected"))})},bindToElements:function(){this.getDOMElementsByPrefix("digitalCurrencyItemContainer-").click(c.bind(this._instrumentRowClicked,this))},_instrumentRowClicked:function(a){a=d(a.currentTarget).data("instrument-id");this.widget.trigger(b,{instrumentId:a});this.widget.trigger("backingInstrumentSelected",{instrumentId:a})}})})})()});
/* ******** */
(function(R){var r=window.AmazonUIPageJS||window.P,E=r._namespace||r.attributeErrors,y=E?E("APXWidgetsAssets@PaymentsPortalWidgetFramework2","APXWidgetsAssets"):r;y.guardFatal?y.guardFatal(R)(y,window):y.execute(function(){R(y,window)})})(function(R,r,E){(function(){var y=PaymentsPortal2.modules.define;R.when("A").execute(function(f){var c=f.state("apx")||{};if(!c.apxSecondaryViewRegistered){var b=f.$(r);f.declarative("apx-secondary-view","click",function(a){if(a.data.widgetInstanceId){var d=a.data.widgetInstanceId,
e=a.data.id||1,c=a.data.header,g=a.data.backButtonText||"Back",l=a.data.hideHeader||!1,k=a.data.alternateBackground||!1,m=a.data.paddingClass||"",u=a.data.inlineContent||a.data.content,x=".pmts-portal-root-"+d,A=".apx-secondary-view-root-"+d,z="#apx-secondary-view-"+e,w=b.scrollTop(),v=a.$target.closest(x).last();v.hide();x=f.$(A).last();x.length||(v.after('\x3cdiv class\x3d"apx-secondary-view-root-'+d+' pmts-portal-component"\x3e\x3c/div\x3e'),x=f.$(A));var h=x.find(z);h.remove();A=c?['\x3cdiv class\x3d"a-span8 a-column a-span-last a-text-right"\x3e',
'\x3ch4 id\x3d"apx-secondary-view-header-'+e+'"\x3e',c,"\x3c/h4\x3e\n\x3c/div\x3e"].join("\n"):"";x.append(['\x3cdiv class\x3d"a-popover a-popover-secondary a-declarative" data-action\x3d"a-popover-a11y" id\x3d"apx-secondary-view-'+e+'"\x3e','\x3cdiv class\x3d"a-popover-wrapper"\x3e','\x3cdiv class\x3d"a-popover-header-secondary'+(l?" a-popover-no-header":"")+'"\x3e','\x3cdiv class\x3d"a-row"\x3e','\x3cdiv class\x3d"'+(c?"a-span4":"a-span12 a-span-last")+' a-column"\x3e','\x3ca class\x3d"a-declarative" data-action\x3d"apx-secondary-view-close"  href\x3d"#" data-apx-secondary-view-close\x3d"{\x26quot;widgetInstanceId\x26quot;:\x26quot;'+
d+"\x26quot;, \x26quot;scrollTop\x26quot;:"+w+", \x26quot;id\x26quot;:\x26quot;"+e+'\x26quot;}"\x3e','\x3ci class\x3d"a-icon a-icon-page-back"\x3e\x3c/i\x3e\n\x3ch4\x3e',g||"Back","\x3c/h4\x3e\n\x3c/a\x3e\n\x3c/div\x3e",A,"\x3c/div\x3e\n\x3c/div\x3e",'\x3cdiv class\x3d"a-popover-inner'+(k?" a-color-alternate-background":"")+'"\x3e','\x3cdiv class\x3d"a-popover-header-spacing'+(l?" a-popover-no-header":"")+'"\x3e\x3c/div\x3e','\x3cdiv class\x3d"a-container a-secondary-view-inner'+m+'" id\x3d"apx-secondary-view-content-'+
e+'"\x3e',u,"\x3c/div\x3e\n\x3c/div\x3e\n\x3c/div\x3e\n\x3c/div\x3e"].join("\n"));h=x.find(z);d=function(){var a=f.viewport();h.width(a.width);h.css("min-height",a.height);h.find(".a-popover-wrapper, .a-popover-inner").css("min-height",a.height)};d();f.on("resize",d);h.show().css("visibility","visible").removeClass("a-popover-hidden");b.scrollTop(0)}a.$event.preventDefault()});f.declarative("apx-secondary-view-close","click",function(a){var d=a.data.widgetInstanceId,e=a.data.id,c=a.data.scrollTop;
d&&e&&(e=a.$target.closest("#apx-secondary-view-"+e).last(),d=f.$(".pmts-portal-root-"+d),e.remove(),d.show(),c&&b.scrollTop(c));a.$event.preventDefault()});c.apxSecondaryViewRegistered=!0;f.state("apx",c)}});y("attributes",["lang","events"],function(f,c){return f.extend({},c,{attributes:{},resetQuietly:function(b){this.attributes={};if(null!=b)for(var a in b){var d=b[a];d!==E&&(this.attributes[a]=d)}},toJSON:function(){return f.clone(this.attributes)},get:function(b){if(f.has(this.attributes,b))return this.attributes[b]},
has:function(b){return this.get(b)!==E},set:function(b,a){var d;f.isString(b)?(d={},d[b]=a):d=b;var e,c;for(c in d)b=d[c],a=this.get(c),this.isAttributeEqual(c,a,b)||(e||(e={}),e[c]=a,b!==E?this.attributes[c]=b:delete this.attributes[c]);if(e){for(var g in e)f.has(e,g)&&(b=this.get(g),a=e[g],this.trigger("change:"+g,b,g,this,a));this.trigger("change",this)}},unset:function(){var b={};if(0===arguments.length)for(var a in this.attributes)f.has(this.attributes,a)&&(b[a]=E);else f.forEach(arguments,function(a){b[a]=
E});return this.set(b)},reset:function(b){var a={},d;for(d in this.attributes)f.has(this.attributes,d)&&(a[d]=E);null!=b&&f.extend(a,b);return this.set(a)},isAttributeEqual:function(b,a,d){return a===d},watch:function(){var b,a,d,e;if(2===arguments.length)for(b in d=arguments[0],a=arguments[1],a)e=a[b],this.on("change:"+b,d,e);else b=arguments[0],d=arguments[1],e=arguments[2],this.on("change:"+b,d,e);return this}})});y("aui-helper",["jQuery","lang","css-utils","AUI!P"],function(f,c,b,a){return{_dropdown:function(d){return{getControlElement:function(){return this._getSpan().prev()},
_getSpan:function(){return d},error:function(a){var d=this._getSpan();if("undefined"!==typeof a)d.toggleClass("a-form-error a-button-error",a);else return d.hasClass("a-button-error")||d.hasClass("a-form-error")},val:function(d){var b=this.getControlElement(),c=this._getSpan();if("undefined"!==typeof d)a.when("a-dropdown").execute("apx-aui-helper-val",function(a){var k=b.attr("id");f.isFunction(a.getSelect)?a.getSelect(k).setValue(d):(b.val(d),f(c.find(".a-dropdown-prompt")[0]).html(d))});else return b.val()},
getOptionTextForValue:function(a){var d=this.getControlElement();return d?d.find("[value\x3d"+a+"]").first().text():""},toggleDisabled:function(d){if(a){var c=this._getSpan(),g=this.getControlElement();"undefined"===typeof d&&(d=!b.hasAUIDisabledButtonClass(g));a.when("a-dropdown").execute("apx-aui-helper-toggleDisabled",function(a){var k=g.attr("id"),m=d?"disabled":"normal";f.isFunction(a.getSelect)?a.getSelect(k).update({status:m}):b.toggleDisabledElement(c,!d)})}},isEnabled:function(){return!b.hasAUIDisabledButtonClass(this._getSpan())}}},
_radio:function(a,e){var b=a.getDOMElementsByPrefix(e+"-");return{getControlElement:function(){return b},error:function(a){},val:function(a){if("undefined"!==typeof a){var d=b.filter(function(d,e){return e.value===a})[0];d&&(d.checked=!0)}else return b.filter(":checked").val()},isEnabled:function(){return!this.getControlElement().prop("disabled")},isChecked:function(){return this.getControlElement()[0].checked}}},_textInput:function(a,e){return{getControlElement:function(){return a},getParent:function(){return a.parent()},
error:function(a){var d=this.getParent(),d=d.hasClass("a-input-text-wrapper")?d:this.getControlElement();if("undefined"!==typeof a)d.toggleClass("a-form-error",a);else return d.hasClass("a-form-error")},val:function(e){if("undefined"!==typeof e)a.val(e);else return a.val()},isEnabled:function(){return!a.hasClass("a-form-disabled")}}},_generic:function(a){return{getControlElement:function(){return a},error:function(e){if("undefined"!==typeof e)a.toggleClass("a-form-error",e);else return a.hasClass("a-form-error")},
val:function(e){if("undefined"!==typeof e)a.val(e);else return a.val()},isEnabled:function(){return!a.hasClass("a-form-disabled")}}},getAUITagHelper:function(a,e){switch(a.getElementTagType(e)){case "RadioButtonTag":return this._radio(a,e);case "DropdownTag":return this._dropdown(a.getDOMElement(e));case "TextInputTag":return this._textInput(a.getDOMElement(e));default:return this._generic(a.getDOMElement(e))}},getFormAlertsContainerHelper:function(a,e){return{render:function(c){c&&c.length&&0<c.length?
("inline"===a?this._renderInlineAlerts(c):this._renderBoxAlerts(c),b.showElement(e)):(f(e.find("ul")).empty(),b.hideElement(e))},_renderInlineAlerts:function(a){e.find(".pmts-error-message-inline").remove();var d=e.find(".pmts-error-message-inline-template");c.forEach(a,function(a){var b=d.clone().removeClass("pmts-error-message-inline-template").addClass("pmts-error-message-inline");b.find("p").text(a.localizedMessageString);b.appendTo(e)})},_renderBoxAlerts:function(a){var d=f(e.find("ul")).empty();
c.forEach(a,function(a){f("\x3cspan\x3e").attr("class","a-list-item").text(a.localizedMessageString).appendTo(f("\x3cli\x3e").appendTo(d))})}}},dynamicTriggeredWidgetEvent:function(a){var e=f("form"),b=document.createElement("input");b.name="ppw-widgetEvent:"+a;b.type="hidden";e.append(b);e.submit()},getExpanderHelper:function(a){var e;return{isExpanded:function(){return"true"===this.getContainer().find("div.a-expander-inline-content").attr("aria-expanded")},getContainer:function(){return e||(e=a.closest("div.a-expander-inline-container"))}}}}});
(function(){var f=null;"undefined"!==typeof AmazonUIPageJS?f=AmazonUIPageJS:"undefined"!==typeof R&&(f=R);f?(y("AUI!P",[],function(){return f}),f.when("A").execute(function(c){y("AUI!A",[],function(){return c})})):(y("AUI!P",[],function(){return null}),y("AUI!A",[],function(){return null}))})();y("base",["lang"],function(f){function c(a,e){return function(){a.apply(this,arguments);e.apply(this,arguments)}}function b(a,e){for(var n=e.length-1;0<=n;n--){var g=e[n];if(f.has(g,"constructor"))return g.constructor;
if(f.has(g,"initialize"))return 0<n&&(a=b(a,f.slice(e,0,n))),c(a,g.initialize)}return function(){a.apply(this,arguments)}}var a=function(){};a.extend=function(){var a=b(this,arguments);a.extend=this.extend;a.prototype=f.create(this.prototype);a.prototype.constructor=a;for(var e=0,c=arguments.length;e<c;e++){var g=arguments[e],l;for(l in g)f.has(g,l)&&"constructor"!==l&&"initialize"!==l&&(a.prototype[l]=g[l])}return a};return a});y("cc-spacing",[],function(){return{fixSpacing:function(f){f=f.replace(/\s/g,
"");0<f.length&&(f=f.match(/^3[47]/)?[f.substr(0,4),f.substr(4,6),f.substr(10,5),f.substr(15)].join(" ").trim():f.match(/.{1,4}/g).join(" "));return f},fixCaret:function(f,c,b,a){if(c&&b)if(c.length===b.length+2){if(a===b.length||" "===b.charAt(a))f+=1}else c.length===b.length+1&&a<b.length&&" "===b.charAt(a)&&(f+=1);return f}}});y("clientSideEventLogger",["lang","clog"],function(f,c){function b(){if(0!=d.length){var b=f.extend(e,d);c.log(b);a=d.length=0}}var a=0,d=[],e;setInterval(function(){b()},
6E4);r.onbeforeunload=function(){b()};return{storeEventsData:function(c,g,l){e=g;d.push(c);a+=1;50<=a?b():"Done"===l&&b()}}});y("component",["base","jQuery","lang","aui-helper","AUI!P"],function(f,c,b,a,d){return f.extend({initialize:function(a,d){this.id=d.id;this.widget=a;this._elementReferences=d.elementReferences;this._elementDOMEventMethodBindings=d.elementDOMEventMethodBindings;this._elementReferenceTagType=d.elementReferenceTagType;this.data=d.data},initializeOnReady:function(){this.bindToEvents();
this._processDOMElementEventMethodBindings();this.bindToElements();this._handleScrollToPosition(this.data);this._setFocusOnElement(this.data)},_processDOMElementEventMethodBindings:function(){var a=this;a._elementDOMEventMethodBindings&&b.forEach(a._elementDOMEventMethodBindings,function(d){if(d.method in a)c("#"+d.elementId).bind(d.event,b.bind(a[d.method],a));else throw Error("Could not find method "+d.method+" on component.");})},getDOMElement:function(a){a=this._elementReferences[a];var d=c("#"+
a);return a&&1===d.length?d:c([])},getDOMElements:function(){var a=c([]);b.forEach(b.keys(this._elementReferences),function(d){a=a.add(this.getDOMElement(d))},this);return a},getDOMElementsByPrefix:function(a){var d=c([]);b.forEach(b.keys(this._elementReferences),function(c){b.startsWith(c,a)&&(d=d.add(this.getDOMElement(c)))},this);return d},getElementTagType:function(a){return this._elementReferenceTagType[a]},_setFocusOnElement:function(a){a!==E&&a.focusElementIdReference!==E&&this.widget.focusToElement(this._elementReferences[a.focusElementIdReference])},
_handleScrollToPosition:function(a){a!==E&&a.scrollOption!==E&&("toElementByReference"===a.scrollOption?this.widget.scrollToElementOnInitialize(this._elementReferences[a.scrollElementIdReference]):"toTopOfThePage"===a.scrollOption&&this.widget.scrollToTopOfThePage())},bindToElements:function(){},bindToEvents:function(){},onExpanderClick:function(d){d=c(d.currentTarget);d=a.getExpanderHelper(d);var b=d.getContainer();if(b.length&&!d.isExpanded()){this.widget.scrollToElement(b);var g=b.find("input[type\x3d'text'], input[type\x3d'tel']").first();
r.setTimeout(function(){g.focus()},150)}},detach:function(){var a=this;b.forEach(b.keys(a._elementReferences),function(d){a.getDOMElement(d).unbind()})},getRootDOMElements:function(){return c(".pmts-portal-components-"+this.id)},widgetState:null,getWidgetState:function(a){this.widgetState||(this.widgetState=this.getDOMElement(a).closest("form").find("input[name\x3dppw-widgetState]").val());return this.widgetState},isWidgetRootComponent:function(){return this.getRootDOMElements().is(this.widget.getRootDOMElements())},
registerSecondaryView:function(a){var c=this,g=this.widget,l=this.getDOMElement(a);d.when("a-secondary-view").execute(function(d){if(d=d.get(l)){var b={instance:d,reference:a};c.secondaryViews=c.secondaryViews||[];c.secondaryViews.push(b);a===g.get("activeSecondaryViewReference")&&d.show()}});d.when("a-popover-util").execute(function(a){c.popoverUtilModule=a});g.on("widget:clean",this,function(){g.unset("activeSecondaryViewReference");c.popoverUtilModule&&c.secondaryViews&&b.forEach(c.secondaryViews,
function(a){var d=a.instance;d.isActive()&&(d.unlock().hide(),c.popoverUtilModule.trigger("dismiss",d),g.set("activeSecondaryViewReference",a.reference))})})}})});y("config",[],function(){var f={useNativeFunctions:!0,useNativeHasOwnProperty:!0};return{getAttribute:function(c){var b=("undefined"!==typeof r.APXConfig?r.APXConfig:"undefined"!==typeof r.PaymentsPortal2Config?r.PaymentsPortal2Config:{})[c];return"undefined"!==typeof b?b:f[c]}}});y("continuable-component",["component","continuable","clog",
"public-event-registry"],function(f,c,b,a){return f.extend(c,{CONTINUABLE_EVENT_NAME:"WidgetContinuableStatusEvent",initialize:function(d,b){a.register(this.CONTINUABLE_EVENT_NAME);this.fireWidgetContinuableStatusEvent=b.data.fireWidgetContinuableStatusEvent;this._watchContinuable()},_watchContinuable:function(){var a=this;this.watchContinuable(this,function(c){var n={widgetName:a.widget.type,isContinuable:c};a.widget.log(n);"undefined"!==typeof c&&(b.logCounterMetric({feature:c?"ContinuableStatusEnabled":
"ContinuableStatusDisabled",resource:"_Count"}),b.publishMetrics());a.fireWidgetContinuableStatusEvent&&"undefined"!==typeof c&&a.widget.trigger(this.CONTINUABLE_EVENT_NAME,n)})}})});y("continuable",["lang","attributes"],function(f,c){return f.extend({},c,{setContinuable:function(b){this.set("ContinuableAttribute",b)},getContinuable:function(){return this.get("ContinuableAttribute")},watchContinuable:function(){var b,a;2===arguments.length?(b=arguments[0],a=arguments[1]):(b=this,a=arguments[0]);this.watch("ContinuableAttribute",
b,a)}})});y("count-down-timer-helper",[],function(){return{startCountDownTimer:function(f,c,b,a){f.countdownTimerIntervalId=setInterval(function(){var d=(new Date).getTime(),d=c-d,e=Math.floor(d/6E4)+":"+Math.floor(d/1E3%60).toString().padStart(2,"0");0>d?(clearInterval(f.countdownTimerIntervalId),a(f)):b(f,e)},1E3);return f.countdownTimerIntervalId}}});y("css-utils",[],function(){var f=function(a){a.addClass("a-hidden aok-hidden");a.hide()},c=function(a){a.removeClass("a-hidden aok-hidden");a.show()},
b=function(a){a.addClass("a-button-disabled")},a=function(a){a.removeClass("a-button-disabled")},d=function(a){return a.hasClass("a-hidden")||a.hasClass("aok-hidden")},e=function(a){return a.hasClass("a-button-disabled")};return{hideElement:f,showElement:c,toggleElement:function(a,b){"undefined"===typeof b&&(b=d(a));b?c(a):f(a)},hasAUIHiddenClass:d,hasAUIDisabledButtonClass:e,disableElement:b,enableElement:a,toggleDisabledElement:function(d,c){"undefined"===typeof c&&(c=e(d));c?a(d):b(d)},disableTextInput:function(a){a.addClass("a-form-disabled");
a.prop("disabled",!0)},enableTextInput:function(a){a.removeClass("a-form-disabled");a.prop("disabled",!1)},makeTextInputReadOnly:function(a){a.addClass("a-form-disabled");a.prop("readonly",!0)},makeTextInputReadWrite:function(a){a.removeClass("a-form-disabled");a.prop("readonly",!1)},isTextInputReadOnly:function(a){return a.hasClass("a-form-disabled")&&a.is("[readonly]")},setElementBackgroundImage:function(a,d,b){b?a.css("background","url('"+d+"')"+b):a.css("background-image","url('"+d+"')")}}});
y("mixins/disable-component",["lang"],function(f){return f.extend({},{_disabled:!1,toggleDisabled:function(){this.setDisabled(!this._disabled)},isDisabled:function(){return this._disabled},setDisabled:function(c,b){c=c===E?!0:c;b=b===E?!0:b;if(c!==this._disabled){this._disabled=c;var a=this.getDOMElements();a.find("input").andSelf().filter("input").prop("disabled",c);b&&(c?(a.find("span.a-color-base").removeClass("a-color-base").addClass("a-color-tertiary"),a.find("div.pmts-payment-method-title-slot").addClass("pmts-payment-method-text-disabled"),
a.find("div.pmts-payment-method-icon-slot").addClass("pmts-logo-disabled")):(a.find("span.a-color-tertiary").removeClass("a-color-tertiary").addClass("a-color-base"),a.find("div.pmts-payment-method-title-slot").removeClass("pmts-payment-method-text-disabled"),a.find("div.pmts-payment-method-icon-slot").removeClass("pmts-logo-disabled")));this.onDisabledChange(c)}},onDisabledChange:function(c){}})});y("events",["lang","AUI!A"],function(f,c){function b(a,d){f.every(a,function(a){return a.callback.apply(a.thisArg,
d)!==PaymentsPortal2.events.STOP_EVENT_PROCESSING},this)}"undefined"===typeof PaymentsPortal2.events&&(PaymentsPortal2.events={},PaymentsPortal2.events.STOP_EVENT_PROCESSING="STOP_EVENT_PROCESSING");return{on:function(){var a,d,b;if(2===arguments.length){d=arguments[0];var c=arguments[1];for(a in c)b=c[a],this.on(a,d,b);return this}a=arguments[0];d=arguments[1];b=arguments[2];if(null==d)throw new TypeError("Events.on: thisArg must not be null or undefined");if(!f.isFunction(b))throw new TypeError("Events.on: callback must be a function");
c=this.listeners;c||(c=this.listeners={});f.has(c,a)||(c[a]=[]);c[a].push({callback:b,thisArg:d});return this},auiListeners:{},onAui:function(a,d){c&&(this.auiListeners[a]=this.auiListeners[a]||[],this.auiListeners[a].push(d),c.on(a,d))},offAui:function(a,d){if(c)if(null==a){for(var b in this.auiListeners)this.auiListeners.hasOwnProperty(b)&&f.forEach(this.auiListeners[b],function(a){c.off(b,a)});this.auiListeners={}}else c.off(a,d)},off:function(a,d,b){if(null==a&&null==d&&null==b)return delete this.listeners,
this;var c=this.listeners;if(!c)return this;a=null==a?f.keys(c):[a];f.forEach(a,function(a){f.has(c,a)&&(c[a]=f.filter(c[a],function(a){return null!=d&&d!==a.thisArg&&d!==a.thisArg.widget||null!=b&&b!==a.callback}))});return this},trigger:function(a){var d=this.listeners;if(!d)return this;var c=f.slice(arguments,1);f.has(d,"all")&&b.call(this,d.all,f.merge([a],c));f.has(d,a)&&b.call(this,d[a],c);return this},triggerContinue:function(a,d){d&&d.submissionParameters&&d.submissionParameters.push({name:"ppw-jsEnabled",
value:!0});this.trigger(a,d)}}});y("events/form-submitted-event",[],function(){return"FormSubmitted"});y("events/js-continue-failure-event",["public-event-registry"],function(f){f.register("JSContinueFailure");return"JSContinueFailure"});y("events/spinner-events",[],function(){return{hideSpinner:"HideSpinner",showSpinner:"ShowSpinner"}});y("events/workflow-state-event",[],function(){return"WorkflowState"});y("form-component",["component","form","keyboard","lang"],function(f,c,b,a){return f.extend({initialize:function(a,
b){this.form=new c(this,b.data.formQualifier,b.data.formDefinition)},bindFormSubmissionHandler:function(d,c,n){var g=this;g.getDOMElement(d).click(a.bind(n,g));g.getDOMElement(c).bind("keypress",function(a){if(a.which===b.keys.VK_RETURN)return n.call(g)})},getFormSubmissionParameters:function(a,b){var c="string"===typeof a?this.getDOMElement(a):a,g=c.find("form").andSelf().filter("form"),g=0!==g.length?g.serializeArray():c.find("input, select").serializeArray(),c=1<arguments.length?("string"===typeof b?
this.getDOMElement(b):b).find("input[type\x3dsubmit]").attr("name"):c.find("input[type\x3dsubmit]")[0].name;g.push({name:c,value:"Submit"});return g}})});y("form-constants",[],function(){return{WIDGET_EVENT_KEY:"ppw-widgetEvent",KEY_VALUE_SEPARATOR:":"}});y("form-helper",["lang","jQuery","form-constants"],function(f,c,b){return{onSubmit:function(a,d){a.each(function(){var a=c(this),b=null;a.find("input[type\x3dsubmit]").click(function(a){b=c(a.target)});a.submit(function(c){d(a,c,b);b=null})})},serializeObject:function(a){return f.reduce(a.serializeArray(),
function(a,b){a[b.name]=b.value;return a},{})},ensureWidgetEventInput:function(a,d){var c=b.WIDGET_EVENT_KEY+b.KEY_VALUE_SEPARATOR;d=f.startsWith(d,c)?d:c+d;var n=function(){return a.find("input[type\x3d'hidden'][name^\x3d'"+c+"']")};n().not("[name^\x3d'"+d+"']'").remove();n().length||a.append("\x3cinput name\x3d"+d+" type\x3dhidden /\x3e")}}});y("form-model",["base","lang","validation-functions"],function(f,c,b){return f.extend({initialize:function(a){this.constraints=a.constraints;this.fields=a.fields;
this.validationEvent=a.validationEvent;this.actionEvent=a.actionEvent;this.additionalData={}},validateForm:function(a){var b={},e=[];c.forEach(this.constraints,function(c){var g=c.metaData&&!b[c.field]&&!this.evalValidator(c,a)&&c.metaData.prioritized;if(!c.metaData&&!b[c.field]&&!this.evalValidator(c,a)||g)b[c.field]=!0,g={field:c.field,validation:c.validation,messageStringId:c.failureMessageStringId,metaData:c.metaData},this.validationEvent&&this.actionEvent&&(g.fieldMetricValueType=c.metricValueType,
g.fieldValue=this._getFieldValue(c,a)),e.push(g)},this);return e},_getFieldValue:function(a,b){var c="CRITICAL_OR_RESTRICTED_VALUE";a.isCriticalOrRestricted||(c=this.fields[a.field],"expirationDate"===a.field?(a=b[c.dayParameterName],c=b[c.yearParameterName]+"-"+b[c.monthParameterName]+"-"+("undefined"===typeof a?"01":a)):c=b[c.defaultParameterName]);return c},evalValidator:function(a,d){var c=b[a.validation];return!c||a.metaData&&a.metaData.disabled?!0:c.call(null,this,d,this.fields[a.field],a.parameters)},
registerAdditionalData:function(a,b){"string"===typeof a&&(this.additionalData[a]=b)},getAdditionalData:function(a){return this.additionalData[a]}})});y("form","base css-utils lang jQuery form-model aui-helper".split(" "),function(f,c,b,a,d,e){var n=[/^addCreditCardVerificationNumber[0-9]*$/,/^apx-secure-field-addCreditCardVerificationNumber[0-9]*$/];return f.extend({initialize:function(a,b,c){this.component=a;this.formQualifier=b;this.formModel=new d(c);this.fields=c.fields},validateForm:function(a){this.clearValidationErrors();
var b=this.getFormValues(),b=this._getLocalizedErrorMessages(this.formModel.validateForm(b));0<b.length&&!a&&this.renderErrorMessages(b);return b},clearLowPrioField:function(a){this.clearValidationError(a.inputFieldName,a.id)},validateField:function(a){var b=this.getFormValues();this.clearValidationError(a.inputFieldName,a.id);var b=this._getLocalizedErrorMessages(this.formModel.validateForm(b)),c=!1;if(0<b.length)for(var d=0;d<b.length;d++){var e=b[d].metaData;e.id!=a.id||e.hideMessage||this.renderErrorMessages([b[d]]);
""!=e.id&&e.messageDefinition&&"error"===e.messageDefinition.messageType&&(c=!0)}return c},renderErrorMessages:function(a){var d=this,c=[],n=[],u=[],x={};b.forEach(a,function(a){a.field&&(x[a.field]||(x[a.field]=[]),x[a.field].push(a),(!a.metaData||a.metaData.messageDefinition&&"info"!=a.metaData.messageDefinition.messageType)&&d.blameFormField(a.field,!0));a.validation&&a.fieldMetricValueType&&a.fieldValue&&(c.push(a.validation),n.push(a.fieldMetricValueType),u.push(a.fieldValue))});var f=this._getFormFieldAlertContainers(a);
b.forEach(b.keys(f),function(a){e.getFormAlertsContainerHelper("inline",f[a]).render(x[a])});a=a.filter(function(a){return a.metaData?!a.metaData.inLine:!0});var z=this._getFormAlertsContainer();z.domElement!==E&&e.getFormAlertsContainerHelper(z.messageDisplayType,z.domElement).render(a)},_submitValidationMetrics:function(a,b,d){a&&b&&d&&this.component.widget.continueRequest({"ppw-widgetEvent":this.formModel.validationEvent,"ppw-actionEvent":this.formModel.actionEvent,"ppw-validations":a,"ppw-valueTypes":b,
"ppw-values":d,"ppw-widgetState":this.component.widget.options.serializedState},{success:function(){}})},_getFormAlertsContainer:function(){var a=this.component.getDOMElement("errorMessagesBoxContainer");return 0<a.length?{domElement:a,messageDisplayType:"box"}:{domElement:this.component.getDOMElement("errorMessagesInlineContainer"),messageDisplayType:"inline"}},_getFormFieldAlertContainers:function(a){var d=this,c={};b.forEach(b.keys(this.fields),function(e){b.forEach(a,function(a){a.field==e&&(a=
a.metaData&&""!=a.metaData.id?d.component.getDOMElement("errorMessagesInlineContainer-"+a.metaData.id):d.component.getDOMElement("errorMessagesInlineContainer-"+e),a.length&&(c[e]=a))})});return c},_getLocalizedErrorMessages:function(a){var d=this;return b.map(a,function(a){return{field:a.field,validation:a.validation,fieldMetricValueType:a.fieldMetricValueType,fieldValue:a.fieldValue,messageStringId:a.messageStringId,localizedMessageString:d.component.widget.getLocalizedString(a.messageStringId),
metaData:a.metaData}})},getFormValues:function(){var a={},d=this;b.forEach(this._getParameterNames(),function(b){d.getAUITagHelperForParameter(b).isEnabled()&&(a[b]=d.getAUITagHelperForParameter(b).val())});a.widgetCreationEpochMilliseconds=this.component.widget.widgetCreationEpochMilliseconds;return a},getQualifiedParameterName:function(a){if(this.formQualifier){var b=!1;n.forEach(function(d){b=b||d.test(a)});return b?a:this.formQualifier+"_"+a}return a},getAUITagHelperForParameter:function(a){return e.getAUITagHelper(this.component,
this.getQualifiedParameterName(a))},bindToParameter:function(a,b){var d=[];Array.prototype.push.apply(d,arguments);d.shift();var c=this.getAUITagHelperForParameter(a).getControlElement();c.bind.apply(c,d)},_getParameterNames:function(a){if(a){var d=this.fields[a];return b.map(b.keys(d),function(a){return d[a]})}var c=[],e=this;b.forEach(b.keys(this.fields),function(a){var d=e.fields[a];a=b.keys(d);b.forEach(a,function(a){c.push(d[a])})});return c},blameFormField:function(a,d){var c=this;a=this._getParameterNames(a);
b.forEach(a,function(a){c.getAUITagHelperForParameter(a).error(d)})},resetErrors:function(){this.clearValidationErrors();c.hideElement(this.component.getDOMElement("errorMessagesBoxContainer"))},clearValidationErrors:function(){var a=this;b.forEach(b.keys(this.fields),function(b){a.blameFormField(b,!1)});var d=this.component.getDOMElementsByPrefix("errorMessagesInlineContainer-");c.hideElement(d)},clearValidationError:function(a,b){a&&this.blameFormField(a,!1);b&&c.hideElement(this.component.getDOMElement("errorMessagesInlineContainer-"+
b))},displayErrorMessage:function(a,b){this.blameFormField(a,!0);c.showElement(b)},resetErrorMessage:function(a,b){this.blameFormField(a,!1);c.hideElement(b)},isMCXValidationConstraint:function(a){return a&&a.metaData}})});y("global-event-bus",["lang","events"],function(f,c){return f.extend({},c)});y("input-helper",[],function(){var f={truncateInput:function(c,b){return(c=c.match(new RegExp("^((\\d*)\\.(\\d{"+b+"}))(\\d+)$")))?c[1]:""},limitToNumericInput:function(c){c.bind("keypress",function(b){var a=
String.fromCharCode(b.keyCode);("0">a||"9"<a)&&"."!==a&&b.preventDefault()})},limitNumericInputDigits:function(c,b){c.bind("input",function(a){var d=c.val();if(d=f.truncateInput(d,b))c.val(d),a.preventDefault()})}};return f});PaymentsPortal2.modules.when(["AUI!P"],function(f){function c(b){y("jQuery",[],function(){return b})}f?f.when("jQuery").execute(c):"undefined"!==typeof jQuery&&c(jQuery)});y("keyboard",[],function(){return{keys:{VK_BACKSPACE:8,VK_RETURN:13,VK_DELETE:46,VK_ZERO:48,VK_NINE:57}}});
y("lang",["config"],function(f){var c={id:function(a){return a}},b=Array.prototype.slice,a=Object.prototype.toString;c.slice=function(a){return b.apply(a,b.call(arguments,1))};c.isDefined=function(a){return!("undefined"===typeof a||null===a)};var d=c.isObject=function(a){return Object(a)===a},e=c.isFunction=function(b){return"[object Function]"===a.call(b)},n=c.isString=function(b){return"[object String]"===a.call(b)};c.isNumber=function(b){return"[object Number]"===a.call(b)};var g=c.extend=function(a){a=
Object(a);for(var b=1,d=arguments.length;b<d;b++){var c=arguments[b],e;for(e in c)a[e]=c[e]}return a};c.clone=function(a){return g({},a)};c.merge=function(a){for(var b=1,d=arguments.length;b<d;b++)for(var c=arguments[b],e=0,g=c.length;e<g;e++)a.push(c[e]);return a};c.force=function(a,b){b=a[b];return e(b)?b.call(a):b};c.time=function(){return(new Date).getTime()};c.date=function(){return new Date(c.time())};c.intercept=function(a,b,d,c){var e=a[b];a[b]=function(){d.apply(c,arguments);e&&e.apply(this,
arguments)};return a};c.NOOP=function(){};c.forEachKeyValue=function(a,b){for(var d in a)m(a,d)&&b(d,a[d])};var l=0;c.newLocalId=function(){return"pmts-id-"+ ++l};c.assert=function(a,b){if(!a)throw Error(b||"Assertion Error");};c.once=function(a){var b=!1,d;return function(){if(b)return d;d=a.apply(this,arguments);b=!0;return d}};c.after=function(a,b){return function(){if(0>=--a)return b.apply(this,arguments)}};c.leftPad=function(a,b,d){a=String(a);b-=a.length;return 0>=b?a:Array(b+1).join(d)+a};
c.endsWith=function(a,b){return-1!==a.indexOf(b,a.length-b.length)};c.startsWith=function(a,b){return a.substr(0,b.length)===b};c.keywordFormat=function(a,b){return a.replace(/\{(\w+)\}/g,function(a,d){return"undefined"!==typeof b[d]?b[d]:a})};c.stableSort=function(a,b){a=C(a,function(a,b){return{index:b,elem:a}});a.sort(function(a,d){var c=b(a.elem,d.elem);return 0===c?a.index-d.index:c});return C(a,function(a){return a.elem})};var k=f.getAttribute("useNativeFunctions");f=f.getAttribute("useNativeHasOwnProperty");
var m,u=Object.prototype.hasOwnProperty;m=u&&f?function(a,b){return u.call(a,b)}:function(a,b){if(!(b in a))return!1;for(var d in a)if(d===b)return!0;return!1};c.has=m;f=Array.isArray;c.isArray=f&&k?f:function(b){return"[object Array]"===a.call(b)};var x;if((f=Object.create)&&k)x=f;else{var A=function(){},z=A.prototype;x=function(a){if(null===a)throw Error("null prototypes are not supported");if(!d(a))throw new TypeError("prototype must be an object");if(1<arguments.length)throw Error("property descriptors are not supported");
A.prototype=a;var b=new A;A.prototype=z;return b}}c.create=x;var w=Function.prototype.bind;c.bind=w&&k?function(a){return w.apply(a,b.call(arguments,1))}:function(a,c){var e=b.call(arguments,2),g=function(){if(this instanceof g){var n=x(a.prototype),h=a.apply(n,e.concat(b.call(arguments)));return d(h)?h:n}return a.apply(c,e.concat(b.call(arguments)))};return g};var v,h=Array.prototype.forEach;v=h&&k?function(a){h.apply(a,b.call(arguments,1))}:function(a,b,d){a=Object(a);for(var c=0,e=a.length>>>0;c<
e;c++)c in a&&b.call(d,a[c],c,a)};c.forEach=v;var p=Array.prototype.filter;c.filter=p&&k?function(a){return p.apply(a,b.call(arguments,1))}:function(a,b,d){var c=[];v(a,function(a,e,g){b.call(d,a,e,g)&&c.push(a)});return c};var C,t=Array.prototype.map;C=t&&k?function(a){return t.apply(a,b.call(arguments,1))}:function(a,b,d){var c=[];v(a,function(a,e,g){c[e]=b.call(d,a,e,g)});return c};c.map=C;var F=Array.prototype.indexOf;c.indexOf=F&&k?function(a){return F.apply(a,b.call(arguments,1))}:function(a,
b,d){a=Object(a);var c=a.length>>>0,e=2<arguments.length?+d:0;0>e&&(e+=c,0>e&&(e=0));for(;e<c;e++)if(e in a&&b===a[e])return e;return-1};var q=Array.prototype.lastIndexOf;c.lastIndexOf=q&&k?function(a){return q.apply(a,b.call(arguments,1))}:function(a,b,d){a=Object(a);var c=a.length>>>0,e=2<arguments.length?+d:c;for(0>e?e+=c:e>c-1&&(e=c-1);0<=e;e--)if(e in a&&b===a[e])return e;return-1};var B=Array.prototype.reduce;c.reduce=B&&k?function(a){return B.apply(a,b.call(arguments,1))}:function(a,b,d){a=
Object(a);var c=a.length>>>0,e=0;if(2>=arguments.length){for(var g=!1;e<c;e++)if(e in a){d=a[e];e++;g=!0;break}if(!g)throw new TypeError("reduce: no initial value specified for empty array");}for(;e<c;e++)e in a&&(d=b.call(null,d,a[e],e,a));return d};var D=Array.prototype.reduceRight;c.reduceRight=D&&k?function(a){return D.apply(a,b.call(arguments,1))}:function(a,b,d){a=Object(a);var c=(a.length>>>0)-1;if(2>=arguments.length){for(var e=!1;0<=c;c--)if(c in a){d=a[c];c--;e=!0;break}if(!e)throw new TypeError("reduceRight: no initial value specified for empty array");
}for(;0<=c;c--)c in a&&(d=b.call(null,d,a[c],c,a));return d};var G=Array.prototype.every;c.every=G&&k?function(a){return G.apply(a,b.call(arguments,1))}:function(a,b,d){a=Object(a);for(var c=0,e=a.length>>>0;c<e;c++)if(c in a&&!b.call(d,a[c],c,a))return!1;return!0};var I=Array.prototype.some;c.some=I&&k?function(a){return I.apply(a,b.call(arguments,1))}:function(a,b,d){a=Object(a);for(var c=0,e=a.length>>>0;c<e;c++)if(c in a&&b.call(d,a[c],c,a))return!0;return!1};f=Object.keys;c.keys=f&&k?f:function(a){var b=
[],d;for(d in a)m(a,d)&&b.push(d);return b};var N=String.prototype.trim;c.trim=N&&k?function(a){return N.apply(a)}:function(a){if(!n(a))throw new TypeError("trim: str must be a string");return a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};c.addEventListener=function(a,b,d){a.addEventListener?a.addEventListener(b,d,!1):a.attachEvent?a.attachEvent("on"+b,d):a["on"+b]=d};return c});y("localization-utils",[],function(){var f=/\{(\w+)\}/g;return{fillInStringTemplate:function(c,b){for(var a=c,d=f.exec(c);d;){var e=
d[0],d=d[1];"string"===typeof b[d]&&(a=a.replace(e,b[d]));d=f.exec(c)}return a}}});y("clog",["lang"],function(f){function c(a){r.console&&r.console.error&&r.console.error(a)}function b(a){return r.Number(a)===a&&0===a%1}function a(a){return"[object String]"===Object.prototype.toString.call(a)}function d(a){return!0===a||!1===a}function e(a,b){return r.JSON&&r.JSON.stringify?b+r.encodeURIComponent(r.JSON.stringify(a)):b+r.encodeURIComponent(a)}function n(a,b){return b+r.encodeURIComponent(a)}function g(b){b=
b();a(b.name)&&"[object Function]"===Object.prototype.toString.call(b.send)&&"isPrimitive"in b&&(C[b.name]=b,++t)}function l(a,b){if(a){b=b||{};var d;if(d=!0===b.dontSendOnBFHit)d=r.ue&&"isBF"in r.ue?r.ue.isBF:(d=r.performance||r.webkitPerformance)&&d.navigation?2===d.navigation.type:!1;if(!(d||1900<a.length)){d=b.client&&b.client in C?b.client:h;try{C[d].send(a,I+N,e,b.chainedClientExecutionOrder)}catch(c){}}}}function k(a,b){z&&(A.numberOfTimberLogCalls++,A.numberOfTimberLogCalls===G?l("Max number of Forester Logs Reached"):
A.numberOfTimberLogCalls<G&&l(a,b))}function m(a){var b;if(b=a&&"[object Array]"===Object.prototype.toString.call(a)&&0<a.length&&a.length<t)a:{for(b=0;b<a.length;++b)if(!(a[b]in C)){b=!1;break a}else if(!C[a[b]].isPrimitive){b=!1;break a}b=!0}return b}function u(){return(new Date).getTime()}function x(){return r.PaymentsPortal2.widgetStartTime}var A={numberOfTimberLogCalls:0},z=!1,w=!1,v=!1,h="consoleLoggingClient",p=["ajaxLoggingClient","imageLoggingClient","consoleLoggingClient"],C={},t=0,F={},
q="requestId session marketplaceId marketplace service method client".split(" "),B={},D=function(){},G=1E3,I="https://fls-devo.vipinteg.amazon.com/",N="/1/payments-portal-log/1/TOP/",y="/1/action-impressions/1/TOP/payments-portal/action/",M=!1,W="",P="";g(function(){function a(){if(r.XDomainRequest){var d=new r.XDomainRequest;d.onerror=D;d.ontimeout=D;d.onprogress=D;d.onload=D;d.timeout=0;return d}if(r.XMLHttpRequest){d=new r.XMLHttpRequest;if(!("withCredentials"in d))throw"WithCredentials header not found Exception";
return d}if(r.ActiveXObject){for(var c=0;c<b.length&&!d;c++)try{d=new r.ActiveXObject(b[c]),b=[b[c]]}catch(e){}return d}}var b="MSXML2.XMLHTTP.6.0 MSXML2.XMLHTTP.5.0 MSXML2.XMLHTTP.4.0 MSXML2.XMLHTTP.3.0 MSXML2.XMLHTTP Microsoft.XMLHTTP".split(" ");return{name:"ajaxLoggingClient",send:function(b,d,c){var e=a();if(!e)throw"unable to Create ajax object Exception";b=c(b,d);e.open("GET",b,!0);e.send()},isPrimitive:!0}});g(function(){return{name:"imageLoggingClient",send:function(a,b,d){(new r.Image).src=
d(a,b)},isPrimitive:!0}});g(function(){return{name:"consoleLoggingClient",send:function(a){if(r.console&&r.console.log)r.console.log(a);else throw"Cannot Find console.log";},isPrimitive:!0}});g(function(){return{name:"chainedLoggingClient",send:function(a,b,d,c){c=m(c)?c:p;for(var e=0;e<c.length;e++)try{return C[c[e]].send(a,b,d)}catch(g){}throw"Failed to send log message using chainedLoggingClient";},isPrimitive:!1}});A.getClientNames=function(){var a=[],b;for(b in C)a.push(b);return a};A.setConfiguration=
function(e){e=e||{};"isTimberLoggingOn"in e&&(d(e.isTimberLoggingOn)?z=e.isTimberLoggingOn:c("isTimberLoggingOn must be a boolean"));"isPmetLoggingOn"in e&&(d(e.isPmetLoggingOn)?v=e.isPmetLoggingOn:c("isPmetLoggingOn must be a boolean"));e.foresterEndpoint&&a(e.foresterEndpoint)&&(I=f.trim(e.foresterEndpoint));e.timberLoggingChannel&&(a(e.timberLoggingChannel)?N=e.timberLoggingChannel:c("timberLoggingChannel must be a string"));e.pmetPostBackChannel&&(a(e.pmetPostBackChannel)?y=e.pmetPostBackChannel:
c("pmetPostBackChannel must be a string"));e.defaultClient&&(e.defaultClient in C?h=e.defaultClient:c("Specified Client not found"));"maxTimberLogCalls"in e&&(b(e.maxTimberLogCalls)&&0<e.maxTimberLogCalls?G=e.maxTimberLogCalls:c("maxTimberLogCalls must be a integer \x3e 0"));e.defaultChainedClientExecutionOrder&&(m(e.defaultChainedClientExecutionOrder)?p=e.defaultChainedClientExecutionOrder:c("defaultChainedClientExecutionOrder must be a array of strings with names exactly matching the exsisting clients; To know the client names use getClientNames() method"));
e.isSushiEelLoggingOn&&(d(e.isSushiEelLoggingOn)?M=e.isSushiEelLoggingOn:c("isSushiEelLoggingOn must be a boolean"));e.sushiEelEndPoint&&(a(e.sushiEelEndPoint)?W=e.sushiEelEndPoint:c("sushiEelEndPoint must be a string"));e.sushiEelSourceGroup&&(a(e.sushiEelSourceGroup)?P=e.sushiEelSourceGroup:c("sushiEelSourceGroup must be a string"))};A.setPmetHeaders=function(a){if(a){w=!1;for(var b=0;b<q.length;b++)if(q[b]in a)F[q[b]]=a[q[b]];else{c(q[b]+" is not found");return}w=!0}else c("PMET headers undefined")};
A.log=k;A.logLatencyMetric=function(b){v&&w&&b&&b.feature&&a(b.feature)&&b.resource&&a(b.resource)&&(B[b.feature]=B[b.feature]||{},B[b.feature][b.resource]=B[b.feature][b.resource]||[],b.startTime=b.startTime||x(),b.unit=b.unit||"ms",B[b.feature][b.resource].push({value:u()-b.startTime,unit:b.unit}))};A.logCounterMetric=function(d){if(v&&w&&d&&d.feature&&a(d.feature)&&d.resource&&a(d.resource)){B[d.feature]=B[d.feature]||{};B[d.feature][d.resource]=B[d.feature][d.resource]||[];var c;if(c="amount"in
d)c=d.amount,c=b(c)&&0<=c;d.amount=c?d.amount:1;0===B[d.feature][d.resource].length?B[d.feature][d.resource].push({value:d.amount,unit:"Count"}):B[d.feature][d.resource][0].value+=d.amount}};A.publishMetrics=function(){if(v&&w)try{var a,b="",d;for(d in B)if(B.hasOwnProperty(d)){var b=b+("/"+d+":"),c;for(c in B[d])if(B[d].hasOwnProperty(c))for(var e=0;e<B[d][c].length;++e)b+=c+"@v\x3d"+B[d][c][e].value,B[d][c][e].unit&&(b+="|u\x3d"+B[d][c][e].unit),b+=",";b=b.substring(0,b.length-1)}if(a=b){var g;
if(w){b="";for(d=0;d<q.length-1;++d)b+=q[d]+"\x3d"+F[q[d]]+"\x26";g=b+=q[q.length-1]+"\x3d"+F[q[q.length-1]]}else g=void 0;a+="?"+g;C.chainedLoggingClient.send(a,I+y,n);B={}}}catch(h){}};A.getCurrentTime=u;A.getWidgetStartTime=x;A.publishSushiEelMetrics=function(a){if(M)try{var b=new r.XMLHttpRequest;if(!("withCredentials"in b))throw"WithCredentials header not found Exception";var d=W+"1/events/"+P;b.onreadystatechange=function(){4===b.readyState&&k({customerId:a.CustomerId,widgetInstanceId:a.WidgetInstanceId,
sessionId:a.Session,status:b.status,message:a.ActionType+" , "+a.ActionValueType})};b.open("POST",d,!0);b.send(JSON.stringify({events:[{data:a}]}))}catch(c){}};return A});y("mash-helper",["AUI!P","clog","metrics-helper"],function(f,c,b){return{openInExternalBrowser:function(a,b,c){f.when("mash").execute(function(n){n.openInExternalBrowser({url:a,successCallback:b,failCallback:c})})},launchIntentURL:function(a,b,c,n,g,l){var k=this;f.when("mash").execute(function(m){m.launchIntentURL({url:a,successCallback:function(){k.launchIntentUrlSuccessCallback(c,
l)},failCallback:function(){k.launchIntentUrlFailCallBack(a,b,c,n,g,l)}})})},launchIntentUrlSuccessCallback:function(a,d){b.emitCounterMetric("LaunchIntentUrlSuccess",[d]);a()},publishOpenBrowserFailureMetric:function(a,d){a?b.emitCounterMetric("LaunchUrlFallback_ToEmbeddedBrowserFail",[d]):b.emitCounterMetric("LaunchUrlFallback_ToExternalBrowserFail",[d])},launchIntentUrlFailCallBack:function(a,d,c,n,g,l){var k=this;k.openIn=d.openIn;k.httpMethod=d.httpMethod;k.additionalPostData=d.additionalPostData;
b.emitCounterMetric("LaunchIntentUrlFallback",[l]);"externalBrowser"===k.openIn?(b.emitCounterMetric("LaunchIntentUrlFallback_ToExternalBrowser",[l]),k.openInExternalBrowser(a,c,function(){k.publishOpenBrowserFailureMetric(!1,l);c()})):"embeddedBrowser"===k.openIn?(b.emitCounterMetric("LaunchIntentUrlFallback_ToEmbeddedBrowser",[l]),k.showEmbeddedBrowser(a,k.httpMethod,k.additionalPostData,function(){},function(){k.publishOpenBrowserFailureMetric(!0,l)},c)):"showFallbackTemplate"===k.openIn?(b.emitCounterMetric("LaunchIntentUrlFallback_ToFallbackTemplate",
[l]),k.showMashFallbackTemplate(n,g)):b.emitCounterMetric("LaunchIntentUrlFallback_Failure",[l])},showMashFallbackTemplate:function(a,b){b(a)},publishCountMetrics:function(a){c.logCounterMetric({feature:a,resource:"_Count"});c.publishMetrics()},showEmbeddedBrowser:function(a,b,c,n,g,l,k){f.when("mash").execute(function(m){m.showEmbeddedBrowser({targetURL:a,method:b,postParameters:c,doneButtonCallback:l,successCallback:n,failCallback:g,enableDeeplinking:k})})},navigateToUrl:function(a){f.when("mash").execute(function(b){b.navigate({url:a})})},
clearNavigationHistory:function(){f.when("mash").execute(function(a){a.navstack.clearHistory({})})},addEventListener:function(a,b){f.when("mash").execute(function(c){c.addEventListener(a,b)})},dispatchEvent:function(a,b){f.when("mash").execute(function(c){c.dispatchEvent({type:a,detail:b})})},setBookmark:function(a){f.when("mash").execute(function(b){b.navstack.setBookmark({bookmark:a,successCallback:function(){},failCallback:function(a){console.error(a)}})})},backToBookmark:function(a){f.when("mash").execute(function(b){b.navstack.begin().backToBookmark(a).end({failCallback:function(a){console.log("cannot find bookmark"+
a)}})})},disableAutoScreenShot:function(){var a=this;f.when("mash").execute(function(b){"function"===typeof b.updateSecureSettings&&b.updateSecureSettings({isSecure:!0,autoDisableScreenShot:!0,successCallback:function(){console.log("Successfully set page as secure");a.publishCountMetrics("SetSecurePageSuccess")},failCallback:function(b){console.log("Failed to set page as secure: "+b);a.publishCountMetrics("SetSecurePageFailed")}})})},hideAppOverlays:function(){f.when("mash").execute(function(a){a.dispatchEvent({type:"appOverlays.Hide"})})},
setUrlInCurrentWebview:function(a){f.when("mash").execute(function(b){b.navstack.begin().replace({url:a}).end()})}}});y("metrics-helper",["lang","jQuery","widget","component","clog"],function(f,c,b,a,d){return{publishOnClickSuccessSushiMetrics:function(a,b){f.forEach(b,function(b){a.getDOMElement(b.JsBindElementId).click(function(){a.widget.publishSuccessSushiMetrics(b.MetricsObject)})},this)},emitCounterMetric:function(a,b,c){!1!==c&&d.logCounterMetric({feature:a,resource:"_Count"});(b=b&&b.filter(Boolean).join("."))&&
d.logCounterMetric({feature:a+"."+b,resource:"_Count"});d.publishMetrics()},emitLatencyMetric:function(a,b,c,l){!1!==l&&d.logLatencyMetric({feature:a,resource:"_Latency",startTime:b});(c=c&&c.filter(Boolean).join("."))&&d.logLatencyMetric({feature:a+"."+c,resource:"_Latency",startTime:b});d.publishMetrics()},logLatency:function(a,b,d){try{var c={};c[b]=(new Date).getTime()-d;d&&a.log(c)}catch(k){}}}});y("mini-browser-helper",[],function(){return{openInMiniBrowser:function(f,c,b){return r.open(f,c,
"toolbar\x3d0,scrollbars\x3d0,location\x3d1,statusbar\x3d0,menubar\x3d0,resizable\x3d1,width\x3d"+b.width+",height\x3d"+b.height+",left\x3d"+(r.screen.availLeft+r.screen.availWidth/2-b.width/2)+",top\x3d"+(r.screen.availTop+r.screen.availHeight/2-b.height/2))}}});y("modal-popover",["jQuery","base","AUI!P","clog"],function(f,c,b,a){return c.extend({initialize:function(a,b,c){this.widget=a;this.popoverName=b.data.popoverName;this.declarativeAction=b.data.declarativeAction;this.closeEventName=b.data.closeEventName||
this.popoverName+":close";this.bindToComponent(c)},bindToComponent:function(a){var b=this,c=a.bindToElements;a.bindToElements=function(){b.bindToElements.call(b);c.call(a)}},bindToElements:function(){var d=this,c=function(){d.widget.trigger(d.closeEventName)};b.when("A","a-modal").execute(function(a,b){var l=a.$("#"+d.declarativeAction);d.popoverInstance=b.get(l);d.popoverInstance.lock(100).show();a.on("a:declarative:a-popover-close:click",c)});d.widget.on(d.closeEventName,d,function(){d.popoverInstance&&
d.popoverInstance.isActive()&&(d._hidePopoverAndOff(c),d.widget.log({popoverCloseButtonClicked:!0}),a.logCounterMetric({feature:"PopoverCloseEvent",resource:"_Count"}))});d.widget.on("widget:clean",d,function(){var a=d.popoverInstance;a&&a.isActive()&&(delete a.typeSpecificFunctions.showMethod,delete a.typeSpecificFunctions.hideMethod,a=a.attrs("lightboxOptions"),a.showDuration=0,a.hideDuration=0,d._hidePopoverAndOff(c))})},_hidePopoverAndOff:function(a){var c=this;c.popoverInstance.unlock(100).hide();
b.when("a-modal").execute(function(a){a.remove(c.declarativeAction)});b.when("A").execute(function(b){b.off("a:declarative:a-popover-close:click",a)})}})});y("number-format",["base","lang"],function(f,c){var b={AUD:"$",BRL:"R$",CAD:"$",CNY:"",EUR:"",GBP:"",INR:"\x3cspan class\x3d'pmts-INR-currency-symbol'\x3e\x26nbsp;\x26nbsp;\x3c/span\x3e",JPY:"",MXN:"$",RUB:"py6.",USD:"$"},a={AU:{fixedDecimalPrecision:2,numberDelim:",",radix:"."},BR:{fixedDecimalPrecision:2,numberDelim:".",radix:","},CA:{fixedDecimalPrecision:2,
numberDelim:",",radix:"."},CN:{fixedDecimalPrecision:2,numberDelim:",",radix:"."},DE:{fixedDecimalPrecision:2,numberDelim:".",radix:","},ES:{fixedDecimalPrecision:2,numberDelim:".",radix:","},FR:{fixedDecimalPrecision:2,numberDelim:".",radix:","},GB:{fixedDecimalPrecision:2,numberDelim:",",radix:"."},IT:{fixedDecimalPrecision:2,numberDelim:".",radix:","},IN:{fixedDecimalPrecision:2,numberDelim:",",radix:"."},JP:{fixedDecimalPrecision:0,numberDelim:",",radix:"."},MX:{fixedDecimalPrecision:2,numberDelim:",",
radix:"."},NL:{fixedDecimalPrecision:2,numberDelim:".",radix:","},RU:{fixedDecimalPrecision:2,numberDelim:".",radix:",",symbolAfterNumber:!0},US:{fixedDecimalPrecision:2,numberDelim:",",radix:"."}};return f.extend({SUPPORTED_COUNTRIES:c.keys(a),initialize:function(d,e){if(-1===c.indexOf(this.SUPPORTED_COUNTRIES,d))throw Error("The country provided is invalid or not supported.");e&&e.currency&&!e.useCurrencyCode&&(e.currency=b[e.currency]);this.formatConfig=c.extend({},a[d],e)},format:function(a){var b=
[],c=Number(a);if(null===a||""===a||isNaN(c))throw Error("The amount value is invalid. It must be represented as a decimal number in string format.");a=Math.abs(c);0>c&&b.push("- ");this.formatConfig.currency&&!this.formatConfig.symbolAfterNumber&&(b.push(this.formatConfig.currency),this.formatConfig.useCurrencyCode&&b.push(" "));for(var c=a.toFixed(this.formatConfig.fixedDecimalPrecision).split("."),g=a=c[0].length,l;0<g;)l=(g-1)%3+1,b.push(c[0].substr(a-g,l)),g-=l,0<g&&b.push(this.formatConfig.numberDelim);
0<this.formatConfig.fixedDecimalPrecision&&(b.push(this.formatConfig.radix),b.push(c[1]));this.formatConfig.currency&&this.formatConfig.symbolAfterNumber&&(b.push(" "),b.push(this.formatConfig.currency));return b.join("")},localizedParseNumber:function(a){if(c.isDefined(a)){a=a.split(this.formatConfig.radix);if(2<a.length)return NaN;var b=this.formatConfig.numberDelim,n=a[0].split(b);if(2>n.length)b=a[0];else if((new RegExp("^-{0,1}[1-9]{1,3}(\\"+b+"[0-9]{3})*$")).test(a[0]))b=n.join("");else return NaN;
return 1===a.length?Number(b):Number(b+"."+a[1])}return NaN}})});y("popover-base",["AUI!P","base","lang","jQuery"],function(f,c,b,a){return c.extend({auiOptions:null,customOptions:null,$elem:null,initialize:function(a,c,n){this.$elem=a;this.auiOptions=c;this.customOptions=b.extend({},n)},auiShow:function(a,c,n){var g=this;c=g._defaultValue(c,{});n=g._defaultValue(n,!1);g._auiDefined(function(l){l&&(n&&(g.auiOptions={}),c=b.extend({},g.auiOptions,c),a?g._auiSet(g.$elem,c):g._auiRemove(g.$elem))})},
customShow:function(a,c,n){var g=this;c=g._defaultValue(c,{});n=g._defaultValue(n,!1);g._auiDefined(function(l){l||(n&&(g.customOptions={}),c=b.extend({},g.customOptions,c),a?g._customSet(g.$elem,c):g._customHide(g.$elem))})},_auiSet:function(a,b){f&&this.componentName&&f.when("A",this.componentName).execute(function(c,g){(c=g.get(a))?c.update(b):g.create(a,b)})},_auiDefined:function(a){f&&f.when("A",this.componentName).execute(function(b,c){a("undefined"!==typeof c)})},_auiRemove:function(a){f&&
this.componentName&&f.when("A",this.componentName).execute(function(b,c){c.remove(a)})},_customSet:function(b,c){f&&f.when("A","a-popover-base").execute(function(n,g){(n=g.get(b))||(n=g.show({$trigger:b,skin:function(a){return['\x3cdiv class\x3d"a-popover"\x3e\x3cdiv class\x3d"a-popover-wrapper"\x3e','\x3cdiv class\x3d"a-popover-inner"\x3e'+a+"\x3c/div\x3e",'\x3cdiv class\x3d"a-arrow-border"\x3e\x3cdiv class\x3d"a-arrow"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'].join("")},alone:!1,update:function(b){a(".a-popover-inner",
this.$popover).html(b)},content:c.literalContent,position:c.position||"triggerLeft"}));n&&(n.update(c.literalContent),n.updatePosition())})},_customHide:function(a){f&&f.when("A","a-popover-base").execute(function(b,c){c.hide(a)})},_defaultValue:function(a,b){return"undefined"!==typeof a?a:b}})});y("popover",["popover-base"],function(f){return f.extend({componentName:"a-popover"})});y("public-event-registry",["lang"],function(f){var c=[];return{register:function(b){var a=this;f.forEach(arguments,
function(b){f.isString(b)&&!a.has(b)&&c.push(b)})},has:function(b){return f.isString(b)&&0<=f.indexOf(c,b)}}});y("redirection-helper",["jQuery","clog"],function(f,c){return{handleRedirection:function(b,a,c,e){b&&(c=JSON.parse(c),c=this.getQueryParameters(b,c),this.publishRedirectionMetrics(c,e),e.log({httpMethod:a,redirectUrl:b,parsedHttpParameters:c}),b=b.split("?")[0],"POST"===a?this.post(b,c):this.get(b,c))},post:function(b,a){var c=document.createElement("form");c.setAttribute("method","post");
c.setAttribute("action",this.decodeHtml(b));if(a)for(var e in a)a.hasOwnProperty(e)&&(b=document.createElement("input"),b.setAttribute("type","hidden"),b.setAttribute("name",e),b.setAttribute("value",this.decodeHtml(a[e])),c.appendChild(b));document.body.appendChild(c);c.submit()},get:function(b,a){b=this.buildURL(b,a);"true"===a.isJuspayRequired?(document.body.style.display="none",(r.cordova&&r.cordova.require("cordova/exec"))(this.juspayRedirectionSuccess,this.juspayRedirectionFailed,"MASHJuspayPayment",
"ShowJuspayBrowser",[b,"POST",a])):r.location.href=this.decodeHtml(b)},buildURL:function(b,a){return a?(a=this.queryParams(a),b+"?"+a):b},decodeHtml:function(b){return(new DOMParser).parseFromString(b,"text/html").documentElement.textContent},queryParams:function(b){var a=[],c;for(c in b)a.push(encodeURIComponent(c)+"\x3d"+encodeURIComponent(b[c]));return a.join("\x26")},getQueryParameters:function(b,a){(b=b.split("?")[1])&&b.split("\x26").forEach(function(b){b=b.split("\x3d");a[decodeURIComponent(b[0])]=
decodeURIComponent(b[1])});return a},juspayRedirectionSuccess:function(){console.log("Juspay redirection successful")},juspayRedirectionFailed:function(){console.log("Juspay redirection failed")},publishRedirectionMetrics:function(b,a){b.errorCode?(this.publishCountMetrics("RedirectionToFailureCallbackUrl_ErrorCode_"+b.errorCode),a.publishFailureSushiMetrics({ActionType:"RedirectionToFailureCallbackUrl",ActionParentValue:"ErrorCode",ActionParentValueType:b.errorCode,ActionValueType:"ErrorDetails",
ActionValue:b.errorDetails})):b.status?(this.publishCountMetrics("RedirectionToCallbackUrl_Status_"+b.status),a.publishSuccessSushiMetrics({ActionType:"RedirectionToCallbackUrl",ActionValueType:"PaymentStatus",ActionValue:b.status})):"true"===b.isJuspayRequired?(this.publishCountMetrics("RedirectionToJuspayBrowser"),a.publishSuccessSushiMetrics({ActionType:"RedirectionToJuspayBrowser",ActionValueType:"RedirectionStatus",ActionValue:"Success"})):(this.publishCountMetrics("RedirectionToAIPS"),a.publishSuccessSushiMetrics({ActionType:"RedirectionToAIPS",
ActionValueType:"RedirectionStatus",ActionValue:"Success"}))},publishCountMetrics:function(b){c.logCounterMetric({feature:b,resource:"_Count"});c.publishMetrics()}}});y("sdk-client",[],function(){var f;try{f=function(c){function b(d){if(a[d])return a[d].exports;var e=a[d]={i:d,l:!1,exports:{}};return c[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var a={};return b.m=c,b.c=a,b.d=function(a,c,n){b.o(a,c)||Object.defineProperty(a,c,{enumerable:!0,get:n})},b.r=function(a){"undefined"!=typeof Symbol&&
Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},b.t=function(a,c){if((1&c&&(a=b(a)),8&c)||4&c&&"object"==typeof a&&a&&a.__esModule)return a;var n=Object.create(null);if(b.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:a}),2&c&&"string"!=typeof a)for(var g in a)b.d(n,g,function(b){return a[b]}.bind(null,g));return n},b.n=function(a){var c=a&&a.__esModule?function(){return a.default}:function(){return a};
return b.d(c,"a",c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p="",b(b.s=275)}([function(c,b,a){(function(a){var b=function(a){return a&&a.Math==Math&&a};c.exports=b("object"==typeof globalThis&&globalThis)||b("object"==typeof r&&r)||b("object"==typeof self&&self)||b("object"==typeof a&&a)||Function("return this")()}).call(this,a(170))},function(c,b,a){var d=a(0),e=a(37).f,n=a(16),g=a(17),l=a(101),k=a(135),m=a(106);c.exports=function(a,b){var c,f,w,v,h,p=a.target,C=
a.global,t=a.stat;if(c=C?d:t?d[p]||l(p,{}):(d[p]||{}).prototype)for(f in b){if(v=b[f],w=a.noTargetGet?(h=e(c,f))&&h.value:c[f],!m(C?f:p+(t?".":"#")+f,a.forced)&&void 0!==w){if(typeof v==typeof w)continue;k(v,w)}(a.sham||w&&w.sham)&&n(v,"sham",!0);g(c,f,v,a)}}},function(c,b){c.exports=function(a){try{return!!a()}catch(b){return!0}}},function(c,b,a){c=a(99);b=a(17);a=a(172);c||b(Object.prototype,"toString",a,{unsafe:!0})},function(c,b,a){b=a(0);var d=a(100),e=a(9),n=a(57),g=a(103);a=a(134);var l=d("wks"),
k=b.Symbol,m=a?k:k&&k.withoutSetter||n;c.exports=function(a){return e(l,a)||(g&&e(k,a)?l[a]=k[a]:l[a]=m("Symbol."+a)),l[a]}},function(c,b){c.exports=function(a){return"object"==typeof a?null!==a:"function"==typeof a}},function(c,b,a){c=a(1);b=a(7);c({target:"Object",stat:!0,forced:!b,sham:!b},{defineProperty:a(12).f})},function(c,b,a){b=a(2);c.exports=!b(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})},,function(c,b){var a={}.hasOwnProperty;c.exports=function(b,c){return a.call(b,
c)}},function(c,b,a){var d=a(5);c.exports=function(a){if(!d(a))throw TypeError(String(a)+" is not an object");return a}},function(c,b,a){var d=a(26);b=a(183);var e=a(52),n=a(24);a=a(109);var g=n.set,l=n.getterFor("Array Iterator");c.exports=a(Array,"Array",function(a,b){g(this,{type:"Array Iterator",target:d(a),index:0,kind:b})},function(){var a=l(this),b=a.target,c=a.kind,d=a.index++;return!b||d>=b.length?(a.target=void 0,{value:void 0,done:!0}):"keys"==c?{value:d,done:!1}:"values"==c?{value:b[d],
done:!1}:{value:[d,b[d]],done:!1}},"values");e.Arguments=e.Array;b("keys");b("values");b("entries")},function(c,b,a){c=a(7);var d=a(133),e=a(10),n=a(56),g=Object.defineProperty;b.f=c?g:function(a,b,c){if(e(a),b=n(b,!0),e(c),d)try{return g(a,b,c)}catch(u){}if("get"in c||"set"in c)throw TypeError("Accessors not supported");return"value"in c&&(a[b]=c.value),a}},function(c,b,a){var d=a(40),e=Math.min;c.exports=function(a){return 0<a?e(d(a),9007199254740991):0}},function(c,b,a){var d,e,n,g;c=a(1);var l=
a(35),k=a(0);b=a(27);var m=a(174),u=a(17),f=a(94),A=a(23),z=a(95),w=a(5),v=a(38),h=a(46),p=a(32),C=a(104),t=a(107),F=a(96),q=a(53),B=a(139).set,D=a(175),G=a(176),I=a(177),N=a(142),r=a(178),M=a(24),W=a(106),P=a(4),y=a(115),O=P("species"),ha=M.get,sa=M.set,E=M.getterFor("Promise"),H=m,K=k.TypeError,ia=k.document,ba=k.process,Q=b("fetch"),J=N.f,X=J,L="process"==p(ba),T=!!(ia&&ia.createEvent&&k.dispatchEvent),F=(a=W("Promise",function(){if(C(H)===String(H)&&(66===y||!L&&"function"!=typeof PromiseRejectionEvent)||
l&&!H.prototype.finally)return!0;if(51<=y&&/native code/.test(H))return!1;var a=H.resolve(1),b=function(a){a(function(){},function(){})};return(a.constructor={})[O]=b,!(a.then(function(){})instanceof b)}))||!F(function(a){H.all(a).catch(function(){})}),Z=function(a){var b;return!(!w(a)||"function"!=typeof(b=a.then))&&b},la=function(a,b,c){if(!b.notified){b.notified=!0;var d=b.reactions;D(function(){for(var e=b.value,g=1==b.state,h=0;d.length>h;){var p,q,n,l=d[h++],m=g?l.ok:l.fail,C=l.resolve,D=l.reject,
k=l.domain;try{m?(g||(2===b.rejection&&ka(a,b),b.rejection=1),!0===m?p=e:(k&&k.enter(),p=m(e),k&&(k.exit(),n=!0)),p===l.promise?D(K("Promise-chain cycle")):(q=Z(p))?q.call(p,C,D):C(p)):D(e)}catch(t){k&&!n&&k.exit(),D(t)}}b.reactions=[];b.notified=!1;c&&!b.rejection&&aa(a,b)})}},S=function(a,b,c){var d,e;T?((d=ia.createEvent("Event")).promise=b,d.reason=c,d.initEvent(a,!1,!0),k.dispatchEvent(d)):d={promise:b,reason:c};(e=k["on"+a])?e(d):"unhandledrejection"===a&&I("Unhandled promise rejection",c)},
aa=function(a,b){B.call(k,function(){var c,d=b.value;if(1!==b.rejection&&!b.parent&&(c=r(function(){L?ba.emit("unhandledRejection",d,a):S("unhandledrejection",a,d)}),b.rejection=L||1!==b.rejection&&!b.parent?2:1,c.error))throw c.value;})},ka=function(a,b){B.call(k,function(){L?ba.emit("rejectionHandled",a):S("rejectionhandled",a,b.value)})},U=function(a,b,c,d){return function(e){a(b,c,e,d)}},V=function(a,b,c,d){b.done||(b.done=!0,d&&(b=d),b.value=c,b.state=2,la(a,b,!0))},da=function(a,b,c,d){if(!b.done){b.done=
!0;d&&(b=d);try{if(a===c)throw K("Promise can't be resolved itself");var e=Z(c);e?D(function(){var d={done:!1};try{e.call(c,U(da,a,d,b),U(V,a,d,b))}catch(g){V(a,d,g,b)}}):(b.value=c,b.state=1,la(a,b,!1))}catch(g){V(a,{done:!1},g,b)}}};a&&(H=function(a){h(this,H,"Promise");v(a);d.call(this);var b=ha(this);try{a(U(da,this,b),U(V,this,b))}catch(c){V(this,b,c)}},(d=function(a){sa(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=f(H.prototype,
{then:function(a,b){var c=E(this),d=J(q(this,H));return d.ok="function"!=typeof a||a,d.fail="function"==typeof b&&b,d.domain=L?ba.domain:void 0,c.parent=!0,c.reactions.push(d),0!=c.state&&la(this,c,!1),d.promise},catch:function(a){return this.then(void 0,a)}}),e=function(){var a=new d,b=ha(a);this.promise=a;this.resolve=U(da,a,b);this.reject=U(V,a,b)},N.f=J=function(a){return a===H||a===n?new e(a):X(a)},l||"function"!=typeof m||(g=m.prototype.then,u(m.prototype,"then",function(a,b){var c=this;return(new H(function(a,
b){g.call(c,a,b)})).then(a,b)},{unsafe:!0}),"function"==typeof Q&&c({global:!0,enumerable:!0,forced:!0},{fetch:function(a){return G(H,Q.apply(k,arguments))}})));c({global:!0,wrap:!0,forced:a},{Promise:H});A(H,"Promise",!1,!0);z("Promise");n=b("Promise");c({target:"Promise",stat:!0,forced:a},{reject:function(a){var b=J(this);return b.reject.call(void 0,a),b.promise}});c({target:"Promise",stat:!0,forced:l||a},{resolve:function(a){return G(l&&this===n?H:this,a)}});c({target:"Promise",stat:!0,forced:F},
{all:function(a){var b=this,c=J(b),d=c.resolve,e=c.reject,g=r(function(){var c=v(b.resolve),g=[],h=0,p=1;t(a,function(a){var q=h++,n=!1;g.push(void 0);p++;c.call(b,a).then(function(a){n||(n=!0,g[q]=a,--p||d(g))},e)});--p||d(g)});return g.error&&e(g.value),c.promise},race:function(a){var b=this,c=J(b),d=c.reject,e=r(function(){var e=v(b.resolve);t(a,function(a){e.call(b,a).then(c.resolve,d)})});return e.error&&d(e.value),c.promise}})},function(c,b,a){(function(b){function c(a){return(c="function"==
typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}a(28);a(29);a(181);a(30);a(182);a(49);a(11);a(90);a(25);a(18);a(31);a(185);a(186);a(43);a(44);a(45);a(3);a(14);a(21);a(20);a(50);a(22);(function(a){function g(a,b,c,d){b=Object.create((b&&b.prototype instanceof k?b:k).prototype);d=new h(d||[]);return b._invoke=function(a,b,c){var d="suspendedStart";return function(e,
g){if("executing"===d)throw Error("Generator is already running");if("completed"===d){if("throw"===e)throw g;return C()}c.method=e;for(c.arg=g;;){if(e=c.delegate)if(e=z(e,c)){if(e===N)continue;return e}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if("suspendedStart"===d)throw d="completed",c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);d="executing";e=l(a,b,c);if("normal"===e.type){if(d=c.done?"completed":"suspendedYield",e.arg===N)continue;
return{value:e.arg,done:c.done}}"throw"===e.type&&(d="completed",c.method="throw",c.arg=e.arg)}}}(a,c,d),b}function l(a,b,c){try{return{type:"normal",arg:a.call(b,c)}}catch(d){return{type:"throw",arg:d}}}function k(){}function m(){}function u(){}function f(a){["next","throw","return"].forEach(function(b){a[b]=function(a){return this._invoke(b,a)}})}function A(a){var b;this._invoke=function(d,g){function h(){return new Promise(function(b,h){!function H(b,d,g,h){b=l(a[b],a,d);if("throw"!==b.type){var p=
b.arg;return(b=p.value)&&"object"===c(b)&&F.call(b,"__await")?Promise.resolve(b.__await).then(function(a){H("next",a,g,h)},function(a){H("throw",a,g,h)}):Promise.resolve(b).then(function(a){p.value=a;g(p)},function(a){return H("throw",a,g,h)})}h(b.arg)}(d,g,b,h)})}return b=b?b.then(h,h):h()}}function z(a,b){var c=a.iterator[b.method];if(void 0===c){if(b.delegate=null,"throw"===b.method){if(a.iterator.return&&(b.method="return",b.arg=void 0,z(a,b),"throw"===b.method))return N;b.method="throw";b.arg=
new TypeError("The iterator does not provide a 'throw' method")}return N}c=l(c,a.iterator,b.arg);return"throw"===c.type?(b.method="throw",b.arg=c.arg,b.delegate=null,N):(c=c.arg)?c.done?(b[a.resultName]=c.value,b.next=a.nextLoc,"return"!==b.method&&(b.method="next",b.arg=void 0),b.delegate=null,N):c:(b.method="throw",b.arg=new TypeError("iterator result is not an object"),b.delegate=null,N)}function w(a){var b={tryLoc:a[0]};1 in a&&(b.catchLoc=a[1]);2 in a&&(b.finallyLoc=a[2],b.afterLoc=a[3]);this.tryEntries.push(b)}
function v(a){var b=a.completion||{};b.type="normal";delete b.arg;a.completion=b}function h(a){this.tryEntries=[{tryLoc:"root"}];a.forEach(w,this);this.reset(!0)}function p(a){if(a){var b=a[B];if(b)return b.call(a);if("function"==typeof a.next)return a;if(!isNaN(a.length)){var c=-1,b=function O(){for(;++c<a.length;)if(F.call(a,c))return O.value=a[c],O.done=!1,O;return O.value=void 0,O.done=!0,O};return b.next=b}}return{next:C}}function C(){return{value:void 0,done:!0}}var t=Object.prototype,F=t.hasOwnProperty,
q="function"==typeof Symbol?Symbol:{},B=q.iterator||"@@iterator",D=q.asyncIterator||"@@asyncIterator",G=q.toStringTag||"@@toStringTag",q="object"===c(b),I=a.regeneratorRuntime;if(I)q&&(b.exports=I);else{(I=a.regeneratorRuntime=q?b.exports:{}).wrap=g;var N={};a={};a[B]=function(){return this};(q=(q=Object.getPrototypeOf)&&q(q(p([]))))&&q!==t&&F.call(q,B)&&(a=q);var r=u.prototype=k.prototype=Object.create(a);m.prototype=r.constructor=u;u.constructor=m;u[G]=m.displayName="GeneratorFunction";I.isGeneratorFunction=
function(a){a="function"==typeof a&&a.constructor;return!!a&&(a===m||"GeneratorFunction"===(a.displayName||a.name))};I.mark=function(a){return Object.setPrototypeOf?Object.setPrototypeOf(a,u):(a.__proto__=u,G in a||(a[G]="GeneratorFunction")),a.prototype=Object.create(r),a};I.awrap=function(a){return{__await:a}};f(A.prototype);A.prototype[D]=function(){return this};I.AsyncIterator=A;I.async=function(a,b,c,d){var e=new A(g(a,b,c,d));return I.isGeneratorFunction(b)?e:e.next().then(function(a){return a.done?
a.value:e.next()})};f(r);r[G]="Generator";r[B]=function(){return this};r.toString=function(){return"[object Generator]"};I.keys=function(a){var b=[],c;for(c in a)b.push(c);return b.reverse(),function O(){for(;b.length;){var c=b.pop();if(c in a)return O.value=c,O.done=!1,O}return O.done=!0,O}};I.values=p;h.prototype={constructor:h,reset:function(a){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(v),!a)for(var b in this)"t"===
b.charAt(0)&&F.call(this,b)&&!isNaN(+b.slice(1))&&(this[b]=void 0)},stop:function(){this.done=!0;var a=this.tryEntries[0].completion;if("throw"===a.type)throw a.arg;return this.rval},dispatchException:function(a){function b(d,e){return g.type="throw",g.arg=a,c.next=d,e&&(c.method="next",c.arg=void 0),!!e}if(this.done)throw a;for(var c=this,d=this.tryEntries.length-1;0<=d;--d){var e=this.tryEntries[d],g=e.completion;if("root"===e.tryLoc)return b("end");if(e.tryLoc<=this.prev){var h=F.call(e,"catchLoc"),
p=F.call(e,"finallyLoc");if(h&&p){if(this.prev<e.catchLoc)return b(e.catchLoc,!0);if(this.prev<e.finallyLoc)return b(e.finallyLoc)}else if(h){if(this.prev<e.catchLoc)return b(e.catchLoc,!0)}else{if(!p)throw Error("try statement without catch or finally");if(this.prev<e.finallyLoc)return b(e.finallyLoc)}}}},abrupt:function(a,b){for(var c=this.tryEntries.length-1;0<=c;--c){var d=this.tryEntries[c];if(d.tryLoc<=this.prev&&F.call(d,"finallyLoc")&&this.prev<d.finallyLoc){var e=d;break}}e&&("break"===a||
"continue"===a)&&e.tryLoc<=b&&b<=e.finallyLoc&&(e=null);c=e?e.completion:{};return c.type=a,c.arg=b,e?(this.method="next",this.next=e.finallyLoc,N):this.complete(c)},complete:function(a,b){if("throw"===a.type)throw a.arg;return"break"===a.type||"continue"===a.type?this.next=a.arg:"return"===a.type?(this.rval=this.arg=a.arg,this.method="return",this.next="end"):"normal"===a.type&&b&&(this.next=b),N},finish:function(a){for(var b=this.tryEntries.length-1;0<=b;--b){var c=this.tryEntries[b];if(c.finallyLoc===
a)return this.complete(c.completion,c.afterLoc),v(c),N}},catch:function(a){for(var b=this.tryEntries.length-1;0<=b;--b){var c=this.tryEntries[b];if(c.tryLoc===a){a=c.completion;if("throw"===a.type){var d=a.arg;v(c)}return d}}throw Error("illegal catch attempt");},delegateYield:function(a,b,c){return this.delegate={iterator:p(a),resultName:b,nextLoc:c},"next"===this.method&&(this.arg=void 0),N}}}})(function(){return this||"object"===("undefined"==typeof self?"undefined":c(self))&&self}()||Function("return this")())}).call(this,
a(179)(c))},function(c,b,a){b=a(7);var d=a(12),e=a(39);c.exports=b?function(a,b,c){return d.f(a,b,e(1,c))}:function(a,b,c){return a[b]=c,a}},function(c,b,a){var d=a(0),e=a(16),n=a(9),g=a(101),l=a(104);b=a(24);var k=b.get,m=b.enforce,u=String(String).split("String");(c.exports=function(a,b,c,l){var k=!!l&&!!l.unsafe,h=!!l&&!!l.enumerable;l=!!l&&!!l.noTargetGet;"function"==typeof c&&("string"!=typeof b||n(c,"name")||e(c,"name",b),m(c).source=u.join("string"==typeof b?b:""));a!==d?(k?!l&&a[b]&&(h=!0):
delete a[b],h?a[b]=c:e(a,b,c)):h?a[b]=c:g(b,c)})(Function.prototype,"toString",function(){return"function"==typeof this&&k(this).source||l(this)})},function(c,b,a){c=a(17);b=Date.prototype;var d=b.toString,e=b.getTime;"Invalid Date"!=new Date(NaN)+""&&c(b,"toString",function(){var a=e.call(this);return a==a?d.call(this):"Invalid Date"})},function(c,b,a){var d=a(36);c.exports=function(a){return Object(d(a))}},function(c,b,a){var d=a(119).charAt;c=a(24);a=a(109);var e=c.set,n=c.getterFor("String Iterator");
a(String,"String",function(a){e(this,{type:"String Iterator",string:String(a),index:0})},function(){var a,b=n(this),c=b.string,e=b.index;return e>=c.length?{value:void 0,done:!0}:(a=d(c,e),b.index+=a.length,{value:a,done:!1})})},function(c,b,a){c=a(17);var d=a(10);b=a(2);var e=a(156),n=RegExp.prototype,g=n.toString;a=b(function(){return"/a/b"!=g.call({source:"a",flags:"b"})});b="toString"!=g.name;(a||b)&&c(RegExp.prototype,"toString",function(){var a=d(this),b=a.flags;return"/"+String(a.source)+"/"+
String(void 0===b&&a instanceof RegExp&&!("flags"in n)?e.call(a):b)},{unsafe:!0})},function(c,b,a){c=a(0);b=a(147);var d=a(11),e=a(16),n=a(4);a=n("iterator");var n=n("toStringTag"),g=d.values,l;for(l in b){var k=c[l];if(k=k&&k.prototype){if(k[a]!==g)try{e(k,a,g)}catch(u){k[a]=g}if(k[n]||e(k,n,l),b[l])for(var m in d)if(k[m]!==d[m])try{e(k,m,d[m])}catch(u){k[m]=d[m]}}}},function(c,b,a){var d=a(12).f,e=a(9),n=a(4)("toStringTag");c.exports=function(a,b,c){a&&!e(a=c?a:a.prototype,n)&&d(a,n,{configurable:!0,
value:b})}},function(c,b,a){var d,e,n;b=a(171);var g=a(0),l=a(5),k=a(16),m=a(9),u=a(86);a=a(51);g=g.WeakMap;if(b){var f=new g,A=f.get,z=f.has,w=f.set;d=function(a,b){return w.call(f,a,b),b};e=function(a){return A.call(f,a)||{}};n=function(a){return z.call(f,a)}}else{var v=u("state");a[v]=!0;d=function(a,b){return k(a,v,b),b};e=function(a){return m(a,v)?a[v]:{}};n=function(a){return m(a,v)}}c.exports={set:d,get:e,has:n,enforce:function(a){return n(a)?e(a):d(a,{})},getterFor:function(a){return function(b){var c;
if(!l(b)||(c=e(b)).type!==a)throw TypeError("Incompatible receiver, "+a+" required");return c}}}},function(c,b,a){c=a(1);var d=a(5),e=a(48),n=a(58),g=a(13),l=a(26),k=a(116);b=a(4);var m=a(155);a=a(60);m=m("slice");a=a("slice",{ACCESSORS:!0,0:0,1:2});var f=b("species"),x=[].slice,A=Math.max;c({target:"Array",proto:!0,forced:!m||!a},{slice:function(a,b){var c,h,p=l(this);h=g(p.length);a=n(a,h);b=n(void 0===b?h:b,h);if(e(p)&&("function"!=typeof(c=p.constructor)||c!==Array&&!e(c.prototype)?d(c)&&null===
(c=c[f])&&(c=void 0):c=void 0,c===Array||void 0===c))return x.call(p,a,b);c=new (void 0===c?Array:c)(A(b-a,0));for(h=0;a<b;a++,h++)a in p&&k(c,h,p[a]);return c.length=h,c}})},function(c,b,a){var d=a(92),e=a(36);c.exports=function(a){return d(e(a))}},function(c,b,a){var d=a(136),e=a(0),n=function(a){return"function"==typeof a?a:void 0};c.exports=function(a,b){return 2>arguments.length?n(d[a])||n(e[a]):d[a]&&d[a][b]||e[a]&&e[a][b]}},function(c,b,a){c=a(1);var d=a(0),e=a(27);b=a(35);var n=a(7),g=a(103),
l=a(134),k=a(2),m=a(9),f=a(48),x=a(5),A=a(10),z=a(19),w=a(26),v=a(56),h=a(39),p=a(33),C=a(97),t=a(59),F=a(180),q=a(113),B=a(37),D=a(12),G=a(112),I=a(16),r=a(17),y=a(100),M=a(86),W=a(51),E=a(57),fa=a(4),O=a(143),ha=a(89),sa=a(23),Y=a(24),H=a(34).forEach,K=M("hidden");a=fa("toPrimitive");var ia=Y.set,ba=Y.getterFor("Symbol"),Q=Object.prototype,J=d.Symbol,X=e("JSON","stringify"),L=B.f,T=D.f,Z=F.f,la=G.f,S=y("symbols"),aa=y("op-symbols"),ka=y("string-to-symbol-registry"),U=y("symbol-to-string-registry"),
e=y("wks"),d=d.QObject,V=!d||!d.prototype||!d.prototype.findChild,da=n&&k(function(){return 7!=p(T({},"a",{get:function(){return T(this,"a",{value:7}).a}})).a})?function(a,b,c){var d=L(Q,b);d&&delete Q[b];T(a,b,c);d&&a!==Q&&T(Q,b,d)}:T,ma=function(a,b){var c=S[a]=p(J.prototype);return ia(c,{type:"Symbol",tag:a,description:b}),n||(c.description=b),c},R=l?function(a){return"symbol"==typeof a}:function(a){return Object(a)instanceof J},na=function(a,b,c){a===Q&&na(aa,b,c);A(a);b=v(b,!0);return A(c),m(S,
b)?(c.enumerable?(m(a,K)&&a[K][b]&&(a[K][b]=!1),c=p(c,{enumerable:h(0,!1)})):(m(a,K)||T(a,K,h(1,{})),a[K][b]=!0),da(a,b,c)):T(a,b,c)},oa=function(a,b){A(a);var c=w(b);b=C(c).concat(pa(c));return H(b,function(b){n&&!ja.call(c,b)||na(a,b,c[b])}),a},ja=function(a){a=v(a,!0);var b=la.call(this,a);return!(this===Q&&m(S,a)&&!m(aa,a))&&(!(b||!m(this,a)||!m(S,a)||m(this,K)&&this[K][a])||b)},l=function(a,b){a=w(a);b=v(b,!0);if(a!==Q||!m(S,b)||m(aa,b)){var c=L(a,b);return!c||!m(S,b)||m(a,K)&&a[K][b]||(c.enumerable=
!0),c}},d=function(a){a=Z(w(a));var b=[];return H(a,function(a){m(S,a)||m(W,a)||b.push(a)}),b},pa=function(a){var b=a===Q;a=Z(b?aa:w(a));var c=[];return H(a,function(a){!m(S,a)||b&&!m(Q,a)||c.push(S[a])}),c};(g||(r((J=function(){if(this instanceof J)throw TypeError("Symbol is not a constructor");var a=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,b=E(a),c=function(a){this===Q&&c.call(aa,a);m(this,K)&&m(this[K],b)&&(this[K][b]=!1);da(this,b,h(1,a))};return n&&V&&da(Q,b,{configurable:!0,
set:c}),ma(b,a)}).prototype,"toString",function(){return ba(this).tag}),r(J,"withoutSetter",function(a){return ma(E(a),a)}),G.f=ja,D.f=na,B.f=l,t.f=F.f=d,q.f=pa,O.f=function(a){return ma(fa(a),a)},n&&(T(J.prototype,"description",{configurable:!0,get:function(){return ba(this).description}}),b||r(Q,"propertyIsEnumerable",ja,{unsafe:!0}))),c({global:!0,wrap:!0,forced:!g,sham:!g},{Symbol:J}),H(C(e),function(a){ha(a)}),c({target:"Symbol",stat:!0,forced:!g},{for:function(a){a=String(a);if(m(ka,a))return ka[a];
var b=J(a);return ka[a]=b,U[b]=a,b},keyFor:function(a){if(!R(a))throw TypeError(a+" is not a symbol");if(m(U,a))return U[a]},useSetter:function(){V=!0},useSimple:function(){V=!1}}),c({target:"Object",stat:!0,forced:!g,sham:!n},{create:function(a,b){return void 0===b?p(a):oa(p(a),b)},defineProperty:na,defineProperties:oa,getOwnPropertyDescriptor:l}),c({target:"Object",stat:!0,forced:!g},{getOwnPropertyNames:d,getOwnPropertySymbols:pa}),c({target:"Object",stat:!0,forced:k(function(){q.f(1)})},{getOwnPropertySymbols:function(a){return q.f(z(a))}}),
X)&&c({target:"JSON",stat:!0,forced:!g||k(function(){var a=J();return"[null]"!=X([a])||"{}"!=X({a:a})||"{}"!=X(Object(a))})},{stringify:function(a,b,c){for(var d,e=[a],g=1;arguments.length>g;)e.push(arguments[g++]);if(d=b,(x(b)||void 0!==a)&&!R(a))return f(b)||(b=function(a,b){if("function"==typeof d&&(b=d.call(this,a,b)),!R(b))return b}),e[1]=b,X.apply(null,e)}});J.prototype[a]||I(J.prototype,a,J.prototype.valueOf);sa(J,"Symbol");W[K]=!0},function(c,b,a){c=a(1);var d=a(7),e=a(0),n=a(9),g=a(5);b=
a(12).f;a=a(135);var l=e.Symbol;if(d&&"function"==typeof l&&!("description"in l.prototype&&void 0===l().description)){var k={},m=function(){var a=1>arguments.length||void 0===arguments[0]?void 0:String(arguments[0]),b=this instanceof m?new l(a):void 0===a?l():l(a);return""===a&&(k[b]=!0),b};a(m,l);a=m.prototype=l.prototype;a.constructor=m;var f=a.toString,x="Symbol(test)"==String(l("test")),A=/^Symbol\((.*)\)[^)]+$/;b(a,"description",{configurable:!0,get:function(){var a=g(this)?this.valueOf():this,
b=f.call(a);if(n(k,a))return"";a=x?b.slice(7,-1):b.replace(A,"$1");return""===a?void 0:a}});c({global:!0,forced:!0},{Symbol:m})}},function(c,b,a){a(89)("iterator")},function(c,b,a){c=a(7);a=a(12).f;b=Function.prototype;var d=b.toString,e=/^\s*function ([^ (]*)/;!c||"name"in b||a(b,"name",{configurable:!0,get:function(){try{return d.call(this).match(e)[1]}catch(a){return""}}})},function(c,b){var a={}.toString;c.exports=function(b){return a.call(b).slice(8,-1)}},function(c,b,a){var d,e=a(10),n=a(152),
g=a(105);b=a(51);var l=a(140),k=a(102),m=a(86)("IE_PROTO"),f=function(){},x=function(){try{d=document.domain&&new ActiveXObject("htmlfile")}catch(a){}var b,c,e;d?(b=d,b.write("\x3cscript\x3e\x3c/script\x3e"),b.close(),e=b.parentWindow.Object):e=((c=k("iframe")).style.display="none",l.appendChild(c),c.src="javascript:",(b=c.contentWindow.document).open(),b.write("\x3cscript\x3edocument.F\x3dObject\x3c/script\x3e"),b.close(),b.F);x=e;for(b=g.length;b--;)delete x.prototype[g[b]];return x()};b[m]=!0;
c.exports=Object.create||function(a,b){var c;return null!==a?(f.prototype=e(a),c=new f,f.prototype=null,c[m]=a):c=x(),void 0===b?c:n(c,b)}},function(c,b,a){var d=a(41),e=a(92),n=a(19),g=a(13),l=a(153),k=[].push;b=function(a){var b=1==a,c=2==a,f=3==a,z=4==a,w=6==a,v=5==a||w;return function(h,p,C,t){var F,q,B=n(h),D=e(B);p=d(p,C,3);C=g(D.length);var G=0;t=t||l;for(h=b?t(h,C):c?t(h,0):void 0;C>G;G++)if((v||G in D)&&(q=p(F=D[G],G,B),a))if(b)h[G]=q;else if(q)switch(a){case 3:return!0;case 5:return F;case 6:return G;
case 2:k.call(h,F)}else if(z)return!1;return w?-1:f||z?z:h}};c.exports={forEach:b(0),map:b(1),filter:b(2),some:b(3),every:b(4),find:b(5),findIndex:b(6)}},function(c,b){c.exports=!1},function(c,b){c.exports=function(a){if(null==a)throw TypeError("Can't call method on "+a);return a}},function(c,b,a){c=a(7);var d=a(112),e=a(39),n=a(26),g=a(56),l=a(9),k=a(133),m=Object.getOwnPropertyDescriptor;b.f=c?m:function(a,b){if(a=n(a),b=g(b,!0),k)try{return m(a,b)}catch(c){}if(l(a,b))return e(!d.f.call(a,b),a[b])}},
function(c,b){c.exports=function(a){if("function"!=typeof a)throw TypeError(String(a)+" is not a function");return a}},function(c,b){c.exports=function(a,b){return{enumerable:!(1&a),configurable:!(2&a),writable:!(4&a),value:b}}},function(c,b){var a=Math.ceil,d=Math.floor;c.exports=function(b){return isNaN(b=+b)?0:(0<b?d:a)(b)}},function(c,b,a){var d=a(38);c.exports=function(a,b,c){if(d(a),void 0===b)return a;switch(c){case 0:return function(){return a.call(b)};case 1:return function(c){return a.call(b,
c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,g){return a.call(b,c,d,g)}}return function(){return a.apply(b,arguments)}}},,function(c,b,a){a(1)({target:"Object",stat:!0,sham:!a(7)},{create:a(33)})},function(c,b,a){c=a(1);b=a(2);var d=a(19),e=a(61);a=a(146);c({target:"Object",stat:!0,forced:b(function(){e(1)}),sham:!a},{getPrototypeOf:function(a){return e(d(a))}})},function(c,b,a){a(1)({target:"Object",stat:!0},{setPrototypeOf:a(54)})},function(c,b){c.exports=function(a,
b,c){if(!(a instanceof b))throw TypeError("Incorrect "+(c?c+" ":"")+"invocation");return a}},,function(c,b,a){var d=a(32);c.exports=Array.isArray||function(a){return"Array"==d(a)}},function(c,b,a){c=a(1);a=a(144);c({target:"Array",proto:!0,forced:[].forEach!=a},{forEach:a})},function(c,b,a){c=a(0);var d=a(147);b=a(144);a=a(16);for(var e in d)if((d=(d=c[e])&&d.prototype)&&d.forEach!==b)try{a(d,"forEach",b)}catch(n){d.forEach=b}},function(c,b){c.exports={}},function(c,b){c.exports={}},function(c,b,
a){var d=a(10),e=a(38),n=a(4)("species");c.exports=function(a,b){var c;a=d(a).constructor;return void 0===a||null==(c=d(a)[n])?b:e(c)}},function(c,b,a){var d=a(10),e=a(184);c.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var a,b=!1,c={};try{(a=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(c,[]),b=c instanceof Array}catch(k){}return function(c,l){return d(c),e(l),b?a.call(c,l):c.__proto__=l,c}}():void 0)},function(c,b,a){c=a(1);b=a(27);var d=a(38),e=a(10),n=a(5),
g=a(33),l=a(150);a=a(2);var k=b("Reflect","construct"),m=a(function(){function a(){}return!(k(function(){},[],a)instanceof a)}),f=!a(function(){k(function(){})});a=m||f;c({target:"Reflect",stat:!0,forced:a,sham:a},{construct:function(a,b){d(a);e(b);var c=3>arguments.length?a:d(arguments[2]);if(f&&!m)return k(a,b,c);if(a==c){switch(b.length){case 0:return new a;case 1:return new a(b[0]);case 2:return new a(b[0],b[1]);case 3:return new a(b[0],b[1],b[2]);case 4:return new a(b[0],b[1],b[2],b[3])}c=[null];
return c.push.apply(c,b),new (l.apply(a,c))}var c=c.prototype,c=g(n(c)?c:Object.prototype),w=Function.apply.call(a,c,b);return n(w)?w:c}})},function(c,b,a){var d=a(5);c.exports=function(a,b){if(!d(a))return a;var c,l;if(b&&"function"==typeof(c=a.toString)&&!d(l=c.call(a))||"function"==typeof(c=a.valueOf)&&!d(l=c.call(a))||!b&&"function"==typeof(c=a.toString)&&!d(l=c.call(a)))return l;throw TypeError("Can't convert object to primitive value");}},function(c,b){var a=0,d=Math.random();c.exports=function(b){return"Symbol("+
String(void 0===b?"":b)+")_"+(++a+d).toString(36)}},function(c,b,a){var d=a(40),e=Math.max,n=Math.min;c.exports=function(a,b){a=d(a);return 0>a?e(a+b,0):n(a,b)}},function(c,b,a){var d=a(137),e=a(105).concat("length","prototype");b.f=Object.getOwnPropertyNames||function(a){return d(a,e)}},function(c,b,a){var d=a(7),e=a(2),n=a(9),g=Object.defineProperty,l={},k=function(a){throw a;};c.exports=function(a,b){if(n(l,a))return l[a];b||(b={});var c=[][a],f=!!n(b,"ACCESSORS")&&b.ACCESSORS,z=n(b,0)?b[0]:k,
w=n(b,1)?b[1]:void 0;return l[a]=!!c&&!e(function(){if(f&&!d)return!0;var a={length:-1};f?g(a,1,{enumerable:!0,get:k}):a[1]=1;c.call(a,z,w)})}},function(c,b,a){var d=a(9),e=a(19);b=a(86);a=a(146);var n=b("IE_PROTO"),g=Object.prototype;c.exports=a?Object.getPrototypeOf:function(a){return a=e(a),d(a,n)?a[n]:"function"==typeof a.constructor&&a instanceof a.constructor?a.constructor.prototype:a instanceof Object?g:null}},,,,,,,,,,,,,,,,,,,,,,,,,function(c,b,a){b=a(100);var d=a(57),e=b("keys");c.exports=
function(a){return e[a]||(e[a]=d(a))}},function(c,b,a){b=a(99);var d=a(32),e=a(4)("toStringTag"),n="Arguments"==d(function(){return arguments}());c.exports=b?d:function(a){var b,c;if(void 0===a)b="Undefined";else{var m;if(null===a)m="Null";else{a:{var f=a=Object(a);try{m=f[e];break a}catch(x){}m=void 0}m="string"==typeof(b=m)?b:n?d(a):"Object"==(c=d(a))&&"function"==typeof a.callee?"Arguments":c}b=m}return b}},function(c,b,a){var d=a(87),e=a(52),n=a(4)("iterator");c.exports=function(a){if(null!=a)return a[n]||
a["@@iterator"]||e[d(a)]}},function(c,b,a){var d=a(136),e=a(9),n=a(143),g=a(12).f;c.exports=function(a){var b=d.Symbol||(d.Symbol={});e(b,a)||g(b,a,{value:n.f(a)})}},function(c,b,a){c=a(1);var d=a(48),e=[].reverse;a=[1,2];c({target:"Array",proto:!0,forced:String(a)===String(a.reverse())},{reverse:function(){return d(this)&&(this.length=this.length),e.call(this)}})},,function(c,b,a){b=a(2);var d=a(32),e="".split;c.exports=b(function(){return!Object("z").propertyIsEnumerable(0)})?function(a){return"String"==
d(a)?e.call(a,""):Object(a)}:Object},function(c,b,a){var d=a(26),e=a(13),n=a(58);b=function(a){return function(b,c,m){var f;b=d(b);var x=e(b.length);m=n(m,x);if(a&&c!=c)for(;x>m;){if((f=b[m++])!=f)return!0}else for(;x>m;m++)if((a||m in b)&&b[m]===c)return a||m||0;return!a&&-1}};c.exports={includes:b(!0),indexOf:b(!1)}},function(c,b,a){var d=a(17);c.exports=function(a,b,c){for(var l in b)d(a,l,b[l],c);return a}},function(c,b,a){var d=a(27),e=a(12);b=a(4);var n=a(7),g=b("species");c.exports=function(a){a=
d(a);var b=e.f;n&&a&&!a[g]&&b(a,g,{configurable:!0,get:function(){return this}})}},function(c,b,a){var d=a(4)("iterator"),e=!1;try{var n=0;b={next:function(){return{done:!!n++}},return:function(){e=!0}};b[d]=function(){return this};Array.from(b,function(){throw 2;})}catch(g){}c.exports=function(a,b){if(!b&&!e)return!1;var c=!1;try{b={},b[d]=function(){return{next:function(){return{done:c=!0}}}},a(b)}catch(m){}return c}},function(c,b,a){var d=a(137),e=a(105);c.exports=Object.keys||function(a){return d(a,
e)}},function(c,b,a){var d=a(2);c.exports=function(a,b){var c=[][a];return!!c&&d(function(){c.call(null,b||function(){throw 1;},1)})}},function(c,b,a){b={};b[a(4)("toStringTag")]="z";c.exports="[object z]"===String(b)},function(c,b,a){b=a(35);var d=a(132);(c.exports=function(a,b){return d[a]||(d[a]=void 0!==b?b:{})})("versions",[]).push({version:"3.6.5",mode:b?"pure":"global",copyright:" 2020 Denis Pushkarev (zloirock.ru)"})},function(c,b,a){var d=a(0),e=a(16);c.exports=function(a,b){try{e(d,a,b)}catch(c){d[a]=
b}return b}},function(c,b,a){b=a(0);a=a(5);var d=b.document,e=a(d)&&a(d.createElement);c.exports=function(a){return e?d.createElement(a):{}}},function(c,b,a){b=a(2);c.exports=!!Object.getOwnPropertySymbols&&!b(function(){return!String(Symbol())})},function(c,b,a){b=a(132);var d=Function.toString;"function"!=typeof b.inspectSource&&(b.inspectSource=function(a){return d.call(a)});c.exports=b.inspectSource},function(c,b){c.exports="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ")},
function(c,b,a){var d=a(2),e=/#|\.prototype\./;b=function(a,b){a=g[n(a)];return a==f||a!=l&&("function"==typeof b?d(b):!!b)};var n=b.normalize=function(a){return String(a).replace(e,".").toLowerCase()},g=b.data={},l=b.NATIVE="N",f=b.POLYFILL="P";c.exports=b},function(c,b,a){var d=a(10),e=a(114),n=a(13),g=a(41),l=a(88),f=a(138),m=function(a,b){this.stopped=a;this.result=b};(c.exports=function(a,b,c,z,w){var v,h;b=g(b,c,z?2:1);if(!w){if("function"!=typeof(w=l(a)))throw TypeError("Target is not iterable");
if(e(w)){w=0;for(c=n(a.length);c>w;w++)if((v=z?b(d(h=a[w])[0],h[1]):b(a[w]))&&v instanceof m)return v;return new m(!1)}a=w.call(a)}for(w=a.next;!(h=w.call(a)).done;)if("object"==typeof(v=f(a,b,h.value,z))&&v&&v instanceof m)return v;return new m(!1)}).stop=function(a){return new m(!0,a)}},function(c,b,a){b=a(27);c.exports=b("navigator","userAgent")||""},function(c,b,a){var d=a(1),e=a(154),n=a(61),g=a(54),f=a(23),k=a(16),m=a(17);b=a(4);var u=a(35),x=a(52);a=a(145);var A=a.IteratorPrototype,z=a.BUGGY_SAFARI_ITERATORS,
w=b("iterator"),v=function(){return this};c.exports=function(a,b,c,t,F,q,B){e(c,b,t);var D,G,I;t=function(a){if(a===F&&P)return P;if(!z&&a in M)return M[a];switch(a){case "keys":case "values":case "entries":return function(){return new c(this,a)}}return function(){return new c(this)}};var r=b+" Iterator",y=!1,M=a.prototype,E=M[w]||M["@@iterator"]||F&&M[F],P=!z&&E||t(F),fa="Array"==b&&M.entries||E;if(fa&&(D=n(fa.call(new a)),A!==Object.prototype&&D.next&&(u||n(D)===A||(g?g(D,A):"function"!=typeof D[w]&&
k(D,w,v)),f(D,r,!0,!0),u&&(x[r]=v))),"values"==F&&E&&"values"!==E.name&&(y=!0,P=function(){return E.call(this)}),u&&!B||M[w]===P||k(M,w,P),x[b]=P,F)if(G={values:t("values"),keys:q?P:t("keys"),entries:t("entries")},B)for(I in G)!z&&!y&&I in M||m(M,I,G[I]);else d({target:b,proto:!0,forced:z||y},G);return G}},,,function(c,b,a){c={}.propertyIsEnumerable;var d=Object.getOwnPropertyDescriptor;a=d&&!c.call({1:2},1);b.f=a?function(a){a=d(this,a);return!!a&&a.enumerable}:c},function(c,b){b.f=Object.getOwnPropertySymbols},
function(c,b,a){b=a(4);var d=a(52),e=b("iterator"),n=Array.prototype;c.exports=function(a){return void 0!==a&&(d.Array===a||n[e]===a)}},function(c,b,a){var d,e;b=a(0);a=a(108);(b=(b=(b=b.process)&&b.versions)&&b.v8)?e=(d=b.split("."))[0]+d[1]:a&&(!(d=a.match(/Edge\/(\d+)/))||74<=d[1])&&(d=a.match(/Chrome\/(\d+)/))&&(e=d[1]);c.exports=e&&+e},function(c,b,a){var d=a(56),e=a(12),n=a(39);c.exports=function(a,b,c){b=d(b);b in a?e.f(a,b,n(0,c)):a[b]=c}},function(c,b,a){b=a(157);a=a(159);c.exports=b("Map",
function(a){return function(){return a(this,arguments.length?arguments[0]:void 0)}},a)},,function(c,b,a){var d=a(40),e=a(36);b=function(a){return function(b,c){var f,m;b=String(e(b));c=d(c);var u=b.length;return 0>c||c>=u?a?"":void 0:55296>(f=b.charCodeAt(c))||56319<f||c+1===u||56320>(m=b.charCodeAt(c+1))||57343<m?a?b.charAt(c):f:a?b.slice(c,c+2):m-56320+(f-55296<<10)+65536}};c.exports={codeAt:b(!1),charAt:b(!0)}},function(c,b,a){a(1)({target:"Function",proto:!0},{bind:a(150)})},,,,,,,,,,,,function(c,
b,a){b=a(0);a=a(101);a=b["__core-js_shared__"]||a("__core-js_shared__",{});c.exports=a},function(c,b,a){b=a(7);var d=a(2),e=a(102);c.exports=!b&&!d(function(){return 7!=Object.defineProperty(e("div"),"a",{get:function(){return 7}}).a})},function(c,b,a){b=a(103);c.exports=b&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(c,b,a){var d=a(9),e=a(173),f=a(37),g=a(12);c.exports=function(a,b){for(var c=e(b),u=g.f,x=f.f,A=0;A<c.length;A++){var z=c[A];d(a,z)||u(a,z,x(b,z))}}},function(c,b,a){b=a(0);
c.exports=b},function(c,b,a){var d=a(9),e=a(26),f=a(93).indexOf,g=a(51);c.exports=function(a,b){var c;a=e(a);var u=0,x=[];for(c in a)!d(g,c)&&d(a,c)&&x.push(c);for(;b.length>u;)d(a,c=b[u++])&&(~f(x,c)||x.push(c));return x}},function(c,b,a){var d=a(10);c.exports=function(a,b,c,f){try{return f?b(d(c)[0],c[1]):b(c)}catch(k){throw b=a.return,void 0!==b&&d(b.call(a)),k;}}},function(c,b,a){var d,e,f,g=a(0);b=a(2);var l=a(32),k=a(41),m=a(140),u=a(102);a=a(141);var x=g.location,A=g.setImmediate,z=g.clearImmediate,
w=g.process,v=g.MessageChannel,h=g.Dispatch,p=0,C={},t=function(a){if(C.hasOwnProperty(a)){var b=C[a];delete C[a];b()}},F=function(a){return function(){t(a)}},q=function(a){t(a.data)},B=function(a){g.postMessage(a+"",x.protocol+"//"+x.host)};A&&z||(A=function(a){for(var b=[],c=1;arguments.length>c;)b.push(arguments[c++]);return C[++p]=function(){("function"==typeof a?a:Function(a)).apply(void 0,b)},d(p),p},z=function(a){delete C[a]},"process"==l(w)?d=function(a){w.nextTick(F(a))}:h&&h.now?d=function(a){h.now(F(a))}:
v&&!a?(f=(e=new v).port2,e.port1.onmessage=q,d=k(f.postMessage,f,1)):!g.addEventListener||"function"!=typeof postMessage||g.importScripts||b(B)||"file:"===x.protocol?d="onreadystatechange"in u("script")?function(a){m.appendChild(u("script")).onreadystatechange=function(){m.removeChild(this);t(a)}}:function(a){setTimeout(F(a),0)}:(d=B,g.addEventListener("message",q,!1)));c.exports={set:A,clear:z}},function(c,b,a){b=a(27);c.exports=b("document","documentElement")},function(c,b,a){b=a(108);c.exports=
/(iphone|ipod|ipad).*applewebkit/i.test(b)},function(c,b,a){var d=a(38),e=function(a){var b,c;this.promise=new a(function(a,d){if(void 0!==b||void 0!==c)throw TypeError("Bad Promise constructor");b=a;c=d});this.resolve=d(b);this.reject=d(c)};c.exports.f=function(a){return new e(a)}},function(c,b,a){c=a(4);b.f=c},function(c,b,a){var d=a(34).forEach;b=a(98);a=a(60);b=b("forEach");a=a("forEach");c.exports=b&&a?[].forEach:function(a){return d(this,a,1<arguments.length?arguments[1]:void 0)}},function(c,
b,a){var d,e,f;b=a(61);var g=a(16),l=a(9),k=a(4);a=a(35);var k=k("iterator"),m=!1;[].keys&&("next"in(f=[].keys())?(e=b(b(f)))!==Object.prototype&&(d=e):m=!0);null==d&&(d={});a||l(d,k)||g(d,k,function(){return this});c.exports={IteratorPrototype:d,BUGGY_SAFARI_ITERATORS:m}},function(c,b,a){b=a(2);c.exports=!b(function(){function a(){}return a.prototype.constructor=null,Object.getPrototypeOf(new a)!==a.prototype})},function(c,b){c.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,
DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(c,b,a){b=a(51);var d=a(5),e=a(9),f=a(12).f,g=a(57),l=a(188),
k=g("meta"),m=0,u=Object.isExtensible||function(){return!0},x=function(a){f(a,k,{value:{objectID:"O"+ ++m,weakData:{}}})},A=c.exports={REQUIRED:!1,fastKey:function(a,b){if(!d(a))return"symbol"==typeof a?a:("string"==typeof a?"S":"P")+a;if(!e(a,k)){if(!u(a))return"F";if(!b)return"E";x(a)}return a[k].objectID},getWeakData:function(a,b){if(!e(a,k)){if(!u(a))return!0;if(!b)return!1;x(a)}return a[k].weakData},onFreeze:function(a){return l&&A.REQUIRED&&u(a)&&!e(a,k)&&x(a),a}};b[k]=!0},,function(c,b,a){var d=
a(38),e=a(5),f=[].slice,g={};c.exports=Function.bind||function(a){var b=d(this),c=f.call(arguments,1),u=function(){var d=c.concat(f.call(arguments)),e;if(this instanceof u){e=b;var z=d.length;if(!(z in g)){for(var w=[],v=0;v<z;v++)w[v]="a["+v+"]";g[z]=Function("C,a","return new C("+w.join(",")+")")}e=g[z](e,d)}else e=b.apply(a,d);return e};return e(b.prototype)&&(u.prototype=b.prototype),u}},,function(c,b,a){b=a(7);var d=a(12),e=a(10),f=a(97);c.exports=b?Object.defineProperties:function(a,b){e(a);
for(var c,m=f(b),u=m.length,x=0;u>x;)d.f(a,c=m[x++],b[c]);return a}},function(c,b,a){var d=a(5),e=a(48),f=a(4)("species");c.exports=function(a,b){var c;return e(a)&&("function"!=typeof(c=a.constructor)||c!==Array&&!e(c.prototype)?d(c)&&null===(c=c[f])&&(c=void 0):c=void 0),new (void 0===c?Array:c)(0===b?0:b)}},function(c,b,a){var d=a(145).IteratorPrototype,e=a(33),f=a(39),g=a(23),l=a(52),k=function(){return this};c.exports=function(a,b,c){b+=" Iterator";return a.prototype=e(d,{next:f(1,c)}),g(a,b,
!1,!0),l[b]=k,a}},function(c,b,a){var d=a(2);b=a(4);var e=a(115),f=b("species");c.exports=function(a){return 51<=e||!d(function(){var b=[];return(b.constructor={})[f]=function(){return{foo:1}},1!==b[a](Boolean).foo})}},function(c,b,a){var d=a(10);c.exports=function(){var a=d(this),b="";return a.global&&(b+="g"),a.ignoreCase&&(b+="i"),a.multiline&&(b+="m"),a.dotAll&&(b+="s"),a.unicode&&(b+="u"),a.sticky&&(b+="y"),b}},function(c,b,a){var d=a(1),e=a(0),f=a(106),g=a(17),l=a(148),k=a(107),m=a(46),u=a(5),
x=a(2),A=a(96),z=a(23),w=a(158);c.exports=function(a,b,c){var C=-1!==a.indexOf("Map"),t=-1!==a.indexOf("Weak"),F=C?"set":"add",q=e[a],B=q&&q.prototype,D=q,G={},I=function(a){var b=B[a];g(B,a,"add"==a?function(a){return b.call(this,0===a?0:a),this}:"delete"==a?function(a){return!(t&&!u(a))&&b.call(this,0===a?0:a)}:"get"==a?function(a){return t&&!u(a)?void 0:b.call(this,0===a?0:a)}:"has"==a?function(a){return!(t&&!u(a))&&b.call(this,0===a?0:a)}:function(a,c){return b.call(this,0===a?0:a,c),this})};
if(f(a,"function"!=typeof q||!(t||B.forEach&&!x(function(){(new q).entries().next()}))))D=c.getConstructor(b,a,C,F),l.REQUIRED=!0;else if(f(a,!0)){var r=new D,y=r[F](t?{}:-0,1)!=r,M=x(function(){r.has(1)}),E=A(function(a){new q(a)}),P=!t&&x(function(){for(var a=new q,b=5;b--;)a[F](b,b);return!a.has(-0)});E||((D=b(function(b,c){m(b,D,a);b=w(new q,b,D);return null!=c&&k(c,b[F],b,C),b})).prototype=B,B.constructor=D);(M||P)&&(I("delete"),I("has"),C&&I("get"));(P||y)&&I(F);t&&B.clear&&delete B.clear}return G[a]=
D,d({global:!0,forced:D!=q},G),z(D,a),t||c.setStrong(D,a,C),D}},function(c,b,a){var d=a(5),e=a(54);c.exports=function(a,b,c){var f,m;return e&&"function"==typeof(f=b.constructor)&&f!==c&&d(m=f.prototype)&&m!==c.prototype&&e(a,m),a}},function(c,b,a){var d=a(12).f,e=a(33),f=a(94),g=a(41),l=a(46),k=a(107),m=a(109),u=a(95),x=a(7),A=a(148).fastKey;b=a(24);var z=b.set,w=b.getterFor;c.exports={getConstructor:function(a,b,c,C){var m=a(function(a,d){l(a,m,b);z(a,{type:b,index:e(null),first:void 0,last:void 0,
size:0});x||(a.size=0);null!=d&&k(d,a[C],a,c)}),u=w(b),q=function(a,b,c){var d,e,h=u(a),q=B(a,b);return q?q.value=c:(h.last=q={index:e=A(b,!0),key:b,value:c,previous:d=h.last,next:void 0,removed:!1},h.first||(h.first=q),d&&(d.next=q),x?h.size++:a.size++,"F"!==e&&(h.index[e]=q)),a},B=function(a,b){a=u(a);var c=A(b);if("F"!==c)return a.index[c];for(a=a.first;a;a=a.next)if(a.key==b)return a};return f(m.prototype,{clear:function(){for(var a=u(this),b=a.index,c=a.first;c;)c.removed=!0,c.previous&&(c.previous=
c.previous.next=void 0),delete b[c.index],c=c.next;a.first=a.last=void 0;x?a.size=0:this.size=0},delete:function(a){var b=u(this);if(a=B(this,a)){var c=a.next,d=a.previous;delete b.index[a.index];a.removed=!0;d&&(d.next=c);c&&(c.previous=d);b.first==a&&(b.first=c);b.last==a&&(b.last=d);x?b.size--:this.size--}return!!a},forEach:function(a){for(var b,c=u(this),d=g(a,1<arguments.length?arguments[1]:void 0,3);b=b?b.next:c.first;)for(d(b.value,b.key,this);b&&b.removed;)b=b.previous},has:function(a){return!!B(this,
a)}}),f(m.prototype,c?{get:function(a){return(a=B(this,a))&&a.value},set:function(a,b){return q(this,0===a?0:a,b)}}:{add:function(a){return q(this,a=0===a?0:a,a)}}),x&&d(m.prototype,"size",{get:function(){return u(this).size}}),m},setStrong:function(a,b,c){var d=b+" Iterator",e=w(b),g=w(d);m(a,b,function(a,b){z(this,{type:d,target:a,state:e(a),kind:b,last:void 0})},function(){for(var a=g(this),b=a.kind,c=a.last;c&&c.removed;)c=c.previous;return a.target&&(a.last=c=c?c.next:a.state.first)?"keys"==
b?{value:c.key,done:!1}:"values"==b?{value:c.value,done:!1}:{value:[c.key,c.value],done:!1}:(a.target=void 0,{value:void 0,done:!0})},c?"entries":"values",!c,!0);u(b)}}},,function(c,b,a){c=a(1);var d=a(93).indexOf;b=a(98);a=a(60);var e=[].indexOf,f=!!e&&0>1/[1].indexOf(1,-0);b=b("indexOf");a=a("indexOf",{ACCESSORS:!0,1:0});c({target:"Array",proto:!0,forced:f||!b||!a},{indexOf:function(a){return f?e.apply(this,arguments)||0:d(this,a,1<arguments.length?arguments[1]:void 0)}})},function(c,b,a){a(1)({target:"Date",
stat:!0},{now:function(){return(new Date).getTime()}})},,,,,function(c,b,a){var d=a(41),e=a(19),f=a(138),g=a(114),l=a(13),k=a(116),m=a(88);c.exports=function(a){var b,c,z,w;w=e(a);c="function"==typeof this?this:Array;b=arguments.length;var v=1<b?arguments[1]:void 0,h=void 0!==v;z=m(w);var p=0;if(h&&(v=d(v,2<b?arguments[2]:void 0,2)),null==z||c==Array&&g(z))for(c=new c(b=l(w.length));b>p;p++)z=h?v(w[p],p):w[p],k(c,p,z);else for(b=(w=z.call(w)).next,c=new c;!(z=b.call(w)).done;p++)z=h?f(w,v,[z.value,
p],!0):z.value,k(c,p,z);return c.length=p,c}},function(c,b,a){Object.defineProperty(b,"__esModule",{value:!0});b.AuthenticationStatusType=void 0;b.AuthenticationStatusType=void 0;c=b.AuthenticationStatusType={};c.InitializationSuccess="InitializationSuccess";c.AuthenticationSuccess="AuthenticationSuccess";c.AuthenticationFailure="AuthenticationFailure";c.ValidationError="ValidationError";c.FallbackRequiredError="FallbackRequiredError";c.SystemError="SystemError";c.ChallengeScreenRendered="ChallengeScreenRendered";
c.SdkAck="SdkAck";c.success="success";c.failure="failure"},,function(c,b){b=function(){return this}();try{b=b||(new Function("return this"))()}catch(a){"object"==typeof r&&(b=r)}c.exports=b},function(c,b,a){b=a(0);a=a(104);b=b.WeakMap;c.exports="function"==typeof b&&/native code/.test(a(b))},function(c,b,a){b=a(99);var d=a(87);c.exports=b?{}.toString:function(){return"[object "+d(this)+"]"}},function(c,b,a){b=a(27);var d=a(59),e=a(113),f=a(10);c.exports=b("Reflect","ownKeys")||function(a){var b=d.f(f(a)),
c=e.f;return c?b.concat(c(a)):b}},function(c,b,a){b=a(0);c.exports=b.Promise},function(c,b,a){var d,e,f,g,l,k,m,u,x=a(0),A=a(37).f,z=a(32),w=a(139).set;a=a(141);b=x.MutationObserver||x.WebKitMutationObserver;var v=x.process,h=x.Promise,p="process"==z(v);(A=(A=A(x,"queueMicrotask"))&&A.value)||(d=function(){var a,b;for(p&&(a=v.domain)&&a.exit();e;){b=e.fn;e=e.next;try{b()}catch(c){throw e?g():f=void 0,c;}}f=void 0;a&&a.enter()},p?g=function(){v.nextTick(d)}:b&&!a?(l=!0,k=document.createTextNode(""),
(new b(d)).observe(k,{characterData:!0}),g=function(){k.data=l=!l}):h&&h.resolve?(m=h.resolve(void 0),u=m.then,g=function(){u.call(m,d)}):g=function(){w.call(x,d)});c.exports=A||function(a){a={fn:a,next:void 0};f&&(f.next=a);e||(e=a,g());f=a}},function(c,b,a){var d=a(10),e=a(5),f=a(142);c.exports=function(a,b){if(d(a),e(b)&&b.constructor===a)return b;a=f.f(a);return(0,a.resolve)(b),a.promise}},function(c,b,a){var d=a(0);c.exports=function(a,b){var c=d.console;c&&c.error&&(1===arguments.length?c.error(a):
c.error(a,b))}},function(c,b){c.exports=function(a){try{return{error:!1,value:a()}}catch(b){return{error:!0,value:b}}}},function(c,b){c.exports=function(a){return a.webpackPolyfill||(a.deprecate=function(){},a.paths=[],a.children||(a.children=[]),Object.defineProperty(a,"loaded",{enumerable:!0,get:function(){return a.l}}),Object.defineProperty(a,"id",{enumerable:!0,get:function(){return a.i}}),a.webpackPolyfill=1),a}},function(c,b,a){var d=a(26),e=a(59).f,f={}.toString,g="object"==typeof r&&r&&Object.getOwnPropertyNames?
Object.getOwnPropertyNames(r):[];c.exports.f=function(a){var b;if(g&&"[object Window]"==f.call(a))try{b=e(a)}catch(c){b=g.slice()}else b=e(d(a));return b}},function(c,b,a){a(89)("asyncIterator")},function(c,b,a){a(89)("toStringTag")},function(c,b,a){b=a(4);var d=a(33);a=a(12);var e=b("unscopables"),f=Array.prototype;null==f[e]&&a.f(f,e,{configurable:!0,value:d(null)});c.exports=function(a){f[e][a]=!0}},function(c,b,a){var d=a(5);c.exports=function(a){if(!d(a)&&null!==a)throw TypeError("Can't set "+
String(a)+" as a prototype");return a}},function(c,b,a){c=a(0);a(23)(c.JSON,"JSON",!0)},function(c,b,a){a(23)(Math,"Math",!0)},,function(c,b,a){b=a(2);c.exports=!b(function(){return Object.isExtensible(Object.preventExtensions({}))})},,function(c,b,a){function d(a){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function e(a,b,c,d,e,
h,p){try{var f=a[h](p),g=f.value}catch(m){return void c(m)}f.done?b(g):Promise.resolve(g).then(d,e)}function f(a){return function(){var b=this,c=arguments;return new Promise(function(d,h){function p(a){e(g,d,h,p,f,"next",a)}function f(a){e(g,d,h,p,f,"throw",a)}var g=a.apply(b,c);p(void 0)})}}function g(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function l(a){var b="function"==typeof Map?new Map:void 0;return(l=function(a){function c(){return k(a,
arguments,x(this).constructor)}if(null===a||(d=a,-1===Function.toString.call(d).indexOf("[native code]")))return a;var d;if("function"!=typeof a)throw new TypeError("Super expression must either be null or a function");if(void 0!==b){if(b.has(a))return b.get(a);b.set(a,c)}return c.prototype=Object.create(a.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),u(c,a)})(a)}function k(a,b,c){return(k=m()?Reflect.construct:function(a,b,c){var d=[null];d.push.apply(d,b);a=new (Function.bind.apply(a,
d));return c&&u(a,c.prototype),a}).apply(null,arguments)}function m(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(a){return!1}}function u(a,b){return(u=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a})(a,b)}function x(a){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}
function A(){return z.apply(this,arguments)}function z(){return(z=f(regeneratorRuntime.mark(function t(){var a,b=arguments;return regeneratorRuntime.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return a=0<b.length&&void 0!==b[0]?b[0]:200,c.abrupt("return",new Promise(function(b){return setTimeout(b,a)}));case 2:case "end":return c.stop()}},t)}))).apply(this,arguments)}function w(a){return v.apply(this,arguments)}function v(){return(v=f(regeneratorRuntime.mark(function t(a){var b,c=arguments;
return regeneratorRuntime.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(void 0!==(b=1<c.length&&void 0!==c[1]?c[1]:h).startTime){d.next=5;break}b.startTime=Date.now();d.next=7;break;case 5:if(!(Date.now()-b.startTime>b.maxPollingTime)){d.next=7;break}throw Error("Exhausted the number of retries within timeout");case 7:return d.prev=7,d.next=10,a();case 10:return d.abrupt("return",d.sent);case 13:if(d.prev=13,d.t0=d.catch(7),!(d.t0 instanceof p)){d.next=23;break}return d.next=18,A(b.delay);
case 18:return d.next=20,w(a,b);case 20:return d.abrupt("return",d.sent);case 23:if(!(0<b.maxRetries)){d.next=31;break}return d.next=26,A(b.delay);case 26:return d.next=28,w(a,{delay:b.delay,maxRetries:b.maxRetries-1,maxPollingTime:b.maxPollingTime,startTime:b.startTime});case 28:return d.abrupt("return",d.sent);case 31:throw d.t0;case 32:case "end":return d.stop()}},t,null,[[7,13]])}))).apply(this,arguments)}a(28);a(29);a(30);a(161);a(11);a(162);a(18);a(120);a(31);a(117);a(43);a(44);a(45);a(3);a(14);
a(55);a(21);a(20);a(22);a(191);Object.defineProperty(b,"__esModule",{value:!0});b.wait=A;b.retry=w;b.PollEnabledError=void 0;a(15);var h={delay:200,maxRetries:0,maxPollingTime:15E3},p=function(a){function b(a){var c;if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");return c=e.call(this,a),Object.setPrototypeOf(g(c),(this instanceof b?this.constructor:void 0).prototype),c.name="PollEnabledError",c}!function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");
a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}});b&&u(a,b)}(b,a);var c,e=(c=m(),function(){var a;a=x(b);if(c){var e=x(this).constructor;a=Reflect.construct(a,arguments,e)}else a=a.apply(this,arguments);return!a||"object"!==d(a)&&"function"!=typeof a?g(this):a});return b}(l(Error));b.PollEnabledError=p},function(c,b,a){c=a(1);b=a(0);a=a(108);var d=[].slice,e=function(a){return function(b,c){var e=2<arguments.length,f=e?d.call(arguments,2):void 0;return a(e?
function(){("function"==typeof b?b:Function(b)).apply(this,f)}:b,c)}};c({global:!0,bind:!0,forced:/MSIE .\./.test(a)},{setTimeout:e(b.setTimeout),setInterval:e(b.setInterval)})},,,,,,,,,,,,,,,,,,,,,function(c,b,a){Object.defineProperty(b,"__esModule",{value:!0});b.ApiType=void 0;b.ApiType=void 0;c=b.ApiType={};c.Initialize="Initialize";c.Authenticate="Authenticate";c.initialize="initialize";c.challenge="challenge"},function(c,b,a){Object.defineProperty(b,"__esModule",{value:!0});b.isFirstSameOrAfterSecond=
function(a,b){if(a.major>b.major)return!0;if(a.major===b.major){if(a.minor>b.minor)return!0;if(a.minor===b.minor){if(a.build>b.build)return!0;if(a.build===b.build)return a.revision>=b.revision}}return!1};b.CURRENT_SDK_VERSION=void 0;b.CURRENT_SDK_VERSION={major:0,minor:1,build:1,revision:2}},function(c,b,a){Object.defineProperty(b,"__esModule",{value:!0});b.registerListener=function(a){try{if(r.addEventListener)return r.addEventListener("message",a),!0;console.warn("Cross-frame communication not supported")}catch(b){console.error("Unable to register listener",
b)}return!1}},function(c,b,a){b=a(2);var d=a(4),e=a(35),f=d("iterator");c.exports=!b(function(){var a=new URL("b?a\x3d1\x26b\x3d2\x26c\x3d3","http://a"),b=a.searchParams,c="";return a.pathname="c%20d",b.forEach(function(a,d){b.delete("b");c+=d+a}),e&&!a.toJSON||!b.sort||"http://a/c%20d?a\x3d1\x26c\x3d3"!==a.href||"3"!==b.get("c")||"a\x3d1"!==String(new URLSearchParams("?a\x3d1"))||!b[f]||"a"!==(new URL("https://a@b")).username||"b"!==(new URLSearchParams(new URLSearchParams("a\x3db"))).get("a")||
"xn--e1aybc"!==(new URL("http://")).host||"#%D0%B1"!==(new URL("http://a#")).hash||"a1c3"!==c||"x"!==(new URL("http://x",void 0)).host})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(c,b,a){a(20);c=a(1);var d=a(7);b=a(215);var e=a(0),f=a(152),g=a(17),l=a(46),k=a(9),m=a(270),u=a(167),x=a(119).codeAt,A=a(271),z=a(23),w=a(272);a=a(24);var v=e.URL,h=w.URLSearchParams,p=w.getState,C=a.set,t=a.getterFor("URL"),r=Math.floor,q=Math.pow,B=/[A-Za-z]/,D=/[\d+-.A-Za-z]/,G=/\d/,y=/^(0x|0X)/,
N=/^[0-7]+$/,E=/^\d+$/,M=/^[\dA-Fa-f]+$/,W=/[\u0000\u0009\u000A\u000D #%/:?@[\\]]/,P=/[\u0000\u0009\u000A\u000D #/:?@[\\]]/,fa=/^[\u0000-\u001F ]+|[\u0000-\u001F ]+$/g,O=/[\u0009\u000A\u000D]/g,ha=function(a,b){var c,d;if("["==b.charAt(0)){if("]"!=b.charAt(b.length-1)||!(c=Y(b.slice(1,-1))))return"Invalid host"}else if(L(a)){if((b=A(b),W.test(b))||null===(c=R(b)))return"Invalid host"}else{if(P.test(b))return"Invalid host";c="";b=u(b);for(d=0;d<b.length;d++)c+=J(b[d],K)}a.host=c},R=function(a){var b,
c,d,e,h,f=a.split(".");if(f.length&&""==f[f.length-1]&&f.pop(),4<(b=f.length))return a;c=[];for(d=0;d<b;d++){if(""==(e=f[d]))return a;if(h=10,1<e.length&&"0"==e.charAt(0)&&(h=y.test(e)?16:8,e=e.slice(8==h?1:2)),""===e)e=0;else{if(!(10==h?E:8==h?N:M).test(e))return a;e=parseInt(e,h)}c.push(e)}for(d=0;d<b;d++)if(e=c[d],d==b-1){if(e>=q(256,5-b))return null}else if(255<e)return null;a=c.pop();for(d=0;d<c.length;d++)a+=c[d]*q(256,3-d);return a},Y=function(a){var b,c,d,e,h=[0,0,0,0,0,0,0,0],f=0,p=null,
q=0;e=function(){return a.charAt(q)};if(":"==e()){if(":"!=a.charAt(1))return;q+=2;p=++f}for(;e();){if(8==f)return;if(":"!=e()){for(b=c=0;4>c&&M.test(e());)b=16*b+parseInt(e(),16),q++,c++;if("."==e()){if(0==c||(q-=c,6<f))return;for(b=0;e();){if(c=null,0<b){if(!("."==e()&&4>b))return;q++}if(!G.test(e()))return;for(;G.test(e());){if(d=parseInt(e(),10),null===c)c=d;else{if(0==c)return;c=10*c+d}if(255<c)return;q++}h[f]=256*h[f]+c;2!=++b&&4!=b||f++}if(4!=b)return;break}if(":"==e()){if(q++,!e())return}else if(e())return;
h[f++]=b}else{if(null!==p)return;q++;p=++f}}if(null!==p)for(e=f-p,f=7;0!=f&&0<e;)b=h[f],h[f--]=h[p+e-1],h[p+--e]=b;else if(8!=f)return;return h},H=function(a){var b,c,d;if("number"==typeof a){b=[];for(c=0;4>c;c++)b.unshift(a%256),a=r(a/256);return b.join(".")}if("object"==typeof a){b="";var e;c=null;e=1;for(var h=null,f=0,p=0;8>p;p++)0!==a[p]?(f>e&&(c=h,e=f),h=null,f=0):(null===h&&(h=p),++f);e=(f>e&&(c=h),c);for(c=0;8>c;c++)d&&0===a[c]||(d&&(d=!1),e===c?(b+=c?":":"::",d=!0):(b+=a[c].toString(16),
7>c&&(b+=":")));return"["+b+"]"}return a},K={},ia=m({},K,{" ":1,'"':1,"\x3c":1,"\x3e":1,"`":1}),ba=m({},ia,{"#":1,"?":1,"{":1,"}":1}),Q=m({},ba,{"/":1,":":1,";":1,"\x3d":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),J=function(a,b){var c=x(a,0);return 32<c&&127>c&&!k(b,a)?a:encodeURIComponent(a)},X={ftp:21,file:null,http:80,https:443,ws:80,wss:443},L=function(a){return k(X,a.scheme)},T=function(a){return!a.host||a.cannotBeABaseURL||"file"==a.scheme},Z=function(a,b){var c;return 2==a.length&&B.test(a.charAt(0))&&
(":"==(c=a.charAt(1))||!b&&"|"==c)},la=function(a){var b;return 1<a.length&&Z(a.slice(0,2))&&(2==a.length||"/"===(b=a.charAt(2))||"\\"===b||"?"===b||"#"===b)},S=function(a){var b=a.path,c=b.length;!c||"file"==a.scheme&&1==c&&Z(b[0],!0)||b.pop()},aa={},ka={},U={},V={},da={},ma={},za={},na={},oa={},ja={},pa={},va={},wa={},xa={},Aa={},ya={},ta={},ca={},Ba={},qa={},ga={},ea=function(a,b,c,d){var e,h,f,p;f=c||aa;var q=0;h="";var g=!1,m=!1,C=!1;c||(a.scheme="",a.username="",a.password="",a.host=null,a.port=
null,a.path=[],a.query=null,a.fragment=null,a.cannotBeABaseURL=!1,b=b.replace(fa,""));b=b.replace(O,"");for(b=u(b);q<=b.length;){switch(e=b[q],f){case aa:if(!e||!B.test(e)){if(c)return"Invalid scheme";f=U;continue}h+=e.toLowerCase();f=ka;break;case ka:if(e&&(D.test(e)||"+"==e||"-"==e||"."==e))h+=e.toLowerCase();else{if(":"!=e){if(c)return"Invalid scheme";h="";f=U;q=0;continue}if(c&&(L(a)!=k(X,h)||"file"==h&&(""!=a.username||""!=a.password||null!==a.port)||"file"==a.scheme&&!a.host))return;if(a.scheme=
h,c)return void(L(a)&&X[a.scheme]==a.port&&(a.port=null));h="";"file"==a.scheme?f=xa:L(a)&&d&&d.scheme==a.scheme?f=V:L(a)?f=na:"/"==b[q+1]?(f=da,q++):(a.cannotBeABaseURL=!0,a.path.push(""),f=Ba)}break;case U:if(!d||d.cannotBeABaseURL&&"#"!=e)return"Invalid scheme";if(d.cannotBeABaseURL&&"#"==e){a.scheme=d.scheme;a.path=d.path.slice();a.query=d.query;a.fragment="";a.cannotBeABaseURL=!0;f=ga;break}f="file"==d.scheme?xa:ma;continue;case V:if("/"!=e||"/"!=b[q+1]){f=ma;continue}f=oa;q++;break;case da:if("/"==
e){f=ja;break}f=ca;continue;case ma:if(a.scheme=d.scheme,void 0==e)a.username=d.username,a.password=d.password,a.host=d.host,a.port=d.port,a.path=d.path.slice(),a.query=d.query;else if("/"==e||"\\"==e&&L(a))f=za;else if("?"==e)a.username=d.username,a.password=d.password,a.host=d.host,a.port=d.port,a.path=d.path.slice(),a.query="",f=qa;else{if("#"!=e){a.username=d.username;a.password=d.password;a.host=d.host;a.port=d.port;a.path=d.path.slice();a.path.pop();f=ca;continue}a.username=d.username;a.password=
d.password;a.host=d.host;a.port=d.port;a.path=d.path.slice();a.query=d.query;a.fragment="";f=ga}break;case za:if(!L(a)||"/"!=e&&"\\"!=e){if("/"!=e){a.username=d.username;a.password=d.password;a.host=d.host;a.port=d.port;f=ca;continue}f=ja}else f=oa;break;case na:if(f=oa,"/"!=e||"/"!=h.charAt(q+1))continue;q++;break;case oa:if("/"!=e&&"\\"!=e){f=ja;continue}break;case ja:if("@"==e){g&&(h="%40"+h);g=!0;h=u(h);for(e=0;e<h.length;e++){var t=h[e];":"!=t||C?(t=J(t,Q),C?a.password+=t:a.username+=t):C=!0}h=
""}else if(void 0==e||"/"==e||"?"==e||"#"==e||"\\"==e&&L(a)){if(g&&""==h)return"Invalid authority";q-=u(h).length+1;h="";f=pa}else h+=e;break;case pa:case va:if(c&&"file"==a.scheme){f=ya;continue}if(":"!=e||m){if(void 0==e||"/"==e||"?"==e||"#"==e||"\\"==e&&L(a)){if(L(a)&&""==h)return"Invalid host";if(c&&""==h&&(""!=a.username||""!=a.password||null!==a.port))return;if(f=ha(a,h))return f;if(h="",f=ta,c)return;continue}"["==e?m=!0:"]"==e&&(m=!1);h+=e}else{if(""==h)return"Invalid host";if(f=ha(a,h))return f;
if(h="",f=wa,c==va)return}break;case wa:if(!G.test(e)){if(void 0==e||"/"==e||"?"==e||"#"==e||"\\"==e&&L(a)||c){if(""!=h){f=parseInt(h,10);if(65535<f)return"Invalid port";a.port=L(a)&&f===X[a.scheme]?null:f;h=""}if(c)return;f=ta;continue}return"Invalid port"}h+=e;break;case xa:if(a.scheme="file","/"==e||"\\"==e)f=Aa;else{if(!d||"file"!=d.scheme){f=ca;continue}if(void 0==e)a.host=d.host,a.path=d.path.slice(),a.query=d.query;else if("?"==e)a.host=d.host,a.path=d.path.slice(),a.query="",f=qa;else{if("#"!=
e){la(b.slice(q).join(""))||(a.host=d.host,a.path=d.path.slice(),S(a));f=ca;continue}a.host=d.host;a.path=d.path.slice();a.query=d.query;a.fragment="";f=ga}}break;case Aa:if("/"==e||"\\"==e){f=ya;break}d&&"file"==d.scheme&&!la(b.slice(q).join(""))&&(Z(d.path[0],!0)?a.path.push(d.path[0]):a.host=d.host);f=ca;continue;case ya:if(void 0==e||"/"==e||"\\"==e||"?"==e||"#"==e){if(!c&&Z(h))f=ca;else{if(""==h){if(a.host="",c)return}else{if(f=ha(a,h))return f;if("localhost"==a.host&&(a.host=""),c)return;h=
""}f=ta}continue}h+=e;break;case ta:if(L(a)){if(f=ca,"/"!=e&&"\\"!=e)continue}else if(c||"?"!=e)if(c||"#"!=e){if(void 0!=e&&(f=ca,"/"!=e))continue}else a.fragment="",f=ga;else a.query="",f=qa;break;case ca:if(void 0==e||"/"==e||"\\"==e&&L(a)||!c&&("?"==e||"#"==e)){if(".."===(p=(p=h).toLowerCase())||"%2e."===p||".%2e"===p||"%2e%2e"===p?(S(a),"/"==e||"\\"==e&&L(a)||a.path.push("")):"."===h||"%2e"===h.toLowerCase()?"/"==e||"\\"==e&&L(a)||a.path.push(""):("file"==a.scheme&&!a.path.length&&Z(h)&&(a.host&&
(a.host=""),h=h.charAt(0)+":"),a.path.push(h)),h="","file"==a.scheme&&(void 0==e||"?"==e||"#"==e))for(;1<a.path.length&&""===a.path[0];)a.path.shift();"?"==e?(a.query="",f=qa):"#"==e&&(a.fragment="",f=ga)}else h+=J(e,ba);break;case Ba:"?"==e?(a.query="",f=qa):"#"==e?(a.fragment="",f=ga):void 0!=e&&(a.path[0]+=J(e,K));break;case qa:c||"#"!=e?void 0!=e&&("'"==e&&L(a)?a.query+="%27":a.query+="#"==e?"%23":J(e,K)):(a.fragment="",f=ga);break;case ga:void 0!=e&&(a.fragment+=J(e,ia))}q++}},ra=function(a){var b,
c,e=l(this,ra,"URL");c=1<arguments.length?arguments[1]:void 0;var f=String(a),q=C(e,{type:"URL"});if(void 0!==c)if(c instanceof ra)b=t(c);else if(c=ea(b={},String(c)))throw TypeError(c);if(c=ea(q,f,null,b))throw TypeError(c);var g=q.searchParams=new h;b=p(g);b.updateSearchParams(q.query);b.updateURL=function(){q.query=String(g)||null};d||(e.href=ua.call(e),e.origin=Ca.call(e),e.protocol=Da.call(e),e.username=Ea.call(e),e.password=Fa.call(e),e.host=Ga.call(e),e.hostname=Ha.call(e),e.port=Ia.call(e),
e.pathname=Ja.call(e),e.search=Ka.call(e),e.searchParams=La.call(e),e.hash=Ma.call(e))};a=ra.prototype;var ua=function(){var a=t(this),b=a.scheme,c=a.username,d=a.password,e=a.host,h=a.port,f=a.path,p=a.query,q=a.fragment,g=b+":";return null!==e?(g+="//",(""!=a.username||""!=a.password)&&(g+=c+(d?":"+d:"")+"@"),g+=H(e),null!==h&&(g+=":"+h)):"file"==b&&(g+="//"),g+=a.cannotBeABaseURL?f[0]:f.length?"/"+f.join("/"):"",null!==p&&(g+="?"+p),null!==q&&(g+="#"+q),g},Ca=function(){var a=t(this),b=a.scheme,
c=a.port;if("blob"==b)try{return(new URL(b.path[0])).origin}catch(d){return"null"}return"file"!=b&&L(a)?b+"://"+H(a.host)+(null!==c?":"+c:""):"null"},Da=function(){return t(this).scheme+":"},Ea=function(){return t(this).username},Fa=function(){return t(this).password},Ga=function(){var a=t(this),b=a.host,a=a.port;return null===b?"":null===a?H(b):H(b)+":"+a},Ha=function(){var a=t(this).host;return null===a?"":H(a)},Ia=function(){var a=t(this).port;return null===a?"":String(a)},Ja=function(){var a=
t(this),b=a.path;return a.cannotBeABaseURL?b[0]:b.length?"/"+b.join("/"):""},Ka=function(){var a=t(this).query;return a?"?"+a:""},La=function(){return t(this).searchParams},Ma=function(){var a=t(this).fragment;return a?"#"+a:""},e=function(a,b){return{get:a,set:b,configurable:!0,enumerable:!0}};if(d&&f(a,{href:e(ua,function(a){var b=t(this);if(a=ea(b,String(a)))throw TypeError(a);p(b.searchParams).updateSearchParams(b.query)}),origin:e(Ca),protocol:e(Da,function(a){var b=t(this);ea(b,String(a)+":",
aa)}),username:e(Ea,function(a){var b=t(this);a=u(String(a));if(!T(b)){b.username="";for(var c=0;c<a.length;c++)b.username+=J(a[c],Q)}}),password:e(Fa,function(a){var b=t(this);a=u(String(a));if(!T(b)){b.password="";for(var c=0;c<a.length;c++)b.password+=J(a[c],Q)}}),host:e(Ga,function(a){var b=t(this);b.cannotBeABaseURL||ea(b,String(a),pa)}),hostname:e(Ha,function(a){var b=t(this);b.cannotBeABaseURL||ea(b,String(a),va)}),port:e(Ia,function(a){var b=t(this);T(b)||(""==(a=String(a))?b.port=null:ea(b,
a,wa))}),pathname:e(Ja,function(a){var b=t(this);b.cannotBeABaseURL||(b.path=[],ea(b,a+"",ta))}),search:e(Ka,function(a){var b=t(this);""==(a=String(a))?b.query=null:("?"==a.charAt(0)&&(a=a.slice(1)),b.query="",ea(b,a,qa));p(b.searchParams).updateSearchParams(b.query)}),searchParams:e(La),hash:e(Ma,function(a){var b=t(this);""!=(a=String(a))?("#"==a.charAt(0)&&(a=a.slice(1)),b.fragment="",ea(b,a,ga)):b.fragment=null})}),g(a,"toJSON",function(){return ua.call(this)},{enumerable:!0}),g(a,"toString",
function(){return ua.call(this)},{enumerable:!0}),v){var Na=v.createObjectURL,Oa=v.revokeObjectURL;Na&&g(ra,"createObjectURL",function(a){return Na.apply(v,arguments)});Oa&&g(ra,"revokeObjectURL",function(a){return Oa.apply(v,arguments)})}z(ra,"URL");c({global:!0,forced:!b,sham:!d},{URL:ra})},function(c,b,a){var d=a(7);b=a(2);var e=a(97),f=a(113),g=a(112),l=a(19),k=a(92),m=Object.assign,u=Object.defineProperty;c.exports=!m||b(function(){if(d&&1!==m({b:1},m(u({},"a",{enumerable:!0,get:function(){u(this,
"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var a={},b={},c=Symbol();return a[c]=7,"abcdefghijklmnopqrst".split("").forEach(function(a){b[a]=a}),7!=m({},a)[c]||"abcdefghijklmnopqrst"!=e(m({},b)).join("")})?function(a,b){for(var c=l(a),m=arguments.length,u=1,h=f.f,p=g.f;m>u;)for(var C,t=k(arguments[u++]),r=h?e(t).concat(h(t)):e(t),q=r.length,B=0;q>B;)C=r[B++],d&&!p.call(t,C)||(c[C]=t[C]);return c}:m},function(c,b,a){var d=/[^\0-\u007E]/,e=/[.\u3002\uFF0E\uFF61]/g,f=Math.floor,g=String.fromCharCode,
l=function(a){return a+22+75*(26>a)},k=function(a){var b,c,d=[];b=[];for(var e=0,k=a.length;e<k;){var v=a.charCodeAt(e++);if(55296<=v&&56319>=v&&e<k){var h=a.charCodeAt(e++);56320==(64512&h)?b.push(((1023&v)<<10)+(1023&h)+65536):(b.push(v),e--)}else b.push(v)}var e=(a=b).length,k=128,p=0,C=72;for(b=0;b<a.length;b++)128>(c=a[b])&&d.push(g(c));for((h=v=d.length)&&d.push("-");h<e;){var t=2147483647;for(b=0;b<a.length;b++)(c=a[b])>=k&&c<t&&(t=c);var r=h+1;if(t-k>f((2147483647-p)/r))throw RangeError("Overflow: input needs wider integers to process");
p+=(t-k)*r;k=t;for(b=0;b<a.length;b++){if((c=a[b])<k&&2147483647<++p)throw RangeError("Overflow: input needs wider integers to process");if(c==k){for(var q=p,t=36;;t+=36){var B=t<=C?1:t>=C+26?26:t-C;if(q<B)break;var q=q-B,D=36-B;d.push(g(l(B+q%D)));q=f(q/D)}d.push(g(l(q)));C=r;t=0;p=h==v?f(p/700):p>>1;for(p+=f(p/C);455<p;t+=36)p=f(p/35);C=f(t+36*p/(p+38));p=0;++h}}++p;++k}return d.join("")};c.exports=function(a){var b,c=[],f=a.toLowerCase().replace(e,".").split(".");for(a=0;a<f.length;a++)b=f[a],
c.push(d.test(b)?"xn--"+k(b):b);return c.join(".")}},function(c,b,a){a(11);b=a(1);var d=a(27),e=a(215),f=a(17),g=a(94),l=a(23),k=a(154),m=a(24),u=a(46),x=a(9),A=a(41),z=a(87),w=a(10),v=a(5),h=a(33),p=a(39),C=a(273),t=a(88);a=a(4);var r=d("fetch"),q=d("Headers");a=a("iterator");var B=m.set,D=m.getterFor("URLSearchParams"),G=m.getterFor("URLSearchParamsIterator"),y=/\+/g,N=Array(4),E=function(a){return N[a-1]||(N[a-1]=RegExp("((?:%[\\da-f]{2}){"+a+"})","gi"))},M=function(a){try{return decodeURIComponent(a)}catch(b){return a}},
W=function(a){a=a.replace(y," ");var b=4;try{return decodeURIComponent(a)}catch(c){for(;b;)a=a.replace(E(b--),M);return a}},P=/[!'()~]|%20/g,fa={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},O=function(a){return fa[a]},R=function(a,b){if(b){var c,d;b=b.split("\x26");for(var e=0;e<b.length;)(c=b[e++]).length&&(d=c.split("\x3d"),a.push({key:W(d.shift()),value:W(d.join("\x3d"))}))}},sa=function(a){this.entries.length=0;R(this.entries,a)},Y=function(a,b){if(a<b)throw TypeError("Not enough arguments");
},H=k(function(a,b){B(this,{type:"URLSearchParamsIterator",iterator:C(D(a).entries),kind:b})},"Iterator",function(){var a=G(this),b=a.kind,a=a.iterator.next(),c=a.value;return a.done||(a.value="keys"===b?c.key:"values"===b?c.value:[c.key,c.value]),a}),K=function(){u(this,K,"URLSearchParams");var a,b,c,d,e,f;c=0<arguments.length?arguments[0]:void 0;var h=[];if(B(this,{type:"URLSearchParams",entries:h,updateURL:function(){},updateSearchParams:sa}),void 0!==c)if(v(c))if("function"==typeof(a=t(c)))for(b=
(a=a.call(c)).next;!(c=b.call(a)).done;){if((c=(e=(d=C(w(c.value))).next).call(d)).done||(f=e.call(d)).done||!e.call(d).done)throw TypeError("Expected sequence with length 2");h.push({key:c.value+"",value:f.value+""})}else for(b in c)x(c,b)&&h.push({key:b,value:c[b]+""});else R(h,"string"==typeof c?"?"===c.charAt(0)?c.slice(1):c:c+"")},k=K.prototype;g(k,{append:function(a,b){Y(arguments.length,2);var c=D(this);c.entries.push({key:a+"",value:b+""});c.updateURL()},delete:function(a){Y(arguments.length,
1);for(var b=D(this),c=b.entries,d=a+"",e=0;e<c.length;)c[e].key===d?c.splice(e,1):e++;b.updateURL()},get:function(a){Y(arguments.length,1);for(var b=D(this).entries,c=a+"",d=0;d<b.length;d++)if(b[d].key===c)return b[d].value;return null},getAll:function(a){Y(arguments.length,1);for(var b=D(this).entries,c=a+"",d=[],e=0;e<b.length;e++)b[e].key===c&&d.push(b[e].value);return d},has:function(a){Y(arguments.length,1);for(var b=D(this).entries,c=a+"",d=0;d<b.length;)if(b[d++].key===c)return!0;return!1},
set:function(a,b){Y(arguments.length,1);for(var c,d=D(this),e=d.entries,f=!1,h=a+"",p=b+"",q=0;q<e.length;q++)(c=e[q]).key===h&&(f?e.splice(q--,1):(f=!0,c.value=p));f||e.push({key:h,value:p});d.updateURL()},sort:function(){var a,b,c,d=D(this),e=d.entries,f=e.slice();for(c=e.length=0;c<f.length;c++){a=f[c];for(b=0;b<c;b++)if(e[b].key>a.key){e.splice(b,0,a);break}b===c&&e.push(a)}d.updateURL()},forEach:function(a){for(var b,c=D(this).entries,d=A(a,1<arguments.length?arguments[1]:void 0,3),e=0;e<c.length;)d((b=
c[e++]).value,b.key,this)},keys:function(){return new H(this,"keys")},values:function(){return new H(this,"values")},entries:function(){return new H(this,"entries")}},{enumerable:!0});f(k,a,k.entries);f(k,"toString",function(){for(var a,b=D(this).entries,c=[],d=0;d<b.length;)a=b[d++],c.push(encodeURIComponent(a.key).replace(P,O)+"\x3d"+encodeURIComponent(a.value).replace(P,O));return c.join("\x26")},{enumerable:!0});l(K,"URLSearchParams");b({global:!0,forced:!e},{URLSearchParams:K});e||"function"!=
typeof r||"function"!=typeof q||b({global:!0,enumerable:!0,forced:!0},{fetch:function(a){var b,c,d,e=[a];return 1<arguments.length&&(v(b=arguments[1])&&(c=b.body,"URLSearchParams"===z(c)&&((d=b.headers?new q(b.headers):new q).has("content-type")||d.set("content-type","application/x-www-form-urlencoded;charset\x3dUTF-8"),b=h(b,{body:p(0,String(c)),headers:p(0,d)}))),e.push(b)),r.apply(this,e)}});c.exports={URLSearchParams:K,getState:D}},function(c,b,a){var d=a(10),e=a(88);c.exports=function(a){var b=
e(a);if("function"!=typeof b)throw TypeError(String(a)+" is not iterable");return d(b.call(a))}},,function(c,b,a){c.exports=a(276)},function(c,b,a){function d(a){try{e().handleMessage(a)}catch(b){console.warn("Unable to handle message from SDK",b)}}function e(a){if(!g){if(!a)throw Error("SDK window is not defined");(0,k.registerListener)(d);g=new l.WebSdkSenderClient(a)}return a&&g.assertSdkWindow(a),g}Object.defineProperty(b,"__esModule",{value:!0});var f={enableWebSdkClient:!0,disableWebSdkClient:!0,
initialize:!0,authenticate:!0};b.enableWebSdkClient=function(a){e(a)};b.disableWebSdkClient=function(){g=void 0};b.initialize=function(a,b,c){e(c).initialize(a,b)};b.authenticate=function(a,b,c){e(c).authenticate(a,b)};var g,l=a(277),k=a(214),m=a(168);Object.keys(m).forEach(function(a){"default"!==a&&"__esModule"!==a&&(Object.prototype.hasOwnProperty.call(f,a)||Object.defineProperty(b,a,{enumerable:!0,get:function(){return m[a]}}))})},function(c,b,a){function d(a,b,c,d,e,f,p){try{var g=a[f](p),m=
g.value}catch(k){return void c(k)}g.done?b(m):Promise.resolve(m).then(d,e)}function e(a){return function(){var b=this,c=arguments;return new Promise(function(e,f){function h(a){d(g,e,f,h,p,"next",a)}function p(a){d(g,e,f,h,p,"throw",a)}var g=a.apply(b,c);h(void 0)})}}function f(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}function g(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,
enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}a(11);a(18);a(117);a(6);a(3);a(14);a(21);a(20);a(22);a(269);Object.defineProperty(b,"__esModule",{value:!0});b.WebSdkSenderClient=void 0;a(15);var l=a(213),k=a(212),m=a(190),u=a(168);c=function(){function a(b){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");!0;g(this,"SDK_ACK_TIMEOUT",200);g(this,"clientWindow",void 0);g(this,"sdkWindow",void 0);g(this,"sequence",0);g(this,"callMap",new Map);g(this,"sdkAck",!1);
g(this,"origin",void 0);this.clientWindow=r;this.sdkWindow=b}var b,c,d;return b=[{key:"assertSdkWindow",value:function(a){if(this.sdkWindow!==a)throw Error("SDK Client supports only a single paired iFrame");}},{key:"handleMessage",value:function(a){try{this.validateSender(a);console.log("Received from SDK ".concat(a.data));var b=JSON.parse(a.data.toString()),c=this.callMap.get(b.sequence);if(!c)throw Error("Unmatched call instance");this.handleMessageSync(b,c)}catch(d){console.error("Unable to handle SDK message",
d)}}},{key:"validateSender",value:function(a){if(a.source!==this.sdkWindow)throw Error("Unexpected sender window");if(a.origin!==this.ensureOrigin())throw Error("Unexpected sender origin");}},{key:"handleMessageSync",value:function(a,b){if(!b)throw Error("No matching callback has been set");u.AuthenticationStatusType.SdkAck===a.output.status?this.sdkAck=!0:b.callback(a.output)}},{key:"initialize",value:function(a,b){this.handleCall(k.ApiType.Initialize,a,b)}},{key:"authenticate",value:function(a,
b){this.handleCall(k.ApiType.Authenticate,a,b)}},{key:"handleCall",value:function(a,b,c){var d=this.sequence++;a={messageIn:{sequence:d,api:a,version:l.CURRENT_SDK_VERSION,input:b},callback:c};this.callMap.set(d,a);this.handleCallAsync(a).then(function(){console.log("SDK Client call processed")}).catch(function(a){console.error("Did not complete async call")})}},{key:"handleCallAsync",value:(d=e(regeneratorRuntime.mark(function h(a){var b,c,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=
e.next){case 0:if(e.prev=0,r.addEventListener){e.next=3;break}throw Error("Cross frame communication not supported");case 3:return b=JSON.stringify(a.messageIn),c=this.setOriginFromUrl(a.messageIn.input.url),this.sdkWindow.postMessage(b,c),e.next=8,this.confirmAckWithTimeout();case 8:e.next=15;break;case 10:e.prev=10,e.t0=e.catch(0),console.warn("Browser does not support SDK",e.t0),d={status:u.AuthenticationStatusType.FallbackRequiredError,errorDesc:"Browser does not support SDK"},a.callback(d);case 15:case "end":return e.stop()}},
h,this,[[0,10]])})),function(a){return d.apply(this,arguments)})},{key:"getTargetOriginFromUrl",value:function(a){try{return(new URL(a)).origin}catch(b){var c=document.createElement("a");return c.href=a,c.origin}}},{key:"confirmAckWithTimeout",value:(c=e(regeneratorRuntime.mark(function p(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,m.wait)(this.SDK_ACK_TIMEOUT);case 2:if(this.sdkAck){a.next=4;break}throw Error("SDK connection timed out");case 4:case "end":return a.stop()}},
p,this)})),function(){return c.apply(this,arguments)})},{key:"setOriginFromUrl",value:function(a){a=this.getTargetOriginFromUrl(a);if(void 0===this.origin)this.origin=a;else if(this.origin!==a)throw Error("Multiple origins not supported for SDK");return this.origin}},{key:"ensureOrigin",value:function(){if(void 0!==this.origin)return this.origin;throw Error("Origin has not been set for SDK");}}],f(a.prototype,b),a}();b.WebSdkSenderClient=c}])}catch(c){f=function(){}}return f});y("security",["base",
"clog","config","jQuery"],function(f,c,b,a){function d(a){a=a.not('[name^\x3d"ppw-"]').filter(function(){return this.value&&""!==this.value.trim()});for(var b=0;b<g.length;++b)a=a.not('[name\x3d"'+g[b]+'"]');return a}function e(b){return function(){d(b.getRootDOMElements().find("input")).each(function(b,d){b=a(d).attr("name");c.logCounterMetric({feature:"sec.exf.",resource:b,amount:n})});c.publishMetrics()}}var n=b.getAttribute("securePage")?0:1,g=["ie"];return f.extend({initialize:function(a){var b=
e(a);a.getRootDOMElements().find(":button,:submit").bind("click",b)}})});y("server",["jQuery","lang","clog"],function(f,c,b){function a(a,b,d){b in a&&(a[b]=c.bind(a[b],d))}function d(a){var b=[];c.forEach(a,function(a){null!=a&&b.push(e(a))});return b}function e(a){if(c.isArray(a))return d(a);if(c.isObject(a)){var b={},f;for(f in a){var g=a[f];null!=g&&(b[f]=e(g))}return b}return a}function n(a){var b=c.extend({},l,a);b.data=e(a.data);b.fatal||(b.fatal=c.NOOP);b.error||(b.error=function(a,c){k&&
"error"===c||b.fatal()});b.headers=c.extend(b.headers,{"Widget-Ajax-Attempt-Count":0});null==b.metricOperation&&(b.metricOperation=b.type);return b}function g(a){var b=0,d=500+Math.floor(500*Math.random());c.has(a,"retryLimit")||(a.retryLimit=2);var e=function(a){return 0===a?d:1E3*Math.pow(2,a)},g=a.retryDelayFn?a.retryDelayFn:e,k=a.error;return function(d,e){var p=500<=d.status&&600>d.status||408===d.status||"timeout"===e||0===d.status&&0===d.readyState;401===d.status?a.fatal({type:"auth"}):!p&&
k?k.apply(this,arguments):p&&b<a.retryLimit?(p=g(b),b++,a.headers=c.extend(a.headers,{"Widget-Ajax-Attempt-Count":b}),r.setTimeout(function(){f.ajax(a)},p)):b>=a.retryLimit&&k&&k.apply(this,arguments)}}var l={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",dataType:"json",cache:!1,globals:!1,timeout:3E4},k=!1;f(r).bind("beforeunload",function(){k=!0});return{ajax:function(c){var d=b.getCurrentTime();k=!1;c=n(c);this._addInterceptHandlers(c,d);if(d=c.context)delete c.context,a(c,
"beforeSend",d),a(c,"success",d),a(c,"error",d),a(c,"complete",d);if(d=c.query){var e=-1===c.url.indexOf("?")?"?":"\x26";c.url+=e+f.param(d,!0)}c.error=g(c);c.xhrFields={withCredentials:!0};return f.ajax(c)},_addInterceptHandlers:function(a,d){c.time();c.intercept(a,"error",function(c,d,e){a.data&&a.data["ppw-widgetEvent"]&&b.logCounterMetric({feature:a.data["ppw-widgetEvent"],resource:"_ErrorCount"})},this);c.intercept(a,"complete",function(){c.time();a.data&&a.data["ppw-widgetEvent"]&&(b.logCounterMetric({feature:a.data["ppw-widgetEvent"],
resource:"_Count"}),b.logLatencyMetric({feature:a.data["ppw-widgetEvent"],resource:"_Latency",startTime:d}))},this);c.intercept(a,"success",function(){a.data&&a.data["ppw-widgetEvent"]&&b.logCounterMetric({feature:a.data["ppw-widgetEvent"],resource:"_SuccessCount"})},this)}}});y("storage-helper",[],function(){return{putInSession:function(f,c){f&&c&&r.sessionStorage.setItem(f,JSON.stringify(c))},getFromSession:function(f){if(f)return f=r.sessionStorage.getItem(f),JSON.parse(f)}}});y("testAjaxCapability",
["clog"],function(f){return{makeCall:function(c){var b=this,a=c.options.clientId+"_testAjaxCapability";c.continueRequest({"ppw-widgetState":c.options.serializedState},{success:function(c){b.logMetric(a,0)},error:function(c){b.logMetric(a,1)},fatal:function(c){b.logMetric(a,1)}})},logMetric:function(c,b){f.logCounterMetric({feature:c,resource:"_Count",amount:b})}}});y("tooltip",["popover-base"],function(f){return f.extend({componentName:"a-tooltip"})});y("url-helper",[],function(){return{getParameterFromCurrentURL:function(f){try{return(new URLSearchParams(r.location.search)).get(f)}catch(c){return""}}}});
y("validation-functions",["lang","number-format"],function(f,c){var b=function(a){if(!a||0===a.length)return!1;for(var b=0,c=!1,d=a.length-1;0<=d;--d){var e=a.charAt(d);c&&(e*=2,9<e&&(e-=9));b+=parseInt(e,10);c=!c}return 0===b%10},a=function(a,b){return f.some(b,function(b){return a.test(b)})},d=function(a){return f.some(a,function(a){return a&&""!==f.trim(a)})},e=function(a){a=a.split("").map(function(a){return parseInt(a,10)});var b=a.length+1;a=a.map(function(a,c){return a*(b-c)}).reduce(function(a,
b){return a+b})%11;return 2>a?0:11-a},n=function(a){var b=2;a=a.split("").reduce(function(a,b){return[parseInt(b,10)].concat(a)},[]).reduce(function(a,c){a+=c*b;b=9===b?2:b+1;return a},0)%11;return 2>a?0:11-a},g=function(a,b){return a!==E&&null!==a&&!0!==a&&!1!==a&&""!==f.trim(a)?(a=(new c(b)).localizedParseNumber(a),isNaN(a)?null:a):null},l=function(a){return a&&null!==a.match(/^[0-9]+$/)},k=function(a){a=a.getAdditionalData("isMbccFn");return f.isFunction(a)&&a()},m=function(a){var b=/^\d{3,4}$/;
"AmericanExpress"===a?b=/^\d{4}$/:a&&(b=/^\d{3}$/);return b},u=function(a,b){return!b.fieldRequiredParameterName||"true"===a[b.fieldRequiredParameterName]},r=function(a){return a&&a.replace(/-|\s/g,"")},A=function(a,b,c){var d="";a!==E&&(d=a);a=b[c.defaultParameterName];return a!==E&&(a=r(a),4<=a.length)?a.substr(a.length-d.length)===d:!1},z=function(a,b,c){var d=a.getAdditionalData("isCvvForMbcc");b=b[c.defaultParameterName];d?a=k(a)?/^\d{3,8}$/:/.*?/:(a=a.getAdditionalData("issuerFn"),a=f.isFunction(a)?
a():"",a=m(a));return a.test(f.trim(b))},w=function(a,b,c){b=b[c.defaultParameterName];a=a.getAdditionalData("issuerFn");return"AmericanExpress"===(f.isFunction(a)?a():"")?/^\d{4}$/.test(f.trim(b)):!0},v={NonEmptyFieldConstraint:function(a,b,c){a=b[c.defaultParameterName];return a!==E&&""!==f.trim(a)},RegexMatchFieldConstraint:function(a,b,c,d){return(new RegExp(d.pattern)).test(b[c.defaultParameterName])},NonEmptyComplexFieldConstraint:function(a,b,c){return d([b[c.defaultParameterName],b[c.radioButtonName],
b[c.dropdownName]])},NumericCustomAmountRewardsAccountSelectionFieldConstraint:function(a,b,c,d){a=d.locale.substring(3);return f.isDefined(g(b[c.customAmountSelectionInput],a))},CustomAmountLessThanOrEqualToMaxUsableRewardsAccountSelectionFieldConstraint:function(a,b,c,d){a=b[c.customAmountSelectionInput];b=d.locale.substring(3);a=g(a,b);return f.isDefined(a)&&a<=Number(d.maxUsableAmount)},CustomAmountLargerThanOrEqualToMinUsableRewardsAccountSelectionFieldConstraint:function(a,b,c,d){a=b[c.customAmountSelectionInput];
b=d.locale.substring(3);a=g(a,b);return f.isDefined(a)&&a>=Number(d.minUsableAmount)},LengthBetweenConstraint:function(a,b,c,d){a=b[c.defaultParameterName];return a.length>=d.min&&a.length<=d.max},LengthLessThanEqualConstraint:function(a,b,c,d){return b[c.defaultParameterName].length<=d.maximumLength},LengthGreaterThanEqualConstraint:function(a,b,c,d){return b[c.defaultParameterName].length>=d.minimumLength},LengthEqualToConstraint:function(a,b,c,d){a=b[c.defaultParameterName];return a!==E&&a.length===
d.expectedLength},IsNumberFieldConstraint:function(a,b,c){a=b[c.defaultParameterName];return a!==E&&null!==a&&!0!==a&&!1!==a&&!isNaN(a-0)&&""!==f.trim(a)},GreaterThanEqualFieldConstraint:function(a,b,c,d){return b[c.defaultParameterName]>=d.min},LessThanEqualFieldConstraint:function(a,b,c,d){return b[c.defaultParameterName]<=d.max},ExpirationDateTooFarConstraint:function(a,b,c,d){c=b[c.combinedMonthYearParameterName].split("/");if(2===c.length){a=c[0].trim();c=c[1].trim();if(2!==c.length)return!0;
a=parseInt(a,10);c=parseInt("20"+c,10)}else return!0;if(isNaN(a)||isNaN(c))return!1;b=(new Date(b.widgetCreationEpochMilliseconds)).getUTCFullYear();return c<=b+20},CreditCardExpirationFormatConstraint:function(a,b,c,d){a=b[c.combinedMonthYearParameterName];var e,f;a?(b=a.split("/"),2===b.length&&(e=parseInt(b[0].trim(),10),f=parseInt("20"+b[1].trim(),10))):(e=parseInt(b[c.monthParameterName],10),f=parseInt(b[c.yearParameterName],10));return isNaN(e)||isNaN(f)?!1:(1==e.toString().length||2==e.toString().length)&&
4==f.toString().length},CreditCardExpirationConstraint:function(a,b,c,d){a=b[c.combinedMonthYearParameterName];var e,f;a?(c=a.split("/"),2===c.length&&(e=parseInt(c[0].trim(),10),f=parseInt("20"+c[1].trim(),10))):(e=parseInt(b[c.monthParameterName],10),f=parseInt(b[c.yearParameterName],10));if(isNaN(e)||isNaN(f))return!1;c=new Date(b.widgetCreationEpochMilliseconds);b=c.getUTCFullYear();c=c.getUTCMonth();return f>b&&f<=b+20||f===b&&e>=c+1},ValidBirthDateConstraint:function(a,b,c){if(!u(b,c)&&!b[c.defaultParameterName])return!0;
a=(new Date(b.widgetCreationEpochMilliseconds)).toISOString().slice(0,10);b=b[c.defaultParameterName];return/^\d{4}-\d{2}-\d{2}$/.test(b)&&0<=a.localeCompare(b)},MCXCreditCardExpirationPastConstraint:function(a,b,c,d){c=b[c.combinedMonthYearParameterName].split("/");if(2===c.length){a=c[0].trim();c=c[1].trim();if(2!==c.length)return!0;a=parseInt(a,10);c=parseInt("20"+c,10)}else return!0;if(isNaN(a)||isNaN(c))return!1;d=new Date(b.widgetCreationEpochMilliseconds);b=d.getUTCFullYear();d=d.getUTCMonth();
return c>b||c===b&&a>=d+1},DateNonEmptyConstraint:function(a,b,c){a=b[c.combinedMonthYearParameterName];return a!==E&&""!==f.trim(a)},ValidCVVConstraint:function(a,b,c){return z(a,b,c)},ValidCreditCardSecurityCodeConstraint:function(a,b,c){return u(b,c)?z(a,b,c):!0},ValidAmexCVVConstraint:function(a,b,c){return w(a,b,c)},ValidAmexCreditCardSecurityCodeConstraint:function(a,b,c){return u(b,c)?w(a,b,c):!0},SelectableListValidCreditCardSecurityCodeConstraint:function(a,b,c,d){a=b[c.defaultParameterName];
return m(d.issuer).test(f.trim(a))},ValidCreditCardNumberTailConstraint:function(a,b,c){return A(a.getAdditionalData("creditCardTail"),b,c)},ValidBankAccountNumberTailConstraint:function(a,b,c){return A(a.getAdditionalData("accountNumberTail"),b,c)},ValidCreditCardNumberConstraint:function(a,c,d){var e=a.getAdditionalData("isSBIMaestroFn"),e=f.isFunction(e)?e():!1;c=r(c[d.defaultParameterName]);a=a.getAdditionalData("issuerFn");a="Naranja"===(f.isFunction(a)?a():"")?!0:!1;if(a){if(e=16===c.length)if(c&&
16===c.length){e=[4,3,2,7,6,5,4,3,2,7,6,5,4,3,2];for(d=a=0;d<c.length-1;d++)a+=parseInt(c.charAt(d),10)*e[d];e=11-a%11;e=(9<e?0:e)===parseInt(c[15],10)}else e=!1;return e}return e?19===c.length&&b(c):11<=c.length&&19>=c.length&&b(c)},ValidCreditCardNumberWarningConstraint:function(a,b,c){a=v.ValidCreditCardNumberConstraint(a,b,c);b=r(b[c.defaultParameterName]);return a||16>b.length},ValidCardHolderNameConstraint:function(a,b,c){return/([A-Z][a-z][a-z]*) ([A-Z][a-z]*)*(\.)? *([A-Z][a-z][a-z][a-z]*)*/.test(b[c.defaultParameterName])},
ValidCardHolderNameConstraint:function(a,b,c){return/([A-Z][a-z][a-z]*) ([A-Z][a-z]*)*(\.)? *([A-Z][a-z][a-z][a-z]*)*/.test(b[c.defaultParameterName])},ValidMinimalCardHolderNameConstraint:function(a,b,c){return v.NonEmptyFieldConstraint(a,b,c)},ValidEBTCardNumberConstraint:function(a,c,d){var e=r(c[d.defaultParameterName]);a=f.some(["600486","507714","507712"],function(a){return f.startsWith(e,a)})?l:b;return 16<=e.length&&19>=e.length&&a(e)},MatchValuesJSOnlyConstraint:function(a,b,c,d){a=b[c.defaultParameterName];
b=b[d.targetFieldParameterName];return a!==E&&b!==E&&a===b},DirectDebitPrefixNotContainsDigitsConstraint:function(a,b,c,d){a=b[c.defaultParameterName];d=d.lengthParameter;return a!==E&&null!==a&&null===a.substring(0,d).match(/\d+/g)},BrazilTaxIdConstraint:function(a,b,c,d){a=b[c.defaultParameterName];if(a===E||11!=a.length&&14!=a.length)return!1;if(11==a.length)return b=a.substr(0,9),b+=e(b),b+=e(b),b.substr(-2)===a.substr(-2);if(14==a.length)return b=a.substr(0,12),b+=n(b),b+=n(b),b.substr(-2)===
a.substr(-2)},BusinessTaxIDConstraint:function(a,b,c,d){d=b[c.defaultParameterName];return v.NonEmptyFieldConstraint(a,b,c)&&2>=d.replace(/[^-]/g,"").length&&9===d.replace(/[-]/g,"").length&&/^\d+$/.test(d.replace(/[-]/g,""))},InvoiceBirthdateConstraint:function(a,b,c,d){a=parseInt(b[c.monthParameterName],10)-1;d=parseInt(b[c.dayParameterName],10)-1;c=parseInt(b[c.yearParameterName],10);var e=new Date(b.widgetCreationEpochMilliseconds);b=e.getUTCFullYear()-18;var f=e.getUTCMonth(),e=e.getUTCDate();
return a||d||c?b>c||b===c&&f>a||b===c&&f===a&&e>=d:!0},ValidPhoneNumberConstraint:function(a,b,c,d){return k(a)?(a=b[c.defaultParameterName],d=new RegExp(d.pattern),!!a&&d.test(f.trim(a.replace(/[\s\(\)\-]/g,"")))):!0},ValidCreditCardPostalCodeConstraint:function(a,b,c,d){if(!u(b,c))return!0;a=b[c.defaultParameterName];d=new RegExp(d.pattern);return!!a&&d.test(a)},ValidVirtualPrivateAddressConstraint:function(a,b,c){return(a=b[c.defaultParameterName])&&a.match(/^([a-zA-Z0-9\.\-]+)([@]{1})([a-zA-Z0-9\-\.]+){1,255}$/)},
RequiredNonEmptyConstraint:function(a,b,c){return u(b,c)?v.NonEmptyFieldConstraint(a,b,c):!0},RequiredValidDateConstraint:function(a,b,c,d){if(!u(b,c))return!0;a=b[c.defaultParameterName];b=d.separator;if((new RegExp(d.pattern)).test(a))if(b=a.split(b),d=parseInt(b[0],10),a=parseInt(b[1],10),b=parseInt(b[2],10),1E3>b||3E3<b||0===a||12<a)d=!1;else{c=[31,28,31,30,31,30,31,31,30,31,30,31];if(0===b%400||0!==b%100&&0===b%4)c[1]=29;d=0<d&&d<=c[a-1]}else d=!1;return d},ContainsOnlyDigitsConstraint:function(a,
b,c){return l(b[c.defaultParameterName])},ValidCreditCardCurrencyCodeConstraint:function(b,c,d,e){return u(c,d)?a(new RegExp(e.pattern),[c[d.defaultParameterName],c[d.radioButtonName],c[d.dropdownName]]):!0}};return v});y("widget-factory",["widget","lang","config","clog","testAjaxCapability"],function(f,c,b,a,d){function e(a,b,c,e,r){a=new f(a,b,c,e,r,function(a){g(a);"true"===a.options.testAjaxAuthenticationRequired&&d.makeCall(a)});n(a);return l[b.widgetInstanceId]=a}function n(b){a.logLatencyMetric({feature:"Widget",
resource:"_Latency"});b.log({WidgetCreationTime:a.getCurrentTime()-a.getWidgetStartTime()})}function g(a){var d=a.publicProxy();b.getAttribute("onWidgetCreated")&&c.forEach(b.getAttribute("onWidgetCreated"),function(a){a(d)})}var l={};return{_widgets:l,create:function(a,b,c,d,f){var g=l[b.widgetInstanceId];g&&g.continueRequestAjaxSubstitutionEnabled?g.setup(b,c,d,f):g=e(a,b,c,d,f);return g}}});y("widget","base lang when jQuery attributes server form-helper events/form-submitted-event clog public-event-registry events/spinner-events continuable AUI!P global-event-bus events security events/js-continue-failure-event clientSideEventLogger redirection-helper".split(" "),
function(f,c,b,a,d,e,n,g,l,k,m,u,x,y,z,w,v,h,p){var C=["sif_profile"];d=f.extend(u,{initialize:function(a,b,c,d,e,f){this.type=a;if(!b.widgetInstanceId)throw Error("widgetInstanceId is required.");this.widgetInstanceId=b.widgetInstanceId;this.widgetAjaxUrlPrefixPath=b.widgetAjaxUrlPrefix?b.widgetAjaxUrlPrefix:"";this.widgetRequestPrefixPath=b.widgetRequestPrefix?b.widgetRequestPrefix+"/":"";this.widgetFormData=null;this.setup(b,c,d,e,f,!0)},setup:function(a,b,c,d,e,f){this.off(null,this);this.offAui();
y.off("AuthTimeout");z.off("AuthTimeout");this.continueRequestAjaxSubstitutionEnabled=a.continueRequestAjaxSubstitutionEnabled!==E?!!a.continueRequestAjaxSubstitutionEnabled:!!this.continueRequestAjaxSubstitutionEnabled;this.components={};this.continueRequestQueue=new F;this.throttledContinueEvents={};this.widgetCreationEpochMilliseconds=d;this._localizationStringsMap=c;this.pageScrolled=!1;this.options=a;this.security=new w(this);this._registerWidgetPublicEvents();e&&e(this);this.serverToClientClockDifference=
this.widgetCreationEpochMilliseconds-Date.now();this.clientSideRequestTimeOffset=0;0<this.serverToClientClockDifference?this.clientSideRequestTimeOffset=this.serverToClientClockDifference:-12E4>this.serverToClientClockDifference&&(this.clientSideRequestTimeOffset=this.serverToClientClockDifference);0!==this.clientSideRequestTimeOffset&&f&&this.publishSuccessSushiMetrics({ActionType:"ClientSideRequestTimeOffsetEvent",ActionValueType:"ClientSideRequestTimeOffset",ActionValue:this.clientSideRequestTimeOffset});
this.on("AuthTimeout",this,function(a){r!==r.parent&&r.parent.PaymentsPortal2&&r.parent.PaymentsPortal2.modules&&(r.parent.PaymentsPortal2.modules.when(["global-event-bus"],function(b){b.trigger("AuthTimeout",a)}),r.parent.PaymentsPortal2.modules.when(["events"],function(b){b.trigger("AuthTimeout",a)}))});y.on("AuthTimeout",this,function(a){this.trigger("AuthTimeout",a)});this.on(v,this,function(){this.trigger("Done",{widgetDone:"true",WidgetResponseStatusCode:"500"})});this._initializeComponents(b)},
getLocalizedString:function(a,b){a=this._localizationStringsMap[a]||"";b&&(a=c.keywordFormat(a,b));return a},clientSideEventsHandler:function(a,b){"true"===this.options.clientLoggingWeblabEnabledValue&&h.storeEventsData({eventName:a,eventObject:b},{customerId:this.options.customerId,widgetInstanceId:this.options.widgetInstanceId,sessionId:this.options.sessionId},a)},publicProxy:function(){var a=this;return a._proxy?a._proxy:a._proxy={type:a.type,on:function(b,c){a.onPublicEvent(b,c)},update:function(b){a.trigger("UpdateWidget",
b)},complete:function(){l.logCounterMetric({feature:"InlineWidget",resource:"CompleteWidgetEvent"});l.publishMetrics();a.trigger("CompleteWidget")},isContinuable:function(){return a.getContinuable()}}},onPublicEvent:function(a,b){var c=this;c.on(a,c.publicProxy(),function(){k.has(a)||c.log({publicEventConsumedButNotRegistered:a});return b.apply(c.publicProxy(),arguments)})},submitFormAJAX:function(b,d){var e=this,f;b instanceof a?(f=n.serializeObject(b),d=d||{},d.queryParameters=this._whitelistedQueryParameters(b.get(0).action)):
f=b;f["ppw-widgetState"]&&0!==f["ppw-widgetState"].trim().length?(e.trigger("submitFormAjaxStarted"),e.continueRequest(f,c.extend({},d,{success:e.createAjaxContinueSuccessHandler(d?d.success:null),complete:function(){e._fixDropdown();e.trigger("submitFormAjaxCompleted")}}))):(this.trigger(m.hideSpinner),this.fatal({type:"error",reason:"Widget state is missing in form data",feature:"MissingWidgetState"}))},_whitelistedQueryParameters:function(a){var b={};if(!a||-1===a.indexOf("?"))return b;a=a.substring(a.indexOf("?")+
1);c.forEach(a.split("\x26"),function(a){a=a.split("\x3d");0<=c.indexOf(C,a[0])&&(b[a[0]]=a[1])});return b},createAjaxContinueSuccessHandler:function(a){var b=this;return function(d){b._onAJAXContinueSuccess(d);a&&c.isFunction(a)&&a.apply(b,arguments)}},continueRequest:function(a,b){b=b?c.extend({},b):{};b.data=c.extend({},b.data?b.data:{},{"ppw-jsEnabled":!0},a);this.continueRequestQueue.enQueue(new t(this.options.customerId,b,this));this._processContinueRequestQueue()},asyncContinueRequest:function(a,
b){b=b?c.extend({},b):{};b.data=c.extend({},b.data?b.data:{},{"ppw-jsEnabled":!0},a);b.resumeContinueQueueOnSuccess=!1;b.resumeContinueQueueOnError=!1;b.resumeContinueQueueOnFatal=!1;a=new t(this.options.customerId,b,this);return e.ajax(a.options)},fatal:function(a){a=a||{type:"error"};var b="auth"===a.type?"AuthTimeout":"Fatal",c=a.feature||"AjaxContinue";"Fatal"===b&&(this.log({ajaxFatal:a}),l.logCounterMetric({feature:c,resource:"_ErrorCount"}),l.publishMetrics());this.trigger(b,a)},_recordSuccess:function(a){a=
a||{type:"error"};l.logCounterMetric({feature:a.feature||"AjaxContinue",resource:"_ErrorCount",amount:0});l.publishMetrics()},widgetAction:function(a){this.trigger("WidgetAction",a)},width:function(){var b=this.getRootDOMElements(),d=0,e;c.forEach(b,function(b){e=a(b);(b=e.outerWidth())&&b>d&&(d=b)});return d},height:function(){var b=this.getRootDOMElements(),d=0,e;c.forEach(b,function(b){e=a(b);(b=e.outerHeight())&&(d+=b)});return d},scrollToElementOnInitialize:function(b){this.pageScrolled||(this.scrollToElement(a("#"+
b)),this.pageScrolled=!0)},scrollToElement:function(b){b&&0<b.length&&a("html, body").animate({scrollTop:b.offset().top},"fast")},scrollToElementWithCompensation:function(b){b&&0<b.length&&a("html, body").animate({scrollTop:b.offset().top-65},"fast")},focusToElement:function(b){a("#"+b).focus()},scrollToTopOfThePage:function(){this.pageScrolled||(this.forceToScrollToTopOfThePage(),this.pageScrolled=!0)},forceToScrollToTopOfThePage:function(){a("html, body").scrollTop(0)},_initializeComponents:function(a){var d=
this,e=c.map(a,function(a){return"components/"+a.type});c.forEach(e,function(c,e){var f=a[e];b([c],function(a){d.components[f.id]=new a(d,f)})});b(e,function(){var a=e.length-c.keys(d.components).length;0<a&&(l.logCounterMetric({feature:"ComponentModulesNotLoaded",resource:"_Count",amount:a}),l.publishMetrics());d._onComponentsInitialized()},!0)},_registerWidgetPublicEvents:function(){k.register("AuthTimeout","Done","Fatal",g,m.showSpinner,m.hideSpinner,"WidgetAction")},_onComponentsInitialized:function(){var b=
this;a("document").ready(function(){c.forEachKeyValue(b.components,function(a,b){b.initializeOnReady()});b._setupFormHandling();b.trigger("componentsInitialized")})},_setupFormHandling:function(){var a=this.getRootDOMElements();n.onSubmit(a.find("form").andSelf().filter("form"),c.bind(this._onFormSubmission,this))},_onFormSubmission:function(a,b,c){this.ajaxSubstitutionEnabled(a)?this._onAJAXFormSubmission(a,b,c):this._onStandardFormSubmission(a,b,c)},_onStandardFormSubmission:function(a,b,c){},_onAJAXFormSubmission:function(a,
b,c){this.isFormContinueEventThrottled(c,a)&&b.preventDefault();if(!b.isDefaultPrevented()){b.preventDefault();b={};if(c){var d=c.get(0).name;""!==d&&(b[d]=c.val())}this.submitFormAJAX(a,{data:b})}},ajaxSubstitutionEnabled:function(a){a=a.get(0).getAttribute("data-pmts-ajax-continuation");return this.continueRequestAjaxSubstitutionEnabled&&(null==a||"true"===a)},setAjaxSubstitutionEnabled:function(a,b){a.attr("data-pmts-ajax-continuation",b)},_onAJAXContinueSuccess:function(a){this._recordSuccess();
a.htmlContent&&this._swapHtmlAndEval(a.htmlContent)},_resumeContinueRequestQueue:function(){this.processingContinueRequest=!1;this._processContinueRequestQueue()},_processContinueRequestQueue:function(){!this.processingContinueRequest&&0<this.continueRequestQueue.length()&&this._processContinueRequest(this.continueRequestQueue.deQueue())},_processContinueRequest:function(a){this.processingContinueRequest=!0;l.publishMetrics();return e.ajax(a.options)},_handleContinueSuccess:function(a){a&&a.htmlChunks&&
a.componentDataList||this.fatal();this._recordSuccess();this._updateWidgetHtml(a.htmlChunks);this._attachNewComponents(a.componentDataList);this._resumeContinueRequestQueue()},_handleContinueError:function(a){400===a.status&&a.getResponseHeader("X-Amzn-Errortype").includes("ThrottlingException")?(this.updateThrottledContinueEvents(a.responseText),this.applyThrottledCustomerExperienceIfApplicable()):this.fatal()},_attachNewComponents:function(b){var d=[];c.forEach(b,function(b){d.push(a.parseJSON(b))});
this._initializeComponents(d)},_updateWidgetHtml:function(a){var b=this;c.forEachKeyValue(a,function(a,c){b._updateComponentDOM(a,c)})},_updateComponentDOM:function(a,b){var c=this.components[a];c&&(c=c.getRootDOMElements(),this._deleteComponentsInDOM(c),this._deleteComponent(a),c.first().before(b).end().remove())},_deleteComponentsInDOM:function(b){var c=this;b.find("[data-pmts-component-id]").each(function(b,d){b=a(d).attr("data-pmts-component-id");c._deleteComponent(b)})},_removeWidgetComponents:function(){var a=
this;a.trigger("widget:clean");c.forEachKeyValue(a.components,function(b,c){c&&(c.detach(),delete a.components[b],c.getRootDOMElements().remove())})},_removeDropdownPopovers:function(){x.when("a-popover-base").execute(function(b){a(".pmts-portal-component .a-dropdown-container").each(function(){b.remove(a(this).find("select").attr("name"))})})},_deleteComponent:function(a){var b=this.components[a];b&&(b.detach(),delete this.components[a])},getRootDOMElements:function(){return a(".pmts-portal-root-"+
this.widgetInstanceId)},_getWidgetDOMAppender:function(){var a=this.getRootDOMElements();if(0===a.length)throw Error("Could not find the root dom elements of the widget in order to append new content.");var a=a.get(a.length-1),b=a.nextSibling,d=a.parentNode,e=null,e=b?function(a){d.insertBefore(a,b)}:function(a){d.appendChild(a)};return function(a){c.forEach(a,e)}},_fixDropdown:function(){var a=this.getRootDOMElements(),b=a.find("select.a-native-dropdown").not("[data-action\x3da-dropdown-select]");
b.length&&(a.find(".a-button-dropdown").attr("aria-hidden",!0).find(".a-button-text").removeAttr("tabindex"),b.attr({tabindex:0,"data-action":"a-dropdown-select"}).addClass("a-declarative"))},_swapHtmlAndEval:function(b){var d=[],e=[];a(b).each(function(b,c){1===c.nodeType?a(c).is("style")||(a(c).is("script:not([src])")?e.push(c):d.push(c)):d.push(c)});a(".apx-secondary-view-root-"+this.widgetInstanceId).remove();b=this._getWidgetDOMAppender(this);this._removeWidgetComponents();this._removeDropdownPopovers();
this.getRootDOMElements().remove();0<d.length&&(b(d),c.forEach(e,function(b){a.globalEval(a(b).html())}))},log:function(a){"false"===this.options.clientLoggingWeblabEnabledValue&&(a=c.extend({customerId:this.options.customerId,widgetInstanceId:this.options.widgetInstanceId,sessionId:this.options.sessionId,clientId:this.options.clientId},a),l.log(a))},_generateWidgetRequestHeaders:function(){return{"APX-Widget-Info":[this.options.clientId,this.options.deviceType,this.options.widgetInstanceId].join("/")}},
_publishSushiMetrics:function(a){var b={ActionResult:a.ActionResult,PageLocale:this.options.locale,CustomerId:this.options.customerId,WidgetInstanceId:this.options.widgetInstanceId,WidgetDeviceType:this.options.deviceType,WidgetName:this.type,MarketplaceId:this.options.marketplaceId,Session:this.options.sessionId,PortalClientId:this.options.clientId,StartTime:Date.now()+this.clientSideRequestTimeOffset};b.RequestId=this.options.requestId?this.options.requestId:this.options.widgetInstanceId;var c=
{ActionType:null,ActionValueType:"Unspecified",ActionValue:null,ActionParentValueType:"Unspecified",ActionParentValue:null,ActionErrorCode:null},d;for(d in c)a[d]?b[d]=a[d]:c[d]&&(b[d]=c[d]);l.publishSushiEelMetrics(b)},publishFailureSushiMetrics:function(a){a.ActionResult="Failure";this._publishSushiMetrics(a)},publishSuccessSushiMetrics:function(a){a.ActionResult="Success";this._publishSushiMetrics(a)},updateThrottledContinueEvents:function(a){c.isString(a)&&(a=a.match(/WidgetContinueEvent:(.*?),/))&&
(this.throttledContinueEvents[a[1]]=!0)},isFormContinueEventThrottled:function(a,b){var d;a&&a.get(0)&&c.isString(a.get(0).name)?(a=a.get(0).name.match(/ppw-widgetEvent:([a-zA-Z]+):?/))&&(d=a[1]):b&&(a=b.find("input[name\x3dppw-widgetEvent]"))&&1===a.length&&(d=a.get(0).value);return this.throttledContinueEvents[d]},applyThrottledCustomerExperienceIfApplicable:function(){var b=a(".apx-throttle-alert");b&&(l.logCounterMetric({feature:"CustomerRateLimitingThrottleAlert",resource:"_Count"}),l.publishMetrics(),
b.removeClass("a-hidden aok-hidden"),this.disableContinueAddButton())},disableContinueAddButton:function(){var b=a(".pmts-button-input.a-button-primary");b&&(this.buttonAlreadyDisabledOnThrottledRequest&&(l.logCounterMetric({feature:"CustomerRateLimitingButtonDisabled",resource:"_Count"}),l.publishMetrics()),b.addClass("a-button-disabled"),b.prop("disabled",!0),this.buttonAlreadyDisabledOnThrottledRequest=!0)}});var t=f.extend({initialize:function(a,b,d){a=c.keywordFormat("{widgetAjaxUrlPrefixPath}/payments-portal/data/{widgetRequestPrefixPath}widgets2/v1/customer/{customerId}/continueWidget",
{customerId:a,widgetAjaxUrlPrefixPath:d.widgetAjaxUrlPrefixPath,widgetRequestPrefixPath:d.widgetRequestPrefixPath});if(b.queryParameters){var e=[];c.forEachKeyValue(b.queryParameters,function(a,b){e.push(encodeURIComponent(a)+"\x3d"+encodeURIComponent(b))});0<e.length&&(a=a+"?"+e.join("\x26"))}this.options=c.extend({},{type:"POST",url:a,success:c.bind(d._handleContinueSuccess,d),error:c.bind(d._handleContinueError,d),fatal:c.bind(d.fatal,d)},b);this.options.headers=c.extend({},this.options.headers,
d._generateWidgetRequestHeaders());c.intercept(this.options,"complete",function(a,c){var e=["timeout","parsererror"],e=0==a.status||500<=a.status||e.includes(c);l.logCounterMetric({feature:"AjaxContinue",resource:"_AvailabilityCount",amount:e?0:1});d.log({ajaxContinueStatus:a.status,ajaxContinueTextStatus:c,ajaxContinueRequestId:a.getResponseHeader("x-amz-rid"),ajaxContinueEvent:b.data?b.data["ppw-widgetEvent"]:"",isAjaxServiceUnavailable:e});b.data&&b.data["ppw-widgetEvent"]&&l.logCounterMetric({feature:b.data["ppw-widgetEvent"],
resource:"_AvailabilityCount",amount:e?0:1})},this);a=function(a,b,c){return b||c&&"undefined"===typeof b?function(b,c){try{a(b,c)}finally{d._resumeContinueRequestQueue()}}:a};this.options.success=a(function(a){return function(b,e){if(b&&b.additionalWidgetResponseData){var f=b.additionalWidgetResponseData.additionalData;if(f){if("true"===f.widgetDone){var g={};c.forEachKeyValue(f,function(a,b){try{var c=JSON.parse(b);g[a]="boolean"===typeof c?b:c}catch(d){g[a]=b}});if("true"===f.needsRedirect&&f.redirectUrl)return p.handleRedirection(f.redirectUrl,
f.httpMethod,f.httpParameters,d),d._recordSuccess(),PaymentsPortal2.events.STOP_EVENT_PROCESSING;"SetPaymentPlanSelect"===d.type?(d.log({additionalData:f,preWidgetDone:!0}),d.trigger("Done",f)):(d.log({jsonParsedAdditionalData:g,preWidgetDone:!0}),d.trigger("Done",g));d.log({widgetTriggerDone:!0})}f.widgetAction&&d.widgetAction(f)}}a(b,e)}}(this.options.success),this.options.resumeContinueQueueOnSuccess,!0);this.options.error=a(this.options.error,this.options.resumeContinueQueueOnError,!0);this.options.fatal=
a(this.options.fatal,this.options.resumeContinueQueueOnFatal,!0)}}),F=f.extend({initialize:function(){this.items=[]},enQueue:function(a){this.items.push(a)},deQueue:function(){return this.items.shift()},length:function(){return this.items.length}});return d});y("workflow-component",["component","lang","public-event-registry","events/workflow-state-event"],function(f,c,b,a){return f.extend({_workflowState:E,initialize:function(c,e){this._workflowState=e.data.workflowState;b.register(a)},bindToEvents:function(){var b=
this;b.widget.on("componentsInitialized",b,function(c){b.widget.trigger(a,b._workflowState)})}})})})()});
/* ******** */
(function(h){var r=window.AmazonUIPageJS||window.P,u=r._namespace||r.attributeErrors,k=u?u("APXWidgetsAssets@APXWidgets-TapAndPay","APXWidgetsAssets"):r;k.guardFatal?k.guardFatal(h)(k,window):k.execute(function(){h(k,window)})})(function(h,r,u){(function(){var k=PaymentsPortal2.modules.define;k("components/TapToAddCardComponent",["css-utils","jQuery","component","lang","clog"],function(e,k,G,g,p){var q=null,l=null,m=null,c=null,n=null,d=null,f=null,D=null,z=null,r=["PRESENT_CARD","PRESENT_CARD_AGAIN",
"CARD_READ_OK_PLEASE_REMOVE"],u={PRESENT_CARD:"PC",PRESENT_CARD_AGAIN:"PCA",CARD_READ_OK_PLEASE_REMOVE:"CR_OK_RM"},E="Success Pending Cancelled Failed Errored SessionActivated ERROR".split(" "),A={Success:"SCS",Pending:"PND",Cancelled:"CNCL",Failed:"FAIL",Errored:"ERRD",SessionActivated:"SSN_ACT",ERROR:"ERR"},H=["NFC_DISABLE","DEBUGGING_ENABLED","DEV_SETTING_ENABLED"],I={prepareTerminal:"PT",activateTerminalSession:"AT",readCard:"RC",activateAndReadCard:"ARC",deactivateTerminalSession:"DT"},B="PRIMARY_SCREEN",
t=!1,v=!1,F=0,C=0,w=!1,x={INVALID_ACTION_REQUESTED:"apx_tta_terminal_initialization_error",SDK_INITIALIZATION_ERROR:"apx_tta_terminal_initialization_error",NFC_DISABLED:"apx_tta_enable_nfc_in_settings",NFC_NOT_PRESENT:"apx_tta_nfc_not_detected_error",INTERNAL_ERROR:"apx_tta_terminal_initialization_error",TERMINAL_NOT_FOUND:"apx_tta_terminal_not_found_error",ATTESTATION_FAILURE:"apx_tta_device_not_supported_error",LICENSE_VALIDATION_FAILURE:"apx_tta_license_validation_failure",TERMINAL_CREATION_FAILED:"apx_tta_terminal_initialization_error",
TERMINAL_SESSION_ACTIVATION_FAILED:"apx_tta_terminal_initialization_error",TERMINAL_SESSION_NOT_FOUND:"apx_tta_terminal_session_not_found",CARD_REJECTED:"apx_tta_card_brand_not_supported_error",TIMEOUT:"apx_tta_timeout_error",INVALID_CARD_DATA:"apx_tta_error_reading_card",MASH_ATTESTATION_FAILURE:"apx_tta_device_not_supported_error",KILL_SWITCH_ENABLED:"apx_tta_kill_switch_enabled_without_update_available",KILL_SWITCH_ENABLED_WITH_UPDATE:"apx_tta_kill_switch_enabled_with_update_available",MSHOP_APP_DEBUGGABLE:"apx_tta_terminal_initialization_error",
INVALID_ANDROID_SDK_VERSION:"apx_tta_terminal_initialization_error",DEBUGGER_ATTACHED:"apx_tta_developer_settings_error",INVALID_INSTALLATION_SOURCE:"apx_tta_terminal_initialization_error",JSON_EXCEPTION:"apx_tta_terminal_initialization_error",INVALID_INPUT_NULL_OR_EMPTY_STRINGS:"apx_tta_terminal_initialization_error",ERROR_FETCHING_LICENSE:"apx_tta_license_validation_failure",ERROR_FETCHING_EMV_CONFIG:"apx_tta_license_validation_failure",NO_CARD_APPLICATION:"apx_tta_no_card_application_error",CARD_ERROR:"apx_tta_no_card_application_error",
PROCESSING_ERROR:"apx_tta_no_card_application_error",SDK_SERVICE_ERROR:"apx_tta_terminal_initialization_error",NULL_REQUEST_DATA:"apx_tta_terminal_initialization_error",INVALID_REQUEST_DATA:"apx_tta_terminal_initialization_error",NULL_RESPONSE_DATA:"apx_tta_terminal_initialization_error",REMOTE_EXCEPTION:"apx_tta_terminal_initialization_error",SDK_SERVICE_EXCEPTION:"apx_tta_terminal_initialization_error",NULL_RESPONSE_DATA_PLUGIN:"apx_tta_terminal_initialization_error",PROCESS_ISOLATION_EXCEPTION:"apx_tta_terminal_initialization_error",
BINDING_ERROR:"apx_tta_terminal_initialization_error",DEFAULT:"apx_tta_terminal_initialization_error"},J=["valued customer","visa cardholder"],y="id"+Math.random().toString(16).slice(2);return G.extend({_getLocalizedViolationMessage:function(a,b){var d=this,c=null;try{var f=JSON.parse(a);f&&f.violations?(a=null,f.violations.forEach(function(a){H.includes(a)&&d._publishCounterMetricsForTapToAdd(b+"_Violation."+a)}),f.violations.includes("NFC_DISABLE")?(a=x.NFC_DISABLED,t=!0):f.violations.includes("DEBUGGING_ENABLED")?
a=x.DEBUGGER_ATTACHED:f.violations.includes("DEV_SETTING_ENABLED")&&(a=x.DEVELOPER_SETTING_ENABLED),a&&(c=d.widget.getLocalizedString(a))):f?d._publishCounterMetricsForTapToAdd(b+"_Violation.Null"):d._publishCounterMetricsForTapToAdd(b+"_NullResponse")}catch(e){d._publishCounterMetricsForTapToAdd(b+"_Violation.InvalidResponse")}c||(c="NULL_FIELD");return c},_getLocalizedErrorMessage:function(a,b){var d=null;try{var c=JSON.parse(a);if(c&&c.error_code){var f=x[c.error_code];f?(d=this.widget.getLocalizedString(f),
this._publishCounterMetricsForTapToAdd(I[b]+"_Error."+c.error_code),this._publishCounterMetricsForTapToAdd(b+"_Error."+c.error_code)):this._publishCounterMetricsForTapToAdd(b+"_Error.Unknown")}else c?this._publishCounterMetricsForTapToAdd(b+"_Error.NullErrorCode"):this._publishCounterMetricsForTapToAdd(b+"_Error.NullResponse")}catch(e){this._publishCounterMetricsForTapToAdd(b+"_Error.InvalidResponse")}d||(d=this.widget.getLocalizedString(x.DEFAULT));return d},_publishCounterMetricsForTapToAdd:function(a){var b=
"TapToAdd_";this.data.processIsolation&&(b+="PI_");p.logCounterMetric({feature:b+a,resource:"_Count"});p.publishMetrics()},_publishLatencyMetricsForTapToAdd:function(a,b){var d="TapToAdd_";this.data.processIsolation&&(d+="PI_");b&&(p.logLatencyMetric({feature:d+a,resource:"_Latency",startTime:b}),p.publishMetrics())},_publishMetricsForReadCard:function(a,b,d){a&&b?E.includes(a)&&r.includes(b)?this._publishCounterMetricsForTapToAdd(d+"_Status."+A[a]+"_CA."+u[b]):E.includes(a)?this._publishCounterMetricsForTapToAdd(d+
"_Status."+A[a]+"_CA.Unknown"):r.includes(b)?this._publishCounterMetricsForTapToAdd(d+"_Status.Unknown_CA."+u[b]):this._publishCounterMetricsForTapToAdd(d+"_Status.Unknown_CA.Unknown"):a&&!b&&("Pending"===a?this._publishCounterMetricsForTapToAdd(d+"_Status."+A[a]+"_CA.Null"):E.includes(a)?this._publishCounterMetricsForTapToAdd(d+"_Status."+A[a]):this._publishCounterMetricsForTapToAdd(d+"_Status.Unknown"))},_triggerTapFailureEvent:function(a,b){a={failedAction:b,failureAlertMessage:a};this._publishCounterMetricsForTapToAdd("FailureEventTriggered");
this.widget.trigger("tapToAddCardFailureEvent",a)},_closeSecondaryView:function(){var a=this;h.when("a-secondary-view").execute(function(b){b&&(b=b.get("tap-to-add-popover"))&&(e.showElement(a.getDOMElement("tap-to-add-spinner")),e.hideElement(a.getDOMElement("tap-to-add-gif")),b.hide())})},_handleCorruptResponseInReadCardSuccessCallback:function(a){this._publishCounterMetricsForTapToAdd(a);a=this.widget.getLocalizedString(x.DEFAULT);this._triggerTapFailureEvent(a,"readCard");this._closeSecondaryView()},
_handleCardInfoNullFields:function(a,b,d,c){var f=0,e=0,g=0,n=0;a||(f=1);d||(e=1);b||(g=1);"NULL_FIELD"===c&&(n=1);this._publishCounterMetricsForTapToAdd("ReadCardResponse_NullFields_Number."+f+"_Month."+e+"_Year."+g);this._publishCounterMetricsForTapToAdd("ReadCardResponse_NullFields_CardHolderName."+n)},_handleReadCardSuccess:function(a){this._publishCounterMetricsForTapToAdd("readCard_Success");try{var b=JSON.parse(a);if(!b){this._handleCorruptResponseInReadCardSuccessCallback("ReadCard_ParsedResponseNull");
return}b.status||this._handleCorruptResponseInReadCardSuccessCallback("ReadCard_ResponseStatusNull");this._publishMetricsForReadCard(b.status,b.customer_action,"readCard");"Pending"===b.status&&"PRESENT_CARD"===b.customer_action?(e.hideElement(this.getDOMElement("tap-to-add-spinner")),e.showElement(this.getDOMElement("tap-to-add-gif")),w=!1,v?(this._publishCounterMetricsForTapToAdd("NFC_enabledAfterError"),t=v=!1):t?(this._publishCounterMetricsForTapToAdd("NFC_enabledAfterViolation"),t=!1):this._publishCounterMetricsForTapToAdd("NFC_enabled")):
"Pending"===b.status&&"PRESENT_CARD_AGAIN"===b.customer_action?w=!0:"Pending"===b.status&&"CARD_READ_OK_PLEASE_REMOVE"===b.customer_action?(l=(new Date).getTime(),e.hideElement(this.getDOMElement("tap-to-add-gif")),e.showElement(this.getDOMElement("tap-to-add-spinner"))):"Cancelled"===b.status?(this._publishCounterMetricsForTapToAdd("BackButtonClicked"),this._publishLatencyMetricsForTapToAdd("BackButtonClicked_Latency",q),5E3>(new Date).getTime()-q&&this._publishCounterMetricsForTapToAdd("AccidentalClick"),
q=null):"Success"===b.status&&(this._handleReadCardSuccessStatus(b),l=q=null,this._closeSecondaryView())}catch(c){this._handleCorruptResponseInReadCardSuccessCallback("ReadCard_ResponseParsingFailure")}this._publishLatencyMetricsForTapToAdd("ReadCardSuccess_Latency",d);d=null},_handleReadCardFailure:function(a){this._publishCounterMetricsForTapToAdd("readCard_Failure");var b=this._getLocalizedErrorMessage(a,"readCard");this._triggerTapFailureEvent(b,"readCard");(a=JSON.parse(a))&&a.error_code&&"TIMEOUT"===
a.error_code&&(C+=1,w&&this._publishCounterMetricsForTapToAdd("RC_timeout_cardTapAttempted"));this._closeSecondaryView();this._publishLatencyMetricsForTapToAdd("ReadCardFailure_Latency",d);d=null},_handleActivationSuccess:function(a){var b=this;b._publishCounterMetricsForTapToAdd("activateTerminalSession_Success");h.when("TapAndPay").execute(function(a){"SECONDARY_SCREEN"===B?(d=(new Date).getTime(),a.readCard({request_id:y,processIsolation:b.data.processIsolation.toString(),successCallback:g.bind(b._handleReadCardSuccess,
b),failCallback:g.bind(b._handleReadCardFailure,b)})):b._invokeDeactivateTerminalSession()});b._publishLatencyMetricsForTapToAdd("ActivateTerminalSuccess_Latency",n);n=null},_handleActivationFailure:function(a){var b=this._getLocalizedErrorMessage(a,"activateTerminalSession");this._triggerTapFailureEvent(b,"activateTerminalSession");this._closeSecondaryView();(a=JSON.parse(a))&&a.error_code&&"NFC_DISABLED"===a.error_code&&(v=!0);this._publishCounterMetricsForTapToAdd("activateTerminalSession_Failure");
this._publishLatencyMetricsForTapToAdd("ActivateTerminalFailure_Latency",n);n=null},_handlePrepareTerminalSuccessOnButtonClick:function(a){var b=this;b._publishCounterMetricsForTapToAdd("prepareTerminalSuccessOnButtonClick");b._publishLatencyMetricsForTapToAdd("prepareTerminalSuccessOnButtonClick_Latency",c);c=null;h.when("TapAndPay").execute(function(a){n=(new Date).getTime();a.activateTerminalSession({request_id:y,offline_activation:"true",processIsolation:b.data.processIsolation.toString(),successCallback:g.bind(b._handleActivationSuccess,
b),failCallback:g.bind(b._handleActivationFailure,b)})})},_handlePrepareTerminalFailureOnButtonClick:function(a){a=this._getLocalizedErrorMessage(a,"prepareTerminal");this._triggerTapFailureEvent(a,"prepareTerminal");this._closeSecondaryView();this._publishCounterMetricsForTapToAdd("prepareTerminalFailureOnButtonClick");this._publishLatencyMetricsForTapToAdd("prepareTerminalFailureOnButtonClick_Latency",c);c=null},_handleReadCardSuccessStatus:function(a){if(a.card_data){var b=null,d=null,c=null;a.card_data.card_number&&
(b=BigInt(a.card_data.card_number));a.card_data.expiration_month&&(d=parseInt(a.card_data.expiration_month,10));a.card_data.expiration_year&&(c=parseInt(a.card_data.expiration_year,10));var f="NULL_FIELD";a.card_data.account_holder_name?f=J.includes(a.card_data.account_holder_name.toString().toLowerCase())?"NULL_FIELD":a.card_data.account_holder_name.toString():this._publishCounterMetricsForTapToAdd("ReadCardResponse_MissingField_CardHolderName");b||d||c?(this._handleCardInfoNullFields(b,c,d,f),a=
{creditCardNumber:b?b.toString():"NULL_FIELD",expirationMonth:d?d.toString():"1",expirationYear:c?c.toString():(new Date).getUTCFullYear().toString(),cardHolderName:f},a={successAlertMessage:this.widget.getLocalizedString("apx_tta_success_tap_to_add"),cardInfo:a,startTimeAtButtonClick:q,startTimeAfterCardTapped:l,processIsolation:this.data.processIsolation},this._publishCounterMetricsForTapToAdd("SuccessEventTriggered"),this.widget.trigger("addCreditCardTapInfo",a)):this._handleCorruptResponseInReadCardSuccessCallback("ReadCardResponse_NullFields_Number.1_Month.1_Year.1")}else this._handleCorruptResponseInReadCardSuccessCallback("ReadCard_ResponseCardDataNull")},
_handleActivateAndReadCardSuccess:function(a){this._closeSecondaryView();this._publishCounterMetricsForTapToAdd("activateAndReadCard_Success");try{var b=JSON.parse(a);if(!b){this._handleCorruptResponseInReadCardSuccessCallback("activateAndReadCard_ParsedResponseNull");return}b.status||this._handleCorruptResponseInReadCardSuccessCallback("activateAndReadCard_ResponseStatusNull");this._publishMetricsForReadCard(b.status,b.customer_action,"activateAndReadCard");"Pending"===b.status&&"PRESENT_CARD"===
b.customer_action?(w=!1,v?(this._publishCounterMetricsForTapToAdd("NFC_enabledAfterError"),t=v=!1):t?(this._publishCounterMetricsForTapToAdd("NFC_enabledAfterViolation"),t=!1):this._publishCounterMetricsForTapToAdd("NFC_enabled")):"Pending"===b.status&&"PRESENT_CARD_AGAIN"===b.customer_action?w=!0:"Pending"===b.status&&"CARD_READ_OK_PLEASE_REMOVE"===b.customer_action?l=(new Date).getTime():"Cancelled"===b.status?(this._publishCounterMetricsForTapToAdd("BackButtonClicked"),this._publishLatencyMetricsForTapToAdd("BackButtonClicked_Latency",
q),5E3>(new Date).getTime()-q&&this._publishCounterMetricsForTapToAdd("AccidentalClick"),q=null,this._invokeDeactivateTerminalSession()):"Success"===b.status&&(this._handleReadCardSuccessStatus(b),l=q=null)}catch(d){this._handleCorruptResponseInReadCardSuccessCallback("activateAndReadCard_ResponseParsingFailure")}this._publishLatencyMetricsForTapToAdd("activateAndReadCard_SuccessLatency",f);f=null},_handleActivateAndReadCardFailure:function(a){this._closeSecondaryView();this._invokeDeactivateTerminalSession();
var b=this._getLocalizedErrorMessage(a,"activateAndReadCard");this._triggerTapFailureEvent(b,"activateAndReadCard");(a=JSON.parse(a))&&a.error_code&&"NFC_DISABLED"===a.error_code&&(v=!0);a&&a.error_code&&"TIMEOUT"===a.error_code&&(C+=1,w&&this._publishCounterMetricsForTapToAdd("ARC_timeout_cardTapAttempted"));this._publishCounterMetricsForTapToAdd("activateAndReadCard_Failure");this._publishLatencyMetricsForTapToAdd("activateAndReadCard_FailureLatency",f);f=null},_handleTapToAddButtonClick:function(){q=
(new Date).getTime();var a=this;B="SECONDARY_SCREEN";e.hideElement(a.getDOMElement("tap-to-add-gif"));e.showElement(a.getDOMElement("tap-to-add-spinner"));a._hideTapToAddAlert("#tap-to-add-subtitle-alert-element");a._hideTapToAddAlert("#tap-to-add-alert-id");a.data.processIsolation?h.when("TapAndPay").execute(function(b){f=(new Date).getTime();b.activateAndReadCard({request_id:y,processIsolation:a.data.processIsolation.toString(),titleString:a.widget.getLocalizedString("apx_tta_button_tap_to_add"),
contentString:a.widget.getLocalizedString("apx_tta_tap_to_add_instruction"),successCallback:g.bind(a._handleActivateAndReadCardSuccess,a),failCallback:g.bind(a._handleActivateAndReadCardFailure,a)})}):h.when("TapAndPay").execute(function(b){c=(new Date).getTime();b.prepareTerminal({request_id:y,enable_attestation:"false",processIsolation:a.data.processIsolation.toString(),successCallback:g.bind(a._handlePrepareTerminalSuccessOnButtonClick,a),failCallback:g.bind(a._handlePrepareTerminalFailureOnButtonClick,
a)})});a._publishCounterMetricsForTapToAdd("ButtonClicked");F+=1;4>=F?a._publishCounterMetricsForTapToAdd("buttonClicksInSession."+F):a._publishCounterMetricsForTapToAdd("buttonClicksInSession.n");4>=C?a._publishCounterMetricsForTapToAdd("buttonClickedAfterTimeout_timeoutCount."+C):a._publishCounterMetricsForTapToAdd("buttonClickedAfterTimeout_timeoutCount.n")},_disableTapToAddButton:function(){this.getDOMElement("tap-to-add-button").addClass("apx-tap-to-add-disabled-button");this.getDOMElement("tap-to-add-button").addClass("a-button-disabled");
this.getDOMElement("tap-to-add-secondary-view-declarative").removeClass("a-declarative");this.getDOMElement("tap-to-add-button").attr("disabled","disabled")},_displayTapToAddSection:function(){e.showElement(this.getDOMElement("tap-to-add-section"));this._disableTapToAddButton();this._publishCounterMetricsForTapToAdd("SectionVisible")},_enableTapToAddButton:function(){this.getDOMElement("tap-to-add-button").removeClass("apx-tap-to-add-disabled-button");this.getDOMElement("tap-to-add-button").removeClass("a-button-disabled");
this.getDOMElement("tap-to-add-secondary-view-declarative").addClass("a-declarative");this.getDOMElement("tap-to-add-button").removeAttr("disabled");e.hideElement(this.getDOMElement("tap-to-add-disabled-subtitle"));this._publishLatencyMetricsForTapToAdd("ButtonEnabled_Latency",D);D=null},_handlePrepareTerminalSuccessOnPageLoad:function(a){var b=this;b._enableTapToAddButton();var d=JSON.parse(a);if(d&&d.violations&&0<d.violations.length){var c=b._getLocalizedViolationMessage(a,"prepareTerminal");"NULL_FIELD"!==
c?h.when("a-alert").execute(function(a){a("#tap-to-add-subtitle-alert-element").text(c).show();b._publishCounterMetricsForTapToAdd("ButtonEnabledWithViolation")}):(b._hideTapToAddAlert("#tap-to-add-subtitle-alert-element"),b._publishCounterMetricsForTapToAdd("Violation.Unknown"))}else b._hideTapToAddAlert("#tap-to-add-subtitle-alert-element");b._publishCounterMetricsForTapToAdd("ButtonEnabled");b._publishCounterMetricsForTapToAdd("PrepareTerminalSuccessOnPageLoad");b._publishLatencyMetricsForTapToAdd("PrepareTerminalSuccessOnPageLoad_Latency",
m);m=null},_hideTapToAddAlert:function(a){h.when("a-alert").execute(function(b){b(a).hide()})},_handlePrepareTerminalFailureOnPageLoad:function(a){var b=this._getLocalizedErrorMessage(a,"prepareTerminal");h.when("a-alert").execute(function(a){a("#tap-to-add-subtitle-alert-element").text(b).show()});this._publishCounterMetricsForTapToAdd("ButtonDisabled");this._publishCounterMetricsForTapToAdd("PrepareTerminalFailureOnPageLoad");this._publishLatencyMetricsForTapToAdd("PrepareTerminalFailureOnPageLoad_Latency",
m);m=null},_handleDeactivateTerminalSessionSuccess:function(a){self=this;this._publishCounterMetricsForTapToAdd("DeactivateTerminalSession_Success");this._publishLatencyMetricsForTapToAdd("DeactivateTerminalSessionSuccess_Latency",z);z=null},_handleDeactivateTerminalSessionFailure:function(a){self=this;this._publishCounterMetricsForTapToAdd("DeactivateTerminalSession_Failure");this._publishLatencyMetricsForTapToAdd("DeactivateTerminalSessionFailure_Latency",z);z=null},_invokeDeactivateTerminalSession:function(a){var b=
this;this._publishCounterMetricsForTapToAdd("DeactivateTerminalSession_Invoked");h.when("TapAndPay").execute(function(a){z=(new Date).getTime();a.deactivateTerminalSession({request_id:y,processIsolation:b.data.processIsolation.toString(),successCallback:g.bind(b._handleDeactivateTerminalSessionSuccess,b),failCallback:g.bind(b._handleDeactivateTerminalSessionFailure,b)})})},_shouldInvokeTapToAddJS:function(){return 0===this.getDOMElement("tap-to-add-section").length?!1:!0},bindToEvents:function(){var a=
this;a.widget.on("componentsInitialized",a,function(){D=(new Date).getTime();a._publishCounterMetricsForTapToAdd("AddCCPageLoad");a.data.isRequestFromAndroidOS?a._publishCounterMetricsForTapToAdd("OS.Android"):a.data.isRequestFromIOS&&a._publishCounterMetricsForTapToAdd("OS.IOS");a._shouldInvokeTapToAddJS()?h.when("TapAndPay").execute(function(b){B="PRIMARY_SCREEN";a._displayTapToAddSection();m=(new Date).getTime();b.prepareTerminal({request_id:y,enable_attestation:"false",processIsolation:a.data.processIsolation.toString(),
successCallback:g.bind(a._handlePrepareTerminalSuccessOnPageLoad,a),failCallback:g.bind(a._handlePrepareTerminalFailureOnPageLoad,a)})}):a._publishCounterMetricsForTapToAdd("SectionNotVisible")});h.when("A","a-modal").execute(function(b,d){b.on("a:popover:afterHide:tap-to-add-popover",function(b){B="PRIMARY_SCREEN";a._invokeDeactivateTerminalSession()})})},bindToElements:function(){this.getDOMElement("tap-to-add-button").click(g.bind(this._handleTapToAddButtonClick,this))}})});k("ErrorCodes",["css-utils",
"jQuery","lang","clog"],function(e,h,k,g){return{errorCodes:{CARD_NOT_SUPPORTED:"CARD_NOT_SUPPORTED",MOBILE_WALLETS_NOT_SUPPORTED:"MOBILE_WALLETS_NOT_SUPPORTED",CARD_TAP_FAILED_FIVE_TIMES:"CARD_TAP_FAILED_FIVE_TIMES",CARD_TAP_FAILED:"CARD_TAP_FAILED",SOFTPOS_INVOCATION_FAILS_RECOVERABLE:"SOFTPOS_INVOCATION_FAILS_RECOVERABLE",SOFTPOS_INVOCATION_FAILS_UNRECOVERABLE:"SOFTPOS_INVOCATION_FAILS_UNRECOVERABLE",TAP_FAILS_OR_TIMES_OUT:"TAP_FAILS_OR_TIMES_OUT"},errorCodeProperties:{CARD_NOT_SUPPORTED:{primaryString:"Your card can not be read.",
secondaryString:"Please try a different payment method.",retryButtonText:"Try another card",shouldShowRetryButton:!0,shouldShowCancelButton:!0},MOBILE_WALLETS_NOT_SUPPORTED:{primaryString:"Digital wallets not supported.",secondaryString:"Please try again using a physical card.",retryButtonText:"Try again",shouldShowRetryButton:!0,shouldShowCancelButton:!0},CARD_TAP_FAILED_FIVE_TIMES:{primaryString:"Your card can not be read.",secondaryString:"Please try a different payment method.",retryButtonText:"",
shouldShowRetryButton:!1,shouldShowCancelButton:!1},CARD_TAP_FAILED:{primaryString:"Card read failed.",secondaryString:"Please try again or use a different card.",retryButtonText:"Try again",shouldShowRetryButton:!0,shouldShowCancelButton:!0},SOFTPOS_INVOCATION_FAILS_RECOVERABLE:{primaryString:"Something went wrong.",secondaryString:"Tap to Pay can't be activated.",retryButtonText:"Try again",shouldShowRetryButton:!0,shouldShowCancelButton:!0},SOFTPOS_INVOCATION_FAILS_UNRECOVERABLE:{primaryString:"Something went wrong.",
secondaryString:"Please try re-starting Amazon app or use a different payment method.",retryButtonText:"",shouldShowRetryButton:!1,shouldShowCancelButton:!1},TAP_FAILS_OR_TIMES_OUT:{primaryString:"Something went wrong.",secondaryString:"No card was detected and Tap to Pay has timed out.",retryButtonText:"Try again",shouldShowRetryButton:!0,shouldShowCancelButton:!0}}}});k("components/TapToPayComponent","css-utils jQuery component form-component lang clog TapToPayErrorScreenJs ErrorCodes".split(" "),
function(e,k,r,g,p,q,l,m){var c=["valued customer","visa cardholder"],n="id"+Math.random().toString(16).slice(2);return g.extend(l,m,{_maybeCardHolderName:"",_obfuscatedCardNumber:"",_maybeBillingAddressId:"",_missingBillingAddressId:"",_currencyDisplayString:"",initialize:function(d,c){this._maybeCardHolderName=c.data.maybeCardHolderName;this._maybeBillingAddressId=c.data.maybeBillingAddressId;this._missingBillingAddressId=c.data.missingBillingAddressId;this._currencyDisplayString=c.data.currencyDisplayString},
bindToEvents:function(){var d=this;d.widget.on("componentsInitialized",d,function(){this._initiateTapToPayCardReadProcessing()});d.widget.on("formSubmission",this,function(c){this._disableContinueButton();this._hideToggleButtonAndSuccessImage();d.widget.trigger("submitFormAjaxStarted");d.widget.continueRequest({addCreditCardNumber:c.submissionParameters[0].value,"ppw-expirationDate_combinedMonthYear":c.submissionParameters[1].value,"ppw-accountHolderName":c.submissionParameters[2].value,"ppw-storageConsent":c.submissionParameters[4].value,
"ppw-widgetState":d.widget.options.serializedState,"ppw-widgetEvent":"AddTapAndPayCreditCardEvent"},{query:{sif_profile:"APX-Encrypt-All-EU"},success:function(d){console.log("AJAX success callback :- "+JSON.stringify(d))},error:function(c){console.log("AJAX error callback :- "+JSON.stringify(c));l._invokeErrorScreen.apply(d,[m.errorCodes.MOBILE_WALLETS_NOT_SUPPORTED])},complete:function(){}})})},bindToElements:function(){this.getDOMElement("tap-to-pay-submit-button").click(p.bind(this._handleFormSubmission,
this));l.bindToElements.apply(this)},_getObfuscatedCardNumber:function(d,c){d=d.slice(-4);return c.repeat(4)+d},_disableContinueButton:function(){this.getDOMElement("tap-to-pay-submit-button").addClass("apx-tap-to-add-disabled-button");this.getDOMElement("tap-to-pay-submit-button").addClass("a-button-disabled");this.getDOMElement("tap-to-pay-submit-button").removeClass("a-declarative");this.getDOMElement("tap-to-pay-submit-button").attr("disabled","disabled")},_hideToggleButtonAndSuccessImage:function(){e.hideElement(this.getDOMElement("tap-to-pay-success-form-toggle-switch"));
e.hideElement(this.getDOMElement("tap-to-pay-success-form-toggle-switch-label"));e.hideElement(this.getDOMElement("tap-to-pay-success-form-logo"))},_updateFormWithCardInformation:function(d){var f=null,g=null,n=null;d.card_data.card_number&&(f=BigInt(d.card_data.card_number));d.card_data.expiration_month&&(g=parseInt(d.card_data.expiration_month,10));d.card_data.expiration_year&&(n=parseInt(d.card_data.expiration_year,10));d=d.card_data.account_holder_name?d.card_data.account_holder_name.toString():
"NULL_FIELD";d="NULL_FIELD"===d||c.includes(d.toLowerCase())?this._maybeCardHolderName:d.toString();f=f?f.toString():"NULL_FIELD";g=g?g.toString():"1";n=n?n.toString():(new Date).getUTCFullYear().toString();this._obfuscatedCardNumber=this._getObfuscatedCardNumber(f,"").toString();this.getDOMElement("tap-to-pay-card-number").html(this._obfuscatedCardNumber);e.showElement(this.getDOMElement("tap-to-pay-success-form-toggle-switch"));e.showElement(this.getDOMElement("tap-to-pay-success-form-toggle-switch-label"));
e.showElement(this.getDOMElement("tap-to-pay-success-screen"));e.showElement(this.getDOMElement("tap-to-pay-success-form-logo"));this.getDOMElement("tap-to-pay-credit-card-number-hidden-input").val(f);this.getDOMElement("tap-to-pay-expiry-date-hidden-input").val(g+" / "+n%100);this.getDOMElement("tap-to-account-holder-name-hidden-input").val(d);this.getDOMElement("tap-to-pay-billing-address-hidden-input").val(this._maybeBillingAddressId)},_handleDeactivateTerminalSessionSuccess:function(d){},_handleDeactivateTerminalSessionFailure:function(d){self=
this;console.log("Failure during deactivating terminal"+d)},_invokeDeactivateTerminalSession:function(d){var c=this;h.when("TapAndPay").execute(function(d){d.deactivateTerminalSession({request_id:n,processIsolation:"true",successCallback:p.bind(c._handleDeactivateTerminalSessionSuccess,c),failCallback:p.bind(c._handleDeactivateTerminalSessionFailure,c)})})},_handleCorruptResponseInReadCardSuccessCallback:function(){console.log("Read card corrupt response")},_handleActivateAndReadCardSuccess:function(d){try{var c=
JSON.parse(d);c&&c.status?"Cancelled"===c.status?this._invokeDeactivateTerminalSession():"Success"===c.status&&this._updateFormWithCardInformation(c):this._handleCorruptResponseInReadCardSuccessCallback()}catch(e){this._handleCorruptResponseInReadCardSuccessCallback()}},_handleActivateAndReadCardFailure:function(c){},_initiateTapToPayCardReadProcessing:function(){var c=this;h.when("TapAndPay").execute(function(f){f.activateAndReadCard({request_id:n,processIsolation:"true",offline_Activation:"true",
registrationType:"TapToPay",amountString:"Estimate Cost "+c._currencyDisplayString,continueString:"Continue",titleString:"Tap to pay",presentCardMessageString:"Hold your contactless card to back of your phone",successCallback:p.bind(c._handleActivateAndReadCardSuccess,c),failCallback:p.bind(c._handleActivateAndReadCardFailure,c)})})},_getStorageConsentValue:function(){return this.getDOMElement("tap-to-pay-success-form-toggle-switch").find("input").prop("checked")?"OptedIn":"OptedOut"},_handleFormSubmission:function(c){this.getDOMElement("tap-to-pay-success-form-storage-consent-field").val(this._getStorageConsentValue());
var f=this.form.validateForm(),e=this.getFormSubmissionParameters("tap-to-pay-form-container-js");0===f.length?(console.log("No form validation errors found, trigger formSubmissionEvent"),this.widget.trigger("formSubmission",{event:c,submissionParameters:e,action:this._action})):(c.preventDefault(),l._invokeErrorScreen.apply(this,[m.errorCodes.CARD_NOT_SUPPORTED]))}})});k("TapToPayErrorScreenJs","css-utils jQuery lang clog component events/close-secure-container-event mash-helper ErrorCodes".split(" "),
function(e,h,k,g,p,q,l,m){return m,{bindToElements:function(){this.getDOMElement("tap-to-pay-error-screen-retry-button").click(k.bind(this._handleRetryButtonClick,this));this.getDOMElement("tap-to-pay-error-screen-cancel-button").click(k.bind(this._handleCancelButtonClick,this))},_handleRetryButtonClick:function(){console.log("TapToPay error screen, retry has been clicked")},_handleCancelButtonClick:function(){this.widget.trigger(q,{force:!0});l.backToBookmark("spps-widget")},_invokeErrorScreen:function(c){this._showErrorScreenMessages(m.errorCodeProperties[c].primaryString,
m.errorCodeProperties[c].secondaryString);this._showErrorScreenButtons(m.errorCodeProperties[c].shouldShowRetryButton,m.errorCodeProperties[c].retryButtonText,m.errorCodeProperties[c].shouldShowCancelButton);e.hideElement(this.getDOMElement("tap-to-pay-success-screen"));e.showElement(this.getDOMElement("tap-to-pay-error-screen-section"))},_showErrorScreenMessages:function(c,e){this.getDOMElement("tap-to-pay-error-screen-primary-string").html(c);this.getDOMElement("tap-to-pay-error-screen-secondary-string").html(e)},
_showErrorScreenButtons:function(c,g,d){c&&(this.getDOMElement("tap-to-pay-error-screen-retry-button-text").html(g),e.showElement(this.getDOMElement("tap-to-pay-error-screen-retry-button")));d&&e.showElement(this.getDOMElement("tap-to-pay-error-screen-cancel-button"))}}});k("components/TapToPayTriggerComponent","css-utils jQuery component lang clog events/postToSecureIframeEvent".split(" "),function(e,k,r,g,p,q){var l=null,m="id"+Math.random().toString(16).slice(2);return r.extend({_creatablePaymentMethods:[],
_registrationType:"TapToPay",_shouldRenderTriggerButtonAsEnabled:!0,initialize:function(c,e){this._creatablePaymentMethods=e.data.creatablePaymentMethods;this._registrationType=e.data.registrationType;this._shouldRenderTriggerButtonAsEnabled=e.data.shouldRenderTriggerButtonAsEnabled},_disableTapToPayTriggerButton:function(){this.getDOMElement("tap-to-pay-trigger-button").addClass("apx-tap-to-pay-disabled-button");this.getDOMElement("tap-to-pay-trigger-button").addClass("a-button-disabled");this.getDOMElement("tap-to-pay-trigger-button").attr("disabled",
"disabled")},_enableTapToPayTriggerButton:function(){this.getDOMElement("tap-to-pay-trigger-button").removeClass("apx-tap-to-pay-disabled-button");this.getDOMElement("tap-to-pay-trigger-button").removeClass("a-button-disabled");this.getDOMElement("tap-to-pay-trigger-button").removeAttr("disabled")},_isTapToPayTriggerButtonDisabled:function(){return this.getDOMElement("tap-to-pay-trigger-button").hasClass("apx-tap-to-pay-disabled-button")||this.getDOMElement("tap-to-pay-trigger-button").hasClass("a-button-disabled")},
_shouldInvokeTapToPayTriggerJS:function(){return 0<this.getDOMElement("tap-to-pay-trigger-button").length},_handlePrepareTerminalFailureOnPageLoad:function(c){this._disableTapToPayTriggerButton();console.log("TapToPay Trigger Button has been disabled");this._publishCountMetrics("ButtonDisabled");this._publishLatencyMetrics("PrepareTerminalFailureOnPageLoad",l);l=null},_handlePrepareTerminalSuccessOnPageLoad:function(c){this._enableTapToPayTriggerButton();(c=JSON.parse(c))&&c.violations&&0<c.violations.length?
(console.log("TapToPay Trigger Button enabled with violations"),this._publishCountMetrics("ButtonEnabledWithViolations")):(console.log("TapToPay Trigger Button enabled without violations"),this._publishCountMetrics("ButtonEnabledWithoutViolations"));this._publishLatencyMetrics("PrepareTerminalSuccessOnPageLoad",l);l=null},_publishCountMetrics:function(c){p.logCounterMetric({feature:"TapToPay_Trigger_"+c,resource:"_Count"});p.publishMetrics()},_publishLatencyMetrics:function(c,e){e&&(p.logLatencyMetric({feature:"TapToPay_Trigger_"+
c,resource:"_Latency",startTime:e}),p.publishMetrics())},_bindTapToPayTriggerButtonClick:function(c){c.preventDefault();this._isTapToPayTriggerButtonDisabled()||(console.log("Tap To Pay Trigger Secure Registration on click"),this.widget.trigger(q,{postData:{hideAddPaymentInstrumentHeader:!0,creatablePaymentMethods:this._creatablePaymentMethods,registrationType:this._registrationType}}))},bindToEvents:function(){var c=this;c.widget.on("componentsInitialized",c,function(){c._shouldInvokeTapToPayTriggerJS()&&
(c._shouldRenderTriggerButtonAsEnabled?c._enableTapToPayTriggerButton():c._disableTapToPayTriggerButton(),c._publishCountMetrics("PageLoad"),h.when("TapAndPay").execute(function(e){l=(new Date).getTime();e.prepareTerminal({request_id:m,enable_attestation:"false",processIsolation:"true",successCallback:g.bind(c._handlePrepareTerminalSuccessOnPageLoad,c),failCallback:g.bind(c._handlePrepareTerminalFailureOnPageLoad,c)})}))})},bindToElements:function(){this.getDOMElement("tap-to-pay-trigger-button").click(g.bind(this._bindTapToPayTriggerButtonClick,
this))}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-InstallmentOffers","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/DefaultComponent",["component"],function(a){return a.extend({initialize:function(){b.alert("DefaultComponent initialize!")}})})})()});
/* ******** */
(function(b){var c=window.AmazonUIPageJS||window.P,d=c._namespace||c.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-BankRefund","APXWidgetsAssets"):c;a.guardFatal?a.guardFatal(b)(a,window):a.execute(function(){b(a,window)})})(function(b,c,d){(function(){var a=PaymentsPortal2.modules.define;a("components/BankRefundComponent",["component","jQuery","lang","AUI!P"],function(a,c,b,f){return a.extend({initialize:function(a,b){this._bankRefundListSize=b.data.bankRefundListSize;var c=this;f.when("A",
"jp-bank-list","ready").execute(function(a,b){for(a=0;a<c._bankRefundListSize;a++){var e=b.getBankNameByCode(c.getDOMElement("bank-refund-bank-name-field-"+a).attr("data-bankNumber"));e!==d&&(c.getDOMElement("bank-refund-bank-name-field-"+a)[0].innerHTML=e)}})},bindToElements:function(){this.getDOMElementsByPrefix("remove-bank-account-").click(b.bind(this._removeBankLinkTriggered,this));this.getDOMElement("add-new-bank-account-button").click(b.bind(this._addBankButtonTriggered,this));this.getDOMElement("add-new-bank-account-link").click(b.bind(this._addBankButtonTriggered,
this))},_removeBankLinkTriggered:function(a){this.widget.scrollToTopOfThePage();a=c(a.target).attr("data-instrumentId");this.widget.submitFormAJAX({"ppw-widgetEvent":"RemoveBankAccountEvent","ppw-instrumentId":a,"ppw-widgetState":this.widget.options.serializedState})},_addBankButtonTriggered:function(){this.widget.scrollToTopOfThePage();this.widget.submitFormAJAX({"ppw-widgetEvent":"AddNewBankAccountEvent","ppw-widgetState":this.widget.options.serializedState})}})});a("components/BankRefundWorkflowComponent",
["component"],function(a){return a})})()});
/* ******** */
(function(d){var c=window.AmazonUIPageJS||window.P,e=c._namespace||c.attributeErrors,a=e?e("APXWidgetsAssets@APXWidgets-Bancontact","APXWidgetsAssets"):c;a.guardFatal?a.guardFatal(d)(a,window):a.execute(function(){d(a,window)})})(function(d,c,e){(function(){var a=PaymentsPortal2.modules.define;a("components/BancontactDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,b){this._paymentMethodId=b.data.paymentMethodId;
this._paymentMethodType=b.data.paymentMethodType},bindToElements:function(){this._bindEditPMLink()}})});a("components/BancontactEditComponent",["component","EditComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,c){b._initializePopover(a,c,this)},bindToEvents:function(){b._bindPopoverCloseButtonClickedEvent(this)}})});a("components/BancontactSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,
b){this._instrumentId=b.data.instrumentId}})})})()});
/* ******** */
(function(e){var c=window.AmazonUIPageJS||window.P,f=c._namespace||c.attributeErrors,a=f?f("APXWidgetsAssets@APXWidgets-Transactions","APXWidgetsAssets"):c;a.guardFatal?a.guardFatal(e)(a,window):a.execute(function(){e(a,window)})})(function(e,c,f){(function(){var a=PaymentsPortal2.modules.define;a("components/TransactionsSummaryComponent",["component","jQuery"],function(a,d){return a.extend({initialize:function(a,b){this._noTransactionsFoundByUPDOrSignature=b.data.noTransactionsFoundByUPDOrSignature;
this._baseUrl=b.data.baseUrl},_reloadPageOnUpdOrSignatureError:function(){var a=d("\x3cform\x3e").attr({method:"GET",action:this._baseUrl});a.append(this.buildHiddenInput("noTransactionsFoundByUPDOrSignature",!0));this.widget.getRootDOMElements().last().append(a);a.submit()},buildHiddenInput:function(a,b){return d("\x3cinput\x3e").attr({type:"hidden",name:a,value:b})},bindToElements:function(){this._noTransactionsFoundByUPDOrSignature&&this._reloadPageOnUpdOrSignatureError()}})});a("components/TransactionLineItemComponent",
["component","lang","metrics-helper","clog"],function(a,d,c,b){return a.extend({initialize:function(a,b){this._orderIds=b.data.orderIds},_publishOrderIdOnClickMetrics:function(){var a=this;d.forEach(a._orderIds,function(b){c.publishOnClickSuccessSushiMetrics(a,[{JsBindElementId:"OrderIdLink-"+b,MetricsObject:{ActionType:"TransactionsOrderIdLink"}}])})},_publishWalletViewTransactionOrderDetailsMetrics:function(){var a=this;d.forEach(a._orderIds,function(c){a.getDOMElement("walletViewTransactionOrderDetails-"+
c).bind("click",function(){b.logCounterMetric({feature:"WalletViewTransactionOrderDetails",resource:"_Count"});b.publishMetrics()})})},bindToElements:function(){this._publishOrderIdOnClickMetrics();this._publishWalletViewTransactionOrderDetailsMetrics()}})})})()});
/* ******** */
(function(k){var f=window.AmazonUIPageJS||window.P,l=f._namespace||f.attributeErrors,c=l?l("APXWidgetsAssets@APXWidgets-Wallet","APXWidgetsAssets"):f;c.guardFatal?c.guardFatal(k)(c,window):c.execute(function(){k(c,window)})})(function(k,f,l){(function(){var c=PaymentsPortal2.modules.define;c("AddBalanceMethodHelper",["events/spinner-events"],function(d){return{_startAddBalanceEvent:function(b){b.widget.trigger(d.showSpinner);b.widget.continueRequest({"ppw-widgetState":b.widget.options.serializedState,
"ppw-widgetEvent":"StartAddBalanceEvent"},{success:b.widget.createAjaxContinueSuccessHandler(),complete:function(){b.widget.trigger(d.hideSpinner)}})}}});c("AddPaymentMethodHelper",["events/spinner-events"],function(d){return{_startAddPMEvent:function(b){b.widget.trigger(d.showSpinner);b.widget.continueRequest({"ppw-widgetState":b.widget.options.serializedState,"ppw-widgetEvent":"StartAddInstrumentEvent"},{success:b.widget.createAjaxContinueSuccessHandler(),complete:function(){b.widget.trigger(d.hideSpinner)}})}}});
c("components/WalletComponent","component jQuery events/spinner-events AddPaymentMethodHelper mash-helper AddBalanceMethodHelper".split(" "),function(d,b,a,c,e,h){return d.extend({_triggerFallbackToMPO:!1,_shouldOpenAddPaymentInstrumentView:!1,initialize:function(b,g){this._triggerFallbackToMPO=g.data.triggerFallbackToMPO;this._isRequestForMobileApp=g.data.isRequestForMobileApp;this._securePaymentMethodAddedEvent=g.data.securePaymentMethodAddedEvent;this._dynamicContinueEnabled=g.data.dynamicContinueEnabled;
this._shouldOpenAddPaymentInstrumentView=g.data.shouldOpenAddPaymentInstrumentView;var a=this;a._isRequestForMobileApp&&(e.addEventListener(a._securePaymentMethodAddedEvent,function(b){a._addEventListenerWalletHandler(b)}),e.setBookmark("wallet-widget"))},_addEventListenerWalletHandler:function(b){this._dynamicContinueEnabled?this.addPaymentMethodRefreshContinue(b.detail.paymentInstrumentId,b.detail.widgetAction):this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"AddPaymentMethodRefreshEvent",
"ppw-paymentMethodId":b.detail.paymentInstrumentId,"ppw-widgetAction":b.detail.widgetAction});e.backToBookmark("wallet-widget")},bindToElements:function(){var a=this;"mobile"!==a.widget.options.deviceType&&(b(".pmts-loading-async-widget-spinner-overlay").css("background-color","rgba( 234, 237, 237, .5 )"),a.getDOMElement("JsBindSleeveAddPMButton").click(function(){c._startAddPMEvent(a)}))},bindToEvents:function(){var a=this;if("mobile"===a.widget.options.deviceType){var g=b(".apx-wallet-mobile-selectable-card-list .apx-wallet-mobile-sleeve-item-shadow-two").first(),
d=b(".apx-wallet-mobile-selectable-cash-list .apx-wallet-mobile-sleeve-item-shadow-two").first();a._updateFirstItemStyle(g);a._updateFirstItemStyle(d)}a.widget.on("componentsInitialized",a,function(){a._triggerFallbackToMPO&&a.widget.trigger("triggerFallbackToMPO");if(a._shouldOpenAddPaymentInstrumentView){var b=(new URLSearchParams(f.location.search)).get("successCodes");null!==b&&"SUCCESS_CHANGE_MOBILE_PHONE"===b&&c._startAddPMEvent(a)}})},_updateFirstItemStyle:function(b){b.removeClass("apx-wallet-mobile-sleeve-item-shadow-two")}})});
c("PaymentMethodDetailsSlotComponentSupport",["lang"],function(d){return{_bindEditPMLink:function(){this.getDOMElement("editPMLink").click(d.bind(this._editPMLinkClicked,this))},_editPMLinkClicked:function(){var b={"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"StartEditEvent","ppw-iid":this._paymentMethodId,"ppw-paymentMethodType":this._paymentMethodType,"ppw-isDefaultPaymentMethod":this._isDefault};"undefined"!==typeof this._paymentMethodSubCategory&&(b["ppw-paymentMethodSubCategory"]=
this._paymentMethodSubCategory);this.widget.submitFormAJAX(b)}}});c("EditComponentSupport",["modal-popover"],function(d){return{_initializePopover:function(b,a,c){a.data.shouldRenderInPopover&&(c.popover=new d(b,a,c))},_bindPopoverCloseButtonClickedEvent:function(b){b.widget.on("apx-wallet-edit-popover-closed",b,function(){b.getDOMElement("apx-wallet-js-edit-popover-cancel-form").submit()})}}});c("components/PaymentMethodSleeveComponent","component jQuery events/spinner-events AddPaymentMethodHelper clog events/InstrumentRowSelectedEvent AddBalanceMethodHelper".split(" "),
function(c,b,a,m,e,h,f){return c.extend({initialize:function(a,c){var d=this;d.widget.on("componentsInitialized",d,function(){var a=c.data.selectedInstrumentId;a&&d.widget.trigger(h,{instrumentId:a});c.data.shouldFocusSelectedInstrument&&b(".apx-wallet-payment-method-tab-selected").find("a").focus()})},bindToElements:function(){var a=this,c=a.getDOMElement("JsBindSleeveAddPMButton"),d=a.getDOMElement("walletSelectableAddTab"),h=a.getDOMElement("walletAddBalanceTab");c.click(function(){m._startAddPMEvent(a)});
d.click(function(){"mobile"!==a.widget.options.deviceType&&(b(".apx-wallet-payment-method-tab-selected").removeClass("apx-wallet-payment-method-tab-selected"),a.getDOMElement("walletSelectableAddTab").addClass("apx-wallet-payment-method-tab-selected"));m._startAddPMEvent(a)});null!=h&&h.click(function(){"mobile"!==a.widget.options.deviceType&&(b(".apx-wallet-payment-method-tab-selected").removeClass("apx-wallet-payment-method-tab-selected"),a.getDOMElement("walletAddBalanceTab").addClass("apx-wallet-payment-method-tab-selected"));
f._startAddBalanceEvent(a)});a.getDOMElement("walletSeeAllPaymentMethods").bind("click",function(){e.logCounterMetric({feature:"WalletSeeAllPaymentMethods",resource:"_Count"});e.publishMetrics();a._triggerFallbackToMPO()})},bindToEvents:function(){var a=this;a.widget.on("triggerFallbackToMPO",a,function(){a._triggerFallbackToMPO()})},_triggerFallbackToMPO:function(){e.logCounterMetric({feature:"WalletFallbackToMPO",resource:"_Count"});e.publishMetrics();this.widget.trigger(a.showSpinner);this.widget.widgetAction({widgetActionType:"wallet",
widgetAction:"fallback-to-mpo-widget"})}})});c("PaymentMethodSleeveItemSlotComponentSupport",["jQuery","events/spinner-events"],function(c,b){return{bindToElements:function(){var a=this;a.getDOMElement("walletSelectablePMTab").click(function(){c(".apx-wallet-payment-method-tab-selected").removeClass("apx-wallet-payment-method-tab-selected");a.getDOMElement("walletSelectablePMTab").addClass("apx-wallet-payment-method-tab-selected");a._triggerViewDetailsEvent()});a.getDOMElement("walletSelectablePMButton").click(function(){a._triggerViewDetailsEvent()})},
_triggerViewDetailsEvent:function(){var a=this;a.widget.trigger(b.showSpinner);a.widget.continueRequest({"ppw-widgetState":a.widget.options.serializedState,"ppw-widgetEvent":"ViewPaymentMethodDetailsEvent","ppw-instrumentId":a._instrumentId},{success:a.widget.createAjaxContinueSuccessHandler(),complete:function(){a.widget.trigger(b.hideSpinner)}})}}});c("components/PaymentMethodSleevePaginationComponent",["component","jQuery","lang"],function(c,b,a){return c.extend({_sleeveId:!1,initialize:function(a,
b){this._sleeveId=b.data.sleeveId},bindToElements:function(){var b=this,c=b.getDOMElements("walletSleevePageButton"+b._sleeveId);a.forEach(c,function(c){c=c.querySelector("button");var d=c.value;d&&(c.onclick=a.bind(function(a){this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"PaymentMethodSleevePaginationNavigateEvent","ppw-sleeveId":this._sleeveId,"ppw-newPageIndex":a})},b,d))})}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-Balances","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/ManageBalancesComponent",["component","metrics-helper"],function(a,b){return a.extend({bindToElements:function(){b.publishOnClickSuccessSushiMetrics(this,[{JsBindElementId:"EnrollRewardsAccountDesktopLink",
MetricsObject:{ActionType:"EnrollRewardsAccountDesktopLink"}},{JsBindElementId:"EnrollRewardsAccountMobileLink",MetricsObject:{ActionType:"EnrollRewardsAccountMobileLink"}}])}})});a("components/RewardsAccountListComponent",["component"],function(a){return a.extend({})});a("components/RewardsAccountListItemComponent",["component"],function(a){return a.extend({})})})()});
/* ******** */
(function(t){var u=window.AmazonUIPageJS||window.P,v=u._namespace||u.attributeErrors,h=v?v("APXWidgetsAssets@APXWidgets-CreditCardBillPayment","APXWidgetsAssets"):u;h.guardFatal?h.guardFatal(t)(h,window):h.execute(function(){t(h,window)})})(function(t,u,v){(function(){var h=PaymentsPortal2.modules.define;h("components/AddCreditCardBillPaymentsComponent","form-component css-utils cc-spacing lang events/form-submitted-event jQuery form-helper mock-helper AUI!P validation-functions".split(" "),function(h,
e,t,m,v,k,P,Q,A,n){var l,y,g,z,O=/^[0-9]+$/,B="",C="",D,E,F,G,I,J,K,r,p,q,w="false",L,M,N=!1,x=!1;return h.extend({initialize:function(b,a){this._addButtonJSBinding=a.data.addButtonJSBinding||"newCreditCardSubmitButton";this._addFormContainerJSBinding=a.data.addFormContainerJSBinding||"addCreditCardContainer";this._accountHolderNameBinding=a.data.addAccountHolderNameBinding||"accountHolderName";this._addCardNumberBinding=a.data.addCardNumberBinding||"addCreditCardNumber";this._placementType=a.data.placementType;
this._alertJSBinding=a.data.alertFailureContainerJSBinding||"pmts-alert-failure-container";this._lengthRequiredToFetchIssuer=a.data.minLengthRequiredToFetchIssuer||6;this._expiryMonthBinding=a.data.addExpiryMonthBinding||"expirationDate";this._expiryYearBinding=a.data.addExpiryYearBinding||"expirationDate";this._secureCardHiddenBinding=a.data.addSecureCardBinding||"secureCardHidden";G=a.data.prefillBankCode;I=a.data.prefillNetworkImage;J=a.data.prefillTail;K=a.data.prefillBankDisplayName;r=a.data.shouldPrefillSemiSavedCardDetails;
p=a.data.isInlineTokenisationEnabled;L=a.data.payAndSecureCTALabel;M=a.data.proceedCTALabel;p&&(q=!1,this.getDOMElement(this._secureCardHiddenBinding).val(!1),D=this.getDOMElement("expiry_selector"),E=this.getDOMElement("name_on_card_section"),x=a.data.isRedirectedFromSecureNow,this.createConditionalValidationFunctions(),F=this.getDOMElement("nonTokenisableCardError"),A.when("a-button").execute(function(a){y=a("#proceedButton")}))},bindToElements:function(){this.getDOMElement(this._addButtonJSBinding).click(m.bind(this.handleAddCardLikeDOMEvent,
this));this.getDOMElement(this._accountHolderNameBinding);var b=this.getDOMElement(this._addCardNumberBinding),a=this.getDOMElement(this._expiryMonthBinding),c=this.getDOMElement(this._expiryYearBinding);z=this.getDOMElement(this._alertJSBinding);e.setElementBackgroundImage(b,this._blankIssuerImageURL,"no-repeat 96% center");setTimeout(function(){r&&e.setElementBackgroundImage(b,I)},500);A.when("jQuery","ready").execute("autofocus-addCreditCardNumber",function(a){r||a('input[name\x3d"addCreditCardNumber"]').focus()});
var d=this,H,f;b.keydown(function(a){H=this.value;f=this.selectionStart});a.click(function(a){d._clearValidationErrors()});c.click(function(a){d._clearValidationErrors()});b.bind("paste",function(a){k(a.target).keyup()});b.keyup(function(a){this.value=this.value.replace(/^0|[^0-9\s]+/g,"");"number"!==this.type&&this.value!==H&&(a=this.selectionStart,this.value=t.fixSpacing(this.value),a=t.fixCaret(a,this.value,H,f),this.setSelectionRange(a,a))});var g=null;b.keyup(function(a){u.clearTimeout(g);g=
u.setTimeout(function(){C=B="";r||(d._resetIssuingBankAndHideTokenisationFields(),p&&(x?(d.enableDisableProceedButton(!0),w=""):d.enableDisableSecureCardCheckbox(!1)));var a=b.val().replace(/\s/g,"");O.test(a)&&a.length>=d._lengthRequiredToFetchIssuer?d.widget.trigger("creditCardNumberChanged",{creditCardNumber:a,placementType:d._placementType}):(d._clearValidationErrors(),e.setElementBackgroundImage(b,this._blankIssuerImageURL))},500)});b.focus(function(a){r&&!N&&(b.val(J),setTimeout(function(){b[0].setSelectionRange(0,
0)},0),N=!0)})},handleAddCardLikeDOMEvent:function(b){if(p&&x&&"false"===w)return!1;var a=this.form.validateForm();0===a.length&&(this.form.renderErrorMessages(a),this._formSubmissionEventObj={submissionParameters:this.getFormSubmissionParameters(this._addFormContainerJSBinding),action:this._action,event:b},m.isDefined(this._formSubmissionEventObj.submissionParameters)&&m.isDefined(this._formSubmissionEventObj.submissionParameters[2])&&(this._formSubmissionEventObj.submissionParameters[2].value=this._formSubmissionEventObj.submissionParameters[2].value.replace(/\s/g,
"")),this.widget.trigger(v,this._formSubmissionEventObj));return!1},bindToEvents:function(){function b(a){g&&g.getSelect("issuingBankSelectDropDown")&&g.getSelect("issuingBankSelectDropDown").setValue(a);k("#issuingBankCodeTextInput").val(a);k("#fetchedBankCodeTextInput").val(a)}var a=this;this.getDOMElement("secureCardCheckbox").change(function(c){a.hideShowTokenisationFields(k(this).is(":checked"))});this.widget.on(v,this,function(c){e.hideElement(z);a.widget.trigger("submitFormAjaxStarted");p?
(x&&(q=!1),c={addCreditCardNumber:c.submissionParameters[2].value,"ppw-accountHolderName":c.submissionParameters[5].value,"ppw-selectIssuingBankCode":c.submissionParameters[3].value,"ppw-fetchedBankCode":c.submissionParameters[4].value,"ppw-cardType":B.split('"')[1],"ppw-countryCode":C,"ppw-widgetState":a.widget.options.serializedState,"ppw-widgetEvent":"AddCreditCardEvent","ppw-expirationDate_month":c.submissionParameters[6].value,"ppw-expirationDate_year":c.submissionParameters[7].value,"ppw-secureCardHidden":q}):
c={addCreditCardNumber:c.submissionParameters[2].value,"ppw-selectIssuingBankCode":c.submissionParameters[3].value,"ppw-fetchedBankCode":c.submissionParameters[4].value,"ppw-cardType":B.split('"')[1],"ppw-countryCode":C,"ppw-widgetState":a.widget.options.serializedState,"ppw-widgetEvent":"AddCreditCardEvent"};a.widget.continueRequest(c,{query:{sif_profile:"CCBP_SIF_Profile"},success:function(c){var b=c.additionalWidgetResponseData.additionalData.addCreditCardEventResponseMessage;"failed"===c.additionalWidgetResponseData.additionalData.addCreditCardEventResponseStatus&&
a._displayErrorMessage(b)},complete:function(){a.widget.trigger("submitFormAjaxCompleted")}})});this.widget.on("creditCardIssuerDetermined",this,function(c){a.widget.trigger("submitFormAjaxCompleted");c.countryCode&&(C=c.countryCode);c.cardType&&(B=c.cardType);c.issuingBankName?this.widget.continueRequest({"ppw-issuingBankName":c.issuingBankName,"ppw-network":c.issuer,"ppw-widgetEvent":"IdentifyIssuingBankEvent","ppw-widgetState":this.widget.options.serializedState},{success:m.bind(function(b){b=
b.additionalWidgetResponseData.additionalData;b.issuingBankCode&&b.issuingBankDisplayName?(l&&l.text(b.issuingBankDisplayName),g&&g.getSelect("issuingBankSelectDropDown")&&g.getSelect("issuingBankSelectDropDown").setValue(b.issuingBankCode),k("#issuingBankCodeTextInput").val(b.issuingBankCode),k("#fetchedBankCodeTextInput").val(b.issuingBankCode),p&&(w=b.isTokenisable,x?("true"===w?this.enableDisableProceedButton(!0):this.enableDisableProceedButton(!1),this.enableDisableSecureCardCheckbox(!0),this.getDOMElement("secureCardCheckbox").attr("checked",
!1),q=!0):"true"===w?(this.showInlineTokenisationFields(),this.getDOMElement("secureCardCheckbox").attr("checked",!0),this.getDOMElement(this._secureCardHiddenBinding).val(!1),q=!1):(this.enableDisableSecureCardCheckbox(!0),this.getDOMElement("secureCardCheckbox").attr("checked",!1),this.getDOMElement(this._secureCardHiddenBinding).val(!0),q=!0,e.showElement(F))),b="#"+this.form.component._elementReferences.selectIssuingBankCode,this.form._getFormFieldAlertContainers().selectIssuingBankCode.find(".pmts-error-message-inline").remove(),
k(b).removeClass("a-form-error a-button-error")):a._resetIssuingBankAndHideTokenisationFields()},this),error:m.bind(function(a){},this)}):a._resetIssuingBankAndHideTokenisationFields();if(c.issuerImage){var b=this.getDOMElement(this._addCardNumberBinding);e.setElementBackgroundImage(b,c.issuerImage)}});A.when("A","a-sheet","a-button","ready").execute("issuingBankBottomsheet",function(a,d,e){var f,g=a.$;l=e("#issuingBankSelectBtn");a.on("a:sheet:afterShow:issuing_bank_bottom_sheet",function(a){f=a.sheet});
a.declarative("issuing-bank-item-click","click",function(a){a=a.data;f&&f.hide();l&&(l.text(a.issuingBankDisplayName),g("#issuingBankCodeTextInput").val(a.issuingBankCode))});r&&(l&&l.text(K),b(G))});A.when("A","a-dropdown","ready").execute("issuingBankDropDown",function(a,d){g=d;r&&b(G)})},hideShowTokenisationFields:function(b){if("true"===w){var a=this.getDOMElement(this._secureCardHiddenBinding);b?(a.val(""),this.showInlineTokenisationFields(),this.getDOMElement(this._secureCardHiddenBinding).val(!1),
q=!1):(a.val("checked"),this.hideInlineTokenisationFields(),this.getDOMElement(this._secureCardHiddenBinding).val(!0),q=!0)}},enableDisableSecureCardCheckbox:function(b){this.getDOMElement("secureCardCheckbox").attr("disabled",b)},hideInlineTokenisationFields:function(){e.hideElement(D);e.hideElement(E);y.text(M)},showInlineTokenisationFields:function(){e.showElement(D);e.showElement(E);y.text(L)},createConditionalValidationFunctions:function(){n.NonEmptyWhenConditionFieldCompliesToValidationTypeConstraint=
function(b,a,c,d){var e="false"==a[d.conditionFieldName],f=!1;switch(d.validationType.value){case "NonEmptyWhenConditionFieldFalse":f=e}return f?n.NonEmptyFieldConstraint(b,a,c):!0};n.MatchesPatternWhenConditionFieldCompliesToValidationTypeConstraint=function(b,a,c,d){var e="false"==a[d.conditionFieldName],f=!1;switch(d.validationType.value){case "MatchesPatternWhenConditionFieldFalse":f=e}return f?n.RegexMatchFieldConstraint(b,a,c,d):!0};n.LengthGreaterThanOrEqualWhenConditionFieldPassesValidationConstraint=
function(b,a,c,d){var e="false"==a[d.conditionFieldName],f=!1;switch(d.validationType.value){case "LengthGreaterThanOrEqualWhenConditionFieldFalse":f=e}return f?n.LengthGreaterThanEqualConstraint(b,a,c,d):!0};n.VerifyExpirationDateWhenConditionFieldCompliesToValidationTypeConstraint=function(b,a,c,d){var e="false"==a[d.conditionFieldName],f=!1;switch(d.validationType.value){case "VerifyExpirationDateWhenConditionFieldFalse":f=e}return f?n.CreditCardExpirationConstraint(b,a,c,d):!0}},_displayErrorMessage:function(b){z.find(".a-alert-content").html(b);
e.showElement(z)},enableDisableProceedButton:function(b){b?y.enable():y.disable()},_resetIssuingBankAndHideTokenisationFields:function(){l&&l.text("Select bank");g&&g.getSelect("issuingBankSelectDropDown")&&g.getSelect("issuingBankSelectDropDown").setValue("");k("#issuingBankCodeTextInput").val("");k("#fetchedBankCodeTextInput").val("");p&&!x?(this.hideInlineTokenisationFields(),e.hideElement(F)):p&&this.showInlineTokenisationFields()},_clearValidationErrors:function(){e.hideElement(z);this.form.clearValidationErrors();
if(m)try{var b=this.form._getFormFieldAlertContainers();b&&m.forEach(m.keys(b),function(a){b[a].find(".pmts-error-message-inline").remove()})}catch(a){console.log("Error while removing inlineFormFieldAlertContainers")}}})})})()});
/* ******** */
(function(e){var c=window.AmazonUIPageJS||window.P,g=c._namespace||c.attributeErrors,b=g?g("APXWidgetsAssets@APXWidgets-Venmo","APXWidgetsAssets"):c;b.guardFatal?b.guardFatal(e)(b,window):b.execute(function(){e(b,window)})})(function(e,c,g){(function(){var b=PaymentsPortal2.modules.define;b("components/AddVenmoComponent","events/form-submitted-event jQuery form-component mini-browser-helper lang clog".split(" "),function(b,m,h,k,f,g){var l={width:600,height:800};return h.extend({_hasErrors:!1,initialize:function(a,
d){this._hasErrors=d.data.hasErrors;this._interstitialPageUrl=d.data.interstitialPageUrl;this._isMiniBrowserEnabled=d.data.isMiniBrowserEnabled;this._instrumentId=d.data.instrumentId;this._widgetAction=d.data.action;this._intermediateScreenTreatment=d.data.intermediateScreenTreatment;this._desktopDescriptionTreatment=d.data.desktopDescriptionTreatment;this._device=a.options.deviceType;this._isRequestForMobileApp=d.data.isRequestForMobileApp},bindToEvents:function(){var a=this;a.widget.on("componentsInitialized",
a,function(){a._interstitialPageUrl&&(a._isMiniBrowserEnabled?a._showPopoverModal():c.location.href=this._interstitialPageUrl)});a.widget.on("AddVenmoIntermediateStepEvent",a,function(a){this._isIntermediateScreenEnabled()?this.getDOMElement("apx-add-venmo-mobile-link").trigger("click"):this._handleAddVenmoClickWithoutIntermediateScreen(a)})},_handleCompactAddVenmoClicked:function(a){this._logClogCounterMetric("DigitalWallet.Venmo.Reg."+this._desktopDescriptionTreatment+".addVenmoBtnClicked");this._handleAddVenmoFormSubmission(a)},
_handleDesktopAddVenmoClicked:function(a){this._logClogCounterMetric("DigitalWallet.Venmo.Reg."+this._desktopDescriptionTreatment+".addVenmoBtnClicked")},bindToElements:function(){var a=this;e.when("A","a-modal","ready").execute(function(d,b){a.getDOMElement("apx-add-venmo-modal-go-button").click(function(){a._logClogCounterMetric("DigitalWallet.Venmo.Reg."+a._desktopDescriptionTreatment+".goToVenmoBtnClicked");a._openVenmoMiniBrowserWindow(a._interstitialPageUrl)})});e.when("A","a-modal").execute(function(d){d.off("a:popover:afterHide:apx-add-venmo-modal");
d.on("a:popover:afterHide:apx-add-venmo-modal",function(d){a._logClogCounterMetric("DigitalWallet.Venmo.addVenmoPopoverHidden")})});a.getDOMElement("apx-add-venmo-link-button").click(f.bind(this._handleDesktopAddVenmoClicked,this));a.getDOMElement("apx-add-venmo-compact-link").click(f.bind(this._handleCompactAddVenmoClicked,this));a.getDOMElement("apx-continue-to-venmo-button-id").click(f.bind(this._handleContinueToVenmoButton,this));this._isIntermediateScreenEnabled()?(a.getDOMElement("apx-venmo-intermediate-screen-learn-more-link-mobile").click(f.bind(this._handleIntermediateScreenLearnMoreLink,
this)),a.getDOMElement("apx-add-venmo-mobile-link").click(f.bind(this._handleAddVenmoClickWhichOpensIntermediateScreen,this))):a.getDOMElement("apx-add-venmo-mobile-link").click(f.bind(this._handleAddVenmoClickWithoutIntermediateScreen,this));this._isDesktopDescriptionEnabled()&&a.getDOMElement("apx-add-venmo-learn-more-link").click(f.bind(this._handleDesktopDescriptionLearnMoreLink,this))},_isIntermediateScreenEnabled:function(){return this._intermediateScreenTreatment&&"C"!==this._intermediateScreenTreatment.toUpperCase()},
_isDesktopDescriptionEnabled:function(){return this._desktopDescriptionTreatment&&"C"!==this._desktopDescriptionTreatment.toUpperCase()},_showPopoverModal:function(){this.getDOMElement("apx-add-venmo-modal-trigger").trigger("click")},_hidePopoverModal:function(){var a=this;e.when("a-modal").execute(function(d){d&&(d=d.get("apx-add-venmo-modal"))&&(d.hide(),a._logClogCounterMetric("DigitalWallet.Venmo.addVenmoPopoverHiddenAfterInterstitialClosed"))})},_getDeviceType:function(){return this._isRequestForMobileApp?
"mobileapp":this._device},_handleContinueToVenmoButton:function(a){this._handleAddVenmoReturnUrl(a);this._logClogCounterMetric("DigitalWallet.Venmo.Reg."+this._intermediateScreenTreatment+"."+this._getDeviceType()+".continueToVenmoBtnClicked");this.widget.publishSuccessSushiMetrics({ActionType:"ContinueToVenmo",ActionValueType:"Click",ActionValue:"ContinueToVenmoButtonClicked"})},_handleAddVenmoClickWithoutIntermediateScreen:function(a){this._logClogCounterMetric("DigitalWallet.Venmo.Reg."+this._getDeviceType()+
".addVenmoBtnClicked");this._handleAddVenmoFormSubmission(a)},_handleAddVenmoClickWhichOpensIntermediateScreen:function(){this._logClogCounterMetric("DigitalWallet.Venmo.Reg."+this._intermediateScreenTreatment+"."+this._getDeviceType()+".addVenmoBtnClicked");this.widget.publishSuccessSushiMetrics({ActionType:"AddVenmoAccount",ActionValueType:"Click",ActionValue:"AddVenmoButtonClicked"})},_handleIntermediateScreenLearnMoreLink:function(){this._logClogCounterMetric("DigitalWallet.Venmo.Reg."+this._intermediateScreenTreatment+
".IntermediateScreen.learnMoreClicked")},_handleDesktopDescriptionLearnMoreLink:function(){this._logClogCounterMetric("DigitalWallet.Venmo.Reg.DesktopDescription.learnMoreClicked")},_logClogCounterMetric:function(a){g.logCounterMetric({feature:a,resource:"_Count"});g.publishMetrics()},_openVenmoMiniBrowserWindow:function(a){this._venmo_window=k.openInMiniBrowser(a,"apx-add-venmo-mini-window",l);this._venmo_window.focus();this._monitorVenmoMinibrowserWindow()},_handleAddVenmoReturnUrl:function(a){a=
c.location.pathname+c.location.search;this.getDOMElement("apx-add-venmo-client-page-url").val(a)},_handleAddVenmoFormSubmission:function(a){this.widget.publishSuccessSushiMetrics({ActionType:"AddVenmoAccount",ActionValueType:"Click",ActionValue:"AddVenmoButtonClicked"});a=this.getDOMElement("apx-add-venmo-form");this._handleAddVenmoReturnUrl();a.submit()},_monitorVenmoMinibrowserWindow:function(){c.clearTimeout(this._venmo_window_timer);!this._venmo_window||this._venmo_window.closed?(this._hidePopoverModal(),
this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"AddPaymentMethodRefreshEvent","ppw-paymentMethodId":this._instrumentId,"ppw-widgetAction":this._widgetAction})):this._venmo_window_timer=setTimeout(this._monitorVenmoMinibrowserWindow.bind(this),100)}})});b("components/VenmoDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport"],function(b,c){return b.extend(c,{initialize:function(b,c){this._paymentMethodId=c.data.paymentMethodId;
this._paymentMethodType=c.data.paymentMethodType;this._paymentMethodSubCategory=c.data.paymentMethodSubCategory},bindToElements:function(){this._bindEditPMLink()}})});b("components/VenmoEditComponent",["component","EditComponentSupport"],function(b,c){return b.extend(c,{initialize:function(b,e){c._initializePopover(b,e,this)},bindToEvents:function(){c._bindPopoverCloseButtonClickedEvent(this)}})});b("components/SelectableVenmoListComponent",["form-component"],function(b){return b});b("components/SelectableVenmoListItemComponent",
["components/SelectableDPMInstrumentListItemComponent"],function(b){return b});b("components/VenmoSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(b,c){return b.extend(c,{initialize:function(b,c){this._instrumentId=c.data.instrumentId}})})})()});
/* ******** */
(function(k){var g=window.AmazonUIPageJS||window.P,l=g._namespace||g.attributeErrors,d=l?l("APXWidgetsAssets@APXWidgets-CVS","APXWidgetsAssets"):g;d.guardFatal?d.guardFatal(k)(d,window):d.execute(function(){k(d,window)})})(function(k,g,l){(function(){var d=PaymentsPortal2.modules.define;d("components/CVSPayByBarcodeComponent","component css-utils jQuery lang AUI!P clog".split(" "),function(d,e,f,c,h,m){return d.extend({countdownTimerIntervalId:"",MAX_FETCH_BARCODE_RETRY:3,RETRY_DELAY:2E3,AUTO_REFRESH_BARCODE_CUTOFF_TIME:30,
shouldContinueFetchData:!0,initialize:function(a,b){this.MAX_FETCH_BARCODE_RETRY=b.data.maxRetry;this.RETRY_DELAY=b.data.retryDelay;this.AUTO_REFRESH_BARCODE_CUTOFF_TIME=b.data.autoRefreshBarcodeCutoffTime;this.displayBarcode=b.data.displayBarcode;this.isMobile="mobile"===a.options.deviceType;this._redirectUrl=b.data.redirectUrl},bindToElements:function(){this.getDOMElement("pmts-cvs-display-barcode-button").click(c.bind(this._displayBarcodeButtonTriggered,this));this.getDOMElement("pmts-cvs-barcode-refresh-button").click(c.bind(this._refreshBarcodeButtonTriggered,
this));this.getDOMElement("pay-by-barcode-store-location-link").click(c.bind(this._triggerConfirmRedirectionPopup,this));this._bindCloseBottomSheetTrigger();!0===this.displayBarcode&&this.isMobile&&this.getDOMElement("pmts-cvs-display-barcode-button").click()},_triggerConfirmRedirectionPopup:function(){this.widget.trigger("OpenRedirectionPopupEvent",{redirectUrl:this._redirectUrl})},_bindCloseBottomSheetTrigger:function(){var a=this;h.when("A","a-sheet").execute("barcode_bottomSheet",function(b,c){b.on("a:sheet:beforeShow:barcode_bottomSheet",
function(b){a.shouldContinueFetchData=!0});b.on("a:sheet:afterHide:barcode_bottomSheet",function(b){clearInterval(a.countdownTimerIntervalId);a.shouldContinueFetchData=!1})})},_renderSpinnerAndFetchBarcodeAsync:function(a){a._renderFetchBarcodePendingView(a);a._continueRequestWithEvent(a,"GenerateBarcodeEvent",0,!1)},_continueRequestWithEvent:function(a,b,c,d){a.widget.continueRequest({"ppw-widgetEvent":b,"ppw-widgetState":a.widget.options.serializedState},{success:function(b){a._handleFetchBarcodeSuccess(a,
b,c,d)},error:function(){a._renderFetchBarcodeFailureView(a)}})},_refreshBarcodeButtonTriggered:function(){this._renderSpinnerAndFetchBarcodeAsync(this)},_displayBarcodeButtonTriggered:function(){this._renderSpinnerAndFetchBarcodeAsync(this)},_fetchBarcodeWithRetry:function(a,b){b++;a.shouldContinueFetchData?a._continueRequestWithEvent(a,"GetBarcodeEvent",b,!0):a._renderFetchBarcodeFailureView(a)},_handleFetchBarcodeSuccess:function(a,b,c,d){var e=b.additionalWidgetResponseData.additionalData;b=e.getBarcodeStatus;
var f=e.barcodeBase64Image,e=e.barcodeExpiresAtEpochSeconds;d||"PENDING"!==b?c<a.MAX_FETCH_BARCODE_RETRY?"SUCCESS"===b?a._renderFetchBarcodeSuccessView(a,f,e):"FAILURE"===b?a._renderFetchBarcodeFailureView(a):g.setTimeout(function(){a._fetchBarcodeWithRetry(a,c)},a.RETRY_DELAY):("SUCCESS"===b?a._renderFetchBarcodeSuccessView(a,f,e):a._renderFetchBarcodeFailureView(a),m.logCounterMetric({feature:"FetchBarcodeRetryExceeded",resource:"_Count"}),m.publishMetrics()):a._fetchBarcodeWithRetry(a,c)},_renderFetchBarcodePendingView:function(a){a._hideBarcodeImageSection(a);
a._hideReloadBarcodeButtonSection(a);e.showElement(a.getDOMElement("pmts-cvs-get-barcode-pending-section"))},_renderFetchBarcodeSuccessView:function(a,b,c){a._hideReloadBarcodeButtonSection(a);a._hideSpinnerSection(a);a._showBarcodeImageSection(a,b,c)},_renderFetchBarcodeFailureView:function(a){a._hideBarcodeImageSection(a);a._hideSpinnerSection(a);a._showReloadBarcodeButtonSection(a)},_hideBarcodeImageSection:function(a){e.hideElement(a.getDOMElement("pmts-cvs-barcode-image-section-id"))},_hideSpinnerSection:function(a){e.hideElement(a.getDOMElement("pmts-cvs-get-barcode-pending-section"))},
_hideReloadBarcodeButtonSection:function(a){e.hideElement(a.getDOMElement("refresh-barcode-button-section-id"))},_showBarcodeImageSection:function(a,b,c){f(a.getDOMElement("pmts-cvs-barcode-image")).attr("src","data:image/png;base64,"+b);a._displayBarcodeExpiresInTimer(a,c);e.showElement(a.getDOMElement("pmts-cvs-barcode-image-section-id"))},_showReloadBarcodeButtonSection:function(a){e.showElement(a.getDOMElement("refresh-barcode-button-section-id"));a.getDOMElement("pmts-cvs-barcode-refresh-button").click(c.bind(this._refreshBarcodeButtonTriggered,
this))},_displayBarcodeExpiresInTimer:function(a,b){var c=!1;a.countdownTimerIntervalId=setInterval(function(){var e=Math.round(Date.now()/1E3),e=b-e,d=Math.floor(e/60)+":"+Math.floor(e%60).toString().padStart(2,"0");e<a.AUTO_REFRESH_BARCODE_CUTOFF_TIME&&!c&&(a.widget.submitFormAJAX({"ppw-widgetEvent":"GenerateBarcodeEvent","ppw-widgetState":a.widget.options.serializedState}),c=!0);0>e?(clearInterval(a.countdownTimerIntervalId),a._renderFetchBarcodePendingView(a),a._fetchBarcodeWithRetry(a,0)):a.getDOMElement("pmts-cvs-barcode-expires-in-timer").html(d)},
1E3)}})});d("components/cvs",["component"],function(d){return d.extend({initialize:function(){console.log("Cvs initialized!")}})});d("components/CVSPaymentNotesComponent",["component"],function(d){return d.extend({})});d("components/CVSPayByPayIdComponent",["component","jQuery","lang"],function(d,e,f){return d.extend({initialize:function(c,d){this.storeLocationIds=d.data.storeLocationIds},bindToElements:function(){var c=this;f.forEach(c.storeLocationIds,function(d){c.getDOMElement("store-location-link-id-"+
d).click(f.bind(c._openConfirmRedirectionPopup,c))})},_openConfirmRedirectionPopup:function(c){c=e(c.target).attr("data-storeLink");this.widget.trigger("OpenRedirectionPopupEvent",{redirectUrl:c})}})});d("components/CVSPaymentLocationsComponent",["component","css-utils","lang","jQuery","clog"],function(d,e,f,c,h){return d.extend({bindToEvents:function(){var c=this;c.widget.on("componentsInitialized",c,function(a){e.hideElement(c.getDOMElement("pmts-cvs-barcode-pending-payment-location-view"));e.showElement(c.getDOMElement("pmts-cvs-barcode-payment-location-view"))})},
bindToElements:function(){this.getDOMElement("JSPaidyBannerClick").click(f.bind(this._triggerBanner,this,"PaidyLpBannerClick","https://www.amazon.co.jp/-/en/dp/B08B5TDT9J"));this.getDOMElement("JSPaidyWalletBannerClick").click(f.bind(this._triggerBanner,this,"PaidyWalletBannerClick","https://www.amazon.co.jp/cpe/yourpayments/wallet"));this.getDOMElement("JSPayPayBannerClick").click(f.bind(this._triggerBanner,this,"PayPayLpBannerClick","https://www.amazon.co.jp/l/10435052051"));this.getDOMElement("JSPayPayWalletBannerClick").click(f.bind(this._triggerBanner,
this,"PayPayWalletBannerClick","https://www.amazon.co.jp/cpe/yourpayments/wallet"))},_triggerBanner:function(c,a){this.publishCountMetrics(c);g.location.href=a},publishCountMetrics:function(c){h.logCounterMetric({feature:c,resource:"_Count"});h.publishMetrics()}})});d("components/ConfirmRedirectionPopupComponent","component jQuery lang AUI!P modal-popover mash-helper".split(" "),function(d,e,f,c,h,k){return d.extend({initialize:function(a,b){this._redirectUrl=b.data.redirectUrl;this._jsComponentData=
b;this._shouldRedirect=!1},bindToElements:function(){this.getDOMElement("confirm-redirection-popup-continue-button").click(f.bind(this._handleContinueAction,this));this.getDOMElement("confirm-redirection-popup-cancel-button").click(f.bind(this._handleCancelAction,this))},bindToEvents:function(){var a=this;a.widget.on("OpenRedirectionPopupEvent",a,function(b){a._redirectUrl=b.redirectUrl;"mobile"===a.widget.options.deviceType?a._openSecondaryView():a._openModal()});var b="mobile"===a.widget.options.deviceType?
"afterSlideOut":"afterHide";c.when("A").execute(function(c){c.on("a:popover:"+b+":"+a._jsComponentData.data.popoverName,function(b){a._shouldRedirect&&(g.location.href=a._redirectUrl,a._shouldRedirect=!1)})})},_handleContinueAction:function(){this._shouldRedirect=!0;this._handleCancelAction()},_openModal:function(){this.popover=new h(this.widget,this._jsComponentData,this);this.bindToElements()},_openSecondaryView:function(){var a=this;c.when("A","a-secondary-view").execute(function(b,c){b=b.$("#"+
a._jsComponentData.data.declarativeAction);a.popover=c.get(b);a.popover.show()})},_closeSecondaryView:function(){var a=this;c.when("a-secondary-view").execute(function(b){b&&(b=b.get(a._jsComponentData.data.popoverName))&&b.hide()})},_closeModal:function(){this.widget.trigger("confirm-redirection-popup-cancel-event")},_handleCancelAction:function(){"mobile"===this.widget.options.deviceType?this._closeSecondaryView():this._closeModal()}})})})()});
/* ******** */
(function(f){var c=window.AmazonUIPageJS||window.P,g=c._namespace||c.attributeErrors,a=g?g("APXWidgetsAssets@APXWidgets-DigitalWallet","APXWidgetsAssets"):c;a.guardFatal?a.guardFatal(f)(a,window):a.execute(function(){f(a,window)})})(function(f,c,g){(function(){var a=PaymentsPortal2.modules.define;a("components/AddDigitalWalletComponent",["events/form-submitted-event","jQuery","form-component","lang","AUI!P"],function(a,b,c,f,g){g.when("A","jQuery","a-dropdown").execute(function(a,b,h){a.declarative("a-popover-a11y",
"focusin",function(a){if(a=document.getElementById("pmts-add-digital-wallet-dropdown-with-grey-out-selected-wallet-native-id_0")){a=a.parentElement.parentElement.childElementCount;for(var b=0;b<a;b++){var e=document.getElementById("pmts-add-digital-wallet-dropdown-with-grey-out-selected-wallet-native-id_"+b);if(null!=e&&e.parentElement.classList.contains("deviceDisabled")&&"A"==e.tagName.toUpperCase()){for(var h=document.createElement("div"),d=0;d<e.attributes.length;d++)h.setAttribute(e.attributes[d].name,
e.attributes[d].value);h.textContent=e.textContent;e.parentElement.replaceChild(h,e)}}}})});return c.extend({_hasErrors:!1,initialize:function(a,b){this._action="add-digital-wallet";this._hasErrors=b.data.hasErrors},bindToElements:function(){this.getDOMElement("addDigitalWalletSubmitButton").click(f.bind(this._handleFormSubmission,this))},bindToEvents:function(){var d=this;d.widget.on(a,d,function(a){a.action===d._action&&b(d.getDOMElement("addDigitalWalletForm")).submit()})},_handleFormSubmission:function(b){var c=
this.form.validateForm(),f=this.getFormSubmissionParameters("addDigitalWalletFormContainer");0===c.length?this.widget.trigger(a,{event:b,submissionParameters:f,action:this._action}):b.preventDefault()}})});a("components/DigitalWalletDetailsSlotComponent",["component"],function(a){return a.extend({initialize:function(a,h){}})});a("components/SelectableDigitalWalletListComponent",["form-component"],function(a){return a});a("components/SelectableDigitalWalletListItemComponent",["components/SelectableDPMInstrumentListItemComponent"],
function(a){return a});a("components/DigitalWalletSleeveItemSlotComponent",["component"],function(a){return a.extend({_triggerFallbackToMPO:!1,initialize:function(a,c){this._triggerFallbackToMPO=c.data.triggerFallbackToMPO},bindToEvents:function(){var a=this;a.widget.on("componentsInitialized",a,function(){a._triggerFallbackToMPO&&a.widget.trigger("triggerFallbackToMPO")})}})})})()});
/* ******** */
(function(g){var e=window.AmazonUIPageJS||window.P,h=e._namespace||e.attributeErrors,c=h?h("APXWidgetsAssets@APXWidgets-ImportantMessageBox","APXWidgetsAssets"):e;c.guardFatal?c.guardFatal(g)(c,window):c.execute(function(){g(c,window)})})(function(g,e,h){(function(){var c=PaymentsPortal2.modules.define;c("components/ImportantMessageBoxComponent","component jQuery css-utils events/InstrumentRowSelectedEvent events/CreditCardIssuerDeterminedEvent events/CreditCardNumberResetEvent".split(" "),function(c,
d,f,e,g,h){return c.extend({initialize:function(a,b){this.messageDisplayConditionMap=b.data.messageDisplayConditionMap;this.messageGroupClass=b.data.messageGroupClass;this.messageGroupItemClass=b.data.messageGroupItemClass;this.shouldDisplayForMultitenderKey=b.data.shouldDisplayForMultitenderKey;this.displayForSpecificInstrumentIdsKey=b.data.displayForSpecificInstrumentIdsKey;this.displayForSpecificBrandsKey=b.data.displayForSpecificBrandsKey;this.isMultitenderSelected=!1;this.creditCardIssuerDetermined=
this.selectedInstrumentId="";this.refreshIMBDisplay()},bindToEvents:function(){this.widget.on(e,this,function(a){this.updateStateInstrumentChanged(a.instrumentId);this.refreshIMBDisplay()});this.widget.on("optionalInstrumentSelected",this,function(a){this.updateStateOptionalInstrumentChanged(!0,a.paymentMethod);this.refreshIMBDisplay()});this.widget.on("optionalInstrumentDeselected",this,function(a){this.updateStateOptionalInstrumentChanged(!1,a.paymentMethod);this.refreshIMBDisplay()});this.widget.on(g,
this,function(a){this.updateStateBrandChanged(a.issuer,a.cardType);this.refreshIMBDisplay()});this.widget.on(h,this,function(){this.updateStateBrandChanged("","");this.refreshIMBDisplay()})},updateStateInstrumentChanged:function(a){this.selectedInstrumentId="string"===typeof a&&a?a:""},updateStateOptionalInstrumentChanged:function(a,b){"string"===typeof b&&"GC"===b.toUpperCase()&&(this.isMultitenderSelected=a)},updateStateBrandChanged:function(a,b){this.creditCardIssuerDetermined="string"===typeof a&&
a&&'"CREDIT"'===b?a:""},refreshIMBDisplay:function(){var a=this,b=this.getDOMElements(),c=b.filter("."+this.messageGroupClass),b=b.filter("."+this.messageGroupItemClass);this.messageDisplayConditionMap&&b.each(function(b,k){if(b=a.messageDisplayConditionMap[d(k).attr("id")]){var c=!0;try{if(a.shouldHideMessageItemForInstrumentId(b,a.selectedInstrumentId)||a.shouldHideMessageItemForMultitender(b,a.isMultitenderSelected)||a.shouldHideMessageItemForBrand(b,a.creditCardIssuerDetermined))c=!1}catch(e){c=
!0}c?f.showElement(d(k)):f.hideElement(d(k))}});c.filter(function(a,b){return!f.hasAUIHiddenClass(d(b))}).filter(function(b,c){return 0===a.findVisibleMessageGroupItems(d(c)).length}).each(function(a,b){f.hideElement(d(b))});c.filter(function(a,b){return f.hasAUIHiddenClass(d(b))}).filter(function(b,c){return 0<a.findVisibleMessageGroupItems(d(c)).length}).each(function(a,b){f.showElement(d(b))})},shouldHideMessageItemForInstrumentId:function(a,b){return(a=a[this.displayForSpecificInstrumentIdsKey])&&
b&&!a.includes(b)},shouldHideMessageItemForMultitender:function(a,b){return!1===a[this.shouldDisplayForMultitenderKey]&&!0===b},shouldHideMessageItemForBrand:function(a,b){return(a=a[this.displayForSpecificBrandsKey])&&!a.includes(b)},findVisibleMessageGroupItems:function(a){return a.find("."+this.messageGroupItemClass).filter(function(a,c){return!1===f.hasAUIHiddenClass(d(c))})}})})})()});
/* ******** */
(function(c){var d=window.AmazonUIPageJS||window.P,b=d._namespace||d.attributeErrors,a=b?b("APXWidgetsAssets@APXWidgets-ReplenishmentPayments","APXWidgetsAssets"):d;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,d,b){(function(){var a=PaymentsPortal2.modules.define;a("components/ReplenishmentPaymentsComponent",["css-utils","lang","component","clog"],function(a,d,c,b){return c.extend({initialize:function(a,b){this.instrumentId=b.data.instrumentId;this.isDisplayable=
b.data.isDisplayable;this.recurringPaymentEligibilityJsBinding=b.data.recurringPaymentEligibilityJsBinding},bindToEvents:function(){this.widget.on("toggleRecurringPaymentEligibilityMessage",this,function(a){this.data.isDisplayable&&this.instrumentId===a.instrumentId&&(b.logCounterMetric({feature:"SPCRecurringIneligibleInstrumentSelect",resource:"_Count"}),b.publishMetrics())})}})})})()});
/* ******** */
(function(g){var d=window.AmazonUIPageJS||window.P,q=d._namespace||d.attributeErrors,c=q?q("APXWidgetsAssets@APXWidgets-GlobalInstallmentLending","APXWidgetsAssets"):d;c.guardFatal?c.guardFatal(g)(c,window):c.execute(function(){g(c,window)})})(function(g,d,q){(function(){var c=PaymentsPortal2.modules.define;c("components/SelectableGILListItemComponent","events/InstrumentRowSelectedEvent components/SelectablePaymentMethodListItemComponent components/POAInstrumentListItemComponent lang css-utils AUI!P jQuery".split(" "),
function(c,f,p,n,l,m,k){var g;return f.extend({initialize:function(a,b){g=b.data.hasInelgibleLineItemsInCart;this.financialOfferCalculationStringsMap=new Map;this.financialOfferDisplayLibraryMap=b.data.financialOfferDisplayLibraryMap;this.multiTenderDiscountAmountMap=b.data.multiTenderDiscountAmountMap;this.gcAmount=b.data.gcAmount.value;this.isCreditLine=b.data.isCreditLine;this.isMobile=b.data.isMobile;this._instrumentId=b.data.instrumentId;this.offerToAmountAllowedOnOtherPaymentMethodsMap=b.data.offerToAmountAllowedOnOtherPaymentMethodsMap;
this.promoAmount=b.data.promoAmount.value;this.showGCWarning=b.data.showGCWarning;this.showGCAndPromoWarning=b.data.showGCAndPromoWarning;this.showGCAndPromoWarningforCL=b.data.showGCAndPromoWarningforCL;this.stringIdMap=b.data.stringIdMap;this.isUpdateFinancialOfferCalculationsEnabled=b.data.isUpdateFinancialOfferCalculationsEnabled;this.showMultiTenderWarning=this.showGCWarning||this.showGCAndPromoWarning;this.currentSelectedFinancialOffer=this._getInitialSelectedFinancialOffer();this._setCurrencyUnit();
this._setFinancialOfferCalculationStringsMap()},_getInitialSelectedFinancialOffer:function(){var a=d.document.getElementById("selectedFinancialOfferHiddenInput");return a?a.value:""},_setCurrencyUnit:function(){this.currencyUnit="";this.offerToAmountAllowedOnOtherPaymentMethodsMap&&(this.currencyUnit=this.offerToAmountAllowedOnOtherPaymentMethodsMap[Object.keys(this.offerToAmountAllowedOnOtherPaymentMethodsMap)[0]].unit)},_chooseGILInstallmentOfferButtonClick:function(a){var b=k(a.currentTarget).find("input"),
e=this.getDOMElement("hiddenGILFinancialOfferIdInput");this.currentSelectedFinancialOffer=b.data("financialofferid");e.val(this.currentSelectedFinancialOffer);b=this.getDOMElement("selectGILOfferAccordionButton");a=k(a.currentTarget).find(".a-section").html();b.html(a);this.closeGilOffersAccordionPopover();this._setMultiTenderWarningMessages(this.currentSelectedFinancialOffer)},closeGilOffersAccordionPopover:function(){m.when("a-secondary-view").execute(function(a){a&&(a=a.get("gilOffersAccordionPopover"))&&
a.hide()})},_hideContainer:function(a){l.hideElement(this.getDOMElement(a))},_showContainer:function(a){l.showElement(this.getDOMElement(a))},_toggleContainers:function(a,b){l.toggleElement(this.getDOMElement(a),b)},_poaInstrumentSelected:function(){n.bind(f.prototype._poaInstrumentSelected,this).apply();this._toggleContainers("selectedFinancialOfferFormContainer",!0);this._toggleContainers("gilMultiTenderWarningsContainer",!0)},_poaInstrumentUnselected:function(){n.bind(f.prototype._poaInstrumentUnselected,
this).apply();this._toggleContainers("selectedFinancialOfferFormContainer",!1);this._toggleContainers("gilMultiTenderWarningsContainer",!1)},_instrumentRowSelected:function(a){n.bind(f.prototype._instrumentRowSelected,this).apply();a===this._instrumentId?this._poaInstrumentSelected():this._poaInstrumentUnselected()},_getWarningMessageElement:function(a){return d.document.getElementById(this._instrumentId+"-"+a)},_hasWarningMessageText:function(a){return a&&a.hasChildNodes()&&""!==a.childNodes[0].data.trim()},
_formatCurrencyInDisplayLibraryMap:function(a){var b=a.currencyCode||this.currencyUnit;a.totalPaymentAmount&&!a.totalPaymentAmount.includes(b)&&(a.totalPaymentAmount=this._formatCurrency(a.totalPaymentAmount,b));a.interestAmount&&!a.interestAmount.includes(b)&&(a.interestAmount=this._formatCurrency(a.interestAmount,b));a.averageMonthlyAmount&&!a.averageMonthlyAmount.includes(b)&&(a.averageMonthlyAmount=this._formatCurrency(a.averageMonthlyAmount,b));a.firstMonthAmount&&!a.firstMonthAmount.includes(b)&&
(a.firstMonthAmount=this._formatCurrency(a.firstMonthAmount,b));return a},_getFinancialOfferCalculationStringId:function(a){a=0===parseInt(a.apr,10)?"offer_calculation_zero_interest":"offer_calculation";this.isMobile&&(a="mobile_"+a);return this.stringIdMap[a]},_setFinancialOfferCalculationStringsMap:function(){for(var a in this.financialOfferDisplayLibraryMap){var b=new Map,e;for(e in this.financialOfferDisplayLibraryMap[a]){var h=this.financialOfferDisplayLibraryMap[a][e],h=this._formatCurrencyInDisplayLibraryMap(h);
b.set(e,this._getTranslatedString(this._getFinancialOfferCalculationStringId(h),h))}this.financialOfferCalculationStringsMap.set(a,b)}},_updateFinancialOfferCalculationStringsDesktop:function(a){var b=this;m.when("a-dropdown").execute(function(e){try{var h=e.getSelect("gilFinancialOffersDropdown"),f=h.getOptions().info();for(e=0;e<f.length;e++){var c=f[e].value,d=b.financialOfferCalculationStringsMap.get(a).get(c);h.getOption(e).update({text:d})}}catch(n){var d=b.financialOfferDisplayLibraryMap[a],
g,p,l,m;for(c in d)d=b.financialOfferCalculationStringsMap.get(a).get(c),h=k('a[data-value\x3d"'+c+'"]'),"a-active"===h.attr("class")&&(g=k('a[data-value\x3d"'+c+'"]').text(),p=d),f=k('option[value\x3d"'+c+'"]'),f[0].hasAttribute("selected")&&(l=k('option[value\x3d"'+c+'"]').text(),m=d),h.text(d),f.text(d);c=p?p:m;k('.a-dropdown-prompt:contains("'+(g?g:l)+'")').text(c)}})},_updateElementText:function(a,b){a=d.document.getElementById(a);a.removeChild(a.childNodes[0]);a.appendChild(d.document.createTextNode(b))},
_updateFinancialOfferCalculationStringsMobile:function(a){var b=this.financialOfferDisplayLibraryMap[a],e;for(e in b){var c=this._formatCurrencyInDisplayLibraryMap(b[e]),f=this.financialOfferCalculationStringsMap.get(a).get(e);this._updateElementText("accordionFinancialOfferCalculationText-"+e,f);this._updateElementText("accordionInterestText-"+e,this._getTranslatedString(this.stringIdMap.interest,c));this._updateElementText("accordionTotalInterestAmountText-"+e,this._getTranslatedString(this.stringIdMap.total_interest_amount,
c));e===this.currentSelectedFinancialOffer&&this._updateElementText("selectGILOfferAccordionButtonText",f)}},_updateFinancialOfferCalculationStrings:function(a){this.isMobile?this._updateFinancialOfferCalculationStringsMobile(a):this._updateFinancialOfferCalculationStringsDesktop(a)},_gcEventHandler:function(a){var b=this._getWarningMessageElement("gilMTWarningMessageGCTextId");this.gcWarningRendered?(this._hasWarningMessageText(b)?this._showContainer("gilGCWarning"):this._hideContainer("gilGCWarning"),
this.isCreditLine&&a&&this._updateFinancialOfferCalculationStrings("GiftCard")):this._hideContainer("gilGCWarning")},_promoEventHandler:function(a){var b=this._getWarningMessageElement("gilMTWarningMessagePromoTextId");this.promoWarningRendered?(this._hasWarningMessageText(b)?this._showContainer("gilPromoWarning"):this._hideContainer("gilPromoWarning"),this.isCreditLine&&a&&this._updateFinancialOfferCalculationStrings("Promo")):this._hideContainer("gilPromoWarning")},_gcAndPromoEventHandler:function(a){var b=
this._getWarningMessageElement("gilMTWarningMessageGCAndPromoContainerGCTextId"),e=this._getWarningMessageElement("gilMTWarningMessageGCAndPromoContainerPromoTextId");this.gcAndPromoWarningRendered?(this._hasWarningMessageText(b)&&this._hasWarningMessageText(e)?this._showContainer("gilGCAndPromoWarning"):this._hideContainer("gilGCAndPromoWarning"),this.isCreditLine&&a&&this._updateFinancialOfferCalculationStrings("GiftCardAndPromo")):this._hideContainer("gilGCAndPromoWarning")},_defaultMTEventHandler:function(a){!this.isCreditLine||
this.gcWarningRendered||this.promoWarningRendered||this.gcAndPromoWarningRendered||!a||this._updateFinancialOfferCalculationStrings("Default")},_setMultiTenderWarningStates:function(a){"GC"===a.paymentMethod?a.isSelected?this.promoWarningRendered?(this.promoWarningRendered=this.gcWarningRendered=0,this.gcAndPromoWarningRendered=1):this.gcWarningRendered=1:(this.gcWarningRendered=0,this.gcAndPromoWarningRendered&&(this.gcAndPromoWarningRendered=0,this.promoWarningRendered=1)):"PROMO"===a.paymentMethod&&
(a.isSelected?this.gcWarningRendered?(this.promoWarningRendered=this.gcWarningRendered=0,this.gcAndPromoWarningRendered=1):this.promoWarningRendered=1:(this.promoWarningRendered=0,this.gcAndPromoWarningRendered&&(this.gcAndPromoWarningRendered=0,this.gcWarningRendered=1)))},_hasDiscountDetailsMessageText:function(a){return a&&""!==a.textContent},_getFormattedDiscountAmount:function(){return this.gcAndPromoWarningRendered?this.multiTenderDiscountAmountMap.GiftCardAndPromo:this.gcWarningRendered?this.multiTenderDiscountAmountMap.GiftCard:
this.promoWarningRendered?this.multiTenderDiscountAmountMap.Promo:this.multiTenderDiscountAmountMap.Default},_getDiscountTranslatedString:function(a){return this.isMobile?this._getTranslatedString(this.stringIdMap.discount_offer_message_mobile,a):this._getTranslatedString(this.stringIdMap.discount_offer_message_desktop,a)},_discountOfferMessageHandler:function(){var a=d.document.getElementById(this._instrumentId+"-gilDiscountOfferTextId");if(this._hasDiscountDetailsMessageText(a)){var b=this._getFormattedDiscountAmount();
b&&(a.textContent=this._getDiscountTranslatedString({discountAmount:b}))}},_balanceSelectionEventHandler:function(a){this.showMultiTenderWarning&&(this._setMultiTenderWarningStates(a),this.showGCWarning&&this._gcEventHandler(this.isUpdateFinancialOfferCalculationsEnabled),this.showGCAndPromoWarning&&(this._promoEventHandler(this.isUpdateFinancialOfferCalculationsEnabled),this._gcAndPromoEventHandler(this.isUpdateFinancialOfferCalculationsEnabled)),this._defaultMTEventHandler(this.isUpdateFinancialOfferCalculationsEnabled));
this._discountOfferMessageHandler()},_formatCurrency:function(a,b){var e,c=b||this.currencyUnit;switch(c){case "EUR":b=",";e=".";break;default:b=".",e=","}a=c+" "+a.toString();return a=a.replace(".",b).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1"+e)},_getTranslatedString:function(a,b){return this.widget.getLocalizedString(a,b)},_updateWarningText:function(a,b){(a=this._getWarningMessageElement(a))&&a.childNodes&&a.childNodes.length&&(a.removeChild(a.childNodes[0]),a.appendChild(d.document.createTextNode(b)))},
_setGCWarningMessage:function(){var a=" ";this.amountOnOtherPaymentMethods<=this.gcAmount&&(a=this._getTranslatedString(this.stringIdMap.gift_card_info,{giftCardAmount:this._formatCurrency(this.amountOnOtherPaymentMethods)}));this._updateWarningText("gilMTWarningMessageGCTextId",a);this._gcEventHandler(!1)},_setPromoWarningMessage:function(){var a=" ";this.amountOnOtherPaymentMethods<=this.promoAmount&&(a=this._getTranslatedString(this.stringIdMap.promo_info,{promoAmount:this._formatCurrency(this.amountOnOtherPaymentMethods)}));
this._updateWarningText("gilMTWarningMessagePromoTextId",a);this._promoEventHandler(!1)},_setGCAndPromoWarningMessage:function(){var a=" ",b=" ";this.amountOnOtherPaymentMethods<=this.gcAmount+this.promoAmount&&(a=Math.round(100*(this.amountOnOtherPaymentMethods-this.promoAmount))/100,b=0<a?this._getTranslatedString(this.stringIdMap.gift_card_info,{giftCardAmount:this._formatCurrency(a<=this.gcAmount?a:this.gcAmount)}):this._getTranslatedString(this.stringIdMap.gift_card_unavailable),a=this._getTranslatedString(this.stringIdMap.promo_info,
{promoAmount:this._formatCurrency(this.amountOnOtherPaymentMethods<=this.promoAmount?this.amountOnOtherPaymentMethods:this.promoAmount)}));this._updateWarningText("gilMTWarningMessageGCAndPromoContainerPromoTextId",a);this._updateWarningText("gilMTWarningMessageGCAndPromoContainerGCTextId",b);this._gcAndPromoEventHandler(!1)},_setMultiTenderWarningMessages:function(a){a=this.offerToAmountAllowedOnOtherPaymentMethodsMap[a];!this.isCreditLine||"undefined"!==typeof this.amountOnOtherPaymentMethods&&
this.amountOnOtherPaymentMethods===a||(this.amountOnOtherPaymentMethods="undefined"===typeof a?Number.MAX_SAFE_INTEGER:a.value,this._setGCWarningMessage(),this._setPromoWarningMessage(),this._setGCAndPromoWarningMessage())},_gilOffersDropdownEventChangeHandler:function(a){this._setMultiTenderWarningMessages(a.value)},bindToEvents:function(){n.bind(f.prototype.bindToEvents,this).apply();var a=this;this.widget.on("gilCheckIneligibleItemsInCartEvent",this,function(){g&&this.widget.trigger("gilIneligibleItemsInCartEvent",
this.widget.getLocalizedString("apx_gil_cc_disabled_continue_button_hover_message"))});a.widget.on(c,a,function(b){a._instrumentRowSelected(b.instrumentId)});a.widget.on("balanceSelectionChanged",a,function(b){a._balanceSelectionEventHandler(b)});a.widget.on("gilOffersDropDownChangeEvent",a,function(b){a._gilOffersDropdownEventChangeHandler(b)});m.when("A").execute(function(b){b.declarative("chooseGILInstallemntOfferButton","click",function(b){a._chooseGILInstallmentOfferButtonClick(b.$event)});if(a.showGCAndPromoWarningforCL)b.on("a:dropdown:selected:ppw-selectedFinancialOfferId",
function(b){a.widget.trigger("gilOffersDropDownChangeEvent",b)})})}})});c("components/SelectableGILBAComponent",["form-component","jQuery","lang"],function(c,f,d){return c.extend({displayIneligibleItemsInMobile:function(c){this.widget.trigger("GILIneligibleSubPageEvent",{subtype:"StandaloneInstallment",error:function(c,d,g){f("#gil-ineligible-subpage-StandaloneInstallment-error").show()}})},bindToElements:function(){f("#gil-ineligible-subpage-StandaloneInstallment").click(d.bind(this.displayIneligibleItemsInMobile,
this))}})});c("components/SelectableGILCCComponent",["form-component","jQuery","lang"],function(c,f,d){return c.extend({displayIneligibleItemsInMobile:function(c){this.widget.trigger("GILIneligibleSubPageEvent",{subtype:"StandaloneCreditCardInstallment",error:function(c,d,g){f("#gil-ineligible-subpage-StandaloneCreditCardInstallment-error").show()}})},bindToElements:function(){f("#gil-ineligible-subpage-StandaloneCreditCardInstallment").click(d.bind(this.displayIneligibleItemsInMobile,this))}})});
c("components/SelectableGILCLComponent",["form-component","jQuery","lang"],function(c,d,g){return c.extend({displayIneligibleItemsInMobile:function(c){this.widget.trigger("GILIneligibleSubPageEvent",{subtype:"StandaloneReusableCreditLineInstallment",error:function(c,g,k){d("#gil-ineligible-subpage-StandaloneReusableCreditLine-error").show()}})},bindToElements:function(){d("#gil-ineligible-subpage-StandaloneReusableCreditLine").click(g.bind(this.displayIneligibleItemsInMobile,this))}})})})()});
/* ******** */
(function(l){var h=window.AmazonUIPageJS||window.P,m=h._namespace||h.attributeErrors,d=m?m("APXWidgetsAssets@APXWidgets-FoodVoucherCard","APXWidgetsAssets"):h;d.guardFatal?d.guardFatal(l)(d,window):d.execute(function(){l(d,window)})})(function(l,h,m){(function(){var d=PaymentsPortal2.modules.define;d("components/AddFoodVoucherCardComponent","events/form-submitted-event form-component lang AUI!P jQuery cc-spacing".split(" "),function(d,f,g,a,b,c){var e=/^[0-9]+$/;return f.extend({initialize:function(a,
b){this.addCardNumberId=b.data.addCardNumber;this.addSubmitButtonId=b.data.addSubmitButton;this.placementType=b.data.placementType;this.$addCardNumberInput=this.getDOMElement(this.addCardNumberId);this.hasErrors=b.data.hasErrors;this.addModalId=b.data.addModalId;this.addModalName=b.data.addModalName;this.queryParams=b.data.queryParams;this.addFormContainer=b.data.addFormContainer;this.addFormId=b.data.addFormId;this.widgetAction=b.data.widgetAction;this.addEvent=b.data.addEvent;this.isDesktop="desktop"===
a.options.deviceType},initPopoverState:function(){!0===this.hasErrors&&(this.isDesktop?this.getDOMElement(this.addModalId).trigger("click"):this.widget.trigger("showAddPaymentInstrumentPage"))},handleAddCardLikeDOMEvent:function(a){if(0===this.form.validateForm().length){this.closeAddPopover();var b=this.getFormSubmissionParameters(this.addFormContainer);this.widget.trigger(d,{queryParameters:this.queryParams,submissionParameters:b,event:a,action:this.widgetAction});return!0}a.preventDefault();return!1},
closeAddPopover:function(){var b=this;a.when("a-modal").execute(function(a){a&&(a=a.get(b.addModalName))&&a.hide()})},creditCardNumberChanged:function(a){var b=a.replace(/\s/g,"");if(e.test(b)&&(8===b.length||16===b.length)){a=a.replace(/\s/g,"").substring(0,8);for(var b=16-(a.length+1),c=0;c<b;c++)a=a.concat(Math.floor(10*Math.random()));for(var b=0,k=a.length-1;0<=k;k--)c=parseInt(a.charAt(k),10),0===k%2&&(c*=2,c=9<c?c-9:c),b+=c;a=a.concat(10-b%10);this.widget.trigger("creditCardNumberChanged",
{creditCardNumber:a,placementType:this.placementType})}},bindToElements:function(){this.getDOMElement(this.addSubmitButtonId).click(g.bind(this.handleAddCardLikeDOMEvent,this))},bindToEvents:function(){var a=this,e,f;this.$addCardNumberInput.keydown(function(a){e=this.value;f=this.selectionStart});this.$addCardNumberInput.change(function(a){this.value=c.fixSpacing(this.value)});this.$addCardNumberInput.keyup(function(b){"number"!==this.type&&this.value!==e&&(b=this.selectionStart,this.value=c.fixSpacing(this.value),
b=c.fixCaret(b,this.value,e,f),this.setSelectionRange(b,b),a.creditCardNumberChanged(this.value))});a.widget.on("componentsInitialized",a,function(a){this.initPopoverState()});a.widget.on(d,this,function(c){if(c.action===a.data.widgetAction){c=a.getDOMElement(a.addFormId);var e=b("\x3cinput\x3e").attr({type:"hidden",name:"ppw-widgetEvent:"+a.addEvent,value:"submit"});c.append(e);c.submit()}})}})});d("components/FoodVoucherCardInputAmountComponent",["css-utils","form-component","lang"],function(d,
f,g){return f.extend({initialize:function(a,b){this.instrumentId=b.data.instrumentId;this.inputAmountId=b.data.inputAmount;this.minSelectableAmount=b.data.minSelectableAmount;this.maxSelectableAmount=b.data.maxSelectableAmount;this.initialAmount=b.data.initialAmount;this.totalAmount=b.data.totalAmount;this.paymentMethodCode=b.data.paymentMethodCode;this.ineligibleAmount=this.remainingGcBalance=this.promoCodeAmount=this.giftCardAmount=0;this.isBacking=this.isCCSelected=this.isSelected=!1;this.currentMaxSelectableAmount=
this.maxSelectableAmount;this.inputAmount=this.getDOMElement(this.inputAmountId)},validationToErrorMap:{IsNumberFieldConstraint:"FailureInvalidInput",LessThanEqualFieldConstraint:"FailureGreaterThanMaxSelectable",GreaterThanEqualFieldConstraint:"FailureLessThanMinSelectable",CoverageCalculationFailedConstraint:"FailureBackingInstrumentIsRequired"},getErrorMessageContainer:function(){return this.getDOMElement("errorMessages")},resetFormErrorMessages:function(){var a=this;d.hideElement(a.getErrorMessageContainer());
g.forEachKeyValue(a.validationToErrorMap,function(b,c){a.form.resetErrorMessage(a.field,a.getDOMElement(c))},a)},displayFormErrorMessages:function(a){0!==a.length&&(a=a[0],a.field===this.inputAmountId&&(a=this.getDOMElement(this.validationToErrorMap[a.validation]),this.form.displayErrorMessage(this.inputAmountId,a)),d.showElement(this.getErrorMessageContainer()))},validateInputAmount:function(){var a;return this.getSelectedAmount()>this.currentMaxSelectableAmount?(a=this.widget.getLocalizedString("apx_food_voucher_error_gt_max_eligible",
{}),[{validation:"LessThanEqualFieldConstraint",field:this.inputAmountId,localizedMessageString:a,messageStringId:"apx_food_voucher_error_gt_max_eligible"}]):this.getSelectedAmount()<this.currentMaxSelectableAmount&&!this.isCCSelected?(a=this.widget.getLocalizedString("apx_food_voucher_error_backing_instrument_is_required",{}),[{validation:"CoverageCalculationFailedConstraint",field:this.inputAmountId,localizedMessageString:a,messageStringId:"apx_food_voucher_error_backing_instrument_is_required"}]):
[]},performCoverageCalculation:function(){this.currentMaxSelectableAmount=this.promoCodeAmount+this.giftCardAmount>=this.maxSelectableAmount?0:this.maxSelectableAmount-this.promoCodeAmount-this.giftCardAmount;this.widget.trigger("FoodVoucherCardMaxSelectableChangedEvent",{instrumentId:this.instrumentId,currentMaxSelectableAmount:this.currentMaxSelectableAmount})},checkForErrors:function(){this.resetFormErrorMessages();var a=this.form.validateForm().concat(this.validateInputAmount());0<a.length&&this.displayFormErrorMessages(a);
return this.isSelected?a.map(function(a){return a.localizedMessageString}):[]},backingInstrumentSelected:function(a){this.isBacking=!0;this.widget.trigger("backingInstrumentSelected",{instrumentId:this.instrumentId,errors:a,paymentMethod:this.paymentMethodCode})},backingInstrumentDeselected:function(a){this.widget.trigger("backingInstrumentSelected",{instrumentId:null,errors:a,paymentMethod:null})},optionalInstrumentSelected:function(a){this.isBacking=!1;a={instrumentId:this.instrumentId,errors:a,
paymentMethod:this.paymentMethodCode,balance:this.getSelectedAmount(),isBackingInstrument:this.isBacking};this.widget.trigger("optionalInstrumentSelected",a)},optionalInstrumentDeselected:function(a){this.widget.trigger("optionalInstrumentDeselected",{instrumentId:this.instrumentId})},fvcRowSelected:function(a){this.giftCardAmount>=this.totalAmount&&(this.giftCardAmount=0,this.widget.trigger("deselectGiftCardCheckbox",{paymentMethod:this.paymentMethodCode}));this.promoCodeAmount>=this.totalAmount&&
(this.promoCodeAmount=0,this.widget.trigger("deselectPromoBalanceInstrument",{paymentMethod:this.paymentMethodCode}));this.performCoverageCalculation();this.inputAmount.val(this.currentMaxSelectableAmount.toFixed(2));a=this.checkForErrors();this.getSelectedAmount()+this.giftCardAmount+this.promoCodeAmount>=this.totalAmount&&this.isCCSelected?(this.widget.trigger("resetSelectedPaymentMethod",{}),this.isCCSelected=!1,this.backingInstrumentSelected(a)):this.isCCSelected?this.optionalInstrumentSelected(a):
this.backingInstrumentSelected(a)},fvcRowDeselected:function(a){!0===this.isBacking?this.backingInstrumentDeselected(null):this.optionalInstrumentDeselected(null);this.isBacking=!1},inputAmountChanged:function(a){this.isSelected&&(this.performCoverageCalculation(),this.updateFoodVoucherCardSelection(),a=this.checkForErrors(),!0===this.isBacking?this.backingInstrumentSelected(a):this.optionalInstrumentSelected(a))},ccRowClicked:function(a){this.performCoverageCalculation();a=this.checkForErrors();
this.isSelected&&this.optionalInstrumentSelected(a)},amazonBalanceRowClicked:function(a){this.performAmazonBalanceAndPromoCalculation(a);this.inputAmountChanged(a)},performAmazonBalanceAndPromoCalculation:function(a){var b=a.isSelected?parseFloat(a.balance):0;"GC"===a.paymentMethod&&(this.giftCardAmount=b);"PROMO"===a.paymentMethod&&(this.promoCodeAmount=b)},updateFoodVoucherCardSelection:function(){this.giftCardAmount>=this.maxSelectableAmount||this.promoCodeAmount>=this.maxSelectableAmount?(this.isSelected=
!1,this.widget.trigger("FoodVoucherCardDeselectedByBalanceEvent",{instrumentId:this.instrumentId,currentMaxSelectableAmount:0})):(this.isSelected=!0,this.widget.trigger("FoodVoucherCardEnabledByBalanceEvent",{instrumentId:this.instrumentId,currentMaxSelectableAmount:this.currentMaxSelectableAmount}))},getSelectedAmount:function(){var a=Number(this.inputAmount.val());return isNaN(a)?0:a},bindToElements:function(){this.inputAmount.bind("keyup change",g.bind(this.inputAmountChanged,this))},bindToEvents:function(){var a=
this;a.widget.on("FoodVoucherCardRowClickedEvent",a,function(b){a.instrumentId===b.instrumentId&&(a.isSelected=b.isSelected,!0===a.isSelected?a.fvcRowSelected(b):a.fvcRowDeselected(b))});a.widget.on("balanceSelectionChanged",a,function(b){a.amazonBalanceRowClicked(b)});a.widget.on("backingInstrumentSelected",a,function(a){"CC"===a.paymentMethod?(this.isCCSelected=!0,this.ccRowClicked(a)):this.isBacking||(this.isCCSelected=!1)})}})});d("components/SelectableFoodVoucherCardListComponent",["events/InstrumentRowSelectedEvent",
"form-component","lang","css-utils"],function(d,f,g,a){return f.extend({initialize:function(a,c){this.initialError=c.data.initialError;this.warningMessagesContainer=this.getDOMElement(c.data.warningMessagesContainer);this.warningMessagesAlert=this.getDOMElement(c.data.warningMessagesAlert);this.errorMessagesContainer=this.getDOMElement(c.data.errorMessagesContainer);this.errorMessagesAlert=this.getDOMElement(c.data.errorMessagesAlert);this.renderInitialErrorMessage()},hideContainers:function(){a.hideElement(this.warningMessagesContainer);
a.hideElement(this.errorMessagesContainer)},showWarningMessage:function(b){this.warningMessagesContainer[0].getElementsByClassName("a-alert-content")[0].textContent=b;a.showElement(this.warningMessagesContainer)},showErrorMessage:function(b){this.errorMessagesContainer[0].getElementsByClassName("a-alert-content")[0].textContent=b;a.showElement(this.errorMessagesContainer)},bindToElements:function(){},renderInitialErrorMessage:function(){if(this.initialError){var a=this.widget.getLocalizedString(this.initialError,
{});this.showErrorMessage(a)}},bindToEvents:function(){var a=this;this.widget.on(d,this,function(c){a.hideContainers();"PayAgent"!==c.paymentMethodCategory||this.initialError?a.renderInitialErrorMessage():(a.widget.trigger("FoodVoucherCardDeselectedByPayCodeEvent",{}),c=a.widget.getLocalizedString("apx_food_voucher_warning_disabled_by_paycode",{}),a.showWarningMessage(c))});this.widget.on("installmentOptionChanged",this,function(c){a.hideContainers();this.initialError?a.renderInitialErrorMessage():
(a.widget.trigger("FoodVoucherCardChangedByInstallmentsEvent",{isEnabled:!c.isInstallmentOfferSelected}),c.isInstallmentOfferSelected&&(c=a.widget.getLocalizedString("apx_food_voucher_warning_disabled_by_installments",{}),a.showWarningMessage(c)))})}})});d("components/SelectableFoodVoucherCardListItemComponent",["form-component","lang","jQuery","css-utils","clog"],function(d,f,g,a,b){return d.extend({initialize:function(b,e){this.instrumentId=e.data.instrumentId;this.currency=e.data.currency;this.isUsable=
e.data.isUsable;this.containerId=e.data.container;this.detailsContainerId=e.data.detailsContainer;this.firstRowContainerId=e.data.firstRowContainer;this.eligibleAmountMessageId=e.data.eligibleAmountMessage;this.checkBoxId=e.data.checkBox;this.container=this.getDOMElement(this.containerId);this.detailsContainer=this.getDOMElement(this.detailsContainerId);this.firstRowContainer=this.getDOMElement(this.firstRowContainerId);this.eligibleAmountMessage=this.getDOMElement(this.eligibleAmountMessageId);this.checkBox=
this.getDOMElement(this.checkBoxId);this.isSelected=this.isDisabled=!1;a.toggleElement(this.detailsContainer,!1);this.checkBox.prop("checked",!1)},doNothing:function(a){a.preventDefault();a.stopPropagation()},firstRowContainerClicked:function(a){!this.isDisabled&&this.isUsable&&(this.selectRowContainer(!this.isSelected),this.widget.trigger("FoodVoucherCardRowClickedEvent",{instrumentId:this.instrumentId,isSelected:this.isSelected}),this.widget.trigger("poaInstrumentRowSelected",{instrumentId:null}),
b.logCounterMetric({feature:"FoodVoucherCardRowClickedEvent",resource:"_Count"}))},selectRowContainer:function(a){this.isSelected=a;this.toggleElement()},toggleElement:function(){this.checkBox.prop("checked",this.isSelected);a.toggleElement(this.detailsContainer,this.isSelected);this.isSelected?this.container.addClass("pmts-selected"):this.container.removeClass("pmts-selected")},renderEligibleAmountMessage:function(a){a=this.currency+" "+a.toFixed(2);a=this.widget.getLocalizedString("apx_food_voucher_eligible_amount",
{eligible_amount:a});this.eligibleAmountMessage.text(a)},enableRowContainer:function(a){this.isUsable&&(this.isDisabled=!a,a?(this.container.removeClass("pmts-disabled-section"),this.checkBox.prop("disabled",!1)):(this.container.addClass("pmts-disabled-section"),this.checkBox.prop("disabled",!0)))},bindToElements:function(){this.firstRowContainer.click(f.bind(this.firstRowContainerClicked,this));this.checkBox.click(f.bind(this.firstRowContainerClicked,this));this.detailsContainer.click(f.bind(this.doNothing,
this))},bindToEvents:function(){var a=this;this.widget.on("FoodVoucherCardRowClickedEvent",this,function(b){b.instrumentId!==this.instrumentId&&!0===this.isSelected&&a.selectRowContainer(!1)});this.widget.on("FoodVoucherCardDeselectedByBalanceEvent",this,function(a){this.selectRowContainer(!1)});this.widget.on("FoodVoucherCardDeselectedByPayCodeEvent",this,function(a){this.selectRowContainer(!1)});this.widget.on("FoodVoucherCardEnabledByBalanceEvent",this,function(a){this.renderEligibleAmountMessage(a.currentMaxSelectableAmount)});
this.widget.on("FoodVoucherCardMaxSelectableChangedEvent",this,function(a){this.renderEligibleAmountMessage(a.currentMaxSelectableAmount)});this.widget.on("FoodVoucherCardChangedByInstallmentsEvent",this,function(a){this.enableRowContainer(a.isEnabled);a.isEnabled||this.selectRowContainer(!1)})}})})})()});
/* ******** */
(function(h){var g=window.AmazonUIPageJS||window.P,k=g._namespace||g.attributeErrors,c=k?k("APXWidgetsAssets@APXWidgets-BLIKDirect","APXWidgetsAssets"):g;c.guardFatal?c.guardFatal(h)(c,window):c.execute(function(){h(c,window)})})(function(h,g,k){(function(){var c=PaymentsPortal2.modules.define;c("components/BlikAuthenticateComponent","css-utils jQuery form-component lang AUI!P clog ExecutionsWidgetUtils AjaxUtil".split(" "),function(b,c,m,f,n,d,p,l){var g,h,k;return m.extend({initialize:function(a,
e){a=e.data.isBlikOneClick;this.dynamicContinueFormDescription=e.data.dynamicContinueFormDescription;this.isBlikOneClick=a;this.pollFundingSourceCounter=this.retries=0;a?(g=new Date((new Date).getTime()+9E4),this._pollForCollectApiStatus()):(b.hideElement(this.getDOMElement("BlikAuthenticateSpinner")),b.hideElement(this.getDOMElement("BlikAuthenticateOTPExpired")),b.hideElement(this.getDOMElement("BlikAuthenticateOTPInvalid")),b.hideElement(this.getDOMElement("add-blik-modal-trigger")),b.hideElement(this.getDOMElement("BlikAuthenticateOTPValidationErrorMessage")),
b.hideElement(this.getDOMElement("CompleteTransactionInBlikAppMessage")),this._disableSubmitButton())},_handleFormSubmission:function(){if(this.getDOMElement("ConfirmBlikButton").hasClass("a-button-disabled"))event.preventDefault();else return this._publishMetric("BlikAuthenticateConfirmButtonClickedCount"),console.log("inside _handleFormSubmission. logging retires"+this.retries),0===this.form.validateForm().length&&(this._publishMetric("BlikAuthenticateFormSubmittedCount"),this.widget.trigger("blikAuthenticateFormSubmitted")),
!1},_showBlikPopoverModal:function(){var a=this;n.when("A","a-modal","ready").execute(function(e,d){a.getDOMElement("add-blik-modal-trigger").click()});this._disableSubmitButton();this.getDOMElement("BlikAuthenticateOTPInputBox").attr("disabled","disabled");b.showElement(this.getDOMElement("CompleteTransactionInBlikAppMessage"));h=(new Date).getTime()},_validateAllCharactersAreDigit:function(a){return/^\d+$/.test(a)},_disableSubmitButton:function(){this.getDOMElement("ConfirmBlikButton").attr("disabled",
"disabled");this.getDOMElement("ConfirmBlikButton").addClass("a-button-disabled")},_enableSubmitButton:function(){this.getDOMElement("ConfirmBlikButton").removeAttr("disabled");this.getDOMElement("ConfirmBlikButton").removeClass("a-button-disabled")},_handleInputEvent:function(a){var e=this.form.getFormValues().__sif_encrypted_stripe_blik_otp;6===e.length&&this._validateAllCharactersAreDigit(e)?(this._enableSubmitButton(),13===a.which&&this.getDOMElement("ConfirmBlikButton").click()):this._disableSubmitButton();
0===e.length||this._validateAllCharactersAreDigit(e)?(b.hideElement(this.getDOMElement("BlikAuthenticateOTPExpired")),b.hideElement(this.getDOMElement("BlikAuthenticateOTPInvalid")),b.hideElement(this.getDOMElement("BlikAuthenticateOTPValidationErrorMessage"))):b.showElement(this.getDOMElement("BlikAuthenticateOTPValidationErrorMessage"))},_pollForValidateOTPStatus:function(){var a=this;l.continueRequestWithPolling({widget:a.widget,inputData:{"ppw-widgetEvent":"BlikValidateOtpEvent","ppw-__sif_encrypted_stripe_blik_otp":a.form.getFormValues().__sif_encrypted_stripe_blik_otp,
"ppw-widgetState":a.widget.options.serializedState},queryParameters:a.widget._whitelistedQueryParameters("?sif_profile\x3dStripe_Blik_SIF_Profile"),retryDelayFn:function(){return 9E3},isResponseExpectedFn:function(a){return a.fsStatus&&a.fsDetailedStatus},onSuccessFn:function(e){a._publishSuccessMetric("BlikAuthenticatePollForValidateOtpSuccessCount");a._handleValidateOTPFundingSourceStatus(e)},onErrorFn:function(){a._publishErrorMetric("BlikAuthenticatePollForValidateOtpErrorCount")},retryFailedFn:function(){a._publishMetric("BlikAuthenticatePollForValidateOtpRetriesExhaustedCount");
a.fireBlikAuthenticateCompleteEvent("BlikValidateOtpApiFailureEvent")},retryLimit:2})},_handleValidateOTPFundingSourceStatus:function(a){var e=a.fsStatus.toUpperCase();"PENDING"!==e&&b.hideElement(this.getDOMElement("BlikAuthenticateSpinner"));switch(e){case "APPROVED":this._publishMetric("BlikAuthenticateFundingSourceStatusApprovedCount");this.fireBlikAuthenticateCompleteEvent("BlikAuthenticateApproveEvent");break;case "PENDING":this._handleValidateOTPFundingSourceDetailedStatus(a.fsDetailedStatus);
break;case "DECLINED":this._publishMetric("BlikAuthenticateFundingSourceStatusDeclinedCount");this.fireBlikAuthenticateCompleteEvent("BlikAuthenticateDeclineEvent");break;case "CANCELLED":this._publishMetric("BlikAuthenticateFundingSourceStatusCancelledCount");this.fireBlikAuthenticateCompleteEvent("BlikAuthenticateDeclineEvent");break;default:this._publishMetric("BlikAuthenticateFundingSourceStatus"+e),this.fireBlikAuthenticateCompleteEvent("BlikAuthenticateDeclineEvent")}},_handleValidateOTPFundingSourceDetailedStatus:function(a){"Accepted"!==
a&&b.hideElement(this.getDOMElement("BlikAuthenticateSpinner"));switch(a){case "Accepted":this._publishMetric("BlikAuthenticateAcceptedBlikOtpCount");k=(new Date).getTime();this._pollBlikValidateOTPFundingSourceDetailedStatus();break;case "ApprovedPendingVerification":this._publishMetric("BlikAuthenticateApprovedBlikOtpCount");this._showBlikPopoverModal();g=new Date((new Date).getTime()+9E4);console.log("Auth Expiry time: "+g);this._pollBlikFundingSourceStatus();break;case "OneTimePasswordInvalid":this._publishMetric("BlikAuthenticateInvalidBlikOtpCount");
b.showElement(this.getDOMElement("BlikAuthenticateOTPInvalid"));this.isEnterBlikOtpAttemptsExhausted();break;case "OneTimePasswordExpired":this._publishMetric("BlikAuthenticateExpiredBlikOtpCount");b.showElement(this.getDOMElement("BlikAuthenticateOTPExpired"));this.isEnterBlikOtpAttemptsExhausted();break;default:this._publishMetric("BlikAuthenticateUndefinedFsDetailedStatusCount"),this.isEnterBlikOtpAttemptsExhausted(),this.fireBlikAuthenticateCompleteEvent("BlikUndefinedFsDetailedStatusEvent")}},
_pollBlikValidateOTPFundingSourceDetailedStatus:function(){var a=this;l.continueRequestWithPolling({widget:a.widget,inputData:{"ppw-widgetEvent":"BlikPollFundingSourceStatusEvent","ppw-widgetState":a.widget.options.serializedState},retryDelayFn:function(){return 1E3},isResponseExpectedFn:function(a){return a.fsStatus&&a.fsDetailedStatus&&"Accepted"!==a.fsDetailedStatus},onSuccessFn:function(e){a._publishSuccessMetric("BlikAuthenticatePollForFundingSourceDetailedStatusSuccessCount");a._publishLatencyMetric("BlikAuthenticatePollTimeForFundingSourceDetailedStatus"+
e.fsDetailedStatus,k);a._handleValidateOTPFundingSourceStatus(e)},onErrorFn:function(){a._publishErrorMetric("BlikAuthenticatePollForFundingSourceDetailedStatusErrorCount")},retryFailedFn:function(){a._publishMetric("BlikAuthenticatePollForFundingSourceDetailedStatusRetriesExhaustedCount");a.fireBlikAuthenticateCompleteEvent("BlikValidateOtpApiFailureEvent")},retryLimit:10})},_pollBlikFundingSourceStatus:function(){var a=this;l.continueRequestWithPolling({widget:a.widget,inputData:{"ppw-widgetEvent":"BlikPollFundingSourceStatusEvent",
"ppw-widgetState":a.widget.options.serializedState},retryDelayFn:function(){return 1E3},isResponseExpectedFn:function(e){a.pollFundingSourceCounter++;console.log("pollFundingSourceCounter: "+a.pollFundingSourceCounter);return e.fsStatus&&"true"===e.fundingSourceInTerminalState},onSuccessFn:function(e){a._publishMetricForBlikPaymentMethod("BlikAuthenticatePollForFundingSourceStatusSuccessCount","BlikOneClickAuthenticatePollForFundingSourceStatusSuccessCount",a._publishSuccessMetric);a._publishLatencyMetric("BlikWaitingForAuthenticationPopOverModalVisibleTime",
h);"APPROVED"===e.fsStatus.toUpperCase()?a.fireBlikAuthenticateCompleteEvent("BlikAuthenticateApproveEvent"):a.fireBlikAuthenticateCompleteEvent("BlikAuthenticateDeclineEvent")},onErrorFn:function(){a._publishMetricForBlikPaymentMethod("BlikAuthenticatePollForFundingSourceStatusErrorCount","BlikOneClickAuthenticatePollForFundingSourceStatusErrorCount",a._publishErrorMetric)},retryFailedFn:function(){a._publishMetricForBlikPaymentMethod("BlikAuthenticatePollForFundingSourceRetriesExhaustedCount","BlikOneClickAuthenticatePollForFundingSourceRetriesExhaustedCount",
a._publishMetric);a._pollForCollectApiStatus()},retryLimit:10})},_pollForCollectApiStatus:function(){var a=this;l.continueRequestWithPolling({widget:a.widget,inputData:{"ppw-widgetEvent":"BlikCollectEvent","ppw-widgetState":a.widget.options.serializedState,"ppw-timeForCustomerActionIsExpired":(new Date).getTime()>g.getTime()?"true":"false"},retryDelayFn:function(){return 1E3},isResponseExpectedFn:function(a){return a.collectApiSucceeded&&"true"===a.collectApiSucceeded},onSuccessFn:function(){a._publishMetricForBlikPaymentMethod("BlikAuthenticatePollForCollectApiSuccessCount",
"BlikOneClickAuthenticatePollForCollectApiSuccessCount",a._publishSuccessMetric);a._checkTransactionAuthorizationTLE()?a.fireBlikAuthenticateCompleteEvent("BlikTransactionAuthorizationTleEvent"):a._pollBlikFundingSourceStatus()},onErrorFn:function(){a._publishMetricForBlikPaymentMethod("BlikAuthenticatePollForCollectApiErrorCount","BlikOneClickAuthenticatePollForCollectApiErrorCount",a._publishErrorMetric)},retryFailedFn:function(){a._publishMetricForBlikPaymentMethod("BlikAuthenticatePollForCollectApiRetriesExhaustedCount",
"BlikOneClickAuthenticatePollForCollectApiRetriesExhaustedCount",a._publishMetric);a._checkTransactionAuthorizationTLE()?a.fireBlikAuthenticateCompleteEvent("BlikTransactionAuthorizationTleEvent"):a._pollBlikFundingSourceStatus()},retryLimit:1})},_checkTransactionAuthorizationTLE:function(){var a=(new Date(g.getTime()+6E4)).getTime();if(45<this.pollFundingSourceCounter)return this._publishMetric("BlikAuthenticatePollForFsCountLimitReachedCount"),console.log("poll fs count limit reached"),!0;if((new Date).getTime()>
a)return this._publishMetric("BlikAuthenticatePollForFsTimeLimitReachedCount"),console.log("poll fs time limit reached"),!0;console.log("continue polling");return!1},fireBlikAuthenticateCompleteEvent:function(a){p.dynamicContinueWithEvent(a,this.widget.options.serializedState,[],this.dynamicContinueFormDescription,this.widget.getRootDOMElements().last())},bindToElements:function(){var a=this;this.getDOMElement("ConfirmBlikButton").click(f.bind(this._handleFormSubmission,this));c(this.getDOMElement("BlikAuthenticateOTPInputBox")).bind("input keypress",
function(d){a._handleInputEvent(d)})},isEnterBlikOtpAttemptsExhausted:function(){3<=this.retries&&(this._publishMetric("BlikAuthenticateEnterBlikOtpAttemptsExhaustedCount"),this.fireBlikAuthenticateCompleteEvent("BlikValidateOtpMaxAttemptsExhaustedEvent"))},bindToEvents:function(){var a=this;a.widget.on("blikAuthenticateFormSubmitted",a,function(){a.retries++;a._publishMetric("BlikAuthenticateOTPAttemptCount."+a.retries);b.showElement(this.getDOMElement("BlikAuthenticateSpinner"));a._disableSubmitButton();
a._pollForValidateOTPStatus()})},_publishMetricForBlikPaymentMethod:function(a,d,b){b(this.isBlikOneClick?d:a)},_publishMetric:function(a){d.logCounterMetric({feature:a,resource:"_Count"});d.publishMetrics()},_publishSuccessMetric:function(a){d.logCounterMetric({feature:a,resource:"_SuccessCount"});d.publishMetrics()},_publishErrorMetric:function(a){d.logCounterMetric({feature:a,resource:"_ErrorCount"});d.publishMetrics()},_publishLatencyMetric:function(a,b){d.logLatencyMetric({feature:a,resource:"_Latency",
startTime:b});d.publishMetrics()}})});c("AjaxUtil",["jQuery","lang"],function(b,c){return{continueRequestWithPolling:function(b){this.widget=b.widget;this.inputData=b.inputData;this.onErrorFn=b.onErrorFn||c.NOOP;this.onSuccessFn=b.onSuccessFn||c.NOOP;this.isResponseExpectedFn=b.isResponseExpectedFn||function(){return!0};this.retryFailedFn=b.retryFailedFn||b.onErrorFn;this.retryLimit=isNaN(b.retryLimit)?15:b.retryLimit;this.retryDelayFn=b.retryDelayFn||function(){return 1E3};this.queryParameters=b.queryParameters;
this.continueRequest(0)},continueRequest:function(b){var f=this;f.widget.continueRequest(f.inputData,{headers:{"executions-widget-ajax-continue-attempt-count":b},retryDelayFn:f.retryDelayFn,queryParameters:f.queryParameters,success:function(c){var d=c.additionalWidgetResponseData.additionalData;if(f.isResponseExpectedFn(d))f.onSuccessFn(d);else b<f.retryLimit?g.setTimeout(function(){var d=c.additionalWidgetResponseData.additionalData.widgetState;d&&(f.inputData["ppw-widgetState"]=d);f.continueRequest(++b)},
f.retryDelayFn(b)):f.retryFailedFn(c)},error:f.onErrorFn})}}});c("components/AddBlikDirectComponent",["events/form-submitted-event","jQuery","form-component","lang","AUI!P"],function(b,c,g,f,h){return g.extend({_hasErrors:!1,initialize:function(b,c){this._action=c.data.action;this._hasErrors=c.data.hasErrors},_initPopoverState:function(){"true"===this._hasErrors&&this.getDOMElement("addBlikDirectPopoverLink").trigger("click")},bindToElements:function(){this.getDOMElement("addBlikDirectSubmitButton").click(f.bind(this._handleFormSubmission,
this))},bindToEvents:function(){var d=this;d.widget.on("componentsInitialized",d,function(b){this._initPopoverState()});d.widget.on(b,d,function(b){b.action===d._action&&c(d.getDOMElement("addBlikDirectForm")).submit()})},_handleFormSubmission:function(d){var c=this.form.validateForm(),f=this.getFormSubmissionParameters("addBlikDirectFormContainer");0===c.length?(this.widget.trigger(b,{event:d,submissionParameters:f,action:this._action}),this.closeAddBlikPopover()):d.preventDefault()},closeAddBlikPopover:function(){h.when("a-modal").execute(function(b){b&&
(b=b.get("addBlikDirectPopover"))&&b.hide()})}})});c("components/SelectableBlikDirectListComponent",["form-component"],function(b){return b});c("components/SelectableBlikDirectListItemComponent",["components/SelectableDPMInstrumentListItemComponent","events/InstrumentRowSelectedEvent","jQuery"],function(b,c){return b.extend({bindToEvents:function(){var b=this;b.widget.on(c,b,function(c){b._instrumentRowSelected(c.instrumentId)})}})})})()});
/* ******** */
(function(c){var d=window.AmazonUIPageJS||window.P,e=d._namespace||d.attributeErrors,a=e?e("APXWidgetsAssets@APXWidgets-BusinessInvoicing","APXWidgetsAssets"):d;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,d,e){(function(){var a=PaymentsPortal2.modules.define;a("components/SelectableBusinessInvoicingListComponent",["form-component"],function(a){return a});a("components/SelectableBusinessInvoicingListItemComponent",["components/SelectableDPMInstrumentListItemComponent"],
function(a){return a});a("components/BusinessInvoicingActivationWorkflowComponent",["modal-popover","component"],function(a,d){return d.extend({initialize:function(d,c){this.popover=new a(d,c,this)}})});a("components/SelectableBusinessInstantInvoicingListComponent",["form-component"],function(a){return a});a("components/SelectableBusinessInstantInvoicingListItemComponent","css-utils jQuery form-component lang AUI!P clog modal-popover components/SelectableDPMInstrumentListItemComponent events/close-secure-container-event events/InstrumentRowSelectedEvent".split(" "),
function(a,d,c,e,g,l,m,h,k,f){return h.extend({bindToEvents:function(){if(this._isPreselected)this.widget.on("componentsInitialized",this,function(){this.widget.trigger(f,{instrumentId:this._instrumentId})});this.widget.on("poaInstrumentRowSelected",this,function(b){this._instrumentRowSelected(b.instrumentId)});this.widget.on(f,this,function(b){this._instrumentRowSelected(b.instrumentId)})},bindToElements:function(){var b=this,a={"ppw-widgetState":b.widget.options.serializedState,"ppw-widgetEvent":"AddInstantInvoiceMetadataEvent"},
c=b.getDOMElement("addInstantInvoicingButton");1===c.length&&c.click(function(c){var e=b.getFormSubmissionParameters("addInstantInvoicingFormContainer");console.log("Form data",e);d.each(e,function(b,c){"ppw-widgetState"!==c.name&&"ppw-widgetEvent"!==c.name&&(a[c.name]=c.value)});c.preventDefault();b.widget.submitFormAJAX(a)});b.getDOMElementsByPrefix("POAInstrumentContainer").click(function(a){d(a.currentTarget).data("disabled")||b.poaInstrumentClicked(b._instrumentId)});b.widget.on("initializeRecommendedInstrument",
b,function(a){a.instrumentId===b._instrumentId&&(b.getDOMElementsByPrefix("POAInstrumentContainer").data("disabled")||b._poaInstrumentSelected())});c=this.getDOMElement("cancelAddInstantInvoicingButton");1===c.length&&c.click(function(){b.closeAddInstantInvoicingPopOverPopover({force:!0});b.widget.publishSuccessSushiMetrics({ActionType:"CancelAddInstantInvoicePopup",ActionValueType:"Click",ActionValue:"CancelButtonClicked",ActionParentValueType:"PurchaseDocument",ActionParentValue:b._purchaseId})})},
closeAddInstantInvoicingPopOverPopover:function(a){this.widget.trigger(k,a);g.when("a-modal").execute(function(a){a&&(a=a.get("pbi2"))&&a.hide()})}})})})()});
/* ******** */
(function(b){var c=window.AmazonUIPageJS||window.P,d=c._namespace||c.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-ShowAllPaymentOptions","APXWidgetsAssets"):c;a.guardFatal?a.guardFatal(b)(a,window):a.execute(function(){b(a,window)})})(function(b,c,d){(function(){var a=PaymentsPortal2.modules.define;a("components/ShowAllPaymentOptionsComponent",["component","public-event-registry","clog"],function(a,c,b){return a.extend({initialize:function(){c.register("ShowAllPaymentOptionsEvent")},_getContainerElement:function(){return this.getDOMElement("ShowAllPaymentOptionsComponent")},
bindToElements:function(){var a=this;a._getContainerElement().click(function(){b.logCounterMetric({feature:"ShowAllPaymentOptionsClicked",resource:"_Count"});b.publishMetrics();a.widget.publishSuccessSushiMetrics({ActionType:"ShowAllPaymentOptionsClicked",ActionValueType:"PaymentOptions",ActionValue:"ShowAllPaymentOptionsClickedEvent"});a.widget.trigger("ShowAllPaymentOptionsEvent")})}})})})()});
/* ******** */
(function(d){var c=window.AmazonUIPageJS||window.P,e=c._namespace||c.attributeErrors,a=e?e("APXWidgetsAssets@APXWidgets-Ideal","APXWidgetsAssets"):c;a.guardFatal?a.guardFatal(d)(a,window):a.execute(function(){d(a,window)})})(function(d,c,e){(function(){var a=PaymentsPortal2.modules.define;a("components/IdealDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,b){this._paymentMethodId=b.data.paymentMethodId;this._paymentMethodType=
b.data.paymentMethodType},bindToElements:function(){this._bindEditPMLink()}})});a("components/IdealEditComponent",["component","EditComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,c){b._initializePopover(a,c,this)},bindToEvents:function(){b._bindPopoverCloseButtonClickedEvent(this)}})});a("components/IdealSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,b){this._instrumentId=b.data.instrumentId}})})})()});
/* ******** */
(function(b){var c=window.AmazonUIPageJS||window.P,d=c._namespace||c.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-PaymentArt","APXWidgetsAssets"):c;a.guardFatal?a.guardFatal(b)(a,window):a.execute(function(){b(a,window)})})(function(b,c,d){(function(){var a=PaymentsPortal2.modules.define;a("components/PaymentArtComponent",["component","jQuery","AUI!P"],function(a,c,b){return a.extend({initialize:function(a,b){this.shouldDownloadImageAfterPageLoad=b.data.shouldDownloadImageAfterPageLoad;this.paymentArtImageElement=
this.getDOMElement("paymentArtImageReference")},bindToEvents:function(){this.shouldDownloadImageAfterPageLoad&&this.downloadImageAfterPageLoad()},downloadImageAfterPageLoad:function(){var a=this;b.when("A","jQuery","load").execute("manual-load-image",function(b){b.loadHiResImage(a.paymentArtImageElement)})}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-BusinessPaymentProducts","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/AddBusinessCardAdvertisementComponent",["component","lang"],function(a,b){return a.extend({})})})()});
/* ******** */
(function(h){var g=window.AmazonUIPageJS||window.P,f=g._namespace||g.attributeErrors,e=f?f("APXWidgetsAssets@APXWidgets-AmazonPayEMI","APXWidgetsAssets"):g;e.guardFatal?e.guardFatal(h)(e,window):e.execute(function(){h(e,window)})})(function(h,g,f){(function(){var e=PaymentsPortal2.modules.define;e("components/AmazonPayEMIComponent","component jQuery lang css-utils events/InstrumentRowSelectedEvent public-event-registry continuable AUI!P".split(" "),function(e,g,h,d,k,m,n,l){return e.extend(n,{isAPBWithEMIEnabled:!1,
installmentOfferBOsWithoutAPB:[],installmentOfferBOsWithAPB:[],isPaylastEligible:!1,isAmazonPayEMIDisabled:!1,isPayLaterAvailable:!1,showFloatingContinueBarOnNonPaylastPSP:!1,isPayLaterDisabledForSIRedirection:!1,isNCEPromtionForAPLOneMonthTenureWeblabEnabled:!1,isAPLPreselectedInTurbo:!1,strategyBasedRecommendationWeblabTreatment:"C",initialize:function(a,b){this.currentInstrumentId=b.data.instrumentId;this.isNomenclatureWave2Enabled=b.data.isNomenclatureWave2Enabled;this.aplPaymentMethodCategory=
b.data.aplPaymentMethodCategory;this.availableAPLBalance=b.data.availableBalance;this.isAmazonPayEMIDisplayable=b.data.isDisplayable;this.isAmazonPayEMIDisabled=b.data.isDisabled;this.strategyBasedRecommendationWeblabTreatment=b.data.strategyBasedRecommendationWeblabTreatment;this.isAmazonPayEMIDisabled&&this._disableAmazonPayEMIOption();this.isPayLaterDisabledForSIRedirection=b.data.isPayLaterDisabledForSIRedirection;this.isAPBWithEMIEnabled=b.data.isAPBWithEMIEnabled;(this.isPayLaterAvailable=b.data.isPayLaterAvailable)&&
m.register(k);this.installmentOfferBOsWithoutAPB=b.data.installmentOfferBOsWithoutAPB;this.installmentOfferBOsWithAPB=b.data.installmentOfferBOsWithAPB;this.isPaylastEligible=b.data.isPaylastEligible;this.showFloatingContinueBarOnNonPaylastPSP=b.data.showFloatingContinueBarOnNonPaylastPSP;this._hideAmazonPayEMINoCostEMIAvailableWrapper();this.isBuyNowPayLaterSlotEnabledForDesktop=b.data.isBuyNowPayLaterSlotEnabledForDesktop;this.isNCEPromtionForAPLOneMonthTenureWeblabEnabled=b.data.isNCEPromtionForAPLOneMonthTenureWeblabEnabled;
this.isAPLPreselectedInTurbo=b.data.isAPLPreselectedInTurbo;"T1"!==this.strategyBasedRecommendationWeblabTreatment&&"T2"!==this.strategyBasedRecommendationWeblabTreatment&&"T3"!==this.strategyBasedRecommendationWeblabTreatment||this._onInstrumentDeselected()},_isAmazonPayBalanceSelected:function(){return this.widget.get("apbCheckboxSelected")},_isAmazonPayEmiAvailable:function(){return this._isAmazonPayBalanceSelected()&&this.isAPBWithEMIEnabled&&0!==this.installmentOfferBOsWithAPB.length?!0:this._isAmazonPayBalanceSelected()||
0===this.installmentOfferBOsWithoutAPB.length?!1:!0},_getAmazonPayEMIContainer:function(){return this.getDOMElementsByPrefix("amazonPayEMIContainer")},_getInstrumentSelectionInputElement:function(){return this.getDOMElement("instrumentRowSelection-"+this.currentInstrumentId)},_showEMIMessageForTurbo:function(){var a=this.getDOMElement("emiHelpStringRowTurbo");a!==f&&d.showElement(a)},_hideEMIMessageForTurbo:function(){var a=this.getDOMElement("emiHelpStringRowTurbo");a!==f&&d.hideElement(a)},_getAmazonPayEMITitleSlotJSBinding:function(){return this.getDOMElement("aplTitleSlot")},
_getAmazonPayEMIIconSlotJSBinding:function(){return this.getDOMElement("aplIconSlot")},_getAmazonPayRadioButtonJSBinding:function(){return this.getDOMElement("aplRadioButton")},_onInstrumentSelected:function(){this._getAmazonPayEMIContainer().addClass("pmts-selected");this._getInstrumentSelectionInputElement().prop("checked",!0);this.isNomenclatureWave2Enabled&&this._getAmazonPayEMITitleSlotJSBinding().addClass("pmts-payment-method-title-slot");(this.isPaylastEligible||this.showFloatingContinueBarOnNonPaylastPSP)&&
this._resetOrderTotalComputation();this._showEMIMessageForTurbo()},_resetOrderTotalComputation:function(){this.widget.trigger("UpdateOrderTotalForIBDEvent",{ibdAmountDisplayed:0});this.widget.trigger("UpdateOrderTotalForNoCostEMIDiscount",{noCostEMIValue:0})},_onInstrumentDeselected:function(){this.isNomenclatureWave2Enabled&&this._getAmazonPayEMITitleSlotJSBinding().removeClass("pmts-payment-method-title-slot");this._getAmazonPayEMIContainer().removeClass("pmts-selected");this._hideEMIMessageForTurbo();
this.hideEMIMessage();this._hideAmazonPayEMILimitUpdateConsentMessage()},_amazonPayEMIOptionClicked:function(a){this._isAmazonPayBalanceSelected()&&!this.isAPBWithEMIEnabled||this.widget.trigger(k,{instrumentId:this.currentInstrumentId})},_showAmazonPayEMIDisabledWrapper:function(){d.showElement(this.getDOMElement("amazonCreditUnavailableMessage"))},_showAmazonPayEMIDropdownWrapper:function(a){d.showElement(this.getDOMElement("amazonPayEMIDropdown"))},_hideAmazonPayEMIDisabledWrapper:function(){d.hideElement(this.getDOMElement("amazonCreditUnavailableMessage"))},
_hideAmazonPayEMIDropdownWrapper:function(a){d.hideElement(this.getDOMElement("amazonPayEMIDropdown"))},_showAmazonPayEMINoCostEMIAvailableWrapper:function(){d.showElement(this.getDOMElement("noCostEMIStringRow"))},_hideAmazonPayEMINoCostEMIAvailableWrapper:function(){d.hideElement(this.getDOMElement("noCostEMIStringRow"))},_showAmazonPayEMILimitUpdateConsentMessage:function(){d.showElement(this.getDOMElement("amazonpayEMILimitUpdateConsentMessage"))},_hideAmazonPayEMILimitUpdateConsentMessage:function(){d.hideElement(this.getDOMElement("amazonpayEMILimitUpdateConsentMessage"))},
_getAmazonPayEMIInstallmentHiddenInput:function(a){return this.getDOMElement("amazonPayEMISelectionHiddenInput-"+a).add(this.getDOMElement("amazonPayEMISelectionHiddenInput-"))},_getPrimaryViewButtonDisplay:function(a){return this.getDOMElement("amazonPayEMIOfferButtonText-"+a).add(this.getDOMElement("amazonPayEMIOfferButtonText-"))},_getAmazonPayEMIInstallmentTouchLink:function(a){return this.getDOMElement("amazonPayEMIMobileTouchLink-"+a).add(this.getDOMElement("amazonPayEMIMobileTouchLink-"))},
_triggerBackingInstrumentSelectedEvent:function(a,b){this.widget.trigger("backingInstrumentSelected",{instrumentId:a,paystationPaymentMethodCategory:this.aplPaymentMethodCategory,availableAPLBalance:this.availableAPLBalance,installmentOfferBOsWithoutAPB:this.installmentOfferBOsWithoutAPB,errors:b})},closeAmazonPayEMIInstallmentsSecondaryPopover:function(a){l.when("a-secondary-view").execute(function(b){b&&(b=b.get("amazonPayEMISecondaryPopover-"+a))&&b.hide()});this._triggerBackingInstrumentSelectedEvent(this.currentInstrumentId,
null)},_updateInstallmentOptionsAccordionStateToLastSelectedInstallment:function(a){a=this.currentInstrumentId;var b=this._getAmazonPayEMIInstallmentHiddenInput(a)[0].value;g("[data-a-accordion-name\x3d'installmentOptionsAccordion-"+a+"'] [data-a-accordion-row-name\x3d'"+("installmentOptionAccordionRow-"+a+b)+"'] a").click()},_chooseInstallmentButtonClick:function(a,b,c){b=this.currentInstrumentId;c=g(a.currentTarget);a=c.find("input");c=c.find(".a-section").html();var d=a.data("instrumentid").toString();
b===d&&(this._displaySelectedInstallmentPlan(a,c),this.displayEMIMessage())},getSelectedInstallmentOfferBO:function(a,b){var c=null;a&&(c=a.filter(function(a){return a.financialOfferId===b})[0]);return c},getEligibleInstallmentOfferBOs:function(){return this._isAmazonPayBalanceSelected()?this.installmentOfferBOsWithAPB:this.installmentOfferBOsWithoutAPB},_displaySelectedInstallmentPlan:function(a,b){var c=this.currentInstrumentId,d=a.data("instrumentid").toString();if(c===d){this._getAmazonPayEMIInstallmentHiddenInput(c).val(a.data("financialofferid"));
this._getPrimaryViewButtonDisplay(c).html(b);if(this.isPaylastEligible||this.showFloatingContinueBarOnNonPaylastPSP)""!==a.data("financialofferid")?this.triggerEventToUpdateOrderTotalForNCEDiscount(a.data().financialofferid):this.widget.trigger("UpdateOrderTotalForNoCostEMIDiscount",{noCostEMIValue:0,instrumentId:this.currentInstrumentId});this.isBuyNowPayLaterSlotEnabledForDesktop&&this.widget.trigger("installmentPlanSelectedForDesktop",{instrumentId:c,displayHtml:b});this.isAPBWithEMIEnabled&&this.widget.trigger("installmentPlanChanged",
{instrumentId:c,displayHtml:b,installmentPlanId:a.data("financialofferid")});a=c.split(".").join("-");this.installmentSelected=!0;this._hideAmazonPayEMINoCostEMIAvailableWrapper();this.closeAmazonPayEMIInstallmentsSecondaryPopover(a)}},_getAmazonPayEMIAvailableLimit:function(){return this.getDOMElement("amazonpayEMIAvailableLimit")},_isInstrumentSelected:function(){return this._getAmazonPayEMIContainer().hasClass("pmts-selected")},_getAmazonPayEMIHeading:function(){return this.getDOMElement("amazonPayEMIHeading")},
_toggleAmazonPayEMIOption:function(a){this.isAPBWithEMIEnabled||0!==this.installmentOfferBOsWithoutAPB.length&&!this._isAmazonPayBalanceSelected()||this._disableAmazonPayEMIOption();if(!this._isAmazonPayBalanceSelected()||this.isAPBWithEMIEnabled)this._hideAmazonPayEMIDisabledWrapper(),this._hideAmazonPayEMINoCostEMIAvailableWrapper(),this._getAmazonPayEMIHeading().removeClass("pmts-disabled-section"),this._getAmazonPayEMIAvailableLimit().removeClass("pmts-disabled-section"),this.isNomenclatureWave2Enabled&&
(this._getAmazonPayEMIIconSlotJSBinding().removeClass("pmts-disabled-section"),this._getAmazonPayEMITitleSlotJSBinding().removeClass("pmts-disabled-section"),this._getAmazonPayRadioButtonJSBinding().removeClass("pmts-disabled-section")),this._getInstrumentSelectionInputElement().prop("disabled",!1);this._isInstrumentSelected()&&!this._isAmazonPayEmiAvailable()&&(this._onInstrumentDeselected(),this._getInstrumentSelectionInputElement().prop("checked",!1),this.widget.trigger(k,{}),this.setContinuable(!1),
this.widget.trigger("PaymentPlanSelected",{isValid:!1}));this.isAPBWithEMIEnabled&&this._isAmazonPayBalanceSelected()&&0===this.installmentOfferBOsWithAPB.length?this._disableAmazonPayEMIOption():this._isAmazonPayBalanceSelected()||0!==this.installmentOfferBOsWithoutAPB.length||this._disableAmazonPayEMIOption();this.isPayLaterDisabledForSIRedirection&&this._disableAmazonPayEMIOption()},_disableAmazonPayEMIOption:function(){this.isPayLaterDisabledForSIRedirection?this._hideAmazonPayEMIDisabledWrapper():
this._showAmazonPayEMIDisabledWrapper();this._hideAmazonPayEMIDropdownWrapper();this._hideAmazonPayEMINoCostEMIAvailableWrapper();this._getAmazonPayEMIHeading().addClass("pmts-disabled-section");this._getAmazonPayEMIAvailableLimit().addClass("pmts-disabled-section");this.isNomenclatureWave2Enabled&&(this._getAmazonPayEMIIconSlotJSBinding().addClass("pmts-disabled-section"),this._getAmazonPayRadioButtonJSBinding().addClass("pmts-disabled-section"),this._getAmazonPayEMITitleSlotJSBinding().addClass("pmts-disabled-section"));
this._getInstrumentSelectionInputElement().prop("disabled",!0);this.hideEMIMessage();this._hideAmazonPayEMILimitUpdateConsentMessage()},_enableAmazonPayEMIOption:function(){this._onInstrumentSelected();this.isOnlyOneMonthTenurePresent()?this._hideAmazonPayEMIDropdownWrapper():this._showAmazonPayEMIDropdownWrapper();this._hideAmazonPayEMINoCostEMIAvailableWrapper();this.displayEMIMessage();this.installmentSelected=!0;this._hideAmazonPayEMIDisabledWrapper();this.installmentSelected&&(this._triggerBackingInstrumentSelectedEvent(this.currentInstrumentId,
null),this._hideAmazonPayEMINoCostEMIAvailableWrapper(),this.triggerEventToUpdateKFSInfo());this._showAmazonPayEMILimitUpdateConsentMessage()},isOnlyOneMonthTenurePresent:function(){return this._isAmazonPayBalanceSelected()&&1===this.installmentOfferBOsWithAPB.length&&1===this.installmentOfferBOsWithAPB[0].numberOfInstallments||!this._isAmazonPayBalanceSelected()&&1===this.installmentOfferBOsWithoutAPB.length&&1===this.installmentOfferBOsWithoutAPB[0].numberOfInstallments},hasNoCostEMIInstallmentsExcludingOneMonthPlan:function(a){return a.filter(function(a){return 1!==
a.numberOfInstallments&&a.maybeOfferDiscountAmount&&0<a.maybeOfferDiscountAmount.value})[0]},isNCEPlan:function(a){return 1===a.numberOfInstallments&&a.maybeOfferDiscountAmount&&0<a.maybeOfferDiscountAmount.value},getInstallmentStartMonth:function(a){return("undefined"!==typeof a.maybeInstallmentStartTime.year&&null!==a.maybeInstallmentStartTime.year?new Date(a.maybeInstallmentStartTime.year,a.maybeInstallmentStartTime.monthValue-1,a.maybeInstallmentStartTime.dayOfMonth):new Date(1E3*a.maybeInstallmentStartTime)).toLocaleString("default",
{month:"short"})},getOneMonthDisplayString:function(a){var b="";null!==a.maybeInstallmentStartTime&&(b={month:this.getInstallmentStartMonth(a)},b=this.isNCEPromtionForAPLOneMonthTenureWeblabEnabled&&this.isNCEPlan(a)?this.widget.getLocalizedString("apx_payselect_installment_row_pay_later_selected_nocost",b):this.widget.getLocalizedString("apx_payselect_installment_row_pay_later_selected",b));return b},displayEMIMessage:function(){var a=this._getAmazonPayEMIInstallmentHiddenInput(this.currentInstrumentId);
if(a[0]!==f){var b=a[0].value,a="",c=this.getEligibleInstallmentOfferBOs();if(b=this.getSelectedInstallmentOfferBO(c,b))1===b.numberOfInstallments?a=1<c.length&&this.hasNoCostEMIInstallmentsExcludingOneMonthPlan(c)!==f?this.widget.getLocalizedString("apx_amazon_pay_emi_nocostemi_available"):1<c.length?this.widget.getLocalizedString("apx_amazon_pay_later_emi_available"):1===c.length?this.getOneMonthDisplayString(b):"":null!==b.maybeInstallmentStartTime?(a={month:this.getInstallmentStartMonth(b)},a=
this.widget.getLocalizedString("apx_amazon_pay_later_emi_starts_from",a)):a="";""!==a&&this.showEMIMessage(a)}},showEMIMessage:function(a){var b=this.getDOMElement("emiHelpStringRow");this.getDOMElement("emiHelpMessage").html(a);d.showElement(b)},hideEMIMessage:function(){d.hideElement(this.getDOMElement("emiHelpStringRow"))},triggerEventToUpdateOrderTotalForNCEDiscount:function(a){var b=this.getEligibleInstallmentOfferBOs();if(a=this.getSelectedInstallmentOfferBO(b,a))(a=a.maybeOfferDiscountAmount)&&
0<a.value?this.widget.trigger("UpdateOrderTotalForNoCostEMIDiscount",{noCostEMIValue:Math.round(a.value)}):this.widget.trigger("UpdateOrderTotalForNoCostEMIDiscount",{noCostEMIValue:0})},triggerEventToUpdateKFSInfo:function(){var a=this._getAmazonPayEMIInstallmentHiddenInput(this.currentInstrumentId);a[0]!==f&&this.widget.trigger("updateKfsInfo",{instrumentId:this.currentInstrumentId,installmentPlanId:a[0].value})},bindToEvents:function(){var a=this;this.getDOMElementsByPrefix("amazonPayEMIContainer").click(h.bind(this._amazonPayEMIOptionClicked,
this));a.widget.on(k,this,function(a){if(a.instrumentId!==this.currentInstrumentId||this.isAmazonPayEMIDisabled||this._isAmazonPayBalanceSelected()&&!this.isAPBWithEMIEnabled){if(this._onInstrumentDeselected(),this._hideAmazonPayEMIDropdownWrapper(),!this._isAmazonPayBalanceSelected()||this.isAPBWithEMIEnabled)this._hideAmazonPayEMINoCostEMIAvailableWrapper(),this.isAPBWithEMIEnabled&&this._isAmazonPayBalanceSelected()&&0===this.installmentOfferBOsWithAPB.length?this._hideAmazonPayEMINoCostEMIAvailableWrapper():
this.isAPBWithEMIEnabled&&!this._isAmazonPayBalanceSelected()&&0===this.installmentOfferBOsWithoutAPB.length&&this._hideAmazonPayEMINoCostEMIAvailableWrapper(),this.isAmazonPayEMIDisabled&&this._disableAmazonPayEMIOption()}else this.isAPBWithEMIEnabled?(this._isAmazonPayBalanceSelected()&&0<this.installmentOfferBOsWithAPB.length&&this._enableAmazonPayEMIOption(),!this._isAmazonPayBalanceSelected()&&0<this.installmentOfferBOsWithoutAPB.length&&this._enableAmazonPayEMIOption()):this._enableAmazonPayEMIOption()});
if(this.isPaylastEligible||this.showFloatingContinueBarOnNonPaylastPSP)a.widget.on("GetNoCostEMISelectionDiscountValue",a,function(b){b.instrumentId===a.currentInstrumentId&&(b=this._getCreditCardInstallmentMobileHiddenInput(b.instrumentId))&&0<b.length&&this.triggerEventToUpdateOrderTotalForNCEDiscount(b[0].value)});a.widget.on("initializeRecommendedInstrument",a,function(b){b.instrumentId===a.currentInstrumentId&&(b=this._getAmazonPayEMIContainer(),0<b.length&&b.click())});a.widget.on("apbSelectionChanged",
a,function(b){this.hideEMIMessage();this.isAmazonPayEMIDisplayable&&(this.isAPBWithEMIEnabled&&this._isInstrumentSelected()?(this._onInstrumentDeselected(),this._getInstrumentSelectionInputElement().prop("checked",!1),this.widget.trigger(k,{}),this.setContinuable(!1),this.widget.trigger("PaymentPlanSelected",{isValid:!1}),this._isAmazonPayBalanceSelected()&&0===this.installmentOfferBOsWithAPB.length?b=a.widget.getLocalizedString("apx_amazon_pay_later_deselect_apb_to_use_pay_later_message"):this._isAmazonPayBalanceSelected()||
0!==this.installmentOfferBOsWithoutAPB.length?(b=a.widget.getLocalizedString("apx_payselect_apb_plus_emi_feature_emi_plan_change_message"),this.triggerEventToUpdateKFSInfo()):b=a.widget.getLocalizedString("apx_amazon_pay_later_select_apb_to_use_pay_later_message"),this.widget.trigger("ChangeInAPBSelectionAfterInstallmentPlanSelectionEvent",{message:b})):this._toggleAmazonPayEMIOption(b))});a.widget.on("updatePrimaryButtonDisplayString",this,function(a){if(this.currentInstrumentId===a.instrumentId){var c=
this._getPrimaryViewButtonDisplay(this.currentInstrumentId),d=this._getAmazonPayEMIInstallmentHiddenInput(a.instrumentId);""===a.displayString&&(a.displayString=this.widget.getLocalizedString("apx_amazon_pay_emi_sec_view_default_text"));c.html(a.displayString);d.val(a.installmentPlanId)}});l.when("A","a-modal").execute(function(b,c){b.on("a:popover:afterHide:amazonPayEMISecondaryPopover-"+this.currentInstrumentId,function(a){this._updateInstallmentOptionsAccordionStateToLastSelectedInstallment(a)});
b.declarative("chooseInstallmentButton","click",function(d){a._chooseInstallmentButtonClick(d.$event,b,c)})})}})})})()});
/* ******** */
(function(k){var e=window.AmazonUIPageJS||window.P,l=e._namespace||e.attributeErrors,c=l?l("APXWidgetsAssets@APXWidgets-PayWithCash","APXWidgetsAssets"):e;c.guardFatal?c.guardFatal(k)(c,window):c.execute(function(){k(c,window)})})(function(k,e,l){(function(){var c=PaymentsPortal2.modules.define;c("components/SelectablePayWithCashListComponent","events/InstrumentRowSelectedEvent css-utils component AUI!P jQuery clog".split(" "),function(n,c,e,h,f,g){return e.extend({initialize:function(a,b){this.isNTAExperience=
b.data.isNTAExperience;this.currentInstrumentId=b.data.currentInstrumentId;this.selectedInstrumentId=b.data.selectedInstrumentId;this.optionExperimentTreatment=b.data.optionExperimentTreatment||"C";this._isMobile="mobile"===a.options.deviceType;this.paywithcashPopoverId="select-pay-with-cash-options-popover-"+b.data.popOverId;this.isPayOnPickupEnabled=b.data.isPayOnPickupEnabled},bindToElements:function(){var a=this;h.when("A","a-modal","ready").execute(function(b){b.on("a:popover:beforeShow:"+a.paywithcashPopoverId,
function(d){d.popover&&(a.paywithcashPopover=d.popover.$popover,a._isMobile&&a.paywithcashPopover.addClass("pay-with-cash-option-pop-over"));a.getDOMElement("select-pay-with-cash-option-continue-button").click(function(d){a.handleOptionSelectionContinueButtonEvent(d)});a.getDOMElementsByPrefix("pay-with-cash-option").change(function(d){a.disableEnableOptionsContinueButton(!1)})});b.on("a:popover:beforeHide:"+a.paywithcashPopoverId,function(d){d.popover&&(a.paywithcashPopover=d.popover.$popover,a._isMobile&&
a.paywithcashPopover.removeClass("pay-with-cash-option-pop-over"));a.paywithcashPopover=null})})},handleOptionSelectionContinueButtonEvent:function(a){var b=this;a.preventDefault();a.stopImmediatePropagation();b.getDOMElement("select-pay-with-cash-option-continue-button").hasClass("a-button-disabled")||(h.when("a-modal").execute(function(a){b.paywithcashPopover&&((a=f(b.paywithcashPopover.find("[data-action]\x3da-popover-close")[0]))&&a.trigger("click"),b.paywithcashPopover=null)}),this.getDOMElementsByPrefix("pay-with-cash-option").find("input").each(function(a,
m){m.checked&&(b.currentInstrumentId=m.value,b.selectedInstrumentId=m.value,b.isNTAExperience?(b.isNTAExperience=!1,b.widget.trigger("PayWithCashSetReturnCustomer",b.currentInstrumentId)):b.triggerSelectedOptionEvent(!1))}))},triggerSelectedOptionEvent:function(a){!this.isNTAExperience&&this.currentInstrumentId&&(this.widget.trigger("payWithCashOptionSelected",this.currentInstrumentId,a),c.showElement(this.getDOMElement("psp-pay-with-cash-list-container")));this.isNTAExperience?c.showElement(this.getDOMElement("psp-pay-with-cash-nta-experience")):
c.hideElement(this.getDOMElement("psp-pay-with-cash-nta-experience"))},disableEnableOptionsContinueButton:function(a){this.getDOMElementsByPrefix("select-pay-with-cash-option-continue-button").toggleClass("a-button-disabled",!!a)},bindToEvents:function(){var a=this;this.widget.on("payWithCashShowOptions",this,function(b){a.disableEnableOptionsContinueButton(!0);a.getDOMElementsByPrefix("pay-with-cash-option").find("input").each(function(d,b){b.value!==a.selectedInstrumentId||b.hasAttribute("disabled")||
(b.checked=!0,a.disableEnableOptionsContinueButton(!1))});a.optionViewInstance?a.optionViewInstance.show():a.getDOMElement("select-pay-with-option-trigger").click();g.logCounterMetric({feature:"PayWithCashOptionsClicked",resource:"_Count"});this.widget.publishSuccessSushiMetrics({ActionType:"PayWithCashOptionsClicked",ActionValueType:"isPayOnPickupEnabled",ActionValue:(a.isPayOnPickupEnabled||!1).toString(),ActionParentValueType:"PurchaseDocument",ActionParentValue:b});this.widget.publishSuccessSushiMetrics({ActionType:"PayWithCashOptionsClicked",
ActionValueType:"optionExperimentTreatment",ActionValue:a.optionExperimentTreatment,ActionParentValueType:"PurchaseDocument",ActionParentValue:b});g.publishMetrics()});this.widget.on("PayWithCashSetReturnCustomerUpdated",this,function(b){this.currentInstrumentId=b;a.triggerSelectedOptionEvent(!1)});this.widget.on("componentsInitialized",this,function(){a.triggerSelectedOptionEvent(!0)})}})});c("components/SelectablePayWithCashListItemComponent","components/SelectableDPMInstrumentListItemComponent events/InstrumentRowSelectedEvent modal-popover css-utils clog lang".split(" "),
function(c,e,k,h,f,g){return c.extend({initialize:function(a,b){this.isCashOptionSelected=b.data.isCashOptionSelected;this.paymentMethod=b.data.paymentMethod;this._purchaseId=b.data.purchaseId;this.isOptionWindowEnabled=b.data.isOptionWindowEnabled},bindToElements:function(){var a=this;a.getDOMElement("pay-with-cash-option-selection-link").click(function(b){b.preventDefault();b.stopImmediatePropagation();a.openOptionsWindow()});c.prototype.bindToElements.apply(this)},bindToEvents:function(){var a=
this;this.widget.on("payWithCashOptionSelected",this,function(b,d){a.showHideCurrentInstrument(a._instrumentId===b);if((!d||a.isCashOptionSelected)&&a._instrumentId===b){try{a.isCashOptionSelected||(f.logCounterMetric({feature:"PayWithCashOptionSelected."+a.paymentMethod,resource:"_Count"}),f.publishMetrics())}catch(m){}a.poaInstrumentClicked(b,!a.isCashOptionSelected,d||a.isCashOptionSelected);a.isCashOptionSelected=!1}});c.prototype.bindToEvents.apply(this)},openOptionsWindow:function(){this.widget.trigger("payWithCashShowOptions",
this._purchaseId)},publishSushiMetrics:function(a,b,d){d=g.isDefined(d)&&"boolean"===typeof d?d.toString():d;this.widget.publishSuccessSushiMetrics({ActionType:a,ActionValueType:b,ActionValue:d,ActionParentValueType:"PurchaseDocument",ActionParentValue:this._purchaseId})},showHideCurrentInstrument:function(a){a?h.showElement(this.getDOMElementsByPrefix("POAInstrumentContainer-")):h.hideElement(this.getDOMElementsByPrefix("POAInstrumentContainer-"))}})});c("components/SelectablePayWithCashPayCodeListItemComponent",
["components/SelectablePayWithCashListItemComponent","events/InstrumentRowSelectedEvent","css-utils","lang","clog"],function(c,e,k,h,f){return c.extend({initialize:function(c,a){this.isPayCodeMultiTenderEnabled=a.data.isPayCodeMultiTenderEnabled;this.paymentMethod=a.data.paymentMethod},bindToElements:function(){var g=this;this.getDOMElement("pmts-paywithcash-paycode-partner-store-link").click(function(a){a.stopImmediatePropagation();a.preventDefault();g.getDOMElement("pmts-paywithcash-paycode-partner-store-popover-trigger").trigger("click")});
c.prototype.bindToElements.apply(g)},poaInstrumentClicked:function(c,a,b){a=h.isDefined(a)?a:!1;if(!a&&!b&&this.isOptionWindowEnabled)return this.openOptionsWindow();this.widget.trigger(e,{instrumentId:c,isPayCodeMultiTenderEnabled:this.isPayCodeMultiTenderEnabled,paymentMethod:this.paymentMethod});f.logCounterMetric({feature:"AmazonPayCodeMultiTender"+(this.isPayCodeMultiTenderEnabled?".Enabled":".Disabled"),resource:"_Count"});this.publishSushiMetrics("PayWithCashOptionSelected."+this.paymentMethod,
"isSelectedFromOption",a);f.publishMetrics()}})});c("components/SelectablePayWithCashPayOnPickupListItemComponent","components/SelectablePayWithCashListItemComponent events/InstrumentRowSelectedEvent continuable css-utils lang AUI!P jQuery clog".split(" "),function(c,k,l,h,f,g,a,b){return c.extend(l,{initialize:function(a,b){this.isLocationInformationAvailable=b.data.isLocationInformationAvailable;this.locationSelectorURL=b.data.locationSelectorURL;this.paymentMethod=b.data.paymentMethod;this.isPayOnPickupMultiTenderEnabled=
b.data.isPayOnPickupMultiTenderEnabled;this.isPayOnPickupPreSelected=b.data.isPayOnPickupPreSelected;this._isMobile="mobile"===a.options.deviceType},bindToElements:function(){var a=this;g.when("A","a-modal","ready").execute(function(c){c.on("a:popover:beforeShow:copu-select-pickup-location-popover",function(c){document.getElementById("pay-on-pickup-location-selector-iframe").src=a.locationSelectorURL;c.popover&&(a.locationSelectorPopover=c.popover.$popover);try{b.logCounterMetric({feature:"PayOnPickupLocationSelectorOpen",
resource:"_Count"}),a.publishSushiMetrics("PayOnPickupLocationSelectorOpen","payOnPickupLocationInfoAvailable",a.isLocationInformationAvailable),b.publishMetrics(),c.preventDefault(),c.stopImmediatePropagation()}catch(m){}})});a.getDOMElement("copu-pickup-location-selector-link").click(function(b){b.stopImmediatePropagation();b.preventDefault();a.getDOMElement("copu-pickup-location-selector-trigger").trigger("click")});a.widget.on("initializeRecommendedInstrument",a,function(b){if(b.instrumentId===
a._instrumentId)if(a.isPayOnPickupPreSelected)a.getDOMElementsByPrefix("POAInstrumentContainer").data("disabled")||a._poaInstrumentSelected();else return APX.events.STOP_EVENT_PROCESSING});c.prototype.bindToElements.apply(a)},bindToEvents:function(){var a=this;a.widget.on("initializeRecommendedInstrument",a,function(b){b.instrumentId===a._getInstrumentId()&&a.isPayOnPickupPreSelected?a._onInstrumentSelected():a._onInstrumentDeselected()});this.widget.on("PayWithCashSetReturnCustomer",this,function(b){a.triggerCustomerEvent("PayWithCashSetReturnCustomerEvent",
b)});var b=f.bind(this._processLocationSelectorMessage,this);f.addEventListener(e,"message",b);c.prototype.bindToEvents.apply(this)},_processLocationSelectorMessage:function(a){if(a.origin===document.location.origin)try{"CONFIRM_PICKUP_LOCATION"===JSON.parse(a.data).name&&this.locationIsSelected()}catch(b){}},locationIsSelected:function(){var b=this;g.when("a-modal").execute(function(c){if(b.locationSelectorPopover){if(c=a(b.locationSelectorPopover.find("[data-action]\x3da-popover-close")[0]))c.trigger("click"),
b.triggerCustomerEvent("PayOnPickupLocationSelectedEvent",b._instrumentId);b.locationSelectorPopover=null}})},poaInstrumentClicked:function(a,b,c){var e=this;b=f.isDefined(b)?b:!1;if(!b&&!c&&e.isOptionWindowEnabled)return this.openOptionsWindow();this.widget.trigger(k,{instrumentId:a,isPayOnPickupMultiTenderEnabled:this.isPayOnPickupMultiTenderEnabled,paymentMethod:this.paymentMethod});b&&!e.isLocationInformationAvailable&&(e._isMobile?setTimeout(function(){e.getDOMElement("copu-pickup-location-selector-trigger").trigger("click")},
100):e.getDOMElement("copu-pickup-location-selector-trigger").trigger("click"));this.publishSushiMetrics("PayWithCashOptionSelected."+e.paymentMethod,"payOnPickupLocationInfoAvailable",e.isLocationInformationAvailable)},triggerCustomerEvent:function(a,b){var c=this;c.widget.submitFormAJAX({"ppw-widgetEvent":a,"ppw-instrumentId":c._instrumentId,"ppw-widgetState":c.widget.options.serializedState},{success:function(){c.widget.trigger("PayWithCashSetReturnCustomerUpdated",b)},error:function(){console.log("Update failed")},
resumeContinueQueueOnError:!0})},_triggerBackingInstrumentSelectedEvent:function(){if(this.isLocationInformationAvailable&&"false"!==this.isLocationInformationAvailable)c.prototype._triggerBackingInstrumentSelectedEvent.apply(this);else{var a=[this.widget.getLocalizedString("pay_on_pickup_psp_select_location_error_message")];this.widget.trigger("backingInstrumentSelected",{instrumentId:self._instrumentId,errors:a,paymentMethod:self._paymentMethodCode})}}})})})()});
/* ******** */
(function(d){var c=window.AmazonUIPageJS||window.P,e=c._namespace||c.attributeErrors,a=e?e("APXWidgetsAssets@APXWidgets-Swish","APXWidgetsAssets"):c;a.guardFatal?a.guardFatal(d)(a,window):a.execute(function(){d(a,window)})})(function(d,c,e){(function(){var a=PaymentsPortal2.modules.define;a("components/SwishComponent",["component"],function(a){return a.extend({initialize:function(){}})});a("components/SelectableSwishListComponent",["form-component"],function(a){return a});a("components/SelectableSwishListItemComponent",
["components/SelectableDPMInstrumentListItemComponent","events/InstrumentRowSelectedEvent"],function(a,b){return a.extend({bindToEvents:function(){if(this._isPreselected)this.widget.on("componentsInitialized",this,function(){this.widget.trigger(b,{instrumentId:this._instrumentId})});this.widget.on(b,this,function(a){this._instrumentRowSelected(a.instrumentId)})}})});a("components/SwishDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,
b){this._paymentMethodId=b.data.paymentMethodId;this._paymentMethodType=b.data.paymentMethodType}})});a("components/SwishSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,b){this._instrumentId=b.data.instrumentId}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-CardClaimOwnership","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/ClaimOwnershipChallengeCardComponent",["component"],function(a){return a.extend({initialize:function(){}})});a("components/CardClaimOwnershipComponent",["component","jQuery","lang","AUI!P"],
function(a,b,e,c){return a.extend({initialize:function(){},bindToElements:function(){var a=this;b("#claim-continue-checkbox-clicked").bind("change",function(c){b(this).is(":checked")?a.getDOMElement("continue-button-clicked").removeClass("apx-wallet-card-claim-ownership-continue-button-disable"):a.getDOMElement("continue-button-clicked").addClass("apx-wallet-card-claim-ownership-continue-button-disable")});a.getDOMElement("continue-button-clicked").click(e.bind(this._continueBankButtonTriggered,this))},
_continueBankButtonTriggered:function(){this.widget.submitFormAJAX({"ppw-widgetEvent":"StartChallengeComponentEvent","ppw-widgetState":this.widget.options.serializedState})}})});a("components/CardClaimOwnershipWorkflowComponent",["modal-popover","component"],function(a,b){return b.extend({initialize:function(b,c){this.popover=new a(b,c,this)},bindToEvents:function(){this.widget.on("claim-ownership-cancelClicked",this,function(a){this.getDOMElement("claim-ownership-popover-cancel-form").submit()})}})})})()});
/* ******** */
(function(e){var c=window.AmazonUIPageJS||window.P,f=c._namespace||c.attributeErrors,a=f?f("APXWidgetsAssets@APXWidgets-APayDeviceValidation","APXWidgetsAssets"):c;a.guardFatal?a.guardFatal(e)(a,window):a.execute(function(){e(a,window)})})(function(e,c,f){(function(){var a=PaymentsPortal2.modules.define;a("components/DeviceValidationComponent",["component","clog","upiEvents"],function(a,d,c){return a.extend({initialize:function(b,a){d.logCounterMetric({feature:"DeviceValidation2FA_JSInitialised",
resource:"_Count"});this.dfValidationResultTracker=[];this.paymentMethodId=a.data.paymentMethodId;this.processedDF2FA=!1;this.DeviceFingerprint2FACompletedEventName="DeviceFingerprint2FACompleted"},bindToEvents:function(){var b=this;b.widget.on(c.DeviceFingerprintValidationPerformedEventName,this,function(a){b.processedDF2FA||(d.logCounterMetric({feature:"DeviceValidation2FA_DeviceFingerprintValidationPerformedEvent",resource:"_Count"}),b.dfValidationResultTracker.push(a.outcome),"SUCCESS"!==a.outcome&&
b.dfValidationResultTracker.length!==a.totalHandleIndexes)||(b.widget.trigger(b.DeviceFingerprint2FACompletedEventName,b.dfValidationResultTracker),b.processedDF2FA=!0)});b.widget.on(b.DeviceFingerprint2FACompletedEventName,this,function(a){d.logCounterMetric({feature:"DeviceValidation2FA_DeviceFingerprint2FACompletedEvent",resource:"_Count"});b.widget.continueRequest({"ppw-widgetState":b.widget.options.serializedState,"ppw-widgetEvent":"CreateDeviceDataSourceEvent","ppw-aggValidationResults":a.join(","),
"ppw-paymentMethodId":b.paymentMethodId},{success:function(a){d.logCounterMetric({feature:"DeviceValidation2FA_CreateDeviceDataSourceEventSuccess",resource:"_Count"})},error:function(a){d.logCounterMetric({feature:"DeviceValidation2FA_CreateDeviceDataSourceEventFailure",resource:"_Count"})}})})}})})})()});
/* ******** */
(function(e){var d=window.AmazonUIPageJS||window.P,f=d._namespace||d.attributeErrors,a=f?f("APXWidgetsAssets@APXWidgets-PaymentAuthenticationApprovers","APXWidgetsAssets"):d;a.guardFatal?a.guardFatal(e)(a,window):a.execute(function(){e(a,window)})})(function(e,d,f){(function(){var a=PaymentsPortal2.modules.define;a("components/AddPaymentAuthenticationApproverComponent",["jQuery","form-component","lang","AUI!P","css-utils"],function(a,d,e,f,g){return d.extend({initialize:function(b,c){this.form.formModel.registerAdditionalData("paymentMethodId",
c.data.paymentMethodId);this.form.formModel.registerAdditionalData("sourceComponent",c.data.sourceComponent)},bindToElements:function(){var b=this.data.paymentMethodId+this.data.sourceComponent,c=this.getDOMElement("pmts-paa-email-input-section"+b),a=this.getDOMElement("pmts-paa-bypass-approval-preference"+b).find("input[type\x3dradio]"),h=this.getDOMElement("pmts-paa-delegate-authentication-preference"+b).find("input[type\x3dradio]");this._shouldShowEmailInputSection(h,c);var d=this.getDOMElement("pmts-paa-add-save-button"+
b),b=this.getDOMElement("pmts-paa-add-cancel-button"+b);this._handleBypassApprovalPreferenceSelectedEvent(a,c);this._handleDelegateAuthenticationPreferenceSelectedEvent(h,c);this._handleSaveButtonEvent(d);this._handleCancelButtonEvent(b)},_handleSaveButtonEvent:function(b){var c=this;b.click(function(b){b.preventDefault();c._saveButtonAction()})},_handleCancelButtonEvent:function(b){var c=this;b.click(function(b){b.preventDefault();c._cancelButtonAction()})},_shouldShowEmailInputSection:function(b,
c){b.is(":checked")?g.showElement(c):g.hideElement(c)},_handleDelegateAuthenticationPreferenceSelectedEvent:function(b,c){b.change(function(a){b.is(":checked")&&g.showElement(c)})},_handleBypassApprovalPreferenceSelectedEvent:function(b,c){b.change(function(a){b.is(":checked")&&g.hideElement(c)})},_saveButtonAction:function(){if(0===this.form.validateForm().length){var b=this.form.getFormValues();this.widget.submitFormAJAX({"ppw-widgetEvent":"AddPaymentAuthenticationApproverSaveButtonClickedEvent",
"ppw-paymentMethodId":this.data.paymentMethodId,"ppw-sourceComponent":this.data.sourceComponent,"ppw-maybePAAEmailId":b.payment_authentication_approver_email_id,"ppw-maybeBypassApproval":b.bypass_approval,"ppw-widgetState":this.widget.options.serializedState})}},_cancelButtonAction:function(){this.form.getFormValues();this.widget.submitFormAJAX({"ppw-widgetEvent":"AddPaymentAuthenticationApproverCancelButtonClickedEvent","ppw-sourceComponent":this.data.sourceComponent,"ppw-paymentMethodId":this.data.paymentMethodId,
"ppw-widgetState":this.widget.options.serializedState})}})});a("components/EditPaymentAuthenticationApproverComponent",["component"],function(a){return a.extend({})});a("components/EditPaymentAuthenticationApproverWorkflowComponent",["component"],function(a){return a.extend({})});a("components/PaymentAuthenticationApproversListItemComponent",["component"],function(a){return a.extend({})});a("components/PaymentAuthenticationApproversListItemAlertComponent",["component"],function(a){return a.extend({})});
a("components/AddPaymentAuthenticationApproversWorkflowComponent",["component"],function(a){return a.extend({})})})()});
/* ******** */
(function(k){var g=window.AmazonUIPageJS||window.P,l=g._namespace||g.attributeErrors,a=l?l("APXWidgetsAssets@APXWidgets-HealthInsurance","APXWidgetsAssets"):g;a.guardFatal?a.guardFatal(k)(a,window):a.execute(function(){k(a,window)})})(function(k,g,l){(function(){var a=PaymentsPortal2.modules.define;a("components/DeleteMe",["component"],function(f){return f.extend({})});a("components/HealthInsuranceEligibilityLoaderComponent",["component","jQuery"],function(f,a){var e,b;return f.extend({initialize:function(n,
d){this.insuranceId=d.data.insuranceId;this.insuranceEligibilityStatus=d.data.eligibilityStatus;e=d.data.maxRetries||10;b=d.data.retryDelayMs||1E3},bindToEvents:function(){var e=this;setTimeout(function(){e._pollForEligibilityStatus(0)},b)},_pollForEligibilityStatus:function(a){var d=this,f={"ppw-widgetEvent":"HealthInsurancePollEligibilityStatusEvent","ppw-insuranceId":this.insuranceId,"ppw-retryCount":a,"ppw-widgetState":this.widget.options.serializedState},c={success:d.widget.createAjaxContinueSuccessHandler(function(h){d.insuranceEligibilityStatus=
h&&h.additionalWidgetResponseData&&h.additionalWidgetResponseData.additionalData&&h.additionalWidgetResponseData.additionalData.eligibilityStatus||"InProgress";d._isInProgress()&&a<e&&g.setTimeout(function(){d._pollForEligibilityStatus(++a)},b)}),error:function(b){}};this.widget.continueRequest(f,c)},_isInProgress:function(){return"inprogress"===this.insuranceEligibilityStatus.toLowerCase()}})});a("components/InsuranceFormComponent","component jQuery form-component css-utils lang AUI!P aui-helper validation-functions".split(" "),
function(a,c,e,b,n,d,g,m){return e.extend({initialize:function(b,a){this.hideShowPrimaryHolderDetailsSection(this.getDOMElement("is_primary_holder").is(":checked"));this.createConditionalValidationFunction()},bindToElements:function(){var b=this;this.getDOMElement("user_details").closest("form").submit(function(a){return b.onSaveInsuranceSubmitButton(a)})},bindToEvents:function(){var b=this;this.getDOMElement("is_primary_holder").change(function(a){b.hideShowPrimaryHolderDetailsSection(c(this).is(":checked"))})},
onSaveInsuranceSubmitButton:function(b){return 0===this.form.validateForm().length},hideShowPrimaryHolderDetailsSection:function(a){var e=this.getDOMElement("is_primary_holder_hidden"),d=this.getDOMElement("primary_holder_details");a?(e.val("checked"),b.hideElement(d)):(e.val(""),b.showElement(d))},createConditionalValidationFunction:function(){m.NonEmptyWhenConditionFieldCompliesToValidationTypeConstraint=function(b,a,e,d){var f=m.NonEmptyFieldConstraint(b,a,b.fields[d.conditionFieldName],d),c=!1;
switch(d.validationType.value){case "NonEmptyWhenConditionFieldNonEmpty":c=!f;break;case "NonEmptyWhenConditionFieldEmpty":c=f}return c?m.NonEmptyFieldConstraint(b,a,e,d):!0}}})});a("components/ValidateInsuranceComponent",["component","jQuery"],function(a,c){var e,b;return a.extend({initialize:function(a,d){this.insuranceId=d.data.insuranceId;this.insuranceValidationStatus=d.data.validationStatus;e=d.data.maxRetries||10;b=d.data.retryDelayMs||1E3},bindToEvents:function(){var a=this;setTimeout(function(){a._pollForValidationStatus(0)},
b)},_pollForValidationStatus:function(a){var d=this,c={"ppw-widgetEvent":"PollInsuranceValidationStatusEvent","ppw-insuranceId":this.insuranceId,"ppw-retryCount":a,"ppw-widgetState":this.widget.options.serializedState},f={success:d.widget.createAjaxContinueSuccessHandler(function(c){this.insuranceValidationStatus=c&&c.additionalWidgetResponseData&&c.additionalWidgetResponseData.additionalData&&c.additionalWidgetResponseData.additionalData.validationStatus||"VerificationPending";"verificationpending"===
this.insuranceValidationStatus.toLowerCase()&&a<e&&g.setTimeout(function(){d._pollForValidationStatus(++a)},b)}),error:function(a){}};this.widget.continueRequest(c,f)}})});a("components/ViewInsuranceComponent",["component","jQuery"],function(a,c){return a.extend({initialize:function(a,b){this.insuranceId=b.data.insuranceId},bindToEvents:function(){var a=this;this.getDOMElement("remove_health_insurance_button").click(function(b){a._removeInsurance()})},_removeInsurance:function(){var a={"ppw-widgetEvent":"RemoveInsuranceEvent",
"ppw-insuranceId":this.insuranceId,"ppw-widgetState":this.widget.options.serializedState},b={success:this.widget.createAjaxContinueSuccessHandler(),error:function(a){}};this.widget.continueRequest(a,b)}})});a("components/HICardAddWorkflowComponent",["component","modal-popover"],function(a,c){return a.extend({initialize:function(a,b){b.data.shouldRenderInPopover&&new c(a,b,this)},bindToEvents:function(){this.widget.on("HiAddPopoverClosed",this,function(){this.getDOMElement("HiAddPopoverCancelForm").submit()})}})});
a("components/HICardDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport","lang"],function(a,c,e){return a.extend(c,{initialize:function(a,c){this._paymentMethodId=c.data.paymentMethodId;this._paymentMethodType=c.data.paymentMethodType},bindToElements:function(){this._bindEditPMLink();this.getDOMElement("verifyHiPmLink").click(e.bind(this._verifyHiPMLinkClicked,this))},_verifyHiPMLinkClicked:function(){this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,
"ppw-widgetEvent":"StartHiCardVerifyEvent","ppw-iid":this._paymentMethodId,"ppw-paymentMethodType":this._paymentMethodType,"ppw-isDefaultPaymentMethod":this._isDefault})}})});a("components/HICardEditWorkflowComponent",["component","EditComponentSupport"],function(a,c){return a.extend(c,{initialize:function(a,b){c._initializePopover(a,b,this)},bindToEvents:function(){c._bindPopoverCloseButtonClickedEvent(this)}})});a("components/HICardSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],
function(a,c){return a.extend(c,{initialize:function(a,b){this._instrumentId=b.data.instrumentId}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-B2BPaymentsAcceptance","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/PaymentMethodOwnerResolverComponent",["jQuery","form-component","lang","AUI!P","css-utils"],function(a,b,c,d,e){return b.extend({initialize:function(f,a){this.form.formModel.registerAdditionalData("sourceComponent",
a.data.sourceComponent);this.form.formModel.registerAdditionalData("sourceComponentSubCategory",a.data.sourceComponentSubCategory)},bindToElements:function(){var a=this.data.sourceComponent+this.data.sourceComponentSubCategory;this.getDOMElement("pmts-pmo-individual-preference"+a).find("input[type\x3dradio]");this.getDOMElement("pmts-pmo-shared-preference"+a).find("input[type\x3dradio]");a=this.getDOMElement("pmts-pmo-resolver-next-button"+a);this._handleNextButtonEvent(a)},_handleNextButtonEvent:function(a){var b=
this;a.click(function(a){a.preventDefault();b._nextButtonAction()})},_nextButtonAction:function(){if(0===this.form.validateForm().length){var a=this.form.getFormValues();this.widget.submitFormAJAX({"ppw-widgetEvent":"PaymentMethodOwnerResolverButtonClickedEvent","ppw-sourceComponent":this.data.sourceComponent,"ppw-sourceComponentSubCategory":this.data.sourceComponentSubCategory,"ppw-maybePaymentMethodOwner":a.payment_method_owner,"ppw-widgetState":this.widget.options.serializedState})}}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-JPPoints","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/JPPointsDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport","jQuery"],function(a,b,c){return a.extend(b,{initialize:function(a,b){this._paymentMethodId=b.data.paymentMethodId;
this._paymentMethodType=b.data.paymentMethodType;this._isDefault=b.data.isDefault},bindToElements:function(){this._bindEditPMLink()}})});a("components/JPPointsMetadataSlotComponent",["component"],function(a){return a.extend({initialize:function(a,b){}})});a("components/JPPointsSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,b){this._instrumentId=b.data.instrumentId}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-BottomSheet","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/BottomSheetComponent",["component","AUI!P","clog"],function(a,b,c){return a.extend({initialize:function(f,a){this._bottomSheetCloseButtonSelector=(f=a.data.bottomSheetCloseButtonClass)?"."+f:
""},bindToEvents:function(){var a=this;a.widget.on("componentsInitialized",a,function(c){a._startWidget(a)})},_startWidget:function(a){b.when("A","a-sheet").execute("APX-Startwidget",function(b,e){e.create({name:"code_generated_sheet",preloadDomId:"bottomSheetComponent",height:800});var d=e.get("code_generated_sheet"),g=null;b.on("a:sheet:beforeShow:code_generated_sheet",function(){g=c.getCurrentTime()});e.showSheet(d);var h=d.$container[0];h&&h.classList.add("mcx-bottom-sheet-container");b.on("a:sheet:afterShow:code_generated_sheet",
function(){c.logLatencyMetric({feature:"ShowBottomSheetWidget",resource:"_Latency",startTime:g});c.publishMetrics()});a._bottomSheetCloseButtonSelector&&$(a._bottomSheetCloseButtonSelector).click(function(){e.hideSheet(d)})})}})})})()});
/* ******** */
(function(d){var c=window.AmazonUIPageJS||window.P,e=c._namespace||c.attributeErrors,a=e?e("APXWidgetsAssets@APXWidgets-P24","APXWidgetsAssets"):c;a.guardFatal?a.guardFatal(d)(a,window):a.execute(function(){d(a,window)})})(function(d,c,e){(function(){var a=PaymentsPortal2.modules.define;a("components/P24DetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,b){this._paymentMethodId=b.data.paymentMethodId;this._paymentMethodType=
b.data.paymentMethodType},bindToElements:function(){this._bindEditPMLink()}})});a("components/P24EditComponent",["component","EditComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,c){b._initializePopover(a,c,this)},bindToEvents:function(){b._bindPopoverCloseButtonClickedEvent(this)}})});a("components/P24SleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,b){this._instrumentId=b.data.instrumentId}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-SPEI","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){});
/* ******** */
(function(d){var e=window.AmazonUIPageJS||window.P,f=e._namespace||e.attributeErrors,b=f?f("APXWidgetsAssets@APXWidgets-Registration","APXWidgetsAssets"):e;b.guardFatal?b.guardFatal(d)(b,window):b.execute(function(){d(b,window)})})(function(d,e,f){(function(){var b=PaymentsPortal2.modules.define;b("components/RegistrationLinkComponent","component lang jQuery events/postToSecureIframeEvent events/secureIframeLoadedEvent AUI!P clog css-utils events/AddPaymentInstrumentLinkSelectedEvent TransitionMetricsConstants".split(" "),
function(b,e,d,f,k,l,g,n,m,h){return b.extend({initialize:function(a,c){this._paymentIdentifier=c.data.paymentIdentifier;this._touchLink=this.getDOMElement(c.data.touchLinkReference);this._secureIframeName=c.data.secureIframeName;this._isEligible=c.data.isEligible;this._bindManualAddCCTrigger()},bindToElements:function(){var a=this;a._touchLink.click(function(){a._registrationLinkTriggered()})},bindToEvents:function(){var a=this;a.widget.on("RecordMaybeIneligiblePaymentMethodDisplayedMetricEvent",
a,function(){this._isEligible||(g.logCounterMetric({feature:"MCXRegistration.PaymentMethodIneligible."+this._paymentIdentifier,resource:"_Count"}),g.publishMetrics(),a.widget.publishSuccessSushiMetrics({ActionType:"PaymentMethodIneligible",ActionValueType:"AddMethod",ActionValue:this._paymentIdentifier}))});if("CC"===this._paymentIdentifier)a.widget.on("DisableCreditCardRegistrationLinkEvent",a,function(c){var b=d(".pmts-mcx-registration-touchlink-CC");1===b.length&&(a._disableRegistrationLink(b),
a._displayVerificationLimitExceedErrorMessage(b,c.rateLimitDurationInSeconds))});a.widget.on(k,this,function(a){a.data&&"CC"===a.data.paymentMethod&&a.clickData&&a.clickData.startTimestamp&&a.clickData.startTimestampSource&&g.logLatencyMetric({feature:a.clickData.startTimestampSource+h.SEPARATOR+h.CARD_REGISTRATION_FORM_VIEW,resource:"_Latency",startTime:a.clickData.startTimestamp})})},_disableRegistrationLink:function(a){a.addClass("isDisabled")},_displayVerificationLimitExceedErrorMessage:function(a,
b){a=900<=b?a.find(".pmts-registration-link-verification-limit-exceed-24hrs-error"):a.find(".pmts-registration-link-verification-limit-exceed-15mins-error");1===a.length&&a.removeClass("a-hidden aok-hidden")},_showAddPMPage:function(){this.widget.trigger(m,{paymentMethodIdentifier:this._paymentIdentifier})},_redirectVenmoPMToInterstitialPage:function(){this.widget.trigger("AddVenmoIntermediateStepEvent")},_registrationLinkTriggered:function(){switch(this._paymentIdentifier){case "CC":var a={ActionType:"StartAddCreditCard",
ActionValueType:"Click",ActionValue:"SecureAddCreditCardLinkClicked"};this._triggerSecureRegistration(a);break;case "BA":a={ActionType:"StartAddBankAccount",ActionValueType:"Click",ActionValue:"SecureAddBankAccountLinkClicked"};this._triggerSecureRegistration(a);break;case "CBA":a={ActionType:"StartAddCorporateBankAccount",ActionValueType:"Click",ActionValue:"SecureAddBankAccountLinkClicked"};this._triggerSecureRegistration(a);break;case "HBA":this._showAddPMPage();break;case "APC":this._showAddPMPage();
break;case "EBT":this._showAddPMPage();break;case "VM":this._redirectVenmoPMToInterstitialPage()}},_bindManualAddCCTrigger:function(){var a=this;"CC"===this._paymentIdentifier&&l.when("A").execute(function(b){b.declarative("add-credit-card-mcx-action-name","click",function(){a._triggerSecureRegistration()})})},_triggerSecureRegistration:function(a){(new Date).getTime();g.logCounterMetric({feature:"SecureRegistrationLinkClicked",resource:"_Count"});this.widget.publishSuccessSushiMetrics(a);this.widget.trigger(f,
{postData:{hideAddPaymentInstrumentHeader:!0,creatablePaymentMethods:[this._paymentIdentifier],iFrameName:this._secureIframeName}})}})})})()});
/* ******** */
(function(d){var b=window.AmazonUIPageJS||window.P,e=b._namespace||b.attributeErrors,a=e?e("APXWidgetsAssets@APXWidgets-Bellamy","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(d)(a,window):a.execute(function(){d(a,window)})})(function(d,b,e){(function(){var a=PaymentsPortal2.modules.define;a("components/AddBankRedirectComponent",["events/form-submitted-event","jQuery","form-component","lang","AUI!P"],function(a,b,f,d,e){return f.extend({_hasErrors:!1,initialize:function(c,a){this._action=a.data.action;
this._hasErrors=a.data.hasErrors},_initPopoverState:function(){"true"===this._hasErrors&&this.getDOMElement("BankRedirectPopoverLink").trigger("click")},bindToElements:function(){this.getDOMElement("addBankRedirectSubmitButton").click(d.bind(this._handleFormSubmission,this))},bindToEvents:function(){var c=this;c.widget.on("componentsInitialized",c,function(a){this._initPopoverState()});c.widget.on(a,c,function(a){a.action===c._action&&b(c.getDOMElement("addBankRedirectForm")).submit()})},_handleFormSubmission:function(c){var f=
this.form.validateForm(),b=this.getFormSubmissionParameters("addBankRedirectFormContainer");0===f.length?(this.widget.trigger(a,{event:c,submissionParameters:b,action:this._action}),this.closeAddBankRedirectPopover()):c.preventDefault()},closeAddBankRedirectPopover:function(){e.when("a-modal").execute(function(a){a&&(a=a.get("pmtsAddBankRedirectPopover"))&&a.hide()})}})});a("components/SelectableBankRedirectListComponent",["form-component"],function(a){return a});a("components/SelectableBankRedirectListItemComponent",
["components/SelectableDPMInstrumentListItemComponent","events/InstrumentRowSelectedEvent"],function(a,b){return a.extend({bindToEvents:function(){var a=this;if(a._isPreselected)a.widget.on("componentsInitialized",a,function(){a.widget.trigger(b,{instrumentId:a._instrumentId})});a.widget.on(b,a,function(b){a._instrumentRowSelected(b.instrumentId)})}})})})()});
/* ******** */
(function(D){var p=window.AmazonUIPageJS||window.P,v=p._namespace||p.attributeErrors,t=v?v("APXWidgetsAssets@APXWidgets-AIPS","APXWidgetsAssets"):p;t.guardFatal?t.guardFatal(D)(t,window):t.execute(function(){D(t,window)})})(function(D,p,v){(function(){var t=PaymentsPortal2.modules.define;t("components/DefaultComponent",["component"],function(c){return c.extend({initialize:function(){p.alert("DefaultComponent initialize!")}})});t("components/UpiOtherPMListItemComponent","component continuable events/InstrumentRowSelectedEvent public-event-registry css-utils components/SimplePaymentOptionListItemComponent lang upi-redirection-util clog events/spinner-events".split(" "),
function(c,l,n,h,f,m,k,A,d,r){return m.extend(l,{isUPIValidated:!1,isUpiContinuable:!1,isUpiRegistrationSelected:!1,upiContainer:"",upiDisabledMessageContainer:"",upiValidationInputContainer:"",upiInputContainer:"",isUpiUsable:!0,isUpiRegistrationUsable:!0,UpiRegistrationSuppressedViolationHead:"",instrumentId:"",instrumentType:"",isAPBSelected:!1,isUpiAPBMultiTenderEnabled:!1,selectedBankValue:"",redirectUrl:"",returnUrl:"",clientId:"",upiAPBUncheckedMessageContainer:"",upiRegistrationSubsectionInfoContainer:"",
isAPBDeselectTriggered:!1,isAutomaticAPBDeselectForUpiEnabled:!1,httpMethod:"",isUpiRecurringEligible:!1,orderId:"",enableGetReturnHttpMethod:!1,enableOrderIdInClientContext:!1,enableMultiTenderContextInUPIRedirectionClientContext:!1,reloadPspOnReappear:!1,upiGifJsBinding:"",upiRegistrationAndValidationLogo:"",genericUpiLogoJsBinding:"",isNomenclatureWave2Enabled:!1,initialize:function(b,a){this.isUpiUsable=a.data.isUpiUsable;this.isUpiRegistrationUsable=a.data.isUpiRegistrationUsable;this.UpiRegistrationSuppressedViolationHead=
a.data.UpiRegistrationSuppressedViolationHead;this.instrumentId=a.data.instrumentId;this.instrumentType=a.data.instrumentType;this.orderId=a.data.orderId;this.enableGetReturnHttpMethod=a.data.enableGetReturnHttpMethod;this.enableOrderIdInClientContext=a.data.enableOrderIdInClientContext;this.upiGifJsBinding=a.data.upiGifJsBinding;this.upiRegistrationAndValidationLogo=a.data.upiRegistrationAndValidationLogo;this.genericUpiLogoJsBinding=a.data.genericUpiLogoJsBinding;this.isNomenclatureWave2Enabled=
a.data.isNomenclatureWave2Enabled;this.isUpiUsable&&(h.register(n),h.register("UpiRedirectionContinueEvent"));this.upiContainer=a.data.upiContainer;this.upiDisabledMessageContainer=a.data.upiDisabledMessageContainer;this.upiValidationInputContainer=a.data.upiValidationInputContainer;this.upiInputContainer=a.data.upiInputContainer;this.upiAPBUncheckedMessageContainer=a.data.upiAPBUncheckedMessageContainer;this.isAutomaticAPBDeselectForUpiEnabled=a.data.isAutomaticAPBDeselectForUpiEnabled;this.upiRegistrationSubsectionInfoContainer=
a.data.upiRegistrationSubsectionInfoContainer;this._toggleUPIInputContainer(!1);this.isUpiAPBMultiTenderEnabled=a.data.isUpiAPBMultiTenderEnabled;this._toggleUncheckAPBtoEnableUPIMessage(!1);f.showElement(this.getDOMElement(this.upiContainer));this.enableMultiTenderContextInUPIRedirectionClientContext=a.data.enableMultiTenderContextInUPIRedirectionClientContext;this.reloadPspOnReappear=a.data.reloadPspOnReappear},_onInstrumentSelected:function(){this._getContainerElement().addClass("pmts-selected");
this._getInstrumentSelectionInputElement().prop("checked",!0);this._toggleUPIInputContainer(!0);this._toggleUPIAPBUncheckedMessage();this._triggerBackingInstrumentSelectedEvent();this.isUPIValidated&&this._toggleUpiLogosForNomenclature(!0)},_onInstrumentDeselected:function(){this._getContainerElement().removeClass("pmts-selected");this._toggleUPIInputContainer(!1);this._getInstrumentSelectionInputElement().prop("checked",!1);this._toggleUpiLogosForNomenclature(!1)},_isInstrumentSelected:function(){return this._getContainerElement().hasClass("pmts-selected")},
_getContainerElement:function(){return this.getDOMElement(this.upiContainer)},_toggleUPIValidationContainer:function(b){0<this.getDOMElement(this.upiValidationInputContainer).length&&f.toggleElement(this.getDOMElement(this.upiValidationInputContainer),b)},_toggleUPIInputContainer:function(b){0<this.getDOMElement(this.upiInputContainer).length&&f.toggleElement(this.getDOMElement(this.upiInputContainer),b)},_toggleUncheckAPBtoEnableUPIMessage:function(b){0<this.getDOMElement(this.upiDisabledMessageContainer).length&&
f.toggleElement(this.getDOMElement(this.upiDisabledMessageContainer),b)},_toggleUPIAPBUncheckedMessage:function(){this.isAutomaticAPBDeselectForUpiEnabled&&this.isAPBSelected&&this.isUpiRegistrationSelected&&!this.isUpiContinuable?(this.isAPBDeselectTriggered=this.isUpiContinuable=!0,this._toggleUPIAPBUncheckedMessageContainer(!0),this._toggleUPIRegistrationSubsectionInfoContainer(!1)):this.isUpiRegistrationSelected&&!this.isAPBDeselectTriggered&&this._toggleUPIRegistrationSubsectionInfoContainer(!0)},
_toggleUPIAPBUncheckedMessageContainer:function(b){var a=this.getDOMElement(this.upiAPBUncheckedMessageContainer);0<a.length&&f.toggleElement(a,b)},_toggleUpiLogosForNomenclature:function(b){this.isNomenclatureWave2Enabled&&(this._toggleUPIGenericLogo(b),this._toggleUPIGif(!b),this._toggleUpiRegistrationAndValidationLogo(!b))},_toggleUPIGenericLogo:function(b){var a=this.getDOMElement(this.genericUpiLogoJsBinding);0<a.length&&f.toggleElement(a,b)},_toggleUPIGif:function(b){var a=this.getDOMElement(this.upiGifJsBinding);
0<a.length&&f.toggleElement(a,b)},_toggleUpiRegistrationAndValidationLogo:function(b){var a=this.getDOMElement(this.upiRegistrationAndValidationLogo);0<a.length&&f.toggleElement(a,b)},_toggleUPIRegistrationSubsectionInfoContainer:function(b){var a=this.getDOMElement(this.upiRegistrationSubsectionInfoContainer);0<a.length&&f.toggleElement(a,b)},_getIsRecurringChargePaymentMethod:function(){return this.isUpiRecurringEligible},_triggerInstrumentRowSelectedEvent:function(b){this.widget.trigger(n,{instrumentId:this._getInstrumentId(),
instrumentType:this._getInstrumentType(),isInstrumentOwned:this._getIsOwned(),isRecurringChargePaymentMethod:this._getIsRecurringChargePaymentMethod(),paymentMethod:this._getPaymentMethodCode()})},_triggerBackingInstrumentSelectedEvent:function(){var b="";this.isUpiRegistrationUsable?b="apx_upi_registration_disabled_message_apb_selected":"PurchaseAmountExceeded"===this.UpiRegistrationSuppressedViolationHead&&(b="apx_upi_registration_disabled_message_for_fl");var b=this.isUpiContinuable?[]:[this.widget.getLocalizedString(this.isUpiRegistrationSelected?
b:"apx_upi_not_verified")],a=this.isUpiRegistrationSelected&&this.isUpiContinuable;this.widget.trigger("backingInstrumentSelected",{instrumentId:this._getInstrumentId(),instrumentType:this._getInstrumentType(),errors:b,paymentMethod:this.data.paymentMethod,isUpiRedirectionRequired:a})},bindToEvents:function(){var b=this;k.bind(m.prototype.bindToEvents,this).apply();b.widget.on(n,this,function(a){a.instrumentId===this._getInstrumentId()?this._onInstrumentSelected():this._onInstrumentDeselected()});
b.widget.on("apbSelectionChanged",b,function(a){b.widget.get("apbCheckboxSelected")!==v&&b.isUpiUsable&&(b.isAPBSelected=a.isSelected,b.giftCardId=a.giftCardId,b.storedValueId=a.storedValueId,b.isAutomaticAPBDeselectForUpiEnabled&&a.isSelected&&(this._toggleUPIAPBUncheckedMessageContainer(!1),this.isAPBDeselectTriggered=!1),b.isUpiAPBMultiTenderEnabled||(this._isInstrumentSelected()&&a.isSelected&&(this.setContinuable(!1),b.widget.trigger("PaymentPlanSelected",{isValid:!1})),a.isSelected&&this._toggleUpiLogosForNomenclature(!1),
this.setDisabled(a.isSelected),this._toggleUncheckAPBtoEnableUPIMessage(a.isSelected)))});b.widget.on("ValidateUpiIdResultEvent",b,function(a){this.isUpiContinuable=this.isUPIValidated=a.isContinuable;this.isUpiRecurringEligible=a.isUpiRecurringEligible;this.isUPIValidated?this._toggleUpiLogosForNomenclature(!0):this._toggleUpiLogosForNomenclature(!1);this.isUpiRecurringEligible&&b._triggerInstrumentRowSelectedEvent()});b.widget.on("UpiActionChangeEvent",b,function(a){b._toggleUPIValidationContainer(a.isUpiValidationContainerSelected);
b.isUpiRegistrationSelected=!a.isUpiValidationContainerSelected;b.isUpiContinuable=a.isUpiValidationContainerSelected?b.isUPIValidated:b.getContinuable();a.isUpiValidationContainerSelected?(b._toggleUPIAPBUncheckedMessageContainer(!1),b._toggleUPIRegistrationSubsectionInfoContainer(!1),this.isAPBDeselectTriggered=!1):(b.selectedBankValue=a.selectedBank,b.redirectUrl=a.redirectUrl,b.returnUrl=a.returnUrl,b.failureReturnUrl=a.failureReturnUrl,b.purchaseId=a.purchaseId,b.isPurchaseIdRequired=a.isPurchaseIdRequired,
b.areReturnUrlsSentByClient=a.areReturnUrlsSentByClient,b.clientId=a.clientId,b.httpMethod=a.httpMethod);b._isInstrumentSelected()&&b._triggerInstrumentRowSelectedEvent()});b.widget.on("UpiBankSelectionChangeEvent",b,function(a){b.isUpiContinuable=!0;b.isUpiRegistrationSelected=!0;b.selectedBankValue=a.selectedBank;b.redirectUrl=a.redirectUrl;b.returnUrl=a.returnUrl;b.failureReturnUrl=a.failureReturnUrl;b.purchaseId=a.purchaseId;b.isPurchaseIdRequired=a.isPurchaseIdRequired;b.areReturnUrlsSentByClient=
a.areReturnUrlsSentByClient;b.clientId=a.clientId;b.httpMethod=a.httpMethod;b._isInstrumentSelected()&&b._triggerInstrumentRowSelectedEvent()});b.widget.on("UpiRedirectionContinueEvent",b,function(){var a=d.getCurrentTime();b._isInstrumentSelected()&&(b.widget.trigger(r.showSpinner),d.logCounterMetric({feature:"UpiRegistrationRedirection",resource:"_Count"}),A.upiRegistration(b.selectedBankValue,{redirectUrl:b.redirectUrl,returnUrl:b.returnUrl,failureReturnUrl:b.failureReturnUrl},b.purchaseId,b.clientId,
b.httpMethod,{areReturnUrlsSentByClient:b.areReturnUrlsSentByClient,isPurchaseIdRequired:b.isPurchaseIdRequired,isAPBSelected:b.isAPBSelected,giftCardId:b.giftCardId,storedValueId:b.storedValueId,enableGetReturnHttpMethod:b.enableGetReturnHttpMethod,enableOrderIdInClientContext:b.enableOrderIdInClientContext,enableMultiTenderContextInUPIRedirectionClientContext:b.enableMultiTenderContextInUPIRedirectionClientContext,orderId:b.orderId,reloadPspOnReappear:b.reloadPspOnReappear})?(d.logCounterMetric({feature:"UpiRegistrationRedirection",
resource:"_SuccessCount"}),this.widget.publishSuccessSushiMetrics({ActionType:"UpiRegistrationRedirection",ActionValueType:"PaymentInstrument",ActionValue:String(b._getInstrumentId())})):(d.logCounterMetric({feature:"UpiRegistrationRedirection",resource:"_ErrorCount"}),this.widget.publishFailureSushiMetrics({ActionType:"UpiRegistrationRedirection",ActionValueType:"PaymentInstrument",ActionValue:String(b._getInstrumentId())})),d.logLatencyMetric({feature:"UpiRegistrationRedirection",resource:"_Latency",
startTime:a}),d.publishMetrics());return!1})},bindToElements:function(){var b=this;b.isUpiUsable&&b._getContainerElement().click(function(){b._isInstrumentSelected()||!b.isUpiUsable||b.isAPBSelected&&!b.isUpiAPBMultiTenderEnabled||b._triggerInstrumentRowSelectedEvent()})}})});t("components/UpiRegistrationComponent","component commonUtil css-utils continuable lang public-event-registry clog events/spinner-events upi-redirection-util jQuery events/InstrumentRowSelectedEvent".split(" "),function(c,l,
n,h,f,m,k,A,d,r,b){return c.extend(h,{isUpiValidated:!1,isUpiRegistrationSelected:!1,upiActionDropdown:"",upiRegistrationDropdownContainer:"",isUpiRegistrationUsable:!1,upiBankSelectDropdown:"",redirectUrl:"",returnUrl:"",failureReturnUrl:"",purchaseId:"",areReturnUrlsSentByClient:!1,isPurchaseIdRequired:!1,upiRegistrationDisabledApbMessageContainer:"",isUpiAPBMultiTenderEnabled:!1,isAPBSelected:!1,clientId:"",isApxReloadEnabled:!1,httpMethod:"",enableGetReturnHttpMethod:!1,isOnlyRegistrationDisplayable:!1,
enableOrderIdInClientContext:!1,enableMultiTenderContextInUPIRedirectionClientContext:!1,isUPIInBoxWeblabEnabled:!1,$getStartedLabel:"",orderId:"",reloadPspOnReappear:!1,isPspBspConvergenceWeblabEnabled:!1,pspBspConvergenceWeblabTreatment:"",initialize:function(a,b){m.register("UpiActionChangeEvent");m.register("UpiBankSelectionChangeEvent");m.register("UpiRedirectionRequiredEvent");this.upiBankSelectDropdown=b.data.upiBankSelectDropdown;this.upiActionDropdown=b.data.upiActionDropdown;this.upiRegistrationDropdownContainer=
b.data.upiRegistrationDropdownContainer;this.isUpiRegistrationUsable=b.data.isUpiRegistrationUsable;this.redirectUrl=b.data.redirectUrl;this.returnUrl=b.data.returnUrl;this.failureReturnUrl=b.data.failureReturnUrl;this.purchaseId=b.data.purchaseId;this.isPurchaseIdRequired=b.data.isPurchaseIdRequired;this.areReturnUrlsSentByClient=b.data.areReturnUrlsSentByClient;this.upiRegistrationDisabledApbMessageContainer=b.data.upiRegistrationDisabledApbMessageContainer;this.isUpiAPBMultiTenderEnabled=b.data.isUpiAPBMultiTenderEnabled;
this.clientId=b.data.clientId;this.isApxReloadEnabled=b.data.isApxReloadEnabled;this.httpMethod=b.data.httpMethod;this.isOnlyRegistrationDisplayable=b.data.isOnlyRegistrationDisplayable;this.enableGetReturnHttpMethod=b.data.enableGetReturnHttpMethod;this.enableOrderIdInClientContext=b.data.enableOrderIdInClientContext;this.orderId=b.data.orderId;this.isUPIInBoxWeblabEnabled=b.data.isUPIInBoxWeblabEnabled;this.enableMultiTenderContextInUPIRedirectionClientContext=b.data.enableMultiTenderContextInUPIRedirectionClientContext;
this.reloadPspOnReappear=b.data.reloadPspOnReappear;this.isPspBspConvergenceWeblabEnabled=b.data.isPspBspConvergenceWeblabEnabled;this.pspBspConvergenceWeblabTreatment=b.data.pspBspConvergenceWeblabTreatment},_toggleUPIRegistrationContainer:function(a){0<this.getDOMElement(this.upiRegistrationDropdownContainer).length&&n.toggleElement(this.getDOMElement(this.upiRegistrationDropdownContainer),a)},_toggleUncheckAPBtoEnableUPIMessage:function(a){var b=this.getDOMElement(this.upiRegistrationDisabledApbMessageContainer);
0<b.length&&n.toggleElement(b,a)},_getUpiRegistrationSelectedBank:function(){var a=this.getDOMElement(this.upiBankSelectDropdown);return 0<a.length?a[0].value:""},_invalidatePaymentPlan:function(){this.setContinuable(!1);this.widget.trigger("PaymentPlanSelected",{isValid:!1})},_triggerUpiRegistrationSelection:function(){if(this.isUpiRegistrationSelected){this.isUpiRegistrationUsable?(this._toggleUncheckAPBtoEnableUPIMessage(this.isAPBSelected),this._toggleUPIRegistrationContainer(!this.isAPBSelected),
this.setContinuable(!this.isAPBSelected)):this._invalidatePaymentPlan();var a;a=this.isAPBSelected?"":this._getUpiRegistrationSelectedBank();this.widget.trigger("UpiActionChangeEvent",{isUpiValidationContainerSelected:!1,selectedBank:a,redirectUrl:this.redirectUrl,returnUrl:this.returnUrl,failureReturnUrl:this.failureReturnUrl,purchaseId:this.purchaseId,isPurchaseIdRequired:this.isPurchaseIdRequired,areReturnUrlsSentByClient:this.areReturnUrlsSentByClient,clientId:this.clientId,httpMethod:this.httpMethod})}},
_isBankSelected:function(){return""!==this._getUpiRegistrationSelectedBank()},_handleUPIRedirectionForUpiRegistration:function(a){var b=k.getCurrentTime();this.widget.trigger(A.showSpinner);k.logCounterMetric({feature:"UpiInBoxPspRegistrationBottomSheetAIPSRedirection",resource:"_Count"});d.upiRegistration(a,{redirectUrl:this.redirectUrl,returnUrl:this.returnUrl,failureReturnUrl:this.failureReturnUrl},this.purchaseId,this.clientId,this.httpMethod,{areReturnUrlsSentByClient:this.areReturnUrlsSentByClient,
isPurchaseIdRequired:this.isPurchaseIdRequired,isAPBSelected:this.isAPBSelected,giftCardId:this.giftCardId,storedValueId:this.storedValueId,enableGetReturnHttpMethod:this.enableGetReturnHttpMethod,enableOrderIdInClientContext:this.enableOrderIdInClientContext,enableMultiTenderContextInUPIRedirectionClientContext:this.enableMultiTenderContextInUPIRedirectionClientContext,orderId:this.orderId,reloadPspOnReappear:this.reloadPspOnReappear})?k.logCounterMetric({feature:"UpiInBoxPspRegistrationBottomSheetAIPSRedirection",
resource:"_SuccessCount"}):k.logCounterMetric({feature:"UpiInBoxPspRegistrationBottomSheetAIPSRedirection",resource:"_ErrorCount"});k.logLatencyMetric({feature:"UpiInBoxPspRegistrationBottomSheetAIPSRedirection",resource:"_Latency",startTime:b});k.publishMetrics()},_moveToDefaultViewOfBottomSheet:function(){var a=this.getDOMElement("upi-registration-bank-selection-bottom-sheet-top-marker");a&&a[0]&&a[0].scrollIntoView({behavior:"auto"})},bindToEvents:function(){var a=this;f.bind(c.prototype.bindToEvents,
this).apply();a.widget.on("ValidateUpiIdResultEvent",this,function(a){this.isUpiValidated=a.isContinuable});a.widget.on("componentsInitialized",a,function(){var b=a.getDOMElement(a.upiActionDropdown);0<b.length&&b.trigger("change");b=a.getDOMElement(a.upiBankSelectDropdown);a.isOnlyRegistrationDisplayable&&0<b.length&&a.isUpiRegistrationUsable&&b.trigger("change");a.isUpiValidated=!1});a.widget.on("apbSelectionChanged",a,function(b){a.widget.get("apbCheckboxSelected")!==v&&(a.isUPIInBoxWeblabEnabled||
a.isApxReloadEnabled||!a.isUpiAPBMultiTenderEnabled?a.isUPIInBoxWeblabEnabled&&(a.isAPBSelected=b.isSelected,a.giftCardId=b.giftCardId,a.storedValueId=b.storedValueId):(a.isAPBSelected=b.isSelected,a._triggerUpiRegistrationSelection()))})},bindToElements:function(){var a=this;f.bind(c.prototype.bindToElements,this).apply();a.$topBanksList=this.getDOMElementsByPrefix("upiTopBanks-list-item-");a.$allBanksList=this.getDOMElementsByPrefix("upiAllBanks-list-item-");a.$topBanksHeader=this.getDOMElement("upiTopBanks-title");
a.$allBanksHeader=this.getDOMElement("upiAllBanks-title");a.$noBankFoundText=this.getDOMElement("no-bank-found");var g=!1,d=a.getDOMElement(a.upiBankSelectDropdown);0<d.length&&d.bind("change",function(){a.isUpiRegistrationSelected=!0;a.setContinuable(!0);a.widget.trigger("UpiBankSelectionChangeEvent",{selectedBank:a._getUpiRegistrationSelectedBank(),redirectUrl:a.redirectUrl,returnUrl:a.returnUrl,failureReturnUrl:a.failureReturnUrl,purchaseId:a.purchaseId,isPurchaseIdRequired:a.isPurchaseIdRequired,
areReturnUrlsSentByClient:a.areReturnUrlsSentByClient,clientId:a.clientId,httpMethod:a.httpMethod})});d=a.getDOMElement(a.upiActionDropdown);0<d.length&&d.bind("change",function(){var b=this.value;"upi-registration"===b?(a.isUpiRegistrationSelected=!0,a._triggerUpiRegistrationSelection()):"upi-acceptance"===b&&(a.isUpiRegistrationSelected=!1,a.setContinuable(a.isUpiValidated),a._toggleUncheckAPBtoEnableUPIMessage(!1),a.widget.trigger("UpiActionChangeEvent",{isUpiValidationContainerSelected:!0}),a._toggleUPIRegistrationContainer(!1))});
a.getDOMElementsByPrefix("apx-bottom-sheet-scroll-to-top-button").click(function(b){a._moveToDefaultViewOfBottomSheet()});D.when("A","a-sheet","ready").execute("bottom-sheet-events",function(c,d){a.getDOMElement("js-binding-upi-registration-box").click(function(c){f.forEach(r("input[type\x3dradio][name\x3dppw-instrumentRowSelection]"),function(a){a.checked=!1});a.widget.trigger(b,{instrumentId:"UPIRegistration"});if(!a.isPspBspConvergenceWeblabEnabled){c={name:"upi-registration-bank-selection-bottom-sheet",
height:400,preloadDomId:"upi-registration-bank-selection-bottom-sheet-id",closeType:"icon",sheetLabel:"Registration Bank Selection Bottom sheet header",sheetDescription:"Registration Bank Selection Bottom sheet content"};var g=d.get("upi-registration-bank-selection-bottom-sheet");g?g.show():(d.create(c),d.get("upi-registration-bank-selection-bottom-sheet").show())}k.logCounterMetric({feature:"PspBspConvergence_"+a.pspBspConvergenceWeblabTreatment,resource:"_Count"});k.publishMetrics();a.widget.publishSuccessSushiMetrics({ActionType:"UpiGetStartedLink",
ActionValueType:"PspBspConvergence",ActionParentValueType:"WeblabTreatment",ActionParentValue:"PspBspConvergence_"+a.pspBspConvergenceWeblabTreatment});l.recordWeblabTrigger("IN_APX_PSP_BSP_AIPS_CONVERGENCE_747406",a.pspBspConvergenceWeblabTreatment);a.isPspBspConvergenceWeblabEnabled&&a._handleUPIRedirectionForUpiRegistration()});c.on("a:sheet:beforeShow:upi-registration-bank-selection-bottom-sheet",function(b){n.showElement(a.getDOMElement("upi-registration-bank-selection-bottom-sheet-content"));
n.enableTextInput(a.getDOMElement("search-bank-text-box-input"));a.bottomSheetOpenTime=k.getCurrentTime();a.widget.publishSuccessSushiMetrics({ActionType:"UpiSearchBankStart",ActionValueType:"UpiSearchBank",ActionParentValueType:"OtherUpiPaymentMethod",ActionParentValue:"UpiInBoxPspRegistration"})});c.declarative("bankSearchDeclarativeActionRegistration","keyup",function(){g=!0;a.$topBankAvailable=0;a.$allBankAvailable=0;var b,d;a.getDOMElement("search-bank-text-box-input").val()&&(d=a.getDOMElement("search-bank-text-box-input").val().toUpperCase());
f.forEach(a.$topBanksList,function(g){b=g.getElementsByClassName("upi-registration-bank-selection-bank-name-element-section")[0].innerHTML.toUpperCase();g.classList.add("aok-offscreen");c.contains(b,d)&&(g.classList.remove("aok-offscreen"),a.$topBankAvailable++)});f.forEach(a.$allBanksList,function(g){b=g.getElementsByClassName("upi-registration-bank-selection-bank-name-element-section")[0].innerHTML.toUpperCase();g.classList.add("aok-offscreen");c.contains(b,d)&&(g.classList.remove("aok-offscreen"),
a.$allBankAvailable++)});0===a.$topBankAvailable?a.$topBanksHeader.addClass("aok-offscreen"):a.$topBanksHeader.removeClass("aok-offscreen");0===a.$allBankAvailable?a.$allBanksHeader.addClass("aok-offscreen"):a.$allBanksHeader.removeClass("aok-offscreen");0===a.$topBankAvailable&&0===a.$allBankAvailable?(n.showElement(a.$noBankFoundText),k.logCounterMetric({feature:"UPI_PSP_REG_NoBankFoundWhenSearchBoxUsed",resource:"_ErrorCount"}),k.publishMetrics(),a.widget.publishFailureSushiMetrics({ActionType:"UpiSearchBankInProgress",
ActionValueType:"UpiSearchBank",ActionValue:"BankNotFoundInList",ActionErrorCode:"NO_BANK_FOUND",ActionParentValueType:"OtherUpiPaymentMethod",ActionParentValue:"UpiInBoxPspRegistration"})):n.hideElement(a.$noBankFoundText)})});f.forEach(["upiTopBanks-list-item-","upiAllBanks-list-item-"],function(b){a.getDOMElementsByPrefix(b).click(function(b){k.logLatencyMetric({feature:"UpiInBoxPspRegistrationBottomSheet",resource:"_Latency",startTime:this.bottomSheetOpenTime});g?k.logCounterMetric({feature:"UPI_PSP_REG_BankSelectCompletedUsingSearchBox",
resource:"_SuccessCount"}):k.logCounterMetric({feature:"UPI_PSP_REG_BankSelectCompletedWithoutUsingSearchBox",resource:"_SuccessCount"});k.publishMetrics();r(".a-sheet-close").click();var c=r(b.currentTarget);b=c&&c.data("bank-code")?c.data("bank-code"):"";var c=c&&c[0].innerText?c[0].innerText:"",d;a.getDOMElement("search-bank-text-box-input").val()&&(d=a.getDOMElement("search-bank-text-box-input").val().length);g?a.widget.publishSuccessSushiMetrics({ActionType:"UpiSearchBankComplete",ActionValueType:"UpiSearchBank",
ActionValue:"BankSelectionUsingSearchBox",ActionErrorCode:c+" inputSize "+d,ActionParentValueType:"OtherUpiPaymentMethod",ActionParentValue:"UpiInBoxPspRegistrationBottomSheet"}):a.widget.publishSuccessSushiMetrics({ActionType:"UpiSearchBankComplete",ActionValueType:"UpiSearchBank",ActionValue:"BankSelectionWithoutUsingSearchBox",ActionErrorCode:c,ActionParentValueType:"OtherUpiPaymentMethod",ActionParentValue:"UpiInBoxPspRegistrationBottomSheet"});g=!1;a._handleUPIRedirectionForUpiRegistration(b)})})}})});
t("components/ValidateUpiComponent",["form-component","css-utils","continuable","lang"],function(c,l,n,h){var f,m,k,A,d,r,b,a,g,y,u,q,z,K,C,w,B,e,x,F,M,G,p,L=!1,t=!1,H="false",I="",v="",E,J;return c.extend(n,{initialize:function(e,x){f=x.data.JsBindingEncryptedVpaInput;m=x.data.JsBindingValidateVpaButton;k=x.data.JsBindingAlertSuccess;A=x.data.JsBindingAlertFailure;d=x.data.JsBindingVerifiedVpaWarningMessage;r=x.data.JsBindingVerifiedVpaErrorMessage;b=x.data.JsBindingSectionSuccess;a=x.data.JsBindingInputHelpTextSection;
L=x.data.isPayWithBankAccountWithBottomSheetEnabled;g=x.data.JsBindingVpaToken;y=x.data.JsBindingPaymentMethodId;u=x.data.JsBindingValidateSuccessHelpTextSection;q=x.data.JsBindingRecurringInlineTextSection;t=x.data.isRecurringInlineMessageDisplayable;E=null;J=!1},bindToElements:function(){var c=this;z=this.getDOMElement(f);K=this.getDOMElement(m);C=this.getDOMElement(k);w=this.getDOMElement(A);B=this.getDOMElement(d);e=this.getDOMElement(r);x=this.getDOMElement(b);F=this.getDOMElement(a);M=this.getDOMElement(g);
$paymentMethodId=this.getDOMElement(y);G=this.getDOMElement(u);p=this.getDOMElement(q);this.watchContinuable(this,function(e){c.widget.trigger("ValidateUpiIdResultEvent",{isContinuable:e,isUpiRecurringEligible:J});c._doesInputContainValidVpa()&&c._displaySuccessMessage("",I,v);c.widget.trigger("PaymentPlanSelected",{isValid:e})});z.live("input propertychange",function(){c._setInputHelpTextVisible(!0);c.setContinuable(c._doesInputContainValidVpa()&&"false"===H);c._doesInputContainValidVpa()&&c._displaySuccessMessage("",
I,v)});c.setContinuable(c._doesInputContainValidVpa()&&"false"===H);z.focusout(this._canonicalizeInputTextField);K.click(function(){z.focusout();var e=c.form.validateForm();if(0<e.length)c._displayFormErrorMessages(e),c.widget.trigger("ValidateUpiIdResultEvent",{isContinuable:!1,isUpiRecurringEligible:!1});else{var a=z.val();c.widget.trigger("submitFormAjaxStarted");c.widget.continueRequest({"ppw-widgetState":c.widget.options.serializedState,"ppw-widgetEvent":"ValidateUpiIdEvent",__sif_encryptedVPA_collect:a},
{success:function(e){var b=e.additionalWidgetResponseData.additionalData.valid,x=e.additionalWidgetResponseData.additionalData.message,g=e.additionalWidgetResponseData.additionalData.vpaToken;J="true"===e.additionalWidgetResponseData.additionalData.isUpiRecurringEligible;var d=e.additionalWidgetResponseData.additionalData.paymentMethodId;H=e.additionalWidgetResponseData.additionalData.shouldSuppressValidatedVpa;I=e.additionalWidgetResponseData.additionalData.verifiedVpaWarningMessage;v=e.additionalWidgetResponseData.additionalData.verifiedVpaErrorMessage;
"true"===b?(E=a,c._setVpaTokenField(g),c._setPaymentMethodId(d),c.setContinuable("false"===H),c._displaySuccessMessage(x,I,v),L&&"false"===H&&c.widget.trigger("UpiIdValidateSuccess",{validatedUpiId:E,vpaToken:g,paymentMethodId:d,isUpiRecurringEligible:J,shouldAutoCloseBottomSheet:!(I||v)})):"false"===b?(E=null,c.setContinuable(!1),c._displayErrorMessage(x)):x&&(E=null,c.setContinuable(!0),c._displayErrorMessage(x))},complete:function(){c.widget.trigger("submitFormAjaxCompleted")}})}return!1})},_doesInputContainValidVpa:function(){return E&&
E===z.val()},_displayFormErrorMessages:function(a){0!==a.length&&(a=a[0],w.find(".a-alert-content").html(a.localizedMessageString),this.form.displayErrorMessage(a.field,w),l.hideElement(x),l.hideElement(F),l.hideElement(B),l.hideElement(e))},_displayVerifiedVpaMessage:function(e,a){e?(a.find(".a-alert-content").html(e),l.showElement(a)):l.hideElement(a)},_displayErrorMessage:function(e){w.find(".a-alert-content").html(e);l.showElement(w);l.hideElement(x);l.hideElement(F)},_displaySuccessMessage:function(a,
b,c){a&&C.find(".a-alert-content").html(a);(!L||b||c)&&l.showElement(x);J&&t?(l.showElement(p),l.hideElement(G)):(l.hideElement(p),l.showElement(G));this._displayVerifiedVpaMessage(b,B);this._displayVerifiedVpaMessage(c,e);b||c?l.hideElement(G):l.showElement(G);l.hideElement(w);l.hideElement(F)},_setInputHelpTextVisible:function(a){a?(l.showElement(F),l.hideElement(x),l.hideElement(w),l.hideElement(B),l.hideElement(e)):l.hideElement(F)},_canonicalizeInputTextField:function(){var e=h.trim(z.val());
z.val(e)},_setVpaTokenField:function(e){M.val(e)},_setPaymentMethodId:function(e){$paymentMethodId.val(e)}})});t("components/SelectableUpiListComponent","AUI!P component lang clog upiEvents sdkUtil deviceSignatureUtil".split(" "),function(c,l,n,h,f,m,k){return l.extend({isDeviceSignatureAlreadyChecked:!1,isSavedHandleComponentUsable:!1,useAmazonJsForDeviceSignatureCheck:!1,totalListItemComponentIndexes:0,savedHandleIndexes:[],isServerSideDeviceSignatureCheckEnabled:!1,isProd:!0,apxSandbox:"",initialize:function(c,
d){this.isSavedHandleComponentUsable=d.data.isSavedHandleComponentUsable;this.useAmazonJsForDeviceSignatureCheck=d.data.useAmazonJsForDeviceSignatureCheck;this.totalListItemComponentIndexes=d.data.totalListItemComponentIndexes;this.isServerSideDeviceSignatureCheckEnabled=d.data.isServerSideDeviceSignatureCheckEnabled;this.isProd=d.data.isProd;this.apxSandbox=d.data.apxSandbox},bindToEvents:function(){var c=this;n.bind(l.prototype.bindToEvents,this).apply();c.widget.on(f.JuspayCheckDeviceSignatureEventName,
c,function(d,k){c.savedHandleIndexes.includes(d)||c.savedHandleIndexes.push(d);c.isDeviceSignatureAlreadyChecked||(c.isDeviceSignatureAlreadyChecked=!0,m.getIsJuspaySdkCallEligible()?m.getIsDeviceSignatureCheckEligible()?m.checkDeviceSignature(c,d,k,m.juspayHandleDeviceSignatureMatchesHandler,m.juspayHandleDeviceSignatureDoesNotMatchHandler,m.juspayErrorHandler):c.widget.trigger(f.NoDevicePermissionsEventName):c.widget.trigger(f.ErrorEventName))});c.widget.on(f.CheckDeviceSignatureEventName,c,function(d,
m,b){var a=function(a,b){return"undefined"!==typeof a?a:b},g=function(b,c,g){c=a(c,!0);g=a(g,"_Count");c&&(h.logCounterMetric({feature:b,resource:g}),h.publishMetrics())},y=function(b,c,g){if(g=a(g,!0))h.logCounterMetric({feature:b,resource:"_Latency",startTime:c}),h.publishMetrics()};g("SelectableUpiAmazonJsCalls_DeviceSignatureCheck",b);this.deviceSignatureCheckStartTime=h.getCurrentTime();var l=function(){g("SelectableUpiAmazonJsCalls_DeviceSignatureCheck",b,"_SuccessCount");y("SelectableUpiAmazonJsCalls_DeviceSignatureCheck",
c.deviceSignatureCheckStartTime,b)},q=function(a){c.widget.trigger(f.DeviceFingerprintValidationPerformedEventName,{outcome:"SUCCESS"===a.status?a.status:a.responseCode,performedOn:c.deviceSignatureCheckStartTime,currentHandleIndex:d,totalHandleIndexes:c.totalListItemComponentIndexes});g("SelectableUpiJsCalls_DFValidationPerformedEvent",b);c.isSavedHandleComponentUsable&&("SUCCESS"===a.status?(c.widget.trigger(f.DeviceSignatureMatchesEventName,d,a.deviceSignature),l(),g("SelectableUpiAmazonJsCalls_DeviceSignatureCheck_SignatureMatch",
b)):"DEVICE_SIGNATURE_MISMATCH"===a.responseCode?(c.widget.trigger(f.DeviceSignatureDoesNotMatchEventName,d),l(),g("SelectableUpiAmazonJsCalls_DeviceSignatureCheck_SigMismatch",b)):"PERMISSION_NOT_GRANTED"===a.responseCode?(c.widget.trigger(f.NoDevicePermissionsEventName,d),l(),g("SelectableUpiAmazonJsCalls_DeviceSignatureCheck_NoPermissions",b)):this.isSavedHandleComponentUsable&&(c.widget.trigger(f.ErrorEventName),g("SelectableUpiAmazonJsCalls_DeviceSignatureCheck",b,"_ErrorCount"),y("SelectableUpiAmazonJsCalls_DeviceSignatureCheck",
c.deviceSignatureCheckStartTime,b)))};c.isServerSideDeviceSignatureCheckEnabled?q({status:"SUCCESS",deviceSignature:m}):k.checkDeviceSignature(m,q)});c.widget.on("componentsInitialized",c,function(){this.useAmazonJsForDeviceSignatureCheck?(!c.isProd&&p.location.toString().includes(c.apxSandbox)&&c.widget.trigger(f.DeviceSignatureCheckMockEventNameForApxSandbox),m.checkUPIIssuanceSupportedForJsLibApps(this)):(h.logCounterMetric({feature:"SelectableUpiSdkCalls",resource:"_Count"}),h.publishMetrics(),
this.sdkCallStartTime=h.getCurrentTime(),m.initializeDeviceSignatureCheck(this,m.juspayHasPermissionsHandler,m.juspayHasNoPermissionsHandler,m.juspayErrorHandler),m.checkUPIIssuanceSupported(this));this.isSavedHandleComponentUsable&&c.widget.trigger(f.GetPaymentMethodDetailsByIdEventName)})}})});t("components/SelectableUpiListItemComponent","component continuable events/InstrumentRowSelectedEvent events/ValidateInstrumentPreparationEvent events/AwaitInstrumentPreparedEvent events/InstrumentPreparedEvent events/PreparedInstrumentContinueErrorEvent public-event-registry css-utils components/SimplePaymentOptionListItemComponent lang upi-redirection-util clog events/spinner-events AwaitingEventStatusConstants upiEnums paymentMethodUtil checkBalanceUtil commonUtil eagerInitUtil jQuery".split(" "),
function(c,l,n,h,f,m,k,A,d,r,b,a,g,y,u,q,z,K,C,w,B){return r.extend(l,{selectableUpiContainer:"",upiDisabledApbMessageContainer:"",upiHeadingDiv:"",upiBankDetailsHeadingDiv:"",isPspNomenclatureEnabled:!1,upiAutoDeselectApbMessageContainer:"",upiInfoContainer:"",isUpiUsable:!0,instrumentId:"",instrumentType:"",isAPBSelected:!1,savedHandleIndex:"0",isPinChosen:!1,mPinLength:"",issuingPsp:"",responseClientContext:"",paymentMethodIdVersion:"",merchantCustomerId:"",deviceSignature:"",isDeviceSignatureValid:null,
isPermanentDisabled:!0,isAIPSRedirectRequired:null,redirectUrl:"",returnUrl:"",failureReturnUrl:"",purchaseId:"",isUpiIssuanceAPBMultiTenderEnabled:"",isUpiSavedHandleAPBMultiTenderEligible:!1,clientId:"",marketPlaceId:"",isApxReloadEnabled:!1,areReturnUrlsSentByClient:!1,isPurchaseIdRequired:!1,isUpiRegistrationEnabled:!1,isUpiAIPSRedirectionWithMTEnabled:!1,upiPermanentDisabledMessageContainer:"",incorrectUpiPinErrorMessageContainer:"",incorrectUpiPinLimitBreachedContainer:"",httpMethod:"",isMergedInlineView:!1,
isTurboView:!1,sdkCallStatus:null,instrumentPreparationStatus:null,isAwaitingInstrumentPrepare:!1,continueClickTime:null,hasContinueTimedOut:!1,failureReason:null,errorMessage:null,isFirstTimeInstrumentSelection:!0,isApbAutoDeselectedOnce:!1,isAutoDeselectApbForUpiIssuanceEnabled:!1,isRecurringChargePaymentMethod:!1,orderId:"",enableGetReturnHttpMethod:!1,enableOrderIdInClientContext:!1,enableMultiTenderContextInUPIRedirectionClientContext:!1,aipsOnboardingEndpointUrl:"",upiCheckBalanceTurboInlineErrorMessage:"",
upiCheckBalanceEnabledContainer:"",upiCheckBalanceEnabledTextId:"",incorrectUpiPinCta:"",incorrectUpiPinLimitBreachedCta:"",upiCheckingBalanceEnabledContainer:"",upiAccountBalanceEnabledContainer:"",upiAccountBalanceDisplayEnabledContainer:"",upiCheckBalanceEnabled:!1,npciKey:"",customerVpa:"",bankAccountUniqueId:"",getPMS2SCallStatus:"",customerMobileNumber:"",bankName:"",bankTail:"",$checkBalanceLabel:"",$checkingBalanceLabel:"",$accountBalanceLabel:"",$accountBalanceDisplayLabel:"",$checkBalanceTextId:"",
$incorrectUpiPinCta:"",$incorrectUpiPinLimitBreachedCta:"",$checkBalanceErrorBottomSheet:"",upiCheckBalanceErrorBottomSheetPreloadDomId:"",upiCheckBalanceWrongMpinContainer:"",upiCheckBalanceMaxRetriesExceededContainer:"",upiCheckBalanceScreenRecordingOnContainer:"",upiCheckBalanceTimeoutErrorContainer:"",upiCheckBalanceGenericErrorContainer:"",upiAmazonPayBalance:0,upiMaybeAdjustedPurchaseTotal:0,isApbAndUpiBalanceMoreThanPurchaseTotal:!1,upiCheckBalanceUpfrontInsufficientBalanceMessageContainer:"",
upiCheckBalanceUpfrontRetriesExceededMessageContainer:"",upiCheckBalanceUpfrontRetriesExceededResetHere:"",upiCheckBalanceWrongMpinInlineTryAgain:"",upiCheckBalanceScreenRecordingOnInlineTryAgain:"",upiCheckBalanceNoResponseBankInlineTryAgain:"",upiCheckBalanceGenericErrorInlineTryAgain:"",revisePaymentFailureReason:"",revisePaymentInstrumentId:"",hasPinBeenReset:!1,isUpiDisabledDueToUpfrontErrorMessage:!1,isUpiPreselectedInTurbo:!1,$topBankAvailable:0,$allBankAvailable:0,$ccBankAvailable:0,$topBanksList:"",
$allBanksList:"",$ccBanksList:"",$topBanksHeader:"",$allBanksHeader:"",$ccBanksHeader:"",$noBankFoundText:"",bottomSheetOpenTime:null,incorrectUpiPinEntered:!1,incorrectUpiPinMaxRetriesExceeded:!1,delegateUpiProcessing:!1,$incorrectUpiPinErrorMessageContainerWrapper:"",$incorrectUpiPinLimitBreachedContainerWrapper:"",eagerInitNpciClWeblabTreatment:"",upiPaymentMethodCategory:v,reloadPspOnReappear:!1,isPrimarySavedHandle:!1,pspMaBspConvergenceWeblabTreatment:"",isCreditCardOnUPIRegistrationEnabledForRetailTreatment:"",
isPspMaBspConvergenceWeblabEnabled:!1,isPspBspConvergenceWeblabEnabled:!1,isUPIInBoxWeblabEnabled:!1,isCreditCardOnUPIRegistrationEnabledForRetail:!1,enableUpi1pforApxSandbox:!1,isDfpMismatchErrorMessageAvailableForCheckBalance:!1,isDfpMismatchViolationPresent:!1,upiCheckBalanceUpfrontDfpMismatchContainer:"",upiCheckBalanceUpfrontDfpMismatchCtaContainer:"",shouldDisplayCreditCardBanks:!1,initialize:function(e,a){this.isUpiUsable=a.data.isUpiUsable;this.instrumentId=a.data.instrumentId;this.instrumentType=
a.data.instrumentType;this.selectableUpiContainer=a.data.selectableUpiContainer;this.upiDisabledApbMessageContainer=a.data.upiDisabledApbMessageContainer;this.upiHeadingDiv=a.data.upiHeadingDiv;this.upiBankDetailsHeadingDiv=a.data.upiBankDetailsHeadingDiv;this.isPspNomenclatureEnabled=a.data.isPspNomenclatureEnabled;this.upiAutoDeselectApbMessageContainer=a.data.upiAutoDeselectApbMessageContainer;this.upiInfoContainer=a.data.upiInfoContainer;this.savedHandleIndex=a.data.savedHandleIndex;this.isPinChosen=
a.data.isPinChosen;this.mPinLength=a.data.mPinLength;this.issuingPsp=a.data.issuingPsp;this.bankName=a.data.bankName;this.bankTail=a.data.bankTail;this.marketPlaceId=a.data.marketPlaceId;this.merchantCustomerId=a.data.merchantCustomerId;this.deviceSignature=a.data.deviceSignature;this._toggleUncheckAPBtoEnableUPIMessage(!1);this._toggleUPIInfoContainer(!1);this.redirectUrl=a.data.redirectUrl;this.returnUrl=a.data.returnUrl;this.failureReturnUrl=a.data.failureReturnUrl;this.purchaseId=a.data.purchaseId;
this.orderId=a.data.orderId;this.isPurchaseIdRequired=a.data.isPurchaseIdRequired;this.areReturnUrlsSentByClient=a.data.areReturnUrlsSentByClient;this.isUpiIssuanceAPBMultiTenderEnabled=a.data.isUpiIssuanceAPBMultiTenderEnabled;this.clientId=a.data.clientId;this.isApxReloadEnabled=a.data.isApxReloadEnabled;this.isUpiRegistrationEnabled=a.data.isUpiRegistrationEnabled;this.upiPermanentDisabledMessageContainer=a.data.upiPermanentDisabledMessageContainer;this.incorrectUpiPinErrorMessageContainer=a.data.incorrectUpiPinErrorMessageContainer;
this.incorrectUpiPinLimitBreachedContainer=a.data.incorrectUpiPinLimitBreachedContainer;this.upiSdkCallFailedMessageContainer=a.data.upiSdkCallFailedMessageContainer;this.isPaylastEligible=a.data.isPaylastEligible;this.showFloatingContinueBarOnNonPaylastPSP=a.data.showFloatingContinueBarOnNonPaylastPSP;this.isAmazonApp=a.data.isAmazonApp;this.httpMethod=a.data.httpMethod;this.isMergedInlineView=a.data.isMergedInlineView;this.isTurboView=a.data.isTurboView;this.isAutoDeselectApbForUpiIssuanceEnabled=
a.data.isAutoDeselectApbForUpiIssuanceEnabled;this.isSavedHandleOriginallySelectable=a.data.isSavedHandleOriginallySelectable;this.handleSavedHandleContinueError=a.data.handleSavedHandleContinueError;this.sdkCallStatus=q.SdkCallStatusEnum.Pending;this.instrumentPreparationStatus=u.Pending;this.errorMessage=[this._buildErrorMessage()];this.isRecurringChargePaymentMethod=a.data.isRecurringChargePaymentMethod;this.enableGetReturnHttpMethod=a.data.enableGetReturnHttpMethod;this.enableOrderIdInClientContext=
a.data.enableOrderIdInClientContext;this.enableMultiTenderContextInUPIRedirectionClientContext=a.data.enableMultiTenderContextInUPIRedirectionClientContext;this.aipsOnboardingEndpointUrl=a.data.aipsOnboardingEndpointUrl;this.upiCheckBalanceEnabledContainer=a.data.upiCheckBalanceEnabledContainer;this.upiCheckBalanceEnabledTextId=a.data.upiCheckBalanceEnabledTextId;this.incorrectUpiPinCta=a.data.incorrectUpiPinCta;this.incorrectUpiPinLimitBreachedCta=a.data.incorrectUpiPinLimitBreachedCta;this.upiCheckingBalanceEnabledContainer=
a.data.upiCheckingBalanceEnabledContainer;this.upiAccountBalanceEnabledContainer=a.data.upiAccountBalanceEnabledContainer;this.upiAccountBalanceDisplayEnabledContainer=a.data.upiAccountBalanceDisplayEnabledContainer;this.upiCheckBalanceEnabled=a.data.upiCheckBalanceEnabled;this.getPMS2SCallStatus=q.GetPMCallStatusEnum.Pending;this.upiCheckBalanceErrorBottomSheetPreloadDomId=a.data.upiCheckBalanceErrorBottomSheetPreloadDomId;this.upiCheckBalanceWrongMpinContainer=a.data.upiCheckBalanceWrongMpinContainer;
this.upiCheckBalanceMaxRetriesExceededContainer=a.data.upiCheckBalanceMaxRetriesExceededContainer;this.upiCheckBalanceScreenRecordingOnContainer=a.data.upiCheckBalanceScreenRecordingOnContainer;this.upiCheckBalanceTimeoutErrorContainer=a.data.upiCheckBalanceTimeoutErrorContainer;this.upiCheckBalanceGenericErrorContainer=a.data.upiCheckBalanceGenericErrorContainer;this.upiCheckBalanceUpfrontInsufficientBalanceMessageContainer=a.data.upiCheckBalanceUpfrontInsufficientBalanceMessageContainer;this.upiCheckBalanceUpfrontRetriesExceededMessageContainer=
a.data.upiCheckBalanceUpfrontRetriesExceededMessageContainer;this.upiCheckBalanceUpfrontRetriesExceededResetHere=a.data.upiCheckBalanceUpfrontRetriesExceededResetHere;this.upiCheckBalanceWrongMpinInlineTryAgain=a.data.upiCheckBalanceWrongMpinTryAgain;this.upiCheckBalanceScreenRecordingOnInlineTryAgain=a.data.upiCheckBalanceScreenRecordingOnTryAgain;this.upiCheckBalanceNoResponseBankInlineTryAgain=a.data.upiCheckBalanceNoResponseFromBankTryAgain;this.upiCheckBalanceGenericErrorInlineTryAgain=a.data.upiCheckBalanceGenericErrorTryAgain;
this.upiCheckBalanceTurboInlineErrorMessage=a.data.upiCheckBalanceTurboInlineErrorMessage;this.upiAmazonPayBalance=a.data.upiAmazonPayBalance;this.upiMaybeAdjustedPurchaseTotal=a.data.upiMaybeAdjustedPurchaseTotal;this.revisePaymentFailureReason=a.data.revisePaymentFailureReason;this.revisePaymentInstrumentId=a.data.revisePaymentInstrumentId;this.isUpiPreselectedInTurbo=a.data.isUpiPreselectedInTurbo;this.hasPinBeenReset=(new URL(p.location.href)).searchParams.get("pinResetSuccessful")||!1;this.eagerInitNpciClWeblabTreatment=
a.data.eagerInitNpciClWeblabTreatment;this.delegateUpiProcessing=a.data.delegateUpiProcessing;this.upiPaymentMethodCategory=a.data.upiPaymentMethodCategory;this.reloadPspOnReappear=a.data.reloadPspOnReappear;this.isPrimarySavedHandle=a.data.isPrimarySavedHandle;this.pspMaBspConvergenceWeblabTreatment=a.data.pspMaBspConvergenceWeblabTreatment;this.isCreditCardOnUPIRegistrationEnabledForRetailTreatment=a.data.isCreditCardOnUPIRegistrationEnabledForRetailTreatment;this.isPspMaBspConvergenceWeblabEnabled=
a.data.isPspMaBspConvergenceWeblabEnabled;this.isCreditCardOnUPIRegistrationEnabledForRetail=a.data.isCreditCardOnUPIRegistrationEnabledForRetail;this.isUPIInBoxWeblabEnabled=a.data.isUPIInBoxWeblabEnabled;this.enableUpi1pforApxSandbox=a.data.enableUpi1pforApxSandbox;this.isUpiAIPSRedirectionWithMTEnabled=a.data.isUpiAIPSRedirectionWithMTEnabled;this.isDfpMismatchErrorMessageAvailableForCheckBalance=a.data.isDfpMismatchErrorMessageAvailableForCheckBalance;this.isDfpMismatchViolationPresent=a.data.isDfpMismatchViolationPresent;
this.upiCheckBalanceUpfrontDfpMismatchContainer=a.data.upiCheckBalanceUpfrontDfpMismatchContainer;this.upiCheckBalanceUpfrontDfpMismatchCtaContainer=a.data.upiCheckBalanceUpfrontDfpMismatchCtaContainer;this.shouldDisplayCreditCardBanks=a.data.shouldDisplayCreditCardBanks;this.isAmazonApp&&this.isSavedHandleOriginallySelectable&&this.isUpiUsable?(this.isPermanentDisabled=!1,this.isUpiSavedHandleAPBMultiTenderEligible=this.isUpiIssuanceAPBMultiTenderEnabled):this.isAmazonApp?this.setDisabled(!0):this.isAIPSRedirectRequired=
this.isPermanentDisabled=!1;this.isUpiUsable&&(this.isUpiSavedHandleAPBMultiTenderEligible=this.isUpiIssuanceAPBMultiTenderEnabled,A.register(n));this.isUpiPreselectedInTurbo&&this._onInstrumentSelected();this.$incorrectUpiPinErrorMessageContainerWrapper=this.getDOMElement(this.incorrectUpiPinErrorMessageContainer);this.$incorrectUpiPinLimitBreachedContainerWrapper=this.getDOMElement(this.incorrectUpiPinLimitBreachedContainer);this.upiCheckBalanceEnabled&&(this.$checkBalanceLabel=this.getDOMElement(this.upiCheckBalanceEnabledContainer),
this.$checkingBalanceLabel=this.getDOMElement(this.upiCheckingBalanceEnabledContainer),this.$accountBalanceLabel=this.getDOMElement(this.upiAccountBalanceEnabledContainer),this.$accountBalanceDisplayLabel=this.getDOMElement(this.upiAccountBalanceDisplayEnabledContainer),this.isDfpMismatchErrorMessageAvailableForCheckBalance&&this.isDfpMismatchViolationPresent&&(this._toggleCheckBalanceContainer(!1),this._toggleUpiCheckBalanceDfpMismatchMessage(!0)))},_onInstrumentSelected:function(){this._getContainerElement().addClass("pmts-selected");
this._getInstrumentSelectionInputElement().prop("checked",!0);this._toggleUPIInfoContainer(!0);!this.isUpiSavedHandleAPBMultiTenderEligible&&this.isAPBSelected&&this.isAutoDeselectApbForUpiIssuanceEnabled&&this._setFlagAndToggleMsgForAutoDeselectApb();this._triggerBackingInstrumentSelectedEvent();(this.isPaylastEligible||this.showFloatingContinueBarOnNonPaylastPSP)&&this._resetOrderTotalComputation();this.getDOMElement("UpiRecurringInlineMessage")[0]&&this.showPaymentMethodInlineMessage();this.isTurboView&&
this.upiCheckBalanceEnabled&&this.isAIPSRedirectRequired&&this._toggleCheckBalanceContainer(!1);w.performNpciClEagerInit(this.eagerInitNpciClWeblabTreatment,this._isInstrumentSelected(),this.sdkCallStatus,this._isUpiRedirectionRequired(),!1,this._getMetadata())},_onInstrumentDeselected:function(){this._getContainerElement().removeClass("pmts-selected");this._getInstrumentSelectionInputElement().prop("checked",!1);this._toggleUPIInfoContainer(!1);this._toggleUpiAutoDeselectAPBMessage(!1);this.getDOMElement("UpiRecurringInlineMessage")[0]&&
this.hidePaymentMethodInlineMessage()},_isInstrumentSelected:function(){return this.isMergedInlineView?!0:this._getContainerElement().hasClass("pmts-selected")},showPaymentMethodInlineMessage:function(){this._togglePaymentMethodInlineMessage(!0)},hidePaymentMethodInlineMessage:function(){this._togglePaymentMethodInlineMessage(!1)},_togglePaymentMethodInlineMessage:function(e){d.toggleElement(this.getDOMElement("UpiRecurringInlineMessage"),e)},_getContainerElement:function(){return this.getDOMElement(this.selectableUpiContainer)},
_isUpiBalanceShown:function(){var e=this.getDOMElement(this.upiAccountBalanceEnabledContainer);return e!==v&&0<e.length&&!d.hasAUIHiddenClass(e)},_isCheckBalanceUpFrontErrorMessageShown:function(){var e=!1,a=this.getDOMElement(this.upiCheckBalanceUpfrontInsufficientBalanceMessageContainer),b=this.getDOMElement(this.upiCheckBalanceUpfrontRetriesExceededMessageContainer);a!==v&&0<a.length&&!d.hasAUIHiddenClass(a)?e=!0:b!==v&&0<b.length&&!d.hasAUIHiddenClass(b)&&(e=!0);return e},_toggleUPIContainer:function(e){var a=
this._getContainerElement();0<a.length&&d.toggleElement(a,e)},_toggleCheckBalanceContainer:function(e){var a=this.getDOMElement(this.upiCheckBalanceEnabledContainer);a!==v&&0<a.length&&d.toggleElement(a,e)},_toggleCheckingBalanceContainer:function(e){var a=this.getDOMElement(this.upiCheckingBalanceEnabledContainer);a!==v&&0<a.length&&d.toggleElement(a,e)},_toggleUncheckAPBtoEnableUPIMessage:function(e){var a=this.getDOMElement(this.upiDisabledApbMessageContainer);0<a.length&&d.toggleElement(a,e)},
_toggleUpiInsufficientBalance:function(e){var a=this.getDOMElement(this.upiCheckBalanceUpfrontInsufficientBalanceMessageContainer);a!==v&&0<a.length&&d.toggleElement(a,e)},_toggleUpiUpfrontRetriesExceededErrorMessage:function(e){var a=this.getDOMElement(this.upiCheckBalanceUpfrontRetriesExceededMessageContainer);a!==v&&0<a.length&&d.toggleElement(a,e)},_toggleUpiCheckBalanceTurboInlineErrorMessage:function(e){var a=this.getDOMElement(this.upiCheckBalanceTurboInlineErrorMessage);a!==v&&0<a.length&&
d.toggleElement(a,e)},_toggleUPIInfoContainer:function(e){var a=this.getDOMElement(this.upiInfoContainer);0<a.length&&d.toggleElement(a,e)},_toggleUPIPermanentDisabledMessage:function(e){var a=this.getDOMElement(this.upiPermanentDisabledMessageContainer);0<a.length&&d.toggleElement(a,e)},_toggleUPISdkCallFailedMessage:function(e){var a=this.getDOMElement(this.upiSdkCallFailedMessageContainer);0<a.length&&d.toggleElement(a,e)},_toggleUpiAutoDeselectAPBMessage:function(e){var a=this.getDOMElement(this.upiAutoDeselectApbMessageContainer);
0<a.length&&d.toggleElement(a,e)},_toggleUpiCheckBalanceDfpMismatchMessage:function(e){var a=this.getDOMElement(this.upiCheckBalanceUpfrontDfpMismatchContainer);0<a.length&&d.toggleElement(a,e)},_triggerUpiRedirectionRequiredEvent:function(){this.widget.trigger("UpiRedirectionRequiredEvent")},_triggerBackingInstrumentSelectedEvent:function(){this.widget.trigger("backingInstrumentSelected",{instrumentId:this._getInstrumentId(),instrumentType:this._getInstrumentType(),errors:[],paymentMethod:this.data.paymentMethod,
isUpiRedirectionRequired:this._isUpiRedirectionRequired(),paystationPaymentMethodCategory:this.upiPaymentMethodCategory});this._publishMetricsOnInstrumentSelection()},_isUpiRedirectionRequired:function(){return!1!==this.isAIPSRedirectRequired},_publishMetricsOnInstrumentSelection:function(){this.isSavedHandleOriginallySelectable&&this.isFirstTimeInstrumentSelection&&(this.sdkCallStatus===q.SdkCallStatusEnum.Pending?g.logCounterMetric({feature:"SavedHandleSdkCallPendingOnSelection",resource:"_Count"}):
g.logCounterMetric({feature:"SavedHandleSdkCallCompletedOnSelection",resource:"_Count"}),g.publishMetrics(),this.isFirstTimeInstrumentSelection=!1)},_invalidatePaymentPlan:function(){this.setContinuable(!1);this.widget.trigger("PaymentPlanSelected",{isValid:!1})},_setAPBSelectionChanged:function(e){if(!this.isAutoDeselectApbForUpiIssuanceEnabled||this.isApbAutoDeselectedOnce)!this.isUpiUsable||this.isPermanentDisabled||this.isUpiSavedHandleAPBMultiTenderEligible?this.isUpiUsable&&!this.isPermanentDisabled&&
this.isUpiSavedHandleAPBMultiTenderEligible&&this.isApbAndUpiBalanceMoreThanPurchaseTotal&&this._isUpiBalanceShown()&&(this._toggleUpiInsufficientBalance(!e),this.isUpiDisabledDueToUpfrontErrorMessage=!e,this.setDisabled(!e)):(this._isInstrumentSelected()&&e&&(this._invalidatePaymentPlan(),this._toggleUpiAutoDeselectAPBMessage(!1)),this._isUpiBalanceShown()||this._toggleCheckBalanceContainer(!e),this.isTurboView&&this.upiCheckBalanceEnabled&&this.isAIPSRedirectRequired&&this._hideAllCheckBalanceRelatedLabel(),
this._isCheckBalanceUpFrontErrorMessageShown()||(this.setDisabled(e),this.isPspNomenclatureEnabled&&(e?(this.getDOMElement(this.upiHeadingDiv).addClass("apx-disabled-opacity"),this.getDOMElement(this.upiBankDetailsHeadingDiv).addClass("apx-disabled-opacity")):(this.getDOMElement(this.upiHeadingDiv).removeClass("apx-disabled-opacity"),this.getDOMElement(this.upiBankDetailsHeadingDiv).removeClass("apx-disabled-opacity"))),this._toggleUncheckAPBtoEnableUPIMessage(e),this.incorrectUpiPinEntered?d.toggleElement(this.$incorrectUpiPinErrorMessageContainerWrapper,
!e):this.incorrectUpiPinMaxRetriesExceeded&&d.toggleElement(this.$incorrectUpiPinLimitBreachedContainerWrapper,!e))),this._setInstrumentPreparationStatus()},_updateFlagsAndWidgetStateOnTerminalSdkResponse:function(){this.isUpiSavedHandleAPBMultiTenderEligible=this.isAIPSRedirectRequired?this.isUpiIssuanceAPBMultiTenderEnabled&&this.isUpiRegistrationEnabled&&(this.isApxReloadEnabled||this.isUpiAIPSRedirectionWithMTEnabled):this.isUpiIssuanceAPBMultiTenderEnabled;this.delegateUpiProcessing&&this.widget.trigger("updateDeviceSignatureCheckStatus",
{deviceSignatureCheckStatus:this.sdkCallStatus});this._setInstrumentPreparationStatus();this._publishMetricsOnSdkCallCompletion();this._autoDeselectApbIfMultitenderNotSupported();w.performNpciClEagerInit(this.eagerInitNpciClWeblabTreatment,this._isInstrumentSelected(),this.sdkCallStatus,this._isUpiRedirectionRequired(),this.isAwaitingInstrumentPrepare,this._getMetadata());this._triggerInstrumentPreparedEvent();this.sdkCallStatus===q.SdkCallStatusEnum.Error||this.isAIPSRedirectRequired&&!this.isUpiRegistrationEnabled?
this._setDisabled(!0):(this._setEnabled(),this.isTurboView&&this.upiCheckBalanceEnabled&&this.isAIPSRedirectRequired&&this._hideAllCheckBalanceRelatedLabel(),this.revisePaymentInstrumentId!==this._getInstrumentId()||this.hasPinBeenReset||("AuthenticationDenied"===this.revisePaymentFailureReason?(d.toggleElement(this.$incorrectUpiPinErrorMessageContainerWrapper,!0),this.incorrectUpiPinEntered=!0):"MaxRetriesExceeded"===this.revisePaymentFailureReason&&(d.toggleElement(this.$incorrectUpiPinLimitBreachedContainerWrapper,
!0),this.incorrectUpiPinMaxRetriesExceeded=!0)));this._setAPBSelectionChanged(this.isAPBSelected)},_setInstrumentPreparationStatus:function(){this.sdkCallStatus===q.SdkCallStatusEnum.Error?(this.instrumentPreparationStatus=u.Failure,this.failureReason=q.FailureReasonEnum.SdkError):this.isAIPSRedirectRequired&&!this.isUpiRegistrationEnabled?(this.instrumentPreparationStatus=u.Failure,this.failureReason=q.FailureReasonEnum.AIPSRedirectionNotEnabled):this._isInstrumentSelected()&&this.isAPBSelected&&
!this.isUpiSavedHandleAPBMultiTenderEligible?(this.instrumentPreparationStatus=u.Failure,this.failureReason=q.FailureReasonEnum.MultitenderNotSupported):(this.instrumentPreparationStatus=this.sdkCallStatus===q.SdkCallStatusEnum.Pending?u.Pending:this.delegateUpiProcessing&&this.getPMS2SCallStatus===q.GetPMCallStatusEnum.Pending?u.Pending:u.Success,this.failureReason=null);this.errorMessage=[this._buildErrorMessage()]},_buildErrorMessage:function(){return this.handleSavedHandleContinueError&&this.instrumentPreparationStatus!==
u.Success?this.failureReason===q.FailureReasonEnum.SdkError?this.widget.getLocalizedString("apx_upi_savedHandle_continue_sdk_error"):this.failureReason===q.FailureReasonEnum.AIPSRedirectionNotEnabled?this.widget.getLocalizedString("apx_upi_savedHandle_continue_redirection_error"):this.failureReason===q.FailureReasonEnum.MultitenderNotSupported?this.widget.getLocalizedString("apx_upi_savedHandle_continue_multi_tender_error"):this.widget.getLocalizedString("apx_upi_savedHandle_continue_error"):null},
_triggerInstrumentPreparedEvent:function(){this.isSavedHandleOriginallySelectable&&this._isInstrumentSelected()&&this.isAwaitingInstrumentPrepare&&(!this.delegateUpiProcessing||this.getPMS2SCallStatus!==q.GetPMCallStatusEnum.Pending)&&this.widget.trigger(m,{instrumentId:this._getInstrumentId(),instrumentPreparationStatus:this.instrumentPreparationStatus,isUpiRedirectionRequired:this._isUpiRedirectionRequired(),failureReason:this.failureReason,errorMessage:this.errorMessage})},_publishMetricsOnSdkCallCompletion:function(){if(this.isSavedHandleOriginallySelectable){var e=
this.continueClickTime?"AfterContinue":"BeforeContinue";this.hasContinueTimedOut&&(e="AfterContinueTimedout");this.sdkCallStatus!==q.SdkCallStatusEnum.Completed||this.isAIPSRedirectRequired||g.logCounterMetric({feature:"SavedHandleHappyCase_"+e,resource:"_Count"});this.sdkCallStatus===q.SdkCallStatusEnum.Completed&&this.isAIPSRedirectRequired&&g.logCounterMetric({feature:"SavedHandleUnhappyCase_"+e,resource:"_Count"});this.sdkCallStatus===q.SdkCallStatusEnum.Error&&g.logCounterMetric({feature:"SavedHandleSdkError_"+
e,resource:"_Count"});this.continueClickTime&&(this.sdkCallStatus===q.SdkCallStatusEnum.Error?g.logLatencyMetric({feature:"SavedHandleSdkCallError_"+e,resource:"_Latency",startTime:this.continueClickTime}):g.logLatencyMetric({feature:"SavedHandleSdkCallSuccess_"+e,resource:"_Latency",startTime:this.continueClickTime}),g.logLatencyMetric({feature:"SavedHandleSdkCallCompletion_AfterContinue_Overall",resource:"_Latency",startTime:this.continueClickTime}));g.publishMetrics()}},_autoDeselectApbIfMultitenderNotSupported:function(){this.isAutoDeselectApbForUpiIssuanceEnabled&&
this._isInstrumentSelected()&&this.isAPBSelected&&!this.isUpiSavedHandleAPBMultiTenderEligible&&!this.isAwaitingInstrumentPrepare&&(this._setFlagAndToggleMsgForAutoDeselectApb(),this._triggerUpiRedirectionRequiredEvent())},_setDisabled:function(e){if(!this.isSavedHandleOriginallySelectable||this.handleSavedHandleContinueError)this._isInstrumentSelected()&&this._invalidatePaymentPlan(),this.isPermanentDisabled=!0,this.setDisabled(!0),this._toggleCheckBalanceContainer(!1),e&&(this.failureReason===q.FailureReasonEnum.SdkError?
this._toggleUPISdkCallFailedMessage(!0):this._toggleUPIPermanentDisabledMessage(!0))},_setEnabled:function(){this.isSavedHandleOriginallySelectable||(this.isPermanentDisabled=!1,this.setDisabled(!1))},_handlePreparedInstrumentContinueError:function(e){e===u.TimedOut&&(this.hasContinueTimedOut=!0,g.logCounterMetric({feature:"SavedHandleSdkCallTimedOut",resource:"_Count"}),g.publishMetrics());this.isAwaitingInstrumentPrepare=!1;this.failureReason===q.FailureReasonEnum.MultitenderNotSupported?this._handleMultitenderContinueErrorCase():
this.failureReason===q.FailureReasonEnum.SdkError?this._setDisabled(!0):this._setDisabled(!1)},_handleMultitenderContinueErrorCase:function(){this.isAutoDeselectApbForUpiIssuanceEnabled?(this._setFlagAndToggleMsgForAutoDeselectApb(),this._triggerUpiRedirectionRequiredEvent()):this._setAPBSelectionChanged(this.isAPBSelected)},_setFlagAndToggleMsgForAutoDeselectApb:function(){this.isApbAutoDeselectedOnce=!0;this._toggleUpiAutoDeselectAPBMessage(this.isAPBSelected)},_resetOrderTotalComputation:function(){this.widget.trigger("UpdateOrderTotalForIBDEvent",
{ibdAmountDisplayed:0});this.widget.trigger("UpdateOrderTotalForNoCostEMIDiscount",{noCostEMIValue:0})},_storeGetPMDetailsResponse:function(){this.getPMS2SCallStatus===q.GetPMCallStatusEnum.Completed?this.widget.trigger("storePaymentMethodDetailsResponse",{getPMS2SCallStatus:this.getPMS2SCallStatus,issuingPsp:this.issuingPsp,responseClientContext:this.responseClientContext,bankTail:this.bankTail,mPinLength:this.mPinLength,paymentMethodIdVersion:this.paymentMethodIdVersion,deviceSignature:this.deviceSignature,
npciKey:this.npciKey,customerVpa:this.customerVpa,bankAccountUniqueId:this.bankAccountUniqueId,customerMobileNumber:this.customerMobileNumber,bankName:this.bankName,instrumentId:this.instrumentId}):this.widget.trigger("storePaymentMethodDetailsResponse",{getPMS2SCallStatus:this.getPMS2SCallStatus})},_removeGetPMDetailsResponse:function(){this.widget.trigger("removePaymentMethodDetailsResponse",{instrumentId:this.instrumentId})},_getMetadata:function(){return{clientName:"APX",clientId:this.clientId,
merchantCustomerId:this.merchantCustomerId}},bindToEvents:function(){var e=this;b.bind(r.prototype.bindToEvents,this).apply();b.forEach(["initializeRecommendedInstrument",n],function(a){e.widget.on(a,e,function(a){a.instrumentId!==e._getInstrumentId()||!e.isUpiUsable||e.isAPBSelected&&!e.isUpiSavedHandleAPBMultiTenderEligible?(e._onInstrumentDeselected(),e.delegateUpiProcessing&&e._removeGetPMDetailsResponse()):(e._onInstrumentSelected(),e.delegateUpiProcessing&&e._storeGetPMDetailsResponse())})});
e.widget.on("apbSelectionChanged",e,function(a){e.widget.get("apbCheckboxSelected")!==v&&(e.isAPBSelected=a.isSelected,e._setAPBSelectionChanged(e.isAPBSelected),e.giftCardId=a.giftCardId,e.storedValueId=a.storedValueId)});e.widget.on("DeviceSignatureMatchesEvent",e,function(a,b){e.isUpiUsable&&e.savedHandleIndex===a&&(e.sdkCallStatus=q.SdkCallStatusEnum.Completed,this.isDeviceSignatureValid=e.deviceSignature===b,this.isAIPSRedirectRequired=!(this.isDeviceSignatureValid&&this.isPinChosen),this.upiCheckBalanceEnabled&&
this.isDfpMismatchErrorMessageAvailableForCheckBalance&&(this.isDfpMismatchViolationPresent?g.logCounterMetric({feature:"DfpMismatchViolationPresent_And_DfpMatched",resource:"_Count"}):g.logCounterMetric({feature:"DfpMismatchViolationNotPresent_And_DfpMatched",resource:"_Count"})),e._updateFlagsAndWidgetStateOnTerminalSdkResponse())});e.widget.on("DeviceSignatureDoesNotMatchEvent",e,function(a){e.isUpiUsable&&e.savedHandleIndex===a&&(e.sdkCallStatus=q.SdkCallStatusEnum.Completed,e.isDeviceSignatureValid=
!1,e.isAIPSRedirectRequired=!0,this.upiCheckBalanceEnabled&&this.isDfpMismatchErrorMessageAvailableForCheckBalance&&(this.isDfpMismatchViolationPresent?g.logCounterMetric({feature:"DfpMismatchViolationPresent_And_DfpMismatched",resource:"_Count"}):g.logCounterMetric({feature:"DfpMismatchViolationNotPresent_And_DfpMismatched",resource:"_Count"})),e._updateFlagsAndWidgetStateOnTerminalSdkResponse())});e.widget.on("JuspayHasPermissionsEvent",e,function(){e.widget.trigger("JuspayCheckDeviceSignatureEvent",
this.savedHandleIndex,this.deviceSignature)});e.widget.on("NoDevicePermissionsEvent",e,function(){e.isUpiUsable&&(e.sdkCallStatus=q.SdkCallStatusEnum.Completed,e.isAIPSRedirectRequired=!0,e._updateFlagsAndWidgetStateOnTerminalSdkResponse())});e.widget.on("ErrorEvent",e,function(){e.sdkCallStatus=q.SdkCallStatusEnum.Error;e.isAIPSRedirectRequired=!1;e._updateFlagsAndWidgetStateOnTerminalSdkResponse()});e.widget.on("InitializeDeviceSignatureCheckEvent",e,function(){null!=this.isPrimarySavedHandle&&
e.widget.trigger("CheckDeviceSignatureEvent",this.savedHandleIndex,this.deviceSignature,this.isPrimarySavedHandle)});e.widget.on("DeviceSignatureCheckMockEventNameForApxSandbox",e,function(){this.enableUpi1pforApxSandbox&&(this.isAIPSRedirectRequired=!1,e.widget.trigger("DeviceSignatureMatchesEvent",this.savedHandleIndex,this.deviceSignature))});e.widget.on("GetPaymentMethodDetailsByIdEvent",e,function(){if(this.delegateUpiProcessing){var a=g.getCurrentTime();g.logCounterMetric({feature:"SelectableUpiCalls_GetPMDetailsById_UpfrontFetch",
resource:"_Count"});g.publishMetrics();z.getPaymentMethodDetailsById({payerPaymentMethodId:e.instrumentId,obfuscatedMarketplaceId:e.marketPlaceId,url:e.aipsOnboardingEndpointUrl},function(b){"SUCCESS"===b.status?(e.getPMS2SCallStatus=q.GetPMCallStatusEnum.Completed,e.issuingPsp=b.issuingPsp,e.responseClientContext=b.clientContext,e.bankTail=b.payerBankTail,e.mPinLength=b.payerMpinLength,e.paymentMethodIdVersion=b.version,e.npciKey=b.npciKey,e.customerVpa=b.payerVpa,e.bankAccountUniqueId=b.payerBankAccountUniqueId,
e.customerMobileNumber=b.payerMobileNumber,e.bankName=b.payerBankName,g.logCounterMetric({feature:"SelectableUpiCalls_GetPMDetailsById_UpfrontFetch",resource:"_SuccessCount"})):(e.getPMS2SCallStatus=q.GetPMCallStatusEnum.Error,g.logCounterMetric({feature:"SelectableUpiCalls_GetPMDetailsById_UpfrontFetch_"+b.responseCode,resource:"_ErrorCount"}),g.logCounterMetric({feature:"SelectableUpiCalls_GetPMDetailsById_UpfrontFetch",resource:"_ErrorCount"}));g.logLatencyMetric({feature:"SelectableUpiCalls_GetPMDetailsById_UpfrontFetch",
resource:"_Latency",startTime:a});g.publishMetrics();e._isInstrumentSelected()&&e._storeGetPMDetailsResponse();e.sdkCallStatus===q.SdkCallStatusEnum.Error?(e.instrumentPreparationStatus=u.Failure,e._triggerInstrumentPreparedEvent()):e.sdkCallStatus===q.SdkCallStatusEnum.Completed&&(e.instrumentPreparationStatus=u.Success,e._triggerInstrumentPreparedEvent())})}else return!1});e.widget.on(h,e,function(a){e.isSavedHandleOriginallySelectable&&e._isInstrumentSelected()&&(this.instrumentPreparationStatus===
u.Pending?(e.widget.trigger(f,{errorMessage:e.errorMessage}),this.isAwaitingInstrumentPrepare=!0):(this.isAwaitingInstrumentPrepare=!0,e._triggerInstrumentPreparedEvent(),this.isAwaitingInstrumentPrepare=!1))});e.widget.on(k,e,function(a){e.handleSavedHandleContinueError&&e._isInstrumentSelected()&&e._handlePreparedInstrumentContinueError(a.reason?a.reason:u.UnknownFailure)});b.forEach(["ContinueButtonClicked","SecondaryContinueButtonClicked","CompleteWidget"],function(a){e.widget.on(a,e,function(a){e.isSavedHandleOriginallySelectable&&
e._isInstrumentSelected()&&(e.continueClickTime=g.getCurrentTime(),g.logCounterMetric({feature:"SavedHandleSelectedAtContinueClick",resource:"_Count"}),g.logCounterMetric({feature:"SavedHandleSelectedAtContinueClick_Index"+e.savedHandleIndex,resource:"_Count"}),e.sdkCallStatus===q.SdkCallStatusEnum.Pending&&g.logCounterMetric({feature:"SavedHandleSdkCallPendingAtContinueClick",resource:"_Count"}),g.publishMetrics());w.performNpciClEagerInit(e.eagerInitNpciClWeblabTreatment,e._isInstrumentSelected(),
e.sdkCallStatus,e._isUpiRedirectionRequired(),!0,e._getMetadata())})});e.widget.on("UpiRedirectionContinueEvent",e,function(){e._isInstrumentSelected()&&e._callUpiRedirectionEvent(e);return!1});e.widget.on("UPIIssuanceNotSupportedEvent",e,function(){e._toggleUPIContainer(!1)});e.widget.on("UPIIssuanceSupportedEvent",e,function(){e._toggleUPIContainer(!0)})},_callUpiRedirectionEvent:function(a){g.getCurrentTime();a.widget.trigger(y.showSpinner);g.logCounterMetric({feature:"SelectableUpiAipsRedirection",
resource:"_Count"});g.logCounterMetric({feature:"SelectableUpiAipsRedirection_Index"+a.savedHandleIndex,resource:"_Count"});this.widget.publishSuccessSushiMetrics({ActionType:"SelectableUpiAipsRedirection",ActionValueType:"PaymentInstrument",ActionValue:String(a._getInstrumentId())});a.isDeviceSignatureValid?a.isPinChosen||a._redirectToSetPin("SelectableUpiAipsRedirectionPinNotSet"):a._redirectToDeviceVerification(!1);g.publishMetrics()},_isSavedHandleInstrumentSelectionEligible:function(a){var b;
b=!a.isAPBSelected||a.isUpiSavedHandleAPBMultiTenderEligible?!0:a.isAutoDeselectApbForUpiIssuanceEnabled&&!a.isApbAutoDeselectedOnce;return a._isInstrumentSelected()||!a.isUpiUsable||a.isPermanentDisabled||!b||a.isUpiDisabledDueToUpfrontErrorMessage?!1:!0},bindToElements:function(){var a=this;a.isUpiUsable&&a._getContainerElement().click(function(){a._isSavedHandleInstrumentSelectionEligible(a)&&a._triggerInstrumentRowSelectedEvent()});a.$checkBalanceLabel=this.getDOMElement(this.upiCheckBalanceEnabledContainer);
a.$checkingBalanceLabel=this.getDOMElement(this.upiCheckingBalanceEnabledContainer);a.$accountBalanceLabel=this.getDOMElement(this.upiAccountBalanceEnabledContainer);a.$accountBalanceDisplayLabel=this.getDOMElement(this.upiAccountBalanceDisplayEnabledContainer);a.$checkBalanceTextId=this.getDOMElement(this.upiCheckBalanceEnabledTextId);a.$incorrectUpiPinCta=this.getDOMElement(this.incorrectUpiPinCta);a.$incorrectUpiPinLimitBreachedCta=this.getDOMElement(this.incorrectUpiPinLimitBreachedCta);a.$topBanksList=
this.getDOMElementsByPrefix("upiTopBanks-list-item-");a.$allBanksList=this.getDOMElementsByPrefix("upiAllBanks-list-item-");a.$ccBanksList=this.getDOMElementsByPrefix("upiCCBanks-list-item-");a.$topBanksHeader=this.getDOMElement("upiTopBanks-title");a.$allBanksHeader=this.getDOMElement("upiAllBanks-title");a.$ccBanksHeader=this.getDOMElement("upiCCBanks-title");a.$noBankFoundText=this.getDOMElement("no-bank-found");var c=!1;a.$checkBalanceTextId.click(function(){a._showCheckingBalanceLabel();a._callCheckBalance(a)});
a.getDOMElement(this.upiCheckBalanceWrongMpinInlineTryAgain).click(function(){a._hideCheckBalanceErrorClass();a._showCheckingBalanceLabel();a._callCheckBalance(a)});a.getDOMElement(this.upiCheckBalanceScreenRecordingOnInlineTryAgain).click(function(){a._hideCheckBalanceErrorClass();a._showCheckingBalanceLabel();a._callCheckBalance(a)});a.getDOMElement(this.upiCheckBalanceNoResponseBankInlineTryAgain).click(function(){a._hideCheckBalanceErrorClass();a._showCheckingBalanceLabel();a._callCheckBalance(a)});
a.getDOMElement(this.upiCheckBalanceGenericErrorInlineTryAgain).click(function(){a._hideCheckBalanceErrorClass();a._showCheckingBalanceLabel();a._callCheckBalance(a)});a.getDOMElement("apx-link-another-bank-account-section-js-label").click(function(){g.logCounterMetric({feature:"PspMaBspConvergence_"+a.pspMaBspConvergenceWeblabTreatment,resource:"_Count"});g.logCounterMetric({feature:"isCreditCardOnUPIRegistrationEnabledForRetail_"+a.isCreditCardOnUPIRegistrationEnabledForRetailTreatment,resource:"_Count"});
g.publishMetrics();a.widget.publishSuccessSushiMetrics({ActionType:"UpiLinkBankAccount",ActionValueType:"PspMaBspConvergence",ActionParentValueType:"WeblabTreatment",ActionParentValue:"PspMaBspConvergence_"+a.pspMaBspConvergenceWeblabTreatment});a.widget.publishSuccessSushiMetrics({ActionType:"UpiLinkBankAccount",ActionValueType:"isCreditCardOnUPIRegistrationEnabledForRetail",ActionParentValueType:"WeblabTreatment",ActionParentValue:"isCreditCardOnUPIRegistrationEnabledForRetail_"+a.isCreditCardOnUPIRegistrationEnabledForRetailTreatment});
a.shouldDisplayCreditCardBanks&&C.recordWeblabTrigger("IN_APX_PSP_UPI_ENABLE_CREDIT_CARD_REGISTRATION_788410",a.isCreditCardOnUPIRegistrationEnabledForRetailTreatment);a.isUPIInBoxWeblabEnabled?C.recordWeblabTrigger("IN_APX_PSP_BSP_AIPS_CONVERGENCE_747406",a.pspMaBspConvergenceWeblabTreatment):C.recordWeblabTrigger("IN_APX_PSP_MA_BSP_AIPS_CONVERGENCE_753596",a.pspMaBspConvergenceWeblabTreatment);a.isPspMaBspConvergenceWeblabEnabled&&a._handleUPIRedirectionForLinkAnotherBankAccount()});a.getDOMElement(this.upiCheckBalanceUpfrontRetriesExceededResetHere).click(function(){a._redirectToSetPin("SelectableUpiUpfrontRedirectResetPin")});
a.$incorrectUpiPinCta.click(function(){a._redirectToSetPin("SelectableUpiAipsRedirectionResetPin")});a.$incorrectUpiPinLimitBreachedCta.click(function(){a._redirectToSetPin("SelectableUpiAipsRedirectionResetPin")});a.getDOMElement(this.upiCheckBalanceUpfrontDfpMismatchCtaContainer).click(function(){a._redirectToDeviceVerification(!0)});D.when("A","a-sheet","ready").execute("bottom-sheet-events",function(w,k){w.on("a:sheet:beforeShow:apx-link-another-bank-account-bottom-sheet",function(b){d.showElement(a.getDOMElement("apx-link-another-bank-account-bottom-sheet-content"));
d.enableTextInput(a.getDOMElement("search-bank-text-box-input"));a.bottomSheetOpenTime=g.getCurrentTime();a.widget.publishSuccessSushiMetrics({ActionType:"UpiSearchBankStart",ActionValueType:"UpiSearchBank",ActionParentValueType:"OtherUpiPaymentMethod",ActionParentValue:"LinkAnotherBankAccount"})});w.declarative("bankSearchDeclarativeActionLBA","keyup",function(){c=!0;a.$topBankAvailable=0;a.$allBankAvailable=0;var k,B;a.getDOMElement("search-bank-text-box-input").val()&&(B=a.getDOMElement("search-bank-text-box-input").val().toUpperCase());
b.forEach(a.$topBanksList,function(b){k=b.getElementsByClassName("apx-link-another-bank-account-bank-name-element-section")[0].innerHTML.toUpperCase();b.classList.add("aok-offscreen");w.contains(k,B)&&(b.classList.remove("aok-offscreen"),a.$topBankAvailable++)});b.forEach(a.$allBanksList,function(b){k=b.getElementsByClassName("apx-link-another-bank-account-bank-name-element-section")[0].innerHTML.toUpperCase();b.classList.add("aok-offscreen");w.contains(k,B)&&(b.classList.remove("aok-offscreen"),
a.$allBankAvailable++)});b.forEach(a.$ccBanksList,function(b){k=b.getElementsByClassName("apx-link-another-bank-account-bank-name-element-section")[0].innerHTML.toUpperCase();b.classList.add("aok-offscreen");w.contains(k,B)&&(b.classList.remove("aok-offscreen"),a.$ccBankAvailable++)});0===a.$topBankAvailable?a.$topBanksHeader.addClass("aok-offscreen"):a.$topBanksHeader.removeClass("aok-offscreen");0===a.$allBankAvailable?a.$allBanksHeader.addClass("aok-offscreen"):a.$allBanksHeader.removeClass("aok-offscreen");
0===a.$ccBankAvailable?a.$ccBanksHeader.addClass("aok-offscreen"):a.$ccBanksHeader.removeClass("aok-offscreen");0===a.$topBankAvailable&&0===a.$allBankAvailable?(d.showElement(a.$noBankFoundText),g.logCounterMetric({feature:"LABA_NoBankFoundWhenSearchBoxUsed",resource:"_ErrorCount"}),g.publishMetrics(),a.widget.publishFailureSushiMetrics({ActionType:"UpiSearchBankInProgress",ActionValueType:"UpiSearchBank",ActionValue:"BankNotFoundInList",ActionErrorCode:"NO_BANK_FOUND",ActionParentValueType:"OtherUpiPaymentMethod",
ActionParentValue:"LinkAnotherBankAccount"})):d.hideElement(a.$noBankFoundText)})});b.forEach(["upiTopBanks-list-item-","upiAllBanks-list-item-","upiCCBanks-list-item-"],function(b){a.getDOMElementsByPrefix(b).click(function(b){g.logLatencyMetric({feature:"LinkAnotherBankAccountBottomSheet",resource:"_Latency",startTime:this.bottomSheetOpenTime});c?g.logCounterMetric({feature:"LABA_BankSelectCompletedUsingSearchBox",resource:"_SuccessCount"}):g.logCounterMetric({feature:"LABA_BankSelectCompletedWithoutUsingSearchBox",
resource:"_SuccessCount"});g.publishMetrics();B(".a-sheet-close").click();var d=B(b.currentTarget);b=d&&d.data("bank-code")?d.data("bank-code"):"";var d=d&&d[0].innerText?d[0].innerText:"",w;a.getDOMElement("search-bank-text-box-input").val()&&(w=a.getDOMElement("search-bank-text-box-input").val().length);c?a.widget.publishSuccessSushiMetrics({ActionType:"UpiSearchBankComplete",ActionValueType:"UpiSearchBank",ActionValue:"BankSelectionUsingSearchBox",ActionErrorCode:d+" inputSize "+w,ActionParentValueType:"OtherUpiPaymentMethod",
ActionParentValue:"LinkAnotherBankAccount"}):a.widget.publishSuccessSushiMetrics({ActionType:"UpiSearchBankComplete",ActionValueType:"UpiSearchBank",ActionValue:"BankSelectionWithoutUsingSearchBox",ActionErrorCode:d,ActionParentValueType:"OtherUpiPaymentMethod",ActionParentValue:"LinkAnotherBankAccount"});c=!1;a._handleUPIRedirectionForLinkAnotherBankAccount(b)})})},_redirectToSetPin:function(e){var b=g.getCurrentTime(),c=this._getUPIRedirectionData(e);g.logCounterMetric({feature:e,resource:"_Count"});
a.upiPinNotSet(this._getInstrumentId(),c.requiredUrls,this.purchaseId,this.clientId,this.httpMethod,c.conditionalArguments)?(g.logCounterMetric({feature:e,resource:"_SuccessCount"}),this.widget.publishSuccessSushiMetrics({ActionType:e,ActionValueType:"PaymentInstrument",ActionValue:String(this._getInstrumentId())})):(g.logCounterMetric({feature:e,resource:"_ErrorCount"}),this.widget.publishFailureSushiMetrics({ActionType:e,ActionValueType:"PaymentInstrument",ActionValue:String(this._getInstrumentId())}));
g.logLatencyMetric({feature:e,resource:"_Latency",startTime:b});g.publishMetrics()},_redirectToDeviceVerification:function(e){var b=g.getCurrentTime(),c=this._getUPIRedirectionData("SelectableUpiAipsRedirection");e&&(c.conditionalArguments.skipRegistrationContext=!0);g.logCounterMetric({feature:"SelectableUpiAipsRedirectionDeviceSignatureMismatch",resource:"_Count"});a.upiDeviceFingerprintDoesNotMatch(this._getInstrumentId(),c.requiredUrls,this.purchaseId,this.clientId,this.httpMethod,c.conditionalArguments)?
(g.logCounterMetric({feature:"SelectableUpiAipsRedirectionDeviceSignatureMismatch",resource:"_SuccessCount"}),this.widget.publishSuccessSushiMetrics({ActionType:"SelectableUpiAipsRedirectionDeviceSignatureMismatch",ActionValueType:"PaymentInstrument",ActionValue:String(this._getInstrumentId())})):(g.logCounterMetric({feature:"SelectableUpiAipsRedirectionDeviceSignatureMismatch",resource:"_ErrorCount"}),this.widget.publishFailureSushiMetrics({ActionType:"SelectableUpiAipsRedirectionDeviceSignatureMismatch",
ActionValueType:"PaymentInstrument",ActionValue:String(this._getInstrumentId())}));g.logLatencyMetric({feature:"SelectableUpiAipsRedirectionDeviceSignatureMismatch",resource:"_Latency",startTime:b})},_getUPIRedirectionData:function(a){var b=this.returnUrl,c=this.failureReturnUrl;"SelectableUpiAipsRedirectionResetPin"===a&&(b=new URL(b),b.searchParams.append("pinResetSuccessful","true"),b=b.toString(),c&&""!=c&&(c=new URL(c),c.searchParams.append("pinResetSuccessful","true"),c=c.toString()));return{requiredUrls:{redirectUrl:this.redirectUrl,
returnUrl:b,failureReturnUrl:c},conditionalArguments:{areReturnUrlsSentByClient:this.areReturnUrlsSentByClient,isPurchaseIdRequired:this.isPurchaseIdRequired,isAPBSelected:this.isAPBSelected,giftCardId:this.giftCardId,storedValueId:this.storedValueId,enableGetReturnHttpMethod:this.enableGetReturnHttpMethod,enableOrderIdInClientContext:this.enableOrderIdInClientContext,enableMultiTenderContextInUPIRedirectionClientContext:this.enableMultiTenderContextInUPIRedirectionClientContext,orderId:this.orderId,
issuingPsp:this.issuingPsp,reloadPspOnReappear:this.reloadPspOnReappear,skipRegistrationContext:!1}}},_handleUPIRedirectionForLinkAnotherBankAccount:function(e){var b=g.getCurrentTime();this.widget.trigger(y.showSpinner);g.logCounterMetric({feature:"LinkAnotherBankAccountAIPSRedirection",resource:"_Count"});var c=this._getUPIRedirectionData("LinkAnotherBankAccountAction");a.upiLinkAnotherBankAccount(e,c.requiredUrls,this.purchaseId,this.clientId,this.httpMethod,c.conditionalArguments)?g.logCounterMetric({feature:"LinkAnotherBankAccountAIPSRedirection",
resource:"_SuccessCount"}):g.logCounterMetric({feature:"LinkAnotherBankAccountAIPSRedirection",resource:"_ErrorCount"});g.logLatencyMetric({feature:"LinkAnotherBankAccountAIPSRedirection",resource:"_Latency",startTime:b});g.publishMetrics()},_callCheckBalance:function(a){a.checkBalanceStartTime=g.getCurrentTime();g.logCounterMetric({feature:"SelectableUpi_CheckBalance_FetchOnClick",resource:"_Count"});g.publishMetrics();a.widget.publishSuccessSushiMetrics({ActionType:"SelectableUpiCheckBalanceStart",
ActionValueType:"CheckBalance",ActionParentValueType:"PaymentInstrument",ActionParentValue:String(a.instrumentId)});if(a.sdkCallStatus===q.SdkCallStatusEnum.Pending||a.sdkCallStatus===q.SdkCallStatusEnum.Error)a._handleCheckBalanceFailureResponseCode(a),g.logCounterMetric({feature:"SelectableUpi_CheckBalance_FetchOnClick",resource:"_ErrorCount"}),g.logCounterMetric({feature:"SelectableUpi_CheckBalance_UpiSdkCall"+a.sdkCallStatus+"_FetchOnClick",resource:"_Count"}),a.widget.publishFailureSushiMetrics({ActionType:"SelectableUpiCheckBalanceCompleted",
ActionValueType:"CheckBalance",ActionValue:"DeviceSignaturePendingOrFailed",ActionErrorCode:a.sdkCallStatus,ActionParentValueType:"PaymentInstrument",ActionParentValue:String(a.instrumentId)});else if(a._isUpiRedirectionRequired()){g.logCounterMetric({feature:"SelectableUpi_CheckBalance_FetchOnClick",resource:"_ErrorCount"});g.logCounterMetric({feature:"SelectableUpi_CheckBalance_UpiRedReq_FetchOnClick",resource:"_Count"});var b="Unspecified";a.isDeviceSignatureValid?a.isPinChosen||(b="PIN_NOT_SET",
a._callUpiRedirectionEvent(a)):(b="DEVICE_SIGNATURE_MISMATCH",a._toggleCheckBalanceContainer(!1),a._toggleCheckingBalanceContainer(!1),a._toggleUpiCheckBalanceDfpMismatchMessage(!0));a.widget.publishFailureSushiMetrics({ActionType:"SelectableUpiCheckBalanceCompleted",ActionValueType:"CheckBalance",ActionValue:"UPI Redirection",ActionErrorCode:b,ActionParentValueType:"PaymentInstrument",ActionParentValue:String(a.instrumentId)})}else a._isUpiRedirectionRequired()?(a._handleCheckBalanceFailureResponseCode(a),
g.logCounterMetric({feature:"SelectableUpi_CheckBalance_FetchOnClick",resource:"_ErrorCount"}),g.logCounterMetric({feature:"SelectableUpi_CheckBalance_Unknown_FetchOnClick",resource:"_Count"}),a.widget.publishFailureSushiMetrics({ActionType:"SelectableUpiCheckBalanceCompleted",ActionValueType:"CheckBalance",ActionValue:"Failed due to Unknown Reason",ActionErrorCode:"UNKNOWN_ERROR",ActionParentValueType:"PaymentInstrument",ActionParentValue:String(a.instrumentId)})):a.getPMS2SCallStatus===q.GetPMCallStatusEnum.Completed?
(b=a._createPayloadForCheckBalance(a),a._callCheckBalanceAndHandleResponse(a,b),g.logCounterMetric({feature:"SelectableUpi_CheckBalance_GetPMCallPresent_FetchOnClick",resource:"_Count"})):(g.logCounterMetric({feature:"SelectableUpi_CheckBalance_GetPMCall_FetchOnClick",resource:"_Count"}),a.widget.publishSuccessSushiMetrics({ActionType:"SelectableUpiGetPMByIdStart",ActionValueType:"GetPaymentMethodById",ActionParentValueType:"PaymentInstrument",ActionParentValue:String(a.instrumentId)}),z.getPaymentMethodDetailsById({payerPaymentMethodId:a.instrumentId,
obfuscatedMarketplaceId:a.marketPlaceId,url:a.aipsOnboardingEndpointUrl},function(b){if("SUCCESS"===b.status){a.getPMS2SCallStatus=q.GetPMCallStatusEnum.Completed;a.npciKey=b.npciKey;a.customerVpa=b.payerVpa;a.bankAccountUniqueId=b.payerBankAccountUniqueId;a.customerMobileNumber=b.payerMobileNumber;a.bankName=b.payerBankName;var c=a._createPayloadForCheckBalance(a);a._callCheckBalanceAndHandleResponse(a,c);g.logCounterMetric({feature:"SelectableUpi_CheckBalance_GetPMCall_FetchOnClick",resource:"_SuccessCount"});
g.logLatencyMetric({feature:"SelectableUpi_CheckBalance_GetPMCall_FetchOnClick",resource:"_Latency",startTime:a.checkBalanceStartTime});a.widget.publishSuccessSushiMetrics({ActionType:"SelectableUpiGetPMByIdCompleted",ActionValueType:"GetPaymentMethodById",ActionValue:b.responseMessage,ActionErrorCode:b.responseCode,ActionParentValueType:"PaymentInstrument",ActionParentValue:String(a.instrumentId)})}else a.getPMS2SCallStatus=q.GetPMCallStatusEnum.Error,a._handleCheckBalanceFailureResponseCode(a),
g.logCounterMetric({feature:"SelectableUpi_CheckBalance_FetchOnClick",resource:"_ErrorCount"}),g.logLatencyMetric({feature:"SelectableUpi_CheckBalance_FetchOnClick",resource:"_Latency",startTime:a.checkBalanceStartTime}),g.logCounterMetric({feature:"SelectableUpi_CheckBalance_GetPMCall_FetchOnClick",resource:"_ErrorCount"}),g.logLatencyMetric({feature:"SelectableUpi_CheckBalance_GetPMCall_FetchOnClick",resource:"_Latency",startTime:a.checkBalanceStartTime}),a.widget.publishFailureSushiMetrics({ActionType:"SelectableUpiGetPMByIdCompleted",
ActionValueType:"GetPaymentMethodById",ActionValue:b.responseMessage,ActionErrorCode:b.responseCode,ActionParentValueType:"PaymentInstrument",ActionParentValue:String(a.instrumentId)}),a.widget.publishFailureSushiMetrics({ActionType:"SelectableUpiCheckBalanceCompleted",ActionValueType:"CheckBalance",ActionValue:b.responseMessage,ActionErrorCode:b.responseCode,ActionParentValueType:"PaymentInstrument",ActionParentValue:String(a.instrumentId)})}));g.publishMetrics()},_callCheckBalanceAndHandleResponse:function(a,
b){var c=a.checkBalanceStartTime,d=C.deleteWindowAppReappear();K.checkBalance(b,function(b){C.enableWindowAppReappear(d);if("SUCCESS"===b.status){a._showAccountBalanceLabel();var w=Number(b.balance),w=w.toLocaleString("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2});a.$accountBalanceDisplayLabel.html(w);a._handleInsufficentBalanceCheck(a,Number(b.balance));g.logCounterMetric({feature:"SelectableUpi_CheckBalance_FetchOnClick",resource:"_SuccessCount"});g.logLatencyMetric({feature:"SelectableUpi_CheckBalance_FetchOnClick",
resource:"_Latency",startTime:c});g.publishMetrics();a.widget.publishSuccessSushiMetrics({ActionType:"SelectableUpiCheckBalanceCompleted",ActionValueType:"CheckBalance",ActionValue:b.responseMessage,ActionErrorCode:b.responseCode,ActionParentValueType:"PaymentInstrument",ActionParentValue:String(a.instrumentId)})}else a._handleCheckBalanceFailureResponseCode(a,b.responseCode),g.logCounterMetric({feature:"SelectableUpi_CheckBalance_FetchOnClick",resource:"_ErrorCount"}),g.logLatencyMetric({feature:"SelectableUpi_CheckBalance_FetchOnClick",
resource:"_Latency",startTime:c}),g.publishMetrics(),a.widget.publishFailureSushiMetrics({ActionType:"SelectableUpiCheckBalanceCompleted",ActionValueType:"CheckBalance",ActionValue:b.responseMessage,ActionErrorCode:b.responseCode,ActionParentValueType:"PaymentInstrument",ActionParentValue:String(a.instrumentId)})})},_createPayloadForCheckBalance:function(a){return{deviceSignature:a.deviceSignature,paymentMethodId:a.instrumentId,npciKey:a.npciKey,customerVpa:a.customerVpa,bankAccountUniqueId:a.bankAccountUniqueId,
obfuscatedMarketplaceId:a.marketPlaceId,payerMobileNumber:a.customerMobileNumber,payerMpinLength:a.mPinLength,payerBankName:a.bankName,payerBankTail:a.bankTail,useCaseName:"CHECK_BALANCE",issuingPsp:a.issuingPsp,clientCategory:"PURCHASE",clientName:a.clientId,pageViewName:"APX",url:a.aipsOnboardingEndpointUrl,remarks:"Check Balance"}},_showCheckBalanceLabel:function(){d.showElement(this.$checkBalanceLabel);d.hideElement(this.$checkingBalanceLabel);d.hideElement(this.$accountBalanceLabel);d.hideElement(this.$accountBalanceDisplayLabel)},
_showCheckingBalanceLabel:function(){d.hideElement(this.$checkBalanceLabel);d.showElement(this.$checkingBalanceLabel);d.hideElement(this.$accountBalanceLabel);d.hideElement(this.$accountBalanceDisplayLabel)},_showAccountBalanceLabel:function(){d.hideElement(this.$checkBalanceLabel);d.hideElement(this.$checkingBalanceLabel);d.showElement(this.$accountBalanceLabel);d.showElement(this.$accountBalanceDisplayLabel)},_hideAllCheckBalanceRelatedLabel:function(){d.hideElement(this.$checkBalanceLabel);d.hideElement(this.$checkingBalanceLabel);
d.hideElement(this.$accountBalanceLabel);d.hideElement(this.$accountBalanceDisplayLabel)},_handleCheckBalanceFailureResponseCode:function(a,b){a.isTurboView?(a._hideAllCheckBalanceRelatedLabel(),a._toggleUpiCheckBalanceTurboInlineErrorMessage(!0),a._showErrorCodeSpecificDiv(a,b)):(a._showCheckBalanceLabel(),a.$checkBalanceErrorBottomSheet||a._createCheckBalanceErrorBottomSheet(a),a._hideCheckBalanceErrorClass(),a._showErrorCodeSpecificDiv(a,b),a._showCheckBalanceBottomSheet(a))},_showErrorCodeSpecificDiv:function(a,
b){b===q.CheckBalanceErrorCode.ZM?d.showElement(this.getDOMElement(this.upiCheckBalanceWrongMpinContainer)):b===q.CheckBalanceErrorCode.Z6?(d.showElement(this.getDOMElement(this.upiCheckBalanceMaxRetriesExceededContainer)),this.isUpiDisabledDueToUpfrontErrorMessage=!0,this.setDisabled(!0),a.isTurboView||(a._hideAllCheckBalanceRelatedLabel(),a._toggleUpiUpfrontRetriesExceededErrorMessage(!0))):b===q.CheckBalanceErrorCode.SCREEN_RECORDING_ON?d.showElement(this.getDOMElement(this.upiCheckBalanceScreenRecordingOnContainer)):
q.UpiBankRelatedErrorCode[b]?d.showElement(this.getDOMElement(this.upiCheckBalanceTimeoutErrorContainer)):d.showElement(this.getDOMElement(this.upiCheckBalanceGenericErrorContainer))},_hideCheckBalanceErrorClass:function(){d.hideElement(this.getDOMElement(this.upiCheckBalanceWrongMpinContainer));d.hideElement(this.getDOMElement(this.upiCheckBalanceMaxRetriesExceededContainer));d.hideElement(this.getDOMElement(this.upiCheckBalanceScreenRecordingOnContainer));d.hideElement(this.getDOMElement(this.upiCheckBalanceTimeoutErrorContainer));
d.hideElement(this.getDOMElement(this.upiCheckBalanceGenericErrorContainer))},_handleInsufficentBalanceCheck:function(a,b){this.upiMaybeAdjustedPurchaseTotal>b&&this.upiMaybeAdjustedPurchaseTotal<b+this.upiAmazonPayBalance&&(this.isApbAndUpiBalanceMoreThanPurchaseTotal=!0);!(this.isUpiSavedHandleAPBMultiTenderEligible&&this.isAPBSelected&&this.isApbAndUpiBalanceMoreThanPurchaseTotal)&&this.upiMaybeAdjustedPurchaseTotal>b&&(a._toggleUpiInsufficientBalance(!0),this.isUpiDisabledDueToUpfrontErrorMessage=
!0,this.setDisabled(!0),g.logCounterMetric({feature:"Upi_Disabled_Insufficient_Balance",resource:"_ErrorCount"}),g.publishMetrics())},_createCheckBalanceErrorBottomSheet:function(a){D.when("a-sheet").execute(function(b){a.$checkBalanceErrorBottomSheet=b.create({name:"checkbalance_bottomSheet",height:125,preloadDomId:a.upiCheckBalanceErrorBottomSheetPreloadDomId,closeType:"icon"})})},_showCheckBalanceBottomSheet:function(a){D.when("a-sheet").execute(function(b){b.showSheet(a.$checkBalanceErrorBottomSheet)})}})});
t("upi-redirection-util",["mash-helper","jQuery"],function(c,l){var n=function(k){try{var m;k.bankCode&&(m={"bank-info":{"bank-code":k.bankCode}});var d={};k.id&&(d["payment-method-id"]=k.id);m&&(d["payment-method-specific-data"]=m);var l={operation:k.operation,"payment-method-details":d,"return-location":k.returnUrl,"client-category":"PURCHASE","client-name":k.clientId,"client-context":{}};k.enableGetReturnHttpMethod&&(l["return-http-method"]="GET");k.failureReturnUrl&&(l["failure-return-location"]=
k.failureReturnUrl);k.issuingPsp&&(l["issuing-psp"]=k.issuingPsp);k.skipRegistrationContext&&(l["skip-reregistration-context"]=k.skipRegistrationContext);if(k.purchaseId){var b={"purchase-id":k.purchaseId};k.enableMultiTenderContextInUPIRedirectionClientContext&&k.isAPBSelected&&(b["is-apb-selected"]=k.isAPBSelected,b["gift-card-id"]=k.giftCardId,b["stored-value-id"]=k.storedValueId);l["client-context"]=b}k.enableOrderIdInClientContext&&k.orderId&&(b={"order-id":k.orderId},l["client-context"]=b);
var a=JSON.stringify(l),g=p.btoa(a),y=k.redirectUrl+p.encodeURIComponent(g);!0===k.reloadPspOnReappear&&p&&(p.app=p.app||{},p.app.willReappear=function(){p.location.reload()});"POST"===k.httpMethod?h(y):c.navigateToUrl(y);return!0}catch(u){return p.ueLogError&&p.ueLogError(u,{logLevel:"FATAL",attribution:"upi_redirect_util",message:"Got an exception while generating request body for AIPS redirection"+u.name+", message\x3d"+u.message}),f("RequestBody:Generation:Failed"),!1}},h=function(c){c=l("\x3cform\x3e\x3c/form\x3e").attr({method:"post",
action:c});l("body").append(c);c.submit()},f=function(c){p.ue&&"function"===typeof p.ue.count&&p.ue.count("APX:UPI:REDIRECTION:"+c,1)},m=function(c,h,d,m,b){return c.redirectUrl&&c.returnUrl?m.areReturnUrlsSentByClient&&!c.failureReturnUrl?(f(d+b+"Empty:failureReturnUrl"),!1):m.isPurchaseIdRequired&&!h?(f(d+b+"Empty:purchaseId"),!1):!0:(f(d+b+"Empty:redirectUrl or returnUrl"),!1)};return{upiRegistration:function(c,f,d,h,b,a){if(m(f,d,h,a,"NEW_REGISTRATION"))return n({operation:"NEW_REGISTRATION",
bankCode:c,redirectUrl:f.redirectUrl,returnUrl:f.returnUrl,failureReturnUrl:f.failureReturnUrl,purchaseId:d,clientId:h,httpMethod:b,isAPBSelected:a.isAPBSelected,storedValueId:a.storedValueId,giftCardId:a.giftCardId,enableGetReturnHttpMethod:a.enableGetReturnHttpMethod,enableOrderIdInClientContext:a.enableOrderIdInClientContext,enableMultiTenderContextInUPIRedirectionClientContext:a.enableMultiTenderContextInUPIRedirectionClientContext,orderId:a.orderId,reloadPspOnReappear:a.reloadPspOnReappear})},
upiLinkAnotherBankAccount:function(c,f,d,h,b,a){if(m(f,d,h,a,"NEW_REGISTRATION"))return n({operation:"ADD_ANOTHER_BANK_ACCOUNT",bankCode:c,redirectUrl:f.redirectUrl,returnUrl:f.returnUrl,failureReturnUrl:f.failureReturnUrl,purchaseId:d,clientId:h,httpMethod:b,isAPBSelected:a.isAPBSelected,storedValueId:a.storedValueId,giftCardId:a.giftCardId,enableGetReturnHttpMethod:a.enableGetReturnHttpMethod,enableOrderIdInClientContext:a.enableOrderIdInClientContext,enableMultiTenderContextInUPIRedirectionClientContext:a.enableMultiTenderContextInUPIRedirectionClientContext,
orderId:a.orderId,reloadPspOnReappear:a.reloadPspOnReappear})},upiPinNotSet:function(c,f,d,h,b,a){if(m(f,d,h,a,"SET_PIN"))return n({operation:"SET_PIN",id:c,redirectUrl:f.redirectUrl,returnUrl:f.returnUrl,failureReturnUrl:f.failureReturnUrl,purchaseId:d,clientId:h,httpMethod:b,isAPBSelected:a.isAPBSelected,storedValueId:a.storedValueId,giftCardId:a.giftCardId,enableGetReturnHttpMethod:a.enableGetReturnHttpMethod,enableOrderIdInClientContext:a.enableOrderIdInClientContext,enableMultiTenderContextInUPIRedirectionClientContext:a.enableMultiTenderContextInUPIRedirectionClientContext,
orderId:a.orderId,reloadPspOnReappear:a.reloadPspOnReappear})},upiDeviceFingerprintDoesNotMatch:function(c,f,d,h,b,a){if(m(f,d,h,a,"RE_REGISTRATION"))return n({operation:"RE_REGISTRATION",id:c,redirectUrl:f.redirectUrl,returnUrl:f.returnUrl,failureReturnUrl:f.failureReturnUrl,purchaseId:d,clientId:h,httpMethod:b,isAPBSelected:a.isAPBSelected,storedValueId:a.storedValueId,giftCardId:a.giftCardId,enableGetReturnHttpMethod:a.enableGetReturnHttpMethod,enableOrderIdInClientContext:a.enableOrderIdInClientContext,
enableMultiTenderContextInUPIRedirectionClientContext:a.enableMultiTenderContextInUPIRedirectionClientContext,orderId:a.orderId,issuingPsp:a.issuingPsp,reloadPspOnReappear:a.reloadPspOnReappear,skipRegistrationContext:a.skipRegistrationContext})}}});t("ajaxUtil",["AUI!P","upiEnums","commonUtil"],function(c,l,n){function h(c){c.sif_profile="upi_profile";return c}function f(c,f,l){var d=h(f),n="";Object.keys(d).forEach(function(b){n+=p.encodeURIComponent(b)+"\x3d"+p.encodeURIComponent(d[b])+"\x26"});
f=l?l:p.location.origin;return f+c+"?"+n}return{makePostCall:function(h,k,l,d,r,b){k=n.getPageLoadDetails();d["page-load-id"]=k.id;d["page-load-start-time"]=k.startTime;c.when("A").execute(function(a){a.$.ajax({url:f(h.path,l,d.url),xhrFields:{withCredentials:!0},data:JSON.stringify(d),contentType:"application/json; charset\x3dutf-8",dataType:"text",type:"POST",timeout:h.timeoutMillis,success:function(a,c,d){c=c+":"+d.status+":";d=d.statusText+":";try{var f=JSON.parse(a);r(f);var h=n.generateSuccessResponse(c+
"SUCCESS",d+"SUCCESS");h.responseJson=f;b(h)}catch(k){f=n.generateFailureResponse(c+"DEPENDENCY_FAILURE",d+k.message),f.responseData=a,b(f)}},error:function(a,c,d){var f;c=c+":"+a.status+":";d=d+":"+a.statusText+":";try{f=JSON.parse(a.responseText),d+=f.message,c+=f["error-code"]}catch(k){f={}}a=n.generateFailureResponse(c,d);a.responseJson=f;f=a;"timeout:0:"===f.responseCode&&(f=n.generateFailureResponse("S2S_CALL_TIMEOUT","S2S call timed out with a timeout of "+h.timeoutMillis));b(f)}})})}}});t("checkBalanceUtil",
"commonUtil npciTokenUtil deviceSignatureUtil ajaxUtil upiEnums npciSdkUtil".split(" "),function(c,l,n,h,f,m){function k(b,a){c.validateTruthy(b,"Input requestId is null or blank");c.validateTruthy(a,"Input payload is null");c.validateTruthy(a.deviceSignature,"Input deviceSignature is null or blank");c.validateTruthy(a.npciKey,"Input npciKey is null or blank");c.validateTruthy(a.customerVpa,"Input customerVpa is null or blank");c.validateTruthy(a.bankAccountUniqueId,"Input bankAccountUniqueId is null or blank");
c.validateTruthy(a.paymentMethodId,"Input paymentMethodId is null or blank");c.validateTruthy(a.obfuscatedMarketplaceId,"Input obfuscatedMarketplaceId is null or blank");c.validateTruthy(a.payerMobileNumber,"Input payerMobileNumber is null or blank");c.validateTruthy(a.payerMpinLength,"Input payerMpinLength is null or blank");c.validateTruthy(a.payerBankName,"Input payerBankName is null or blank");c.validateTruthy(a.payerBankTail,"Input payerBankTail is null or blank");c.validateTruthy(a.useCaseName,
"Input useCaseName is null or blank");c.validateTruthy(a.issuingPsp,"Input issuingPsp is null or blank");c.validateTruthy(a.url,"Input url is null or blank")}function A(b){c.validateTruthy(b,"response is null or blank");c.validateTruthy(b.status,"response status is null or blank");c.validateTruthy(b["response-code"],"response code is null or blank");c.validateTruthy(b["response-message"],"response message is null or blank");"SUCCESS"===b.status&&"00"===b["response-code"]&&c.validateTruthy(b.balance,
"balance is null or blank")}function d(b,a,d){var k=a.issuingPsp,m=a.clientContext||{};m.requestId=b;k={"device-signature":a.deviceSignature,"device-signature-fallback":a.deviceSignatureFallback,"upi-request-id":a.upiRequestId,"bank-account-unique-id":a.bankAccountUniqueId,"encrypted-customer-vpa":a.customerVpa,"encrypted-encoded-cred-blocks":a.encodedCredBlocks,"obfuscated-marketplace-id":a.obfuscatedMarketplaceId,"issuing-psp":k,"client-context":m,"payment-method-id":a.paymentMethodId||null,"skip-mpin-required-check":!1,
"client-category":a.clientCategory,"client-name":a.clientName,"use-case-name":a.useCaseName,"page-view-name":a.pageViewName,url:a.url,"customer-device-details":c.getCustomerDeviceDetails(a)};h.makePostCall(f.S2SMethods.CHECK_BALANCE,b,{},k,A,function(c){if("SUCCESS"===c.status){var h={};h.status=c.responseJson.status;h.responseCode=c.responseJson["response-code"];h.responseMessage=c.responseJson["response-message"];h.merchantId=c.responseJson["merchant-id"];h.merchantChannelId=c.responseJson["merchant-channel-id"];
h.merchantCustomerId=c.responseJson["merchant-customer-id"];h.encryptedCustomerMobileNumber=c.responseJson["encrypted-customer-mobile-number"];h.bankAccountUniqueId=c.responseJson["bank-account-unique-id"];h.bankCode=c.responseJson["bank-code"];h.encryptedCustomerVpa=c.responseJson["encrypted-customer-vpa"];h.maskedAccountNumber=c.responseJson["masked-account-number"];h.npciTransactionId=c.responseJson["npci-transaction-id"];h.balance=c.responseJson.balance;h.forcedTokenRefreshStatus="NOT_REQUIRED";
c.responseJson["response-code"]===f.ForceTokenRefreshResponseCode[c.responseJson["response-code"]]?(a.forceRefresh=!0,l.getOrCreateNpciToken(b+"-gcntf",a,function(a){h.forcedTokenRefreshStatus=a.status;d(h)})):d(h)}else d(c)})}function r(b,a,g){a.credRequestType="MPIN";a.credType=["reqBalEnq"];var f=c.generateRequestIdForPsp(a.issuingPsp);a.upiRequestId=f;m.getCredential(b,a,function(c){"SUCCESS"===c.status?(a.encodedCredBlocks=c.encodedCredBlocks,d(b+"-cb",a,g)):g(c)})}return{checkBalance:function(b,
a){var d=c.generateRequestId();try{k(d,b)}catch(f){a(c.generateFailureResponse("INVALID_INPUT",f.message+""));return}d+="-gcnt";l.getOrCreateNpciToken(d,b,function(c){"SUCCESS"===c.status?(b.npciToken=c.npciToken,b.deviceId=c.deviceDetails.deviceId,b.packageName=c.deviceDetails.packageName,b.deviceSignature=c.deviceSignature,b.deviceSignatureFallback=c.deviceSignatureFallback,b.deviceDetails=c.deviceDetails,b.simDetail=c.simDetail,r(d+"-gcr",b,a)):a(c)})}}});t("commonUtil",["upiEnums"],function(c){var l=
function(){function c(){return("0000"+Math.random().toString(16)).slice(-4)}return("000000000000"+n().toString(16)).slice(-12)+c()+c()+c()+c()+c()},n=function(){return Date.now()};return{validateTruthy:function(c,f){if(!c)throw Error(f);},generateRequestIdForPsp:function(h){if(c.SupportedIssuingPspAndConfig.hasOwnProperty(h))return c.SupportedIssuingPspAndConfig[h].requestIdPrefix+l();throw Error("Unsupported psp: "+h);},generateRequestId:l,generateFailureResponse:function(c,f){return{status:"FAILURE",
responseCode:c||"FAILURE",responseMessage:f||"unknown"}},generateSuccessResponse:function(c,f){return{status:"SUCCESS",responseCode:c||"SUCCESS",responseMessage:f||"unknown"}},generateCallbackResponse:function(c,f,m){return{status:c,responseCode:f,responseMessage:m}},isTrue:function(c){return"boolean"===typeof c&&c||"string"===typeof c&&"TRUE"===c.toUpperCase()},getDevicePlatform:function(){return p.device&&p.device.platform?p.device.platform:p.cordova&&p.cordova.platformId?"undefined"!==typeof c.OperatingSystem[p.cordova.platformId.toUpperCase()]?
c.OperatingSystem[p.cordova.platformId.toUpperCase()]:"UNKNOWN":"UNKNOWN"},getPageLoadDetails:function(){var c,f;try{f=p.ue_id,c=p.performance.timing.navigationStart}catch(m){c=-1}return{startTime:c||-1,id:f||"unknown"}},getCurrentTime:n,deleteWindowAppReappear:function(){var c;p.app&&p.app.willReappear&&(c=p.app.willReappear,delete p.app.willReappear);return c},enableWindowAppReappear:function(c){p.app.willReappear=c},getCustomerDeviceDetails:function(h){var f=h.deviceDetails;h=h.simDetail;var m=
{},k={};m["device-manufacturer"]=f.manufacturer;m["device-model"]=f.model;m["os-version"]=f.version;m["os-name"]=f.os?f.os.toUpperCase():null;m["app-version"]=f.appVersion;m["package-name"]=c.PackageName[f.packageName];null!==h&&h!==v&&(k["sim-id"]=h.id,f=h.provider,k["sim-operator"]=f!==v&&""!==f&&"No service"!==f?h.provider:"UNKNOWN",k["slot-index"]=h.slotIndex,k["is-sim-inactive"]=h.isSimInactive,m["sim-info-list"]=[k]);return m},compareVersions:function(c,f){c=c.split(".");f=f.split(".");for(var m=
0;m<Math.max(c.length,f.length);m++){var k=parseInt(c[m])||0,l=parseInt(f[m])||0;if(k<l)return-1;if(k>l)return 1}return 0},recordWeblabTrigger:function(c,f){p.ue&&"function"===typeof p.ue.trigger&&p.ue.trigger(c,f)}}});t("cordovaUtil",["commonUtil"],function(c){var l=function(){if(p.cordova)try{return p.cordova.require("cordova/exec")}catch(h){return function(f,m){m(c.generateCallbackResponse("FAILURE","CORDOVA_EXCEPTION",h.message+""))}}else return function(h,f){f(c.generateCallbackResponse("FAILURE",
"CORDOVA_NOT_AVAILABLE","Cordova is not loaded properly"))}},n=function(h){var f;"string"===typeof h?f="STRING_SDK_RESPONSE":h&&"object"===typeof h?(f=h.errorCode||"NULL_RESPONSE_CODE",h=h.errorDescription||"Null Response Message"):(f="UNKNOWN_SDK_RESPONSE",h=JSON.stringify(h)||"NullSdkResponse");return c.generateCallbackResponse("FAILURE",f,h)};return{executeNativeAction:function(h,f,m,k,A,d){m={requestId:f,payload:m,instrumentationData:d||{}};var r;"iOS"===c.getDevicePlatform()?(d="upiIssuanceSMASHPlugin",
r="executeSdkApi",m.command=h):(d="AipsJusPayPlugin",r=h);l()(function(b){b&&"object"===typeof b&&"SUCCESS"===b.status?(b.responseCode=b.responseCode||"NULL_RESPONSE_CODE",b.responseMessage=b.responseMessage||"Null Response Message"):b=n(b);"SUCCESS"===b.status?k(h,f,b):A(h,f,b)},function(b){A(h,f,n(b))},d,r,[m])}}});t("deviceSignatureUtil",["commonUtil","cordovaUtil"],function(c,l){var n,h=function(a){var b=c.generateRequestId(),d={permission:["android.permission.READ_PHONE_STATE","android.permission.SEND_SMS",
"android.permission.RECEIVE_SMS"]};"iOS"===c.getDevicePlatform()?(b=c.generateCallbackResponse("SUCCESS","SUCCESS","Permissions are already granted at app install in iOS"),a(b)):l.executeNativeAction("UPI_CHECK_PERMISSION",b,d,function(b,g,e){try{if(f(e,d.permission))a(e);else{var h=c.generateCallbackResponse("FAILURE","PERMISSION_NOT_GRANTED","Some permissions not granted by the user");h.permissions=e.permissions;a(h)}}catch(k){a(c.generateCallbackResponse("FAILURE","DEPENDENCY_FAILURE",k.message+
""))}},function(b,c,e){a(e)})},f=function(a,b){for(var c={},d=a.permissions.length,g=0;g<d;g++)if(a.permissions[g].label)c[a.permissions[g].label]=a.permissions[g].status;else throw Error("Invalid response structure. Label field not found");return b.every(function(a){if(c[a])return"GRANTED"===c[a];throw Error("Response does not contain all requested permission status");})},m=function(a,b){k(function(d){if("SUCCESS"===d.status)a:{var g,f,e=d.deviceSignatures.length;n=d.deviceDetails;for(f=0;f<e;f++)if(g=
a===d.deviceSignatures[f].deviceSignature,d.deviceSignatures[f].simDetail.serialNumber&&(g=g||a===d.deviceSignatures[f].deviceSignatureFallback),g){g=c.generateCallbackResponse("SUCCESS","SUCCESS","SUCCESS");g.deviceDetails=d.deviceDetails;g.simDetail=d.deviceSignatures[f].simDetail;g.deviceSignature=a===d.deviceSignatures[f].deviceSignature?d.deviceSignatures[f].deviceSignature:d.deviceSignatures[f].deviceSignatureFallback;b(g);break a}b(c.generateCallbackResponse("FAILURE","DEVICE_SIGNATURE_MISMATCH",
"Device signature passed in input does not matches with any of the sim present"))}else b(d)})},k=function(a){try{A(function(b){"SUCCESS"===b.status?d(b,a):a(b)})}catch(b){a(c.generateCallbackResponse("FAILURE","DEPENDENCY_FAILURE",b.message+""))}},A=function(a){var b=c.generateRequestId();l.executeNativeAction("UPI_GET_DEVICE_DETAILS",b,{},function(b,d,g){try{c.validateTruthy(g,"Null response returned"),c.validateTruthy("SUCCESS"===g.status,"Non success response status returned : "+g.status),c.validateTruthy(g.deviceDetails,
"Null device details returned"),c.validateTruthy(g.deviceDetails.deviceId,"Null or blank deviceId returned"),c.validateTruthy(g.deviceDetails.manufacturer,"Null or blank manufacturer returned"),c.validateTruthy(g.deviceDetails.model,"Null or blank model returned"),c.validateTruthy(g.deviceDetails.version,"Null or blank version returned"),c.validateTruthy(g.deviceDetails.os,"Null or blank os returned"),c.validateTruthy(g.deviceDetails.appVersion,"Null or blank appVersion returned"),c.validateTruthy(g.deviceDetails.packageName,
"Null or blank packageName returned"),a(g)}catch(e){a(c.generateCallbackResponse("FAILURE","DEPENDENCY_FAILURE",e.message+""))}},function(b,c,d){a(d)})},d=function(a,b){r(function(c){"SUCCESS"===c.status?y(a,c,b):b(c)})},r=function(d){var f=c.generateRequestId();l.executeNativeAction("UPI_GET_SIM_DETAILS",f,{},function(f,w,h){try{c.validateTruthy(h,"Null response returned");c.validateTruthy("SUCCESS"===h.status,"Non success response status returned : "+h.status);c.validateTruthy(h.simDetails,"Null sim details returned");
h.simDetails=g(h.simDetails);var e=h.simDetails.length;c.validateTruthy(0!==e,"Empty sim details returned");var k;for(k=0;k<e;k++)c.validateTruthy(h.simDetails[k].id,"Null or blank slot id returned for sim"+k),c.validateTruthy(h.simDetails[k].slotIndex,"Null or blank slot index returned for sim"+k),"iOS"===c.getDevicePlatform()?c.validateTruthy(h.simDetails[k].serialNumber,"Null or blank serialNumber returned for sim "+k+" for iOS"):c.validateTruthy(h.simDetails[k].subscriptionId,"Null or blank subscriptionId returned for sim "+
k+" for Android");if(c.isTrue(h.simDetails[0].isAirplaneModeOn))d(c.generateCallbackResponse("FAILURE","AIRPLANE_MODE_ACTIVE","Airplane mode is turned on device"));else{var m=b(h.simDetails);m.length?(h.simDetails=a(m),d(h)):d(c.generateCallbackResponse("FAILURE","ACTIVE_SIM_CARD_NOT_AVAILABLE","No active sim card present in device"))}}catch(l){"Empty sim details returned"===l.message?d(c.generateCallbackResponse("FAILURE","SIM_CARD_NOT_AVAILABLE",l.message+"")):d(c.generateCallbackResponse("FAILURE",
"DEPENDENCY_FAILURE",l.message+""))}},function(a,b,c){d(c)})},b=function(a){return a.filter(function(a){return!c.isTrue(a.isSimInactive)})},a=function(a){a.forEach(function(a){a.mobileNumber=(a.mobileNumber||"").slice(-12);"iOS"===c.getDevicePlatform()?a.ssid=a.serialNumber:a.ssid=a.subscriptionId});return a},g=function(a){return"iOS"===c.getDevicePlatform()?a.filter(function(a){return"undefined"!==typeof a.slotIndex}):a},y=function(a,b,d){var g=a.deviceDetails.deviceId,f=c.generateCallbackResponse("SUCCESS",
"SUCCESS","SUCCESS");f.deviceDetails=a.deviceDetails;f.deviceSignatures=[];var e=b.simDetails.length;a=function(a){q(g+a.ssid,function(b){a.serialNumber?q(g+a.serialNumber,function(c){u(f,a,e,b,c,d)}):u(f,a,e,b,"",d)})};var h;for(h=0;h<e;h++)a(b.simDetails[h])},u=function(a,b,c,d,g,e){a.deviceSignatures.push({simDetail:b,deviceSignature:d,deviceSignatureFallback:g});a.deviceSignatures.length===c&&e(a)},q=function(a,b){if("function"!==typeof b)throw Error("Input callback should be a function");if("function"===
typeof p.TextEncoder)return a=(new p.TextEncoder("utf-8")).encode(a),p.crypto.subtle.digest("SHA-256",a).then(function(a){var c;c=[];a=new DataView(a);for(var d=0;d<a.byteLength;d+=4){var e=("00000000"+a.getUint32(d).toString(16)).slice(-8);c.push(e)}c=c.join("");b(c)});throw Error("Unsupported platform. TextEncoder is not available");};return{checkDeviceSignature:function(a,b){h(function(c){"SUCCESS"===c.status?m(a,b):b(c)})},getCachedDeviceDetails:function(){return n}}});t("eagerInitUtil",["commonUtil",
"deviceSignatureUtil","npciSdkUtil","upiEnums","clog"],function(c,l,n,h,f){function m(c){f.logCounterMetric({feature:"EagerInitComplete_"+c.status,resource:"_Count"});f.publishMetrics()}function k(c){c=c||{};return{useCaseName:"EAGER_INIT_NPCI_CL",clientName:c.clientName,clientCategory:c.clientId,merchantCustomerId:c.merchantCustomerId}}return{performNpciClEagerInit:function(A,d,r,b,a,g){if(A&&p.ue&&!n.isInitNpciSdkApiCalled()){var y=l.getCachedDeviceDetails();if(y){var u=y.os?y.os.toUpperCase():
null,y=y.appVersion;d=u!==h.OperatingSystem.ANDROID.toUpperCase()||0>c.compareVersions(y,"26.8.2.300")||!d||r!==h.SdkCallStatusEnum.Completed||b||!a&&(A===h.WeblabTreatment.T1||A===h.WeblabTreatment.C)?!1:!0}else d=!1}else d=!1;d&&A!==h.WeblabTreatment.C&&(n.initNpciSdk(c.generateRequestId()+"-einc",{},m,k(g)),f.logCounterMetric({feature:"EagerInitStart",resource:"_Count"}),f.publishMetrics())}}});t("npciSdkUtil",["commonUtil","deviceSignatureUtil","upiEnums","cordovaUtil"],function(c,l,n,h){function f(a,
b,e,d,g,f,k,m){try{b(d,g)}catch(l){k(c.generateFailureResponse("INVALID_INPUT",l.message+""));return}h.executeNativeAction(a,d,f(g),function(a,b,d){try{e(d),k(d)}catch(g){k(c.generateFailureResponse("DEPENDENCY_FAILURE",g.message+""))}},function(a,b,c){k(c)},m)}function m(a,b){c.validateTruthy(a,"Input requestId is null or blank");c.validateTruthy(b,"Input payload is null")}function k(a){c.validateTruthy(a,"Null response returned");c.validateTruthy("SUCCESS"===a.status,"Non success response status returned : "+
a.status)}function p(){return{}}function d(a,b){m(a,b);c.validateTruthy(b.deviceId,"Input deviceId is null or blank");c.validateTruthy(b.tokenRequestType,"Input tokenRequestType is null or blank");"iOS"===c.getDevicePlatform()&&c.validateTruthy(b.packageName,"Input packageName is null or blank")}function r(a){k(a);c.validateTruthy(a.challenge,"Returned challenge is null or blank")}function b(a){var b={deviceId:a.deviceId,tokenRequestType:a.tokenRequestType};"iOS"===c.getDevicePlatform()&&(b.appId=
a.packageName);return b}function a(a,b){m(a,b);c.validateTruthy(b.deviceId,"Input deviceId is null or blank");c.validateTruthy(b.npciToken,"Input npciToken is null or blank");c.validateTruthy(b.tokenCreationTimeEpoch,"Input tokenCreationTimeEpoch is null or blank");c.validateTruthy(b.packageName,"Input packageName is null or blank");c.validateTruthy(b.payerMobileNumber,"Input payerMobileNumber is null or blank")}function g(a){k(a);c.validateTruthy(c.isTrue(a.responseCode),"Unexpected responseCode returned: "+
a.responseCode)}function y(a){return{deviceId:a.deviceId,token:a.npciToken,tokenCreationTimeEpoch:""+a.tokenCreationTimeEpoch,appId:a.packageName,mobileNumber:a.payerMobileNumber}}function u(a,b){m(a,b);c.validateTruthy(b.deviceId,"Input deviceId is null or blank");c.validateTruthy(b.npciToken,"Input npciToken is null or blank");c.validateTruthy(b.npciKey,"Input npciKey is null or blank");c.validateTruthy(b.payerBankName,"Input payerBankName is null or blank");c.validateTruthy(b.payerMobileNumber,
"Input payerMobileNumber is null or blank");c.validateTruthy(b.packageName,"Input packageName is null or blank");c.validateTruthy(b.upiRequestId,"Input upiRequestId is null or blank");c.validateTruthy(b.payerBankTail,"Input payerBankTail is null or blank");c.validateTruthy(b.credRequestType,"Input credRequestType is null or blank");switch(b.credRequestType){case "MPIN":c.validateTruthy(b.payerMpinLength,"Input payerMpinLength is null or blank");break;default:throw Error("Unsupported credRequestType: "+
b.credRequestType);}}function q(a){k(a);c.validateTruthy("SUCCESS"===a.responseCode,"Non success response code returned : "+a.responseCode);c.validateTruthy(a.encodedCredBlocks,"Returned encoded cred block is null or blank")}function z(a,b){return{name:a,value:b}}function t(a){var b=a.npciToken,c=a.npciKey,d;a:switch(a.credRequestType){case "MPIN":d='{\n\t"CredAllowed": [{\n\t\t"type": "PIN",\n\t\t"subtype": "MPIN",\n\t\t"dType": "NUM",\n\t\t"dLength": '+a.payerMpinLength+"\n\t}]\n}";break a;default:throw Error("Unsupported credRequestType: "+
a.credRequestType);}b={token:b,encodedXmlPayload:c,credAllowed:d,keyCode:a.keyCode||"NPCI",languagePref:a.languagePref||"en_US",configuration:{payerBankName:a.payerBankName},salt:{payerAddr:a.payerVpa||"",payeeAddr:a.payeeVpa||"",mobileNumber:a.payerMobileNumber,appId:a.packageName,deviceId:a.deviceId,txnAmount:a.amount||"",txnId:a.upiRequestId,credType:a.credType},payInfoArray:[]};a.payeeName&&b.payInfoArray.push(z("payeeName",a.payeeName));b.payInfoArray.push(z("refId",a.upiRequestId));b.payInfoArray.push(z("account",
a.payerBankTail));a.remarks&&b.payInfoArray.push(z("note",a.remarks));a.amount&&b.payInfoArray.push(z("txnAmount",a.amount));a.refUrl&&b.payInfoArray.push(z("refUrl",a.refUrl));b.trustParamInput=(a.amount?a.amount+"|":"")+a.upiRequestId+"|"+(a.payerVpa?a.payerVpa+"|":"")+(a.payeeVpa?a.payeeVpa+"|":"")+a.packageName+"|"+a.payerMobileNumber+"|"+a.deviceId;return b}var v=!1;return{initNpciSdk:function(a,b,e,d){"iOS"===c.getDevicePlatform()?(a=c.generateSuccessResponse("SUCCESS","Npci Sdk is already initialised in iOS"),
e(a)):(f("INIT_NPCI_SDK",m,k,a,b,p,e,d),v=!0)},getNpciTokenFromLocalStorage:function(a,b,c){f("GET_TOKEN_FROM_LS",m,k,a,b,p,c)},getChallenge:function(a,c,e){f("GET_CHALLENGE",d,r,a,c,b,e)},registerApp:function(b,c,d){f("REGISTER_APP",a,g,b,c,y,d)},getCredential:function(a,b,c){f("GET_CREDENTIAL",u,q,a,b,t,c)},isInitNpciSdkApiCalled:function(){return v}}});t("npciTokenUtil",["commonUtil","npciSdkUtil","deviceSignatureUtil","upiEnums","ajaxUtil"],function(c,l,n,h,f){function m(a,b){c.validateTruthy(a,
"Input requestId is null or blank");c.validateTruthy(b,"Input payload is null");c.validateTruthy(b.payerMobileNumber,"Input payerMobileNumber is null or blank");c.validateTruthy(b.deviceSignature,"Input deviceSignature is null or blank");c.validateTruthy(b.clientCategory,"Input clientCategory is null or blank");c.validateTruthy(b.clientName,"Input clientName is null or blank");c.validateTruthy(b.url,"Input url is null or blank")}function k(a){c.validateTruthy(a,"response is null or blank");c.validateTruthy(a["encrypted-npci-token"],
"encryptedNpciToken is null or blank");c.validateTruthy(a["token-creation-time-epoch"],"tokenCreationTimeEpoch is null or blank")}function p(a,b,d){l.registerApp(a,b,function(a){"SUCCESS"===a.status&&(a=c.generateSuccessResponse("SUCCESS_CREATE_TOKEN","Successfully created a new token"),a.npciToken=b.npciToken);d(a)})}function d(a,b,d,m){var l=b.issuingPsp,n=c.generateRequestIdForPsp(l),r=b.clientContext||{};r.requestId=a;d={"device-signature":b.deviceSignature,"device-signature-fallback":b.deviceSignatureFallback,
"token-request-type":b.tokenRequestType,"token-challenge":d.challenge,"encrypted-mobile-number":b.payerMobileNumber,"issuing-psp":l,"upi-request-id":n,"client-context":r,"client-category":b.clientCategory,"client-name":b.clientName,"use-case-name":b.useCaseName,"page-view-name":b.pageViewName,"obfuscated-marketplace-id":b.obfuscatedMarketplaceId,url:b.url,"customer-device-details":c.getCustomerDeviceDetails(b)};f.makePostCall(h.S2SMethods.CREATE_NPCI_TOKEN,a,{},d,k,function(c){"SUCCESS"===c.status?
(b.npciToken=c.responseJson["encrypted-npci-token"],c=c.responseJson["token-creation-time-epoch"],c=b.os.toUpperCase()!==h.OperatingSystem.ANDROID.toUpperCase()?c:"24.17.0.300"===b.appVersion?c+" V2":c+" "+b.supportedNpciTokenVersion,b.tokenCreationTimeEpoch=c,p(a+"-ra",b,m)):m(c)})}function r(a,b,c){b.tokenRequestType="INITIAL";l.getChallenge(a,b,function(f){"SUCCESS"===f.status?d(a+"-cnts",b,f,c):c(f)})}function b(a,b,d){b.forceRefresh?r(a+"-gchf",b,d):l.getNpciTokenFromLocalStorage(a,b,function(f){if("SUCCESS"===
f.status){var k;if(!f.token||b.expectedNpciToken&&b.expectedNpciToken!==f.token||f.mobileNumber!==b.payerMobileNumber)k=!1;else{var m=f.tokenCreationTimeEpoch.toString().split(" ");k=m[0];var l="";1<m.length&&(l=m[1]);b.os.toUpperCase()===h.OperatingSystem.ANDROID.toUpperCase()&&"24.17.0.300"===b.appVersion&&"V2"!==l||b.os.toUpperCase()===h.OperatingSystem.ANDROID.toUpperCase()&&"24.17.0.300"!==b.appVersion&&l!==b.supportedNpciTokenVersion?k=!1:(m=c.getCurrentTime(),k=parseInt(k,10),k=76032E5>m-k)}k?
(k=c.generateSuccessResponse("SUCCESS_EXISTING_TOKEN","Existing token fetched from Local storage is valid"),k.npciToken=f.token,d(k)):r(a+"-gch",b,d)}else d(f)})}function a(a,c,d,f){var k=function(a){a.deviceDetails=d.deviceDetails;a.deviceSignature=d.deviceSignature;a.deviceSignatureFallback=d.deviceSignatureFallback;a.simDetail=d.simDetail;f(a)};c.deviceId=d.deviceDetails.deviceId;c.packageName=d.deviceDetails.packageName;c.deviceSignature=d.deviceSignature;c.deviceSignatureFallback=d.deviceSignatureFallback;
c.supportedNpciTokenVersion=d.deviceDetails.supportedNpciTokenVersion||"V1";c.appVersion=d.deviceDetails.appVersion;c.os=d.deviceDetails.os;c.deviceDetails=d.deviceDetails;c.simDetail=d.simDetail;l.initNpciSdk(a,c,function(d){"SUCCESS"===d.status?b(a+"-gntls",c,k):k(d)})}return{getOrCreateNpciToken:function(b,d,f){try{m(b,d)}catch(k){f(c.generateFailureResponse("INVALID_INPUT",k.message+""));return}b+="-idfv";n.checkDeviceSignature(d.deviceSignature,function(c){"SUCCESS"===c.status?a(b+"-ins",d,c,
f):f(c)})}}});t("p2mIntentUtil",["AUI!P","commonUtil","cordovaUtil","lang"],function(c,l,n,h){function f(c,d){l.validateTruthy(c,"Input requestId is null or blank");l.validateTruthy(d,"Input payload is null");l.validateTruthy(d.intentFilterUri,"Input intentFilterUri is null or blank")}function m(f,d){c.when("mash").execute(function(c){var b=[],a=0;h.forEach(f,function(g){c.canLaunchIntentURL({url:g+"://upi",successCallback:function(c){a++;c&&b.push({intentAppPackageName:g});a===f.length&&d(b)},failCallback:function(c){a++;
a===f.length&&d(b)}})})})}function k(c,d){if(c)var f;m(c,function(b){f=0<b.length?l.generateCallbackResponse("SUCCESS","SUCCESS","SUCCESS"):l.generateCallbackResponse("SUCCESS","UPI_INTENT_ELIGIBLE_APPS_NOT_AVAILABLE","UPI_INTENT_ELIGIBLE_APPS_NOT_AVAILABLE");f.upiIntentEligibleApps=b;d(f)})}return{getIntentEligibleApps:function(c,d){if("iOS"===l.getDevicePlatform())k(c.intentAppsList,function(b){try{d(b)}catch(a){d(l.generateFailureResponse("FAILURE","DEPENDENCY_FAILURE",a.message+""))}});else{var h=
l.generateRequestId(),h=h+"-giea";try{f(h,c)}catch(b){d(l.generateFailureResponse("INVALID_INPUT",b.message+""));return}n.executeNativeAction("GET_UPI_INTENT_ELIGIBLE_APPS",h,c,function(b,a,c){try{d(c)}catch(f){d(l.generateCallbackResponse("FAILURE","DEPENDENCY_FAILURE",f.message+""))}},function(b,a,c){d(c)})}}}});t("paymentMethodUtil",["commonUtil","upiEnums","ajaxUtil"],function(c,l,n){function h(f){c.validateTruthy(f,"response is null or blank");c.validateTruthy(f["encrypted-payer-vpa"],"response encryptedPayerVpa is null or blank");
c.validateTruthy(f["encrypted-mobile-number"],"response encryptedMobileNumber is null or blank");c.validateTruthy(f["npci-public-key"],"response npciPublicKey is null or blank");c.validateTruthy(f["bank-name"],"response bankName is null or blank");c.validateTruthy(f["bank-tail"],"response bankTail is null or blank");c.validateTruthy(f["mpin-length"],"response mpinLength is null or blank");c.validateTruthy(f.version,"response version is null or blank");c.validateTruthy(f["payer-bank-account-unique-id"],
"response payerBankAccountUniqueId is null or blank");c.validateTruthy(f["device-signature"],"response deviceSignature is null or blank")}function f(c,f,p){var d=f.clientContext||{};d.requestId=c;n.makePostCall(l.S2SMethods.GET_PAYMENT_METHOD_DETAILS,c,{},{"payer-payment-method-id":f.payerPaymentMethodId,"obfuscated-marketplace-id":f.obfuscatedMarketplaceId,"client-context":d,"client-category":f.clientCategory,"client-name":f.clientName,"use-case-name":f.useCaseName,"page-view-name":f.pageViewName,
url:f.url},h,function(c){if("SUCCESS"===c.status){var b={};b.status=c.status;b.responseCode=c.responseCode;b.responseMessage=c.responseMessage;b.payerVpa=c.responseJson["encrypted-payer-vpa"];b.payerMobileNumber=c.responseJson["encrypted-mobile-number"];b.npciKey=c.responseJson["npci-public-key"];b.payerBankName=c.responseJson["bank-name"];b.payerBankTail=c.responseJson["bank-tail"];b.payerMpinLength=c.responseJson["mpin-length"];b.issuingPsp=c.responseJson["issuing-psp"];b.version=c.responseJson.version;
b.payerBankAccountUniqueId=c.responseJson["payer-bank-account-unique-id"];b.deviceSignature=c.responseJson["device-signature"];b.clientContext=c.responseJson["client-context"];p(b)}else p(c)})}return{getPaymentMethodDetailsById:function(h,k){var l=c.generateRequestId();try{c.validateTruthy(l,"Input requestId is null or blank"),c.validateTruthy(h,"Input payload is null"),c.validateTruthy(h.payerPaymentMethodId,"Input payerPaymentMethodId is null or blank"),c.validateTruthy(h.obfuscatedMarketplaceId,
"Input obfuscatedMarketplaceId is null or blank"),c.validateTruthy(h.url,"Input url is null or blank")}catch(d){k(c.generateFailureResponse("INVALID_INPUT",d.message+""));return}f(l+"-gpm",h,k)}}});t("sdkUtil",["AUI!P","clog","upiEvents"],function(c,l,n){var h,f,m,k,t,d=function(a,b,c,d,e){if(!h){var f=p.cordova;if(f)h=f.require("cordova/exec");else{e(a,b,null,"cordova undefined");return}}var g=r();c.requestId=g;h(function(c){d(a,b,g,c)},function(c){e(a,b,g,c)},m.serviceName,b,[c])},r=function(){function a(){return Math.random().toString(16).slice(-4)}
return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},b=function(a,b,c,d,e,f){var g={};if("SUCCESS"===d.status)if(e.forEach(function(a){g[a]=0}),d.hasOwnProperty("permissions")){d.permissions.forEach(function(a){"GRANTED"===a.status&&(g[a.label]=1)});for(var h in g)if(!g[h]){f.externalNeedsPermissionsHandler(a);return}f.externalHasPermissionsHandler(a)}else f.externalErrorHandler(a,b,c,d);else f.externalErrorHandler(a,b,c,d)},a=function(a,b,c,d){m.executeUpi(a,"CHECK_PERMISSION",{permission:b},
c,d)},g=function(c,d){var e=["android.permission.READ_PHONE_STATE","android.permission.SEND_SMS","android.permission.RECEIVE_SMS"];a(c,e,function(a,c,f,g){b(a,c,f,g,e,d)},d.externalErrorHandler)},v=function(a,b,c,d){m.executeUpi(a,"IS_DEVICE_FINGERPRINT_VALID",{deviceFingerPrint:b},c,d)},u=function(a,b,c){m.executeUpi(a,"SDK_INIT",{},b,c)},q=function(a){t=!0;a.widget.trigger(n.JuspayHasPermissionsEventName)},z=function(a,b){a=Object.create(a);for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a};
Object.create||(Object.create=function(a){function b(){}if(1<arguments.length)throw Error("Object.create implementation only accepts the first parameter.");b.prototype=a;return new b});var D={executeUpi:function(){},serviceName:""},C={getSDKHelper:function(a){return"iOS"===a?z(D,{executeUpi:function(a,b,c,e,f){d(a,"executeSdkApi",{payload:c,command:b},e,f)},serviceName:"upiIssuanceSMASHPlugin"}):z(D,{executeUpi:function(a,b,c,e,f){d(a,b,{payload:c},e,f)},serviceName:"AipsJusPayPlugin"})}},w=function(a,
b,c,d){"Enabled"===d.Status?(k=!0,q(a),a.widget.trigger(n.UPIIssuanceSupportedEventName)):a.widget.trigger(n.UPIIssuanceNotSupportedEventName)},B=function(a,b,c,d){a.widget.trigger(n.UPIIssuanceNotSupportedEventName)},e=function(a,b,c,d){"Enabled"===d.Status?(a.widget.trigger(n.InitializeDeviceSignatureCheckEventName),a.widget.trigger(n.UPIIssuanceSupportedEventName)):a.widget.trigger(n.UPIIssuanceNotSupportedEventName)},x=function(a,b,c,d){a.widget.trigger(n.UPIIssuanceNotSupportedEventName)};return{initializeDeviceSignatureCheck:function(a,
b,d,e){var h={externalHasPermissionsHandler:b,externalNeedsPermissionsHandler:d,externalErrorHandler:e};c.when("safe-mash").execute(function(b){b&&(f||(f=p.device),m=C.getSDKHelper(f.platform),"iOS"!==f.platform&&u(a,function(a,b,c,d){"SUCCESS"===d.status?(k=!0,g(a,h)):h.externalErrorHandler(a,b,c,d)},h.externalErrorHandler))})},juspayHasPermissionsHandler:q,juspayHasNoPermissionsHandler:function(a){t=!1;a.widget.trigger(n.NoDevicePermissionsEventName);l.logCounterMetric({feature:"SelectableUpiSdkCalls",
resource:"_SuccessCount"});l.logCounterMetric({feature:"SelectableUpiSdkCalls_NoPermissions",resource:"_Count"});l.logLatencyMetric({feature:"SelectableUpiSdkCalls",resource:"_Latency",startTime:a.sdkCallStartTime});l.publishMetrics()},checkDeviceSignature:function(a,b,c,d,e,f){var g={externalMatchHandler:d,externalMismatchHandler:e,externalErrorHandler:f};v(a,c,function(a,d,e,f){f&&"SUCCESS"===f.status?"true"===f.isValid?g.externalMatchHandler(a,b,c):g.externalMismatchHandler(a,b):g.externalErrorHandler(a,
d,e,f)},g.externalErrorHandler)},juspayHandleDeviceSignatureMatchesHandler:function(a,b,c){for(var d in a.savedHandleIndexes)a.widget.trigger(n.DeviceSignatureMatchesEventName,d,c);l.logCounterMetric({feature:"SelectableUpiSdkCalls",resource:"_SuccessCount"});l.logCounterMetric({feature:"SelectableUpiSdkCalls_SignatureMatch",resource:"_Count"});l.logLatencyMetric({feature:"SelectableUpiSdkCalls",resource:"_Latency",startTime:a.sdkCallStartTime});l.publishMetrics()},juspayHandleDeviceSignatureDoesNotMatchHandler:function(a,
b){for(var c in a.savedHandleIndexes)a.widget.trigger(n.DeviceSignatureDoesNotMatchEventName,c);l.logCounterMetric({feature:"SelectableUpiSdkCalls",resource:"_SuccessCount"});l.logCounterMetric({feature:"SelectableUpiSdkCalls_SignatureMismatch",resource:"_Count"});l.logLatencyMetric({feature:"SelectableUpiSdkCalls",resource:"_Latency",startTime:a.sdkCallStartTime});l.publishMetrics()},juspayErrorHandler:function(a,b,c,d){k=!1;p.console.error("JusPay SDK failed",b,c,d);a.widget.trigger(n.ErrorEventName);
l.logCounterMetric({feature:"SelectableUpiSdkCalls",resource:"_ErrorCount"});l.logLatencyMetric({feature:"SelectableUpiSdkCalls",resource:"_Latency",startTime:a.sdkCallStartTime});l.publishMetrics()},checkUPIIssuanceSupported:function(a){c.when("safe-mash").execute(function(b){b&&(f||(f=p.device),m=C.getSDKHelper(f.platform),a.isSavedHandleComponentUsable&&"iOS"===f.platform&&(a.widget.trigger(n.UPIIssuanceNotSupportedEventName),d(a,"isUPIIssuanceSupported",{},w,B)))})},checkUPIIssuanceSupportedForJsLibApps:function(a){c.when("safe-mash").execute(function(b){b&&
(f||(f=p.device),m=C.getSDKHelper(f.platform),"iOS"===f.platform?(a.widget.trigger(n.UPIIssuanceNotSupportedEventName),d(a,"isUPIIssuanceSupported",{},e,x)):a.widget.trigger(n.InitializeDeviceSignatureCheckEventName))})},getIsJuspaySdkCallEligible:function(){return k},getIsDeviceSignatureCheckEligible:function(){return t}}});t("upiEnums",[],function(){var c={Pending:"Pending",Completed:"Completed",Error:"Error"};Object.freeze(c);var l={C:"C",T1:"T1",T2:"T2"};Object.freeze(l);var n={Pending:"Pending",
Completed:"Completed",Error:"Error"};Object.freeze(n);var h={U13:!0,U78:!0,U99:!0,U88:!0,U28:!0,IR:!0,XB:!0,HS:!0,U80:!0,Y1:!0};Object.freeze(h);var f={U66:!0,21:!0};Object.freeze(f);var m={ZM:"ZM",Z6:"Z6",SCREEN_RECORDING_ON:"SCREEN_RECORDING_ON"};Object.freeze(m);var k={SdkError:"SdkError",AIPSRedirectionNotEnabled:"AIPSRedirectionNotEnabled",MultitenderNotSupported:"MultitenderNotSupported"};Object.freeze(k);var p={AXIS:{requestIdPrefix:"APL"},ICICI:{requestIdPrefix:"ICI"},YES:{requestIdPrefix:"APY"},
RBL:{requestIdPrefix:"RBA"}};Object.freeze(p);var d={CHECK_BALANCE:{name:"CheckBalance",path:"/upi/check-balance",timeoutMillis:45E3},CREATE_NPCI_TOKEN:{name:"CreateNpciToken",path:"/upi/customer/device/create-npci-token",timeoutMillis:2E4},GET_PAYMENT_METHOD_DETAILS:{name:"GetPaymentMethodDetailsById",path:"/upi/get-payment-method-details-by-id",timeoutMillis:45E3}};Object.freeze(d);var r={ANDROID:"Android",IOS:"iOS"};Object.freeze(r);var b={"in.amazon.mShop.android.shopping":"IN_AMAZON_MSHOP_ANDROID_SHOPPING",
"com.amazon.mShop.android.beta":"COM_AMAZON_MSHOP_ANDROID_SHOPPING_BETA","in.amazon.mShop.android.business.shopping":"IN_AMAZON_MSHOP_ANDROID_BUSINESS_SHOPPING","com.amazon.AmazonIN":"IN_AMAZON_MSHOP_IOS_SHOPPING","com.amazon.AmazonIN.Enterprise":"IN_AMAZON_MSHOP_IOS_SHOPPING_ENTERPRISE","com.amazon.AmazonIN.development":"IN_AMAZON_MSHOP_IOS_SHOPPING_DEVELOPMENT","com.amazon.AmazonBusinessIndia":"IN_AMAZON_BUSINESS_IOS_SHOPPING","com.amazon.AmazonBusinessIndia.Enterprise":"IN_AMAZON_BUSINESS_IOS_SHOPPING_ENTERPRISE",
"com.amazon.AmazonBusinessIndia.development":"IN_AMAZON_BUSINESS_IOS_SHOPPING_DEVELOPMENT"};Object.freeze(b);return{SdkCallStatusEnum:c,GetPMCallStatusEnum:n,ForceTokenRefreshResponseCode:f,UpiBankRelatedErrorCode:h,CheckBalanceErrorCode:m,WeblabTreatment:l,FailureReasonEnum:k,SupportedIssuingPspAndConfig:p,S2SMethods:d,OperatingSystem:r,PackageName:b}});t("upiEvents",[],function(){return{DeviceSignatureMatchesEventName:"DeviceSignatureMatchesEvent",DeviceSignatureDoesNotMatchEventName:"DeviceSignatureDoesNotMatchEvent",
DeviceFingerprintValidationPerformedEventName:"DeviceFingerprintValidationPerformed",JuspayHasPermissionsEventName:"JuspayHasPermissionsEvent",NoDevicePermissionsEventName:"NoDevicePermissionsEvent",ErrorEventName:"ErrorEvent",JuspayCheckDeviceSignatureEventName:"JuspayCheckDeviceSignatureEvent",UPIIssuanceNotSupportedEventName:"UPIIssuanceNotSupportedEvent",UPIIssuanceSupportedEventName:"UPIIssuanceSupportedEvent",UpiIdValidateSuccessEvent:"UpiIdValidateSuccess",UpiRedirectionContinueEventName:"UpiRedirectionContinueEvent",
InitializeDeviceSignatureCheckEventName:"InitializeDeviceSignatureCheckEvent",CheckDeviceSignatureEventName:"CheckDeviceSignatureEvent",GetPaymentMethodDetailsByIdEventName:"GetPaymentMethodDetailsByIdEvent",DeviceSignatureCheckMockEventNameForApxSandbox:"DeviceSignatureCheckMockEventNameForApxSandbox"}})})()});
/* ******** */
(function(l){var g=window.AmazonUIPageJS||window.P,f=g._namespace||g.attributeErrors,d=f?f("APXWidgetsAssets@APXWidgets-PayApps","APXWidgetsAssets"):g;d.guardFatal?d.guardFatal(l)(d,window):d.execute(function(){l(d,window)})})(function(l,g,f){(function(){var d=PaymentsPortal2.modules.define;d("redirection-utils",["clog"],function(p){return{handleInterstitialPageRedirection:function(e,d){var c=e.interstitialPageUrl,h=e.widgetAction;e=e.widgetActionType;d&&("add-pay-apps"===h&&"add-payment-instrument"===
e||"add-pay-pay-funds"===h)&&(c===f?(p.logCounterMetric({feature:"PayAppInterstitialPageUrlUndefined",resource:"_Count"}),p.publishMetrics()):g.location.href=c)}}});d("components/AddPayAppComponent","events/form-submitted-event jQuery form-component mini-browser-helper lang AUI!P clog redirection-utils".split(" "),function(d,e,f,c,h,k,l,m){var n={width:600,height:800};return f.extend({_hasErrors:!1,_redirectionEnabled:!1,initialize:function(a,b){this._action=b.data.action;this._hasErrors=b.data.hasErrors;
this._redirectionEnabled=b.data.redirectionEnabled;this._isMiniBrowserEnabled=b.data.isMiniBrowserEnabled},bindToElements:function(){var a=this,a=this;k.when("A","a-modal","ready").execute(function(b,c){a.getDOMElement("apx-add-paypay-modal-go-button").click(function(){a._openPayPayMiniBrowserWindow(a._interstitialPageUrl)})});this.getDOMElement("addPayPaySubmitButton").click(h.bind(this._handleFormSubmission,this))},_openPayPayMiniBrowserWindow:function(){this._paypay_window=c.openInMiniBrowser(url,
"apx-add-paypay-mini-window",n);this._paypay_window.focus();this._monitorPayPayMinibrowserWindow()},_monitorPayPayMinibrowserWindow:function(){g.clearTimeout(this._paypay_window_timer);!this._paypay_window||this._paypay_window.closed?(this._hidePopoverModal(),this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"AddPaymentMethodRefreshEvent","ppw-paymentMethodId":this._instrumentId,"ppw-widgetAction":this._widgetAction})):this._paypay_window_timer=setTimeout(this._monitorPayPayMinibrowserWindow.bind(this),
100)},_hidePopoverModal:function(){k.when("a-modal").execute(function(a){a&&(a=a.get("apx-add-paypay-modal"))&&a.hide()})},_showPopoverModal:function(){var a=this;k.when("A","a-modal","ready").execute(function(b,c){a.getDOMElement("apx-add-paypay-modal-trigger").click()})},openPayPayWindow:function(){c.openInMiniBrowser(url,"apx-add-paypay-mini-window",n).focus()},bindToEvents:function(){var a=this;a.widget.on("componentsInitialized",a,function(){this._initPopoverState();a._interstitialPageUrl&&(a._isMiniBrowserEnabled?
a._showPopoverModal():g.location.href=this._interstitialPageUrl)});a.widget.on(d,a,function(b){b.action===a._action&&e(a.getDOMElement("addPayAppForm")).submit()});a.widget.on("WidgetAction",this,function(a){m.handleInterstitialPageRedirection(a,this._redirectionEnabled)})},_initPopoverState:function(){this.refreshAddPayAppPopover()},refreshAddPayAppPopover:function(){k.when("a-modal").execute(function(a){a&&(a=a.get("addPayAppPopover"))&&a.isActive()&&a.refresh()})},_handleFormSubmission:function(a){var b=
this.form.validateForm(),c=this.getFormSubmissionParameters("addPayAppFormContainer"),e=g.location.pathname+g.location.search;this.getDOMElement("pmts-portal-pay-apps-client-page-url").val(e);0===b.length?this.widget.trigger(d,{event:a,submissionParameters:c,action:this._action}):a.preventDefault();return!1}})});d("components/SelectablePayAppsListComponent",["form-component"],function(d){return d});d("components/SelectablePayAppsListItemComponent","components/SelectableDPMInstrumentListItemComponent events/InstrumentRowSelectedEvent clog css-utils continuable jQuery redirection-utils events/SelectablePaymentOptionEvents fetch-balance".split(" "),
function(d,e,q,c,h,k,r,m,n){return d.extend(h,{_instrumentId:f,_redirectionEnabled:!1,_authenticationRetryEnabled:!1,_numberOfRetries:2,_retryIntervalInMillis:1E3,_payPayLiveBalanceLookUpEnabled:!1,_shouldDisableContinueButton:!1,_totalPurchaseAmount:f,_gcAmount:0,_jpPointsAmount:0,_promoAmount:0,_isDigitalWalletSelected:!1,_balanceDisplayed:!1,_fetchedBalance:f,_externalTokenSecureData:null,_externalTokenSecureEncryptionSystem:null,initialize:function(a,b){this.paymentMethodCategory=b.data.paymentMethodCategory;
this.isMultiTenderEnabled=b.data.isMultiTenderEnabled;this._instrumentId=b.data.instrumentId;this._redirectionEnabled=b.data.redirectionEnabled;this._authenticationRetryEnabled=b.data.authenticationRetryEnabled;this._payPayLiveBalanceLookUpEnabled=b.data.payPayLiveBalanceLookUpEnabled;this._shouldDisableContinueButton=b.data.payPayDisableContinueButton;this._externalTokenSecureData=b.data.externalTokenSecureData;this._externalTokenSecureEncryptionSystem=b.data.externalTokenSecureEncryptionSystem;
b.data.fetchBalanceRetries!==f&&(this._numberOfRetries=b.data.fetchBalanceRetries);b.data.fetchBalanceRetryIntervalInMs!==f&&(this._retryIntervalInMillis=b.data.fetchBalanceRetryIntervalInMs);b.data.purchaseAmount!==f&&(this._totalPurchaseAmount=b.data.purchaseAmount);this.closeAddPayAppsPopover()},bindToEvents:function(){var a=this;a.widget.on("WidgetAction",a,function(b){r.handleInterstitialPageRedirection(b,a._redirectionEnabled)});a.widget.on(e,a,function(b){a._instrumentRowSelected(b.instrumentId);
a._authenticationRetryEnabled&&a._handleAuthRetryButtonDisplay(b);a._digitalWalletInstrumentRowSelected(b)&&a._payPayLiveBalanceLookUpEnabled&&!a._authenticationRetryEnabled&&a._handlePayPayBalanceLinkClick();a._isDigitalWalletSelected=a.isMultiTenderEnabled&&a._digitalWalletInstrumentRowSelected(b)});a.widget.on("balanceSelectionChanged",a,function(b){a.isMultiTenderEnabled&&a._balanceSelectionChangedEventHandler(b)})},_balanceSelectionChangedEventHandler:function(a){"JPPoints"===a.paymentMethod?
this._jpPointsAmount=a.balance:"GC"===a.paymentMethod?this._gcAmount=a.isSelected?a.balance:0:"PROMO"===a.paymentMethod&&(this._promoAmount=a.isSelected?a.balance:0);this._balanceDisplayed&&this._fetchedBalance!==f&&(a=parseInt(this._jpPointsAmount)+parseInt(this._gcAmount)+parseInt(this._promoAmount),this._handleInsufficientBalanceMessage(a))},_digitalWalletInstrumentRowSelected:function(a){return a.instrumentId===this._instrumentId&&a.instrumentCategory===this.paymentMethodCategory},_handleAuthRetryButtonDisplay:function(a){this._digitalWalletInstrumentRowSelected(a)?
(this.setContinuable(!1),this.widget.trigger(m.PaymentPlanSelected,{isValid:!1,message:"",notValidReason:"NotAuthenticated",paymentMethod:this.paymentMethodCategory}),c.showElement(this.getDOMElement("pmts-portal-pay-apps-authenticate-pay-app-button-section-binding"))):c.hideElement(this.getDOMElement("pmts-portal-pay-apps-authenticate-pay-app-button-section-binding"))},_handleRetry:function(a){a.preventDefault();this.widget.submitFormAJAX({"ppw-widgetEvent":"AuthenticatePayAppEvent","ppw-paymentMethodId":this._instrumentId,
"ppw-payAppsClientPageURL":g.location.pathname+g.location.search,"ppw-widgetState":this.widget.options.serializedState})},poaInstrumentClicked:function(a){this.widget.trigger(e,{instrumentId:a,instrumentCategory:this.paymentMethodCategory,isMultiTenderEnabled:this.isMultiTenderEnabled,isAuthenticationRetryEnabled:this._authenticationRetryEnabled})},closeAddPayAppsPopover:function(){l.when("a-modal").execute(function(a){a&&(a=a.get("addPayAppPopover"))&&a.hide()})},bindToElements:function(){var a=
this;a.getDOMElement("pmts-portal-pay-apps-see-pay-pay-balance").click(function(b){a.publishCountMetrics("PayAppsSeePayPayBalanceClick");b.preventDefault();a._handlePayPayBalanceLinkClick()});a.getDOMElement("pmts-portal-pay-apps-pay-pay-refresh-balance-success").click(function(b){a.publishCountMetrics("PayAppsRefreshPayPayBalanceClick");b.preventDefault();a._handlePayPayBalanceLinkClick()});a.getDOMElement("pmts-portal-pay-apps-see-pay-pay-balance-failure").click(function(b){a.publishCountMetrics("PayAppsSeePayPayBalanceAfterFailureClick");
b.preventDefault();a._handlePayPayBalanceLinkClick()});a.getDOMElement("pmts-portal-pay-apps-authenticate-pay-app-button-binding").click(function(b){a._handleRetry(b)});a.getDOMElement("pmts-portal-pay-apps-add-funds").click(function(b){a._handlePayPayAddFundsClick(b)});a.instrumentSpecificHelper?a.instrumentSpecificHelper.bindToElements():(a.getDOMElementsByPrefix("POAInstrumentContainer").click(function(b){k(b.currentTarget).data("disabled")||a.poaInstrumentClicked(a._instrumentId)}),a.widget.on("initializeRecommendedInstrument",
a,function(b){b.instrumentId!==a._instrumentId||a.getDOMElementsByPrefix("POAInstrumentContainer").data("disabled")||(a._poaInstrumentSelected(),a.poaInstrumentClicked(a._instrumentId))}))},_handlePayPayBalanceLinkClick:function(){var a=this,b={widget:a.widget,instrumentId:a._instrumentId,eventName:"FetchBalanceEvent",successView:function(b){a.showPayPayBalanceSuccessView(b)},failureView:function(){a.showPayPayBalanceFailureView()},pendingView:function(){a.showPayPayBalancePendingView()},numberOfRetries:a._numberOfRetries,
retryDelayInMs:a._retryIntervalInMillis};a.publishCountMetrics("PayAppsPayPayFetchBalanceInitiated");n.fetchBalance(b)},_handlePayPayAddFundsClick:function(){event.preventDefault();var a=g.location.pathname+g.location.search,b=this._totalPurchaseAmount,c=parseInt(this._jpPointsAmount)+parseInt(this._gcAmount)+parseInt(this._promoAmount);this.isMultiTenderEnabled&&this._totalPurchaseAmount!==f&&parseInt(b)>c&&(b=(parseInt(b)-c).toString());this.widget.submitFormAJAX({"ppw-widgetEvent":"AddPayPayFundsEvent",
"ppw-paymentMethodId":this._instrumentId,"ppw-payAppsClientPageURL":a,"ppw-widgetState":this.widget.options.serializedState,"ppw-externalTokenSecureData":this._externalTokenSecureData,"ppw-externalTokenSecureEncryptionSystem":this._externalTokenSecureEncryptionSystem,"ppw-purchaseAmount":b})},showPayPayBalanceSuccessView:function(a,b){b=Number(a).toLocaleString("en-US");b=this.widget.getLocalizedString("pmts_portal_pay_apps_pay_pay_success_balance",{balance:b});this.getDOMElement("pmts-portal-pay-apps-pay-pay-success-balance-text").html(b);
c.hideElement(this.getDOMElement("pmts-portal-pay-apps-pay-pay-fetch-balance-initial-section"));c.hideElement(this.getDOMElement("pmts-portal-pay-apps-pay-pay-fetch-balance-failure-section"));c.showElement(this.getDOMElement("pmts-portal-pay-apps-pay-pay-fetch-balance-success-section"));c.hideElement(this.getDOMElement("pmts-portal-pay-pay-fetch-balance-pending-section"));this.publishCountMetrics("PayAppsPayPayBalanceSuccessView");this._balanceDisplayed=!0;this._fetchedBalance=a;this.isMultiTenderEnabled?
(a=parseInt(this._jpPointsAmount)+parseInt(this._gcAmount)+parseInt(this._promoAmount),this._handleInsufficientBalanceMessage(a)):this._handleInsufficientBalanceMessage(0)},showPayPayBalancePendingView:function(){this._balanceDisplayed=!1;c.hideElement(this.getDOMElement("pmts-portal-pay-apps-pay-pay-insufficient-balance-section"));c.hideElement(this.getDOMElement("pmts-portal-pay-apps-pay-pay-fetch-balance-initial-section"));c.hideElement(this.getDOMElement("pmts-portal-pay-apps-pay-pay-fetch-balance-failure-section"));
c.hideElement(this.getDOMElement("pmts-portal-pay-apps-pay-pay-fetch-balance-success-section"));c.showElement(this.getDOMElement("pmts-portal-pay-pay-fetch-balance-pending-section"))},showPayPayBalanceFailureView:function(){this._balanceDisplayed=!1;this._fetchedBalance=f;c.hideElement(this.getDOMElement("pmts-portal-pay-apps-pay-pay-insufficient-balance-section"));c.hideElement(this.getDOMElement("pmts-portal-pay-apps-pay-pay-fetch-balance-initial-section"));c.showElement(this.getDOMElement("pmts-portal-pay-apps-pay-pay-fetch-balance-failure-section"));
c.hideElement(this.getDOMElement("pmts-portal-pay-apps-pay-pay-fetch-balance-success-section"));c.hideElement(this.getDOMElement("pmts-portal-pay-pay-fetch-balance-pending-section"));this.publishCountMetrics("PayAppsPayPayBalanceFailureView")},_handleInsufficientBalanceMessage:function(a){this._totalPurchaseAmount!==f&&parseInt(this._totalPurchaseAmount)>parseInt(this._fetchedBalance)+parseInt(a)?(c.showElement(this.getDOMElement("pmts-portal-pay-apps-pay-pay-insufficient-balance-section")),this._isDigitalWalletSelected&&
this._shouldDisableContinueButton&&(this.setContinuable(!1),this.widget.trigger(m.PaymentPlanSelected,{isValid:!1,message:"",notValidReason:"InsufficientBalance",paymentMethod:this.paymentMethodCategory})),this.publishCountMetrics("PayAppsPayPayInsufficientBalanceView")):c.hideElement(this.getDOMElement("pmts-portal-pay-apps-pay-pay-insufficient-balance-section"))},publishCountMetrics:function(a){q.logCounterMetric({feature:a,resource:"_Count"});q.publishMetrics()}})});d("components/PayPayDetailsSlotComponent",
["component","PaymentMethodDetailsSlotComponentSupport"],function(d,e){return d.extend(e,{initialize:function(d,c){this._paymentMethodId=c.data.paymentMethodId;this._paymentMethodType=c.data.paymentMethodType;this._paymentMethodSubCategory=c.data.paymentMethodSubCategory},bindToElements:function(){this._bindEditPMLink()}})});d("components/PayPayEditComponent",["component","EditComponentSupport"],function(d,e){return d.extend(e,{initialize:function(d,c){e._initializePopover(d,c,this)},bindToEvents:function(){e._bindPopoverCloseButtonClickedEvent(this)}})});
d("components/PayPaySleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(d,e){return d.extend(e,{initialize:function(d,c){this._instrumentId=c.data.instrumentId}})})})()});
/* ******** */
(function(e){var a=window.AmazonUIPageJS||window.P,f=a._namespace||a.attributeErrors,b=f?f("APXWidgetsAssets@APXWidgets-AmazonBankConnect","APXWidgetsAssets"):a;b.guardFatal?b.guardFatal(e)(b,window):b.execute(function(){e(b,window)})})(function(e,a,f){(function(){var b=PaymentsPortal2.modules.define;b("components/LinkAccountCardComponent",["component","metrics-helper","lang","jQuery"],function(a,b,d,c){return a.extend({bindToElements:function(){var a=this;this.redirectionUrl=this.data.redirectionUrl;
c(".abc-linkable-accounts-dropdown").change(function(){a._handleAbcDropdownChange()});this.getDOMElement("add-card-continue-button").click(d.bind(this._handleAbcContinueButtonClick,this));b.publishOnClickSuccessSushiMetrics(a,[{JsBindElementId:"add-card-continue-button",MetricsObject:{ActionType:"AddCreditCard",ActionValueType:"AddMethod",ActionValue:"BankConnect"}}])},_handleAbcContinueButtonClick:function(a){return c(".abc-linkable-accounts-dropdown").val()?!0:(this._displayAbcChooseBankErrorMessage(),
!1)},_handleAbcDropdownChange:function(){this._hideAbcChooseBankErrorMessage();this._assignAbcContinueButtonRedirectUrl()},_displayAbcChooseBankErrorMessage:function(){c("#abc-add-card-partner-select-id").toggleClass("a-button-error",!0);c("#abc-linkable-accounts-dropdown-error-container-id").toggleClass("a-hidden aok-hidden",!1)},_hideAbcChooseBankErrorMessage:function(){c("#abc-add-card-partner-select-id").attr("class").includes("a-button-error")&&(c("#abc-add-card-partner-select-id").toggleClass("a-button-error",
!1),c("#abc-linkable-accounts-dropdown-error-container-id").toggleClass("a-hidden aok-hidden",!0))},_assignAbcContinueButtonRedirectUrl:function(){var a=c(".abc-linkable-accounts-dropdown").val();c(".abc-add-card-continue-button").attr("href",encodeURI(this.redirectionUrl+a))}})});b("components/LinkToAddCardComponent","component metrics-helper mash-helper lang jQuery clog".split(" "),function(b,e,d,c,f,g){return b.extend({initialize:function(a,b){this.partnerListURL=b.data.partnerListURL;this.isAmazonApp=
b.data.isAmazonApp;this.treatment=b.data.treatment},bindToElements:function(){this.getDOMElement("link-to-add-card-button").click(c.bind(this._handleLinkToAddButtonClick,this))},_handleLinkToAddButtonClick:function(b){g.logCounterMetric({feature:"LinkYourCard",resource:"_Count"});g.publishMetrics();b.preventDefault();if(this.isAmazonApp)switch(this.treatment){case "C":a.location.href="https://www.amazon.com/amazonbankconnect";break;case "T1":a.location.href="ssnap://www.amazon.com/amazonbankconnect";
break;case "T2":a.location.href="com.amazon.mobile.shopping://www.amazon.com/amazonbankconnect";break;case "T3":d.navigateToUrl("https://www.amazon.com/amazonbankconnect");break;case "T4":d.navigateToUrl("ssnap://www.amazon.com/amazonbankconnect");break;case "T5":d.navigateToUrl("com.amazon.mobile.shopping://www.amazon.com/amazonbankconnect");break;default:a.location.href="https://www.amazon.com/amazonbankconnect"}else a.location.href=this.partnerListURL}})})})()});
/* ******** */
(function(d){var c=window.AmazonUIPageJS||window.P,e=c._namespace||c.attributeErrors,a=e?e("APXWidgetsAssets@APXWidgets-AmazonPaymentProducts","APXWidgetsAssets"):c;a.guardFatal?a.guardFatal(d)(a,window):a.execute(function(){d(a,window)})})(function(d,c,e){(function(){var a=PaymentsPortal2.modules.define;a("components/APPCardDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport","jQuery"],function(a,c,d){return a.extend(c,{initialize:function(a,b){this._paymentMethodId=b.data.paymentMethodId;
this._paymentMethodType=b.data.paymentMethodType;this._foregroundColor=b.data.foregroundColor;this._refreshData=b.data.refreshData;this._messageHeader=b.data.messageHeader;this._messageType=b.data.messageType;this._messageContent=b.data.messageContent;this._paymentInstrumentId=b.data.paymentInstrumentId},bindToElements:function(){var a=this;a._bindEditPMLink();d(".apx-wallet-card-art-foreground-color").css("color",a._foregroundColor);a.widget.on("componentsInitialized",a,function(){this._refreshData&&
a.widget.submitFormAJAX({"ppw-widgetState":a.widget.options.serializedState,"ppw-widgetEvent":"CardClaimOwnershipRefreshEvent","ppw-messageHeader":this._messageHeader,"ppw-messageType":this._messageType,"ppw-messageContent":this._messageContent,"ppw-paymentInstrumentId":this._paymentInstrumentId})})}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-NetBankingCard","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/NetBankingCardListItemComponent",["events/InstrumentRowSelectedEvent","css-utils","components/SimplePaymentOptionListItemComponent","lang","public-event-registry"],function(a,b,c,d,e){return c.extend({initialize:function(f,
b){e.register(a);this._toggleBankSelectionInput(b.data.initiallySelected);this._togglePayURedirectionInfoMessage(!1)},_toggleBankSelectionInput:function(a){this.getDOMElement("netbanking-card-bank-selection-hidden-input").prop("disabled",!a)},_togglePayURedirectionInfoMessage:function(a){b.toggleElement(this.getDOMElement("netbanking-card-payu-redirection-info-message"),a)},_onInstrumentSelected:function(){this._getContainerElement().addClass("pmts-selected");this._getInstrumentSelectionInputElement().prop("checked",
!0);this._toggleBankSelectionInput(!0);this._triggerBackingInstrumentSelectedEvent(this._getDisplayableErrors(this.form.validateForm(!0)));this._togglePayURedirectionInfoMessage(!0)},_onInstrumentDeselected:function(){this._getContainerElement().removeClass("pmts-selected");this._getInstrumentSelectionInputElement().prop("checked",!1);this._toggleBankSelectionInput(!1);this._togglePayURedirectionInfoMessage(!1)},_getContainerElement:function(){return this.getDOMElement("netBankingCardContainer")},
bindToEvents:function(){var b=this;d.forEach(["initializeRecommendedInstrument",a],function(a){b.widget.on(a,b,function(a){a.instrumentId===b._getInstrumentId()?b._onInstrumentSelected():b._onInstrumentDeselected()})})}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-RewardsInfluencer","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){});
/* ******** */
(function(f){var b=window.AmazonUIPageJS||window.P,g=b._namespace||b.attributeErrors,a=g?g("APXWidgetsAssets@APXWidgets-ClientSideTestingSupport","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(f)(a,window):a.execute(function(){f(a,window)})})(function(f,b,g){(function(){var a=PaymentsPortal2.modules.define;a("test/client/default",["base","lang"],function(a,d){return a.extend({initialize:function(){this.testWidget=TestWidgetFactory.create();this.selectableCCListProxy=this._getSelectableCCListProxy();
this.ccListItemProxies=this._getCCListItemProxies()},_getSelectableCCListProxy:function(){var a=this.testWidget.getComponentProxiesByType("SelectableCreditCardListComponent");if(a)return a[0];console.log("No selectable CC list found.")},_getCCListItemProxies:function(){var a=this.testWidget.getComponentProxiesByType("CreditCardListItemComponent");if(a)return a;console.log("No CC List Items found.")},getCCSelectionElementByTail:function(a){if(this.ccListItemProxies){var e=d.filter(this.ccListItemProxies,
function(e){return e.getAccountTail()===a});if(e)return e=e[0].getInstrumentId(),this.selectableCCListProxy.getCCSelectionElement(e);console.log("No matching CC Item found for tail: "+a)}else console.log("No CC Items to lookup.")}})});a("test/proxy/CreditCardListItemComponent",["base","lang","when"],function(a,d,b){return a.extend({initialize:function(a,c){a=c.data;this.instrumentId=a.instrumentId;this.accountTail=a.tail},getInstrumentId:function(){return this.instrumentId},getAccountTail:function(){return this.accountTail}})});
a("test/proxy/SelectableCreditCardListComponent",["base","lang","when"],function(a,d,b){var e=/^instrumentRowSelection-(.*)/,c=function(a){return e.test(a)};return a.extend({initialize:function(a,b){var k=b.data;a=d.filter(d.keys(k),c);var h=this;this.instrumentIdToSelectionElement={};d.forEach(a,function(a){var c=e.exec(a)[1];h.instrumentIdToSelectionElement[c]=k[a]})},getCCSelectionElement:function(a){return this.instrumentIdToSelectionElement[a]}})});a("test/widget",["base","lang","when"],function(a,
d,b){return a.extend({initialize:function(a,c,b){this.id=a;this.name=c;this.componentProxiesByType={};this._initializeProxies(b)},_initializeProxies:function(a){var c=this,f=d.map(a,function(a){return"test/proxy/"+a.type});d.forEach(f,function(d,f){var h=a[f],g=h.type;b([d],function(a){c.componentProxiesByType[g]||(c.componentProxiesByType[g]=[]);c.componentProxiesByType[g].push(new a(c,h))})})},getComponentProxiesByType:function(a){return this.componentProxiesByType[a]}})})})()});
/* ******** */
(function(c){var a=window.AmazonUIPageJS||window.P,d=a._namespace||a.attributeErrors,b=d?d("APXWidgetsAssets@APXWidgets-PayNow","APXWidgetsAssets"):a;b.guardFatal?b.guardFatal(c)(b,window):b.execute(function(){c(b,window)})})(function(c,a,d){(function(){var b=PaymentsPortal2.modules.define;b("components/PayNowListItemComponent",["events/InstrumentRowSelectedEvent","components/SimplePaymentOptionListItemComponent"],function(b,a){return a.extend({initialize:function(b,a){this.setDisabled(a.data.isPayNowDisabled)},
bindToEvents:function(){var a=this;a.widget.on(b,a,function(b){b.instrumentId===a._getInstrumentId()?a._onInstrumentSelected():a._onInstrumentDeselected()})},_getContainerElement:function(){return this.getDOMElement("payNowContainer")}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-DPMCommon","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/SelectableDPMCommonListComponent",["form-component"],function(a){return a});a("components/SelectableDPMCommonListItemComponent",["components/SelectableDPMInstrumentListItemComponent"],function(a){return a})})()});
/* ******** */
(function(e){var c=window.AmazonUIPageJS||window.P,b=c._namespace||c.attributeErrors,a=b?b("APXWidgetsAssets@APXWidgets-PaymentLocation","APXWidgetsAssets"):c;a.guardFatal?a.guardFatal(e)(a,window):a.execute(function(){e(a,window)})})(function(e,c,b){(function(){var a=PaymentsPortal2.modules.define;a("components/PaymentLocationComponent","events/form-submitted-event form-component lang jQuery css-utils clog aui-helper events/spinner-events".split(" "),function(a,c,e,b,g,h,k,f){return c.extend({initialize:function(a,
b){this._action=b.data.action},bindToElements:function(){this.getDOMElement("pmts-search-continue-button").click(e.bind(this._handleFormSubmission,this))},bindToEvents:function(){var d=this;d.widget.trigger(f.hideSpinner);d.widget.forceToScrollToTopOfThePage();b("#pmts-edit-button-id").click(function(a){b("#pmts-search-edit-form-container").css("display","none");b("#pmts-search-form-container").css("display","block");a.preventDefault()});d.widget.on(a,d,function(a){a.action===d._action&&d.getDOMElement("pmts-search-form").submit()})},
_handleFormSubmission:function(b){if(0===this.form.validateForm().length){var c=this.getFormSubmissionParameters("searchFormContainer");this.widget.trigger(a,{queryParameters:this.data.queryParams,submissionParameters:c,event:b,action:this._action})}}})})})()});
/* ******** */
(function(c){var a=window.AmazonUIPageJS||window.P,d=a._namespace||a.attributeErrors,b=d?d("APXWidgetsAssets@APXWidgets-ConsumerInvoicing","APXWidgetsAssets"):a;b.guardFatal?b.guardFatal(c)(b,window):b.execute(function(){c(b,window)})})(function(c,a,d){(function(){var b=PaymentsPortal2.modules.define;b("components/ConsumerInvoicingDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport","jQuery"],function(b,a,c){return b.extend(a,{initialize:function(b,a){this._paymentMethodId=
a.data.paymentMethodId;this._paymentMethodType=a.data.paymentMethodType;this._isDefault=a.data.isDefault},bindToElements:function(){this._bindEditPMLink()}})});b("components/ConsumerInvoicingSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(b,a){return b.extend(a,{initialize:function(b,a){this._instrumentId=a.data.instrumentId}})})})()});
/* ******** */
(function(c){var a=window.AmazonUIPageJS||window.P,d=a._namespace||a.attributeErrors,b=d?d("APXWidgetsAssets@APXWidgets-Boleto","APXWidgetsAssets"):a;b.guardFatal?b.guardFatal(c)(b,window):b.execute(function(){c(b,window)})})(function(c,a,d){(function(){var b=PaymentsPortal2.modules.define;b("components/BoletoComponent",["events/InstrumentRowSelectedEvent","components/SimplePaymentOptionListItemComponent"],function(b,a){return a.extend({initialize:function(b,a){this.setDisabled(a.data.isBoletoDisabled)},
bindToEvents:function(){var a=this;a.widget.on(b,a,function(b){b.instrumentId===a._getInstrumentId()?(this._toggleRecurringPaymentEligibilityMessage(!0),a._onInstrumentSelected()):(this._toggleRecurringPaymentEligibilityMessage(!1),a._onInstrumentDeselected())})},_toggleRecurringPaymentEligibilityMessage:function(a){this.widget.trigger("toggleRecurringPaymentEligibilityMessage",{instrumentId:this.data.instrumentId,isSelected:a})},_getContainerElement:function(){return this.getDOMElement("boletoContainer")}})})})()});
/* ******** */
(function(g){var d=window.AmazonUIPageJS||window.P,e=d._namespace||d.attributeErrors,c=e?e("APXWidgetsAssets@APXWidgets-AmazonPayInstruments","APXWidgetsAssets"):d;c.guardFatal?c.guardFatal(g)(c,window):c.execute(function(){g(c,window)})})(function(g,d,e){(function(){var c=PaymentsPortal2.modules.define;c("components/SelectableAmazonPayInstrumentsListComponent","component css-utils continuable events/InstrumentRowSelectedEvent lang public-event-registry events/spinner-events clog".split(" "),function(c,
g,e,h,l,k,m,f){return c.extend(e,{initialize:function(a,b){k.register("APPInstrumentsRedirectionRequiredEvent");k.register("APPRedirectionContinueEvent");this.currentInstrumentId=b.data.instrumentId;this.instrumentType=b.data.instrumentType;this.appInstrumentsIssuance=b.data.appInstrumentsIssuance;this.nomenclatureWave2Enabled=b.data.nomenclatureWave2Enabled;this.isInlineIssuanceEnabled=b.data.isInlineIssuanceEnabled;this.redirectUrl=b.data.redirectUrl;this.isInlineIssuanceEnabled&&k.register(h);
this.bindToEvents()},_getAmazonPayInstrumentsContainer:function(){return this.getDOMElementsByPrefix("appInstrumentsContainer")},_onInstrumentSelected:function(){this._getAmazonPayInstrumentsContainer().addClass("pmts-selected");this._getInstrumentSelectionInputElement().prop("checked",!0);this._triggerBackingInstrumentSelectedEvent()},_getInstrumentSelectionInputElement:function(){return this.nomenclatureWave2Enabled?this.getDOMElement("instrumentRowSelection-"+this.appInstrumentsIssuance):this.getDOMElement("instrumentRowSelection-"+
this.currentInstrumentId)},_onInstrumentDeselected:function(){this._getAmazonPayInstrumentsContainer().removeClass("pmts-selected")},_triggerBackingInstrumentSelectedEvent:function(){this.widget.trigger("backingInstrumentSelected",{instrumentId:this.currentInstrumentId,instrumentType:this.instrumentType,errors:[],isAPPInstrumentRedirectionRequired:this._isAPPRedirectionRequired()});this._publishMetricsOnInstrumentSelection()},_publishMetricsOnInstrumentSelection:function(){this.isFirstTimeInstrumentSelection&&
(f.publishMetrics(),this.isFirstTimeInstrumentSelection=!1)},_isAPPRedirectionRequired:function(){return this.isInlineIssuanceEnabled},_isInstrumentSelected:function(){return this._getAmazonPayInstrumentsContainer().hasClass("pmts-selected")},_amazonPayInlineIssuanceOptionClicked:function(a){this.isInlineIssuanceEnabled&&this.widget.trigger(h,{instrumentId:this.currentInstrumentId,instrumentType:this.instrumentType,isInstrumentOwned:!0})},bindToEvents:function(){var a=this;this.getDOMElementsByPrefix("appInstrumentsContainer").click(l.bind(this._amazonPayInlineIssuanceOptionClicked,
this));a.widget.on(h,this,function(b){b.instrumentId===this.currentInstrumentId?this._onInstrumentSelected():a._onInstrumentDeselected()})},bindToElements:function(){var a=this;a.widget.on("APPInstrumentsRedirectionRequiredEvent",a,function(){return!1});a.widget.on("APPRedirectionContinueEvent",a,function(){var b=f.getCurrentTime();a._isInstrumentSelected()&&(a.widget.trigger(m.showSpinner),"undefined"!==typeof this.redirectUrl&&(f.logCounterMetric({feature:"APPRegistrationRedirection",resource:"_Count"}),
d.location=this.redirectUrl),f.logLatencyMetric({feature:"APPRegistrationRedirection",resource:"_Latency",startTime:b}),f.publishMetrics());return!1})}})})})()});
/* ******** */
(function(h){var e=window.AmazonUIPageJS||window.P,f=e._namespace||e.attributeErrors,c=f?f("APXWidgetsAssets@APXWidgets-AmazonProductVouchers","APXWidgetsAssets"):e;c.guardFatal?c.guardFatal(h)(c,window):c.execute(function(){h(c,window)})})(function(h,e,f){(function(){var c=PaymentsPortal2.modules.define;c("components/AddProductVoucherComponent",["component","clog"],function(g,c){return g.extend({bindToElements:function(){this.getDOMElement("WalletAddBalanceRedeemPV").bind("click",function(){c.logCounterMetric({feature:"WalletAddBalanceRedeemPV",
resource:"_Count"});c.publishMetrics()})}})});c("components/ProductVoucherDetailsSlotComponent",["component"],function(c){return c.extend({initialize:function(c,g){this._paymentMethodId=g.data.paymentMethodId}})});c("components/DummyComponent",["component"],function(c){return c.extend({initialize:function(){e.alert("DummyComponent initialized")}})});c("components/ProductVoucherListComponent",["component"],function(c){return c.extend({initialize:function(){}})});c("components/ProductVoucherListItemComponent",
"events/InstrumentRowSelectedEvent public-event-registry jQuery css-utils component clog lang mixins/b2b-cross-wallet-mixin".split(" "),function(c,e,r,d,m,k,n,p){return m.extend(p,{_isNotOwnedInstrumentSelected:!1,initialize:function(a,b){e.register(c);this.canPVEligibleAmountCoverPurchaseTotalAfterPromo=b.data.canPVEligibleAmountCoverPurchaseTotalAfterPromo;this.canPVEligibleAmountCoverPurchaseTotalWithOutPromo=b.data.canPVEligibleAmountCoverPurchaseTotalStandalone;this.canPVBalanceCoverPurchaseTotalAfterPromo=
b.data.canPVBalanceCoverPurchaseTotalAfterPromo;this.canPVBalanceCoverPurchaseTotalWithOutPromo=b.data.canPVBalanceCoverPurchaseTotalStandalone;this.canPromoCoverPurchaseWithoutProductVoucher=b.data.canPromoCoverPurchaseWithoutProductVoucher;this.productVoucherBalance=b.data.productVoucherBalance;this.displayablePurchaseTotal=b.data.displayablePurchaseTotal;this.displayablePurchaseTotalAfterPromo=b.data.displayablePurchaseTotalAfterPromo;this.promoIdentifier=b.data.promoIdentifier;this.productVoucherIdentifier=
b.data.productVoucherIdentifier;this.productVoucherTypeStringId=b.data.productVoucherTypeStringId;this.isABCrossCustomerMultiTenderSuppressionEnabled=b.data.isABCrossCustomerMultiTenderSuppressionEnabled;this.disallowAutoSelectionWhenConvertingToCheckbox=b.data.disallowAutoSelectionWhenConvertingToCheckbox;this.productVoucherType=this.widget.getLocalizedString(this.productVoucherTypeStringId);this.isPromoBalanceNone=b.data.isPromoBalanceNone;this.shouldDisplayModernizedFrameCX=b.data.shouldDisplayModernizedFrameCX;
this.instrumentRowSelectionValue=b.data.instrumentRowSelectionValue;this.productVoucherToggleSwitchName=b.data.productVoucherToggleSwitchName;this._modernizedPaymentArtGridCssClass=b.data.modernizedPaymentArtGridCssClass;this._disabledSectionCssClass=b.data.disabledSectionCssClass;this.isRadioButtonDisplay=this._shouldDisplayRadioButton(!0);this.productVoucherId=b.data.productVoucherId;this.isPVIneligible=b.data.isPVIneligible;this.$checkbox=this.getDOMElement("productVoucherBalanceSelection");this.$toggleSwitch=
this.getDOMElement(this.productVoucherToggleSwitchName);this.$toggleSwitchInput=this.$toggleSwitch.find("input");this.$checkboxContainer=this.getDOMElement("productVoucherCheckboxDisplay");this.$radioButton=this.getDOMElement("instrumentRowSelection-"+this.productVoucherId);this.$radioButtonContainer=this.getDOMElement("productVoucherRadioButtonDisplay");this.$container=this.getDOMElement("productVoucherContainer");this.$pvIneligibleWarningMessage=this.getDOMElement("pvIneligibleWarningMessageDisplay");
this._setTitleAttributeToElement(this.$checkbox);this._setTitleAttributeToElement(this.$radioButton);this._setTitleAttributeToElement(this.$toggleSwitch)},_setTitleAttributeToElement:function(a){try{a.length&&this.getDOMElement("productVoucherMsgWithPromo")&&this.getDOMElement("productVoucherMsgWithPromo")[0]&&a.attr({title:this.getDOMElement("productVoucherMsgWithPromo")[0].textContent})}catch(b){k.logCounterMetric({feature:"ProductVoucherSetTitleAttributeToElement",resource:"_ErrorCount"}),k.publishMetrics()}},
_checkFormInput:function(a){this.isRadioButtonDisplay?this.$radioButton.prop("checked",a):this._updateOptionalProductVoucherSelected(a)},_toggleOptionalProductVoucher:function(){this._isOptionalProductVoucherEnabled()&&this._setProductVoucher(!this._isOptionalProductVoucherSelected())},_setProductVoucher:function(a){a?this._selectProductVoucher():this._unselectProductVoucher()},_unselectProductVoucher:function(){this.isRadioButtonDisplay?this.$container.toggleClass("pmts-selected",!1):this._triggerOptionalInstrumentDeselectedEvent();
this._checkFormInput(!1);this._triggerBalanceSelectionChangedEvent(!1)},_selectProductVoucher:function(){this.isRadioButtonDisplay?(this.$container.toggleClass("pmts-selected",!0),this._triggerBackingInstrumentSelectedEvent(this.productVoucherId)):this._triggerOptionalInstrumentSelectedEvent();this._checkFormInput(!0);this._triggerBalanceSelectionChangedEvent(!0)},_deselectCurrentDisplay:function(){!0===this.isRadioButtonDisplay&&this.$radioButton.prop("checked")?(this._unselectProductVoucher(),this.widget.trigger(c,
{}),this._triggerBackingInstrumentSelectedEvent(null)):!1===this.isRadioButtonDisplay&&this.$checkbox.prop("checked")&&this._unselectProductVoucher()},_setDisplayToRadioButton:function(){this.isRadioButtonDisplay||(this._isOptionalProductVoucherSelected()&&this._unselectProductVoucher(),this.isRadioButtonDisplay=!0,this._toggleRadioButtonDisplay(this.isRadioButtonDisplay))},_setDisplayToCheckBoxOrToggleSwitch:function(){this.isRadioButtonDisplay&&(this.$radioButton.prop("checked")&&(this._unselectProductVoucher(),
this._triggerBackingInstrumentSelectedEvent(null)),this.isRadioButtonDisplay=!1,!0===this._isB2BCrossWalletMultitenderEnforcementEnabled?!0!==this.disallowAutoSelectionWhenConvertingToCheckbox&&this._selectProductVoucher():this.isABCrossCustomerMultiTenderSuppressionEnabled&&this._isNotOwnedInstrumentSelected||this._selectProductVoucher(),this._toggleRadioButtonDisplay(this.isRadioButtonDisplay))},_toggleRadioButtonDisplay:function(a){d.toggleElement(this.$radioButtonContainer,a);this.shouldDisplayModernizedFrameCX&&
this.$toggleSwitch?d.toggleElement(this.$toggleSwitch,!a):!this.shouldDisplayModernizedFrameCX&&this.$checkboxContainer&&d.toggleElement(this.$checkboxContainer,!a)},_canPVEligibleAmountCoverPurchaseAfterPromoApplied:function(a){return a&&this.canPVEligibleAmountCoverPurchaseTotalAfterPromo&&!this.canPromoCoverPurchaseWithoutProductVoucher||this.canPVEligibleAmountCoverPurchaseTotalWithOutPromo},_canPVBalanceCoverPurchaseAfterPromoApplied:function(a){return a&&this.canPVBalanceCoverPurchaseTotalAfterPromo&&
!this.canPromoCoverPurchaseWithoutProductVoucher||this.canPVBalanceCoverPurchaseTotalWithOutPromo},_shouldDisplayUseSomeOfYourAvailableBalanceMessageType:function(a){return this._canPVBalanceCoverPurchaseAfterPromoApplied(a)&&this.isPromoBalanceNone},_shouldDisplayRadioButton:function(a){return this._canPVEligibleAmountCoverPurchaseAfterPromoApplied(a)},_handlePromoSelectionChange:function(a){this._toggleProductVoucherMsg(a);this._shouldDisplayRadioButton(a)?this._setDisplayToRadioButton():this._setDisplayToCheckBoxOrToggleSwitch()},
_toggleProductVoucherMsg:function(a){if(this.shouldDisplayModernizedFrameCX){var b=this.getDOMElement("productVoucherMsgWithoutPromoMCXRadioButtonString"),c=this.getDOMElement("productVoucherMsgWithPromoMCXRadioButtonString"),e=this.getDOMElement("productVoucherMsgWithoutPromoMCXToggleSwitchString"),f=this.getDOMElement("productVoucherMsgWithPromoMCXToggleSwitchString");d.toggleElement(c,a);d.toggleElement(b,!a);d.toggleElement(f,!a);d.toggleElement(e,a)}else{var b=this.getDOMElement("productVoucherMsgWithoutPromo"),
c=this.getDOMElement("productVoucherMsgWithPromo"),e=this.getDOMElement("productVoucherMsgWithoutPromoWithCheckbox"),f=this.getDOMElement("productVoucherMsgWithPromoWithCheckbox"),g=this._productVoucherCoverageMessage(a),g=this.widget.getLocalizedString(g.stringId,g.args),h,l;a?(h=c,l=f):(h=b,l=e);try{h[0].innerHTML=g,l[0].innerHTML=g}catch(q){k.logCounterMetric({feature:"ProductVoucherToggleProductVoucherMsg",resource:"_ErrorCount"}),k.publishMetrics()}d.toggleElement(b,!a);d.toggleElement(c,a);
d.toggleElement(e,!a);d.toggleElement(f,a)}},_productVoucherCoverageMessage:function(a){var b=!this.canPromoCoverPurchaseWithoutProductVoucher&&a;return this._shouldDisplayUseSomeOfYourAvailableBalanceMessageType(a)?{stringId:"pmts_portal_payselect_use_some_of_your_available_balance_pv_type",args:{pv_balance:this.productVoucherBalance,amount_to_use:b?this.displayablePurchaseTotalAfterPromo:this.displayablePurchaseTotal,pv_type:this.productVoucherType}}:{stringId:"pmts_portal_payselect_your_available_balance_pv_type",
args:{pv_balance:this.productVoucherBalance,pv_type:this.productVoucherType}}},_triggerBalanceSelectionChangedEvent:function(a){this.widget.trigger("balanceSelectionChanged",{paymentMethod:this.productVoucherIdentifier,isSelected:a,balance:this.productVoucherBalance,isBackingInstrument:this.isRadioButtonDisplay})},_triggerInstrumentRowSelectedEvent:function(){this.widget.trigger(c,{instrumentId:this.productVoucherId,paymentMethod:this.productVoucherIdentifier})},_triggerBackingInstrumentSelectedEvent:function(a){this.widget.trigger("backingInstrumentSelected",
{instrumentId:a,paymentMethod:this.productVoucherIdentifier})},_triggerOptionalInstrumentSelectedEvent:function(){this.widget.trigger("optionalInstrumentSelected",{instrumentId:this.productVoucherId,paymentMethod:this.productVoucherIdentifier,requireBackingInstrument:this.requireBackingInstrument,balance:this.productVoucherBalance})},_triggerOptionalInstrumentDeselectedEvent:function(){this.widget.trigger("optionalInstrumentDeselected",{instrumentId:this.productVoucherId,paymentMethod:this.productVoucherIdentifier})},
_isProductVoucherSelectedAsInstrument:function(){return this.$container.hasClass("pmts-selected")},_triggerDeselectGiftCardCheckboxEvent:function(){this.widget.trigger("deselectGiftCardCheckbox",{instrumentId:this.productVoucherId,paymentMethod:this.productVoucherIdentifier})},_getToggleSwitchAuiElement:function(){var a=this,b=null;h.now("a-switch","jQuery").execute(function(c,d){c!==f&&d!==f&&(b=c.getSwitch(a.$toggleSwitch))});return b},_isOptionalProductVoucherSelected:function(){if(this.shouldDisplayModernizedFrameCX){var a=
this._getToggleSwitchAuiElement();return a&&a.isOn()}return this.$checkbox.prop("checked")},_updateOptionalProductVoucherSelected:function(a){if(this.shouldDisplayModernizedFrameCX){var b=this._getToggleSwitchAuiElement();return b&&this._isOptionalProductVoucherSelected()!==a&&b.isOn(a)}return this.$checkbox.prop("checked",a)},_isOptionalProductVoucherEnabled:function(){if(this.shouldDisplayModernizedFrameCX){var a=this._getToggleSwitchAuiElement();return a&&a.enabled()}return!this.$checkbox.prop("disabled")},
_updateOptionalProductVoucherEnabled:function(a){if(this.shouldDisplayModernizedFrameCX){var b=this._getToggleSwitchAuiElement();b&&this._isOptionalProductVoucherEnabled()==a&&b.enabled(!a)}else return this.$checkbox.prop("disabled",a)},bindToElements:function(){var a=this;if(a.shouldDisplayModernizedFrameCX&&a.productVoucherToggleSwitchName){a.$toggleSwitchInput.val(a.instrumentRowSelectionValue);var b="a:switch:"+a.productVoucherToggleSwitchName+":flip";a.widget.offAui(b);a.widget.onAui(b,function(b){a._setProductVoucher(b.switchState.isOn)})}a.$container.click(function(b){a.isRadioButtonDisplay?
a._isProductVoucherSelectedAsInstrument()||(a._triggerDeselectGiftCardCheckboxEvent(),a._triggerInstrumentRowSelectedEvent()):a.shouldDisplayModernizedFrameCX||(b.preventDefault(),a._toggleOptionalProductVoucher())});a.$checkbox.click(function(b){a._setProductVoucher(a._isOptionalProductVoucherSelected());b.stopPropagation()})},bindToEvents:function(){var a=this;a.widget.on(c,a,function(b){this._isNotOwnedInstrumentSelected=n.isDefined(b.isInstrumentOwned)&&!b.isInstrumentOwned;a.isRadioButtonDisplay?
(b.instrumentId===a.productVoucherId||a._isProductVoucherSelectedAsInstrument())&&a._setProductVoucher(b.instrumentId===a.productVoucherId):(!0===a._isB2BCrossWalletMultitenderEnforcementEnabled?a.shouldBeDeselectedPerB2BMultitenderRules(c,b)&&a._unselectProductVoucher():a.isABCrossCustomerMultiTenderSuppressionEnabled&&this._isNotOwnedInstrumentSelected&&this._unselectProductVoucher(),b=b.instrumentId===a.promoIdentifier||this.isPVIneligible,a.shouldDisplayModernizedFrameCX?(a._updateOptionalProductVoucherEnabled(b),
this.$container.find("."+this._modernizedPaymentArtGridCssClass).toggleClass(this._disabledSectionCssClass,!!b)):a.$checkbox.prop("disabled",b),d.toggleElement(this.$pvIneligibleWarningMessage,this.isPVIneligible))});a.widget.on("balanceSelectionChanged",a,function(b){"ProductVoucher"===b.paymentMethod&&a.shouldDisplayModernizedFrameCX&&a.widget.trigger("updateEstimatedTotal",{type:b.paymentMethod,status:b.isSelected,balance:b.balance,isValid:!0});a.shouldBeDeselectedPerB2BMultitenderRules("balanceSelectionChanged",
b)&&a._deselectCurrentDisplay();b.paymentMethod===this.promoIdentifier&&a._handlePromoSelectionChange(b.isSelected)});a.widget.on("componentsInitialized",a,function(){if(!a.isRadioButtonDisplay){var b=a.$checkbox.prop("checked"),c=a.$toggleSwitchInput.prop("checked");b||c?(a._triggerOptionalInstrumentSelectedEvent(),a._triggerBalanceSelectionChangedEvent(!0)):a._triggerOptionalInstrumentDeselectedEvent()}});a.widget.on("initializeRecommendedInstrument",a,function(b){b.instrumentId===a.productVoucherId&&
a.isRadioButtonDisplay&&a._triggerInstrumentRowSelectedEvent()})}})});c("components/ProductVoucherSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(c,e){return c.extend(e,{initialize:function(c,d){this._instrumentId=d.data.instrumentId}})})})()});
/* ******** */
(function(d){var e=window.AmazonUIPageJS||window.P,f=e._namespace||e.attributeErrors,a=f?f("APXWidgetsAssets@APXWidgets-MobileCarrierBilling","APXWidgetsAssets"):e;a.guardFatal?a.guardFatal(d)(a,window):a.execute(function(){d(a,window)})})(function(d,e,f){(function(){var a=PaymentsPortal2.modules.define;a("components/AddMobileCarrierBillingComponent",["jQuery","form-component","events/form-submitted-event","lang"],function(a,c,g,h){return c.extend({initialize:function(b,a){this.ADD_MCB_BUTTON_ID=
a.data.ADD_MCB_BUTTON_ID;this.ADD_MCB_FORM_ID=a.data.ADD_MCB_FORM_ID;this.ADD_MCB_COMPACT_BUTTON_ID=a.data.addMobileCarrierBillingCompactButtonSelector;this.showSpinnerWhenSubmit=a.data.showSpinnerWhenSubmit;this._action=a.data.action;this.$addMobileCarrierBillingPopoverTriggerLink=this.getDOMElement("addMobileCarrierBillingPopoverTriggerLink");this.isExpanded=a.data.isExpanded},bindToElements:function(){this.getDOMElement(this.ADD_MCB_BUTTON_ID).click(h.bind(this._handleCreate,this))},bindToEvents:function(){var b=
this;b.widget.on("componentsInitialized",b,function(a){b._initPopoverState()});a(this.ADD_MCB_COMPACT_BUTTON_ID).click(function(a){b.closeAddMobileCarrierBillingPopover()});b.widget.on("openAddMobileCarrierBillingPopover",b,function(a){b.$addMobileCarrierBillingPopoverTriggerLink.trigger("click")})},_initPopoverState:function(){this.refreshAddMobileCarrierBillingPopover();"true"===this.isExpanded&&this.widget.trigger("openAddMobileCarrierBillingPopover")},closeAddMobileCarrierBillingPopover:function(){d.when("a-modal").execute(function(b){b&&
(b=b.get("addMobileCarrierBillingPopover"))&&b.hide()})},refreshAddMobileCarrierBillingPopover:function(){d.when("a-modal").execute(function(b){b&&(b=b.get("addMobileCarrierBillingPopover"))&&b.isActive()&&b.refresh()})},_handleCreate:function(b){this.widget.trigger(g,{action:this._action,event:b,submissionParameters:this.getFormSubmissionParameters(this.ADD_MCB_FORM_ID)});this.showSpinnerWhenSubmit&&this.widget.trigger("submitFormAjaxStarted")}})});a("components/MobileCarrierBillingDetailsSlotComponent",
["component","PaymentMethodDetailsSlotComponentSupport","jQuery"],function(a,c,d){return a.extend(c,{initialize:function(a,b){this._paymentMethodId=b.data.paymentMethodId;this._paymentMethodType=b.data.paymentMethodType;this._isDefault=b.data.isDefault},bindToElements:function(){this._bindEditPMLink()}})});a("components/MobileCarrierBillingEditComponent",["component","EditComponentSupport"],function(a,c){return a.extend(c,{initialize:function(a,d){c._initializePopover(a,d,this)},bindToEvents:function(){c._bindPopoverCloseButtonClickedEvent(this)}})});
a("components/MobileCarrierBillingSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(a,c){return a.extend(c,{initialize:function(a,c){this._instrumentId=c.data.instrumentId}})})})()});
/* ******** */
(function(l){var h=window.AmazonUIPageJS||window.P,m=h._namespace||h.attributeErrors,d=m?m("APXWidgetsAssets@APXWidgets-PostPay","APXWidgetsAssets"):h;d.guardFatal?d.guardFatal(l)(d,window):d.execute(function(){l(d,window)})})(function(l,h,m){(function(){var d=PaymentsPortal2.modules.define;d("components/ChooseAddressPostPayComponent",["components/SelectAddressComponent","lang","jQuery","css-utils"],function(k,e,d,c){var f;return k.extend({initialize:function(a,b){this.$validateAgreeAndSendOTPButton=
this.getDOMElement("validateAgreeAndSentOTP");this.postPayAddressSelectedEventWebLabEnabled=b.data.postPayAddressSelectedEventWebLabEnabled},bindToEvents:function(){this.widget.on("addressRowSelected",this,function(a){this._logPostPayJsMetric("addressRowSelectedEvent observed with ",a.addressId);f=a.addressId});this.widget.on("sendDefaultAddressRowSelected",this,function(a){this._logPostPayJsMetric("sendDefaultAddressRowSelectedEvent observed with default addresID ",a.addressId);f=a.addressId;this._isValidAddressId(f)||
c.disableElement(this.$validateAgreeAndSendOTPButton)})},bindToElements:function(){this.$validateAgreeAndSendOTPButton.click(e.bind(this._clickValidateAgreeAndSendOTP,this))},_clickValidateAgreeAndSendOTP:function(a){this._logPostPayJsMetric("addressID submitted ",f);this._isValidAddressId(f)&&(this.postPayAddressSelectedEventWebLabEnabled?this.widget.submitFormAJAX({"ppw-widgetEvent":"PostPayAddressSelectedEvent","ppw-addressId":f,"ppw-widgetState":this.widget.options.serializedState}):this.widget.submitFormAJAX({"ppw-widgetEvent":"SelectAddressEvent",
"ppw-addressSelection":f,"ppw-widgetState":this.widget.options.serializedState}))},_logPostPayJsMetric:function(a,b){console.log(a+b)},_isValidAddressId:function(a){return!("undefined"===typeof a||null===a||""===a)}})});d("components/RegisterPostPayComponent",["form-component","lang"],function(k,e){return k.extend({bindToElements:function(){this.getDOMElement("registerPostPayContinueButtonJSBinding").click(e.bind(this._handleContinueToBillingAddressFormSubmission,this))},_handleContinueToBillingAddressFormSubmission:function(e){this.widget.trigger("RegisterPostpayContinueButtonSelected");
0===this.form.validateForm().length?this.getDOMElement("registerPostPayDetailFormJSBinding").submit():e.preventDefault()}})});d("components/ValidatePostPayComponent",["jQuery","form-component","lang"],function(k,e,d){return e.extend({bindToElements:function(){this.getDOMElement("confirmOTPSubmitButton").click(d.bind(this._handleConfirmOTPFormSubmission,this));var c=this;k("input:radio[name\x3dppw-resendOTPSelection]").change(function(){c._toggleResendOTPButtonText()})},_handleConfirmOTPFormSubmission:function(c){0===
this.form.validateForm().length?this.getDOMElement("confirmOTPForm").submit():(this.getDOMElement("OTPSentViaDispatchText").addClass("apx-js-hide"),c.preventDefault())},_toggleResendOTPButtonText:function(){var c=this.getDOMElement("resendOTPSelection-sms").is(":checked"),e=this.getDOMElement("sendViaSMS"),a=this.getDOMElement("sendViaVoice");c?(a.addClass("apx-js-hide"),e.removeClass("apx-js-hide")):(e.addClass("apx-js-hide"),a.removeClass("apx-js-hide"))}})});d("components/AddPostPayWorkflowComponent",
"component css-utils AUI!P jQuery lang clog".split(" "),function(d,e,g,c,f,a){return d.extend({initialize:function(a,c){this.autofillName=c.data.autofillName;this.autofillEmail=c.data.autofillEmail;this.autofillMobile=c.data.autofillMobile;e.showElement(this.getDOMElement("pmtsPostPayCreatableWrapper"));this.autofillFields()},bindToEvents:function(){this.widget.on("componentsInitialized",this,function(a){this._initPopoverState()});this.widget.on("RegisterPostpayContinueButtonSelected",this,function(){this._publishMetrics()})},
_initPopoverState:function(){this.refreshAddPostPayPopover()},_publishMetrics:function(){var a=c("[name\x3d'__sif_encrypted_postpay_fullName']").val(),e=c("[name\x3d'__sif_encrypted_postpay_email']").val(),d=c("[name\x3d'__sif_encrypted_postpay_mobileNumber']").val();this._publishCountMetric("RegisterPostpayFormSubmitted");""!=this.autofillName&&a!=this.autofillName&&this._publishCountMetric("Autofill.PostpayNameFieldChanged");""!=this.autofillEmail&&e!=this.autofillEmail&&this._publishCountMetric("Autofill.PostpayEmailFieldChanged");
""!=this.autofillMobile&&d!=this.autofillMobile&&this._publishCountMetric("Autofill.PostpayMobileFieldChanged")},_publishCountMetric:function(b){a.logCounterMetric({feature:b,resource:"_Count"});a.publishMetrics()},refreshAddPostPayPopover:function(){g.when("a-modal").execute(function(a){a&&(a=a.get("addPostPayPopover"))&&a.isActive()&&a.refresh()})},autofillFields:function(){var a=c("[name\x3d'__sif_encrypted_postpay_fullName']").val(),e=c("[name\x3d'__sif_encrypted_postpay_email']").val(),d=c("[name\x3d'__sif_encrypted_postpay_mobileNumber']").val();
""==a&&c("[name\x3d'__sif_encrypted_postpay_fullName']").val(this.autofillName);""==e&&c("[name\x3d'__sif_encrypted_postpay_email']").val(this.autofillEmail);""==d&&c("[name\x3d'__sif_encrypted_postpay_mobileNumber']").val(this.autofillMobile)}})});d("components/PaidyDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport","jQuery","css-utils","fetch-balance"],function(d,e,g,c,f){return d.extend(e,{initialize:function(a,b){this._paymentMethodId=b.data.paymentMethodId;this._paymentMethodType=
b.data.paymentMethodType;this._paymentMethodSubCategory=b.data.paymentMethodSubCategory;this._isDefault=b.data.isDefault;this._isFetchBalanceEnabled=b.data.isFetchBalanceEnabled},bindToElements:function(){var a=this;a._bindEditPMLink();a._isFetchBalanceEnabled&&(a.getDOMElement("pmts-portal-post-pay-fetch-balance-initial-section").click(function(b){a._handlePostPayBalanceButtonClick(b)}),a.getDOMElement("pmts-portal-post-pay-see-paidy-balance").click(function(b){a._handlePostPayBalanceButtonClick(b)}),
a.getDOMElement("pmts-portal-see-post-pay-balance-failure").click(function(b){a._handlePostPayBalanceButtonClick(b)}))},_handlePostPayBalanceButtonClick:function(a){var b=this;a.preventDefault();f.fetchBalance({widget:b.widget,instrumentId:b._paymentMethodId,eventName:"FetchBalanceEvent",successView:function(a,c){b.showPostPayBalanceSuccessView(a,c)},failureView:function(){b.showPostPayBalanceFailureView()},pendingView:function(){b.showPostPayBalancePendingView()}})},showPostPayBalanceSuccessView:function(a,
b){b=Number(a).toLocaleString("en-US");a=this.getDOMElement("pmts-portal-post-pay-success-balance-amount");b=this.widget.getLocalizedString("pmts_portal_paidy_available_balance_amount",{balance:b});a.html(b);c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-initial-section"));c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-failure-section"));c.showElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-success-section"));c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-pending-section"))},
showPostPayBalancePendingView:function(){c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-initial-section"));c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-failure-section"));c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-success-section"));c.showElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-pending-section"))},showPostPayBalanceFailureView:function(){c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-initial-section"));
c.showElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-failure-section"));c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-success-section"));c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-pending-section"))}})});d("components/PaidyEditComponent",["component","EditComponentSupport"],function(d,e){return d.extend(e,{initialize:function(d,c){e._initializePopover(d,c,this)},bindToEvents:function(){e._bindPopoverCloseButtonClickedEvent(this)}})});
d("components/SelectablePostPayListComponent",["component","css-utils"],function(d,e){return d.extend({initialize:function(){e.showElement(this.getDOMElement("pmtsPostPaySelectableWrapper"))}})});d("components/SelectablePostPayListItemComponent",["components/SelectableDPMInstrumentListItemComponent","events/InstrumentRowSelectedEvent","lang","css-utils","fetch-balance"],function(d,e,g,c,f){return d.extend({initialize:function(a,b){this.$PostPaySelectedNote=this.getDOMElement("pmtsPostPaySelectNote");
this.$FetchBalanceDisplayed=this.getDOMElement("pmtsFetchBalanceDisplayed");this.$isDisabled=this.getDOMElementsByPrefix("POAInstrumentContainer").data("disabled");this.$PostPaySelectedNote.addClass("apx-js-hide");this._isFetchBalanceEnabled=b.data.fetchBalanceStatus;this.closeAddPostPayPopover()},_triggerInstrumentRowSelectedEvent:function(a){this.widget.trigger(e,{instrumentId:a.instrumentId})},bindToEvents:function(){var a=this;a.widget.on("initializeRecommendedInstrument",a,function(b){this.$PostPaySelectedNote.addClass("apx-js-hide");
b.instrumentId!==a._instrumentId||this.$isDisabled||(a._poaInstrumentSelected(),a._triggerInstrumentRowSelectedEvent(b))});a.widget.on(e,a,function(b){b.instrumentId===a._instrumentId?(this.$PostPaySelectedNote.removeClass("apx-js-hide"),this.$FetchBalanceDisplayed.removeClass("apx-js-hide")):(this.$PostPaySelectedNote.addClass("apx-js-hide"),this.$FetchBalanceDisplayed.addClass("apx-js-hide"));this._instrumentRowSelected(b.instrumentId)});this._isFetchBalanceEnabled&&(a.getDOMElement("pmts-portal-post-pay-fetch-balance-initial-section").click(function(b){a._handlePostPayBalanceButtonClick(b)}),
a.getDOMElement("pmts-portal-post-pay-see-paidy-balance").click(function(b){a._handlePostPayBalanceButtonClick(b)}),a.getDOMElement("pmts-portal-see-post-pay-balance-failure").click(function(b){a._handlePostPayBalanceButtonClick(b)}))},_handlePostPayBalanceButtonClick:function(a){var b=this;a.preventDefault();f.fetchBalance({widget:b.widget,instrumentId:b._instrumentId,eventName:"FetchBalanceEvent",successView:function(a,c){b.showPostPayBalanceSuccessView(a,c)},failureView:function(){b.showPostPayBalanceFailureView()},
pendingView:function(){b.showPostPayBalancePendingView()}})},showPostPayBalanceSuccessView:function(a,b){b=Number(a).toLocaleString("en-US");a=this.getDOMElement("pmts-portal-post-pay-success-balance-amount");b=this.widget.getLocalizedString("pmts_portal_paidy_available_balance_amount",{balance:b});a.html(b);c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-initial-section"));c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-failure-section"));c.showElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-success-section"));
c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-pending-section"))},showPostPayBalancePendingView:function(){c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-initial-section"));c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-failure-section"));c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-success-section"));c.showElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-pending-section"))},showPostPayBalanceFailureView:function(){c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-initial-section"));
c.showElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-failure-section"));c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-success-section"));c.hideElement(this.getDOMElement("pmts-portal-post-pay-fetch-balance-pending-section"))},closeAddPostPayPopover:function(){l.when("a-modal").execute(function(a){a&&(a=a.get("addPostPayPopover"))&&a.hide()})}})});d("components/SelectablePostPayListItemInstallmentComponent",["events/InstrumentRowSelectedEvent","form-component",
"lang","AUI!P","jQuery"],function(d,e,g,c,f){return e.extend({_currentInstrumentId:m,initialize:function(a,b){this._currentInstrumentId=b.data.instrumentId;this.installmentsAvailableMessage=b.data.installmentsAvailableMessage;this.$paymentOptionsContainer=this.getDOMElement("pmtsPostPayPaymentOptionContainer");this.$installmentsNote=this.getDOMElement("pmtsPostPayInstallmentsAvailableNote");this.$installmentsMobileTouchLink=this.getDOMElement("pmtsPostPayInstallmentsMobileTouchLink");this.$installmentsMobilePopover=
this.getDOMElement("pmtsPostPayInstallmentsMobilePopover");this.$installmentsEligibilityInfo=this.getDOMElement("pmtsPostPayInstallmentsEligibilityInfoNote");this.$paidyApplyForUpgradeMobileTopButton=this.getDOMElement("pmtsPostPayAccountUpgradeTopButton");this.$paidyApplyForUpgradeMobileBottomButton=this.getDOMElement("pmtsPostPayAccountUpgradeBottomButton");this.$paidyInstallmentsMobilePrimaryContinueButton=this.getDOMElement("pmtsPostPayInstallmentsPrimaryContinueButton");this.$paidyInstallmentsMobileSecondaryContinueButton=
this.getDOMElement("pmtsPostPayInstallmentsSecondaryContinueButton");this.$paidyAccountUpgradeInfoHeader=this.getDOMElement("pmtsPostPayAccountUpgradeInfoHeader");this.$paidyAccountUpgradeSteps=this.getDOMElement("pmtsPostPayAccountUpgradeSteps");this.$paidyAccountUpgradeTable=this.getDOMElement("pmtsPostPayAccountUpgradeTable");this.$paidyApplyForUpgradeMobileTopButton.addClass("apx-js-hide");this.$paidyApplyForUpgradeMobileBottomButton.addClass("apx-js-hide");this.$paidyAccountUpgradeInfoHeader.addClass("apx-js-hide");
this.$paidyAccountUpgradeSteps.addClass("apx-js-hide");this.$paidyAccountUpgradeTable.addClass("apx-js-hide");this.$paymentOptionsContainer.addClass("apx-js-hide");this.$installmentsEligibilityInfo.addClass("apx-js-hide");this.$installmentsMobileTouchLink.addClass("apx-js-hide")},bindToElements:function(){this.getDOMElement("pmtsPostPayInstallmentsPrimaryContinueButton").click(g.bind(this._postpayInstallmentsPopoverContinueButtonClick,this));this.getDOMElement("pmtsPostPayInstallmentsSecondaryContinueButton").click(g.bind(this._postpayInstallmentsPopoverContinueButtonClick,
this));var a=this;a.getDOMElement("pmtsPostPayAccountUpgradeTopButton").click(function(b){a._postpayAccountUpgradeButtonClick(b)});a.getDOMElement("pmtsPostPayAccountUpgradeBottomButton").click(function(b){a._postpayAccountUpgradeButtonClick(b)});this.getDOMElementsByPrefix("pmtsPostPayPaymentOptionINSTALLMENT").click(g.bind(this._postpayAccountUpgradeInstallmentSelectedAction,this));this.getDOMElementsByPrefix("pmtsPostPayPaymentOptionONETIME").click(g.bind(this._postpayAccountUpgradeOnePaySelectedAction,
this))},bindToEvents:function(){var a=this;a.widget.on(d,a,function(b){b.instrumentId===a._currentInstrumentId?(this.$paymentOptionsContainer.removeClass("apx-js-hide"),this.$installmentsNote.addClass("apx-js-hide"),this.$installmentsMobileTouchLink.removeClass("apx-js-hide"),this.$installmentsEligibilityInfo.removeClass("apx-js-hide")):(this.$paymentOptionsContainer.addClass("apx-js-hide"),this.$installmentsNote.removeClass("apx-js-hide"),this.$installmentsMobileTouchLink.addClass("apx-js-hide"),
this.$installmentsEligibilityInfo.addClass("apx-js-hide"))})},_postpayInstallmentsPopoverContinueButtonClick:function(){this._updateTouchLinkContent();this._closePostPayPaymentOptionsSecondaryPopover()},_postpayAccountUpgradeButtonClick:function(a){a.preventDefault();this.widget.submitFormAJAX({"ppw-widgetEvent":"PostpayAccountUpgradeStarted","ppw-paymentMethodId":this._currentInstrumentId,"ppw-postpayCurrentPageURL":h.location.pathname+h.location.search,"ppw-widgetState":this.widget.options.serializedState})},
_postpayAccountUpgradeInstallmentSelectedAction:function(){this.$paidyApplyForUpgradeMobileTopButton.removeClass("apx-js-hide");this.$paidyApplyForUpgradeMobileBottomButton.removeClass("apx-js-hide");this.$paidyInstallmentsMobilePrimaryContinueButton.addClass("apx-js-hide");this.$paidyInstallmentsMobileSecondaryContinueButton.addClass("apx-js-hide");this.$paidyAccountUpgradeInfoHeader.removeClass("apx-js-hide");this.$paidyAccountUpgradeSteps.removeClass("apx-js-hide");this.$paidyAccountUpgradeTable.removeClass("apx-js-hide")},
_postpayAccountUpgradeOnePaySelectedAction:function(){this.$paidyApplyForUpgradeMobileTopButton.addClass("apx-js-hide");this.$paidyApplyForUpgradeMobileBottomButton.addClass("apx-js-hide");this.$paidyInstallmentsMobilePrimaryContinueButton.removeClass("apx-js-hide");this.$paidyInstallmentsMobileSecondaryContinueButton.removeClass("apx-js-hide");this.$paidyAccountUpgradeInfoHeader.addClass("apx-js-hide");this.$paidyAccountUpgradeSteps.addClass("apx-js-hide");this.$paidyAccountUpgradeTable.addClass("apx-js-hide")},
_updateTouchLinkContent:function(){this.$installmentsMobileTouchLink.find("input").remove();var a=this._extractInputs(this.$installmentsMobilePopover);null!=a&&(this._appendHiddenInput(a,this.$installmentsMobileTouchLink),a=a.value.includes("INSTALLMENT")?a.parentElement.innerText:this.installmentsAvailableMessage,this.$installmentsMobileTouchLink.find("span").text(a))},_extractInputs:function(a){var b=null;a.find("input").each(function(a,c){c&&c.type&&c.name&&c.value&&"radio"===c.type&&c.checked&&
(b=c)});return b},_appendHiddenInput:function(a,b){f('\x3cinput type\x3d"hidden"\x3e').attr({name:a.name,value:a.value}).appendTo(b)},_closePostPayPaymentOptionsSecondaryPopover:function(){c.when("a-secondary-view").execute(function(a){a&&(a=a.get("PostpayInstallmentsSecondaryPopover"))&&a.hide()})}})});d("components/PaidySleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(d,e){return d.extend(e,{initialize:function(d,c){this._instrumentId=c.data.instrumentId}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-RewardsAccount","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/RewardsAccountMetadataSlotComponent",["component"],function(a){return a.extend({initialize:function(a,b){}})})})()});
/* ******** */
(function(r){var v=window.AmazonUIPageJS||window.P,k=v._namespace||v.attributeErrors,f=k?k("APXWidgetsAssets@APXWidgets-EquatedMonthlyInstallments","APXWidgetsAssets"):v;f.guardFatal?f.guardFatal(r)(f,window):f.execute(function(){r(f,window)})})(function(r,v,k){(function(){var f=PaymentsPortal2.modules.define;f("components/EmiListItemComponent","events/InstrumentRowSelectedEvent public-event-registry css-utils component lang jQuery AUI!P form-component InstallmentOptionsAccordionHelper".split(" "),
function(g,f,d,n,p,c,l,b,h){return b.extend({isNomenclatureWave2Enabled:!1,invalidCvv:!0,invalidPostalCode:!0,installmentNotSelected:!0,cvvFieldPrefix:"",postalFieldPrefix:"",noCostEMIMessageId:"",emiMenuKFSViewId:"",limitUpdateConsentMessage:"",isCvvRequired:!1,isPostalCodeRequired:!1,emiMenuInstrumentId:"",id:"",cvvId:"",postalCodeId:"",postalFieldName:"",cvvFieldName:"",installmentSelectionError:"",invalidVerificationCodeError:"",idSecView:"",isSecondaryViewEnabled:!1,isAPBWithEMIEnabled:!1,isAPBSelected:!1,
currentInstrumentId:null,installmentOfferBOsWithoutAPB:[],installmentOfferBOsWithAPB:[],isPaylastEligible:!1,showFloatingContinueBarOnNonPaylastPSP:!1,initialize:function(a,b){this.isNomenclatureWave2Enabled=b.data.isNomenclatureWave2Enabled;this.currentInstrumentId="EMI-"+this.data.instrumentId;this.cvvFieldPrefix=this.data.cvvFieldPrefix;this.emiMenuInstrumentId=this.data.emiMenuInstrumentId;this.id=this.emiMenuInstrumentId+"-"+this.data.instrumentId;this.idSecView="EMISec-"+this.data.instrumentId;
this.cvvId=this.cvvFieldPrefix+this.data.index;this.noCostEMIMessageId=this.data.noCostEMIMessageKey+this.data.index;this.emiMenuKFSViewId=this.data.emiMenuKFSViewContainerKey;this.limitUpdateConsentMessageId=this.data.limitUpdateConsentMessage;this.postalCodeId=this.postalCodeFieldPrefix+this.data.index;this.isCvvRequired=this.data.isCvvRequired;this.isPostalCodeRequired=this.data.isPostalCodeRequired;this.postalFieldName=this.data.postalFieldName;this.cvvFieldName=this.data.cvvFieldName;this.installmentSelectionError=
this.data.installmentSelectionError;this.invalidVerificationCodeError=this.data.invalidVerificationCodeError;this.isSecondaryViewEnabled=this.data.isSecondaryViewEnabled;this.isAPBWithEMIEnabled=this.data.isAPBWithEMIEnabled;this.isPaylastEligible=this.data.isPaylastEligible;this.showFloatingContinueBarOnNonPaylastPSP=this.data.showFloatingContinueBarOnNonPaylastPSP;this.isDownPaymentEnabled=this.data.isDownPaymentEnabled;this.isDownPaymentWithAPBSelectionFixEnabled=this.data.isDownPaymentWithAPBSelectionFixEnabled;
this.installmentOptionsAccordionHelper=new h(this);this.isEmiKfsViewEnabled=this.data.isEmiKfsViewEnabled;this.installmentOfferBOsWithoutAPB=this.data.installmentOfferBOsWithoutAPB;this.installmentOfferBOsWithAPB=this.data.installmentOfferBOsWithAPB;this.hideEMIInfoMessage();this.isAccordionViewForDesktopEnabled=this.data.isAccordionViewForDesktopEnabled;this.isMobile="mobile"===a.options.deviceType},updateEmiContinueButton:function(){var a,b=!1;this.installmentNotSelected?a=this.installmentSelectionError:
this.invalidCvv&&this.isCvvRequired?(a=this.invalidVerificationCodeError,b=!0):this.isPostalCodeRequired&&this.invalidPostalCode?(b=!0,a=this.invalidVerificationCodeError):(a=null,b=!0);(this.data.skipFormValidation||this.showFloatingContinueBarOnNonPaylastPSP)&&this.widget.trigger("fetchOrderSummary",{fetchCompleteOrderSummary:b});this.displayableError=a?this.widget.getLocalizedString(a):null;this._triggerEmiBackingInstrumentSelectedEvent([this.displayableError])},_mobileView:function(){return"mobile"===
this.widget.options.deviceType},_validateFormField:function(a){return p.filter(this.form.validateForm(),function(b){return b.field===a})},_triggerEmiBackingInstrumentSelectedEvent:function(a){this.widget.trigger("backingInstrumentSelected",{instrumentId:this.emiMenuInstrumentId,instrumentType:this.data.instrumentType,errors:a,paymentMethod:this.data.paymentMethod})},checkCreditCardVerificationCode:function(){this.invalidCvv=0<this._validateFormField(this.cvvFieldName).length},checkPostalCode:function(){this.invalidPostalCode=
0<this._validateFormField(this.postalFieldName).length},checkInstallmentsField:function(){this.installmentNotSelected=0<this._validateFormField(this.data.installmentSelection).length;this.isNomenclatureWave2Enabled||this.getDOMElement(this.idSecView).toggleClass("a-button-error",this.installmentNotSelected)},extractCreditCardInstrumentFromInstrumentId:function(a){return a.replace("EMI-","")},_getCreditCardInstallmentMobileHiddenInput:function(a){a=this.extractCreditCardInstrumentFromInstrumentId(a);
return this.getDOMElement("emiListItemSelectionHiddenInput-"+a).add(this.getDOMElement("emiListItemSelectionHiddenInput-"))},_getCreditCardInstallmentDownPaymentValueHiddenInput:function(a){a=this.extractCreditCardInstrumentFromInstrumentId(a);return this.getDOMElement("emiListItemDownPaymentValueSelectionHiddenInput-"+a).add(this.getDOMElement("emiListItemDownPaymentValueSelectionHiddenInput-"))},_getCreditCardInstallmentDownPaymentCurrencyHiddenInput:function(a){a=this.extractCreditCardInstrumentFromInstrumentId(a);
return this.getDOMElement("emiListItemDownPaymentCurrencySelectionHiddenInput-"+a).add(this.getDOMElement("emiListItemDownPaymentCurrencySelectionHiddenInput-"))},_getCreditCardInstallmentMobileTouchLink:function(a){a=this.extractCreditCardInstrumentFromInstrumentId(a);return this.getDOMElement("emiListItemMobileTouchLink-"+a).add(this.getDOMElement("emiListItemMobileTouchLink-"))},_triggerInstallmentOptionChangedEvent:function(a){this.widget.trigger("installmentOptionChanged",{summaryDisplay:a})},
_getPrimaryViewButtonDisplay:function(a){a=this.extractCreditCardInstrumentFromInstrumentId(a);return this.getDOMElement("emiListItemOfferButtonText-"+a).add(this.getDOMElement("emiListItemOfferButtonText-"))},_showAndUpdateKFSComponentFromCurrentSelection:function(a){this.isEmiKfsViewEnabled&&this.currentInstrumentId===a.data("instrumentid").toString()&&(this.triggerEventToUpdateKFSInfo(a.data("financialofferid")),this.toggleKfsView(!0))},_toggleAndUpdateKFSComponentFromHiddenInput:function(){if(this.isEmiKfsViewEnabled){var a=
this._getCreditCardInstallmentMobileHiddenInput(this.currentInstrumentId);a[0]!==k&&""!==a[0].value?(this.triggerEventToUpdateKFSInfo(a[0].value),this.toggleKfsView(!0)):this.toggleKfsView(!1)}},triggerEventToUpdateKFSInfo:function(a){this.widget.trigger("updateKfsInfo",{instrumentId:this.currentInstrumentId,installmentPlanId:a})},closeCreditCardInstallmentsSecondaryPopover:function(a){var b=this.extractCreditCardInstrumentFromInstrumentId(a);l.when("a-secondary-view").execute(function(a){a&&(a=a.get("emiListItemSecondaryPopoverEMIMenu-"+
b))&&a.hide()});"undefined"!==typeof this._getCreditCardInstallmentMobileHiddenInput(this.currentInstrumentId)[0]&&(this.checkInstallmentsField(),this.updateEmiContinueButton())},displayNCEMessageWithAPB:function(){d.toggleElement(this.getDOMElement("nceAvailableTextWithAPB"),!0);d.toggleElement(this.getDOMElement("nceAvailableTextWithoutAPB"),!1)},displayNCEMessageWithoutAPB:function(){d.toggleElement(this.getDOMElement("nceAvailableTextWithoutAPB"),!0);d.toggleElement(this.getDOMElement("nceAvailableTextWithAPB"),
!1)},showEMIInfoMessage:function(a){var b=this.getDOMElement("emiInfoMessage");d.toggleElement(b,!0);a=this.getEMIInfoDisplayMessage(a);b[0].getElementsByClassName("a-alert-content")[0].textContent=a},hideEMIInfoMessage:function(){var a=this.getDOMElement("emiInfoMessage");d.toggleElement(a,!1)},toggleKfsView:function(a){d.toggleElement(this.getDOMElement(this.emiMenuKFSViewId),a)},getEMIInfoDisplayMessage:function(a){return a?this.widget.getLocalizedString("apx_payselect_apb_plus_emi_feature_deselect_apb_to_view_emi_options_message"):
this.widget.getLocalizedString("apx_payselect_apb_plus_emi_feature_select_apb_to_view_emi_options_message")},bindToEvents:function(){this.widget.on("toggleEmiDropDown",this,function(a){c(".emiMenuDropdown").val()===this.data.instrumentId&&a.instrumentId===this.emiMenuInstrumentId?(this._onInstrumentSelected(),this.isAPBSelected&&this.isAPBWithEMIEnabled&&0===this.installmentOfferBOsWithAPB.length&&(this._onInstrumentDeselected(),this.showEMIInfoMessage(this.isAPBSelected)),!this.isAPBSelected&&this.isAPBWithEMIEnabled&&
0===this.installmentOfferBOsWithoutAPB.length&&(this._onInstrumentDeselected(),this.showEMIInfoMessage(this.isAPBSelected))):(this._onInstrumentDeselected(),this.hideEMIInfoMessage())});this.widget.on("componentsInitialized",this,function(){d.toggleElement(this.getDOMElement(this.id),!1)});(this._mobileView()||this.isAccordionViewForDesktopEnabled)&&this.installmentOptionsAccordionHelper.bindToEvents();this.widget.on("installmentOptionsAccordionChanged",this,function(a){a.instrumentId===this.currentInstrumentId&&
(this._getCreditCardInstallmentMobileHiddenInput(a.instrumentId).val(a.financialofferid),this._triggerInstallmentOptionChangedEvent(a.summaryDisplay),this.checkInstallmentsField(),this.updateEmiContinueButton())});this.widget.on("updatePrimaryButtonDisplayString",this,function(a){if(this.currentInstrumentId===a.instrumentId){var b=this._getPrimaryViewButtonDisplay(this.currentInstrumentId),h=this._getCreditCardInstallmentMobileHiddenInput(a.instrumentId);""===a.displayString&&(a.displayString=this.widget.getLocalizedString("apx_emi_menu_sec_view_default_text"));
b.html(a.displayString);h.val(a.installmentPlanId);this.isDownPaymentWithAPBSelectionFixEnabled&&a.downPaymentAmount!==k&&""!==a.downPaymentAmount&&(b=this._getCreditCardInstallmentDownPaymentValueHiddenInput(a.instrumentId),h=this._getCreditCardInstallmentDownPaymentCurrencyHiddenInput(a.instrumentId),a=JSON.parse(a.downPaymentAmount),b.val(a.amount),h.val(a.currency))}});if(this.isAPBWithEMIEnabled)this.widget.on("apbSelectionChanged",this,function(a){a.isSelected?(this.displayNCEMessageWithAPB(),
this.isAPBSelected=!0):(this.displayNCEMessageWithoutAPB(),this.isAPBSelected=!1);if(c(".emiMenuDropdown").val()===this.data.instrumentId){var b=this.widget.getLocalizedString("apx_payselect_apb_plus_emi_feature_emi_plan_change_message");a.isSelected?0===this.installmentOfferBOsWithAPB.length&&(b=this.widget.getLocalizedString("apx_payselect_apb_plus_emi_feature_deselect_apb_to_view_emi_options_message")):0===this.installmentOfferBOsWithoutAPB.length&&(b=this.widget.getLocalizedString("apx_payselect_apb_plus_emi_feature_select_apb_to_view_emi_options_message"));
this.widget.trigger("infoMessageAfterChangeInAPBSelection",{message:b});this._toggleAndUpdateKFSComponentFromHiddenInput()}})},bindToElements:function(){var a=this;this.isCvvRequired&&c(this.getDOMElement(this.cvvFieldName)).bind("input",function(){a.checkCreditCardVerificationCode();a.updateEmiContinueButton()});this.isPostalCodeRequired&&c(this.getDOMElement(this.postalFieldName)).bind("input",function(){a.checkPostalCode();a.updateEmiContinueButton()});a.form.bindToParameter(this.data.installmentSelection,
"change",function(){a.checkInstallmentsField();a.updateEmiContinueButton()})},_resetOrderTotalComputation:function(){this.widget.trigger("UpdateOrderTotalForIBDEvent",{ibdAmountDisplayed:0});this.widget.trigger("UpdateOrderTotalForNoCostEMIDiscount",{noCostEMIValue:0})},_onInstrumentDeselected:function(){d.toggleElement(this.getDOMElement(this.idSecView),!1);d.toggleElement(this.getDOMElement(this.id),!1);d.toggleElement(this.getDOMElement(this.cvvId),!1);d.toggleElement(this.getDOMElement(this.postalCodeId),
!1);d.toggleElement(this.getDOMElement(this.noCostEMIMessageId),!1);d.toggleElement(this.getDOMElement(this.limitUpdateConsentMessageId),!1);this.toggleKfsView(!1)},_onInstrumentSelected:function(){this._mobileView()?this.isSecondaryViewEnabled?(d.toggleElement(this.getDOMElement(this.idSecView),!0),d.toggleElement(this.getDOMElement(this.id),!1)):(d.toggleElement(this.getDOMElement(this.idSecView),!1),d.toggleElement(this.getDOMElement(this.id),!0)):(d.toggleElement(this.getDOMElement(this.idSecView),
!1),d.toggleElement(this.getDOMElement(this.id),!0));this.isCvvRequired?d.toggleElement(this.getDOMElement(this.cvvId),!0):d.toggleElement(this.getDOMElement(this.cvvId),!1);this.isPostalCodeRequired?d.toggleElement(this.getDOMElement(this.postalCodeId),!0):d.toggleElement(this.getDOMElement(this.postalCodeId),!1);d.toggleElement(this.getDOMElement(this.noCostEMIMessageId),!0);this.checkInstallmentsField();this.updateEmiContinueButton();(this.isPaylastEligible||this.showFloatingContinueBarOnNonPaylastPSP)&&
this._resetOrderTotalComputation();this._toggleAndUpdateKFSComponentFromHiddenInput();d.toggleElement(this.getDOMElement(this.limitUpdateConsentMessageId),!0)}})});f("components/SelectableEmiMenuComponent","events/InstrumentRowSelectedEvent public-event-registry css-utils component lang jQuery components/SimplePaymentOptionListItemComponent form-component continuable".split(" "),function(g,f,d,k,p,c,l,b,h){return b.extend(h,{creditCardSelectionError:"",instrumentId:"",paymentMethod:"",instrumentType:"",
emiMenuContainer:"",emiDisabledContainer:"",emiDisabledAPBSelection:"",emiDisabledInvalidPurchase:"",emiEnabledContainer:"",emiContentWrapper:"",isAnyEMIOptionAvailable:!0,addCreditCardContainer:"",addCreditCardWorkflowId:"",addCardIntermittentStepRemoved:!1,addCreditCardSelectedEvent:"",addCreditCardDeselectedEvent:"",addCreditCardOptionValue:"",amazonCreditUnavailableMessage:"",isAPBWithEMIEnabled:!1,isDebitEMIRecommendationMessage:!1,isMShop:!1,initialize:function(a,b){this.addCardIntermittentStepRemoved=
b.data.addCardIntermittentStepRemoved;this.addCreditCardWorkflowId=this.data.addCreditCardWorkflowId;this.addCreditCardSelectedEvent=this.data.addCreditCardSelectedEvent;this.addCreditCardDeselectedEvent=this.data.addCreditCardDeselectedEvent;this.addCreditCardOptionValue=this.data.addCreditCardOptionValue;this.addCreditCardContainer=this.data.addCreditCardContainer;this.enterAddCardDetailsError=this.data.enterAddCardDetailsError;this.instrumentId=this.data.instrumentId;this.paymentMethod=this.data.paymentMethod;
this.instrumentType=this.data.instrumentType;this.emiMenuContainer=this.data.emiMenuContainer;this.emiDisabledContainer=this.data.emiDisabledContainer;this.emiDisabledAPBSelection=this.data.emiDisabledAPBSelection;this.emiDisabledInvalidPurchase=this.data.emiDisabledInvalidPurchase;this.emiEnabledContainer=this.data.emiEnabledContainer;this.emiContentWrapper=this.data.emiContentWrapper;this.isAnyEMIOptionAvailable=this.data.isAnyEMIOptionAvailable;this.creditCardSelectionError=this.data.creditCardSelectionError;
this.amazonCreditUnavailableMessage=this.data.amazonCreditUnavailableMessage;this.isAPBWithEMIEnabled=this.data.isAPBWithEMIEnabled;this.isDebitEMIRecommendationMessage=this.data.isDebitEMIRecommendationMessage;this.isShowingAddCard=!1;this.isMShop=this.data.isMShop;this.isAnyEMIOptionAvailable&&(d.toggleElement(this.getDOMElement(this.emiDisabledContainer),!1),this._toggleEmiContentWrapper(!1),this._toggleAmazonCreditUnavailableMessage(!1),f.register(g));d.toggleElement(this.getDOMElement("emiMenuAlertMessage"),
!0);this._isAmazonPayBalanceSelected()&&!this.isAPBWithEMIEnabled?(d.toggleElement(this.getDOMElement(this.emiDisabledAPBSelection),!0),d.toggleElement(this.getDOMElement(this.emiDisabledInvalidPurchase),!1)):(d.toggleElement(this.getDOMElement(this.emiDisabledAPBSelection),!1),d.toggleElement(this.getDOMElement(this.emiDisabledInvalidPurchase),!0))},_triggerEmiBackingInstrumentSelectedEvent:function(a){this.widget.trigger("backingInstrumentSelected",{instrumentId:this.instrumentId,instrumentType:this.instrumentType,
errors:a,paymentMethod:this.paymentMethod})},_getContainerElement:function(){return this.getDOMElement(this.emiMenuContainer)},_validateFormField:function(a){return p.filter(this.form.validateForm(),function(b){return b.field===a})},checkCreditCardSelection:function(){return 0<this._validateFormField(this.data.creditCardField).length},_toggleEmiContentWrapper:function(a){d.toggleElement(this.getDOMElement(this.emiContentWrapper),a)},_toggleDebitEmiRecommendationMessage:function(a){d.toggleElement(this.getDOMElement("DebitEMIRecommendationMessage"),
a)},_toggleAmazonCreditUnavailableMessage:function(a){d.toggleElement(this.getDOMElement(this.amazonCreditUnavailableMessage),a)},_isAmazonPayBalanceSelected:function(){return!!this.widget.get("apbCheckboxSelected")},isEmiAvailable:function(){return(!this._isAmazonPayBalanceSelected()||this.isAPBWithEMIEnabled)&&this.isAnyEMIOptionAvailable},bindToEvents:function(){var a=this;a.widget.on(g,this,function(a){a.instrumentId===this.addCreditCardOptionValue&&this.isEmiAvailable()&&this._onInstrumentSelected();
a.instrumentId===this._getInstrumentId()&&this.isEmiAvailable()?this._onInstrumentSelected():this._onInstrumentDeselected(a)});this.widget.on("pmts-close-add-card-form",this,this._resetBackingInstrumentSelection);a.widget.on("apbSelectionChanged",a,function(a){this.isAPBWithEMIEnabled&&this._isInstrumentSelected()?(this._onInstrumentDeselected(a),this.setContinuable(!1),a=this.widget.getLocalizedString("apx_payselect_apb_plus_emi_feature_emi_plan_change_message"),""===c(".emiMenuDropdown").val()&&
this.widget.trigger("ChangeInAPBSelectionAfterInstallmentPlanSelectionEvent",{message:a}),this.widget.trigger("PaymentPlanSelected",{isValid:!1,message:a})):this._toggleEmiMenu(a)});a.widget.on("infoMessageAfterChangeInAPBSelection",a,function(a){this.isAPBWithEMIEnabled&&this._isInstrumentSelected()&&this.widget.trigger("ChangeInAPBSelectionAfterInstallmentPlanSelectionEvent",{message:a.message})});a.widget.on("selectableAddEmiCardSelectedOnInitialize",this,function(){d.toggleElement(this.getDOMElement(this.data.paymentOptionDropdownContainer),
!1);this._onInstrumentSelected()});this.widget.on("initializeRecommendedInstrument",this,function(a){a.instrumentId===this._getInstrumentId()&&this.isEmiAvailable()&&this._onInstrumentSelected()});r.when("A","a-popover","ready").execute(function(b,h){var c=b.$;c(document).delegate(".a-popover-wrapper","keydown",function(a){c("li.suppressed-dropdown-option").unbind("keydown").keydown(function(a){if(13===a.keyCode)return a.preventDefault(),!1})});c(document).delegate(".emi-dropdown-add-card-item","click",
function(b){a.widget.publishSuccessSushiMetrics({ActionValueType:"Click",ActionValue:"AddCardOnEMIOption"})});c(document).delegate(".emi-menu-dropdown-item","click",function(b){a.widget.publishSuccessSushiMetrics({ActionValueType:"ClickSavedCard",ActionValue:b.target.innerHtml})})})},bindToElements:function(){var a=this;c(".emiMenuDropdown").change(function(){d.toggleElement(a.getDOMElement("emiMenuAlertMessage"),!1);a.checkCreditCardSelection();a._onInstrumentSelected()});a.data.isAnyEMIOptionAvailable&&
a._getContainerElement().click(function(){!a._isInstrumentSelected()&&a.isEmiAvailable()&&a.widget.trigger(g,{instrumentId:a.instrumentId})});this.getDOMElement(this.data.paymentOptionDropdownContainer).click(function(){a.widget.publishSuccessSushiMetrics({ActionValueType:"Click",ActionValue:"SelectEMIOption"})})},_toggleEmiMenu:function(a){d.toggleElement(this.getDOMElement(this.emiEnabledContainer),this.isEmiAvailable());d.toggleElement(this.getDOMElement(this.emiDisabledContainer),!this.isEmiAvailable());
d.toggleElement(this.getDOMElement(this.emiDisabledAPBSelection),this._isAmazonPayBalanceSelected()&&!this.isAPBWithEMIEnabled);d.toggleElement(this.getDOMElement(this.emiDisabledInvalidPurchase),!this._isAmazonPayBalanceSelected()||this.isAPBWithEMIEnabled);this._getInstrumentSelectionInputElement().prop("disabled",!this.isEmiAvailable());this._isInstrumentSelected()&&!this.isEmiAvailable()&&(this._getInstrumentSelectionInputElement().prop("checked",!1),this.widget.trigger(g,{}),this.setContinuable(!1),
this.widget.trigger("PaymentPlanSelected",{isValid:!1}))},_isInstrumentSelected:function(){return this._getContainerElement().hasClass("pmts-selected")},_getInstrumentId:function(){return this.instrumentId},_getInstrumentSelectionInputElement:function(){return this.getDOMElement("instrumentRowSelection-"+this.instrumentId)},_toggleAddEmiCreditCardContainer:function(a){d.toggleElement(this.getDOMElement(this.addCreditCardContainer),a)},_onInstrumentSelected:function(){this.isDebitEMIRecommendationMessage&&
this._toggleDebitEmiRecommendationMessage(!1);this._triggerEmiBackingInstrumentSelectedEvent(["enter payment option details"]);this._getContainerElement().addClass("pmts-selected");this._getInstrumentSelectionInputElement().prop("checked",!0);this._toggleEmiContentWrapper(!0);this._toggleAmazonCreditUnavailableMessage(!0);if(c(".emiMenuDropdown").val()===this.addCreditCardOptionValue)if(this.addCardIntermittentStepRemoved){var a=this._getContainerElement().find("#apx-add-credit-card-action-test-id");
a.length&&a.trigger("click");this._toggleShowAddCardExperience(!0);this.isMShop&&this._delay(this).then(this._resetBackingInstrumentSelection)}else this._toggleAddEmiCreditCardContainer(!0),this.widget.trigger(this.addCreditCardSelectedEvent),this.widget.trigger("toggleEmiDropDown",{instrumentId:this.instrumentId});else this._toggleAddEmiCreditCardContainer(!1),this.widget.trigger(this.addCreditCardDeselectedEvent),this.widget.trigger("toggleEmiDropDown",{instrumentId:this.instrumentId}),this.addCardIntermittentStepRemoved&&
this._toggleShowAddCardExperience(!1)},_resetBackingInstrumentSelection:function(){r.when("a-dropdown","ready").execute(function(a){null!==a&&(a=a.getSelect(c(".emiMenuDropdown")),null!==a&&a.setValue(""))})},_delay:function(a){return new Promise(function(b,h){setTimeout(function(){b(a)},1E3)})},_toggleShowAddCardExperience:function(a){a?(this.isShowingAddCard=!0,c(".pmts-payment-method-secondary-slot").toggleClass("pmts-add-card-secondary-content-slot-hidden",!1)):this.isShowingAddCard&&(this.isShowingAddCard=
!1,c(".pmts-payment-method-secondary-slot").toggleClass("pmts-add-card-secondary-content-slot-hidden",!0))},_onInstrumentDeselected:function(a){this.isDebitEMIRecommendationMessage&&this._toggleDebitEmiRecommendationMessage(!0);this._getContainerElement().removeClass("pmts-selected");this._toggleAddEmiCreditCardContainer(!1);this._getInstrumentSelectionInputElement().prop("checked",!1);this.widget.trigger("toggleEmiDropDown",{instrumentId:a.instrumentId});this._toggleEmiContentWrapper(!1);this._toggleAmazonCreditUnavailableMessage(!1);
this.addCardIntermittentStepRemoved&&this._toggleShowAddCardExperience(!1)}})});f("components/InstallmentOptionsAccordionComponent","css-utils component lang jQuery AUI!P InstallmentOptionsAccordionHelper".split(" "),function(g,f,d,n,p,c){var l=!1;return f.extend({isEMIAvailable:!1,installmentOfferBOsWithoutAPB:[],installmentOfferBOsWithAPB:[],initialize:function(b,h){this.hideAccordionWithAPB();this.installmentOfferBOsWithoutAPB=this.data.installmentOfferBOsWithoutAPB;this.installmentOfferBOsWithAPB=
this.data.installmentOfferBOsWithAPB;this.isDynamicOrderSummaryEnabled=h.data.isDynamicOrderSummaryEnabled;this.installmentOptionPopoverTriggerSource=this.data.popoverTriggerSource;this.isEMIAvailable=this.installmentOfferBOsWithoutAPB!==k&&0!==this.installmentOfferBOsWithoutAPB.length||this.installmentOfferBOsWithAPB!==k&&0!==this.installmentOfferBOsWithAPB.length;g.hideElement(this.getDOMElement("emiErrorMessagingSlotInAccordion"));this.installmentOfferBOsWithoutAPB!==k&&0!==this.installmentOfferBOsWithoutAPB.length&&
(h=this.installmentOfferBOsWithoutAPB[0],null!==h.maybeProcessingFeeAmount&&this.displayProcessingFeeMessage({instrumentId:this.data.instrumentId,bankDisplayName:this.data.bankDisplayName,processingFeeAmount:h.maybeProcessingFeeAmount.value,fosId:h.financialOfferId}));this.data.isEMISuppressed&&this.displayEMILowPSRMessage();this.isMobile="mobile"===b.options.deviceType;this.installmentOptionsAccordionHelper=new c(this);this.isDownPaymentWithAPBSelectionFixEnabled=this.data.isDownPaymentWithAPBSelectionFixEnabled;
(this.isBuyNowPayLaterSeparateSectionEnabledForDesktop=this.data.isBuyNowPayLaterSeparateSectionEnabledForDesktop)?"AMAZON_EMI"===this.installmentOptionPopoverTriggerSource&&(this.initializeHiddenInputs("displayStringHiddenInputWithoutAPBEMI-","installmentPlanIdHiddenInputWithoutAPBEMI-",this.installmentOfferBOsWithoutAPB),this.initializeHiddenInputs("displayStringHiddenInputWithAPBEMI-","installmentPlanIdHiddenInputWithAPBEMI-",this.installmentOfferBOsWithAPB)):this.isMobile&&"AMAZON_EMI"===this.installmentOptionPopoverTriggerSource&&
(this.initializeHiddenInputs("displayStringHiddenInputWithoutAPBEMI-","installmentPlanIdHiddenInputWithoutAPBEMI-",this.installmentOfferBOsWithoutAPB),this.initializeHiddenInputs("displayStringHiddenInputWithAPBEMI-","installmentPlanIdHiddenInputWithAPBEMI-",this.installmentOfferBOsWithAPB))},_triggerRadioAction:function(b){b=n(b.currentTarget);var h=this.data.instrumentId,a=n("input:radio[name\x3demi-radio-"+h+"]:checked").val();a===b.data("financialofferid").toString()&&(g.hideElement(this.getDOMElementsByPrefix("installmentOptionsDetailBox-"+
h)),this.getDOMElementsByPrefix("installmentOptionsRadioButton-"+h).addClass("a-color-alternate-background"),g.showElement(this.getDOMElement("installmentOptionsDetailBox-"+h+a)),this.getDOMElement("installmentOptionsRadioButton-"+h+a).removeClass("a-color-alternate-background"),this.widget.trigger("installmentOptionsAccordionChanged",{instrumentId:h,financialofferid:a,summaryDisplay:b.data("summarydisplay")}))},bindToElements:function(){this.getDOMElementsByPrefix("installmentOptionsRadioButton-").click(d.bind(this._triggerRadioAction,
this))},bindToEvents:function(){this.data.isAPBWithEMIEnabled&&(this.widget.on("apbSelectionChanged",this,function(b){l=b.isSelected;var a=this.handleAPBSelection(l);if(this.mobile){b=this.getDOMElement("emiErrorMessagingSlotInAccordion");g.hideElement(b);var c=a.displayMessage,a=a.message;this.isEMIAvailable&&c&&this.isMobile&&(g.showElement(b),b[0].getElementsByClassName("a-alert-content")[0].textContent=a)}else this.updateInstallmentOptionsPopoverPrimaryButtonTextForDesktop(a.displayString,l)}),
this.widget.on("installmentPlanChanged",this,function(b){if(b.instrumentId===this.data.instrumentId){if(l)var a=this.getDOMElement("displayStringHiddenInputWithAPBEMI-"+b.instrumentId).add(this.getDOMElement("displayStringHiddenInputWithAPBEMI-")),c=this.getDOMElement("installmentPlanIdHiddenInputWithAPBEMI-"+b.instrumentId).add(this.getDOMElement("installmentPlanIdHiddenInputWithAPBEMI-"));else a=this.getDOMElement("displayStringHiddenInputWithoutAPBEMI-"+b.instrumentId).add(this.getDOMElement("displayStringHiddenInputWithoutAPBEMI-")),
c=this.getDOMElement("installmentPlanIdHiddenInputWithoutAPBEMI-"+b.instrumentId).add(this.getDOMElement("installmentPlanIdHiddenInputWithoutAPBEMI-"));a.val(b.displayHtml);c.val(b.installmentPlanId);this.updateDownPaymentAmountOnInstalmentPlanChange(l,this.data.instrumentId,b.downPaymentAmount)}}));this.widget.on("installmentPlanSelectedForDesktop",this,function(b){this.data.instrumentId===b.instrumentId&&(this.closeInstallmentOptionsPopover(b),this.updateInstallmentOptionsPopoverPrimaryButtonText(b))});
var b=this;p.when("A").execute(function(h){h.declarative("actionWithDownpayment_withAPB","click",function(a){b.toggleDownPaymentUI(a.$event,"withDownPayment","withoutDownPayment",!0)});h.declarative("actionWithDownpayment_withoutAPB","click",function(a){b.toggleDownPaymentUI(a.$event,"withDownPayment","withoutDownPayment",!1)});h.declarative("actionWithoutDownpayment_withAPB","click",function(a){b.toggleDownPaymentUI(a.$event,"withoutDownPayment","withDownPayment",!0)});h.declarative("actionWithoutDownpayment_withoutAPB",
"click",function(a){b.toggleDownPaymentUI(a.$event,"withoutDownPayment","withDownPayment",!1)})});b.widget.on("installmentOptionsAccordionSelection",this,function(b){this.toggleIBDMessage(b);(this.data.processingFeeMessageEnabled||this.data.processingFeeMessageAboveAccordionEnabled)&&this.displayProcessingFeeMessage(b)})},toggleIBDMessage:function(b){b.instrumentId===this.data.instrumentId&&(b.fosId?(g.hideElement(this.getDOMElement("IBDMessageForFullPayment")),g.showElement(this.getDOMElement("IBDMessageForEMI"))):
(g.showElement(this.getDOMElement("IBDMessageForFullPayment")),g.hideElement(this.getDOMElement("IBDMessageForEMI"))))},displayProcessingFeeMessage:function(b){if(b.instrumentId===this.data.instrumentId){var c=this.getDOMElement("processingFeeMessageContainer");b.fosId&&b.processingFeeAmount?(b=this.widget.getLocalizedString("apx_emi_processing_fee_message",{bankName:b.bankDisplayName,processingFee:b.processingFeeAmount}),this.getDOMElement("processingFeeMessage").html(b),g.showElement(c)):g.hideElement(c)}},
displayEMILowPSRMessage:function(){var b=this.getDOMElement("emiLowPSRMessageContainer");g.showElement(b)},initializeHiddenInputs:function(b,c,a){b=this.getDOMElement(b+this.data.instrumentId).add(this.getDOMElement(b));c=this.getDOMElement(c+this.data.instrumentId).add(this.getDOMElement(c));a&&0<a.length&&(1===a[0].numberOfInstallments?b.val(this.getOneMonthDisplayString(a[0])):b.val(a[0].selectionDisplayStrings[0]),c.val(a[0].financialOfferId))},getOneMonthDisplayString:function(b){var c="";null!==
b.maybeInstallmentStartTime&&(c={month:("undefined"!==typeof b.maybeInstallmentStartTime.year&&null!==b.maybeInstallmentStartTime.year?new Date(b.maybeInstallmentStartTime.year,b.maybeInstallmentStartTime.monthValue-1,b.maybeInstallmentStartTime.dayOfMonth):new Date(1E3*b.maybeInstallmentStartTime)).toLocaleString("default",{month:"short"})},c=this.data.isNCEPromtionForAPLOneMonthTenureWeblabEnabled&&this.isOneMonthNCEInstallmentOffer(b)?this.widget.getLocalizedString("apx_payselect_installment_row_pay_later_selected_nocost",
c):this.widget.getLocalizedString("apx_payselect_installment_row_pay_later_selected",c));return c},isOneMonthNCEInstallmentOffer:function(b){return 1===b.numberOfInstallments&&b.maybeOfferDiscountAmount&&0<b.maybeOfferDiscountAmount.value},fetchDownPaymentAmountOnAPBSelectionChange:function(b){var c;this.isDownPaymentWithAPBSelectionFixEnabled&&(b=b?this.getDOMElement("downPaymentAmountHiddenInputWithAPB-"+this.data.instrumentId).add(this.getDOMElement("downPaymentAmountHiddenInputWithAPB-")):this.getDOMElement("downPaymentAmountHiddenInputWithoutAPB-"+
this.data.instrumentId).add(this.getDOMElement("downPaymentAmountHiddenInputWithoutAPB-")),0<b.length&&(c=b[0].value));return c},updateDownPaymentAmountOnInstalmentPlanChange:function(b,c,a){this.isDownPaymentWithAPBSelectionFixEnabled&&a!==k&&(b?this.getDOMElement("downPaymentAmountHiddenInputWithAPB-"+c).add(this.getDOMElement("downPaymentAmountHiddenInputWithAPB-")).val(a):this.getDOMElement("downPaymentAmountHiddenInputWithoutAPB-"+c).add(this.getDOMElement("downPaymentAmountHiddenInputWithoutAPB-")).val(a))},
handleAPBSelection:function(b){var c,a,d="",e=!1;b?(this.hideAccordionWithoutAPB(),this.showAccordionWithAPB(),a=this.getDOMElement("displayStringHiddenInputWithAPBEMI-"+this.data.instrumentId).add(this.getDOMElement("displayStringHiddenInputWithAPBEMI-")),c=this.getDOMElement("installmentPlanIdHiddenInputWithAPBEMI-"+this.data.instrumentId).add(this.getDOMElement("installmentPlanIdHiddenInputWithAPBEMI-")),0<a.length&&""!==a[0].value?(a=a[0].value,c=c[0].value):c=a="",this.installmentOfferBOsWithAPB.length<
this.installmentOfferBOsWithoutAPB.length&&(e=!0,d=this.widget.getLocalizedString("apx_payselect_apb_plus_emi_feature_deselect_apb_for_more_tenures_message"))):(this.hideAccordionWithAPB(),this.showAccordionWithoutAPB(),a=this.getDOMElement("displayStringHiddenInputWithoutAPBEMI-"+this.data.instrumentId).add(this.getDOMElement("displayStringHiddenInputWithoutAPBEMI-")),c=this.getDOMElement("installmentPlanIdHiddenInputWithoutAPBEMI-"+this.data.instrumentId).add(this.getDOMElement("installmentPlanIdHiddenInputWithoutAPBEMI-")),
0<a.length&&""!==a[0].value?(a=a[0].value,c=c[0].value):c=a="",this.installmentOfferBOsWithoutAPB.length<this.installmentOfferBOsWithAPB.length&&(e=!0,d=this.widget.getLocalizedString("apx_payselect_apb_plus_emi_feature_select_apb_for_more_tenures_message")));b=this.fetchDownPaymentAmountOnAPBSelectionChange(b);this.widget.trigger("updatePrimaryButtonDisplayString",{instrumentId:this.data.instrumentId,displayString:a,installmentPlanId:c,downPaymentAmount:b});return{displayMessage:e,message:d,displayString:a}},
closeInstallmentOptionsPopover:function(b){var c=b.instrumentId;p.when("A","a-popover-base").execute(function(a,b){b&&(a="emiInstallmentOptionPopoverDesktop-"+c.replace(/\./g,"_"),(b=b.get(a))&&b.$popover.find("button[data-action]\x3da-popover-close").trigger("click"))})},_getPrimaryViewButtonDisplay:function(b){return this.getDOMElement("installmentOptionsPopoverPrimaryButtonTextDesktop-"+b).add(this.getDOMElement("installmentOptionsPopoverPrimaryButtonTextDesktop-"))},updateInstallmentOptionsPopoverPrimaryButtonTextForDesktop:function(b,
c){if(""===b)switch(this.installmentOptionPopoverTriggerSource){case "SAVED_CARD":c&&0<this.installmentOfferBOsWithAPB.length?b=this.getInstallmentOfferDisplayString(this.installmentOfferBOsWithAPB[0]):!c&&0<this.installmentOfferBOsWithoutAPB.length&&(b=this.getInstallmentOfferDisplayString(this.installmentOfferBOsWithoutAPB[0]));break;case "EMI_MENU":b=this.widget.getLocalizedString("apx_emi_menu_sec_view_default_text");break;case "AMAZON_EMI":b=this.getDisplayStringForPrimaryButton(c);break;default:b=
""}this.updateInstallmentOptionsPopoverPrimaryButtonText({instrumentId:this.data.instrumentId,displayHtml:b})},updateInstallmentOptionsPopoverPrimaryButtonText:function(b){this._getPrimaryViewButtonDisplay(b.instrumentId).html(b.displayHtml)},toggleDownPaymentUI:function(b,c,a,d){var e=this.data.instrumentId;b=n(b.currentTarget).find("input");if(e===b.data("instrumentid").toString()){var u=b.data("index").toString(),m="importantInformationSection-installmentOptionsAccordion-"+b.data("instrumentid").toString();
this.installmentOptionsAccordionHelper.showImportantInformation(b,e,b.data("financialofferid").toString(),m);this.showDownPaymentContent(e,u,d,c);this.hideDownPaymentContent(e,u,d,a)}},getInstallmentOfferDisplayString:function(b){return b.selectionDisplayStrings[0]},showDownPaymentContent:function(b,c,a,d){g.showElement(this.getDOMElementsByPrefix(b+a+c+d))},hideDownPaymentContent:function(b,c,a,d){g.hideElement(this.getDOMElementsByPrefix(b+a+c+d))},showAccordionWithAPB:function(){g.showElement(this.getDOMElement("accordionWithAPB"))},
hideAccordionWithAPB:function(){g.hideElement(this.getDOMElement("accordionWithAPB"))},showAccordionWithoutAPB:function(){g.showElement(this.getDOMElement("accordionWithoutAPB"))},hideAccordionWithoutAPB:function(){g.hideElement(this.getDOMElement("accordionWithoutAPB"))},getDisplayStringForPrimaryButton:function(b){var c="";b&&0<this.installmentOfferBOsWithAPB.length?c=this.getInstallmentOfferDisplayString(this.installmentOfferBOsWithAPB[0]):!b&&0<this.installmentOfferBOsWithoutAPB.length&&(c=this.getInstallmentOfferDisplayString(this.installmentOfferBOsWithoutAPB[0]));
return c}})});f("InstallmentOptionsAccordionHelper",["jQuery","AUI!P","css-utils","lang"],function(g,f,d,n){return function(d){function c(a,c,d,l){if(e.data.isImportantEmiInfoEnabled&&c===a.data("instrumentid").toString()){c=null;if(l=g("div[id\x3d'"+l+"']"))l.html(""),l.removeClass("importantInformationSection");""!==d&&(c=b(a));if(c&&0<c.length){a=e.widget.getLocalizedString("apx_important_emi_info_header_message");a=g('\x3cspan class\x3d"importantInformationTextColor a-text-bold"\x3e'+a+"\x3c/span\x3e");
var h=g('\x3cul class\x3d"a-unordered-list a-vertical"/\x3e');c.forEach(function(a){h.append('\x3cli\x3e\x3cspan class\x3d"a-list-item"\x3e\x3cspan class\x3d"importantInformationTextColor"\x3e'+a+"\x3c/span\x3e\x3c/span\x3e\x3c/li\x3e")});l&&(a.appendTo(l),h.appendTo(l),l.removeClass("importantInformationSection"))}else l&&l.addClass("importantInformationSection")}}function l(b){var c=h();if(b=a(c,b))(b=b.maybeOfferDiscountAmount)&&0<b.value?e.widget.trigger("UpdateOrderTotalForNoCostEMIDiscount",
{noCostEMIValue:Math.round(b.value)}):e.widget.trigger("UpdateOrderTotalForNoCostEMIDiscount",{noCostEMIValue:0})}function b(b){var c;c=0<Number(b.data("downpaymentamount"))?!0:!1;c=c?e.isApbSelected?e.data.installmentOfferBOsWithAPBWithDownPayment:e.data.installmentOfferBOsWithoutAPBWithDownPayment:h();var d=b.data("financialofferid");c=a(c,d);if(d=c.maybeTotalPrincipalAmount){var d=Math.round(d.value),l=Math.round(c.installmentMonthlyPaymentAmount.value),g=c.numberOfInstallments.toString,f;f=c.maybeOfferDiscountAmount;
var q=null;f&&f.value&&(q=Math.round(f.value));f=q;var q=c.maybeDownPaymentAmount,k=null;q&&(k=Math.round(q.value));var q=k,k=b.data("issuingbank"),p=b.data("paymentmethodcode");b=b.data("installmentstartdate");if(1<c.numberOfInstallments){if(k&&"BFL"===k)return c={emiAmount:l,tenure:g},b=e.widget.getLocalizedString("apx_important_emi_info_nce_creditLimitBlock_message_without_discount",{discountedAmount:d}),c=e.widget.getLocalizedString("apx_important_emi_info_emiAndTenureInfo_message",c),d=e.widget.getLocalizedString("apx_checkout_spc_bfl_disclaimer"),
[b,c,d];if("AmazonCredit"===p){if(k&&k.endsWith("_3P"))return t(d,q,!0);c=e.widget.getLocalizedString("apx_important_emi_info_aemi_limit_utilization",{principal:d});b&&""!==b?(b=e.widget.getLocalizedString("apx_important_emi_info_aemi_due_date",{installmentStartDate:b}),b=[c,b]):b=[c];return b}return 0<f?(b=q?e.widget.getLocalizedString("apx_important_emi_info_downpayment_message",{downPayment:q,amountForEMIConversion:d}):e.widget.getLocalizedString("apx_important_emi_info_nce_creditLimit_message",
{discountedAmount:d}),c=e.widget.getLocalizedString("apx_important_emi_info_nce_interestInfo_message",{nceDiscount:f}),[b,c]):t(d,q,!1)}}return null}function h(){var a=null;e.isApbSelected?a=e.data.installmentOfferBOsWithAPB:e.data.installmentOfferBOs?a=e.data.installmentOfferBOs:e.data.installmentOfferBOsWithoutAPB&&(a=e.data.installmentOfferBOsWithoutAPB);return a}function a(a,b){var c=null;a&&(c=a.filter(function(a){return a.financialOfferId===b})[0]);return c}function t(a,b,c){a=b?e.widget.getLocalizedString("apx_important_emi_info_downpayment_message",
{downPayment:b,amountForEMIConversion:a}):c?e.widget.getLocalizedString("apx_important_emi_info_aemi_cardless_consumed_creditlimit",{amount:a}):e.widget.getLocalizedString("apx_important_emi_info_nce_creditLimitBlock_message_without_discount",{discountedAmount:a});b=e.widget.getLocalizedString("apx_important_emi_info_amountToEMIConversion_message");return[a,b]}var e=d;e.isApbSelected=!1;return{bindToEvents:function(){f.when("A","a-modal").execute(function(b,d){function f(a,b,d,l){e.widget.trigger("installmentOptionsAccordionSelection",
{fosId:b,instrumentId:a,bankDisplayName:d,processingFeeAmount:l});d="importantInformationSection-installmentOptionsAccordion-"+a;l=g("div[data-a-accordion-row-name\x3d'"+("installmentOptionAccordionRow-"+a+b)+"']");c(l,a,b,d)}function t(a,c,e,d){b.on("a:accordion:installmentOptionsAccordion-EMI-"+a+":installmentOptionAccordionRow-EMI-"+a+c+":select",function(b){f("EMI-"+a,c,e,d)})}function p(a,c,e,d){b.on("a:accordion:installmentOptionsAccordion-"+a+":installmentOptionAccordionRow-"+a+c+":select",
function(b){f(a,c,e,d)})}b.on("a:popover:afterHide:creditCardInstallmentsSecondaryPopover-"+e.currentInstrumentId,function(a){self.widget.publishSuccessSushiMetrics({ActionValueType:"Click",ActionValue:"CardInstallmentSecondaryPopoverClosed"});a=e.currentInstrumentId;var b=e._getCreditCardInstallmentMobileHiddenInput(a);g("[data-a-accordion-name\x3d'installmentOptionsAccordion-"+a+"'] [data-a-accordion-row-name\x3d'"+("installmentOptionAccordionRow-"+a+(0<b.length?b[0]:""))+"'] a").click()});b.on("a:popover:afterHide:emiListItemSecondaryPopoverEMIMenu-"+
e.currentInstrumentId,function(a){self.widget.publishSuccessSushiMetrics({ActionValueType:"Click",ActionValue:"EMIListItemSecondaryPopoverClosed"})});b.declarative("chooseInstallmentButton","click",function(b){self.widget.publishSuccessSushiMetrics({ActionValueType:"Click",ActionValue:"ChooseEMIPlan"});var c=e.currentInstrumentId,d=g(b.$event.currentTarget);b=d.find("input");var f=d.find(".a-section").html();self.widget.publishSuccessSushiMetrics({ActionValueType:"SelectedEMI",ActionValue:f});c.split(".").join("-");
if(c===b.data("instrumentid").toString()){var d=e.currentInstrumentId,t;if(d===b.data("instrumentid").toString()){e._getCreditCardInstallmentMobileHiddenInput(d).val(b.data("financialofferid"));e.isDownPaymentEnabled&&(e._getCreditCardInstallmentDownPaymentValueHiddenInput(d).val(b.data("downpaymentamount")),e._getCreditCardInstallmentDownPaymentCurrencyHiddenInput(d).val(b.data("downpaymentcurrency")),t={amount:b.data("downpaymentamount"),currency:b.data("downpaymentcurrency")});e._getPrimaryViewButtonDisplay(d).html(f);
e.isAccordionViewForDesktopEnabled&&e.widget.trigger("installmentPlanSelectedForDesktop",{instrumentId:d,displayHtml:f});if(e.isDynamicOrderSummaryEnabled){var k=e.currentInstrumentId,q=b.data().financialofferid,u=h();if(u=a(u,q))if((u=u.maybeOfferDiscountAmount)&&0<u.value)try{var p=-1*Math.round(u.value),m=document.getElementsByName("ppw-"+k+"_instrumentOrderTotalBalance")[0],n=JSON.parse(m&&m.value?m.value.toString():"{}");n&&0!==Object.keys(n).length?n.nceDiscount=p:n={nceDiscount:p};m&&(m.value=
JSON.stringify(n))}catch(r){console.log(r)}else{if(m=document.getElementsByName("ppw-"+k+"_instrumentOrderTotalBalance")[0])m.value=JSON.stringify({})}else if(m=document.getElementsByName("ppw-"+k+"_instrumentOrderTotalBalance")[0])m.value=JSON.stringify({});e.widget.trigger("UpdateOrderTotalHiddenInputForIBD",{fosId:q,instrumentId:k})}if(e.isPaylastEligible||e.showFloatingContinueBarOnNonPaylastPSP)""!==b.data("financialofferid")?(e.widget.trigger("UpdateOrderTotalForIBDonEMIOnly",{emiOptionSelected:!0,
instrumentId:e.currentInstrumentId}),l(b.data().financialofferid)):(e.widget.trigger("UpdateOrderTotalForIBDonEMIOnly",{emiOptionSelected:!1,instrumentId:e.currentInstrumentId}),e.widget.trigger("UpdateOrderTotalForNoCostEMIDiscount",{noCostEMIValue:0,instrumentId:e.currentInstrumentId}));e.isAPBWithEMIEnabled&&e.widget.trigger("installmentPlanChanged",{instrumentId:d,displayHtml:f,installmentPlanId:b.data("financialofferid"),downPaymentAmount:JSON.stringify(t)});t=b.data("summarydisplay");e._getCreditCardInstallmentMobileTouchLink(d).find("input").data("summarydisplay",
t);e._triggerInstallmentOptionChangedEvent(t);t=d.split(".").join("-");e.closeCreditCardInstallmentsSecondaryPopover(t)}c.startsWith("EMI-")&&e._showAndUpdateKFSComponentFromCurrentSelection(b);e.widget.trigger("UpdateIBDAmount",{fosId:b.data("financialofferid"),instrumentId:e.currentInstrumentId})}});if(e.data.differentialIBDPromotionEnabled||e.data.processingFeeMessageEnabled||e.data.processingFeeMessageAboveEnabled)if(b.on("a:accordion:installmentOptionsAccordion-"+e.data.instrumentId+":installmentOptionAccordionRow-"+
e.data.instrumentId+":select",function(a){f(e.data.instrumentId,"",e.data.bankDisplayName)}),d=null,e.data.installmentOfferBOs?d=e.data.installmentOfferBOs:e.data.installmentOfferBOsWithoutAPB&&(d=e.data.installmentOfferBOsWithoutAPB),d!==k)for(var n=0;n<d.length;n++){var q=d[n],r=q.financialOfferId,v=e.data.bankDisplayName,w;null!==q.maybeProcessingFeeAmount&&(w=q.maybeProcessingFeeAmount.value);t(e.data.instrumentId,r,v,w);p(e.data.instrumentId,r,v,w)}e.widget.on("GetNoCostEMISelectionDiscountValue",
e,function(a){(e.isPaylastEligible||e.showFloatingContinueBarOnNonPaylastPSP)&&a.instrumentId===e.currentInstrumentId&&(a=e._getCreditCardInstallmentMobileHiddenInput(a.instrumentId))&&0<a.length&&l(a[0].value)});e.widget.on("apbSelectionChanged",e,function(a){e.isApbSelected=a.isSelected?!0:!1})})},showImportantInformation:c}}});f("components/EmiKfsComponent",["css-utils","component","lang","jQuery","AUI!P"],function(g,f,d,k,p){return f.extend({installmentPlanDataWithoutAPBSequence:[],installmentPlanDataWithAPBSequence:[],
maxTenure:0,initialize:function(){this.installmentPlanDataWithoutAPBSequence=this.data.installmentPlanDataWithoutAPBSequence;this.installmentPlanDataWithAPBSequence=this.data.installmentPlanDataWithAPBSequence;this.currentInstrumentId=this.data.instrumentId;this.maxTenure=this.data.maxTenure},getEligibleInstallmentPlanDataSequence:function(){return this.isAmazonPayBalanceSelected()?this.installmentPlanDataWithAPBSequence:this.installmentPlanDataWithoutAPBSequence},isAmazonPayBalanceSelected:function(){return this.widget.get("apbCheckboxSelected")},
getSelectedInstallmentPlanData:function(c,d){var b=null;c&&(b=c.filter(function(b){return b.installmentPlanId===d})[0]);return b},getInstallmentsTotals:function(c){var d=0,b=0,h=0,a=0;c.maybeInterestAmount&&(d=c.maybeInterestAmount.value);c.maybeTotalCost&&(b=c.maybeTotalCost.value);c.maybeTotalPrincipalAmount&&(h=c.maybeTotalPrincipalAmount.value);c.maybeOfferDiscountAmount&&(a=c.maybeOfferDiscountAmount.value);var f={};f.monthlyPayableAmount=c.installmentMonthlyPaymentAmount.value;f.interestAmount=
d;f.totalCost=b;f.loanAmount=h;f.interestRate=this.getInterestRate(c);f.emiDiscount=a;return f},getFormattedAmount:function(c){return this.widget.getLocalizedString("apx_emi_kfs_formated_amount",{amount:c})},getInterestRate:function(c){return c.maybeInterestRate?c.maybeInterestRate:""},getTenureDisplayString:function(c){return 1===c?this.widget.getLocalizedString("apx_emi_kfs_tenure_value_one_month",{month:c}):this.widget.getLocalizedString("apx_emi_kfs_tenure_value",{month:c})},getInterestRateDisplayString:function(c,
d,b){return 1===b?this.widget.getLocalizedString("apx_emi_kfs_interest_rate_one_month"):0<d?this.widget.getLocalizedString("apx_emi_kfs_interest_rate_ncemi",{interestRate:c}):this.widget.getLocalizedString("apx_emi_kfs_interest_rate_standard_emi",{interestRate:c})},getTotalInterestDisplayString:function(c,d,b){return 1===b?this.widget.getLocalizedString("apx_emi_kfs_total_interest_one_month"):0<d?d>=c?this.widget.getLocalizedString("apx_emi_kfs_total_interest_ncemi",{totalInterest:this.getFormattedAmount(c)}):
this.widget.getLocalizedString("apx_emi_kfs_total_interest_mixed_cart",{totalInterest:this.getFormattedAmount(c)}):this.getFormattedAmount(c)},getRepaymentScheduleTable:function(c,d,b,f){for(var a=[],g=0;g<d;g++){var e={},k=c;0<g&&(k=a[g-1].outstandingPrincipal-a[g-1].principal);var m=k*b,n=0,p=Math.round(f),r=p-m;g+1===d&&(0!==m&&(n=Math.round(k+m)-(k+m)),p=k+m,r=k);m+=n;e.installmentNumber=g+1;e.outstandingPrincipal=k.toFixed(2);e.principal=r.toFixed(2);e.interestAmount=m.toFixed(2);e.installmentAmount=
p.toFixed(2);a[g]=e}return a},hideRepaymentScheduleContent:function(){for(var c=1;c<=this.maxTenure;c++)g.hideElement(this.getDOMElement("repaymentScheduleInstallmentNumber_"+c))},updateRepaymentScheduleRow:function(c){var d=this.getDOMElement("repaymentScheduleOutstandingPrincipalInstallmentNumber_"+c.installmentNumber),b=this.getDOMElement("repaymentSchedulePrincipalInstallmentNumber_"+c.installmentNumber),f=this.getDOMElement("repaymentScheduleInterestInstallmentNumber_"+c.installmentNumber),a=
this.getDOMElement("repaymentScheduleInstallmentAmountInstallmentNumber_"+c.installmentNumber);d.html(c.outstandingPrincipal);b.html(c.principal);f.html(c.interestAmount);a.html(c.installmentAmount);g.showElement(this.getDOMElement("repaymentScheduleInstallmentNumber_"+c.installmentNumber))},updateAndShowRepaymentScheduleTable:function(c,d){for(var b=0;b<d;++b)this.updateRepaymentScheduleRow(c[b])},updateLoanAndRepaymentDetails:function(c,d){var b=this.getDOMElement("loanAmount"),f=this.getDOMElement("interestAmount"),
a=this.getDOMElement("totalCost"),g=this.getDOMElement("interestPercentage"),e=this.getDOMElement("tenure"),k=this.getDOMElement("numberOfInstallments"),m=this.getDOMElement("monthlyInstallmentAmount");b.html(this.getFormattedAmount(c.loanAmount));f.html(this.getTotalInterestDisplayString(c.interestAmount,c.emiDiscount,d));a.html(this.getFormattedAmount(c.totalCost));g.html(this.getInterestRateDisplayString(c.interestRate,c.emiDiscount,d));e.html(this.getTenureDisplayString(d));k.html(d.toString());
m.html(this.getFormattedAmount(c.monthlyPayableAmount))},bindToEvents:function(){var c=this;c.widget.on("updateKfsInfo",c,function(c){if(c.instrumentId===this.currentInstrumentId){c=c.installmentPlanId;var b=this.getEligibleInstallmentPlanDataSequence();c=this.getSelectedInstallmentPlanData(b,c);var b=this.getInstallmentsTotals(c),d=b.interestRate/1200;this.updateLoanAndRepaymentDetails(b,c.numberOfInstallments);this.hideRepaymentScheduleContent();b=this.getRepaymentScheduleTable(b.loanAmount,c.numberOfInstallments,
d,b.monthlyPayableAmount);this.updateAndShowRepaymentScheduleTable(b,c.numberOfInstallments)}});c.widget.on("installmentPlanChanged",this,function(d){c.widget.trigger("updateKfsInfo",{instrumentId:d.instrumentId,installmentPlanId:d.installmentPlanId})});c.getDOMElement("keyFactsLink").click(function(){c.widget.publishSuccessSushiMetrics({ActionValue:"KeyFactsLinkClicked",ActionValueType:"Click"})})}})})})()});
/* ******** */
(function(p){var m=window.AmazonUIPageJS||window.P,n=m._namespace||m.attributeErrors,g=n?n("APXWidgetsAssets@APXWidgets-KYCInfoCollection","APXWidgetsAssets"):m;g.guardFatal?g.guardFatal(p)(g,window):g.execute(function(){p(g,window)})})(function(p,m,n){(function(){var g=PaymentsPortal2.modules.define;g("components/KYCInfoCollectionFormComponent","form-component lang events/form-submitted-event jQuery AUI!P css-utils validation-functions".split(" "),function(g,m,p,d,q,n,b){return g.extend({$submitButton:null,
_formValidationStartEvent:null,_isDynamicRFIWeblabEnabled:null,_requiredArtifacts:null,_isAddressRequired:null,_isDateOfBirthRequired:null,initialize:function(c,a){this._isDynamicRFIWeblabEnabled=a.data.isDynamicRFIWeblabEnabled;this._requiredArtifacts=a.data.requiredArtifacts;this._isAddressRequired=0==this._requiredArtifacts.length||this._requiredArtifacts.includes("Address");this._isDateOfBirthRequired=0==this._requiredArtifacts.length||this._requiredArtifacts.includes("Date");this._createConditionalValidationFunction(a.data);
this._formValidationStartEvent=!this._isDynamicRFIWeblabEnabled||this._isAddressRequired?"AddressValidationSuccess":"KYCFormSubmitStarted"},bindToElements:function(){var c=this;c._isDynamicRFIWeblabEnabled&&!c._isDateOfBirthRequired||c._setupDateOfBirthInput();var a=c.getDOMElement("pmts-info-collection-submit-button");a.click(function(a){a.preventDefault();c.$submitButton.isEnabled()&&c.widget.trigger("KYCFormSubmitStarted")});q.when("a-button").execute(function(h){c.$submitButton=h(a)});this.widget.on("AddressValidationFailed",
this,function(){c.form.validateForm()});this.widget.on(c._formValidationStartEvent,c,function(a){var k={},b=c.form.getFormValues();if(0==c.form.validateForm().length){if(!c._isDynamicRFIWeblabEnabled||0==c._requiredArtifacts.length||c._requiredArtifacts.includes("Date")){var e=b.dateOfBirth.split("/");k.dobDay=e[0];k.dobMonth=e[1];k.dobYear=e[2]}k.firstName=b.firstName;k.middleName=b.middleName||"";k.lastName=b.lastName;k.nationality=b.nationality;this._submitKYCInformation(c,a,k)}})},_setupDateOfBirthInput:function(){var c=
this.getDOMElement("pmts-info-collection-date-of-birth-input");c.bind("input",function(a){if("deleteContentBackward"!==a.originalEvent.inputType){var h=c.val().replace(/[^0-9]/g,""),k=h.length,b=h.substring(0,2);2<k&&(b+="/"+h.substring(2,4));4<k&&(b+="/"+h.substring(4,8));h=b.length;if(2===h||5===h)b+="/";c.val(b);a.stopPropagation()}})},_closePopoverIfPsp:function(){var c=this;q.when("a-modal").execute(function(a){c._closePspPopover(a)});q.when("a-secondary-view").execute(function(a){c._closePspPopover(a)})},
_closePspPopover:function(c){(c=c.get("pmts-gc-kyc-info-collection-popover"))&&c.hide()},_submitKYCInformation:function(c,a,h){c.$submitButton.disable();c.widget.trigger("submitFormAjaxStarted");var b={"ppw-firstName":"","ppw-middleName":"","ppw-lastName":"","ppw-nationality":"","ppw-dobDay":"","ppw-dobMonth":"","ppw-dobYear":"","ppw-addressLine1":"","ppw-addressLine2":"","ppw-addressLine3":"","ppw-city":"","ppw-state":"","ppw-postalCode":"","ppw-countryCode":"","ppw-widgetState":c.widget.options.serializedState,
"ppw-widgetEvent":"SubmitKYCBasicInfoEvent"};c._isDynamicRFIWeblabEnabled&&c._requiredArtifacts.length?(c._requiredArtifacts.includes("FullName")&&(b=d.extend({},b,{"ppw-firstName":h.firstName,"ppw-middleName":h.middleName,"ppw-lastName":h.lastName})),c._isAddressRequired&&(b=d.extend({},b,{"ppw-addressLine1":a.addressLine1,"ppw-addressLine2":a.addressLine2,"ppw-addressLine3":a.addressLine3,"ppw-city":a.city,"ppw-state":a.state,"ppw-postalCode":a.postalCode,"ppw-countryCode":a.countryCode})),c._requiredArtifacts.includes("Country")&&
(b=d.extend({},b,{"ppw-nationality":h.nationality})),c._isDateOfBirthRequired&&(b=d.extend({},b,{"ppw-dobDay":h.dobDay,"ppw-dobMonth":h.dobMonth,"ppw-dobYear":h.dobYear}))):b={"ppw-firstName":h.firstName,"ppw-middleName":h.middleName,"ppw-lastName":h.lastName,"ppw-nationality":h.nationality,"ppw-dobDay":h.dobDay,"ppw-dobMonth":h.dobMonth,"ppw-dobYear":h.dobYear,"ppw-addressLine1":a.addressLine1,"ppw-addressLine2":a.addressLine2,"ppw-addressLine3":a.addressLine3,"ppw-city":a.city,"ppw-state":a.state,
"ppw-postalCode":a.postalCode,"ppw-countryCode":a.countryCode,"ppw-widgetState":c.widget.options.serializedState,"ppw-widgetEvent":"SubmitKYCBasicInfoEvent"};c.widget.continueRequest(b,{success:c.widget.createAjaxContinueSuccessHandler(),error:function(a){},complete:function(){c._closePopoverIfPsp();c.$submitButton.enable();c.widget.trigger("submitFormAjaxCompleted")},queryParameters:{sif_profile:"KYC_CAMS_PROFILE"}})},_createConditionalValidationFunction:function(c){b.KYCValidDateConstraint=function(a,
h,k,f){if(!b.RequiredValidDateConstraint(a,h,k,f))return!1;k=h[k.defaultParameterName].split(f.separator);a=parseInt(k[0],10);h=parseInt(k[1],10)-1;k=parseInt(k[2],10);f=new Date;f=new Date(f.getFullYear()-c.minimumAgeOfAdult,f.getMonth(),f.getDate());a=new Date(k,h,a);return k>=c.minimumValidDateOfBirthYear&&a<=f}}})});g("components/KYCAddressComponent",["form-component","lang","jQuery","AUI!P","css-utils"],function(g,m,p,d,q){var n="AT BE DE FR PL SE".split(" ");return g.extend({selectedAddress:null,
selectedAddressId:null,addressNotSelectedAlert:null,stateFormField:null,stateFormFieldInput:null,accordionState:"Saved",initialize:function(b,c){this._formSubmitEvent=c.data.formSubmitEvent;this._savedAddressesMap=c.data.savedAddressesMap},_savedAddressesAccordionSelected:function(b){return function(){b.accordionState="Saved"}},_newAddressAccordionSelected:function(b){return function(){b.accordionState="New";b.addressNotSelectedAlert.hide()}},_initializeAccordionJs:function(){var b=this;d.when("A",
"a-alert").execute(function(c,a){c.on("a:accordion:provide-address-accordion:use-saved-address-accordion-row:select",b._savedAddressesAccordionSelected(b));c.on("a:accordion:provide-address-accordion:add-new-address-accordion-row:select",b._newAddressAccordionSelected(b));b.addressNotSelectedAlert=a(".kyc-address-no-input-alert")})},_initializeCountryDropdownJs:function(){var b=this;d.when("A").execute(function(c){c.on("a:dropdown:add-new-address-country-dropdown-native-id:select",function(a){b._updateStateFieldOnCountrySelection(a.value)});
b.stateFormField=c.$("#state")});b.stateFormFieldInput=b.form.getAUITagHelperForParameter("state")},_updateStateFieldOnCountrySelection:function(b){n.includes(b)?(this.stateFormField.hide(),this.stateFormFieldInput.val("")):this.stateFormField.show()},_validateUserInputAndDisplay:function(b){var c=!1;"New"===b.accordionState?c=0!=b.form.validateForm().length:null===b.selectedAddress&&(c=!0,b.addressNotSelectedAlert.show());return c},bindToEvents:function(){var b=this;b._initializeAccordionJs();b._initializeCountryDropdownJs();
b.getDOMElementsByPrefix("savedAddressCarouselBox-").click(m.bind(b.savedAddressCarouselEventHandler,b));b.widget.on(b._formSubmitEvent,b,function(){if(b._validateUserInputAndDisplay(b))b.widget.trigger("AddressValidationFailed");else{var c={},a=b.form.fields.addressLine1,h=b.form.fields.addressLine2,k=b.form.fields.addressLine3,f=b.form.fields.city,e=b.form.fields.state,d=b.form.fields.postalCode,r=b.form.fields.countryCode;if("New"===b.accordionState){var g=b.form.getFormValues(),m=g[h.defaultParameterName],
l=g[k.defaultParameterName],p=g[f.defaultParameterName],n=g[e.defaultParameterName],q=g[d.defaultParameterName],t=g[r.defaultParameterName];c[a.defaultParameterName]=g[a.defaultParameterName];c[h.defaultParameterName]=m||"";c[k.defaultParameterName]=l||"";c[f.defaultParameterName]=p;c[e.defaultParameterName]=n||"";c[d.defaultParameterName]=q;c[r.defaultParameterName]=t}else c[a.defaultParameterName]=b.selectedAddress.addressLine1||"",c[h.defaultParameterName]=b.selectedAddress.addressLine2||"",c[k.defaultParameterName]=
b.selectedAddress.addressLine3||"",c[f.defaultParameterName]=b.selectedAddress.city,c[e.defaultParameterName]=b.selectedAddress.stateOrRegion||"",c[d.defaultParameterName]=b.selectedAddress.postalCode,c[r.defaultParameterName]=b.selectedAddress.countryCode;b.widget.trigger("AddressValidationSuccess",c)}})},savedAddressCarouselEventHandler:function(b){b=p(b.currentTarget);var c=this.selectedAddressId;c!==b.data("addressid").toString()&&(null!=c&&this._toggleCarouselCardSelection(this.getDOMElement("savedAddressCarouselBox-"+
c),!1),this.addressNotSelectedAlert.hide(),this._toggleCarouselCardSelection(b,!0),this.selectedAddressId=b.data("addressid").toString(),this.selectedAddress=this._savedAddressesMap[this.selectedAddressId])},_toggleCarouselCardSelection:function(b,c){c?b.removeClass("saved-address-carousel-not-selected-card").addClass("saved-address-carousel-selected-card"):b.removeClass("saved-address-carousel-selected-card").addClass("saved-address-carousel-not-selected-card")}})});g("components/KYCDocUploadFormComponent",
"form-component lang events/form-submitted-event jQuery AUI!P css-utils clog".split(" "),function(g,m,p,d,n,u,b){var c=["image/png","image/pjpeg","image/jpeg","image/tiff","application/pdf"];return g.extend({$submitButton:null,$POIDropdown:null,$POIDropdownValidationText:null,$POIFrontFilePicker:null,$POIFrontLabel:null,$POIFrontButton:null,$POIFrontFileValidationText:null,$POIBackFilePicker:null,$POIBackLabel:null,$POIBackButton:null,$POIBackFileValidationText:null,$POADropdown:null,$POADropdownValidationText:null,
$POAFilePicker:null,$POALabel:null,$POAButton:null,$POAFileValidationText:null,$charEncodingHiddenInput:null,$sessionIdHiddenInput:null,$destinationHiddenInput:null,$docDispositionHiddenInput:null,$mandatoryFieldsDocDispositionHiddenInput:null,$signatureHiddenInput:null,$mandatoryFieldsSignatureHiddenInput:null,initialize:function(a,b){this._docTypeToIdMap=b.data.docKindToIdMap},bindToElements:function(){var a=this;a.$charEncodingHiddenInput=a.getDOMElement("pmts-doc-upload-char-encoding-hidden-input");
a.$sessionIdHiddenInput=a.getDOMElement("pmts-doc-upload-session-id-hidden-input");a.$destinationHiddenInput=a.getDOMElement("pmts-doc-upload-destination-hidden-input");a.$docDispositionHiddenInput=a.getDOMElement("pmts-doc-upload-doc-disposition-hidden-input");a.$mandatoryFieldsDocDispositionHiddenInput=a.getDOMElement("pmts-doc-upload-mandatory-fields-doc-disposition-hidden-input");a.$signatureHiddenInput=a.getDOMElement("pmts-doc-upload-signature-hidden-input");a.$mandatoryFieldsSignatureHiddenInput=
a.getDOMElement("pmts-doc-upload-mandatory-fields-signature-hidden-input");a.$POIDropdown=a.getDOMElement("pmts-doc-upload-poi-dropdown");a.$POIDropdownValidationText=a.getDOMElement("pmts-doc-upload-poi-dropdown-validation-text");a.$POIDropdownValidationText.hide();d(a.$POIDropdown).change(function(){a.$POIDropdownValidationText.hide()});a.$POADropdown=a.getDOMElement("pmts-doc-upload-poa-dropdown");a.$POADropdownValidationText=a.getDOMElement("pmts-doc-upload-poa-dropdown-validation-text");a.$POADropdownValidationText.hide();
d(a.$POADropdown).change(function(){a.$POADropdownValidationText.hide()});var b=a.getDOMElement("pmts-doc-upload-poi-front-file-picker");a.$POIFrontFilePicker=b.first()[0];a.$POIFrontLabel=a.getDOMElement("pmts-doc-upload-poi-front-label-description");a.$POIFrontButton=a.getDOMElement("pmts-doc-upload-poi-front-button");a.$POIFrontFileValidationText=a.getDOMElement("pmts-doc-upload-poi-front-validation-text");a.$POIFrontFileValidationText.hide();null!=a.$POIFrontFilePicker&&(d(a.$POIFrontFilePicker).change(function(){a._isInvalidFileSize(b)||
a._isInvalidFileType(b)?(a.$POIFrontFileValidationText.show(),a.$POIFrontFilePicker.value=""):(a._updateFilePickerState(a.$POIFrontFilePicker,a.$POIFrontLabel,a.$POIFrontButton,"apx_kyc_info_collection_document_label_proof_of_identity_frontside_notes"),a._onFileChanged())}),a.$POIFrontButton.click(function(){a.$POIFrontFileValidationText.hide();""==a.$POIFrontFilePicker.value?a.$POIFrontFilePicker.click():a._removeSelectedFile(a.$POIFrontFilePicker,a.$POIFrontLabel,a.$POIFrontButton,"apx_kyc_info_collection_document_label_proof_of_identity_frontside_notes")}));
var c=a.getDOMElement("pmts-doc-upload-poi-back-file-picker");a.$POIBackFilePicker=c.first()[0];a.$POIBackLabel=a.getDOMElement("pmts-doc-upload-poi-back-label-description");a.$POIBackButton=a.getDOMElement("pmts-doc-upload-poi-back-button");a.$POIBackFileValidationText=a.getDOMElement("pmts-doc-upload-poi-back-validation-text");a.$POIBackFileValidationText.hide();null!=a.$POIBackFilePicker&&(d(a.$POIBackFilePicker).change(function(){a._isInvalidFileSize(c)||a._isInvalidFileType(c)?(a.$POIBackFileValidationText.show(),
a.$POIBackFilePicker.value=""):a._updateFilePickerState(a.$POIBackFilePicker,a.$POIBackLabel,a.$POIBackButton,"apx_kyc_info_collection_document_label_proof_of_identity_backside_notes")}),a.$POIBackButton.click(function(){a.$POIBackFileValidationText.hide();""==a.$POIBackFilePicker.value?a.$POIBackFilePicker.click():a._removeSelectedFile(a.$POIBackFilePicker,a.$POIBackLabel,a.$POIBackButton,"apx_kyc_info_collection_document_label_proof_of_identity_backside_notes")}));var f=a.getDOMElement("pmts-doc-upload-poa-file-picker");
a.$POAFilePicker=f.first()[0];a.$POALabel=a.getDOMElement("pmts-doc-upload-poa-label-description");a.$POAButton=a.getDOMElement("pmts-doc-upload-poa-button");a.$POAFileValidationText=a.getDOMElement("pmts-doc-upload-poa-validation-text");a.$POAFileValidationText.hide();null!=a.$POAFilePicker&&(d(a.$POAFilePicker).change(function(){a._isInvalidFileSize(f)||a._isInvalidFileType(f)?(a.$POAFileValidationText.show(),a.$POAFilePicker.value=""):(a._updateFilePickerState(a.$POAFilePicker,a.$POALabel,a.$POAButton,
"apx_kyc_info_collection_document_label_proof_of_address_upload_notes"),a._onFileChanged())}),a.$POAButton.click(function(){a.$POAFileValidationText.hide();""==a.$POAFilePicker.value?a.$POAFilePicker.click():a._removeSelectedFile(a.$POAFilePicker,a.$POALabel,a.$POAButton,"apx_kyc_info_collection_document_label_proof_of_address_upload_notes")}));var e=a.getDOMElement("pmts-doc-upload-submit-button");n.when("a-button").execute(function(b){a.$submitButton=b(e)});e.click(function(e){e.preventDefault();
if(a.$submitButton.isEnabled()&&a._validateDropdowns()){var d,g,m;e=null!=c[0]&&null!=c[0].files[0];var l=new FormData;l.append(a.$charEncodingHiddenInput.attr("name"),a.$charEncodingHiddenInput.val());l.append(a.$sessionIdHiddenInput.attr("name"),a.$sessionIdHiddenInput.val());l.append(a.$destinationHiddenInput.attr("name"),a.$destinationHiddenInput.val());e?(l.append(a.$docDispositionHiddenInput.attr("name"),a.$docDispositionHiddenInput.val()),l.append(a.$signatureHiddenInput.attr("name"),a.$signatureHiddenInput.val())):
(l.append(a.$docDispositionHiddenInput.attr("name"),a.$mandatoryFieldsDocDispositionHiddenInput.val()),l.append(a.$signatureHiddenInput.attr("name"),a.$mandatoryFieldsSignatureHiddenInput.val()));null!=b[0]&&(l.append(b.attr("name"),b[0].files[0]),d=b.attr("name"));e&&(l.append(c.attr("name"),c[0].files[0]),g=c.attr("name"));null!=f[0]&&(l.append(f.attr("name"),f[0].files[0]),m=f.attr("name"));a._submitKYCInfo(l,d,g,m)}})},_validateDropdowns:function(){var a=!0;null==this.$POIDropdown[0]||this.$POIDropdown[0].value||
(this.$POIDropdownValidationText.show(),a=!1);null==this.$POADropdown[0]||this.$POADropdown[0].value||(this.$POADropdownValidationText.show(),a=!1);return a},_isInvalidFileSize:function(a){return 15E6<a[0].files[0].size},_isInvalidFileType:function(a){return-1==d.inArray(a[0].files[0].type,c)},_removeSelectedFile:function(a,b,c,f){a.value="";this._updateFilePickerState(a,b,c,f);this._onFileChanged()},_updateFilePickerState:function(a,b,c,f){""==a.value?(d(b).html(this.widget.getLocalizedString(f)),
d(c).find("button").html(this.widget.getLocalizedString("apx_kyc_info_collection_document_button_add"))):(a=a.value.replace(/.*[\/\\]/,""),d(b).html(a),d(c).find("button").html(this.widget.getLocalizedString("apx_kyc_info_collection_document_button_remove")))},_onFileChanged:function(){var a=null==this.$POAFilePicker||""!=this.$POAFilePicker.value;null!=this.$POIFrontFilePicker&&""==this.$POIFrontFilePicker.value||!a?this.$submitButton.disable():this.$submitButton.enable()},_submitKYCInfo:function(a,
c,k,f){var e=this;e.widget.trigger("submitFormAjaxStarted");var g=b.getCurrentTime();d.ajax({type:"POST",enctype:"multipart/form-data",url:"/v2/documents/upload/",data:a,processData:!1,contentType:!1,cache:!1,success:function(a){e._publishDocUploadLatencyMetrics(g);var b={},d={};try{e._parseAlexandriaResponse(a,b,d,c,k,f),e._publishDocUploadSuccessMetrics(),e._continueWidget(b,d)}catch(l){e.widget.trigger("submitFormAjaxCompleted"),e._triggerWidgetDoneWithError()}},error:function(a){e._publishDocUploadFailureMetrics("UploadCallFailed",
"FAILED_UPLOAD");e.widget.trigger("submitFormAjaxCompleted");e._triggerWidgetDoneWithError()}})},_triggerWidgetDoneWithError:function(){this.widget.trigger("Done",{widgetDone:"true",WidgetResponseStatusCode:"500"})},_publishDocUploadSuccessMetrics:function(){b.logCounterMetric({feature:"KYCAlexandriaDocUpload",resource:"_SuccessCount"});this.widget.publishSuccessSushiMetrics({ActionType:"KYCAlexandriaDocUpload",ActionValueType:"UploadStatusCode",ActionValue:"UploadSuccess"})},_publishDocUploadFailureMetrics:function(a,
c){b.logCounterMetric({feature:"KYCAlexandriaDocUpload",resource:"_ErrorCount"});this.widget.publishFailureSushiMetrics({ActionType:"KYCAlexandriaDocUpload",ActionValueType:"UploadStatusCode",ActionValue:a,ActionErrorCode:c})},_publishDocUploadLatencyMetrics:function(a){b.logLatencyMetric({feature:"KYCAlexandriaDocUpload",resource:"_Latency",startTime:a})},_parseAlexandriaResponse:function(a,b,c,f,e,d){a=(new DOMParser).parseFromString(a,"text/html").getElementsByTagName("input")[0];if("uploadResponse"!=
a.getAttribute("name"))throw this._publishDocUploadFailureMetrics("MissingUploadResponse","MISSING_RESPONSE"),Error("Missing 'uploadResponse' input tag in Alexandria response");this._parseAlexandriaJsonResponse(a.getAttribute("value"),b,c,f,e,d)},_parseAlexandriaJsonResponse:function(a,b,c,f,e,d){a=JSON.parse(a);if("REQUEST_SUCCEEDED"==a.type){if(!this._isValidAlexandriaUploadResponse(a,f,e,d))throw this._publishDocUploadFailureMetrics("InvalidUploadResponse","INVALID_RESPONSE"),Error("Invalid Alexandria response.");
var g=a.content.documentUploadResponseList[d];if(null!=g)if("SUCCESSFUL"==g.status)c.docId=g.content.documentId,c.contentLength=g.content.contentLength,c.documentFieldName=d;else throw this._publishDocUploadFailureMetrics("POAFileUploadFailed",g.status),Error("POA file upload failed");c=a.content.documentUploadResponseList[e];if(null!=c)if("SUCCESSFUL"==c.status)b.backSideDocId=c.content.documentId,b.backSideContentLength=c.content.contentLength,b.backSideDocumentFieldName=e;else throw this._publishDocUploadFailureMetrics("POIBackSideFileUploadFailed",
c.status),Error("POI backside file upload failed");e=a.content.documentUploadResponseList[f];if(null!=e)if("SUCCESSFUL"==e.status)b.frontSideDocId=e.content.documentId,b.frontSideContentLength=e.content.contentLength,b.frontSideDocumentFieldName=f;else throw this._publishDocUploadFailureMetrics("POIFrontSideFileUploadFailed",e.status),Error("POI frontside file upload failed");}else throw this._publishDocUploadFailureMetrics("UploadRequestFailed","FAILED_REQUEST"),Error("Upload request failed");},
_isValidAlexandriaUploadResponse:function(a,b,c,d){return this._isValidResponseForFileField(a,b)&&this._isValidResponseForFileField(a,c)&&this._isValidResponseForFileField(a,d)},_isValidResponseForFileField:function(a,b){return null!=b&&null==a.content.documentUploadResponseList[b]?!1:!0},_continueWidget:function(a,b){var c=this;c.widget.continueRequest(c._buildContinueWidgetParams({"ppw-poiDocumentFieldName":"","ppw-poiAlexandriaDocumentId":"","ppw-poiDocumentKind":"","ppw-poiArtifactId":"","ppw-poiContentLength":"0",
"ppw-poiDocumentFieldNameBackside":"","ppw-poiAlexandriaDocumentIdBackside":"","ppw-poiContentLengthBackside":"0","ppw-poaDocumentFieldName":"","ppw-poaAlexandriaDocumentId":"","ppw-poaDocumentKind":"","ppw-poaArtifactId":"","ppw-poaContentLength":"0","ppw-widgetState":c.widget.options.serializedState,"ppw-widgetEvent":"SubmitKYCDocUploadEvent"},a,b),{success:c.widget.createAjaxContinueSuccessHandler(),error:function(a){},complete:function(){c.widget.trigger("submitFormAjaxCompleted")},queryParameters:{sif_profile:"KYC_CAMS_PROFILE"}})},
_buildContinueWidgetParams:function(a,b,c){if(null!=b){if(b.hasOwnProperty("frontSideDocumentFieldName")&&b.hasOwnProperty("frontSideDocId")&&b.hasOwnProperty("frontSideContentLength")){var f=this.$POIDropdown[0].value;a=d.extend({},a,{"ppw-poiDocumentFieldName":b.frontSideDocumentFieldName,"ppw-poiAlexandriaDocumentId":b.frontSideDocId,"ppw-poiDocumentKind":f,"ppw-poiArtifactId":this._docTypeToIdMap[f],"ppw-poiContentLength":b.frontSideContentLength})}b.hasOwnProperty("backSideDocumentFieldName")&&
b.hasOwnProperty("backSideDocId")&&b.hasOwnProperty("backSideContentLength")&&(a=d.extend({},a,{"ppw-poiDocumentFieldNameBackside":b.backSideDocumentFieldName,"ppw-poiAlexandriaDocumentIdBackside":b.backSideDocId,"ppw-poiContentLengthBackside":b.backSideContentLength}))}null!=c&&c.hasOwnProperty("documentFieldName")&&c.hasOwnProperty("docId")&&c.hasOwnProperty("contentLength")&&(b=this.$POADropdown[0].value,a=d.extend({},a,{"ppw-poaDocumentFieldName":c.documentFieldName,"ppw-poaAlexandriaDocumentId":c.docId,
"ppw-poaDocumentKind":b,"ppw-poaArtifactId":this._docTypeToIdMap[b],"ppw-poaContentLength":c.contentLength}));return a}})})})()});
/* ******** */
(function(d){var b=window.AmazonUIPageJS||window.P,e=b._namespace||b.attributeErrors,a=e?e("APXWidgetsAssets@APXWidgets-BLIK","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(d)(a,window):a.execute(function(){d(a,window)})})(function(d,b,e){(function(){var a=PaymentsPortal2.modules.define;a("components/AddBlikComponent",["events/form-submitted-event","jQuery","form-component","lang","AUI!P"],function(a,b,f,d,e){return f.extend({_hasErrors:!1,initialize:function(c,a){this._action=a.data.action;this._hasErrors=
a.data.hasErrors},_initPopoverState:function(){"true"===this._hasErrors&&this.getDOMElement("addBlikPopoverLink").trigger("click")},bindToElements:function(){this.getDOMElement("addBlikSubmitButton").click(d.bind(this._handleFormSubmission,this))},bindToEvents:function(){var c=this;c.widget.on("componentsInitialized",c,function(a){this._initPopoverState()});c.widget.on(a,c,function(a){a.action===c._action&&b(c.getDOMElement("addBlikForm")).submit()})},_handleFormSubmission:function(c){var b=this.form.validateForm(),
d=this.getFormSubmissionParameters("addBlikFormContainer");0===b.length?(this.widget.trigger(a,{event:c,submissionParameters:d,action:this._action}),this.closeAddBlikPopover()):c.preventDefault()},closeAddBlikPopover:function(){e.when("a-modal").execute(function(a){a&&(a=a.get("addBlikPopover"))&&a.hide()})}})});a("components/SelectableBlikListComponent",["form-component"],function(a){return a});a("components/SelectableBlikListItemComponent",["events/InstrumentRowSelectedEvent","components/POAInstrumentListItemComponent"],
function(a,b){return b.extend({bindToEvents:function(){var b=this;b.widget.on(a,b,function(a){b._instrumentRowSelected(a.instrumentId)})}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-Maple","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/IRSComponent",["component","metrics-helper"],function(a,b){return a.extend({bindToElements:function(){b.publishOnClickSuccessSushiMetrics(this,[{JsBindElementId:"maple-advertisement",MetricsObject:{ActionType:"IRSAdvertisement"}}])}})})})()});
/* ******** */
(function(f){var g=window.AmazonUIPageJS||window.P,h=g._namespace||g.attributeErrors,c=h?h("APXWidgetsAssets@APXWidgets-Bizum","APXWidgetsAssets"):g;c.guardFatal?c.guardFatal(f)(c,window):c.execute(function(){f(c,window)})})(function(f,g,h){(function(){var c=PaymentsPortal2.modules.define;c("components/AddBizumComponent","events/form-submitted-event jQuery form-component lang AUI!P clog mini-browser-helper".split(" "),function(c,d,k,e,f,h,l){var m={width:600,height:800};return k.extend({_hasErrors:!1,
_showPrimaryMobileNumber:!1,initialize:function(a,b){this._action=b.data.action;this._hasErrors=b.data.hasErrors;this._interstitialPageUrl=b.data.interstitialPageUrl;this._isMiniBrowserEnabled=b.data.isMiniBrowserEnabled;this._widgetAction=b.data.action;this._instrumentId=b.data.instrumentId;this._showPrimaryMobileNumber=b.data.showPrimaryMobileNumber;this._device=a.options.deviceType;this._isRequestForMobileApp=b.data.isRequestForMobileApp},bindToElements:function(){var a=this;this.getDOMElement("apx-add-bizum-cancel-button").click(e.bind(this._closeAddBizumDesktopPopover,
this));this.getDOMElement("apx-add-bizum-continue-button").click(e.bind(this._handleFormSubmission,this));this.getDOMElement("apx-add-bizum-button").click(e.bind(this._handleAddBizumAccountButtonClick,this));this.getDOMElement("apx-add-bizum-phone-number-input").keydown(e.bind(this._resetFormError,this));this.getDOMElement("apx-add-bizum-phone-number-input").focus(e.bind(this._handleFocusEvent,this));f.when("A","a-modal").execute(function(b){b.off("a:popover:afterHide:apx-add-bizum-popover-desktop");
b.on("a:popover:afterHide:apx-add-bizum-popover-desktop",function(b){a._logClogCounterMetric("addBizumPopoverHidden",["Bizum"])})})},bindToEvents:function(){var a=this;a.widget.on("componentsInitialized",a,function(){a._initPopoverState();a._interstitialPageUrl&&a._isMiniBrowserEnabled&&"interstitial-page-authentication"===a._widgetAction?a._openBizumMiniBrowserWindow(a._interstitialPageUrl):a._interstitialPageUrl&&!a._isMiniBrowserEnabled&&(g.location.href=a._interstitialPageUrl)});a.widget.on(c,
a,function(b){b.action===a._action&&d(a.getDOMElement("apx-add-bizum-form")).submit()})},_handleFocusEvent:function(){d("#apx-add-bizum-link-new-phone-number").prop("checked",!0).trigger("click")},_initPopoverState:function(){!0===this._hasErrors&&(d("#apx-add-bizum-alert-container-tag-id").addClass("apx-bizum-remove-alert-container-bullet-point"),this.getDOMElement("apx-add-bizum-button").trigger("click"));this._initFormState()},_resetFormError:function(){var a=d("#apx-add-bizum-inline-alert-container-tag-id"),
b=this.getDOMElement("apx-add-bizum-phone-number-input");a.addClass("a-hidden aok-hidden");b.removeClass("apx-bizum-input-phone-number-error-box-border")},_hideUpperAlertContainer:function(){d("#apx-add-bizum-alert-container-tag-id").addClass("a-hidden aok-hidden")},_handleDisplayInlineErrorContainer:function(){this._hideUpperAlertContainer();var a=d("#apx-add-bizum-inline-alert-container-tag-id"),b=this.getDOMElement("apx-add-bizum-phone-number-input");a.removeClass("a-hidden aok-hidden");a.children().removeClass("a-hidden aok-hidden");
b.addClass("apx-bizum-input-phone-number-error-box-border")},_handleFormSubmission:function(a){var b=this.getDOMElement("apx-add-bizum-hidden-form-field"),e=d("#apx-add-bizum-link-saved-phone-number");if(this._showPrimaryMobileNumber&&e.is(":checked"))b.val(e.val());else{var e=d("select[name\x3dppw-bizumCountryCode] option").filter(":selected").val(),f=this.getDOMElement("apx-add-bizum-phone-number-input").val();b.val(e+f)}0===this.form.validateForm().length?(b=this.getFormSubmissionParameters("apx-add-bizum-form",
"apx-add-bizum-continue-button"),e=this.getDOMElement("apx-add-bizum-form").find("form").andSelf().filter("form"),this.widget.trigger(c,{event:a,submissionParameters:b,formElement:e,action:this._action}),this._closePopover()):(this._handleDisplayInlineErrorContainer(),a.preventDefault());this._logClogCounterMetric("continueToAuthNClicked",["Bizum",this._getDeviceType()])},_openBizumMiniBrowserWindow:function(a){this._bizum_window=l.openInMiniBrowser(a,"apx-add-bizum-mini-window",m);this._bizum_window.focus();
this._monitorBizumMinibrowserWindow()},_monitorBizumMinibrowserWindow:function(){g.clearTimeout(this._bizum_window_timer);!this._bizum_window||this._bizum_window.closed?(this._closeAddBizumDesktopPopover(),this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"AddPaymentMethodRefreshEvent","ppw-paymentMethodId":this._instrumentId,"ppw-widgetAction":this._widgetAction})):this._bizum_window_timer=setTimeout(this._monitorBizumMinibrowserWindow.bind(this),
100)},_initFormState:function(){d("apx-add-bizum-phone-number-input").length&&(d("apx-add-bizum-phone-number-input").val(""),d("#apx-add-bizum-link-saved-phone-number").prop("checked",!0).trigger("click"))},_logClogCounterMetric:function(a,b){b=b&&b.filter(Boolean).join(".");h.logCounterMetric({feature:b+"."+a,resource:"_Count"});h.publishMetrics()},_handleAddBizumAccountButtonClick:function(){this._logClogCounterMetric("AddBizumBtnClicked",["Bizum",this._getDeviceType()])},_getDeviceType:function(){return this._isRequestForMobileApp?
"mobileapp":this._device},_hidePopoverModal:function(a){a&&a.hide()},_closeAddBizumDesktopPopover:function(){var a=this;a._resetFormError();f.when("a-modal").execute(function(b){b&&a._hidePopoverModal(b.get("apx-add-bizum-popover-desktop"))})},_closeAddBizumMobilePopover:function(){var a=this;a._resetFormError();f.when("a-secondary-view").execute(function(b){b&&a._hidePopoverModal(b.get("apx-add-bizum-popover-mobile"))})},_closePopover:function(){"mobile"===this._device?this._closeAddBizumMobilePopover():
this._closeAddBizumDesktopPopover()}})});c("components/SelectableBizumListComponent",["form-component"],function(c){return c});c("components/SelectableBizumListItemComponent",["components/SelectableDPMInstrumentListItemComponent"],function(c){return c});c("components/BizumDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport"],function(c,d){return c.extend(d,{initialize:function(c,d){this._paymentMethodId=d.data.paymentMethodId;this._paymentMethodType=d.data.paymentMethodType},
bindToElements:function(){this._bindEditPMLink()}})});c("components/BizumEditComponent",["component","EditComponentSupport"],function(c,d){return c.extend(d,{initialize:function(c,e){d._initializePopover(c,e,this)},bindToEvents:function(){d._bindPopoverCloseButtonClickedEvent(this)}})});c("components/BizumSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(c,d){return c.extend(d,{initialize:function(c,d){this._instrumentId=d.data.instrumentId}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-Selection","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/SelectionComponent",["component"],function(a){return a.extent({})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-ElectronicBenefitTransfer","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/ElectronicBenefitTransferDetailsSlotComponent",["jQuery","component","PaymentMethodDetailsSlotComponentSupport","css-utils","lang"],function(a,b,c,d,e){a(document).ready(function(){a(".pmts-portal-list-item-ebt-balance-check-last-updated-time-reference").map(function(a,
b){a=(new Date(b.textContent)).toLocaleString("UTC",{timeZoneName:"short"});b.textContent=a})});return b.extend(c,{initialize:function(a,b){this._paymentMethodId=b.data.paymentMethodId;this._paymentMethodType=b.data.paymentMethodType},_bindCheckBalanceLink:function(){this.getDOMElement("pmts-portal-list-item-ebt-balance-check-link-reference").click(e.bind(this._checkBalanceLinkClicked,this))},_checkBalanceLinkClicked:function(){this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,
"ppw-widgetEvent":"ViewBalanceEvent","ppw-iid":this._paymentMethodId,"ppw-accountType":this._paymentMethodType})},bindToElements:function(){this._bindEditPMLink();this._bindCheckBalanceLink()}})});a("components/ElectronicBenefitTransferSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,b){this._instrumentId=b.data.instrumentId}})})})()});
/* ******** */
(function(d){var e=window.AmazonUIPageJS||window.P,f=e._namespace||e.attributeErrors,c=f?f("APXWidgetsAssets@APXWidgets-CreditCardInstallments","APXWidgetsAssets"):e;c.guardFatal?c.guardFatal(d)(c,window):c.execute(function(){d(c,window)})})(function(d,e,f){(function(){var c=PaymentsPortal2.modules.define;c("components/ILFCreditCardInstallmentsComponent",["form-component","jQuery","AUI!P","css-utils","lang"],function(c,e,d,f,g){return c.extend({currentInstrumentId:null,initialize:function(a,b){this.currentInstrumentId=
b.data.instrumentId;this.ilfPromptInitialText=b.data.ilfPromptInitialText;this.singlePlanSelectedString=b.data.singlePlanSelectedString;this.multiplePlansSelectedString=b.data.multiplePlansSelectedString},_confirmButtonClick:function(a){a=this.currentInstrumentId;this._refreshILFModalPopoverButtonText(a);this._closeILFModalPopover(a)},_refreshILFModalPopoverButtonText:function(a){var b=0;this.getDOMElementsByPrefix("ilfBucketDropdown-"+a).each(function(a,c){(a=c.previousSibling)&&a.options&&0<=a.selectedIndex&&
a.selectedIndex<a.options.length&&(a=a.options[a.selectedIndex].value)&&!a.endsWith("PayInFull")&&b++});a=this.getDOMElement("ilfModalPopoverButtonText-"+a);0===b?a.text(this.ilfPromptInitialText):1===b?a.text(this.singlePlanSelectedString.replace("{numberOfPlansSelected}",b.toString())):a.text(this.multiplePlansSelectedString.replace("{numberOfPlansSelected}",b.toString()))},_closeILFModalPopover:function(a){d.when("a-modal").execute(function(b){b&&(b=b.get("ilfModalPopover-"+a))&&b.hide()})},bindToEvents:function(){var a=
this,b=this.currentInstrumentId;d.when("A").execute(function(c){c.declarative("modalPopoverConfirmButton-"+b,"click",function(b){a._confirmButtonClick(b.$event)})})}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-Points","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/PointsDetailsSlotComponent",["component"],function(a){return a.extend({initialize:function(a,b){},bindToEvents:function(){this.widget.on("componentsInitialized",this,function(){})}})});a("components/PointsMetadataSlotComponent",
["component"],function(a){return a.extend({initialize:function(a,b){}})});a("components/PointsSleeveItemSlotComponent",["component"],function(a){return a.extend({_triggerFallbackToMPO:!1,initialize:function(a,b){this._triggerFallbackToMPO=b.data.triggerFallbackToMPO},bindToEvents:function(){var a=this;a.widget.on("componentsInitialized",a,function(){a._triggerFallbackToMPO&&a.widget.trigger("triggerFallbackToMPO")})}})})})()});
/* ******** */
(function(d){var b=window.AmazonUIPageJS||window.P,c=b._namespace||b.attributeErrors,a=c?c("APXWidgetsAssets@APXWidgets-WeChatPay","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(d)(a,window):a.execute(function(){d(a,window)})})(function(d,b,c){(function(){var a=PaymentsPortal2.modules.define;a("components/SelectableWeChatListComponent",["css-utils","form-component","jQuery","lang","AUI!P"],function(a,b,d,c,e){return b});a("components/SelectableWeChatListItemComponent",["components/SelectableDPMInstrumentListItemComponent",
"continuable-component","css-utils","jQuery","AUI!P"],function(a,d,c,f,e){return a.extend(d,{initialize:function(a,b){this.isAmazonApp=b.data.isAmazonApp;this.deviceUserAgent=b.data.deviceUserAgent;this.isDetectable=b.data.isDetectable;this.hideWeChatAppNotInstallmentAlert();this.isDetectable&&this.checkWeChatInstallment()},checkWeChatInstallment:function(){var a="WeChatPaymentPlugin";"IPHONE"===this.deviceUserAgent?a="WeChatPaymentPlugin":"ANDROID"===this.deviceUserAgent&&(a="MShopWeChatPayment");
e.when("mash").execute("wechat-contract-detector",function(c){b.cordova.require("cordova/exec")(function(a){a&&!1!==a.isWeChatInstalled?this.hideWeChatAppNotInstallmentAlert():this.showWeChatAppNotInstallmentAlert()},function(a){this.hideWeChatAppNotInstallmentAlert()},a,"isWeChatInstalled",[])})},showWeChatAppNotInstallmentAlert:function(){c.showElement(this.getDOMElement("weChatAppNotInstallContainer"))},hideWeChatAppNotInstallmentAlert:function(){c.hideElement(this.getDOMElement("weChatAppNotInstallContainer"))}})})})()});
/* ******** */
(function(h){var l=window.AmazonUIPageJS||window.P,m=l._namespace||l.attributeErrors,c=m?m("APXWidgetsAssets@APXWidgets-PayLaterAccount","APXWidgetsAssets"):l;c.guardFatal?c.guardFatal(h)(c,window):c.execute(function(){h(c,window)})})(function(h,l,m){(function(){var c=PaymentsPortal2.modules.define;c("components/PayLaterInstallmentOptionsComponent",["jQuery","component","lang"],function(c,e,b){return e.extend({_payLaterAccountInstrumentId:null,_externalPaymentMethodSourceId:null,initialize:function(b,
d){this._payLaterAccountInstrumentId=d.data.payLaterAccountInstrumentIdDataKey;this._externalPaymentMethodSourceId=d.data.payLaterAccountExternalPaymentMethodSourceIdDataKey;this._payLaterAccountInstrumentRowValue=d.data.payLaterAccountInstrumentRowValueDataKey;this._refreshWidgetButtonId="payLaterAccountRefreshButton-".concat(this._externalPaymentMethodSourceId)},bindToEvents:function(){this.widget.on("installmentOptionChanged",this,this.instalmentOptionChangeEventHandler);var b=this;b.getDOMElement(this._refreshWidgetButtonId).click(function(d){b._triggerRefreshWidget()})},
bindToElements:function(){},_triggerRefreshWidget:function(){this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"RefreshEvent","ppw-widgetAction":"PayLaterAccountInstallmentOptionsRefreshEvent"})},_updatePayLaterAccountSelectedHiddenInput:function(b){this.getDOMElement("payLaterAccountSelectedInstrumentIdInputJSBindId-".concat(this._externalPaymentMethodSourceId)).val(b)},instalmentOptionChangeEventHandler:function(b){b.isInstallmentOfferSelected?this._updatePayLaterAccountSelectedHiddenInput(this._payLaterAccountInstrumentRowValue):
this._updatePayLaterAccountSelectedHiddenInput("")}})});c("components/SelectableLatitudeCreatableListItemSlotComponent",["jQuery","component","lang","events/ShowAddPaymentInstrumentPage"],function(c,e,b,g){return e.extend({initialize:function(b,k){},bindToEvents:function(){},bindToElements:function(){var b=this;b.getDOMElement("paylateraccount-add-latitude-card").click(function(k){b.widget.trigger(g,{})})}})});c("components/AddPayLaterAccountComponent",["component"],function(c){return c.extend({initialize:function(e,
b){}})});c("components/PayLaterAccountDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport","jQuery"],function(c,e,b){return c.extend(e,{initialize:function(b,d){this._paymentMethodId=d.data.paymentMethodId;this._paymentMethodType=d.data.paymentMethodType;this._isDefault=d.data.isDefault},bindToElements:function(){this._bindEditPMLink()}})});c("components/PayLaterAccountEditComponent",["component","EditComponentSupport"],function(c,e){return c.extend(e,{initialize:function(b,
c){e._initializePopover(b,c,this)},bindToEvents:function(){e._bindPopoverCloseButtonClickedEvent(this)}})});c("components/SelectablePayLaterAvailableListItemComponent","events/InstrumentRowSelectedEvent components/SimplePaymentOptionListItemComponent css-utils jQuery clog mixins/disable-component".split(" "),function(c,e,b,g,d,k){return e.extend({_instrumentId:null,_popoverViewInstance:null,initialize:function(a,f){this._instrumentId=f.data.instrumentId;this._deviceType=a.options.deviceType;this._isDesktop=
"desktop"===this._deviceType;this._isMobile="mobile"===this._deviceType;this._popoverComponent=this._isDesktop?"a-modal":"a-secondary-view";this._widgetHasBeenClickedOnce=!1;this._brand=f.data.brand;this._isMultiTenderEnabled=f.data.payLaterAccountIsMultiTenderEnabled;this._giftCardUsageDisabledMessage=f.data.giftCardUsageDisabledMessage;this._isPaymentMethodDisabled=f.data.isPaymentMethodDisabled;this._initializeInstallmentsOffersPopoverView();this.setDisabled(this._isPaymentMethodDisabled,!0);this._originalPaymentMethodInfoText=
this._getOriginalPaymentLevelInfo();this._isFoodVoucherCardSelected=this._isGiftCardSelected=!1;this._isBalanceShownOutsideFinancialOfferSelection=f.data.isBalanceShownOutsideFinancialOfferSelection;this._isPopoverViewFinancialOfferSelectionContinueButtonSuppressed=f.data.isPopoverViewFinancialOfferSelectionContinueButtonSuppressed},_onPayLaterSelected:function(){this._isInstrumentSelected()||(this._onInstrumentSelected(),b.showElement(this._getOfferSectionElement()),this._getAccordionSelectedOfferIdValueAndUpdateHiddenSelectedOfferIdInput(this._getInstrumentId()),
this._isBalanceShownOutsideFinancialOfferSelection&&b.showElement(this._getBalanceTextShownOutSideFinancialOfferContainer()))},_onPayLaterDeselected:function(){this._isInstrumentSelected()&&(this._onInstrumentDeselected(),b.hideElement(this._getOfferSectionElement()),this._isBalanceShownOutsideFinancialOfferSelection&&b.hideElement(this._getBalanceTextShownOutSideFinancialOfferContainer()))},bindToEvents:function(){var a=this;a.widget.on(c,a,function(f){f.instrumentId===a._getInstrumentId()?a._onPayLaterSelected():
a._onPayLaterDeselected()});a.widget.on("optionalInstrumentSelected",a,a._optionalInstrumentSelectedHandler);a.widget.on("optionalInstrumentDeselected",a,a._optionalInstrumentDeselectedHandler);a.widget.on("FoodVoucherCardRowClickedEvent",a,function(a){a.paymentMethod="FVC";a.isSelected?this._optionalInstrumentSelectedHandler(a):this._optionalInstrumentDeselectedHandler(a)});a._getContainerElement().click(function(){if(0==a._widgetHasBeenClickedOnce){a._widgetHasBeenClickedOnce=!0;try{d.logCounterMetric({feature:"PayLaterAccountWidget.AvailableComponentClicked."+
a._deviceType+"."+a._brand,resource:"_Count"}),d.publishMetrics()}catch(f){}}})},_disablePayLaterAccount:function(){this._onPayLaterDeselected();this.setDisabled(!0,!0);this._instrumentPayLaterAccountEnableGreyOut()},_enablePayLaterAccount:function(){this.setDisabled(!1,!0);this._instrumentPayLaterAccountDisableGreyOut()},_getPaymentMethodInfoWithGC:function(){return this.getDOMElement("paymentLevelInfoContainerWithGC-"+this._getInstrumentId())},_getPaymentMethodInfoDefault:function(){return this.getDOMElement("paymentLevelInfoContainer-"+
this._getInstrumentId())},_getPaymentMethodInfoWithFVC:function(){return this.getDOMElement("paymentLevelInfoContainerWithFVC-"+this._getInstrumentId())},_getAccordionSectionWithGC:function(){return this.getDOMElement("payLaterAccountMultiOfferSection-WithGC-"+this._brand)},_getAccordionSectionWithoutGC:function(){return this.getDOMElement("payLaterAccountMultiOfferSection-default-"+this._brand)},_updatePaymentMethodLevelHiddenInput:function(a){var f=this._instrumentId.split(".").join(""),f=document.querySelector("#payLaterAccountSelectedOfferForPaymentMethod-"+
f);null!==f&&(f.value=a);this._isInstrumentSelected()&&this._getAccordionSelectedOfferIdValueAndUpdateHiddenSelectedOfferIdInput(this._getInstrumentId())},_deactivateAllPayLaterAccountSections:function(){b.hideElement(this._getPaymentMethodInfoDefault());b.hideElement(this._getPaymentMethodInfoWithGC());b.hideElement(this._getPaymentMethodInfoWithFVC());b.hideElement(this._getAccordionSectionWithoutGC());b.hideElement(this._getAccordionSectionWithGC())},_deselectInstrumentIfSelectedOfferConflict:function(){this._isInstrumentSelected()&&
this.data.recommendFinancialOfferIDWithGC!==this.data.recommendFinancialOfferIDDefault&&(this.widget.trigger(c,{}),this.widget.trigger("backingInstrumentSelected",{}))},_optionalInstrumentSelectedWithPrecalculationHandler:function(){this._isMultiTenderEnabled&&(this.data.isPaymentMethodWithGCDisabled?this._disablePayLaterAccount():this._enablePayLaterAccount(),b.showElement(this._getPaymentMethodInfoWithGC()),b.hideElement(this._getPaymentMethodInfoDefault()),b.hideElement(this._getAccordionSectionWithoutGC()),
b.showElement(this._getAccordionSectionWithGC()),this.data.isFinancialOfferAutoSwitchDisabled&&this._deselectInstrumentIfSelectedOfferConflict(),this._updatePaymentMethodLevelHiddenInput(this.data.recommendFinancialOfferIDWithGC))},_optionalInstrumentDeselectedWithPrecalculationHandler:function(){this._isMultiTenderEnabled&&(this._isPaymentMethodDisabled?this._disablePayLaterAccount():this._enablePayLaterAccount(),b.hideElement(this._getPaymentMethodInfoWithGC()),b.showElement(this._getPaymentMethodInfoDefault()),
b.showElement(this._getAccordionSectionWithoutGC()),b.hideElement(this._getAccordionSectionWithGC()),this.data.isFinancialOfferAutoSwitchDisabled&&this._deselectInstrumentIfSelectedOfferConflict(),this._updatePaymentMethodLevelHiddenInput(this.data.recommendFinancialOfferIDDefault))},_onGiftCardSelectedHandler:function(){this._isMultiTenderEnabled?this._optionalInstrumentSelectedWithPrecalculationHandler():(this._disablePayLaterAccount(),this._showGiftCardDisabledMessage())},_onGiftCardDeselectedHandler:function(){this._isMultiTenderEnabled?
this._optionalInstrumentDeselectedWithPrecalculationHandler():this._isPaymentMethodDisabled||(this._enablePayLaterAccount(),this._hideGiftCardDisabledMessageAndUpdateOriginalPaymentLevelInfo(this._getOriginalPaymentLevelInfo()))},_onFoodVoucherCardSelectedHandler:function(){this._deactivateAllPayLaterAccountSections();b.showElement(this._getPaymentMethodInfoWithFVC());this._disablePayLaterAccount()},_onFoodVoucherCardDeselectedHandler:function(){this._deactivateAllPayLaterAccountSections();this._isGiftCardSelected?
this._onGiftCardSelectedHandler():this._onGiftCardDeselectedHandler()},_optionalInstrumentSelectedHandler:function(a){a=a.paymentMethod;"FVC"==a?(this._isFoodVoucherCardSelected=!0,this._onFoodVoucherCardSelectedHandler()):"GC"==a&&(this._isGiftCardSelected=!0,this._isFoodVoucherCardSelected||this._onGiftCardSelectedHandler())},_optionalInstrumentDeselectedHandler:function(a){a=a.paymentMethod;"FVC"==a?(this._isFoodVoucherCardSelected=!1,this._onFoodVoucherCardDeselectedHandler()):"GC"==a&&(this._isGiftCardSelected=
!1,this._isFoodVoucherCardSelected||this._onGiftCardDeselectedHandler())},_getOriginalPaymentLevelInfo:function(){return this.getDOMElement("paymentLevelInfoContainer-".concat(this._instrumentId)).text()},_showGiftCardDisabledMessage:function(){var a=this.getDOMElement("paymentLevelInfoContainer-".concat(this._instrumentId));0==this._isPaymentMethodDisabled&&a.text(this._giftCardUsageDisabledMessage)},_hideGiftCardDisabledMessageAndUpdateOriginalPaymentLevelInfo:function(a){var f=this.getDOMElement("paymentLevelInfoContainer-".concat(this._instrumentId));
0!=a.length&&f.text(a)},_getContainerElement:function(){var a="payLaterAccountContainer-".concat(this._instrumentId);return this.getDOMElement(a)},_getOfferSectionElement:function(){var a="payLaterAccountOfferContainer-".concat(this._instrumentId);return this.getDOMElement(a)},_initializeInstallmentsOffersPopoverView:function(){var a=this;h.when("A",a._popoverComponent,"ready").execute(function(f,k){var b=a._instrumentId;f.on("a:accordion:payLaterAccountPopoverAccordion-"+b+"-WithGC:select",a._installmentsWithInfoPopoverAccordionRowSelectedHandler(a));
f.on("a:accordion:payLaterAccountPopoverAccordion-"+b+":select",a._installmentsWithInfoPopoverAccordionRowSelectedHandler(a));var c=("payLaterAccountPopover-"+a._instrumentId).replaceAll(".","");f.on("a:popover:show:"+c,function(){a._popoverViewInstance=k.get(c)});a.getDOMElement("selectPlanBtn-"+a._instrumentId).click(function(){a._popoverViewInstance&&a._popoverViewInstance.hide()})})},_installmentsWithInfoPopoverAccordionRowSelectedHandler:function(a){return function(b){var k=a._instrumentId.split(".").join(""),
c=b.selectedRow.accordionName.split(".").join(""),c=document.querySelector("#"+c);b=b.selectedRow.rowName.split(".").join("");var d=document.querySelector("#"+b);a._updateDynamicButtonContent(a._instrumentId,d.dataset.primaryoffertext,d.dataset.secondaryoffertext);b=d.dataset.financialofferid;c.dataset.selectedfinancialofferid=b;(c=d.dataset.gcheader)&&"WithGC"==c?a.data.recommendFinancialOfferIDWithGC=b:a.data.recommendFinancialOfferIDDefault=b;document.querySelector("#selectedOfferIdHiddenInput").value=
b;document.querySelector("#payLaterAccountSelectedOfferForPaymentMethod-"+k).value=b;a._isPopoverViewFinancialOfferSelectionContinueButtonSuppressed&&a._popoverViewInstance&&a._popoverViewInstance.hide()}},_updateDynamicButtonContent:function(a,b,k){var c="selectedOfferButtonTextPrefix-".concat(a);this.getDOMElement(c).text(b);a="selectedOfferButtonSecondaryTextPrefix-".concat(a);this.getDOMElement(a).text(k)},_getAccordionSelectedOfferIdValueAndUpdateHiddenSelectedOfferIdInput:function(a){a=a.split(".").join("");
g("#selectedOfferIdHiddenInput").val(g("#payLaterAccountSelectedOfferForPaymentMethod-"+a).val())},_instrumentPayLaterAccountEnableGreyOut:function(){this._getContainerElement();this._getContainerElement().addClass("pmts-payLater-greyed-out-section")},_instrumentPayLaterAccountDisableGreyOut:function(){this._getContainerElement();this._getContainerElement().removeClass("pmts-payLater-greyed-out-section")},_getBalanceTextShownOutSideFinancialOfferContainer:function(){var a="payLaterAccountBalanceOutsideFinancialOfferSelection-".concat(this._instrumentId);
return this.getDOMElement(a)}})});c("components/SelectablePayLaterCreatableListItemComponent",["jQuery","component","css-utils","lang","clog"],function(c,e,b,g,d){return e.extend({initialize:function(b,a){this._deviceType=b.options.deviceType;this._isDesktop="desktop"===this._deviceType;this._isMobile="mobile"===this._deviceType;this._isAmazonApp=a.data.isAmazonApp;this._widgetAction=a.data.widgetAction;this._brand=a.data.brand;this._iframeSource=a.data.iframeSource;this._popoverComponent=this._isDesktop?
"a-modal":"a-secondary-view";this._popoverModalName=this._generateBindingJS("apx-paylater-creatable-popover-modal",this._brand,a.data.uniqueId);this._iframeName=this._generateBindingJS("apx-paylater-iframe",this._brand);this._popoverLinkTrigger=this._generateBindingJS("apx-paylateraccount-creatable-modal-trigger",this._brand);this._popoverActivated=!1},bindToEvents:function(){var b=this;b.widget.on("componentsInitialized",b,function(){h.when("A",b._popoverComponent,"ready").execute(function(a,c){b.getDOMElement(b._popoverLinkTrigger).click(function(){if(c){var a=
c.get(b._popoverModalName);a&&a.show()}});a.on("a:popover:show:"+b._popoverModalName,function(a){try{d.logCounterMetric({feature:"PayLaterAccountWidget.CreatableComponentClicked."+b._deviceType+"."+b._brand,resource:"_Count"}),d.publishMetrics()}catch(c){}b._popoverActivated=!0;b.getDOMElement(b._iframeName).attr("src",b._iframeSource)});a.on("a:popover:hide:"+b._popoverModalName,function(a){b._popoverActivated=!1})});this._bindMessageListener()})},bindToElements:function(){},_generateBindingJS:function(){return Array.from(arguments).join("-")},
_bindMessageListener:function(){var b=g.bind(this._processBetsyMessage,this);g.addEventListener(l,"message",b)},_auiCompatibilityClosePopover:function(){c('div[id^\x3d"a-popover-"]').hide()},_closePopoverModal:function(){var b=this;h.when("A",b._popoverComponent,"ready").execute(function(a,c){c?(a=c.get(b._popoverModalName))&&a.isActive()&&a.hide():b._popoverActivated&&b._auiCompatibilityClosePopover()})},_processBetsyMessage:function(b){var a;try{a=JSON.parse(b.data)}catch(c){return}if(a&&a.linkingStatus)switch(a.linkingStatus){case "MiniBrowserOpened":this._handleMiniBrowerOpened();
break;case "LinkingFailed":this._handleLinkingFailed(a.errorCode);break;case "LinkingSuccess":this._handleLinkingSuccess(a.paymentMethodId);break;case "LinkingCancelled":this._closePopoverModal()}},_handleMiniBrowerOpened:function(){},_showErrorText:function(){var c=this.getDOMElement(this._generateBindingJS("apx-paylateraccount-creatable-error",this._brand));"undefined"!=typeof errorMessage&&(c.textContent=errorMessage);b.showElement(c)},_hideErrorText:function(){var c=this.getDOMElement(this._generateBindingJS("apx-paylateraccount-creatable-error",
this._brand));b.hideElement(c)},_handleLinkingFailed:function(b){var a=this;h.when("A",a._popoverComponent,"ready").execute(function(b,c){c?(b=c.get(a._popoverModalName))&&b.isActive()?(a._closePopoverModal(),a._showErrorText()):a._hideErrorText():a._popoverActivated?(a._showErrorText(),a._closePopoverModal()):a._hideErrorText()})},_triggerRefreshWidget:function(b){"undefined"==typeof b?this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"RefreshEvent",
"ppw-widgetAction":this._widgetAction}):this.widget.submitFormAJAX({"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"AddPaymentMethodRefreshEvent","ppw-paymentMethodId":b,"ppw-widgetAction":this._widgetAction})},_handleLinkingSuccess:function(b){var a=this;h.when("A",a._popoverComponent,"ready").execute(function(c,d){d?(c=d.get(a._popoverModalName))&&c.isActive()&&(a._closePopoverModal(),a._triggerRefreshWidget(b)):a._popoverActivated&&(a._closePopoverModal(),a._triggerRefreshWidget(b))})}})});
c("components/SelectablePayLaterListComponent",["events/InstrumentRowSelectedEvent","components/SimplePaymentOptionListItemComponent"],function(c,e){return e.extend({initialize:function(b,c){},bindToEvents:function(){}})});c("components/PayLaterAccountSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(c,e){var b=e.bindToElements;return c.extend(e,{initialize:function(b,c){this._instrumentId=c.data.instrumentId;this._isRequestForApp=c.data.isRequestForApp;
this._isBrandRequestToMshop=c.data.isBrandRequestToMshop;this._brandName=c.data.brandName},bindToElements:function(){this._isRequestForApp&&this._isBrandRequestToMshop?this._ingressMshopRedirection(this._brandName):b.call(this)},_ingressMshopRedirection:function(b){var c;switch(b){case "Invex":c="/spa/debit-installment/dashboard?ingressSource\x3dwallet\x26preSelectedPaymentMethodId\x3d"+this._instrumentId}this.getDOMElement("walletSelectablePMTab").click(function(){l.location.href=c});this.getDOMElement("walletSelectablePMButton").click(function(){l.location.href=
c})}})});c("components/PayLaterAccountLearnMoreComponent",["jQuery","component","lang","mixins/disable-component"],function(c,e,b,g){return e.extend(g,{initialize:function(b,c){this._instrumentId=c.data.instrumentId;this._partnerName=c.data.partnerName;this._isMultiTenderEnabledForPayLaterAccount=c.data.isMultiTenderEnabledForPayLaterAccount},bindToElements:function(){this._enableComponentState();this._isMultiTenderEnabledForPayLaterAccount||(this.widget.on("optionalInstrumentSelected",this,this._enableLearnMoreLink),
this.widget.on("optionalInstrumentDeselected",this,this._enableLearnMoreLink));this.getDOMElement("apx-paylateraccount-creatable-learn-more-wrapper-"+this._partnerName).click(function(b){b.stopPropagation()})},_enableLearnMoreLink:function(b){"GC"===b.paymentMethod&&this._enableComponentState()},_enableComponentState:function(){this.setDisabled(!1)}})})})()});
/* ******** */
(function(l){var h=window.AmazonUIPageJS||window.P,m=h._namespace||h.attributeErrors,d=m?m("APXWidgetsAssets@APXWidgets-ZipPay","APXWidgetsAssets"):h;d.guardFatal?d.guardFatal(l)(d,window):d.execute(function(){l(d,window)})})(function(l,h,m){(function(){var d=PaymentsPortal2.modules.define;d("components/SelectableZipPayListComponent",["form-component"],function(c){return c});d("components/ZipPayListItemComponent","components/SelectableDPMInstrumentListItemComponent events/InstrumentRowSelectedEvent lang jQuery css-utils component".split(" "),
function(c,d,h,g,k,m){var f,a,b,e;return c.extend({initialize:function(a,b){this._maybeDisableInstrumentRow()},_maybeDisableInstrumentRow:function(){var a=this._getContainerElement();0<a.find(".pmts-zip-no-balance-text").length&&(a.find("img").each(function(a,b){g(b).css("opacity","0.5")}),a.find(".pmts-zip-balance-instrument-type").each(function(a,b){g(b).addClass("a-color-tertiary")}),a.find("input[type\x3dradio]").each(function(a,b){g(b).prop("disabled",!0)}))},_getContainerElement:function(){return this.getDOMElement("POAInstrumentContainer-"+
this._getInstrumentId())},_triggerIsLineItemIneligibleEvent:function(){this._instrumentZipEnableGreyOut();this._instrumentZipUnclickable()},_instrumentZipEnableGreyOut:function(){this._getContainerElement().addClass("pmts-disabled-section")},_instrumentZipUnclickable:function(){this._getContainerElement().addClass("pmts-pm-disabled")},_instrumentZipDisableGreyOut:function(){this._getContainerElement().removeClass("pmts-disabled-section")},_instrumentZipClickable:function(){this._getContainerElement().removeClass("pmts-pm-disabled")},
_hideZipAlertMessage:function(){this.getDOMElement("pmts-zip-inline-alert-message").addClass("apx-js-hide")},_showZipAlertMessage:function(){this.getDOMElement("pmts-zip-inline-alert-message").removeClass("apx-js-hide")},_setZipPaymentInvalid:function(a){a=[this.widget.getLocalizedString(a)];this._triggerBackingInstrumentSelectedEvent(a)},_canGiftCardBalanceCoverZipBalanceInsufficiency:function(){a=this.data.zipBalance;b=this.data.cartTotalAmount;return a&&b?f?Number(a)+Number(f)>=Number(b):!1:!0},
bindToElements:function(){var a=this;0===a._getContainerElement().find(".pmts-zip-no-balance-text").length&&a.getDOMElementsByPrefix("POAInstrumentContainer").click(function(b){g(b.currentTarget).data("disabled")||a.poaInstrumentClicked(a._instrumentId)});a.getDOMElement("ZipBalanceRefresh").find(".pmts-zip-balance-refresh-link").click(function(){a.widget.trigger("ZipBalanceRefresh")})},bindToEvents:function(){var a=this;a.widget.on("initializeRecommendedInstrument",a,function(b){a.data.isLineItemIneligible?
(a._triggerIsLineItemIneligibleEvent(),b.instrumentId===a._getInstrumentId()&&a._setZipPaymentInvalid("pmts_portal_payselect_empty_instrument_selection")):b.instrumentId===a._getInstrumentId()?(a.widget.trigger(d,{instrumentId:a._getInstrumentId()}),a.data.isMultiTenderEnabledWithZip||a.widget.trigger("deselectGiftCardCheckbox",{paymentMethod:a.data.paymentMethod})):a._onInstrumentDeselected()});a.widget.on(d,a,function(b){e=!1;a._instrumentRowSelected(b.instrumentId);h.isDefined(a.data.instrumentId)&&
-1!==b.instrumentId.indexOf("amzn1.pm.pma.zip")&&(e=!0,a.data.isInsufficientCoverage&&(a.data.isMultiTenderEnabledWithZip&&a._canGiftCardBalanceCoverZipBalanceInsufficiency()?a._hideZipAlertMessage():(a._setZipPaymentInvalid("pmts_portal_zp_error_insufficient_popover"),a._showZipAlertMessage())))});a.widget.on("optionalInstrumentSelected",a,function(b){"GC"===b.paymentMethod&&(f=b.balance,a.data.isMultiTenderEnabledWithZip?a.data.isInsufficientCoverage&&a._canGiftCardBalanceCoverZipBalanceInsufficiency()&&
(e&&a._instrumentRowSelected(a.data.zipPayId),a._hideZipAlertMessage()):(a._instrumentZipEnableGreyOut(),a._instrumentZipUnclickable(),a._showZipAlertMessage()))});a.widget.on("optionalInstrumentDeselected",a,function(b){"GC"===b.paymentMethod&&(f=0,a.data.isMultiTenderEnabledWithZip?a.data.isInsufficientCoverage&&(e&&a._setZipPaymentInvalid("pmts_portal_zp_error_insufficient_popover"),a._showZipAlertMessage()):a.data.isLineItemIneligible||(a._instrumentZipDisableGreyOut(),a._instrumentZipClickable(),
a._hideZipAlertMessage()))});a.widget.on("ZipBalanceRefresh",a,function(b){a.widget.submitFormAJAX({"ppw-widgetState":a.widget.options.serializedState,"ppw-widgetEvent":"ZipBalanceRefreshEvent"})})}})});d("components/AddZipPayComponent","css-utils jQuery form-component lang AUI!P aui-helper clog".split(" "),function(c,d,p,g,k,l,f){return p.extend({_authenticationSourceId:"",_authenticationSourceStatus:"",_authenticationSourceIdRedirect:"",_authenticationSourceIdRedirectStatus:"",_AUCountryCodePrefix:"+61",
_resendCodeClickCount:0,_zipAjaxCallInProgress:!1,_zipModalLockLevel:11,_zipApplicationURL:"",_zipApplicationModalVisible:!1,_zipApplicationSecondaryViewVisible:!1,_zipIFrameApplicationLoaded:!1,_isAUIAvailable:!0,_zipModalPopover:"",_isZipSignupPromotion:!1,_emptyMobileNumberErrorMsg:{field:"zip_mobile_number",messageStringId:"pmts_portal_zp_error_no_mobile_number"},_invalidMobileNumberErrorMsg:{field:"zip_mobile_number",messageStringId:"pmts_portal_zp_error_invalid_mobile_number"},_emptyOTPErrorMsg:{field:"zip_one_time_password",
messageStringId:"pmts_portal_zp_error_no_verification_code"},_invalidOTPErrorMsg:{field:"zip_one_time_password",messageStringId:"pmts_portal_zp_error_invalid_verification_code"},_failedInternalCallErrorMsg:{messageStringId:"pmts_portal_zp_error_internal_fail"},initialize:function(a,b){this._isDesktop="desktop"===a.options.deviceType;this._isTablet="tablet"==a.options.deviceType;this._isMobile="mobile"===a.options.deviceType;this._isAmazonApp=b.data.isAmazonApp},bindToElements:function(){this.bindFormSubmissionHandler("getVerificationCodeButton",
"mobileNumber",this.handleSendOTPRequest);this.bindFormSubmissionHandler("resendCodeRequest","mobileNumber",this.handleResendOTPRequest);this.bindFormSubmissionHandler("verifyButton","verificationCode",this.handleVerifyOTPRequest);this._bindCreateZipAccountTrigger();this._bindPromptUserToAddOrCreateZipAccount()},loadModal:function(){"mobile"===this.deviceType&&this.getDOMElement("bottomSheetTrigger").click()},handleSendOTPRequest:function(){var a=this,b=a._validateFormField("zip_mobile_number"),e=
a.getDOMElement("zip_mobile_number").val(),b=a._validateMobileNumberInput(e,b),e=a._AUCountryCodePrefix+e;0===b.length?(a._handleValidRequest("getVerificationCodeButton","a-button-disabled","errorMessagesInlineContainer-zip_mobile_number"),a.widget.continueRequest({"ppw-widgetEvent":"ZipPaySendOTPEvent",zip_mobile_number:e,"ppw-widgetState":a.widget.options.serializedState},{complete:function(){a.getDOMElement("getVerificationCodeButton").removeClass("a-button-disabled")},success:g.bind(function(b){a._checkMobileNumberRegistrationStatus(b.additionalWidgetResponseData.additionalData)},
this),error:g.bind(function(){},this),queryParameters:a.widget._whitelistedQueryParameters("?sif_profile\x3dZIP_SIF_Profile")})):(c.hideElement(this.getDOMElement("errorMessagesInlineContainer")),a._renderErrorMessages(a.form._getLocalizedErrorMessages(b)));return!1},handleResendOTPRequest:function(){var a=this,b=a._validateFormField("zip_mobile_number"),e=a.getDOMElement("zip_mobile_number").val(),b=a._validateMobileNumberInput(e,b);0===b.length&&a._validateResendOtpFrequencyCheck();e=a._AUCountryCodePrefix+
e;0===b.length?(a._handleValidRequest(null,null,"errorMessagesInlineContainer-zip_mobile_number"),a.widget.continueRequest({"ppw-widgetEvent":"ZipPayResendOTPEvent",zip_mobile_number:e,"ppw-authenticationSourceId":a._authenticationSourceId,"ppw-widgetState":a.widget.options.serializedState},{success:g.bind(function(b){b=b.additionalWidgetResponseData.additionalData;a._authenticationSourceStatus=b.authenticationSourceStatus;a._checkMobileNumberRegistrationStatus(b)},this),error:g.bind(function(){},
this),queryParameters:a.widget._whitelistedQueryParameters("?sif_profile\x3dZIP_SIF_Profile")})):(c.hideElement(this.getDOMElement("errorMessagesInlineContainer")),a._renderErrorMessages(a.form._getLocalizedErrorMessages(b)));return!1},handleVerifyOTPRequest:function(){var a=this,b=a._validateFormField("zip_one_time_password"),e=a.getDOMElement("zip_one_time_password").val(),b=a._validateOTPInput(e,b);0===b.length?(a._handleValidRequest("verifyButton","a-button-disabled","errorMessagesInlineContainer-zip_one_time_password"),
a.widget.trigger("submitFormAjaxStarted"),a.widget.continueRequest({"ppw-widgetEvent":"ZipPayVerifyOTPEvent",zip_one_time_password:e,"ppw-authenticationSourceId":a._authenticationSourceId,"ppw-widgetState":a.widget.options.serializedState},{complete:function(){a.getDOMElement("verifyButton").removeClass("a-button-disabled");a.widget.trigger("submitFormAjaxCompleted")},success:g.bind(function(b){var e=b.additionalWidgetResponseData.additionalData;"APPROVED"===e.authenticationSourceStatus?(a.widget._onAJAXContinueSuccess(b),
a.closeAddZipPayPopover()):e.errors?(b=JSON.parse(e.errors),a.form.renderErrorMessages(b)):(b=[],b.push(a._failedInternalCallErrorMsg),a.form.renderErrorMessages(a.form._getLocalizedErrorMessages(b)))},this),error:g.bind(function(){},this),queryParameters:a.widget._whitelistedQueryParameters("?sif_profile\x3dZIP_SIF_Profile")})):(c.hideElement(this.getDOMElement("errorMessagesInlineContainer")),a._renderErrorMessages(a.form._getLocalizedErrorMessages(b)));return!1},verificationCodeFormDisplay:function(a){c.toggleElement(this.getDOMElement("verificationCodeForm"),
a)},hideGetVerificationCodeButtonAndShowResendCodeRequest:function(){c.hideElement(this.getDOMElement("getVerificationCodeButton"));c.showElement(this.getDOMElement("resendCodeRequest"))},closeAddZipPayPopover:function(){k.when("a-modal").execute(function(a){a&&(a=a.get("addZipPayPopover"))&&a.hide()})},_bindPromptUserToAddOrCreateZipAccount:function(){var a=this;k.when("A","a-modal","ready").execute(function(b,e){if(a._isDesktop||a._isTablet)e=b.$(h.location).attr("hash"),"#ZipPromoteSignup"===e&&
1===b.$("#zip-application-create-zip-account-button").length?(a._isZipSignupPromotion=!0,f.logCounterMetric({feature:"ZipApplicationSignupPromotionClickCount",resource:"_Count"}),f.publishMetrics(),a._expandAddZipAccountSection(b),b.$("#zip-application-create-zip-account-button").trigger("click")):"#ZipPromoteLinking"===e&&1===b.$("#zip-application-mobile-number-text-input").length&&(f.logCounterMetric({feature:"ZipApplicationAccountLinkingPromotionClickCount",resource:"_Count"}),f.publishMetrics(),
a._expandAddZipAccountSection(b),b.$("#zip-application-mobile-number-text-input").focus())})},_expandAddZipAccountSection:function(a){a.$(".pmts-add-your-zip-account-expander .a-expander-prompt").trigger("click")},_bindCreateZipAccountTrigger:function(){var a=this;a._bindCrossDomainMessaging();k.when("A","a-modal").execute(function(b,e){b.on("a:popover:beforeShow:ZipApplicationModal",function(b){a._zipModalPopover=b.popover;a._zipApplicationModalVisible=!0;a._showZipApplicationSection("leavingAmazonSection");
a.lockZipApplicationModal();f.logCounterMetric({feature:"ZipApplicationCreateZipAccountClickCount",resource:"_Count"});f.publishMetrics()});b.on("a:popover:show:ZipApplicationModal",function(b){a._zipModalPopover.updatePosition();a._zipModalPopover.$popover.find(".a-popover-header").addClass("aok-hidden");a._zipModalPopover.$popover.find(".a-popover-inner").addClass("a-padding-none")});b.on("a:popover:hide:ZipApplicationModal",function(b){a._zipApplicationModalVisible=!1;a._zipIFrameApplicationLoaded=
!1});b.declarative("pmts-zp-application-continue-button","click",function(){a._showZipApplicationSection("zipApplicationLoader");a._generateRedirectURL()});b.declarative("pmts-zp-application-close-icon","click",function(){a.closeZipApplicationModal()});b.declarative("pmts-zp-application-try-again-button","click",function(){a._showZipApplicationSection("zipApplicationLoader");a._generateRedirectURL()});b.declarative("pmts-zp-application-choose-another-pm-button","click",function(){a._isMobile?a.closeZipApplicationSecondaryView():
a.closeZipApplicationModal()})});k.when("A","a-secondary-view","a-sheet").execute(function(b,e,c){b.on("a:popover:beforeShow:ZipApplicationSecondaryView",function(b){a._zipApplicationSecondaryViewVisible=!0;a._showZipApplicationSection("zipApplicationLoader");a._generateRedirectURL()});b.on("a:sheet:afterShow:zipApplicationBottomSheet",function(a){f.logCounterMetric({feature:"ZipApplicationCreateZipAccountButtonPressedCount",resource:"_Count"});f.publishMetrics()});b.on("a:popover:hide:ZipApplicationSecondaryView",
function(b){a._zipApplicationSecondaryViewVisible=!1;a._zipIFrameApplicationLoaded=!1;c&&c.get("zipApplicationBottomSheet")&&c.get("zipApplicationBottomSheet").hide()})})},_showZipApplicationSection:function(a){c.hideElement(this.getDOMElement("iFrameSection"));c.hideElement(this.getDOMElement("leavingAmazonSection"));c.hideElement(this.getDOMElement("zipApplicationLoader"));c.hideElement(this.getDOMElement("zipApplicationSomethingWentWrong"));c.hideElement(this.getDOMElement("zipApplicationUnableToProcess"));
c.showElement(this.getDOMElement(a))},_generateRedirectURL:function(){var a=this;a._zipAjaxCallInProgress||(a._zipAjaxCallInProgress=!0,a._toggleCreateZipAccountButton(!1),a._isAUIAvailable||a.widget.trigger("submitFormAjaxStarted"),a.widget.continueRequest({"ppw-widgetEvent":"ZipPayGenerateRedirectURLEvent","ppw-widgetState":a.widget.options.serializedState},{complete:function(){a._isAUIAvailable||a.widget.trigger("submitFormAjaxCompleted");a._toggleCreateZipAccountButton(!0);a._zipAjaxCallInProgress=
!1},success:g.bind(function(b){b=b.additionalWidgetResponseData.additionalData;"PENDING"===b.authenticationSourceStatus?(a._zipApplicationURL=b.zipApplicationURL,a._authenticationSourceIdRedirect=b.authenticationSourceId,a._handleGenerateRedirectURLSuccess()):(a._authenticationSourceIdRedirectStatus=b.authenticationSourceStatus,a._handleGenerateRedirectURLFailure())},this),error:g.bind(function(){a._authenticationSourceIdRedirectStatus="ERROR";a._handleGenerateRedirectURLFailure()},this)}))},_toggleCreateZipAccountButton:function(a){a?
(this.getDOMElement("createZipAccountButton").removeClass("a-button-disabled"),this.getDOMElement("createZipAccountButtonWrapper").addClass("a-declarative"),this.getDOMElement("createZipAccountButton").attr("disabled",!1)):(this.getDOMElement("createZipAccountButton").addClass("a-button-disabled"),this.getDOMElement("createZipAccountButtonWrapper").removeClass("a-declarative"),this.getDOMElement("createZipAccountButton").attr("disabled",!0))},_handleGenerateRedirectURLSuccess:function(){if(this._zipApplicationModalVisible||
this._zipApplicationSecondaryViewVisible)this._isAmazonApp?this._openInEmbeddedBrowser():this._addIFrameSource()},_openInEmbeddedBrowser:function(){var a=this;k.when("mash").execute(function(b){b.showEmbeddedBrowser({targetURL:a._zipApplicationURL,successCallback:function(){a.lastWillReappear=h.app.willReappear;delete h.app.willReappear;h.app.willReappear=function(){h.app.willReappear=a.lastWillReappear;a._handleThirdPartyRedirectResponse()}}})})},_handleGenerateRedirectURLFailure:function(){this._showZipApplicationSection("zipApplicationSomethingWentWrong")},
closeZipApplicationModal:function(){var a=this;k.when("a-modal").execute(function(b){b?b.get("ZipApplicationModal").unlock(a._zipModalLockLevel).hide():a._zipModalPopover.$popover.find("button[data-action]\x3da-popover-close").trigger("click")})},lockZipApplicationModal:function(a){var b=this;k.when("a-modal").execute(function(a){a?a.get("ZipApplicationModal").lock(b._zipModalLockLevel):b._isAUIAvailable=!1})},closeZipApplicationSecondaryView:function(){k.when("a-secondary-view").execute(function(a){a&&
a.get("ZipApplicationSecondaryView").hide()})},_addIFrameSource:function(){var a=this,b=a.getDOMElement("zipApplicationIFrame");b.attr("src",a._zipApplicationURL);a.startTime=(new Date).getTime();b.load(function(){b.attr("src")!==a._zipApplicationURL||!a._zipApplicationSecondaryViewVisible&&!a._zipApplicationModalVisible||a._zipIFrameApplicationLoaded||(a._showZipApplicationSection("iFrameSection"),a._zipIFrameApplicationLoaded=!0,f.logLatencyMetric({feature:"ZipApplicationPageLoadTime",resource:"_Latency",
startTime:a.startTime}),f.publishMetrics(),a.startTime=(new Date).getTime())})},_bindCrossDomainMessaging:function(){var a=g.bind(this._processCrossDomainMessage,this);g.addEventListener(h,"message",a)},_processCrossDomainMessage:function(a){if(a&&a.origin&&a.data&&(this._zipApplicationSecondaryViewVisible||this._zipApplicationModalVisible)){this._isZipSignupPromotion&&this._emitZipSignupPromotionCSM(a.data.message_type);switch(a.data.message_type){case "user_journey_started":f.logCounterMetric({feature:"ZipApplicationJourneyStartedCount",
resource:"_Count"});break;case "user_journey_completed":f.logCounterMetric({feature:"ZipApplicationJourneyCompletedCount",resource:"_Count"});f.logLatencyMetric({feature:"ZipApplicationJourneyCompletedTime",resource:"_Latency",startTime:this.startTime});this._handleThirdPartyRedirectResponse();break;case "user_journey_expired":f.logCounterMetric({feature:"ZipApplicationJourneyExpiredCount",resource:"_Count"});this._handleFailureZipRegistration();break;default:f.logCounterMetric({feature:"ZipApplicationJourneyInvalidMessageCount",
resource:"_Count"})}f.publishMetrics()}},_emitZipSignupPromotionCSM:function(a){switch(a){case "user_journey_started":f.logCounterMetric({feature:"ZipApplicationPromotionJourneyStartedCount",resource:"_Count"});break;case "user_journey_completed":f.logCounterMetric({feature:"ZipApplicationPromotionJourneyCompletedCount",resource:"_Count"});break;case "user_journey_expired":f.logCounterMetric({feature:"ZipApplicationPromotionJourneyExpiredCount",resource:"_Count"});break;default:f.logCounterMetric({feature:"ZipApplicationPromotionJourneyInvalidMessageCount",
resource:"_Count"})}f.publishMetrics()},_handleThirdPartyRedirectResponse:function(){var a=this;a._showZipApplicationSection("zipApplicationLoader");a._zipIFrameApplicationLoaded=!1;a._isAUIAvailable||a.widget.trigger("submitFormAjaxStarted");a.widget.continueRequest({"ppw-widgetEvent":"ZipPayThirdPartyResponseEvent","ppw-authenticationSourceId":a._authenticationSourceIdRedirect,"ppw-widgetState":a.widget.options.serializedState},{complete:function(){a._isAUIAvailable||a.widget.trigger("submitFormAjaxCompleted")},
success:g.bind(function(b){"APPROVED"===b.additionalWidgetResponseData.additionalData.authenticationSourceStatus?a._handleSuccessfulZipRegistration(b):a._handleFailureZipRegistration()},this),error:g.bind(function(){a._handleFailureZipRegistration()},this)})},_handleFailureZipRegistration:function(){this._zipIFrameApplicationLoaded=!1;this._showZipApplicationSection("zipApplicationUnableToProcess")},_handleSuccessfulZipRegistration:function(a){this._isMobile?(this.widget._onAJAXContinueSuccess(a),
this.closeZipApplicationSecondaryView()):(this.widget._onAJAXContinueSuccess(a),this.closeZipApplicationModal())},_handleValidRequest:function(a,b,e){this.form.resetErrors();null!=a&&null!=b&&this.getDOMElement(a).addClass(b);c.hideElement(this.getDOMElement(e))},_validateFormField:function(a){return g.filter(this.form.validateForm(),function(b){return b.field===a})},_validateMobileNumberInput:function(a,b){0!==a.length?/^\d+$/.test(a)?(9>a.length||9===a.length&&"4"!==a.charAt(0)||10===a.length&&
"04"!==a.substring(0,2))&&b.push(this._invalidMobileNumberErrorMsg):b.push(this._invalidMobileNumberErrorMsg):b.push(this._emptyMobileNumberErrorMsg);return b},_validateOTPInput:function(a,b){0!==a.length?/^\d+$/.test(a)?6!==a.length&&b.push(this._invalidOTPErrorMsg):b.push(this._invalidOTPErrorMsg):b.push(this._emptyOTPErrorMsg);return b},_validateResendOtpFrequencyCheck:function(){var a=this;a._resendCodeClickCount++;3>a._resendCodeClickCount?(a.getDOMElement("resendCodeRequest").addClass("apx-zipPay-link-disabled"),
h.setTimeout(function(){a.getDOMElement("resendCodeRequest").removeClass("apx-zipPay-link-disabled")},3E4)):a.getDOMElement("resendCodeRequest").addClass("apx-zipPay-link-disabled")},_checkMobileNumberRegistrationStatus:function(a){this._authenticationSourceId=a.authenticationSourceId;this._authenticationSourceStatus=a.authenticationSourceStatus;"PENDING"===this._authenticationSourceStatus?(this.form.clearValidationErrors(),this.hideGetVerificationCodeButtonAndShowResendCodeRequest(),this.verificationCodeFormDisplay(!0),
c.hideElement(this.getDOMElement("errorMessagesInlineContainer")),c.hideElement(this.getDOMElement("errorMessagesInlineContainer-verificationCode"))):(a.errors?a=JSON.parse(a.errors):(a=[],a.push(this._failedInternalCallErrorMsg)),this.form.renderErrorMessages(a))},_renderErrorMessages:function(a){var b=this,c=[],f=[],d=[],h={};g.forEach(a,function(a){a.field&&(h[a.field]||(h[a.field]=[]),h[a.field].push(a),b.form.blameFormField(a.field,!0));a.validation&&a.fieldMetricValueType&&a.fieldValue&&(c.push(a.validation),
f.push(a.fieldMetricValueType),d.push(a.fieldValue))});if(b._isDesktop){var k=b.form._getFormAlertsContainer();k.domElement!==m&&l.getFormAlertsContainerHelper(k.messageDisplayType,k.domElement).render(a)}else{var n=b.form._getFormFieldAlertContainers();g.forEach(g.keys(n),function(a){l.getFormAlertsContainerHelper("inline",n[a]).render(h[a])})}}})});d("components/ZipPayDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport","jQuery"],function(c,d,h){return c.extend(d,{initialize:function(c,
d){this._paymentMethodId=d.data.paymentMethodId;this._paymentMethodType=d.data.paymentMethodType;this._isDefault=d.data.isDefault},bindToElements:function(){this._bindEditPMLink()}})});d("components/ZipPayEditComponent",["component","EditComponentSupport"],function(c,d){return c.extend(d,{initialize:function(c,g){d._initializePopover(c,g,this)},bindToEvents:function(){d._bindPopoverCloseButtonClickedEvent(this)}})});d("components/ZipPayMetadataSlotComponent",["component"],function(c){return c.extend({initialize:function(c,
d){}})});d("components/ZipPaySleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(c,d){return c.extend(d,{initialize:function(c,d){this._instrumentId=d.data.instrumentId}})})})()});
/* ******** */
(function(m){var e=window.AmazonUIPageJS||window.P,k=e._namespace||e.attributeErrors,g=k?k("APXWidgetsAssets@APXWidgets-BancomatPay","APXWidgetsAssets"):e;g.guardFatal?g.guardFatal(m)(g,window):g.execute(function(){m(g,window)})})(function(m,e,k){(function(){var g=PaymentsPortal2.modules.define;g("components/AddBancomatPayComponent","events/form-submitted-event jQuery form-component css-utils lang AUI!P clog".split(" "),function(n,d,g,f,h,l,m){return g.extend({_hasErrors:!1,_showSavedMobileNumber:!1,
_clientProfile:"YA:MPO",_deviceType:"desktop",_maybeHighFrictionCXWithPolicy2:!1,_shouldOpenAddPaymentInstrumentView:!1,initialize:function(a,b){this._action=b.data.action;this._hasErrors=b.data.hasErrors;this._widgetState=b.data.widgetState;this._widgetComplete=!1;this._showSavedMobileNumber=b.data.showSavedMobileNumber;this._clientProfile=b.data.clientProfile;this._deviceType=b.data.deviceType;this._maybeHighFrictionCXWithPolicy2=b.data.maybeHighFrictionCXWithPolicy2;this._maybeEnableRedirectURLBuild=
b.data.maybeEnableRedirectURLBuild;this.$toggleSwitch=this.getDOMElement("apxSetAsDefaultJsBinding");this._paymentMethodId=this._addBancomatPayData=k;this._shouldOpenAddPaymentInstrumentView=b.data.shouldOpenAddPaymentInstrumentView},initPopoverState:function(){"true"===String(this._hasErrors)&&(this.getDOMElement("addBancomatPayJSOpenPopOverButtonId").trigger("click"),this.getDOMElement("addBancomatPayCompactPopOverLink").trigger("click"));this.getDOMElement("addBancomatPayLinkSavedNumberIdBox").length?
(this.getDOMElement("addBancomatPayLinkNewNumberIdBox").css({"background-color":"#F0F2F2"}),this.getDOMElement("addBancomatPayLinkSavedNumberIdBox").css({"background-color":"#FFF"}),this.getDOMElement("addBancomatPayJsPhoneNumberInputId").length?this.getDOMElement("addBancomatPayJsPhoneNumberInputId").prop("disabled",!0):(f.hideElement(this.getDOMElement("addBancomatPayRedirectButton")),f.showElement(this.getDOMElement("addBancomatPaySubmitButton")))):this.getDOMElement("addBancomatPayJsPhoneNumberInputId").length&&
this.getDOMElement("addBancomatPayJsPhoneNumberInputId").prop("disabled",!1);var a=e.location.hash,b=new URLSearchParams(e.location.search),c=b.get("successCodes");a.includes("successCodes\x3dSUCCESS_CHANGE_MOBILE_PHONE")?(this.publishMetrics("BancomatPayHighFrictionCX.RedirectBack.ToPSP"),this.triggerPopOver()):null!==c&&"SUCCESS_CHANGE_MOBILE_PHONE"===c&&(this.publishMetrics("BancomatPayHighFrictionCX.RedirectBack.ToMPO"),this.triggerPopOver(),this._shouldOpenAddPaymentInstrumentView&&(b.delete("successCodes"),
e.history.replaceState({},"",e.location.protocol+"//"+e.location.host+e.location.pathname+"?"+b.toString())))},triggerPopOver:function(){this.getDOMElement("addBancomatPayJSOpenPopOverButtonId").trigger("click");this.getDOMElement("addBancomatPayCompactPopOverLink").trigger("click")},bindToElements:function(){this.getDOMElement("addBancomatPayCancelButton").click(h.bind(this.closeAddBancomatPayDesktopPopover,this));this.getDOMElement("addBancomatPayJsCompactCancelButtonId").click(h.bind(this.closeAddBancomatPayCompactPopover,
this));d("#addBancomatPayLinkSavedNumberId").click(h.bind(this.handleSavedNumberRadioButtonClick,this));d("#addBancomatPayLinkNewNumberId").click(h.bind(this.handleNewNumberRadioButtonClick,this));this.getDOMElement("addBancomatPaySubmitButton").click(h.bind(this.handleFormSubmission,this));this.getDOMElement("addBancomatPayRedirectButton").click(h.bind(this.handleRedirection,this));this.getDOMElement("setPreferenceBancomatPayJsButtonId").click(h.bind(this.handleContinueButton,this))},bindToEvents:function(){var a=
this;a.widget.on(n,a,function(b){if(b.action===a._action)b.event.preventDefault(),f.showElement(a.getDOMElement("addBancomatPayJsSpinnerId")),this.pollPaymentMethodVerificationStatus(b);else if("setPreferenceBancomatPay"===b.action){b.event.preventDefault();var c=this._getToggleSwitchAuiElement();c&&c.isOn()?(a.publishMetrics("BancomatPay.SetAsDefault.FormSubmitted.ToggleOn"),f.showElement(a.getDOMElement("setPreferenceBancomatPayJsSpinnerId")),this.setPreferenceBancomatPay(b)):a._addBancomatPayData&&
(a.publishMetrics("BancomatPay.SetAsDefault.FormSubmitted.ToggleOff"),a.switchPopoverWidth(),a.closeAllPopovers(),a.formActivityCompleteRefresh(a._addBancomatPayData),a._addBancomatPayData=k)}});a.widget.on("componentsInitialized",a,function(b){a.initPopoverState()});l.when("A").execute(function(b){b.on("a:popover:dismiss:addBancomatPayPopOverDesktopName",function(b){a.form.resetErrors();a.resetBpayForm();a._addBancomatPayData&&(a.publishMetrics("BancomatPay.SetAsDefault.CustomerAbandonAfterRegistration"),
a.switchPopoverWidth(),a.closeAllPopovers(),a.formActivityCompleteRefresh(a._addBancomatPayData),a._addBancomatPayData=k)})});l.when("A").execute(function(b){b.on("a:popover:dismiss:addBancomatPayCompactPopoverName",function(b){a.form.resetErrors();a.resetBpayForm();a._addBancomatPayData&&(a.publishMetrics("BancomatPay.SetAsDefault.CustomerAbandonAfterRegistration"),a.switchPopoverWidth(),a.closeAllPopovers(),a.formActivityCompleteRefresh(a._addBancomatPayData),a._addBancomatPayData=k)})});a.getDOMElement("addBancomatPayJsPhoneNumberInputId").keypress(function(a){if(!(48<=
a.which&&57>=a.which||8===a.which||46===a.which))return!1});a.getDOMElement("addBancomatPayJsPhoneNumberInputId").bind("paste",function(a){a.preventDefault()})},getForm:function(a){return this.getDOMElement(a).find("form").andSelf().filter("form")},handleContinueButton:function(a){self=this;this.getDOMElement("setPreferenceBancomatPayPMHiddenFormJSBinding").val(self._paymentMethodId);var b=self.getFormSubmissionParameters("setPreferenceBancomatPayPopOverContainerId","setPreferenceBancomatPayJsButtonId"),
c=self.getForm("setPreferenceBancomatPayPopOverContainerId");self.widget.trigger(n,{event:a,submissionParameters:b,formElement:c,action:"setPreferenceBancomatPay"})},handleFormSubmission:function(a){self=this;if(self._showSavedMobileNumber&&d("#addBancomatPayLinkSavedNumberId").is(":checked"))this.publishMetrics("BancomatPay.PrimaryPhoneNumberSelectedForPMCreation"),this.getDOMElement("addBancomatPayHiddenField").val(d("#addBancomatPayLinkSavedNumberId").val());else{var b=d("select[name\x3dppw-bancomatPayCountryCode] option").filter(":selected").val(),
c=self.getDOMElement("addBancomatPayJsPhoneNumberInputId").val();this.publishMetrics("BancomatPay.CustomerAddedPhoneNumberSelectedForPMCreation");this.getDOMElement("addBancomatPayHiddenField").val(b+c)}b=this.getDOMElement("addBancomatPayHiddenField").val().slice(-4);this.getDOMElement("addBancomatPayTailHiddenField").html(" "+b+" ");var b=self.form.validateForm(),c=self.getFormSubmissionParameters("addBancomatPayPopOverContainer","addBancomatPaySubmitButton"),f=self.getForm("addBancomatPayPopOverContainer");
0===b.length?self.widget.trigger(n,{event:a,submissionParameters:c,formElement:f,action:self._action}):a.preventDefault()},handleRedirection:function(a){a.preventDefault();this._showSavedMobileNumber?(this.publishMetrics("BancomatPayHighFrictionCX.Redirect.ChangeMobileNumber.Policy1"),this._maybeEnableRedirectURLBuild?this.handleRedirectionToDevicesURLBuild():this.handleRedirectionToDevices("https://amazon.it/ap/profile/mobilephone?orig_return_to\x3dhttps%3A%2F%2Fwww.amazon.it%2Fgp%2Fbuy%2Fpayselect%2Fhandlers%2Fdisplay.html%23\x26openid.identity\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.assoc_handle\x3danywhere_v2_it\x26openid.mode\x3dcheckid_setup\x26openid.ns.pape\x3dhttp%3A%2F%2Fspecs.openid.net%2Fextensions%2Fpape%2F1.0\x26openid.claimed_id\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.ns\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0",
"https://amazon.it/ap/profile/mobilephone?orig_return_to\x3dhttps%3A%2F%2Fwww.amazon.it%2Fcpe%2Fyourpayments%2Fwallet%3Fref_%3Dya_d_c_pmt_mpo\x26openid.identity\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.assoc_handle\x3danywhere_v2_it\x26openid.mode\x3dcheckid_setup\x26openid.ns.pape\x3dhttp%3A%2F%2Fspecs.openid.net%2Fextensions%2Fpape%2F1.0\x26openid.claimed_id\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.ns\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0",
"https://amazon.it/ap/profile/mobilephone?orig_return_to\x3dhttps%3A%2F%2Fwww.amazon.it%2Fcpe%2Fyourpayments%2Fsettings%2Fmanageoneclick%3Fref_%3Dv1c_payment_method%23\x26openid.identity\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.assoc_handle\x3danywhere_v2_it\x26openid.mode\x3dcheckid_setup\x26openid.ns.pape\x3dhttp%3A%2F%2Fspecs.openid.net%2Fextensions%2Fpape%2F1.0\x26openid.claimed_id\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.ns\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0",
"https://amazon.it/ap/profile/mobilephone?orig_return_to\x3dhttps%3A%2F%2Fwww.amazon.it%2Fgp%2Fbuy%2Fpayselect%2Fhandlers%2Fdisplay.html%23\x26openid.identity\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.assoc_handle\x3ditflex\x26openid.mode\x3dcheckid_setup\x26openid.ns.pape\x3dhttp%3A%2F%2Fspecs.openid.net%2Fextensions%2Fpape%2F1.0\x26openid.claimed_id\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.ns\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0",
"https://amazon.it/ap/profile/mobilephone?orig_return_to\x3dhttps%3A%2F%2Fwww.amazon.it%2Fcpe%2Fyourpayments%2Fwallet%3Fref_%3Dya_d_c_pmt_mpo\x26openid.identity\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.assoc_handle\x3ditflex\x26openid.mode\x3dcheckid_setup\x26openid.ns.pape\x3dhttp%3A%2F%2Fspecs.openid.net%2Fextensions%2Fpape%2F1.0\x26openid.claimed_id\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.ns\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0",
"https://amazon.it/ap/profile/mobilephone?orig_return_to\x3dhttps%3A%2F%2Fwww.amazon.it%2Fcpe%2Fyourpayments%2Fsettings%2Fmanageoneclick%3Fref_%3Dv1c_payment_method%23\x26openid.identity\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.assoc_handle\x3ditflex\x26openid.mode\x3dcheckid_setup\x26openid.ns.pape\x3dhttp%3A%2F%2Fspecs.openid.net%2Fextensions%2Fpape%2F1.0\x26openid.claimed_id\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.ns\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0")):
this._maybeHighFrictionCXWithPolicy2?(this.publishMetrics("BancomatPayHighFrictionCX.Redirect.AddMobileNumber.Policy2"),this.handleRedirectionToDevices("https://amazon.it/ap/signin?openid.assoc_handle\x3danywhere_v2_it\x26openid.mode\x3dcheckid_setup\x26openid.ns\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0\x26openid.pape.preferred_auth_policies\x3dEnforcePossessionOnMobileClaim\x26intercept\x3dfalse\x26openid.pape.max_auth_age\x3d0\x26openid.return_to\x3dhttps%3A%2F%2Fwww.amazon.it%2Fgp%2Fbuy%2Fpayselect%2Fhandlers%2Fdisplay.html%3F_from%3Dcheetah",
"https://amazon.it/ap/signin?openid.assoc_handle\x3danywhere_v2_it\x26openid.mode\x3dcheckid_setup\x26openid.ns\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0\x26openid.pape.preferred_auth_policies\x3dEnforcePossessionOnMobileClaim\x26intercept\x3dfalse\x26openid.pape.max_auth_age\x3d0\x26openid.return_to\x3dhttps%3A%2F%2Fwww.amazon.it%2Fgp%2Fbuy%2Fpayselect%2Fhandlers%2Fdisplay.html","https://amazon.it/ap/profile/mobilephone?orig_return_to\x3dhttps%3A%2F%2Fwww.amazon.it%2Fcpe%2Fyourpayments%2Fsettings%2Fmanageoneclick%3Fref_%3Dv1c_payment_method%23\x26openid.identity\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.assoc_handle\x3danywhere_v2_it\x26openid.mode\x3dcheckid_setup\x26openid.ns.pape\x3dhttp%3A%2F%2Fspecs.openid.net%2Fextensions%2Fpape%2F1.0\x26openid.claimed_id\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.ns\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0",
"https://amazon.it/ap/signin?openid.assoc_handle\x3ditflex\x26openid.mode\x3dcheckid_setup\x26openid.ns\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0\x26openid.pape.preferred_auth_policies\x3dEnforcePossessionOnMobileClaim\x26intercept\x3dfalse\x26openid.pape.max_auth_age\x3d0\x26openid.return_to\x3dhttps%3A%2F%2Fwww.amazon.it%2Fgp%2Fbuy%2Fpayselect%2Fhandlers%2Fdisplay.html%3F_from%3Dcheetah","https://amazon.it/ap/signin?openid.assoc_handle\x3ditflex\x26openid.mode\x3dcheckid_setup\x26openid.ns\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0\x26openid.pape.preferred_auth_policies\x3dEnforcePossessionOnMobileClaim\x26intercept\x3dfalse\x26openid.pape.max_auth_age\x3d0\x26openid.return_to\x3dhttps%3A%2F%2Fwww.amazon.it%2Fgp%2Fbuy%2Fpayselect%2Fhandlers%2Fdisplay.html",
"https://amazon.it/ap/profile/mobilephone?orig_return_to\x3dhttps%3A%2F%2Fwww.amazon.it%2Fcpe%2Fyourpayments%2Fsettings%2Fmanageoneclick%3Fref_%3Dv1c_payment_method%23\x26openid.identity\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.assoc_handle\x3ditflex\x26openid.mode\x3dcheckid_setup\x26openid.ns.pape\x3dhttp%3A%2F%2Fspecs.openid.net%2Fextensions%2Fpape%2F1.0\x26openid.claimed_id\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.ns\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0")):
(this.publishMetrics("BancomatPayHighFrictionCX.Redirect.AddMobileNumber.Policy1"),this._maybeEnableRedirectURLBuild?this.handleRedirectionToDevicesURLBuild():this.handleRedirectionToDevices("https://amazon.it/ap/profile/mobilephone?orig_return_to\x3dhttps%3A%2F%2Fwww.amazon.it%2Fgp%2Fbuy%2Fpayselect%2Fhandlers%2Fdisplay.html%23\x26openid.identity\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.assoc_handle\x3danywhere_v2_it\x26openid.mode\x3dcheckid_setup\x26openid.ns.pape\x3dhttp%3A%2F%2Fspecs.openid.net%2Fextensions%2Fpape%2F1.0\x26openid.claimed_id\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.ns\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0",
"https://amazon.it/ap/profile/mobilephone?orig_return_to\x3dhttps%3A%2F%2Fwww.amazon.it%2Fcpe%2Fyourpayments%2Fwallet%3Fref_%3Dya_d_c_pmt_mpo\x26openid.identity\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.assoc_handle\x3danywhere_v2_it\x26openid.mode\x3dcheckid_setup\x26openid.ns.pape\x3dhttp%3A%2F%2Fspecs.openid.net%2Fextensions%2Fpape%2F1.0\x26openid.claimed_id\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.ns\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0",
"https://amazon.it/ap/profile/mobilephone?orig_return_to\x3dhttps%3A%2F%2Fwww.amazon.it%2Fcpe%2Fyourpayments%2Fsettings%2Fmanageoneclick%3Fref_%3Dv1c_payment_method%23\x26openid.identity\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.assoc_handle\x3danywhere_v2_it\x26openid.mode\x3dcheckid_setup\x26openid.ns.pape\x3dhttp%3A%2F%2Fspecs.openid.net%2Fextensions%2Fpape%2F1.0\x26openid.claimed_id\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.ns\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0",
"https://amazon.it/ap/profile/mobilephone?orig_return_to\x3dhttps%3A%2F%2Fwww.amazon.it%2Fgp%2Fbuy%2Fpayselect%2Fhandlers%2Fdisplay.html%23\x26openid.identity\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.assoc_handle\x3ditflex\x26openid.mode\x3dcheckid_setup\x26openid.ns.pape\x3dhttp%3A%2F%2Fspecs.openid.net%2Fextensions%2Fpape%2F1.0\x26openid.claimed_id\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.ns\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0",
"https://amazon.it/ap/profile/mobilephone?orig_return_to\x3dhttps%3A%2F%2Fwww.amazon.it%2Fcpe%2Fyourpayments%2Fwallet%3Fref_%3Dya_d_c_pmt_mpo\x26openid.identity\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.assoc_handle\x3ditflex\x26openid.mode\x3dcheckid_setup\x26openid.ns.pape\x3dhttp%3A%2F%2Fspecs.openid.net%2Fextensions%2Fpape%2F1.0\x26openid.claimed_id\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.ns\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0",
"https://amazon.it/ap/profile/mobilephone?orig_return_to\x3dhttps%3A%2F%2Fwww.amazon.it%2Fcpe%2Fyourpayments%2Fsettings%2Fmanageoneclick%3Fref_%3Dv1c_payment_method%23\x26openid.identity\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.assoc_handle\x3ditflex\x26openid.mode\x3dcheckid_setup\x26openid.ns.pape\x3dhttp%3A%2F%2Fspecs.openid.net%2Fextensions%2Fpape%2F1.0\x26openid.claimed_id\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.ns\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0"))},
handleRedirectionToDevices:function(a,b,c,f,d,e){"mobile"===this._deviceType?this.handleRedirectUrls(a,b,c):this.handleRedirectUrls(f,d,e)},handleRedirectionToDevicesURLBuild:function(){"mobile"===this._deviceType?this.handleRedirectUrlsBuilder("https://amazon.it/ap/profile/mobilephone?openid.identity\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.assoc_handle\x3danywhere_v2_it\x26openid.mode\x3dcheckid_setup\x26openid.ns.pape\x3dhttp%3A%2F%2Fspecs.openid.net%2Fextensions%2Fpape%2F1.0\x26openid.claimed_id\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.ns\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0\x26orig_return_to\x3d"):
this.handleRedirectUrlsBuilder("https://amazon.it/ap/profile/mobilephone?openid.identity\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.assoc_handle\x3ditflex\x26openid.mode\x3dcheckid_setup\x26openid.ns.pape\x3dhttp%3A%2F%2Fspecs.openid.net%2Fextensions%2Fpape%2F1.0\x26openid.claimed_id\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select\x26openid.ns\x3dhttp%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0\x26orig_return_to\x3d")},publishMetrics:function(a){m.logCounterMetric({feature:a,
resource:"_Count"});m.publishMetrics()},handleRedirectUrls:function(a,b,c){e.location.href="AmazonRetail"===this._clientProfile?a:"YA:OneClick"===this._clientProfile?c:b},handleRedirectUrlsBuilder:function(a){var b=encodeURIComponent(e.location.href);e.location.href="AmazonRetail"===this._clientProfile?a+b+"%23":a+b},switchPopovertoSAD:function(a){var b=this;b.resetBpayForm();b.form.resetErrors();this.getDOMElement("addBancomatPayPopOverContainer").hide();var c=b.getDOMElement("setPreferenceBancomatPayPopOverContainerId");
0<c.length?(l.when("a-modal").execute(function(a){if(a){var c=a.get("addBancomatPayPopOverDesktopName");a=a.get("addBancomatPayCompactPopoverName");c&&c.isActive()?b.changeWidth(c,"350px"):a&&a.isActive()&&b.changeWidth(a,"350px")}}),c.show()):(b.closeAllPopovers(),b.formActivityCompleteRefresh(a))},switchPopoverWidth:function(){var a=this;a.resetBpayForm();a.form.resetErrors();l.when("a-modal").execute(function(b){if(b){var c=b.get("addBancomatPayPopOverDesktopName");b=b.get("addBancomatPayCompactPopoverName");
c&&c.isActive()?a.changeWidth(c,"550px"):b&&b.isActive()&&a.changeWidth(b,"550px")}})},closeAllPopovers:function(){this.closeAddBancomatPayDesktopPopover();this.closeAddBancomatPayCompactPopover();this.closeAddBancomatPayMobilePopover()},formActivityCompleteRefresh:function(a){this.widget.createAjaxContinueSuccessHandler(null)(a)},closeAddBancomatPayDesktopPopover:function(){var a=this;a.resetBpayForm();a.form.resetErrors();l.when("a-modal").execute(function(b){b&&a.hideBancomatPayPopOver(b.get("addBancomatPayPopOverDesktopName"))})},
closeAddBancomatPayMobilePopover:function(){var a=this;a.resetBpayForm();a.form.resetErrors();l.when("a-secondary-view").execute(function(b){b&&a.hideBancomatPayPopOver(b.get("addBancomatPayPopOverMobileName"))})},closeAddBancomatPayCompactPopover:function(){var a=this;a.resetBpayForm();a.form.resetErrors();l.when("a-modal").execute(function(b){b&&a.hideBancomatPayPopOver(b.get("addBancomatPayCompactPopoverName"))})},hideBancomatPayPopOver:function(a){a&&(a.unlock(20),a.hide())},changeWidth:function(a,
b){a&&a.update({width:b}).lock(20).show()},resetBpayForm:function(){d("addBancomatPayJsPhoneNumberInputId").length&&d("addBancomatPayJsPhoneNumberInputId").val("");d("#addBancomatPayLinkSavedNumberId").prop("checked",!0).trigger("click")},lockPopover:function(){l.when("a-modal").execute(function(a){if(a){var b=a.get("addBancomatPayPopOverDesktopName");a=a.get("addBancomatPayCompactPopoverName");b?b.lock(20).show():a&&a.lock(20).show()}});l.when("a-secondary-view").execute(function(a){a&&(a=a.get("addBancomatPayPopOverMobileName"))&&
a.lock(20).show()})},handleSavedNumberRadioButtonClick:function(){d("#addBancomatPayLinkSavedNumberId").is(":checked")&&(this.getDOMElement("addBancomatPayLinkNewNumberIdBox").css({"background-color":"#F0F2F2"}),this.getDOMElement("addBancomatPayLinkSavedNumberIdBox").css({"background-color":"#FFF"}),this.getDOMElement("addBancomatPayJsPhoneNumberInputId").length?this.getDOMElement("addBancomatPayJsPhoneNumberInputId").prop("disabled",!0):(f.hideElement(this.getDOMElement("addBancomatPayRedirectButton")),
f.showElement(this.getDOMElement("addBancomatPaySubmitButton"))))},handleNewNumberRadioButtonClick:function(){d("#addBancomatPayLinkNewNumberId").is(":checked")&&(this.getDOMElement("addBancomatPayLinkSavedNumberIdBox").css({"background-color":"#F0F2F2"}),this.getDOMElement("addBancomatPayLinkNewNumberIdBox").css({"background-color":"#FFF"}),this.getDOMElement("addBancomatPayJsPhoneNumberInputId").length?this.getDOMElement("addBancomatPayJsPhoneNumberInputId").prop("disabled",!1):(f.showElement(this.getDOMElement("addBancomatPayRedirectButton")),
f.hideElement(this.getDOMElement("addBancomatPaySubmitButton"))))},verificationSuccessHandler:function(a){f.hideElement(this.getDOMElement("addBancomatPayJsSpinnerId"))},setPreferenceHandler:function(a){f.hideElement(this.getDOMElement("setPreferenceBancomatPayJsSpinnerId"));this.switchPopoverWidth();this.closeAllPopovers();this._addBancomatPayData?(this.formActivityCompleteRefresh(this._addBancomatPayData),this._addBancomatPayData=k):this.formActivityCompleteRefresh(a)},serializeObject:function(a){return h.reduce(a,
function(a,c){a[c.name]=c.value;return a},{})},_getToggleSwitchAuiElement:function(){var a=this,b=null;l.now("a-switch","jQuery").execute(function(c,f){c!==k&&f!==k&&(b=c.getSwitch(a.$toggleSwitch))});return b},pollPaymentMethodVerificationStatus:function(a){var b=this,c=b.serializeObject(a.submissionParameters),d={};b.lockPopover();d.queryParameters=b.widget._whitelistedQueryParameters(a.formElement.get(0).action);b._widgetState&&(c["ppw-widgetState"]=b._widgetState);b.widget.continueRequest(c,h.extend({},
d,{success:function(c){var d=c.additionalWidgetResponseData.additionalData;b._widgetState=d.serializedState;d&&"true"===String(d.widgetComplete)?(e.setTimeout(h.bind(b.verificationSuccessHandler,b,c),2E3),"true"===d.enableSetAsDefaultPopover?(b.publishMetrics("BancomatPay.SetAsDefault.FormEnabled"),b._paymentMethodId=d.paymentInstrumentId,b._addBancomatPayData=c,b.switchPopovertoSAD(c)):(b.closeAllPopovers(),e.setTimeout(h.bind(b.formActivityCompleteRefresh,b,c),2E3))):e.setTimeout(h.bind(b.pollPaymentMethodVerificationStatus,
b,a),100)},error:function(a){f.hideElement(b.getDOMElement("addBancomatPayJsSpinnerId"))}}))},setPreferenceBancomatPay:function(a){var b=this;a=b.serializeObject(a.submissionParameters);b._widgetState&&(a["ppw-widgetState"]=b._widgetState);b.widget.continueRequest(a,h.extend({success:function(a){e.setTimeout(h.bind(b.setPreferenceHandler,b,a),1E3)},error:function(a){b.setPreferenceHandler(a)}}))}})});g("components/BancomatPayDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport"],
function(e,d){return e.extend(d,{initialize:function(d,f){this._paymentMethodId=f.data.paymentMethodId;this._paymentMethodType=f.data.paymentMethodType},bindToElements:function(){this._bindEditPMLink()}})});g("components/BancomatPayEditComponent",["component","EditComponentSupport"],function(e,d){return e.extend(d,{initialize:function(e,f){d._initializePopover(e,f,this)},bindToEvents:function(){d._bindPopoverCloseButtonClickedEvent(this)}})});g("components/SelectableBancomatPayListComponent",["form-component"],
function(e){return e});g("components/SelectableBancomatPayListItemComponent",["components/SelectableDPMInstrumentListItemComponent","events/InstrumentRowSelectedEvent"],function(e,d){return e.extend({bindToEvents:function(){var e=this;if(this._isPreselected)this.widget.on("componentsInitialized",this,function(){this.widget.trigger(d,{instrumentId:this._instrumentId})});e.widget.on(d,e,function(d){e._instrumentRowSelected(d.instrumentId)})}})});g("components/BancomatPaySleeveItemSlotComponent",["component",
"PaymentMethodSleeveItemSlotComponentSupport"],function(e,d){return e.extend(d,{initialize:function(e,d){this._instrumentId=d.data.instrumentId}})})})()});
/* ******** */
(function(f){var g=window.AmazonUIPageJS||window.P,e=g._namespace||g.attributeErrors,c=e?e("APXWidgetsAssets@APXWidgets-ShopWithPoints","APXWidgetsAssets"):g;c.guardFatal?c.guardFatal(f)(c,window):c.execute(function(){f(c,window)})})(function(f,g,e){(function(){var c=PaymentsPortal2.modules.define;c("components/EligibleRewardsAccountComponent",["component","AUI!P","css-utils","jQuery"],function(c,k,b,g){var f=!1,h;return c.extend({toggleSpinner:function(a){b.toggleElement(this.getDOMElement("EligibleRewardsAccountSpinner"),
a)},showRegistrationPopover:function(){function a(a){a&&(a=a.get(b.data.popoverName))&&a.show()}var b=this;k.when("a-modal").execute(function(d){a(d)});k.when("a-secondary-view").execute(function(d){a(d)})},closeRegistrationPopover:function(){function a(a){b.isUsingOldAUI(b)&&h?h.$popover.find("button[data-action]\x3da-popover-close").trigger("click"):a&&(a=a.get(b.data.popoverName))&&a.hide()}var b=this;k.when("a-modal").execute(function(d){a(d)});k.when("a-secondary-view").execute(function(d){a(d)})},
showRegistrationFailureView:function(a){"mobile"===this.widget.options.deviceType&&this.getDOMElement("RegistrationHeader").addClass("a-color-tertiary");b.showElement(this.getDOMElement("RegistrationFailureContinue"));b.showElement(this.getDOMElement(a));b.showElement(this.getDOMElement("RegisterRewardsAccountFailureSection"));b.hideElement(this.getDOMElement("RewardsAccountRegistrationForm"))},resetRegistrationFormView:function(){"mobile"===this.widget.options.deviceType&&this.getDOMElement("RegistrationHeader").removeClass("a-color-tertiary");
b.hideElement(this.getDOMElement("RegistrationFailureContinue"));b.hideElement(this.getDOMElement("RegistrationErrorMessages").children());b.hideElement(this.getDOMElement("RegisterRewardsAccountFailureSection"));b.showElement(this.getDOMElement("RewardsAccountRegistrationForm"))},showValidationErrorMessage:function(a){b.showElement(this.getDOMElement(a));b.hideElement(this.getDOMElement("EligibleRewardsAccountSpinner"))},isRegistrationPostDataValid:function(a){return a["ppw-maybePostalCode"]===e||
(b.hideElement(this.getDOMElement(this.data.rewardsPostalCodeValidationErrorJsBindingKey)),this.isValidPostalCode(a["ppw-maybePostalCode"]))?a["ppw-maybeDobMonth"]===e||(b.hideElement(this.getDOMElement(this.data.rewardsMonthValidationErrorJsBindingKey)),this.isValidRange(a["ppw-maybeDobMonth"],1,12))?a["ppw-maybeDobDay"]!==e&&(b.hideElement(this.getDOMElement(this.data.rewardsDayValidationErrorJsBindingKey)),!this.isValidRange(a["ppw-maybeDobDay"],1,31))||a["ppw-maybeDobDay"]!==e&&a["ppw-maybeDobMonth"]!==
e&&(b.hideElement(this.getDOMElement(this.data.rewardsDayValidationErrorJsBindingKey)),!this.isValidMonthDayCombination(a["ppw-maybeDobMonth"],a["ppw-maybeDobDay"]))?(this.showValidationErrorMessage(this.data.rewardsDayValidationErrorJsBindingKey),!1):!0:(this.showValidationErrorMessage(this.data.rewardsMonthValidationErrorJsBindingKey),!1):(this.showValidationErrorMessage(this.data.rewardsPostalCodeValidationErrorJsBindingKey),!1)},isValidRange:function(a,b,d){return!!a&&!isNaN(a)&&a>=b&&a<=d},isValidMonthDayCombination:function(a,
b){var d=[31,29,31,30,31,30,31,31,30,31,30,31];return 0<b&&b<=d[a-1]},isValidPostalCode:function(a){return/^[a-zA-Z0-9 -]{3,20}$/.test(a)},populatePostData:function(){var a={"ppw-widgetState":this.widget.options.serializedState,"ppw-widgetEvent":"RewardsAccountRegisterEvent","ppw-piid":this.data.parentInstrumentId,"ppw-isApplyByDefault":this.getDOMElement("RewardsAccountApplyByDefaultCheckbox").find("input").prop("checked")};1===this.getDOMElement("RewardsAccountPostalCodeField").length&&(a["ppw-maybePostalCode"]=
this.getDOMElement("RewardsAccountPostalCodeField").val());1===this.getDOMElement("RewardsAccountDOBMonth").length&&(this.isUsingOldAUI(this)?a["ppw-maybeDobMonth"]=this.getDOMElement("RewardsAccountDOBMonth").val():a["ppw-maybeDobMonth"]=this.getDOMElement("RewardsAccountDOBMonth").find("option:selected").text());1===this.getDOMElement("RewardsAccountDOBDay").length&&(this.isUsingOldAUI(this)?a["ppw-maybeDobDay"]=this.getDOMElement("RewardsAccountDOBDay").val():a["ppw-maybeDobDay"]=this.getDOMElement("RewardsAccountDOBDay").find("option:selected").text());
return a},handleRegistrationFailure:function(a){switch(a.registrationStatus){case "INVALID_CREDENTIALS":if(a.maybeValidationFailureFieldName)if("BILLING_POSTAL_CODE"===a.maybeValidationFailureFieldName){this.showRegistrationFailureView("rewards_BadZip");break}else if("DATE_OF_BIRTH"===a.maybeValidationFailureFieldName){this.showRegistrationFailureView("rewards_BadDateOfBirth");break}this.showRegistrationFailureView("rewards_InvalidCredentials");break;case "NOT_ELIGIBLE":this.showRegistrationFailureView("rewards_CardNotEligible");
break;case "NOT_AUTHORIZED":this.showRegistrationFailureView("rewards_UnauthorizedRedeemer");break;case "LOCKED_OUT":this.showRegistrationFailureView("rewards_CardLocked");break;case "ACCOUNT_CLOSED":this.showRegistrationFailureView("rewards_AccountClosed");break;case "EXTERNAL_ACTION_REQUIRED":this.showRegistrationFailureView("rewards_ExternalActionRequired");break;default:this.showRegistrationFailureView("rewards_SystemUnavailable")}},isUsingOldAUI:function(a){return"desktop"===a.widget.options.deviceType&&
("Checkout"===a.widget.options.clientId||"ABCheckout"===a.widget.options.clientId||"ABCheckoutSharedPay"===a.widget.options.clientId)&&!a.data.isCompact},bindToElements:function(){var a=this;a.getDOMElement("DismissPopover").click(function(){a.closeRegistrationPopover()});a.getDOMElement("RegistrationFailureContinue").click(function(){a.closeRegistrationPopover()});a.getDOMElement("RewardsAccountRegistrationCall").click(function(c){b.showElement(a.getDOMElement("EligibleRewardsAccountSpinner"));c=
a.populatePostData();if(!a.isRegistrationPostDataValid(c))return!1;a.widget.continueRequest(c,{complete:function(){b.hideElement(a.getDOMElement("EligibleRewardsAccountSpinner"))},success:function(b){b=b.additionalWidgetResponseData.additionalData;b.registrationOutput?(b=JSON.parse(b.registrationOutput),"REGISTERED"===b.registrationStatus?(f=!0,a.closeRegistrationPopover()):a.handleRegistrationFailure(b)):b.validationError?a.showValidationErrorMessage(b.validationError):a.showRegistrationFailureView("rewards_SystemUnavailable")},
error:function(){a.showRegistrationFailureView("rewards_SystemUnavailable")}})})},bindToEvents:function(){var a=this;a.widget.on("addressChallengePassed",a,function(c){c.instrumentId===a.data.parentInstrumentId&&b.showElement(a.getDOMElement("MobileEligibleRewardsAccountSection"))});k.when("A").execute(function(c){c.on("a:popover:hide:"+a.data.popoverName,function(b){f&&(a.widget.submitFormAJAX({"ppw-widgetState":a.widget.options.serializedState,"ppw-widgetEvent":"RefreshEvent"}),f=!1)});c.on("a:popover:show:"+
a.data.popoverName,function(c){a.resetRegistrationFormView();a.isUsingOldAUI(a)&&(h=c.popover,c=h.$popover.find(".a-popover-inner"),a.getDOMElement("CheckoutDesktopPopoverContent").parent("div.a-popover-inner").length||c.html(""),g("#"+h.name).appendTo(c),b.showElement(g("#"+h.name)),h.updatePosition())})})}})})})()});
/* ******** */
(function(p){var q=window.AmazonUIPageJS||window.P,w=q._namespace||q.attributeErrors,l=w?w("APXWidgetsAssets@APXWidgets-PayWithBankAccount","APXWidgetsAssets"):q;l.guardFatal?l.guardFatal(p)(l,window):l.execute(function(){p(l,window)})})(function(p,q,w){(function(){var l=PaymentsPortal2.modules.define;l("components/PayWithBankAccountComponent","events/InstrumentRowSelectedEvent components/SimplePaymentOptionListItemComponent lang jQuery css-utils AUI!P ExecutionsWidgetUtils upi-redirection-util events/spinner-events clog events/SelectablePaymentOptionEvents sdkUtil upiEvents AwaitingEventStatusConstants events/InstrumentPreparedEvent events/ValidateInstrumentPreparationEvent events/AwaitInstrumentPreparedEvent events/PreparedInstrumentContinueErrorEvent upiEnums p2mIntentUtil eagerInitUtil commonUtil".split(" "),
function(l,q,h,e,c,p,F,y,A,d,x,N,n,m,G,H,I,J,g,K,L,M){var B,C,r,t,D=!1,E=!1,z,k;return q.extend({instrumentId:"",isDeviceSignatureValid:null,isUpiSavedHandleUsable:null,isPermanentDisabled:null,isUpiRegistrationEnabled:null,sdkCallStatus:null,instrumentPreparationStatus:null,isAwaitingInstrumentPrepare:null,continueClickTime:null,failureReason:null,errorMessage:null,isAIPSRedirectRequired:null,upiSavedHandleSelectedIndex:-1,upiP2MIntentSelectedAppName:"",upiP2MIntentSelectedAppPackageName:"",isUpiSavedHandleOriginallySelectable:null,
noOfSavedHandles:0,isPWBASelected:!1,_selectedPaymentMethod:"",isUpiIssuanceAPBMultiTenderEnabled:null,isAPBSelected:!1,isApxReloadEnabled:!1,isUpiSavedHandleAPBMultiTenderEligible:null,isUpiAIPSRedirectionWithMTEnabled:!1,$topBankAvailable:0,$allBankAvailable:0,$topBankList:"",$allBankList:"",$topBanksHeader:"",$allBanksHeader:"",$noBankFound:"",bottomSheetOpenTime:null,isUpiP2MIntentEnabled:!1,eagerInitNpciClWeblabTreatment:"",upiIntentApplicationMap:"",reloadPspOnReappear:!1,isUpiAcceptanceComponentDisplayable:!1,
isNomenclatureWave2Enabled:!1,initialize:function(a,b){this.isNomenclatureWave2Enabled=b.data.isNomenclatureWave2Enabled;this.instrumentId=b.data.instrumentId;this.paymentMethod=b.data.paymentMethod;this.savedHandleInstrumentType=b.data.savedHandleInstrumentType;this.isUpiSavedHandlePresent=b.data.isUpiSavedHandlePresent;this.$form=e(".pmts-select-payment-instrument-form");this.netBankingInstrumentRowSelectionValue=b.data.netBankingInstrumentRowSelectionValue;this.upiOtherPMInstrumentRowSelectionValue=
b.data.upiOtherPMInstrumentRowSelectionValue;this.upiP2MIntentInstrumentRowSelectionValue=b.data.upiP2MIntentInstrumentRowSelectionValue;this.upiSavedHandleInstrumentRowSelectionValue=b.data.upiSavedHandleInstrumentRowSelectionValue;this.upiRegistrationAction=b.data.upiRegistrationAction;this.upiAcceptanceAction=b.data.upiAcceptanceAction;this.upiRegistrationRedirectUrl=b.data.upiRegistrationRedirectUrl;this.upiRegistrationReturnUrl=b.data.upiRegistrationReturnUrl;this.upiRegistrationFailureReturnUrl=
b.data.upiRegistrationFailureReturnUrl;this.areReturnUrlsSentByClient=b.data.areReturnUrlsSentByClient;this.clientId=b.data.clientId;this.httpMethod=b.data.httpMethod;this.isPaylastEligible=b.data.isPaylastEligible;this.showFloatingContinueBarOnNonPaylastPSP=b.data.showFloatingContinueBarOnNonPaylastPSP;this.isSavedHandleUsable=b.data.isSavedHandleUsable;this.savedHandlesData=b.data.savedHandlesData;this.isUpiRegistrationEnabled=b.data.isUpiRegistrationEnabled;this.isSavedHandleOriginallySelectable=
b.data.isSavedHandleOriginallySelectable;this.handleSavedHandleContinueError=b.data.handleSavedHandleContinueError;this.noOfSavedHandles=Object.keys(this.savedHandlesData).length;this.failureReason=Array(this.noOfSavedHandles).fill(null);this.sdkCallStatus=Array(this.noOfSavedHandles).fill(g.SdkCallStatusEnum.Pending);this.instrumentPreparationStatus=Array(this.noOfSavedHandles).fill(m.Pending);this.errorMessage=Array(this.noOfSavedHandles).fill([this._buildErrorMessage()]);this.isAIPSRedirectRequired=
Array(this.noOfSavedHandles).fill(!1);this.isDeviceSignatureValid=Array(this.noOfSavedHandles).fill(!1);this.isUpiSavedHandleUsable=Array(this.noOfSavedHandles).fill(!1);this.isPermanentDisabled=Array(this.noOfSavedHandles).fill(!0);this.isAwaitingInstrumentPrepare=Array(this.noOfSavedHandles).fill(!1);this.isUpiIssuanceAPBMultiTenderEnabled=b.data.isUpiIssuanceAPBMultiTenderEnabled;this.isUpiSavedHandleAPBMultiTenderEligible=Array(this.noOfSavedHandles).fill(!1);this.isApxReloadEnabled=b.data.isApxReloadEnabled;
this.purchaseId=b.data.purchaseId;this.isPurchaseIdRequired=b.data.isPurchaseIdRequired;this.isUpiP2MIntentEnabled=b.data.isUpiP2MIntentEnabled;this.eagerInitNpciClWeblabTreatment=b.data.eagerInitNpciClWeblabTreatment;this.upiIntentApplicationMap=b.data.upiIntentApplicationMap;this.isUpiAcceptanceComponentDisplayable=b.data.isUpiAcceptanceComponentDisplayable;C=b.data.JsBindingRecurringInlineTextSectionUpi3P;E=b.data.isRecurringInlineMessageDisplayableUpi3P;B=b.data.JsBindingRecurringInlineTextSectionUpi1P;
D=b.data.isRecurringInlineMessageDisplayableUpi1P;this.reloadPspOnReappear=b.data.reloadPspOnReappear;this.isUpiAIPSRedirectionWithMTEnabled=b.data.isUpiAIPSRedirectionWithMTEnabled;z=this.upiIntentApplicationMap;if(this.isSavedHandleOriginallySelectable&&this.isSavedHandleUsable){this.isPermanentDisabled.fill(!1);this.isUpiSavedHandleAPBMultiTenderEligible.fill(this.isUpiIssuanceAPBMultiTenderEnabled);for(var f in h.keys(this.savedHandlesData))this.isUpiSavedHandleUsable[f]=this.savedHandlesData[f][2],
this.isUpiSavedHandleUsable[f]||this.setUPISavedHandleDisabled(!0,f)}else this.setUPISavedHandleDisabled(!0);this._selectedPaymentMethod="EMPTY_SELECTION";k=this.isNomenclatureWave2Enabled?e(".apx-pay-with-bank-bottom-sheet-selected-element-display-nomenclature"):e(".apx-pay-with-bank-bottom-sheet-selected-element-display")},bindToEvents:function(){var a=this;a.widget.on("componentsInitialized",a,function(){p.when("mash").execute(function(b){var f=M.getDevicePlatform();a.isUpiP2MIntentEnabled&&(b=
{intentFilterUri:"upi://pay",intentAppsList:Array.from(h.keys(z))},d.logCounterMetric({feature:"PWBA_GetIntentEligibleAppCallInitiated_"+f,resource:"_Count"}),K.getIntentEligibleApps(b,function(b){"SUCCESS"===b.status&&"SUCCESS"===b.responseCode?(d.logCounterMetric({feature:"PWBA_GetIntentEligibleAppsSuccess_"+f,resource:"_SuccessCount"}),a._displayUPIIntentApps(b)):(d.logCounterMetric({feature:"PWBA_GetIntentEligibleAppsFailure_"+f,resource:"_ErrorCount"}),d.logCounterMetric({feature:"PWBA_GetIntentEligibleAppsFailure_"+
b.responseCode+"_"+f,resource:"_ErrorCount"}),a._checkAndDisplayNoP2MIntentAppsAvailable())}),d.publishMetrics())})});a.widget.on(l,a,function(b){b.instrumentId===this.instrumentId?((this.isPaylastEligible||this.showFloatingContinueBarOnNonPaylastPSP)&&a._resetOrderTotalComputation(),a.isPWBASelected=!0,a._deselectInstrumentRowSelectionRadioButtons()):(a._getContainerElement().find("input[type\x3dradio]")&&a._getContainerElement().find("input[type\x3dradio]")[0]&&(a._getContainerElement().find("input[type\x3dradio]")[0].checked=
!1,this.isNomenclatureWave2Enabled&&a._getContainerElement().removeClass("pmts-selected")),this._toggleSelectedOption(!1),c.showElement(e(".apx-get-started-with-upi-message")),a.upiSavedHandleSelectedIndex=-1,a.isPWBASelected=!1,this._clearPwbaSavedHandleRadioButtons(),this._clearPwbaP2MIntentRadioButtons(),a._hidePWBAExistingSelectedLogo(a.upiP2MIntentSelectedAppName),a._toggleUpiP2MIntentSubMessage(!0),c.showElement(e(".apx-pwba-gif-css")),a._selectedPaymentMethod="EMPTY_SELECTION",c.hideElement(r),
c.hideElement(t))});a.widget.on("submitFormAjaxStarted",a,function(b){a.isPWBASelected&&(this.getDOMElement("apx-pay-with-bank-account-bottom-sheet-content").addClass("apx-pwba-bottom-sheet-disabled"),c.showElement(this.getDOMElement("apx-pay-with-bank-account-bottom-sheet-spinner")))});a.widget.on("submitFormAjaxCompleted",a,function(a){this.getDOMElement("apx-pay-with-bank-account-bottom-sheet-content").removeClass("apx-pwba-bottom-sheet-disabled");c.hideElement(this.getDOMElement("apx-pay-with-bank-account-bottom-sheet-spinner"))});
a.widget.on(n.UpiIdValidateSuccessEvent,a,function(b){k&&k[0]&&(k[0].innerHTML=b.validatedUpiId,this._toggleSelectedOption(!0),c.hideElement(e(".apx-get-started-with-upi-message")),a._selectedPaymentMethod="UPI_3P",a._clearPwbaSavedHandleRadioButtons(),a._clearPwbaP2MIntentRadioButtons(),a._hidePWBAExistingSelectedLogo(a.upiP2MIntentSelectedAppName),a._toggleUpiP2MIntentSubMessage(!1),c.showElement(e(".apx-pwba-upi-acceptance-logo-css")),b.isUpiRecurringEligible&&E?c.showElement(t):c.hideElement(t),
b.shouldAutoCloseBottomSheet&&a._closeBottomSheet(!1),a._setInstrumentRowSelectionValue(a.upiOtherPMInstrumentRowSelectionValue),a._setHiddenInputInForm("__sif_encryptedVPA_collect",b.validatedUpiId),a._setHiddenInputInForm("upiSelectedAction",a.upiAcceptanceAction),a._setHiddenInputInForm("ppw-vpaToken",b.vpaToken),a._setHiddenInputInForm("ppw-paymentMethodId",b.paymentMethodId),a._selectRadioButton(),a._triggerPaymentPlanSelectedEvent(!0,null,null,a.paymentMethod))});a.widget.on("apbSelectionChanged",
a,function(b){b.isSelected?c.showElement(e(".apx_pay_with_bank_apb_deselection_message")):c.hideElement(e(".apx_pay_with_bank_apb_deselection_message"));a.isAPBSelected=b.isSelected;for(var f in h.keys(this.savedHandlesData))a._setAPBSelectionChanged(a.isAPBSelected,f)});a.widget.on(n.UPIIssuanceSupportedEventName,a,function(){a._toggleUPISavedHandleHeading(!0);a._toggleUPISavedHandle(!0)});a.widget.on(n.UPIIssuanceNotSupportedEventName,a,function(){a._toggleUPISavedHandleHeading(!1);a._toggleUPISavedHandle(!1)});
a.widget.on(n.NoDevicePermissionsEventName,a,function(){if(a.isSavedHandleUsable)for(var b in h.keys(this.savedHandlesData))a.isUpiSavedHandleUsable[b]&&(a.sdkCallStatus[b]=g.SdkCallStatusEnum.Completed,a.isAIPSRedirectRequired[b]=!0,a._updateFlagsAndWidgetStateOnTerminalSdkResponse(b))});a.widget.on(n.ErrorEventName,a,function(){for(var b in h.keys(this.savedHandlesData))a.sdkCallStatus[b]=g.SdkCallStatusEnum.Error,a.isAIPSRedirectRequired[b]=!1,a._updateFlagsAndWidgetStateOnTerminalSdkResponse(b);
a._deselectAndDisableUPISavedHandle()});a.widget.on(n.DeviceSignatureMatchesEventName,a,function(b,f){for(var c in h.keys(this.savedHandlesData))a.isSavedHandleUsable&&c===b&&a.isUpiSavedHandleUsable[c]&&(a.sdkCallStatus[c]=g.SdkCallStatusEnum.Completed,a.isDeviceSignatureValid[c]=a.savedHandlesData[c][0]===f,a.isAIPSRedirectRequired[c]=!(a.isDeviceSignatureValid[c]&&a.savedHandlesData[c][1]),a._updateFlagsAndWidgetStateOnTerminalSdkResponse(c))});a.widget.on(n.DeviceSignatureDoesNotMatchEventName,
a,function(b){for(var c in h.keys(this.savedHandlesData))a.isSavedHandleUsable&&c===b&&a.isUpiSavedHandleUsable[c]&&(a.sdkCallStatus[c]=g.SdkCallStatusEnum.Completed,a.isDeviceSignatureValid[c]=!1,a.isAIPSRedirectRequired[c]=!0,a._updateFlagsAndWidgetStateOnTerminalSdkResponse(c))});a.widget.on(H,a,function(b){a.isSavedHandleOriginallySelectable&&a.isPWBASelected&&-1!==a.upiSavedHandleSelectedIndex&&(a.instrumentPreparationStatus[a.upiSavedHandleSelectedIndex]===m.Pending?(a.widget.trigger(I,{errorMessage:a.errorMessage[a.upiSavedHandleSelectedIndex]}),
a.isAwaitingInstrumentPrepare[a.upiSavedHandleSelectedIndex]=!0):(a.isAwaitingInstrumentPrepare[a.upiSavedHandleSelectedIndex]=!0,a._triggerInstrumentPreparedEvent(a.upiSavedHandleSelectedIndex),a.isAwaitingInstrumentPrepare[a.upiSavedHandleSelectedIndex]=!1))});a.widget.on(J,a,function(b){a.handleSavedHandleContinueError&&a.isPWBASelected&&-1!==a.upiSavedHandleSelectedIndex&&a._handlePreparedInstrumentContinueError(b.reason?b.reason:m.UnknownFailure)});h.forEach(["ContinueButtonClicked","SecondaryContinueButtonClicked",
"CompleteWidget"],function(b){a.widget.on(b,a,function(b){a.isSavedHandleOriginallySelectable&&a.isPWBASelected&&-1!==a.upiSavedHandleSelectedIndex?(a.continueClickTime=d.getCurrentTime(),d.logCounterMetric({feature:"PWBA_SavedHandleSelectedAtContinueClick",resource:"_Count"}),d.logCounterMetric({feature:"PWBA_SavedHandleSelectedAtContinueClick_Index"+a.upiSavedHandleSelectedIndex,resource:"_Count"}),d.publishMetrics()):a.continueClickTime=null;"UPI_P2M_INTENT"===a._selectedPaymentMethod&&(b="PWBA_UpiP2MIntentAppSelectedAtContinueClick_"+
a.upiP2MIntentSelectedAppName,d.logCounterMetric({feature:"PWBA_UpiP2MIntentSelectedAtContinueClick",resource:"_Count"}),d.logCounterMetric({feature:b,resource:"_Count"}),d.publishMetrics());a._invokeEagerInitModule(!0)})});a.widget.on(n.UpiRedirectionContinueEventName,a,function(){var b=d.getCurrentTime();if(a.isPWBASelected&&-1!==a.upiSavedHandleSelectedIndex){a.widget.trigger(A.showSpinner);d.logCounterMetric({feature:"PWBA_SelectableUpiAipsRedirection",resource:"_Count"});d.logCounterMetric({feature:"PWBA_SelectableUpiAipsRedirection_Index"+
a.upiSavedHandleSelectedIndex,resource:"_Count"});var c=a._getUPIRedirectionData();this.isDeviceSignatureValid[this.upiSavedHandleSelectedIndex]?this.savedHandlesData[this.upiSavedHandleSelectedIndex][1]||(d.logCounterMetric({feature:"PWBA_SelectableUpiAipsRedirectionPinNotSet",resource:"_Count"}),y.upiPinNotSet(a._getSavedHandleInstrumentId(this.upiSavedHandleSelectedIndex),c.upiRequiredUrls,a.purchaseId,a.clientId,a.httpMethod,c.upiConditionalArguments)?(d.logCounterMetric({feature:"PWBA_SelectableUpiAipsRedirectionPinNotSet",
resource:"_SuccessCount"}),this.widget.publishSuccessSushiMetrics({ActionType:"PWBA_SelectableUpiAipsRedirectionPinNotSet",ActionValueType:"PaymentInstrument",ActionValue:String(a._getInstrumentId())})):(d.logCounterMetric({feature:"PWBA_SelectableUpiAipsRedirectionPinNotSet",resource:"_ErrorCount"}),this.widget.publishFailureSushiMetrics({ActionType:"PWBA_SelectableUpiAipsRedirectionPinNotSet",ActionValueType:"PaymentInstrument",ActionValue:String(a._getInstrumentId())})),d.logLatencyMetric({feature:"PWBA_SelectableUpiAipsRedirectionPinNotSet",
resource:"_Latency",startTime:b})):(d.logCounterMetric({feature:"PWBA_SelectableUpiAipsRedirectionDeviceSignatureMismatch",resource:"_Count"}),y.upiDeviceFingerprintDoesNotMatch(a._getSavedHandleInstrumentId(this.upiSavedHandleSelectedIndex),c.upiRequiredUrls,a.purchaseId,a.clientId,a.httpMethod,c.upiConditionalArguments)?(d.logCounterMetric({feature:"PWBA_SelectableUpiAipsRedirectionDeviceSignatureMismatch",resource:"_SuccessCount"}),this.widget.publishSuccessSushiMetrics({ActionType:"PWBA_SelectableUpiAipsRedirectionDeviceSignatureMismatch",
ActionValueType:"PaymentInstrument",ActionValue:String(a._getInstrumentId())})):(d.logCounterMetric({feature:"PWBA_SelectableUpiAipsRedirectionDeviceSignatureMismatch",resource:"_ErrorCount"}),this.widget.publishFailureSushiMetrics({ActionType:"PWBA_SelectableUpiAipsRedirectionDeviceSignatureMismatch",ActionValueType:"PaymentInstrument",ActionValue:String(a._getInstrumentId())})),d.logLatencyMetric({feature:"PWBA_SelectableUpiAipsRedirectionDeviceSignatureMismatch",resource:"_Latency",startTime:b}));
d.publishMetrics()}return!1})},_displayUPIIntentApps:function(a){if(a.upiIntentEligibleApps!==w&&0<a.upiIntentEligibleApps.length){for(var b=!1,f=0,u=new Set,v=0;v<a.upiIntentEligibleApps.length;v++)u.add(a.upiIntentEligibleApps[v].intentAppPackageName);h.forEachKeyValue(z,function(a,v){u.has(a)&&5>f&&(f++,d.logCounterMetric({feature:"PWBA_UPIP2MIntentAppCount_"+a,resource:"_Count"}),b=!0,c.showElement(e(".apx-pwba-p2m-indivisual-app-css-"+v)))});d.publishMetrics();b?(c.showElement(this.getDOMElement("apx-pay-with-bank-account-bottom-sheet-other-upi-apps-heading")),
c.hideElement(this.getDOMElement("apx-pay-with-bank-account-bottom-sheet-enter-upi-id-heading")),this.isUpiSavedHandlePresent?c.showElement(e(".apx-pwba-p2m-intent-heading-registered-customer")):c.showElement(e(".apx-pwba-p2m-intent-heading-non-registered-customer"))):this._checkAndDisplayNoP2MIntentAppsAvailable()}},_checkAndDisplayNoP2MIntentAppsAvailable:function(){this.isUpiAcceptanceComponentDisplayable||(c.showElement(this.getDOMElement("apx-pay-with-bank-account-bottom-sheet-other-upi-apps-heading")),
c.showElement(this.getDOMElement("apx-pay-with-bank-account-bottom-sheet-no-apps-available")))},_getUPIRedirectionData:function(){return{upiRequiredUrls:{redirectUrl:this.upiRegistrationRedirectUrl,returnUrl:this.upiRegistrationReturnUrl,failureReturnUrl:this.upiRegistrationFailureReturnUrl},upiConditionalArguments:{areReturnUrlsSentByClient:this.areReturnUrlsSentByClient,isPurchaseIdRequired:this.isPurchaseIdRequired,reloadPspOnReappear:this.reloadPspOnReappear}}},_toggleSelectedOption:function(a){a?
this.isNomenclatureWave2Enabled?c.showElement(e(".apx-pay-with-bank-bottom-sheet-selected-element-container-nomenclature")):c.showElement(e(".apx-pay-with-bank-bottom-sheet-selected-element-container")):this.isNomenclatureWave2Enabled?c.hideElement(e(".apx-pay-with-bank-bottom-sheet-selected-element-container-nomenclature")):c.hideElement(e(".apx-pay-with-bank-bottom-sheet-selected-element-container"))},_toggleUpiP2MIntentSubMessage:function(a){a?c.showElement(e(".apx-pwba-p2m-intent-sub-message")):
c.hideElement(e(".apx-pwba-p2m-intent-sub-message"))},_toggleUncheckAPBtoEnableUPIMessage:function(a,b){if(-1<b&&b<this.noOfSavedHandles)a?c.showElement(e(".apx_pay_with_bank_list_item_saved_handle_apb_deselection_message_"+b)):c.hideElement(e(".apx_pay_with_bank_list_item_saved_handle_apb_deselection_message_"+b));else for(var f in h.keys(this.savedHandlesData))a?c.showElement(e(".apx_pay_with_bank_list_item_saved_handle_apb_deselection_message_"+f)):c.hideElement(e(".apx_pay_with_bank_list_item_saved_handle_apb_deselection_message_"+
f))},_setAPBSelectionChanged:function(a,b){this._isActionNeededPostAPBSelectionChange(b)&&(this.isPWBASelected&&-1!==this.upiSavedHandleSelectedIndex&&a&&this._invalidatePaymentPlan(),this.setUPISavedHandleDisabled(a,b),a&&this.upiSavedHandleSelectedIndex==b&&(this._deselectAndDisableUPISavedHandle(),c.showElement(e(".apx-pwba-gif-css"))),this._toggleUncheckAPBtoEnableUPIMessage(a,b));this._setInstrumentPreparationStatus(b)},_isActionNeededPostAPBSelectionChange:function(a){return this.isUpiSavedHandleUsable[a]&&
!this.isPermanentDisabled[a]&&!this.isUpiSavedHandleAPBMultiTenderEligible[a]},_deselectAndDisableUPISavedHandle:function(){this.isPWBASelected&&-1!==this.upiSavedHandleSelectedIndex&&(this._toggleSelectedOption(!1),this._selectedPaymentMethod="EMPTY_SELECTION",this._getContainerElement().find("input[type\x3dradio]")[0].checked=!1,this.upiSavedHandleSelectedIndex=-1,this.isPWBASelected=!1,this._clearPwbaSavedHandleRadioButtons())},_getSavedHandleInstrumentId:function(a){return this.savedHandlesData[a][3].split("\x26")[0].split("\x3d")[1]},
_getOrElse:function(a,b){return a?a:b},_updateFlagsAndWidgetStateOnTerminalSdkResponse:function(a){this.isAIPSRedirectRequired[this._getOrElse(a,0)]?this.isUpiSavedHandleAPBMultiTenderEligible[a]=this.isUpiIssuanceAPBMultiTenderEnabled&&this.isUpiRegistrationEnabled&&(this.isApxReloadEnabled||this.isUpiAIPSRedirectionWithMTEnabled):this.isUpiSavedHandleAPBMultiTenderEligible[a]=this.isUpiIssuanceAPBMultiTenderEnabled;this._setInstrumentPreparationStatus(a);this._publishMetricsOnSdkCallCompletion(a);
this._invokeEagerInitModule(!0===this.isAwaitingInstrumentPrepare[a]);this._triggerInstrumentPreparedEvent(a);if(this.sdkCallStatus[this._getOrElse(a,0)]===g.SdkCallStatusEnum.Error||this.isAIPSRedirectRequired[this._getOrElse(a,0)]&&!this.isUpiRegistrationEnabled){var b=this.isAIPSRedirectRequired[this._getOrElse(a,0)]&&!this.isUpiRegistrationEnabled;this._setUPISavedHandleDisabled(b,a)}else this._setUPISavedHandleEnabled(a);this._setAPBSelectionChanged(this.isAPBSelected,a)},_setInstrumentPreparationStatus:function(a){this.sdkCallStatus[this._getOrElse(a,
0)]===g.SdkCallStatusEnum.Error?(this.instrumentPreparationStatus[this._getOrElse(a,0)]=m.Failure,this.failureReason[this._getOrElse(a,0)]=g.FailureReasonEnum.SdkError):this.isAIPSRedirectRequired[this._getOrElse(a,0)]&&!this.isUpiRegistrationEnabled?(this.instrumentPreparationStatus[this._getOrElse(a,0)]=m.Failure,this.failureReason[this._getOrElse(a,0)]=g.FailureReasonEnum.AIPSRedirectionNotEnabled):this.isPWBASelected&&-1!==this.upiSavedHandleSelectedIndex&&this.isAPBSelected&&!this.isUpiSavedHandleAPBMultiTenderEligible[a]?
(this.instrumentPreparationStatus[this._getOrElse(a,0)]=m.Failure,this.failureReason[this._getOrElse(a,0)]=g.FailureReasonEnum.MultitenderNotSupported):(this.sdkCallStatus[this._getOrElse(a,0)]===g.SdkCallStatusEnum.Pending?this.instrumentPreparationStatus[this._getOrElse(a,0)]=m.Pending:this.instrumentPreparationStatus[this._getOrElse(a,0)]=m.Success,this.failureReason[this._getOrElse(a,0)]=null);this.errorMessage[this._getOrElse(a,0)]=[this._buildErrorMessage(a)]},_buildErrorMessage:function(a){return this.handleSavedHandleContinueError&&
this.instrumentPreparationStatus[this._getOrElse(a,0)]!==m.Success?this.failureReason[this._getOrElse(a,0)]===g.FailureReasonEnum.SdkError?this.widget.getLocalizedString("apx_upi_savedHandle_continue_sdk_error"):this.failureReason[this._getOrElse(a,0)]===g.FailureReasonEnum.AIPSRedirectionNotEnabled?this.widget.getLocalizedString("apx_upi_savedHandle_continue_redirection_error"):this.failureReason[this._getOrElse(a,0)]===g.FailureReasonEnum.MultitenderNotSupported?this.widget.getLocalizedString("apx_upi_savedHandle_continue_multi_tender_error"):
this.widget.getLocalizedString("apx_upi_savedHandle_continue_error"):null},_publishMetricsOnSdkCallCompletion:function(a){if(this.isSavedHandleOriginallySelectable){var b=this.continueClickTime?"AfterContinue":"BeforeContinue";this.sdkCallStatus[this._getOrElse(a,0)]!==g.SdkCallStatusEnum.Completed||this.isAIPSRedirectRequired[this._getOrElse(a,0)]||d.logCounterMetric({feature:"PWBA_SavedHandleHappyCase_"+b,resource:"_Count"});this.sdkCallStatus[this._getOrElse(a,0)]===g.SdkCallStatusEnum.Completed&&
this.isAIPSRedirectRequired[this._getOrElse(a,0)]&&d.logCounterMetric({feature:"PWBA_SavedHandleUnhappyCase_"+b,resource:"_Count"});this.sdkCallStatus[this._getOrElse(a,0)]===g.SdkCallStatusEnum.Error&&d.logCounterMetric({feature:"PWBA_SavedHandleSdkError_"+b,resource:"_Count"});this.continueClickTime&&(this.sdkCallStatus[this._getOrElse(a,0)]===g.SdkCallStatusEnum.Error?d.logLatencyMetric({feature:"PWBA_SavedHandleSdkCallError_"+b,resource:"_Latency",startTime:this.continueClickTime}):d.logLatencyMetric({feature:"PWBA_SavedHandleSdkCallSuccess_"+
b,resource:"_Latency",startTime:this.continueClickTime}));d.publishMetrics()}},_triggerInstrumentPreparedEvent:function(a){this.isSavedHandleOriginallySelectable&&-1!==this.upiSavedHandleSelectedIndex&&this.isAwaitingInstrumentPrepare[this._getOrElse(a,0)]&&this.widget.trigger(G,{instrumentId:this._getSavedHandleInstrumentId(this.upiSavedHandleSelectedIndex),instrumentPreparationStatus:this.instrumentPreparationStatus[this._getOrElse(a,0)],isUpiRedirectionRequired:this._isUpiRedirectionRequired(this._getOrElse(a,
0)),failureReason:this.failureReason[this._getOrElse(a,0)],errorMessage:this.errorMessage[this._getOrElse(a,0)]})},_isUpiRedirectionRequired:function(a){return!1!==this.isAIPSRedirectRequired[a]},_invokeEagerInitModule:function(a){var b=this.isPWBASelected&&-1!==this.upiSavedHandleSelectedIndex,c,d,e;0<=this.upiSavedHandleSelectedIndex&&(c=this.sdkCallStatus[this.upiSavedHandleSelectedIndex],d=this.isAIPSRedirectRequired[this.upiSavedHandleSelectedIndex],e=this.savedHandlesData[this.upiSavedHandleSelectedIndex][5]);
L.performNpciClEagerInit(this.eagerInitNpciClWeblabTreatment,b,c,d,a,this._getMetadata(e))},_setUPISavedHandleDisabled:function(a,b){-1!==this.upiSavedHandleSelectedIndex&&this._invalidatePaymentPlan();-1<b&&b<this.noOfSavedHandles?this.isPermanentDisabled[b]=!0:this.isPermanentDisabled.fill(!0);this.setUPISavedHandleDisabled(!0,b);this._toggleUPIPermanentDisabledMessage(a,b)},_toggleUPIPermanentDisableMessageForSavedHandleIndex:function(a,b){a?c.showElement(this.getDOMElement("upiPermanentDisabledMessageContainer_pwba_sh_"+
b)):c.hideElement(this.getDOMElement("upiPermanentDisabledMessageContainer_pwba_sh_"+b))},_toggleUPIPermanentDisabledMessage:function(a,b){if(-1<b&&b<this.noOfSavedHandles)this._toggleUPIPermanentDisableMessageForSavedHandleIndex(a,b);else for(var c in h.keys(this.savedHandlesData))this._toggleUPIPermanentDisableMessageForSavedHandleIndex(a,c)},_setUPISavedHandleEnabled:function(a){this.isSavedHandleOriginallySelectable||(-1<a&&a<this.noOfSavedHandles?this.isPermanentDisabled[a]=!1:this.isPermanentDisabled.fill(!1),
this.setUPISavedHandleDisabled(!1,a))},setUPISavedHandleDisabledWithIndex:function(a,b){a?(this._getUPISavedHandleContainerElement(b).addClass("apx-disabled-bottom-sheet-line-item"),e(".apx-pwba-bottom-sheet-upi-tag-logo-t2").eq(b).addClass("apx-pwba-bottom-sheet-disabled"),e(".in-apx-psp-upi-ma-pwba-bank-logo-sprite-t3").eq(b).addClass("apx-pwba-bottom-sheet-disabled")):(this._getUPISavedHandleContainerElement(b).removeClass("apx-disabled-bottom-sheet-line-item"),e(".apx-pwba-bottom-sheet-upi-tag-logo-t2").eq(b).removeClass("apx-pwba-bottom-sheet-disabled"),
e(".in-apx-psp-upi-ma-pwba-bank-logo-sprite-t3").eq(b).removeClass("apx-pwba-bottom-sheet-disabled"))},setUPISavedHandleDisabled:function(a,b){if(-1<b&&b<this.noOfSavedHandles)this.setUPISavedHandleDisabledWithIndex(a,b);else for(var c in h.keys(this.savedHandlesData))this.setUPISavedHandleDisabledWithIndex(a,c)},_getUPISavedHandleContainerElement:function(a){return this.getDOMElement("savedHandle-list-item-"+a)},_invalidatePaymentPlan:function(){this.setContinuable(!1);this.widget.trigger(x.PaymentPlanSelected,
{isValid:!1})},_toggleUPISavedHandleHeading:function(a){a?c.showElement(this.getDOMElement("apx-pay-with-bank-registered-account-header-text")):c.hideElement(this.getDOMElement("apx-pay-with-bank-registered-account-header-text"))},_toggleUPISavedHandle:function(a){for(var b in h.keys(this.savedHandlesData))a?c.showElement(this._getUPISavedHandleContainerElement(b)):c.hideElement(this._getUPISavedHandleContainerElement(b))},_handlePreparedInstrumentContinueError:function(a){a===m.TimedOut&&(d.logCounterMetric({feature:"PWBA_SavedHandleSdkCallTimedOut",
resource:"_Count"}),d.publishMetrics());this.failureReason[this.upiSavedHandleSelectedIndex]===g.FailureReasonEnum.MultitenderNotSupported?this._setAPBSelectionChanged(this.isAPBSelected,this.upiSavedHandleSelectedIndex):this._setUPISavedHandleDisabled(!1,this.upiSavedHandleSelectedIndex);this.isAwaitingInstrumentPrepare[this.upiSavedHandleSelectedIndex]=!1;this._getContainerElement().find("input[type\x3dradio]")[0].checked=!1;this._deselectAndDisableUPISavedHandle()},bindToElements:function(){var a=
this;a.$topBanksList=this.getDOMElementsByPrefix("upiTopBanks-list-item-");a.$allBanksList=this.getDOMElementsByPrefix("upiAllBanks-list-item-");a.$topBanksHeader=this.getDOMElement("upiTopBanks-title");a.$allBanksHeader=this.getDOMElement("upiAllBanks-title");a.$noBankFoundText=this.getDOMElement("no-bank-found");var b=!1;r=this.getDOMElement(B);t=this.getDOMElement(C);p.when("A","a-sheet","ready").execute("bottom-sheet-events",function(f,e){1<document.querySelectorAll("#apx-pay-with-bank-account-bottom-sheet-content-id").length&&
(e=e.get("apx-pay-with-bank-account-bottom-sheet"))&&e.destroy();f.on("a:sheet:beforeShow:apx-pay-with-bank-account-bottom-sheet",function(b){c.hideElement(a.getDOMElement("upiBanksListContent"));c.hideElement(a.getDOMElement("netBankingContent"));c.hideElement(a.getDOMElement("upi3PContent"));a._loadUPIViewInBottomSheet();a._scrollToTopOfBottomSheet();a.bottomSheetOpenTime=d.getCurrentTime();a.widget.publishSuccessSushiMetrics({ActionType:"UpiSearchBankStart",ActionValueType:"UpiSearchBank",ActionParentValueType:"OtherUpiPaymentMethod",
ActionParentValue:"PayWithBankAccount"})});f.declarative("bankSearchDeclarativeAction","keyup",function(){b=!0;a.$topBankAvailable=0;a.$allBankAvailable=0;var e,u=a.getDOMElement("search-bank-text-box-input").val().toUpperCase();h.forEach(a.$topBanksList,function(b){e=b.getElementsByClassName("apx-net-banking-element-name-section")[0].innerHTML.toUpperCase();b.classList.add("aok-offscreen");f.contains(e,u)&&(b.classList.remove("aok-offscreen"),a.$topBankAvailable++)});h.forEach(a.$allBanksList,function(b){e=
b.getElementsByClassName("apx-net-banking-element-name-section")[0].innerHTML.toUpperCase();b.classList.add("aok-offscreen");f.contains(e,u)&&(b.classList.remove("aok-offscreen"),a.$allBankAvailable++)});0===a.$topBankAvailable?a.$topBanksHeader.addClass("aok-offscreen"):a.$topBanksHeader.removeClass("aok-offscreen");0===a.$allBankAvailable?a.$allBanksHeader.addClass("aok-offscreen"):a.$allBanksHeader.removeClass("aok-offscreen");0===a.$topBankAvailable&&0===a.$allBankAvailable?(c.showElement(a.$noBankFoundText),
d.logCounterMetric({feature:"PWBA_NoBankFoundWhenSearchBoxUsed",resource:"_ErrorCount"}),d.publishMetrics(),a.widget.publishFailureSushiMetrics({ActionType:"UpiSearchBankInProgress",ActionValueType:"UpiSearchBank",ActionValue:"BankNotFoundInList",ActionErrorCode:"NO_BANK_FOUND",ActionParentValueType:"OtherUpiPaymentMethod",ActionParentValue:"PayWithBankAccount"})):c.hideElement(a.$noBankFoundText)});f.on("a:sheet:beforeHide:apx-pay-with-bank-account-bottom-sheet",function(b){"EMPTY_SELECTION"===a._selectedPaymentMethod?
(b=a.widget.getLocalizedString("pmts_portal_payselect_empty_instrument_selection"),a._triggerPaymentPlanSelectedEvent(!1,b,b,null),a._getContainerElement().find("input[type\x3dradio]")&&a._getContainerElement().find("input[type\x3dradio]")[0]&&(a._getContainerElement().find("input[type\x3dradio]")[0].checked=!1,a._getContainerElement().find("input[type\x3dradio]")[0].blur(),this.isNomenclatureWave2Enabled&&a._getContainerElement().removeClass("pmts-selected"))):a._selectRadioButton()})});a._getContainerElement().click(function(b){a._triggerInstrumentRowSelectedEvent()});
h.forEach(["upiTopBanks-list-item-","upiAllBanks-list-item-"],function(f){a.getDOMElementsByPrefix(f).click(function(f){d.logLatencyMetric({feature:"PayWithBankAccountBottomSheet",resource:"_Latency",startTime:this.bottomSheetOpenTime});b?d.logCounterMetric({feature:"PWBA_BankSelectCompletedUsingSearchBox",resource:"_SuccessCount"}):d.logCounterMetric({feature:"PWBA_BankSelectCompletedWithoutUsingSearchBox",resource:"_SuccessCount"});d.publishMetrics();if(k&&k[0]){k[0].innerHTML=f.srcElement.innerText;
a._toggleSelectedOption(!0);c.showElement(e(".apx-get-started-with-upi-message"));a._selectedPaymentMethod="UPI_REGISTRATION";a._clearPwbaSavedHandleRadioButtons();a._clearPwbaP2MIntentRadioButtons();a._hidePWBAExistingSelectedLogo(a.upiP2MIntentSelectedAppName);a._toggleUpiP2MIntentSubMessage(!1);a._closeBottomSheet(!1);a.upiSavedHandleSelectedIndex=-1;var g=e(f.currentTarget);f=g&&g.data("bank-code")?g.data("bank-code"):"";var g=g&&g[0].innerText?g[0].innerText:"",h;a.getDOMElement("search-bank-text-box-input").val()&&
(h=a.getDOMElement("search-bank-text-box-input").val().length);b?a.widget.publishSuccessSushiMetrics({ActionType:"UpiSearchBankComplete",ActionValueType:"UpiSearchBank",ActionValue:"BankSelectionUsingSearchBox",ActionErrorCode:g+" inputSize "+h,ActionParentValueType:"OtherUpiPaymentMethod",ActionParentValue:"PayWithBankAccount"}):a.widget.publishSuccessSushiMetrics({ActionType:"UpiSearchBankComplete",ActionValueType:"UpiSearchBank",ActionValue:"BankSelectionWithoutUsingSearchBox",ActionErrorCode:g,
ActionParentValueType:"OtherUpiPaymentMethod",ActionParentValue:"PayWithBankAccount"});b=!1;a._setInstrumentRowSelectionValue(a.upiOtherPMInstrumentRowSelectionValue);a._setHiddenInputInForm("upiSelectedAction",a.upiRegistrationAction);a._setHiddenInputInForm("ppw-upiRegistrationSelectedBank",f);a._selectRadioButton();a._handleUPIRedirectionForRegistration(f)}})});a.getDOMElement("moreOptionsToPay-list-item-NetBanking").click(function(b){c.hideElement(a.getDOMElement("upiUnregisteredContent"));c.hideElement(a.getDOMElement("upiRegisteredContent"));
c.showElement(a.getDOMElement("netBankingContent"));a._scrollToTopOfBottomSheet();a.upiSavedHandleSelectedIndex=-1});a.getDOMElement("moreOptionsToPay-list-item-3PUPI").click(function(b){c.hideElement(a.getDOMElement("upiUnregisteredContent"));c.hideElement(a.getDOMElement("upiRegisteredContent"));c.showElement(a.getDOMElement("upi3PContent"));(b=e(".validate-upi-component-container").find("input[name\x3d__sif_encryptedVPA_collect]"))&&b.focus();a.upiSavedHandleSelectedIndex=-1});a.getDOMElement("apx-pay-with-bank-bottom-sheet-net-banking-header-back-btn").click(function(b){c.hideElement(a.getDOMElement("netBankingContent"));
a._loadUPIViewInBottomSheet()});a.getDOMElement("apx-pay-with-bank-bottom-sheet-upi-3p-header-back-btn").click(function(b){c.hideElement(a.getDOMElement("upi3PContent"));a._loadUPIViewInBottomSheet()});a.getDOMElement("apx-pay-with-bank-bottom-sheet-upi-bank-list-header-back-btn").click(function(b){c.hideElement(a.getDOMElement("upiBanksListContent"));a._loadUPIViewInBottomSheet()});e(".apx-pwba-bottom-sheet-tab-heading").click(function(b){a._scrollToTopOfBottomSheet()});a.getDOMElementsByPrefix("apx-bottom-sheet-scroll-to-top-button-").click(function(b){a._scrollToTopOfBottomSheet()});
a.getDOMElementsByPrefix("apx-bottom-sheet-link-bank-account-and-pay-button").click(function(b){c.hideElement(a.getDOMElement("upiUnregisteredContent"));c.showElement(a.getDOMElement("upiBanksListContent"))});h.forEach(["netBankingTopBanks-list-item-","netBankingAllBanks-list-item-"],function(b){a.getDOMElementsByPrefix(b).click(function(b){k&&k[0]&&(k[0].innerHTML=b.srcElement.innerText+" - Netbanking",a._toggleSelectedOption(!0),c.hideElement(e(".apx-get-started-with-upi-message")),a._selectedPaymentMethod=
"NET_BANKING",a._clearPwbaSavedHandleRadioButtons(),a._clearPwbaP2MIntentRadioButtons(),a._closeBottomSheet(!1),a.upiSavedHandleSelectedIndex=-1,b=(b=e(b.currentTarget))&&b.data("bank-code")?b.data("bank-code"):"",a._setInstrumentRowSelectionValue(a.netBankingInstrumentRowSelectionValue),a._setHiddenInputInForm("ppw-bankSelection_dropdown",b),a._selectRadioButton(),a._triggerPaymentPlanSelectedEvent(!0,null,null,a.paymentMethod))})});a.getDOMElementsByPrefix("savedHandle-list-item-").click(function(b){var d=
e(b.currentTarget);a.upiSavedHandleSelectedIndex=parseInt(d&&(d.data("saved-handle-index")||0===d.data("saved-handle-index"))?d.data("saved-handle-index"):"-1",10);!a.isSavedHandleUsable||-1===a.upiSavedHandleSelectedIndex||a.isPermanentDisabled[a.upiSavedHandleSelectedIndex]||!a.isUpiSavedHandleUsable[a.upiSavedHandleSelectedIndex]||a.isAPBSelected&&!a.isUpiSavedHandleAPBMultiTenderEligible[a.upiSavedHandleSelectedIndex]||(k&&k[0]&&(a._clearPwbaSavedHandleRadioButtons(),a._clearPwbaP2MIntentRadioButtons(),
a._hidePWBAExistingSelectedLogo(a.upiP2MIntentSelectedAppName),k[0].innerHTML=b.srcElement.querySelector(".apx-pwba-saved-handle-banking-details").innerText,b.srcElement.querySelector("#apx-pwba-input-id-saved-handle-radio-button").checked=!0,a._toggleSelectedOption(!0)),a._toggleUpiP2MIntentSubMessage(!1),a._selectedPaymentMethod="UPI_SAVED_HANDLE",a.savedHandlesData[a.upiSavedHandleSelectedIndex][4]&&D?c.showElement(r):c.hideElement(r),a._closeBottomSheet(!1),a._setInstrumentRowSelectionValue(a.savedHandlesData[a.upiSavedHandleSelectedIndex][3]),
a._selectRadioButton(),a._triggerBackingInstrumentSelectedEvent(),a._invokeEagerInitModule(!1))});a.isUpiP2MIntentEnabled&&a.getDOMElementsByPrefix("upiIntentApp-list-item-").click(function(b){var d=e(b.currentTarget);a._hidePWBAExistingSelectedLogo(a.upiP2MIntentSelectedAppName);a.upiP2MIntentSelectedAppName=d&&d.data("upi-intent-app-name")?d.data("upi-intent-app-name"):"";a.upiP2MIntentSelectedAppPackageName=d&&d.data("upi-intent-app-package-name")?d.data("upi-intent-app-package-name"):"";c.showElement(e(".apx-pwba-p2m-intent-app-selection-logo-css"+
a.upiP2MIntentSelectedAppName));k&&k[0]&&(a._clearPwbaP2MIntentRadioButtons(),a._clearPwbaSavedHandleRadioButtons(),k[0].innerHTML=b.target.querySelector(".apx-pwba-p2m-intent-app-details").innerText,b.target.querySelector("#apx-pwba-input-id-intent-app-radio-button").checked=!0);a._toggleSelectedOption(!0);a._toggleUpiP2MIntentSubMessage(!1);c.hideElement(e(".apx-get-started-with-upi-message"));a._selectedPaymentMethod="UPI_P2M_INTENT";a.upiSavedHandleSelectedIndex=-1;a._closeBottomSheet(!1);a._setInstrumentRowSelectionValue(a.upiP2MIntentInstrumentRowSelectionValue);
a._setHiddenInputInForm("ppw-upiIntentAppName",a.upiP2MIntentSelectedAppName);a._setHiddenInputInForm("ppw-upiIntentAppPackageName",a.upiP2MIntentSelectedAppPackageName);a._selectRadioButton();a._triggerPaymentPlanSelectedEvent(!0,null,null,a.paymentMethod)})},_hidePWBAExistingSelectedLogo:function(a){c.hideElement(e(".apx-pwba-gif-css"));c.hideElement(e(".apx-pwba-p2m-intent-app-selection-logo-css"+a));c.hideElement(e(".apx-pwba-upi-acceptance-logo-css"))},_clearPwbaSavedHandleRadioButtons:function(){for(var a=
document.querySelectorAll(".apx-pwba-radio-button-cx-align #apx-pwba-input-id-saved-handle-radio-button"),b=0;b<a.length;b++)a[b].checked=!1},_clearPwbaP2MIntentRadioButtons:function(){for(var a=document.querySelectorAll(".apx-pwba-radio-button-cx-align #apx-pwba-input-id-intent-app-radio-button"),b=0;b<a.length;b++)a[b].checked=!1},_deselectInstrumentRowSelectionRadioButtons:function(){h.forEach(e("input[type\x3dradio][name\x3dppw-instrumentRowSelection]"),function(a){a.checked=!1})},_triggerPaymentPlanSelectedEvent:function(a,
b,c,d){b={isValid:a,message:b,notValidReason:c,paymentMethod:d};this.widget.trigger(x.paymentPlanSelectedPrepare,b);this.setContinuable(a);this.widget.trigger(x.PaymentPlanSelected,b);this.widget.log({event:x.PaymentPlanSelected,details:b})},_triggerBackingInstrumentSelectedEvent:function(){this.widget.trigger("backingInstrumentSelected",{instrumentId:this._getSavedHandleInstrumentId(this.upiSavedHandleSelectedIndex),instrumentType:this.savedHandleInstrumentType,errors:[],paymentMethod:this.paymentMethod,
isUpiRedirectionRequired:this._isUpiRedirectionRequired(this.upiSavedHandleSelectedIndex)})},_setInstrumentRowSelectionValue:function(a){var b=this._getContainerElement().find("input[name\x3dppw-instrumentRowSelection]");b&&b[0]&&(b[0].value=a)},_setHiddenInputInForm:function(a,b){var c=this._getContainerElement().closest("form");if(c&&c[0]){var d=c[0].elements[a];d?d.value=b:c.append(F.buildHiddenInput(a,b))}},_getContainerElement:function(){return e(".pay-with-bank-account-container")},_handleUPIRedirectionForRegistration:function(a){var b=
d.getCurrentTime();this.widget.trigger(A.showSpinner);d.logCounterMetric({feature:"PWBA_UpiRegistrationRedirection",resource:"_Count"});var c=this._getUPIRedirectionData();y.upiRegistration(a,c.upiRequiredUrls,this.purchaseId,this.clientId,this.httpMethod,c.upiConditionalArguments)?(d.logCounterMetric({feature:"PWBA_UpiRegistrationRedirection",resource:"_SuccessCount"}),this.widget.publishSuccessSushiMetrics({ActionType:"PWBA_UpiRegistrationRedirection",ActionValueType:"PaymentInstrument",ActionValue:String(this._getInstrumentId())})):
(d.logCounterMetric({feature:"PWBA_UpiRegistrationRedirection",resource:"_ErrorCount"}),this.widget.publishFailureSushiMetrics({ActionType:"PWBA_UpiRegistrationRedirection",ActionValueType:"PaymentInstrument",ActionValue:String(this._getInstrumentId())}));d.logLatencyMetric({feature:"PWBA_UpiRegistrationRedirection",resource:"_Latency",startTime:b});d.publishMetrics()},_triggerInstrumentRowSelectedEvent:function(){this.widget.trigger(l,{instrumentId:this.instrumentId,paymentMethod:this.paymentMethod})},
_scrollToTopOfBottomSheet:function(){var a=this.getDOMElement("apx-pay-with-bank-bottom-sheet-top-marker");a&&a[0]&&a[0].scrollIntoView({behavior:"smooth"})},_closeBottomSheet:function(a){a||(c.hideElement(this.getDOMElement("upiBanksListContent")),c.hideElement(this.getDOMElement("netBankingContent")),c.hideElement(this.getDOMElement("upi3PContent")),this._loadUPIViewInBottomSheet());e(".a-sheet-close").click();if("NET_BANKING"===this._selectedPaymentMethod||"UPI_3P"===this._selectedPaymentMethod||
"UPI_P2M_INTENT"===this._selectedPaymentMethod||"EMPTY_SELECTION"===this._selectedPaymentMethod)c.hideElement(e(".apx_pay_with_bank_selected_element_apb_deselection_message")),this.setDisabled(!1);"UPI_SAVED_HANDLE"!==this._selectedPaymentMethod&&"UPI_3P"!==this._selectedPaymentMethod?(c.hideElement(r),c.hideElement(t)):"UPI_SAVED_HANDLE"===this._selectedPaymentMethod?c.hideElement(t):c.hideElement(r)},_loadUPIViewInBottomSheet:function(){this.isUpiSavedHandlePresent?c.showElement(this.getDOMElement("upiRegisteredContent")):
c.showElement(this.getDOMElement("upiUnregisteredContent"))},_resetOrderTotalComputation:function(){this.widget.trigger("UpdateOrderTotalForIBDEvent",{ibdAmountDisplayed:0});this.widget.trigger("UpdateOrderTotalForNoCostEMIDiscount",{noCostEMIValue:0})},_selectRadioButton:function(){this._getContainerElement().find("input[type\x3dradio]")&&this._getContainerElement().find("input[type\x3dradio]")[0]&&(this._getContainerElement().find("input[type\x3dradio]")[0].checked=!0);this.isNomenclatureWave2Enabled&&
this._getContainerElement().addClass("pmts-selected")},_getMetadata:function(a){return{clientName:"APX PWBA",clientId:this.clientId,merchantCustomerId:a}}})})})()});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("APXWidgetsAssets@APXWidgets-HealthBenefitsCard","APXWidgetsAssets"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){(function(){var a=PaymentsPortal2.modules.define;a("components/HealthBenefitsCardDetailsSlotComponent",["component","PaymentMethodDetailsSlotComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,b){this._paymentMethodId=b.data.paymentMethodId;
this._paymentMethodType=b.data.paymentMethodType},bindToElements:function(){this._bindEditPMLink()}})});a("components/HealthBenefitsCardSleeveItemSlotComponent",["component","PaymentMethodSleeveItemSlotComponentSupport"],function(a,b){return a.extend(b,{initialize:function(a,b){this._instrumentId=b.data.instrumentId}})})})()});
/* ******** */
