(function(h){var q=window.AmazonUIPageJS||window.P,p=q._namespace||q.attributeErrors,k=p?p("KYCxBorderAsset",""):q;k.guardFatal?k.guardFatal(h)(k,window):k.execute(function(){h(k,window)})})(function(h,q,p){h.when("A").register("kyc-xborder-state-register-data-files-module",function(){return{onKycXborderStateRegisterInit:function(k,m,g){h.when("A").execute(function(c){var b={};b[m]=k;c.state("sizeLimit",b)});h.when("A","kyc-form-validator","kyc-component-validator").execute(function(c,b,e){c=c.$;
var f=c("#"+g).find(".kyc-document-single-page").find(".page-uploaded-status");b.addValidator("#"+g,function(){return e.uploaderValidator(f,"#"+g,!0)});f.change(function(){e.uploaderValidator(f,"#"+g,!1)})});h.when("A","kyc-upload-controller","ready").execute(function(c,b){var e=c.$;e("#"+g).find(".kyc-document-single-page").find(".kyc-document-upload-text").click(function(c){var f=e(this).closest(".kyc-document-single-page");c.preventDefault();b.clickUploadLink(f)});e("#"+g).find(".kyc-document-single-page").find(".kyc-cancel-upload-link").click(function(){var c=
e(this).closest(".kyc-document-single-page");b.cancelUploading(c)});e("#"+g).find(".kyc-document-single-page").find(".kyc-document-upload-inputs").change(function(){var c=e(this).closest(".kyc-document-single-page");b.handleFileUpload(c)})})}}});h.when("A").register("kyc-xborder-select-input-controller-module",function(k){return{onKycXborderSelectControllerInit:function(k,g,c){h.when("A","jQuery","a-dropdown","kyc-form-validator","a-button").execute(function(b,e,f,n,m){function h(d){return 0===d.find("input[name\x3d'isLazyLoadDone']").length}
function r(d){"function"==typeof uet&&uet("bb","KYCxBorderWebAppService:LoadDynamicContent",{wb:1});var a=d.find(".lazy-load-field");e.ajax({url:c,type:"GET",data:a,dataType:"html",success:function(a){d.html(a);"function"==typeof uet&&uet("cf","KYCxBorderWebAppService:LoadDynamicContent",{wb:1});"function"==typeof uex&&uex("ld","KYCxBorderWebAppService:LoadDynamicContent",{wb:1});e("#kyc-xborder-radio-new").is(":checked")&&(m("#kyc-xborder-continue-button").disable(),e("#kyc-xborder-continue-btn-container").addClass("kyc-xborder-continue-btn-container-click-disabled"))},
error:function(a,d){"function"==typeof uet&&uet("cf","KYCxBorderWebAppService:LoadDynamicContent",{wb:1});"function"==typeof uex&&uex("ld","KYCxBorderWebAppService:LoadDynamicContent",{wb:1});e("#kyc_xborder_spinner_container_section").addClass("aok-hidden inactive");e("#kyc_xborder_lazy_load_failed_section").removeClass("aok-hidden inactive")}})}e=b.$;var l=k;l&&(f.getSelect("dropdown_0").val(l),f=e("#"+l),h(f)&&(f.removeClass("aok-hidden inactive"),r(f)));b.on("a:dropdown:selected:"+g,function(d){l&&
e("#"+l).addClass("aok-hidden inactive");l=d.value;d="#"+l;var a=e(d);a.removeClass("aok-hidden inactive");h(a)?r(a):n.validateForm(d)})});h.when("A","jQuery","a-dropdown","kyc-form-validator").execute(function(b,c,f,g){c(".kyc-xborder-page-form").submit(function(b){c(".inactive").remove()})})}}});h.when("A").register("kyc-xborder-upload-controller-module",function(k){return{onKycXborderUploadControllerInit:function(){h.when("A").execute(function(k){k=k.state("kycXborder");k!==p&&!0===k.isKycUploaderLoaded||
h.when("A","ready").register("kyc-upload-controller",function(g){function c(){return"undefined"!==typeof g.state("signInState")&&"undefined"!==typeof g.state("signInState").url?g.state("signInState").url:"/gp/sign-in.html"}function b(a){return a.find(".kyc-document-uploaded-successfully")}function e(a){return a.find(".kyc-document-uploaded-failed")}function f(a){return a.find(".kyc-document-uploading")}function k(a){return a.find(".kyc-document-page-input")}function h(a){return a.find("input[name\x3d'Custom-Timestamp']")}
function m(a){return a.find(".kyc-document-token")}function u(a){var d=10,c=g.state("sizeLimit");c!==p&&(a=a.parent()[0].id,0<c[a]&&(d=c[a]));return 1048576*d}function l(a){a=k(a);a[0].value=null;q.app&&(q.app.willReappear=function(){});E()?J(a):a.click()}function d(a){b(a).hide();e(a).hide();var d=(new Date).getTime();k(a).attr("name");h(a).val(d)}function a(a,d){m(a).val("");a.find(".page-uploaded-status").val(!1).trigger("change");F(a,d)}function t(a,d){d=d.parent();var c=a.find(".alexandria-field"),
b=c.clone(),e=a.find("iframe:first").attr("name");a=a.find(".uploadUrl")[0].value;var f=G("\x3cform\x3e\x3c/form\x3e");f.attr("method","post");f.attr("action",a);f.attr("target",e);f.attr("enctype","multipart/form-data");f.append(c);f.appendTo("body");f.submit();f.remove();d.append(b)}function D(a){f(a).show();a.find(".kyc-document-upload-text").hide()}function x(a){f(a).hide();a.find(".kyc-document-upload-text").html("undefined"!==typeof g.state("KYCxBorderLmsStrings")?g.state("KYCxBorderLmsStrings").reuploadVar:
"").show()}function v(a){k(a).attr("name");h(a).val("NOT_SET");f(a).hide();m(a).val()?b(a).show():b(a).hide();e(a).hide();a.find(".kyc-document-upload-text").show()}function z(a,d,c){d&&d.startsWith("urn:alx:")?("undefined"!==typeof ue&&ue&&ue.count("KYC_XBORDER:alexandriaUpload:success:all",(ue.count("KYC_XBORDER:alexandriaUpload:success:all")||0)+1),b(a).show(),a.find(".page-uploaded-status").val(!0).trigger("change"),m(a).val(d)):("ERROR204"===c?A("signInError"):B(c),H(a,c));x(a)}function C(a,
d){a=h(a).val();return a===d||"NOT_SET"!==a?!1:!0}function I(a,d){if(!C(a,d.passthroughFields["Custom-Timestamp"])){var c=k(a).attr("name"),b=d.documentUploadResponseList;b&&b.hasOwnProperty(c)&&(d=d.documentUploadResponseList[c],z(a,d.content.documentId,"SUCCESSFUL"!==d.status?d.content.errorCode:d.status))}}function F(a,d){$uploadedFailedElement=e(a);$uploadedFailedElement.find(".kyc-upload-error-alert").addClass("aok-hidden");$uploadedFailedElement.find(d).removeClass("aok-hidden");$uploadedFailedElement.show()}
function H(a,d){var b=".network-error";if("ERROR204"===d||"INVALID_SESSION"===d)"undefined"!==typeof c()&&(q.location.href=c());else if("BAD_REQUEST"===d||"ERROR_MIME_TYPE_VIOLATION"===d)b=".invalid-input-file-type";F(a,b);a.find(".page-uploaded-status").val(!1).trigger("change");e(a).show();m(a).val("")}function E(){return"undefined"!==typeof g.state("deviceType")&&"undefined"!==typeof g.state("deviceType").isAndroidApp?g.state("deviceType").isAndroidApp:0}function K(a,d,b){A("fileTransferError");
q.location.href=c()}function J(c){var b=c.closest(".kyc-document-single-page"),f="image/*",e=c.attr("accept");e.includes("application/pdf")&&L()&&(f="*/*");f={mimeType:f,capture:!1,maxSize:u(b),failCallback:function(d){switch(d.code){case 2:w("fileSizeExceeded");a(b,".invalid-input-file-size");break;case 4:w("unsupportedMimeType");a(b,".invalid-input-file-type");break;case 3:w("fileNotFound");a(b,".null-input-file");break;case 1001:w("permissionDenied");a(b,".permission-denied");break;case 1006:v(b);
break;default:w("others"),v(b)}},successCallback:function(d){try{if(M(d,c)){var f=(b.find(".uploadUrl")[0].value||"").startsWith("/v2");D(b);var g=b.find(".uploadUrl")[0].value,t=q.location.protocol+"//"+q.location.host+g,l=c.siblings(".alexandria-field");g={};for(var n=0;n<l.length;n++)g[l[n].name]=l[n].value;var h=new q.FileUploadOptions;h.headers={Referer:encodeURI(q.location.protocol+"//"+q.location.host),Accept:f?"text/html":"application/json"};h.fileKey=c.attr("name");h.fileName=d.substr(d.lastIndexOf("/")+
1);h.params=g;h.mimeType=e;h.chunkedMode=!1;(new q.FileTransfer).upload(d,encodeURI(t),function(d){if(f){var c=new DOMParser;try{var e=c.parseFromString(d.response,"text/html").getElementsByName("uploadResponse");if(e.length){var g=JSON.parse(e[0].getAttribute("value")).content;I(b,g)}}catch(N){B("generic"),a(b,".network-error"),x(b)}}else{e=/\{(.|\n|\r)+\}/;try{c=d.response.match(e);var t=JSON.parse(c[0]);if(!C(b,t["Custom-Timestamp"])){var l=k(b).attr("name"),n=t[l].status,h=t[l].documentVersionURN;
-1==t[l].claimedMIMEType.indexOf(t[l].inferredMIMEType)?(a(b,".invalid-input-file-type"),x(b)):z(b,h,n)}}catch(N){B("generic"),a(b,".network-error"),x(b)}}},K,h)}else w("unsupportedMimeType"),a(b,".invalid-input-file-type")}catch(R){a(b,".network-error")}}};d(b);q.amazon.mash.openFileChooser(f)}function M(a,d){var b=!1;try{var c=a.substr(a.lastIndexOf("/")+1),f=c.substr(c.lastIndexOf(".")+1).toLowerCase(),e=(d.attr("accept")||"").split(","),g;for(g in e)e[g].split("/")[1]===f&&(b=!0)}catch(P){b=!1}return b}
function L(){var a=document.cookie.split("; ").filter(function(a){return-1<a.indexOf("amzn-app-id")});return 0<a.length?(a=a[0].split("\x3d")[1].split("/")[1].split("."),1<a.length&&(24<a[0]||24==a[0]&&19<=a[1])):!1}function O(a){var d={isValid:!0,errorTag:null},b=k(a);try{var c=b[0],f=c.files[0],e=c.accept,g=f.type,t=f.size;if(!g||!e||-1===e.indexOf(g))return d.isValid=!1,d.errorTag=".invalid-input-file-type",d;if(t&&t>u(a))return d.isValid=!1,d.errorTag=".invalid-input-file-size",d}catch(Q){d.isValid=
!1,d.errorTag=".null-input-file"}return d}function B(a){"undefined"!==typeof ue&&ue&&(a&&""!==a&&(a="KYC_XBORDER:alexandriaUpload:failure:"+a,ue.count(a,(ue.count(a)||0)+1)),ue.count("KYC_XBORDER:alexandriaUpload:failure:all",(ue.count("KYC_XBORDER:alexandriaUpload:failure:all")||0)+1))}function A(a){"undefined"!==typeof ue&&ue&&(a&&""!==a&&(a="KYC_XBORDER:userInitiatedUpload:failure:"+a,ue.count(a,(ue.count(a)||0)+1)),ue.count("KYC_XBORDER:userInitiatedUpload:failure:all",(ue.count("KYC_XBORDER:userInitiatedUpload:failure:all")||
0)+1))}function w(a){"undefined"!==typeof ue&&ue&&(a&&""!==a&&(a="KYC_XBORDER:uploadValidation:failure:android:"+a,ue.count(a,(ue.count(a)||0)+1)),ue.count("KYC_XBORDER:uploadValidation:failure:android:all",(ue.count("KYC_XBORDER:uploadValidation:failure:android:all")||0)+1))}g.state("kycXborder",{isKycUploaderLoaded:!0});var G=g.$;return{handleUploadingResultFromIframe:function(a,d){a=G("[name\x3d'"+a+"']").closest(".kyc-document-single-page");if(d.hasOwnProperty("uploadResponse")){d=JSON.parse(d.uploadResponse.replace(/&#34;/g,
'"'));var b=d.type;"REQUEST_SUCCEEDED"===b?I(a,d.content):"REQUEST_FAILED"===b&&(H(a,d.content.errorCode),x(a))}else C(a,d["Custom-Timestamp"])||(b=k(a).attr("name"),d=d[b],z(a,d,d))},clickUploadLink:function(d){if(q.amazon&&q.amazon.mash&&q.amazon.mash.permissions&&q.amazon.mash.permissions.available)q.amazon.mash.permissions.requireForFeature({featureID:"know_your_customer",requestID:"media_permission"}).onPermissionGranted(function(){l(d)}).onPermissionDenied(function(){E()&&w("permissionDenied");
a(d,".permission-denied")});else l(d)},cancelUploading:v,handleFileUpload:function(b){var f=k(b);b.attr("id");f.attr("name");if(0!==f.val().length){d(b);var e=O(b);e.isValid?(t(b,f),D(b),setTimeout(function(){var a=b.find("iframe:first")[0].contentWindow.location.href;"undefined"!==typeof a&&0<=a.indexOf("/errors/400.html")&&(A("signatureExpired"),q.location.href=c())},3E3)):a(b,e.errorTag)}}}})})}}});h.when("A").register("kyc-xborder-validation-module",function(k){return{onKycXborderValidationInit:function(){h.when("A").execute(function(g){g=
g.state("kycXborder");g!==p&&!0===g.isKycComponentValidatorLoaded||h.when("A","a-text-input","a-dropdown","a-form-checkbox","kyc-form-validator","a-alert").register("kyc-component-validator",function(c,b,e,f,g,k){function h(){return"undefined"!==typeof c.state("KYCxBorderLmsStrings")?c.state("KYCxBorderLmsStrings").emptyTextComponent:""}var n=c.$;c.state("kycXborder",{isKycComponentValidatorLoaded:!0});return{checkboxValidator:function(b,d,a){var c=new f("[id\x3d"+d+"]"),e=!0;"true"!=c.data("required")||
c.isChecked()||(e=!1);a||(e?n("#"+d+"_alert").addClass("aok-hidden"):n("#"+d+"_alert").removeClass("aok-hidden"),g.validateForm("#"+b));return e},dropdownEmptyValidator:function(b,d,a){var c=""!=e.getSelect(d).val();a||(c?n("#"+d+"_alert").addClass("aok-hidden"):n("#"+d+"_alert").removeClass("aok-hidden"),g.validateForm("#"+b));return c},textboxValidator:function(f,d,a){var e=new b("[name\x3d"+d+"]",f),l=e.data("regex"),m=new RegExp(l);l=!0;var v="";""==e.val()?(l=!1,v=h()):m.test(e.val())||(l=!1,
v=-1!=d.indexOf("SAVE_ID_AS")?"undefined"!==typeof c.state("KYCxBorderLmsStrings")?c.state("KYCxBorderLmsStrings").invalidSaveIdAsComponent:"":"undefined"!==typeof c.state("KYCxBorderLmsStrings")?c.state("KYCxBorderLmsStrings").invalidTextComponent:"");a||(a=k(f+"_"+d+"_alert"),l?(a.text(""),n(f+"_"+d+"_alert").addClass("aok-hidden")):(a.text(v),n(f+"_"+d+"_alert").removeClass("aok-hidden")),g.validateForm(f));return l},cnPhoneNumberValidator:function(f,d,a){var e=new b("[name\x3d"+d+"]",f),l=!0,
h="",m=e.val();""==m||11!==m.length?(l=!1,h="undefined"!==typeof c.state("KYCxBorderLmsStrings")?c.state("KYCxBorderLmsStrings").invalidCnPhoneNumberLength:""):(e=e.val(),/^1\d{10}$/.test(e)||(l=!1,h="undefined"!==typeof c.state("KYCxBorderLmsStrings")?c.state("KYCxBorderLmsStrings").invalidCnPhoneNumberFormat:""));a||(a=k(f+"_"+d+"_alert"),l?(a.text(""),n(f+"_"+d+"_alert").addClass("aok-hidden")):(a.text(h),n(f+"_"+d+"_alert").removeClass("aok-hidden")),g.validateForm(f));return l},cnCitizenIdValidator:function(f,
d,a){var e=new b("[name\x3d"+d+"]",f),h=!0,l="",m=e.val();if(""==m||18!==m.length)h=!1,l="undefined"!==typeof c.state("KYCxBorderLmsStrings")?c.state("KYCxBorderLmsStrings").invalidCnCitizenIdLength:"";else if(m=e.val(),/(^\d{18}$)|(^\d{17}(\d|X|x)$)/.test(m)){m=e.val();var p=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2];e=m.substring(17);for(var q=0,r=0;r<p.length;r++){var y=p[r],u=parseInt(m.substring(r,r+1));q+=y*u}m="10x987654321".split("")[q%11];e.toLowerCase().valueOf()!=m.toLowerCase().valueOf()&&
(h=!1,l="undefined"!==typeof c.state("KYCxBorderLmsStrings")?c.state("KYCxBorderLmsStrings").invalidCnCitizenIdCheckBit:"")}else h=!1,l="undefined"!==typeof c.state("KYCxBorderLmsStrings")?c.state("KYCxBorderLmsStrings").invalidCnCitizenIdFormat:"";a||(a=k(f+"_"+d+"_alert"),h?(a.text(""),n(f+"_"+d+"_alert").addClass("aok-hidden")):(a.text(l),n(f+"_"+d+"_alert").removeClass("aok-hidden")),g.validateForm(f));return h},textEmptyValidator:function(c,d,a){var f=""!=(new b("[name\x3d"+d+"]",c)).val(),e=
h();a||(a=k(c+"_"+d+"_alert"),f?(a.text(""),n(c+"_"+d+"_alert").addClass("aok-hidden")):(a.text(e),n(c+"_"+d+"_alert").removeClass("aok-hidden")),g.validateForm(c));return f},dateValidator:function(b,d,a,c,f,e,k){b=b.val();d=d.val();a=a.val();var h=!1;b&&d&&a&&(b=new Date(b,d-1,a),a=new Date,h="FUTURE"==c?Date.parse(b)>Date.parse(a):"PAST"==c?Date.parse(b)<=Date.parse(a):!0);k||(h?n(f).addClass("aok-hidden"):n(f).removeClass("aok-hidden"),g.validateForm(e));return h},existingValidator:function(b){return e.getSelect("existing-kyc-dropdown").val()?
(b||g.validateForm("#kyc_xborder_existing_section"),!0):!1},uploaderValidator:function(b,d,a){var c=!0;b.each(function(){c="true"===n(this).val()&&c});a||g.validateForm(d);return c},skipForNow:function(){return!0},apayKYCValidator:function(){return!0}}})});h.when("A","kyc-section-select","kyc-form-validator","a-dropdown").execute(function(g,c,b,e){g.declarative("kyc-option-select","change",function(f){c.showSelectedSection(f.data.id);"kyc_xborder_existing_section"==f.data.id?b.validateForm("#kyc_xborder_existing_section"):
"kyc_xborder_add_section"==f.data.id?g.$("#kyc_xborder_device_not_support_status").value&&e.getSelect("dropdown_0").val()?b.validateForm("#"+e.getSelect("dropdown_0").val()):b.validateForm(""):"kyc_xborder_apay_section"==f.data.id?b.validateForm("#kyc_xborder_apay_section"):b.validateForm("#kyc_xborder_skip_section")})});h.when("A","address-section-select","kyc-form-validator").execute(function(g,c,b){g.declarative("address-option-select","change",function(e){c.showPupSelectedSection(e.data.id);"kyc_xborder_existing_address"===
e.data.id?b.validatePupForm("#kyc_xborder_existing_address"):"kyc_xborder_add_address_section"===e.data.id&&b.validatePupForm("#kyc_xborder_add_address_section")})});h.when("A","kyc-form-validator").execute(function(g,c){g.declarative("validate-consignee-address-pup","click",function(b){c.validateNewAddressFormData()&&c.validatePupForm("#kyc_xborder_add_address_section")});g.declarative("edit-consignee-address-pup","click",function(b){$=g.$;$("#kyc_xborder_pup_new_address_show_section").addClass("aok-hidden");
$("#kyc_xborder_pup_new_address_add").removeClass("aok-hidden")})});h.when("A").execute(function(g){var c=g.state("kycXborder");c!==p&&!0===c.isKycSectionSelectLoaded||h.when("A").register("kyc-section-select",function(b){var c=b.$;b.state("kycXborder",{isKycSectionSelectLoaded:!0});return{showSelectedSection:function(b){c("#kyc_xborder_skip_section, #kyc_xborder_add_section, #kyc_xborder_existing_section, #kyc_xborder_apay_section").addClass("aok-hidden");c("#kyc_xborder_skip_section_label, #kyc_xborder_add_section_label, #kyc_xborder_existing_section_label, #kyc_xborder_apay_kyc_section_label").removeClass("a-text-bold");
c("#"+b).removeClass("aok-hidden");c("#"+b+"_label").addClass("a-text-bold")}}});g=g.state("pupXborder");g!==p&&!0===g.isAddressSectionSelectLoaded||h.when("A").register("address-section-select",function(b){var c=b.$;b.state("pupXborder",{isAddressSectionSelectLoaded:!0});return{showPupSelectedSection:function(b){c("#kyc_xborder_existing_address, #kyc_xborder_add_address_section").addClass("aok-hidden");c("#kyc_xborder_existing_address_label, #kyc_xborder_add_address_section_label").removeClass("a-text-bold");
c("#"+b).removeClass("aok-hidden");c("#"+b+"_label").addClass("a-text-bold")}}})});var k={};h.when("A").execute(function(g){g=g.state("kycXborder");g!==p&&!0===g.isKycFormValidatorLoader||h.when("A","a-text-input","a-button","a-form","a-dropdown").register("kyc-form-validator",function(c,b,e,f,g){function h(){var d=l("#kyc-xborder-continue-btn-container");e("#kyc-xborder-continue-button").enable();d&&d.removeClass("kyc-xborder-continue-btn-container-click-disabled")}function n(){var d=l("#kyc-xborder-continue-btn-container");
e("#kyc-xborder-continue-button").disable();d&&d.addClass("kyc-xborder-continue-btn-container-click-disabled")}function m(){return c.state("kycXborderPageData").pageType===p?"#main-continue-form":"#kyc-collect-form"}var l=c.$;c.state("kycXborder",{isKycFormValidatorLoader:!0});return{addValidator:function(d,a){d in k||(k[d]=[]);k[d].push(a)},removeValidator:function(d,a){d in k&&(k[d]=k[d].filter(function(d){return d!==a}))},validateForm:function(d,a){if(d&&c.$(d).length){for(var b=!0,f=0;f<k[d].length;++f)k[d][f]()||
(b=!1);if(a!==p&&a)return b;b&&this.validatePupForCompleteForm()?h():n();return b}n();return!1},validatePupForCompleteForm:function(){if(!0===c.state("kycXborderPageData").isPupOrder){form=new f(m());var d=form.getRadioButton("#kyc-xborder-radio-existing-address");if(null!==d&&d.isChecked())return null!==g.getSelect("existing-address-dropdown").val();d=form.getRadioButton("#kyc-xborder-radio-new-address");if(null!==d&&d.isChecked())return this.validateNewAddressFormData()}else return!0},validatePupForm:function(d){var a;
if(!0===("#kyc_xborder_existing_address"===d?null!==g.getSelect("existing-address-dropdown").val():this.validateNewAddressFormData())){form=new f(m());d=form.getRadioButton("#kyc-xborder-radio-apay");null!==d&&d.isChecked()&&(a=this.validateForm("#kyc_xborder_apay_section",!0));d=form.getRadioButton("#kyc-xborder-radio-existing");null!==d&&d.isChecked()&&(a=this.validateForm("#kyc_xborder_existing_section",!0));d=form.getRadioButton("#kyc-xborder-radio-new");null!==d&&d.isChecked()&&(a=c.$("#kyc_xborder_device_not_support_status").value&&
g.getSelect("dropdown_0").val()?this.validateForm("#"+g.getSelect("dropdown_0").val(),!0):this.validateForm("",!0));d=form.getRadioButton("#kyc-xborder-radio-skip");null!==d&&d.isChecked()&&(a=this.validateForm("#kyc_xborder_skip_section",!0));if(!0===a)return h(),!0;n();return!1}n();return!1},validateNewAddressFormData:function(){var d=c.state("kycXborderPageData"),a=function(a){return a===p||0===a.length};form=new f(m());if(form.getRadioButton("#kyc-xborder-radio-new-address").isChecked()){var e=
"";d=d.countryCode;if(g.getSelect("address-ui-widgets-countryCode-dropdown-nativeId").val()!==d)return e=l("#kyc_invalid_pup_address_country").html(),l("#address-ui-widgets-addr-form-switch-alert-box").removeClass("aok-hidden"),l("#address-ui-widgets-addr-form-switch-alert-box").find(".a-section").html(e),n(),!1;l("#address-ui-widgets-addr-form-switch-alert-box").addClass("aok-hidden");e=e.concat('\x3ch5 id\x3d"address-ui-widgets-FullName"\x3e');d=new b("[name\x3daddress-ui-widgets-enterAddressFullName]");
if(a(d.val()))return l("#address-ui-widgets-full-name-special-characters-error").removeClass("aok-hidden"),n(),!1;l("#address-ui-widgets-full-name-special-characters-error").addClass("aok-hidden");e=e.concat(d.val(),"\x3c/h5\x3e");d=new b("[name\x3daddress-ui-widgets-enterAddressLine1]");a(d.val())||(e=e.concat(d.val(),"\x3cbr/\x3e"));d=new b("[name\x3daddress-ui-widgets-enterAddressLine2]");a(d.val())||(e=e.concat(d.val(),"\x3cbr/\x3e"));d=new b("[name\x3daddress-ui-widgets-enterAddressCity]");if(a(d.val()))return l("#address-ui-widgets-inline-city-error").removeClass("aok-hidden"),
n(),!1;l("#address-ui-widgets-inline-city-error").addClass("aok-hidden");e=e.concat(d.val(),"\x3cbr/\x3e");d=new b("[name\x3daddress-ui-widgets-enterAddressStateOrRegion]");if(a(d.val()))return l("#address-ui-widgets-inline-state-or-region-error").removeClass("aok-hidden"),n(),!1;l("#address-ui-widgets-inline-state-or-region-error").addClass("aok-hidden");e=e.concat(d.val()," ");d=new b("[name\x3daddress-ui-widgets-enterAddressPostalCode]");if(a(d.val()))return l("#address-ui-widgets-postalcode-error").removeClass("aok-hidden"),
n(),!1;l("#address-ui-widgets-postalcode-error").addClass("aok-hidden");e=e.concat(d.val(),"\x3cbr/\x3e");d=new b("[name\x3daddress-ui-widgets-enterAddressPhoneNumber]");if(a(d.val()))return l("#address-ui-widgets-phone-number-invalid-error").removeClass("aok-hidden"),n(),!1;l("#address-ui-widgets-phone-number-invalid-error").addClass("aok-hidden");a=document.getElementById("address-ui-widgets-countryCode-dropdown-nativeId").selectedIndex;a=document.getElementById("address-ui-widgets-countryCode-dropdown-nativeId").options[a].innerText;
e=e.concat(a);l("#kyc_xborder_pup_new_address_show_lines").html(e);l("#kyc_xborder_pup_new_address_show_section").removeClass("aok-hidden");l("#kyc_xborder_pup_new_address_add").addClass("aok-hidden")}h();return!0}}})});h.when("A").execute(function(g){g=g.state("kycXborder");g!==p&&!0===g.isThreeDropDownDateControllerLoader||h.when("A","kyc-component-validator").register("three-dropdown-date-controller",function(c,b){var e=c.$;c.state("kycXborder",{isThreeDropDownDateControllerLoader:!0});return c.createClass({init:function(b,
c,e,g,k,h,d,a){this.yearSelect=b;this.monthSelect=c;this.daySelect=e;this.errorAlert=g;this.validRange=k;this.dateType=h;this.hiddenDivName=d;this.kycDivID=a},updateDayDropdown:function(c,e,g){c=c&&e?(new Date(c,e,0)).getDate():null;if(c){(e=this.daySelect.getOptions())&&e.remove();e=[];if(c)for(var f=1;f<=c;f++)e.push({text:f,value:f});this.daySelect.addOptions(e);this.daySelect.update({status:"normal"});g&&(g<=c?this.daySelect.setValue(g):b.dateValidator(this.yearSelect,this.monthSelect,this.daySelect,
this.validRange,this.errorAlert,this.kycDivID,!1))}},populateDate:function(){if(this.monthSelect.val()&&this.yearSelect.val()&&this.daySelect.val()){var c=this.yearSelect.val()+"-"+this.monthSelect.val()+"-"+this.daySelect.val();e("input[name\x3d"+this.hiddenDivName+"]",this.kycDivID).val(c);b.dateValidator(this.yearSelect,this.monthSelect,this.daySelect,this.validRange,this.errorAlert,this.kycDivID,!1)}}})})});h.when("A","kyc-form-validator","kyc-component-validator").execute(function(g,c,b){c.addValidator("#kyc_xborder_skip_section",
function(){return b.skipForNow()})});h.when("A","kyc-form-validator","kyc-component-validator").execute(function(g,c,b){c.addValidator("#kyc_xborder_apay_section",function(){return b.apayKYCValidator()})});h.when("A","kyc-form-validator","a-text-input","kyc-component-validator").execute(function(g,c,b,e){c.addValidator("#kyc_xborder_existing_section",function(){return e.existingValidator(!0)});g.on("a:dropdown:existing-kyc-dropdown:select",function(b){e.existingValidator(!1)})});h.when("A","kyc-form-validator").execute(function(g,
c){g.on("a:dropdown:existing-address-dropdown:select",function(b){c.validatePupForm("#kyc_xborder_existing_address")})});h.when("A","page-transition-controller").execute(function(g,c){var b=g.$;b(document).delegate("form.kyc-checkout-page-form","submit",function(e){var f=e?b(e.currentTarget):void 0;c.blockAllActions();e=f.data("shrink-panel");f=f.data("loading-text");(e=b("#"+e))&&e.length?e.hasClass("expanded")||c.shrinkPanel(b(".spp-panel.expanded"),!1):e=b(".spp-panel.expanded");c.shrinkPanel(e,
!0,f)})})}}});h.when("A").register("kyc-xborder-main-workflow-module",function(k){return{onKycXborderMainWorkflowInit:function(){h.when("A","kyc-section-select","kyc-form-validator","kyc-component-validator").execute(function(k,g,c,b){if(k=k.state("kycXborderPageData")){b=k.defaultKycActionType;var e=k.selectExistingKyc;b!==p&&""!==b&&b===k.selectApayKYC?(g.showSelectedSection("kyc_xborder_apay_section"),c.validateForm("#kyc_xborder_apay_section")):b!==p&&""!==b&&b===e&&(g.showSelectedSection("kyc_xborder_existing_section"),
c.validateForm("#kyc_xborder_existing_section"))}});h.when("A","address-section-select","kyc-form-validator").execute(function(k,g,c){var b=k.state("kycXborderPageData");b?(k=b.addNewAddressChecked,"false"===k?(g.showPupSelectedSection("kyc_xborder_existing_address"),c.validatePupForm("#kyc_xborder_existing_address")):"true"===k&&(g.showPupSelectedSection("kyc_xborder_add_address_section"),c.validatePupForm("#kyc_xborder_add_address_section"))):($=k.$,$("#kyc-xborder-radio-existing-address").is(":checked")?
(g.showPupSelectedSection("kyc_xborder_existing_address"),c.validatePupForm("#kyc_xborder_existing_address")):$("#kyc-xborder-radio-new-address").is(":checked")&&(g.showPupSelectedSection("kyc_xborder_add_address_section"),c.validatePupForm("#kyc_xborder_add_address_section")))})}}});h.when("A").register("kyc-xborder-list-ids-module",function(){return{onKycXborderListIdsActionInit:function(){h.when("A","a-button","a-modal").execute(function(k,h){function g(){c(".popover-close").click()}var c=k.$;
k.declarative("unlink-kyc-id","click",function(b){var e=b.$target.attr("data-kycId");e!==p&&(b=b.$target.attr("data-addressId"),b!==p&&c.ajax({type:"POST",url:"/gp/kyc/xborder/handlers/unlink-address-kyc-handler.html",dataType:"json",data:{"kyc-xborder-selected-id":e,"kyc-xborder-address-id":b},beforeSend:g,success:function(b){c("#kycList").find("#savedId-"+e).remove();c("#updateSuccessMessageSpan").hide();c("#errorMessageSpan").hide();c("#deleteSuccessMessageSpan").show()},error:function(b){c("#updateSuccessMessageSpan").hide();
c("#deleteSuccessMessageSpan").hide();c("#errorMessageSpan").show()}}))});k.declarative("address-edit-kyc-id-desktop","click",function(b){var c=b.$target.attr("data-kycId");c!==p&&(b=b.$target.attr("data-addressId"),b!==p&&(q.location.href="/gp/kyc/xborder/editKycForAddress?kyc-xborder-selected-id\x3d"+c+"\x26kyc-xborder-address-id\x3d"+b))});k.declarative("address-edit-kyc-id-mobile","click",function(b){var c=b.$target.attr("data-kycId");c!==p&&(b=b.$target.attr("data-addressId"),b!==p&&(q.location.href=
"/gp/aw/kyc/xborder/editKycForAddress?kyc-xborder-selected-id\x3d"+c+"\x26kyc-xborder-address-id\x3d"+b))})})}}});h.when("A","ready").register("kyc-xborder-manage-kyc-module",function(){return{onKycXborderManageKycInit:function(){h.when("A","a-button","a-modal").execute(function(k,h){function g(){f(".popover-close").click()}h=k.state("kycXborderSavedIdPageData");var c="/gp/kyc/xborder/handlers/delete-kyc-handler.html",b="/gp/kyc/xborder/editKyc",e="/gp/aw/kyc/xborder/editKyc";h&&h.v2UrlEnabled&&(c=
h.v2DeleteUrl,e=b=h.v2EditUrl);var f=k.$;k.declarative("delete-kyc-id","click",function(b){var e=b.$target.attr("data-kycId");e!==p&&f.ajax({type:"POST",url:c,dataType:"json",data:{"kyc-xborder-selected-id":e},beforeSend:g,success:function(b){f("#kycList").find("#savedId-"+e).remove();f("#deleteSuccessMessageSpan").show()},error:function(b){f("#errorMessageSpan").show()}})});k.declarative("edit-kyc-id-desktop","click",function(c){c=c.$target.attr("data-kycId");c!==p&&(q.location.href=b+"?kyc-xborder-selected-id\x3d"+
c)});k.declarative("edit-kyc-id-mobile","click",function(b){b=b.$target.attr("data-kycId");b!==p&&(q.location.href=e+"?kyc-xborder-selected-id\x3d"+b)})})}}});h.when("A","ready").register("kyc-xborder-manage-kyc-module-cn",function(){return{onKycXborderManageKycInit:function(){h.when("A","a-checkbox","a-button","a-alert").execute(function(k,h,g,c){function b(a,b){a=a.value.split("_");return"address"==b?a[0]:a[1]}function e(a,c){var e=!1;d("input[name\x3d'address-link-input']").each(function(){b(this,
"kyc")==c&&this.checked&&(e=!0)});a=g("#link-address-button-"+c);e?a.enable():a.disable()}function f(){d(".popover-close").click();d("#kyc-management").css("opacity","0.5");d("#kyc-management").css("z-index","-1")}function n(a){401!=a.status&&(d("#kyc-management").css("opacity","1"),d("#kyc-management").css("z-index",""))}function m(a){401==a.status?k.delay(function(){q.location.reload(!0)},1E3):y(a)}function y(a){var b=c("#kyc-error-msg");a.isOK||(a.errorMessage?b.text(a.errorMessage).show():(a=
"undefined"!==typeof k.state("kycXborderSavedIdPageData")?k.state("kycXborderSavedIdPageData").serviceErrorMessage:"",a&&b.text(a).show()))}function u(a,b){var c=a.id.replace("kyc-address-pagination-",""),e=d(a).find(".a-pagination").find("li");e.each(function(){if(this!=e[0]&&this!=e[e.length-1]){var a=d(this).find("a");0<a.length&&(a[0].innerHTML==b?d(this).attr("class","a-selected"):d(this).attr("class",""))}});l(e[0],1!=b);l(e[e.length-1],b!=e.length-2);a=d(".kyc-address-book-page-"+c);a.each(function(){d(this).css("display",
"none")});d(a[b-1]).css("display","block")}function l(a,b){var c=d(a).find("a");0<c.length!=b&&(1==b?(a.innerHTML="\x3ca\x3e"+a.innerHTML+"\x3c/a\x3e",d(a).attr("class","")):(a.innerHTML=c[0].innerHTML,d(a).attr("class","a-disabled")))}var d=k.$;k.declarative("deleteKycItem","click",function(a){a=a.$target.data().kycid;a!==p&&d.ajax({type:"POST",url:"/aee/kyc/savedId/delete",dataType:"json",data:{"kyc-xborder-selected-id":a},beforeSend:f,complete:function(a){n(a)},success:function(){q.location.reload()},
error:function(a){m(a)}})});k.declarative("linkAddress","click",function(a){var c=a.$target.data().kycid;if(c!==p&&g("#link-address-button-"+c).isEnabled()){var e=[];d("input[name\x3d'address-link-input']").each(function(){b(this,"kyc")==c&&this.checked&&e.push(b(this,"address"))});d.ajax({type:"POST",url:"/aee/kyc/savedId/mapKycToAddresses",dataType:"json",data:{"kyc-xborder-selected-id":c,addressIdList:e.join(",")},beforeSend:f,complete:function(a){n(a)},success:function(){q.location.reload()},
error:function(a){m(a)}})}});k.declarative("unlinkAddress","click",function(a){var b=a.$target.data();a=b.kycid;b=b.addressid;a!==p&&b!==p&&d.ajax({type:"POST",url:"/aee/kyc/savedId/unlinkId",dataType:"json",data:{"kyc-xborder-selected-id":a,"kyc-xborder-address-id":b},beforeSend:f,complete:function(a){n(a)},success:function(){q.location.reload()},error:function(a){m(a)}})});k.on("a:popover:beforeShow",function(a){a=a.popover;if(0==a.name.indexOf("link-address-popover")){var c=h(".address-link-checkbox");
c.uncheck();g(".link-address-button").disable();d("input[name\x3d'address-link-input']").each(function(){var a=b(this,"kyc");this.onclick=function(){e(c,a)}});d(a.$popover).find(".kyc-address-pagination").each(function(){u(this,1)})}});k.declarative("kyc-address-book-page","click",function(a){if(a.data!==p&&a.data.kycId!==p&&a.$target!==p&&"a"==a.targetTag){var b=d("#kyc-address-pagination-"+a.data.kycId),c=a.$target[0].parentNode;a=a.$target[0].innerHTML;var e=b.find(".a-pagination").find("li[class\x3d'a-selected']");
e===p?e=void 0:(e=e.find("a")[0].innerHTML,e=parseInt(e));if(a!=e){var f=b.find(".a-pagination").find("li");c===f[0]?a=e-1:c===f[f.length-1]&&(a=e+1);u(b[0],a)}}})})}}});h.when("A").register("kyc-xborder-save-id-as-module",function(){return{onKycXborderSaveIdAsInit:function(k,m,g){h.when("A","ready").execute(function(c){function b(){return e("#"+g).find("input[name\x3d"+k+"]")}var e=c.$;""===b().val()&&("undefined"!==typeof c.state("KYCxBorderCustomerInfo")?b().val(c.state("KYCxBorderCustomerInfo").kycCustomerName+
" "+m):b().val(e("#address-ui-widgets-FullName").text()+" "+m))});h.when("A","kyc-form-validator","a-text-input","kyc-component-validator").execute(function(c,b,e,f){var h="#"+g;b.addValidator(h,function(){return f.textboxValidator(h,k,!0)});(new e("[name\x3d"+k+"]",h)).on("focusout",function(){f.textboxValidator(h,k,!1)})})}}});h.when("A").register("kyc-xborder-existing-id-module",function(){return{onKycXborderExistingIdInit:function(k){h.when("A","a-dropdown").execute(function(h,g){k&&g.getSelect("existing-kyc-dropdown").val(k)});
h.when("A","kyc-form-validator","a-text-input","kyc-component-validator","a-button","jQuery").execute(function(h,g,c,b,e,f){var n=h.state("kycXborderMissingPhoneNumberCnCitizenIds"),m=f("#kyc-xborder-continue-btn-container"),p=function(){return f("#cn-missing-phone-section").hasClass("aok-hidden")?!0:b.cnPhoneNumberValidator("#cn-missing-phone-section","sif_kyc_xborder_phoneNumberUpdate",!0)};(new c("[name\x3dsif_kyc_xborder_phoneNumberUpdate]","#cn-missing-phone-section")).on("focusout",function(){b.cnPhoneNumberValidator("#cn-missing-phone-section",
"sif_kyc_xborder_phoneNumberUpdate",!1)});var q=function(b){!f.isEmptyObject(n)&&-1<n.indexOf(b)?(g.addValidator("#kyc_xborder_existing_section",p),g.addValidator("#cn-missing-phone-section",p),""==f("#selected-cn-citizen-id-phone-number-update").val()&&(e("#kyc-xborder-continue-button").disable(),m&&m.addClass("kyc-xborder-continue-btn-container-click-disabled")),f("#cn-missing-phone-section").removeClass("aok-hidden")):(f("#cn-missing-phone-section").addClass("aok-hidden"),g.removeValidator("#kyc_xborder_existing_section",
p),g.removeValidator("#cn-missing-phone-section",p),f("#selected-cn-citizen-id-phone-number-update").val(""))};q(k);h.on("a:dropdown:existing-kyc-dropdown:select",function(b){q(b.value)})})}}});h.when("A").register("kyc-xborder-existing-address-module",function(){h.when("A","kyc-form-validator").execute(function(k,h){k.on("a:dropdown:existing-address-dropdown:select",function(g){h.validatePupForm("#kyc_xborder_existing_address")})});return{onKycXborderExistingAddressInit:function(k){h.when("A","a-dropdown").execute(function(h,
g){k&&g.getSelect("existing-address-dropdown").val(k)})}}});h.when("A").register("cn-consent-modify-module",function(k){function h(g){return new Promise(function(c,b){var e=document.getElementsByName("set-consent-token")[0].value,f=new XMLHttpRequest;f.open("POST","handler/set-consent");f.setRequestHeader("Content-Type","application/json;charset\x3dUTF-8");f.setRequestHeader("anti-csrftoken-a2z",e);f.send(JSON.stringify({desiredValue:g?1:0}));f.onload=function(){200!==f.status?b(g):"SUCCESS"===JSON.parse(f.response).statusCode?
c(g):b(g)};f.onerror=function(){b(g)}})}return{initConsentPage:function(g,c,b,e){function f(b){b?k.$("#success-alert").find(".a-alert-content").html(g):k.$("#success-alert").find(".a-alert-content").html(c);k.$("#error-alert").hide();e&&k.$("#info-alert").hide();k.$("#success-alert").show();k.$("#accept-consent-section").toggle();k.$("#cancel-consent-section").toggle()}function n(){k.$("#error-alert").find(".a-alert-content").html(b);k.$("#error-alert").show();k.$("#success-alert").hide();e&&k.$("#info-alert").hide()}
k.$("#accept-button")[0].onclick=function(){!e||document.getElementById("consent_content_1").checked&&document.getElementById("consent_content_2").checked?h(!0).then(f).catch(n):(k.$("#success-alert").hide(),k.$("#error-alert").hide(),k.$("#info-alert").find(".a-alert-content").html(e),k.$("#info-alert").show())};k.$("#cancel-button")[0].onclick=function(){h(!1).then(f).catch(n);e&&(document.getElementById("consent_content_1").checked=!1,document.getElementById("consent_content_2").checked=!1)}}}});
h.when("A").register("kyc-xborder-boolean-component",function(){return{onKycXborderBooleanComponentInit:function(k,m){h.when("A","kyc-form-validator","a-form-checkbox","kyc-component-validator").execute(function(g,c,b,e){var f=m+"_"+k;c.addValidator("#"+m,function(){return e.checkboxValidator(m,f,!0)});(new b("[id\x3d"+f+"]")).on("change",function(){e.checkboxValidator(m,f,!1)})})}}});h.when("A").register("kyc-xborder-date-component",function(){return{onKycXborderDateComponentInit:function(k,m,g,
c,b){h.when("A","bodyBegin").execute(function(e){e=e.$;var f="#"+c+"-"+k;if(b){var g=b.split("-");e(f+"-kyc-year-dropdown").val(g[0]).attr("selected","true");e(f+"-kyc-month-dropdown").val(g[1]).attr("selected","true");e(f+"-kyc-day-dropdown").val(g[2]).attr("selected","true")}});h.when("A","three-dropdown-date-controller","a-alert","a-dropdown","kyc-form-validator","kyc-component-validator").execute(function(b,f,h,p,q,u){h=c+"-"+k;var e=p.getSelect(h+"-kyc-year-dropdown"),d=p.getSelect(h+"-kyc-month-dropdown"),
a=p.getSelect(h+"-kyc-day-dropdown"),n="#"+h+"-kyc-date-inline-alert",r=new f(e,d,a,n,m,g,k,"#"+c);b.on("a:dropdown:"+h+"-kyc-year-dropdown:select",function(b){var c=d.val();b=b.value;var e=a.val();r.updateDayDropdown(b,c,e);r.populateDate()});b.on("a:dropdown:"+h+"-kyc-month-dropdown:select",function(b){var c=e.val();b=b.value;var d=a.val();r.updateDayDropdown(c,b,d);r.populateDate()});b.on("a:dropdown:"+h+"-kyc-day-dropdown:select",function(a){r.populateDate()});q.addValidator("#"+c,function(){return u.dateValidator(e,
d,a,m,n,"#"+c,!0)})})}}});h.when("A").register("kyc-xborder-select-component",function(){return{onKycXborderSelectComponentInit:function(k,m,g){h.when("A","bodyBegin").execute(function(c){c=c.$;k&&c("#"+g+"_"+m).val(k).attr("selected","true")});h.when("A","kyc-form-validator","a-dropdown","kyc-component-validator").execute(function(c,b,e,f){b.addValidator("#"+g,function(){return f.dropdownEmptyValidator(g,g+"_"+m,!0)});c.on("a:dropdown:"+g+"_"+m+":select",function(b){f.dropdownEmptyValidator(g,g+
"_"+m,!1)})})}}});h.when("A").register("kyc-xborder-text-component",function(){return{onKycXborderTextComponentInit:function(k,m){h.when("A","kyc-form-validator","a-text-input","kyc-component-validator").execute(function(g,c,b,e){var f="#"+m;if("sif_kyc_xborder_HOLDER_NAME"===k&&"undefined"!==typeof g.state("KYCxBorderPaymentHolderName")){var h=new b("[name\x3d"+k+"]",f);h.val(g.state("KYCxBorderPaymentHolderName").paymentHolderName)}"sif_kyc_xborder_PHONE_NUMBER"===k?(c.addValidator(f,function(){return e.cnPhoneNumberValidator(f,
k,!0)}),h=new b("[name\x3d"+k+"]",f),h.on("focusout",function(){e.cnPhoneNumberValidator(f,k,!1)})):"sif_kyc_xborder_CN_CITIZEN_ID_STRING"===k?(c.addValidator(f,function(){return e.cnCitizenIdValidator(f,k,!0)}),h=new b("[name\x3d"+k+"]",f),h.on("focusout",function(){e.cnCitizenIdValidator(f,k,!1)})):(c.addValidator(f,function(){return e.textboxValidator(f,k,!0)}),h=new b("[name\x3d"+k+"]",f),h.on("focusout",function(){e.textboxValidator(f,k,!1)}))})}}})});