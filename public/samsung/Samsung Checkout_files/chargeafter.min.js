(()=>{var e,t,n={725:e=>{"use strict";var t,n="object"==typeof Reflect?Reflect:null,o=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function r(){r.init.call(this)}e.exports=r,e.exports.once=function(e,t){return new Promise((function(n,o){function i(n){e.removeListener(t,r),o(n)}function r(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}m(e,t,r,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&m(e,"error",t,n)}(e,i,{once:!0})}))},r.EventEmitter=r,r.prototype._events=void 0,r.prototype._eventsCount=0,r.prototype._maxListeners=void 0;var s=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?r.defaultMaxListeners:e._maxListeners}function c(e,t,n,o){var i,r,s,c;if(a(n),void 0===(r=e._events)?(r=e._events=Object.create(null),e._eventsCount=0):(void 0!==r.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),r=e._events),s=r[t]),void 0===s)s=r[t]=n,++e._eventsCount;else if("function"==typeof s?s=r[t]=o?[n,s]:[s,n]:o?s.unshift(n):s.push(n),(i=l(e))>0&&s.length>i&&!s.warned){s.warned=!0;var d=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");d.name="MaxListenersExceededWarning",d.emitter=e,d.type=t,d.count=s.length,c=d,console&&console.warn&&console.warn(c)}return e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u(e,t,n){var o={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=d.bind(o);return i.listener=n,o.wrapFn=i,i}function f(e,t,n){var o=e._events;if(void 0===o)return[];var i=o[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):p(i,i.length)}function g(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function p(e,t){for(var n=new Array(t),o=0;o<t;++o)n[o]=e[o];return n}function m(e,t,n,o){if("function"==typeof e.on)o.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(r){o.once&&e.removeEventListener(t,i),n(r)}))}}Object.defineProperty(r,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),r.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},r.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},r.prototype.getMaxListeners=function(){return l(this)},r.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,r=this._events;if(void 0!==r)i=i&&void 0===r.error;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=r[e];if(void 0===l)return!1;if("function"==typeof l)o(l,this,t);else{var c=l.length,d=p(l,c);for(n=0;n<c;++n)o(d[n],this,t)}return!0},r.prototype.addListener=function(e,t){return c(this,e,t,!1)},r.prototype.on=r.prototype.addListener,r.prototype.prependListener=function(e,t){return c(this,e,t,!0)},r.prototype.once=function(e,t){return a(t),this.on(e,u(this,e,t)),this},r.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,u(this,e,t)),this},r.prototype.removeListener=function(e,t){var n,o,i,r,s;if(a(t),void 0===(o=this._events))return this;if(void 0===(n=o[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete o[e],o.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,r=n.length-1;r>=0;r--)if(n[r]===t||n[r].listener===t){s=n[r].listener,i=r;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(o[e]=n[0]),void 0!==o.removeListener&&this.emit("removeListener",e,s||t)}return this},r.prototype.off=r.prototype.removeListener,r.prototype.removeAllListeners=function(e){var t,n,o;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,r=Object.keys(n);for(o=0;o<r.length;++o)"removeListener"!==(i=r[o])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(o=t.length-1;o>=0;o--)this.removeListener(e,t[o]);return this},r.prototype.listeners=function(e){return f(this,e,!0)},r.prototype.rawListeners=function(e){return f(this,e,!1)},r.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):g.call(e,t)},r.prototype.listenerCount=g,r.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},474:(e,t)=>{function n(e,t){var n=[],o=[];return null==t&&(t=function(e,t){return n[0]===t?"[Circular ~]":"[Circular ~."+o.slice(0,n.indexOf(t)).join(".")+"]"}),function(i,r){if(n.length>0){var s=n.indexOf(this);~s?n.splice(s+1):n.push(this),~s?o.splice(s,1/0,i):o.push(i),~n.indexOf(r)&&(r=t.call(this,i,r))}else n.push(r);return null==e?r:e.call(this,i,r)}}(e.exports=function(e,t,o,i){return JSON.stringify(e,n(t,i),o)}).getSerialize=n}},o={};function i(e){var t=o[e];if(void 0!==t)return t.exports;var r=o[e]={id:e,loaded:!1,exports:{}};return n[e](r,r.exports,i),r.loaded=!0,r.exports}i.m=n,i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((t,n)=>(i.f[n](e,t),t)),[])),i.u=e=>e+".js",i.miniCssF=e=>{},i.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="caJsonp:",i.l=(n,o,r,s)=>{if(e[n])e[n].push(o);else{var a,l;if(void 0!==r)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==n||u.getAttribute("data-webpack")==t+r){a=u;break}}a||(l=!0,(a=document.createElement("script")).type="module",a.charset="utf-8",a.timeout=120,i.nc&&a.setAttribute("nonce",i.nc),a.setAttribute("data-webpack",t+r),a.src=n),e[n]=[o];var f=(t,o)=>{a.onerror=a.onload=null,clearTimeout(g);var i=e[n];if(delete e[n],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach((e=>e(o))),t)return t(o)},g=setTimeout(f.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=f.bind(null,a.onerror),a.onload=f.bind(null,a.onload),l&&document.head.appendChild(a)}},i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.p="https://cdn.chargeafter.com",(()=>{var e={404:0};i.f.j=(t,n)=>{var o=i.o(e,t)?e[t]:void 0;if(0!==o)if(o)n.push(o[2]);else{var r=new Promise(((n,i)=>o=e[t]=[n,i]));n.push(o[2]=r);var s=i.p+i.u(t),a=new Error;i.l(s,(n=>{if(i.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var r=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+r+": "+s+")",a.name="ChunkLoadError",a.type=r,a.request=s,o[1](a)}}),"chunk-"+t,t)}};var t=(t,n)=>{var o,r,[s,a,l]=n,c=0;if(s.some((t=>0!==e[t]))){for(o in a)i.o(a,o)&&(i.m[o]=a[o]);if(l)l(i)}for(t&&t(n);c<s.length;c++)r=s[c],i.o(e,r)&&e[r]&&e[r][0](),e[r]=0},n=self.webpackChunkcaJsonp=self.webpackChunkcaJsonp||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),(()=>{"use strict";var e=function(e,t,n){if(n||2===arguments.length)for(var o,i=0,r=t.length;i<r;i++)!o&&i in t||(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return e.concat(o||Array.prototype.slice.call(t))},t=function(e,t,n){this.name=e,this.version=t,this.os=n,this.type="browser"},n=function(e){this.version=e,this.type="node",this.name="node",this.os={env:{NX_WORKSPACE_ROOT:"/__w/104/s",NX_LOGS_URL:"https://logging-proxy-ca-production-170512-af60esna.uc.gateway.dev/log",NX_TASK_TARGET_CONFIGURATION:"production",NX_TASK_HASH:"12924189229093895859",NX_ENV_NAME:"production",NX_IFRAME_URL:"https://pm.chargeafter.com",NX_IFRAME_STYLE:"position: fixed;top: 0;left:0;width: 100%;height: 100%;z-index: 10010000000;border: 0;box-sizing: border-box;background-color: #00000038;display:none;",NX_CLI_SET:"true",NX_PROMOTION_URL_PATH:"/promotional-info",NX_TASK_TARGET_TARGET:"buildenv",NX_VERSION:"1.1.3115-releases-1-55",NX_LOAD_DOT_ENV_FILES:"true",NX_CDN_URL:"https://cdn.chargeafter.com",NX_TASK_TARGET_PROJECT:"sdk",NX_CONTAINER_SELECTION:".ca-promotional-widget",NX_EXTERNAL_SCRIPT_ID:"ca-external-script",NX_IFRAME_ID:"ca-modal-iframe",NX_API_URL:"https://api.chargeafter.com/v2",NX_BUTTON_SELECTOR:".ca-checkout-button",NX_FLOW_MFE_URL:"http://localhost:4302",NX_SKIP_NX_CACHE:"true",NX_TERMINAL_OUTPUT_PATH:"/__w/104/s/node_modules/.cache/nx/terminalOutputs/12924189229093895859",NX_STREAM_OUTPUT:"true"}}.platform},o=function(e,t,n,o){this.name=e,this.version=t,this.os=n,this.bot=o,this.type="bot-device"},r=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},s=function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null},a=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,l=3,c=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],d=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function u(e){return e?g(e):"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new s:"undefined"!=typeof navigator?g(navigator.userAgent):{env:{NX_WORKSPACE_ROOT:"/__w/104/s",NX_LOGS_URL:"https://logging-proxy-ca-production-170512-af60esna.uc.gateway.dev/log",NX_TASK_TARGET_CONFIGURATION:"production",NX_TASK_HASH:"12924189229093895859",NX_ENV_NAME:"production",NX_IFRAME_URL:"https://pm.chargeafter.com",NX_IFRAME_STYLE:"position: fixed;top: 0;left:0;width: 100%;height: 100%;z-index: 10010000000;border: 0;box-sizing: border-box;background-color: #00000038;display:none;",NX_CLI_SET:"true",NX_PROMOTION_URL_PATH:"/promotional-info",NX_TASK_TARGET_TARGET:"buildenv",NX_VERSION:"1.1.3115-releases-1-55",NX_LOAD_DOT_ENV_FILES:"true",NX_CDN_URL:"https://cdn.chargeafter.com",NX_TASK_TARGET_PROJECT:"sdk",NX_CONTAINER_SELECTION:".ca-promotional-widget",NX_EXTERNAL_SCRIPT_ID:"ca-external-script",NX_IFRAME_ID:"ca-modal-iframe",NX_API_URL:"https://api.chargeafter.com/v2",NX_BUTTON_SELECTOR:".ca-checkout-button",NX_FLOW_MFE_URL:"http://localhost:4302",NX_SKIP_NX_CACHE:"true",NX_TERMINAL_OUTPUT_PATH:"/__w/104/s/node_modules/.cache/nx/terminalOutputs/12924189229093895859",NX_STREAM_OUTPUT:"true"}}.version?new n({env:{NX_WORKSPACE_ROOT:"/__w/104/s",NX_LOGS_URL:"https://logging-proxy-ca-production-170512-af60esna.uc.gateway.dev/log",NX_TASK_TARGET_CONFIGURATION:"production",NX_TASK_HASH:"12924189229093895859",NX_ENV_NAME:"production",NX_IFRAME_URL:"https://pm.chargeafter.com",NX_IFRAME_STYLE:"position: fixed;top: 0;left:0;width: 100%;height: 100%;z-index: 10010000000;border: 0;box-sizing: border-box;background-color: #00000038;display:none;",NX_CLI_SET:"true",NX_PROMOTION_URL_PATH:"/promotional-info",NX_TASK_TARGET_TARGET:"buildenv",NX_VERSION:"1.1.3115-releases-1-55",NX_LOAD_DOT_ENV_FILES:"true",NX_CDN_URL:"https://cdn.chargeafter.com",NX_TASK_TARGET_PROJECT:"sdk",NX_CONTAINER_SELECTION:".ca-promotional-widget",NX_EXTERNAL_SCRIPT_ID:"ca-external-script",NX_IFRAME_ID:"ca-modal-iframe",NX_API_URL:"https://api.chargeafter.com/v2",NX_BUTTON_SELECTOR:".ca-checkout-button",NX_FLOW_MFE_URL:"http://localhost:4302",NX_SKIP_NX_CACHE:"true",NX_TERMINAL_OUTPUT_PATH:"/__w/104/s/node_modules/.cache/nx/terminalOutputs/12924189229093895859",NX_STREAM_OUTPUT:"true"}}.version.slice(1)):null}function f(e){return""!==e&&c.reduce((function(t,n){var o=n[0],i=n[1];if(t)return t;var r=i.exec(e);return!!r&&[o,r]}),!1)}function g(n){var i=f(n);if(!i)return null;var s=i[0],c=i[1];if("searchbot"===s)return new r;var u=c[1]&&c[1].split(".").join("_").split("_").slice(0,3);u?u.length<l&&(u=e(e([],u,!0),function(e){for(var t=[],n=0;n<e;n++)t.push("0");return t}(l-u.length),!0)):u=[];var g=u.join("."),p=function(e){for(var t=0,n=d.length;t<n;t++){var o=d[t],i=o[0];if(o[1].exec(e))return i}return null}(n),m=a.exec(n);return m&&m[1]?new o(s,g,p,m[1]):new t(s,g,p)}const p=["color: #d96666","color: #6495ed"],m=["appName","service","message"],h=[],v=["printOriginalToConsole","isConsoleOnly","filename","function"],y=(e,t)=>Object.entries(t).reduce(((t,[n,o])=>((e?v:h).includes(n)||m.includes(n)||(t[n]=o),t)),{}),w=({module:e="",message:t,logData:n})=>{const o=y(!1,n);return(e=>{const{error:t,err:n,er:o,e:i}=e,r=t||n||o||i,s=t?"error":n?"err":o?"er":"e";if(r&&r instanceof Error){const{name:t,message:n,stack:o}=r;e[s]={name:t,message:n,stack:o}}})(o),[`[Client]${e.replace(/%c| /g,"")}${t&&` ${t}`||""}`,o]},b=({message:e,logMessage:t,logData:n},o)=>{const i=y(!0,n);return[t,...o,e+(Object.keys(i).length?",":""),...Object.entries(i).reduce(((e,[t,n])=>(e.push(`${t}:`,"string"==typeof n?`${n},`:n),e)),[])]};var _=i(474),O=i.n(_);let E=function(e){return e[e.OFF=0]="OFF",e[e.TRACE=1]="TRACE",e[e.DEBUG=2]="DEBUG",e[e.INFO=3]="INFO",e[e.LOG=4]="LOG",e[e.WARN=5]="WARN",e[e.ERROR=6]="ERROR",e[e.FATAL=7]="FATAL",e}({});const T={[E.OFF]:"Off",[E.DEBUG]:"Debug",[E.INFO]:"Info",[E.TRACE]:"Info",[E.LOG]:"Info",[E.WARN]:"Warning",[E.ERROR]:"Error",[E.FATAL]:"Critical"},S={[E.OFF]:"debug",[E.DEBUG]:"debug",[E.INFO]:"info",[E.TRACE]:"log",[E.LOG]:"log",[E.WARN]:"warn",[E.ERROR]:"error",[E.FATAL]:"error"},A=[];let C,I=!1,N=0;const L=e=>{const t=O()(e);if(131072<new Blob([t]).size/1024){const t=Math.floor(e.length/2);return A.unshift(...e.splice(t,e.length)),L(e)}return{body:t,currLogs:e}},P=(e,t=3e3)=>(...n)=>{C&&clearTimeout(C),C=setTimeout((()=>{e.apply(void 0,n)}),t)},D=P((e=>{R(e)})),R=(e,t=!1)=>{if(!A.length||N>3||!e.logsUrl)return;if(I)return D(e);I=!0;const{body:n,currLogs:o}=L(A.splice(0,100));fetch(e.logsUrl,Object.assign({method:"POST",headers:{"Content-Type":"application/json"},body:n},t&&{keepalive:!0})).then((t=>{if(!t.ok)throw new Error(t.statusText);N=0,I=!1,A.length>100&&D(e)})).catch((t=>{I=!1,0===N&&M(e,E.ERROR,["Failed to send logs to server",{error:t.message,timestamp:Date.now(),function:"sendLogsToServer",filename:"logger.sender.ts"}]);const n=P((e=>{R(e)}),2e3*(0===N?1:N));N<=3&&(A.unshift(...o),n(e)),++N}))},M=(e,t,n)=>{const[o,i]=n,r=`frontend${e.browserSessionId?`_${e.browserSessionId}`:""}${e.correlationId?`_${e.correlationId}`:""}${e.sessionId?`_${e.sessionId}`:""}`;A.push({severity:T[t],timestamp:i.timestamp,messageText:o,data:i,correlationId:r}),A.length<100?D(e):(C&&clearTimeout(C),R(e))},k=window,U=k.console,x=["^Warning: Received .* for a non-boolean attribute .*","^Warning: React does not recognize the .* prop on a DOM element. If you intentionally want it to appear in the DOM as a custom attribute, spell it as lowercase .* instead. If you accidentally passed it from a parent component, remove it from the DOM element..*","^Using kebab-case for css properties in objects is not supported. Did you mean.*","^Warning: A component is changing an uncontrolled input to be controlled. This is likely caused by the value changing from undefined to a defined value, which should not happen. Decide between using a controlled or uncontrolled input element for the lifetime of the component. More info: https://reactjs.org/link/controlled-components","^Warning: validateDOMNesting\\(\\.\\.\\.\\): .* cannot appear as a descendant of .*","^Warning: Failed .* type: .*"].join("|"),j=(e,t)=>(n,o)=>{t(n,Object.assign({},o,e()))},F=["modal"],$=(e,t)=>{const n=S[e];if(e!==E.ERROR){const e=t.filter((e=>"string"==typeof e)),o=t.length>1&&("string"==typeof t[0]?t.slice(1,t.length):t)||[];U[n](...e,{function:"interceptConsole",filename:"LoggerService"},...o)}e===E.ERROR&&("string"==typeof(null==t?void 0:t[0])&&new RegExp(x).test(t[0])?U.warn(...t):U[n](...t))};let X=[];const W=(e,t=!1)=>{X.forEach((({logLevel:t,log:n,message:o})=>{B(e,t,o,n)})),X=[],R(e.config,t)},B=(e,t,n,o)=>{const{config:i,merchantName:r,featureFlags:s}=e,a=u(),l=(e=>{var t;const n=null!=(t=e.message)?t:"",o=`%c[${e.appName}]${e.service&&` [${e.service}]`||""}`,i={module:o,logMessage:`${o} %c[${e.filename}] [${e.function}]`,message:n,logData:e};return{server:!e.isConsoleOnly&&w(i)||void 0,console:b(i,p)}})(Object.assign({},o,{browserSessionId:i.browserSessionId,deviceSessionId:i.deviceSessionId,correlationId:i.correlationId,browserName:null==a?void 0:a.name,browserVersion:null==a?void 0:a.version,featureFlags:s,sessionId:i.sessionId,appName:i.appName,merchantName:r,message:n}));if((!i.production||[E.ERROR,E.FATAL].includes(t))&&l.console){U[S[t]](...l.console)}l.server&&M(i,t,l.server)},z=(e,t)=>(n,o)=>{const i=t(),{config:r,isInitialized:s}=i;if(s||U.error(`Logger is not initialized, called console.${S[e]} with message:`,n,"and log data:",o),!o||!o.filename||!o.function)throw new Error("Log data is required");if([E.ERROR,E.FATAL].includes(e))console.error(new Error(n),y(!0,o));else if("string"!=typeof n&&n.printOriginalToConsole||o.printOriginalToConsole){const t=y(!0,o);U[S[e]](n,...Object.values(t))}const a={message:n,log:Object.assign({},o,{timestamp:Date.now()})};if(!r.browserSessionId&&!r.sessionId||!s)return((e,t,n)=>{X.push({logLevel:e,log:n,message:t})})(e,n,a.log);B(i,e,n,a.log)};class Logger{set version(e){this.config.version=e}set merchantName(e){this._merchantName=e,this.setSentryTag("merchantName",e)}set fullStoryUrl(e){this.setSentryTag("fullStoryUrl",e)}set sessionId(e){this.config.sessionId=e,this.setSentryTag("sessionId",e),W(this.getConfig())}set browserSessionId(e){this.config.browserSessionId=e,this.setSentryTag("browserSessionId",e),W(this.getConfig())}set deviceSessionId(e){this.config.deviceSessionId=e,this.setSentryTag("deviceSessionId",e)}set correlationId(e){this.config.correlationId=e,this.setSentryTag("correlationId",e)}set featureFlags(e){const t=Object.entries(e).reduce(((e,[t,n])=>(e[`feature-${t}`]=null==n?void 0:n.toString(),e)),{});this._featureFlags=t,this.setSentryTags(t)}constructor(e){this.config={production:!1,appName:"",logsUrl:""},this.isSentryInitialized=!1,this._merchantName="",this._featureFlags={},this.isInitialized=!1,this.getConfig=()=>({config:this.config,merchantName:this._merchantName,isInitialized:this.isInitialized,featureFlags:this._featureFlags}),this.log=z(E.LOG,this.getConfig),this.info=z(E.INFO,this.getConfig),this.warn=z(E.WARN,this.getConfig),this.error=z(E.ERROR,this.getConfig),this.group=e=>{U.group("[ChargeAfter]",e)},this.groupCollapsed=(...e)=>{U.groupCollapsed("[ChargeAfter]",...e)},this.groupEnd=()=>{U.groupEnd()},this.service=e=>{let t="-1";const n=()=>({version:t,service:e});return{set version(e){t=e},log:j(n,this.log),info:j(n,this.info),warn:j(n,this.warn),error:j(n,this.error)}},this.flush=()=>{W(this.getConfig(),!0)},this.getLogs=()=>L(A.slice()),this.getServerUrl=()=>this.config.logsUrl,e&&this.init(e)}setSentryTag(e,t){this.setSentryTags({[e]:t})}setSentryTags(e){this.isSentryInitialized&&Promise.all([i.e(805),i.e(914)]).then(i.bind(i,914)).then((({setSentryTags:t})=>t(e)))}initSentry(){var e;null!=(e=this.config)&&null!=(e=e.sentryConfig)&&e.dsn&&!/headless/.test(navigator.userAgent.toLowerCase())&&Promise.all([i.e(805),i.e(914)]).then(i.bind(i,914)).then((({initSentry:e})=>{this.config.sentryConfig&&(e(this.config.sentryConfig),this.isSentryInitialized=!0)}))}init(e){var t;this.config=e,this.initSentry(),this.isInitialized=!!e,t=e.appName,-1!==F.indexOf(t.toLowerCase())&&(k.console=Object.assign({},k.console,{log:(...e)=>$(E.LOG,e),info:(...e)=>$(E.INFO,e),warn:(...e)=>$(E.WARN,e),error:(...e)=>$(E.ERROR,e)}))}}new Logger;const K="https://api.chargeafter.com/v2",G={production:!0,containerSelector:".ca-promotional-widget",buttonSelector:".ca-checkout-button",specialContainerSelector:".ca-lenovo-promotional-widget",apiUrl:K,promotionUrl:`${K}/promotional-info`,cdnUrl:"https://cdn.chargeafter.com",logsUrl:"https://logging-proxy-ca-production-170512-af60esna.uc.gateway.dev/log",version:"1.1.3115-releases-1-55",envName:"production",externalScriptId:"ca-external-script",iframe:{url:"https://pm.chargeafter.com",id:"ca-modal-iframe",style:"position: fixed;top: 0;left:0;width: 100%;height: 100%;z-index: 10010000000;border: 0;box-sizing: border-box;background-color: #00000038;display:none;"}},H=new Logger({logsUrl:G.logsUrl,appName:"SDK",production:G.production});const V=function(e){let t,n;const o=new Promise(((o,i)=>{t=o,n=i,null!=e&&("function"==typeof e?e(o,i):e.constructor===Promise&&e.then(o,i))}));return o.resolve=t,o.reject=n,o};function Y(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(o){return Promise.reject(o)}}}const J=window,q=document,Q=["large-generic","small-generic","medium-generic","large-square","small-square","medium-square"],Z=["default","product-widget","product-widget-syf","product-widget-line-of-credit","product-widget-line-of-credit-by-promo","product-widget-installments","banner-vertical","banner-horizontal","banner-vertical-upto-6months","banner-horizontal-upto-6months","banner-vertical-upto-48months","banner-horizontal-upto-48months","line-of-credit","textual","default-template","multi-lender"],ee=["product-widget-line-of-credit","line-of-credit","product-widget-syf","product-widget-line-of-credit-by-promo"],te=["banner-horizontal","banner-horizontal-upto-48months","banner-horizontal-upto-6months","banner-vertical","banner-vertical-upto-48months","banner-vertical-upto-6months","default","textual","product-widget"],ne=["product-widget-line-of-credit","product-widget-syf","product-widget-installments","line-of-credit"],oe="validations",ie=/^=|(\b)(on\S+)(\s*)=|javascript|<(|\/|[^\\/>][^>]+|\/[^>][^>]+)>/gi,re=e=>("string"==typeof e&&e||"number"==typeof e)&&!isNaN(+e),se=e=>"string"==typeof e&&!!e,ae=e=>"object"==typeof e&&!(e instanceof Array)&&null!==e,le=e=>"function"==typeof e,ce=e=>{const t={filename:oe,function:"isWidgetValid",printOriginalToConsole:!0},{widgetType:n,widgetItemPrice:o,widgetItemSku:i,widgetFinancingPageUrl:r,buttonType:s,widgetProfile:a}=e,l=te.includes(n),c=s;return Z.includes(n)||Q.includes(s)||a?!(!l&&!c)||(o&&i&&"string"==typeof i?ne.indexOf(n)>-1&&!r?(H.error(`Cannot render widget (SKU: "${i}"), because the mandatory attribute "data-widget-financing-page-url" was not added to the widget's element`,Object.assign({},t,{isSeverityWarn:!0})),!1):!(isNaN(+o)||+o<0)||(H.error(`Cannot render widget, item price is not in the correct format should be bigger or equal to 0. received:${o}`,Object.assign({},t,{isSeverityWarn:!0})),!1):(H.error(`Cannot render widget${i?" "+i:""}, because ${i||o?"the mandatory attribute "+(o?'"data-widget-item-sku"':'"data-widget-item-price"'):'at least one of the mandatory attributes "data-widget-item-sku" and "data-widget-item-price"'} ${"string"!=typeof i&&null!=i?"is not of type string":"were not added to the widget's element"}`,Object.assign({},t,{isSeverityWarn:!0})),!1)):(H.error(`Cannot render widget, the type "${n||s}" is not supported, the supported types are "${(s?Q:Z).join(", ")}"`,Object.assign({},t,{isSeverityWarn:!0})),!1)},de=e=>{let t=!0;if(e)for(const n in e){const o=e[n];if("object"!=typeof o||o instanceof Array){if("string"==typeof o&&new RegExp(ie).test(o)){t=!1;break}}else t=de(o)}return t},ue=e=>{if(e.widgetFinancingPageUrl&&/[-a-zA-Z0-9@:%_+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_+.~#?&//=]*)?/gi.test(e.widgetFinancingPageUrl)&&!/^http:|https:/.test(e.widgetFinancingPageUrl))e.widgetFinancingPageUrl=`https://${e.widgetFinancingPageUrl}`;else if(e.widgetFinancingPageUrl){const t=document.createElement("a");t.href=e.widgetFinancingPageUrl,e.widgetFinancingPageUrl=`${/^http:|https:/.test(t.protocol)?t.protocol:location.protocol}//${t.host}${/^\//.test(t.pathname)?t.pathname:`/${t.pathname}`}${t.search}`}return"string"==typeof e.widgetItemPrice&&(e.widgetItemPrice=e.widgetItemPrice.replace(/[^0-9.-]+/g,"")),ee.includes(e.widgetType)&&(e.widgetType="product-widget-line-of-credit"),Object.assign({},e)},fe=e=>{var t,n;if(!e)return H.error("can't continue application because cartDetails was not provided",{function:"isMerchantOptValid",filename:oe,printOriginalToConsole:!0}),!1;const{items:o,discounts:i}=e;if(r=o,!Array.isArray(r)||!r.length)return H.error("cart details provided without items",{function:"validateCartDetails",filename:oe,printOriginalToConsole:!0}),!1;var r;const s={items:void 0,discounts:void 0};var a;return s.items=o.filter((e=>{var t,n,o,i;return!(se(e.name)&&re(e.price)&&re(e.quantity)&&se(e.sku)&&(i=e.warranty,ae(i)||null==i)&&(!e.warranty||se(null==(t=e.warranty)?void 0:t.name)&&re(null==(n=e.warranty)?void 0:n.price)&&se(null==(o=e.warranty)?void 0:o.sku)))})),s.discounts=null==i?void 0:i.filter((e=>!se(e.name)||!re(e.amount))),!(null!=(t=s.items)&&t.length||null!=(n=s.discounts)&&n.length)||(s.items.length&&H.error(`the following cart Items missing basic or warranty data: ${JSON.stringify(s.items)}`,{filename:oe,function:"validateCartDetails",printOriginalToConsole:!0}),null!=s&&null!=(a=s.discounts)&&a.length&&H.error(`the following cart discounts missing basic data: ${JSON.stringify(s.discounts)}`,{filename:oe,function:"validateCartDetails",printOriginalToConsole:!0}),!1)},ge=(e,t)=>fe(e)?!!(({totalAmount:e,taxAmount:t,shippingAmount:n,discounts:o=[],items:i=[]})=>{var r,s;if(null!=(r=location)&&null!=(r=r.host)&&r.toLowerCase().includes("sh.chargeafter.com")||null!=(s=location)&&null!=(s=s.host)&&s.toLowerCase().includes("shopify.chargeafter.com"))return!0;const a=o.reduce(((e,t)=>+e+ +t.amount),0),l=(+t+ +n+ +i.reduce(((e,t)=>{var n;return e+(+t.price*+t.quantity+ +((null==(n=t.warranty)?void 0:n.price)||0))}),0)-+a).toFixed(2),c=(+e).toFixed(2)===l;return c||H.error(`totalAmount is not matching the cart details, totalAmount received:${e.toFixed(2)}, totalAmount calculated:${l}`,{function:"validateCartAmount",filename:oe,printOriginalToConsole:!0}),c})(e)||(t(void 0,void 0,{code:"TOTAL_AMOUNT_MISMATCH",message:"totalAmount is not matching the cart details"}),!1):(t(void 0,void 0,{code:"MISSING_CHECKOUT_DATA",message:"Partial or missing cartDetails"}),!1),pe=e=>ae(e)?!e.isCheckout||(le(e.callback)?(e=>{if(e){const t=se(e.token);return t||H.error("The application cannot be continued because token is missing",{function:"validateManaged",filename:oe,printOriginalToConsole:!0}),t}return!0})(e.managed)?!(!e.managed&&!e.applicationId)||(le(e.onDataUpdate)||ae(e.consumerDetails)&&(({shippingAddress:e,billingAddress:t}={})=>{const n=!!(se(null==e?void 0:e.city)&&se(null==e?void 0:e.zipCode)&&se(null==e?void 0:e.state)&&se(null==e?void 0:e.line1)&&se(null==t?void 0:t.city)&&se(null==t?void 0:t.zipCode)&&se(null==t?void 0:t.state)&&se(null==t?void 0:t.line1));return n||H.error("some data is missing from shipping and/or billing addresses, while updateCallBack was not provided",{function:"validateAddress",filename:oe,isSeverityWarn:!0,printOriginalToConsole:!0}),n})(e.consumerDetails)?!!ge(e.cartDetails,e.callback)&&(!!de(e.consumerDetails)||(H.error("consumer details contains illegal char",{function:"isMerchantOptValid",filename:oe,printOriginalToConsole:!0}),e.callback(void 0,void 0,{code:"ILLEGAL_CHAR_PROVIDED",message:"consumer details contains illegal char"}),!1)):(e.callback(void 0,void 0,{code:"MISSING_CHECKOUT_DATA",message:"Partial or missing billing and shipping address, and no onDataUpdate to allow modification"}),!1)):(e.callback(void 0,void 0,{code:"MISSING_CHECKOUT_DATA",message:"Token is missing from managed object"}),!1):(H.error('can\'t continue application because "callBack" was not provided in opt',{function:"isMerchantOptValid",filename:oe,printOriginalToConsole:!0}),!1)):(H.error("can't continue application because opt was not passed",{function:"isMerchantOptValid",filename:oe,printOriginalToConsole:!0}),!1),me=()=>([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)));let he,ve,ye=!0;const we=window,be={get get(){var e,t;const n=(null==(e=we.caConfig)?void 0:e.browserSessionId)||(null==(t=we.ChargeAfter)||null==(t=t.cfg)?void 0:t.browserSessionId);return he||(he=n||me(),ve=Date.now(),ye=!0),he},get sendBrowserSessionStartedEvent(){return ye},set sendBrowserSessionStartedEvent(e){ye=e},get timestamp(){return he?ve:0},set set(e){e!==he&&(ye=!0,ve=Date.now(),he=e)}};function _e(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}const Oe=document;function Ee(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(o){return Promise.reject(o)}}}const Te=window,Se={filename:"sdk.actions",origin:Te.origin,href:Te.location.href,function:"fetchWidgets"},Ae=Ee((function({apiKey:e,storeId:t,language:n="en-US",widgets:o=[],currency:i,sendBrowserSessionStartedEvent:r}){o.length||H.warn("no widgets were found",Object.assign({},Se));const s=`Frontend_${be.get}_${me()}`;return function(e,t){try{var n=e()}catch(o){return t(o)}return n&&n.then?n.then(void 0,t):n}((function(){const a=JSON.stringify({"Content-Type":"application/json",Authorization:`Bearer ${e}`,"x-dcode-flow":s,"x-ca-store-id":t}),l=JSON.stringify(Object.assign({items:o,storeId:t,language:n,currency:i,browserSessionId:be.get},o.length&&{sendBrowserSessionStartedEvent:r,timestamp:be.timestamp})),c=new FormData;return c.append("body",l),c.append("headers",a),c.append("method","POST"),_e(fetch(G.promotionUrl,{credentials:"include",method:"POST",body:c}),(function(i){const r=i.clone();return _e(i.json().catch(Ee((function(i){const s=H.error,a=G.promotionUrl,l=null==r?void 0:r.statusText,c=null==r?void 0:r.status;return _e(null==r||null==r.text?void 0:r.text(),(function(d){s.call(H,"failed to parse response to json",Object.assign({},Se,{error:i,url:a,apiKey:e,response:{status:c,statusText:l,body:d,headers:null==r?void 0:r.headers},body:JSON.stringify({items:o,storeId:t,language:n}),errorMessage:i.message}))}))}))))}))}),(function(i){H.error("fetching widgets failed",Object.assign({},Se,{error:i,url:G.promotionUrl,apiKey:e,body:JSON.stringify({items:o,storeId:t,language:n}),errorMessage:i.message}))}))}));let Ce,Ie,Ne,Le={},Pe=!1;const De=new Map,Re={get widgets(){return Le},set widgets(e){Le=e},get config(){return Ce},set config(e){Ce=e},get isInitialized(){return Pe},set isInitialized(e){Pe=e},get basePromotionModalData(){return Ne},set basePromotionModalData(e){Ne=e},get sdkInitializedPromise(){return Ie},set sdkInitializedPromise(e){Ie=e},get itemsToUpdate(){return De}};const Me="initWidgets";const ke=(Ue=function(e,t,n){const o=!e,i=Date.now();H.log("initializing widgets",{function:"initWidgets",filename:Me,widgetsData:e});let r=e;if(!e){const{promotionRequestPayload:e,widgets:t}=(()=>{const{containerSelector:e,buttonSelector:t}=G,n=Oe.querySelectorAll(`${e}, ${t}`),o=[],i={};return n.forEach((e=>{const t=ue(e.dataset),n=t.widgetItemSku;ce(t)&&!i[n||t.widgetType||t.buttonType]&&(i[n||t.widgetType||t.buttonType]={widget:t},o.push(t))})),{widgets:i,promotionRequestPayload:o}})();r=e,Re.widgets=t}const{apiKey:s,storeId:a,currency:l}=Re.config;var c,d,u;if(r&&0!==r.length)return c=Ae({widgets:r,language:t,apiKey:s,storeId:a,currency:n||l,sendBrowserSessionStartedEvent:be.sendBrowserSessionStartedEvent}),d=function(e){if(be.sendBrowserSessionStartedEvent=!1,e){var t;const{widgets:n={},basePromotionModalData:r={}}=((e,t)=>{let n;const{promotions:o=[],merchant:i,lendersInWaterfall:r,canApplyFromWidget:s,configuration:a,configurationSessionId:l}=t,c={merchant:i,lendersInWaterfall:r,canApplyFromWidget:s,configuration:a,configurationSessionId:l},d={};for(const u of o){n=u.referenceId?`${G.containerSelector}[data-widget-item-sku=${JSON.stringify(u.referenceId)}]`:`${u.buttonType?G.buttonSelector:G.containerSelector}[data-${u.buttonType?"button":"widget"}-type=${JSON.stringify(u.widgetType||u.buttonType)}]`;const t=u.referenceId||u.widgetType||u.buttonType;t in e&&(d[t]=Object.assign({},e[t],{selector:n,promotion:u}),e[t].selector=n,e[t].promotion=u)}return{widgets:d,basePromotionModalData:c}})(Re.widgets,e);Object.values(n).forEach((e=>{q.querySelectorAll(e.selector).forEach((t=>{t.innerHTML=e.promotion.el}))})),e.cssData&&((e,t)=>{const n=Oe.getElementById(e.key),o=n||Oe.createElement("style"),i=[];o.id=e.key,t&&(o.innerHTML=""),e.css.split(/(.*?\})/g).forEach((e=>{const t=e.split(/(?=\{)/g);null!=t&&t[0]&&e&&i.push(e.trim())})),i.forEach((e=>{o.innerHTML.includes(e)||o.appendChild(Oe.createTextNode(e))})),n||Oe.head.insertBefore(o,Oe.head.firstChild)})(e.cssData,o),Re.basePromotionModalData=r,Re.config.merchantId=null==(t=Re.basePromotionModalData.merchant)?void 0:t.id;const s=Date.now()-i;H.log(`widgets initialized within ${s}ms`,{function:"initWidgets",filename:Me,widgets:Re.widgets,widgetsInitTime:s})}},u?d?d(c):c:(c&&c.then||(c=Promise.resolve(c)),d?c.then(d):c);H.log("no widgets initialized, widgets not found",{function:"initWidgets",filename:Me})},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(Ue.apply(this,e))}catch(n){return Promise.reject(n)}});var Ue;const xe=(e,t)=>{H.error(`called ${e} with out initializing sdk`,{function:e,filename:t,printOriginalToConsole:!0,isSeverityWarn:!0})};function je(){}const Fe="update.ts";const $e=((e,t=0)=>{let n,o=null;return Y((function(...i){const r=Y((function(){return clearTimeout(n),t=e(...i).catch((e=>{var t;throw null==(t=o)||t.reject(e),o=null,e})),r=function(e){var t;null==(t=o)||t.resolve(e),o=null},s?r?r(t):t:(t&&t.then||(t=Promise.resolve(t)),r?t.then(r):t);var t,r,s}));return o||(o=new V),clearTimeout(n),n=setTimeout(r,t),o}))})(Xe((function(e,t,n){var o;let i;return void 0===t&&(t=null==(o=Re.config)||null==(o=o.preferences)?void 0:o.language),H.log("updating widgets",{function:"update",filename:Fe,items:e}),null!=e&&e.length&&(i=e.reduce(((e,t)=>{var n,o;const i=t.sku,r=t.price;let s=(null==(n=Re.widgets)||null==(n=n[i])?void 0:n.widget)||(null==(o=q.querySelector(`[data-widget-item-sku=${JSON.stringify(i)}]`))?void 0:o.dataset);return s?(s.widgetItemPrice=r,s=ue(s),ce(s)&&(e.push(s),Re.widgets[i]=Object.assign({},Re.widgets[i]||{},{widget:s})),e):e}),[])),function(e){var t=e();if(t&&t.then)return t.then(je)}((function(){var o;if(null!=(o=i)&&o.length||null==e||!e.length)return function(e,t){if(!t)return e&&e.then?e.then(je):Promise.resolve()}(ke(i,t,n));H.error("the items provided are invalid",{function:"update",filename:Fe})}))})),500);function Xe(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(o){return Promise.reject(o)}}}const We=Xe((function(e=[],t,n){var o,i,r,s;if(void 0===t&&(t=null==(o=Re.config)||null==(o=o.preferences)?void 0:o.language),!Re.isInitialized)return xe("update","update.ts");for(const a of e)a.sku&&Re.itemsToUpdate.set(a.sku,a);return i=$e(Array.from(Re.itemsToUpdate.values()),t,n),r=function(){Re.itemsToUpdate.clear()},s?r?r(i):i:(i&&i.then||(i=Promise.resolve(i)),r?i.then(r):i)})),Be=e=>{try{return JSON.parse(JSON.stringify(e))}catch(t){return H.error("failed to serialize object",{function:"serialize",filename:"serialize",obj:e,e:t}),e}};class DBUY{constructor(){this.isEventAdded=!1,this.modal=void 0,this.windowRef=window,this.modalCloseHandler=e=>{let t=!1;if("string"==typeof e.data)switch(t=!1,e.data){case"Close Model":case"Return To Merchant Shipping":t=!0,H.log("DBUY_RETURNED_MSG",{filename:"dbuy.ts",function:"modalCloseHandler",data:e.data}),this.sendMsg({action:"DBUY_RETURNED_MSG",dbuyData:{action:"DBUY_CLOSE"}}),this.modal.style.display="block"}t&&(H.log("DBUY_REMOVING",{filename:"dbuy.ts",function:"modalCloseHandler",data:e.data}),this.windowRef.removeEventListener("message",this.modalCloseHandler),this.isEventAdded=!1,this.modal=null,this.windowRef=null)},this.sendMsg=e=>{this.modal&&this.modal.contentWindow.postMessage(e,"*")},this.load=this.load.bind(this)}load(e,t){const{url:n,dbuy:o={}}=e;H.log("DBUY_START_LOADING",{filename:"dbuy.ts",function:"load"}),this.modal=t;const i=()=>{var e;H.log("DBUY_SCRIPT_LOADEDG",{filename:"dbuy.ts",function:"onLoadScript"}),this.isEventAdded||(this.windowRef.addEventListener("message",this.modalCloseHandler),this.isEventAdded=!0),this.sendMsg({action:"DBUY_RETURNED_MSG",dbuyData:{action:"DBUY_LOADED"}}),null==(e=this.windowRef.syfDBuy)||e.calldBuyProcess(null,Object.assign({},o,{processInd:1,clientTransId:me()})),setTimeout((()=>{t.style.display="none"}),50)},r=(e,n,o,i,r)=>{H.log("DBUY_FAIL_O_LOAD",{filename:"dbuy.ts",function:"onErrorScript",error:r,event:e,source:n,lineno:o,colno:i,errorMessage:r.message}),t.style.display="block",this.sendMsg({action:"DBUY_RETURNED_MSG",dbuyData:{action:"DBUY_ERROR"}})};if(document.getElementById("caSyfDbuyScript"))return i&&setTimeout(i,50);if(n){const e=document.createElement("script");e.id="caSyfDbuyScript",e.onload=i,e.onerror=r,e.src=n,document.body.appendChild(e)}}}let ze;function Ke(e,t){if(null==e)return{};var n,o,i={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(i[n]=e[n]);return i}var Ge=i(725),He=i.n(Ge);const Ve=["headersInfo"],Ye=window,Je=document;function qe(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(o){return Promise.reject(o)}}}const Qe=window;const Ze="message.listener";function et(){}let tt={};function nt(e){var t=e();if(t&&t.then)return t.then(et)}const ot=(e,t)=>(n,o)=>{H.log(`creating message listeners for ${null==o?void 0:o.name}`,{function:"createMessageFunction",filename:Ze});const i="string"==typeof t?[t]:t;return new Promise((t=>{var r;const s=new AbortController,a=e=>{const{data:n}=e;"CAMODAL"===n.source&&i.includes(n.action)&&(n.id===(null==o?void 0:o.name)||"static"===n.id&&"global"===(null==o?void 0:o.name))&&(H.log(`received ${n.action} message for ${null==o?void 0:o.name}`,{function:"createMessageFunction",filename:Ze,data:n}),t(n),s.abort(),Qe.removeEventListener("message",a))};Qe.addEventListener("message",a,{signal:s.signal}),null==o||null==(r=o.contentWindow)||r.postMessage(Object.assign({},n,{source:"CASDK",id:o.name,action:e}),"*")}))},it=(qe((function(e,t,n){return new Promise((o=>{var i;H.log(`sends message to ${null==n?void 0:n.name}`,{function:"sendMessageToModal",filename:Ze,payload:e,responseMessageType:t});const r=new AbortController,s=e=>{const{data:i}=e;"CAMODAL"===i.source&&i.action===t&&i.id===n.name&&(H.log(`received ${i.action} message for ${null==n?void 0:n.name}`,{function:"sendMessageToModal",filename:Ze,data:i}),o(i),r.abort(),Qe.removeEventListener("message",s))};t?Qe.addEventListener("message",s,{signal:r.signal}):o(),null==n||null==(i=n.contentWindow)||i.postMessage(Object.assign({},e,{source:"CASDK",id:n.name}),"*")}))})),(e,t,n)=>{tt[e]={},tt[e].listener=qe((function({data:e}){return nt((function(){if("CAMODAL"===e.source)return nt((function(){if(n[e.action]&&e.id===t.name)return H.log(`received ${e.action} message for ${null==t?void 0:t.name}`,{function:"createListenersEvents",filename:Ze,data:e}),o=n[e.action].onMessage(e),i=function(o){var i;n[e.action].responseAction&&(null==t||null==(i=t.contentWindow)||i.postMessage(Object.assign({},o,{source:"CASDK",id:t.name,action:n[e.action].responseAction}),"*"))},r?i?i(o):o:(o&&o.then||(o=Promise.resolve(o)),i?o.then(i):o);var o,i,r}))}))}));const o=new AbortController;return Qe.addEventListener("message",tt[e].listener,{signal:o.signal}),tt[e].signal=o,o}),rt=(e,t)=>{const n=document.getElementById(`${G.iframe.id}${"global"===e?"":`-${e}`}`);if(n){const e=new MutationObserver((o=>{o.forEach((o=>{if(o.removedNodes.length>0){const i=Array.from(o.removedNodes);(i.indexOf(n)>-1||i.some((e=>e.contains(n))))&&(H.log(`modal ${t} removed from DOM`,{function:"listenToModalRemoveFromDom",filename:Ze,pathname:parent.location.pathname}),parent.postMessage({action:"CLOSE_MODAL",source:"CAMODAL",id:t},"*"),e.disconnect())}}))}));e.observe(document.body,{subtree:!0,childList:!0})}else setTimeout((()=>rt(e,t)),100)};function st(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}const at=window;function lt(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(o){return Promise.reject(o)}}}const ct="modal.actions";const dt=document;const ut=(e,t)=>new Promise((n=>{let o;if("string"==typeof t&&(o=document.getElementById(t)),o||(o=t instanceof HTMLElement&&t||dt.body),o.contains(e))n();else{o.appendChild(e);const t=({data:e})=>{"CAMODAL"!==e.source||"APPLICATION_LOADED"!==e.action&&"APPLICATION_INIT"!==e.action||(at.removeEventListener("message",t),n())};at.addEventListener("message",t)}})),ft=lt((function({id:e,container:t,name:n,style:o,url:i}){H.log("creating modal iframe",{function:"createIframe",id:e,name:n,container:t&&t.toString(),filename:ct});const r=document.getElementById(e)||dt.createElement("iframe");r.setAttribute("title","Payment option flow"),r.setAttribute("style",o||G.iframe.style),r.setAttribute("name",n),r.setAttribute("id",e),r.setAttribute("src",i||G.iframe.url);const s=(...e)=>{throw e.length&&e[e.length-1]||new Error("modal failed to initialize")};return r.onerror=s,r.onabort=s,st(ut(r,t),(function(){return r}))})),gt=(e,t)=>{const n=document.createElement("script");return n.setAttribute("id",G.externalScriptId),n.setAttribute("src",e),n.setAttribute("async","true"),n.async=!0,n.onerror=t,n.onabort=t,n},pt=(e,t)=>{var n;H.log("SDK sends message",{function:"sendMsg",filename:ct,payload:e}),null==t||null==(n=t.contentWindow)||n.postMessage(Object.assign({},e,{source:"CASDK",id:t.name}),"*")},mt=ot("GET_DIRECT_LENDERS",["ON_GET_DIRECT_LENDERS_RECEIVED","COMPLETION_CALLBACK_CALLED"]),ht=ot("APPLICATION_INIT","APPLICATION_INIT_DONE"),vt=ot("OPEN_MODAL",["CLOSE_MODAL","COMPLETION_CALLBACK_CALLED"]),yt=ot("OPEN_MODAL",["CLOSE_MODAL","COMPLETION_CALLBACK_CALLED"]),wt=lt((function(e,t,n){return function(e,t){try{var n=e()}catch(o){return t(o)}return n&&n.then?n.then(void 0,t):n}((function(){let o,i;H.log("about to call merchant onDataUpdate",{function:"callMerchantDataUpdate",filename:ct,isOnDataUpdateExist:!!n,updatedData:e,isCheckout:t});const r=new Promise((e=>{i=e}));return st(null==n?void 0:n(e,i),(function(e){return o=e,t=function(){return o},(n=function(){if(!o)return st(r,(function(e){o=e}))}())&&n.then?n.then(t):t(n);var t,n}))}),(function(e){return H.error("An error accrued while calling merchant onDataUpdate",{function:"onUpdateDataCalled",filename:ct,error:e,message:e.message}),{}}))})),bt=({isCheckout:e,merchantActions:{onConfirm:t,onDataUpdate:n,onApprovalStatusChange:o}={},modalData:i})=>{const{iframe:r}=i;return it(i.id,r,{CONFIRM:{onMessage:function({confirmationId:e,callbackData:n}){return null==t||t(e,n),st()}},OPEN_DBUY:{onMessage:lt((function({dbuyData:e}){return e&&r&&(new DBUY).load(e,r),st()}))},OPEN_EXTERNAL_SCRIPT:{onMessage:lt((function({scriptInfo:e,scriptUrl:t}){return t&&e&&((e,t,{createScript:n,sendMsg:o})=>{let i,{scriptUrl:r,scriptInfo:{headersInfo:s}}=t,a=Ke(t.scriptInfo,Ve);const l=new(He()),c=e.iframe,d=e.id,u=()=>{var e;null==(e=i)||e.remove(),Ye.caExternalScript=void 0,l.removeAllListeners(),c.style.display="block"};l.addListener("complete",(e=>{u(),o({type:"payments",action:"OPEN_EXTERNAL_SCRIPT_COMPLETE",paymentsData:{success:e},id:d},c)})),l.addListener("onLoadComplete",(()=>{c.style.display="none",o({type:"payments",action:"OPEN_EXTERNAL_SCRIPT_LOADED",id:d},c)})),Ye.caExternalScript=Object.freeze({complete:e=>l.emit("complete",e),onLoadCompleted:()=>l.emit("onLoadComplete"),config:Object.freeze(a),headersInfo:Object.freeze(s)}),i=n(r,(()=>{u(),H.error("External script failed to load",{function:"loadExternalScript",filename:"external.actions"}),o({type:"payments",action:"OPEN_EXTERNAL_SCRIPT_COMPLETE",paymentsData:{success:!1},id:d},c)})),Je.body.appendChild(i)})(i,{scriptInfo:e,scriptUrl:t},{sendMsg:pt,createScript:gt}),st()}))},ON_UPDATE_DATA_CALLED:{responseAction:"ON_UPDATE_DATA_CALLED",onMessage:lt((function(t){return st(wt(t.updatedData,e,n),(function(e){return{type:"payments",paymentsData:{opt:{cartDetails:e}}}}))}))},ON_APPROVAL_STATUS_CHANGE:{onMessage:function({status:e,data:t}){return null==o||o(e,t),st()}},SET_FEATURE_FLAGS:{onMessage:lt((function({featureFlags:e}){return ze=e,st()}))}})};function _t(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}let Ot=null;function Et(e,t){var n=e();return n&&n.then?n.then(t):t(n)}const Tt="modal.manager";function St(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(o){return Promise.reject(o)}}}const At=document;function Ct(){}let It={};function Nt(e,t){if(!t)return e&&e.then?e.then(Ct):Promise.resolve()}let Lt="";const Pt=St((function({modalId:e,config:t,type:n="promotions",iframeData:{id:o=G.iframe.id,container:i,name:r=e,style:s=G.iframe.style}={}}){let a;return H.log(`creating modal for ${e}`,{function:"createModal",filename:Tt,isModalExist:!!It[e]}),Et((function(){var l;return null!=(l=It[e])&&l.iframe?_t(ut(It[e].iframe,i),(function(){var t;a=null==(t=It[e])?void 0:t.iframe})):(It[e]=Object.assign({},It[e]||{},{isInitialized:!1,isPresenting:!0,id:e}),_t(ft({name:r,id:o,container:i,style:s,url:`${G.iframe.url}/v3/`}),(function(o){return a=o,_t(ht({type:n,id:e,browserSessionId:be.get,caConfig:Object.assign({},Be(t||{}),{browserSessionId:be.get,origin:location.origin})},a),(function(){It[e]&&(It[e].iframe=a,It[e].isInitialized=!0)}))})))}),(function(){return rt(e,r),a}))})),Dt=St((function({payload:e,config:t,isCheckout:n=!1,merchantActions:o}){return Ot=At.activeElement,Et((function(){var n;if("paymentsData"in e&&"opt"in e.paymentsData&&"lenderId"in e.paymentsData.opt&&null!=(n=e.paymentsData.opt)&&n.lenderId)return Et((function(){if(!Lt)return Nt(kt(t,e.configurationSessionId))}),(function(){var t;e.paymentsData.sessionId=Lt,e.paymentsData.lenderSessionId=null==(t=It[e.paymentsData.opt.lenderId])||null==(t=t.data)?void 0:t.lenderSessionId}))}),(function(){const i="global",{iframe:r,isPresenting:s=!1}=It[i]||{};if(!s)return _t(Pt({modalId:i,type:e.type,config:t}),(function(t){if(!It[i])return;const r="payments"===e.type&&bt({modalData:It[i],isCheckout:n,merchantActions:o})||null;H.log(`starting to present modal ${e.type}`,{function:"present",filename:Tt,payload:e,isPresenting:s,isModalExist:!!t}),It[i].isPresenting=!0;const a=At.body.style.overflow;t.style.display="block",At.body.style.overflow="hidden";const l=(e=>{const t=()=>{H.log("closing modal due to popstate",{function:"listenToPopState",filename:ct}),e.contentWindow.postMessage({action:"CLOSE_MODAL",type:"payments",source:"CASDK",id:e.name},"*")};return at.addEventListener("popstate",t),()=>{at.removeEventListener("popstate",t)}})(t);return null==o||null==o.onModalOpen||o.onModalOpen(),_t(vt(Object.assign({},e,{id:"global"}),t),(function(s){var c;l();const d="payments"===(null==s?void 0:s.type)&&"data"in s;return _t(d&&(({isCheckout:e,callbackData:t,onComplete:n,presentCallback:o,widgetData:i})=>{H.log("about to call merchant callback",{function:"callMerchantCallbacks",filename:ct,isCallbackExist:!!o,isOnCompleteCallbackExist:!!n,callbackData:t,isCheckout:e});try{const{token:r,data:s,status:a}=t,{widgetItemCategory:l,widgetItemPrice:c,widgetItemSku:d,widgetItemTag:u}=i||{};null==n||n(r,s,a,Object.assign({source:e?"CHECKOUT":"APPLY"},i&&{promotion:{category:l,price:c,sku:d,tag:u}})),e?null==o||o(r,s,a):null==o||o(s,a)}catch(r){H.error("An error accrued while calling merchant callback",{function:"callMerchantCallbacks",filename:ct,error:r,message:r.message,printOriginalToConsole:!1,isSeverityWarn:!0})}})({isCheckout:n,callbackData:s.data,onComplete:null==o?void 0:o.onComplete,presentCallback:null==o?void 0:o.callback,widgetData:"promotions"===e.type?null==e||null==(c=e.widget)?void 0:c.widgetData:void 0}),(function(e){var n;return null==r||r.abort(),It[i]&&(It[i].isPresenting=!1),t.style.display="none",At.body.style.overflow=a,null==(n=Ot)||null==n.focus||n.focus(),"data"in s&&s.data||null}),!d)}))}));H.log(`${e.type} modal is already presented`,{function:"present",filename:Tt,payload:e,isPresenting:s,isModalExist:!!r})}))})),Rt=St((function({lenderId:e,config:t,container:n,cartDetails:o,callback:i,preferences:r,configurationSessionId:s}){return Et((function(){if(!Lt)return Nt(kt(t,s))}),(function(){if(!It[e])return void H.error(`cannot create eligibility modal with the lenderId ${e} because its is not supported`,{function:"modalPresentEligibility",filename:Tt,printOriginalToConsole:!0});Ot=At.activeElement;const{data:{lenderName:a}={lenderName:null}}=It[e];return _t(Pt({modalId:e,type:"eligibility",config:t,iframeData:{id:G.iframe.id+"-"+e,container:n,name:a,style:G.iframe.style.replace("position: fixed;","position:relative;").replace("background-color: #00000038","background-color: #F5F7FA")}}),(function(t){if(!It[e])return;t.style.display="block";const n={type:"promotions",configurationSessionId:s,eligibilityData:{inlineMode:!0,sessionId:Lt,opt:{cartDetails:o,lenderName:a,lenderId:e,preferences:r}}},l=it(e,t,{ELIGIBILITY_CHECK_STATUS_RECEIVED:{onMessage:function({eligible:e}){return null==i||i(e),_t()}},LENDER_SESSION_ID:{onMessage:St((function({lenderId:e,lenderSessionId:t}){return It[e].data.lenderSessionId=t,_t()}))}});return It[e].isPresenting=!0,_t(yt(Object.assign({},n,{id:e}),t),(function(){var n;It[e].isPresenting=!1,null==l||l.abort(),t.style.display="none",null==(n=Ot)||null==n.focus||n.focus()}))}))}))})),Mt=()=>{H.log("disposing modal data",{function:"dispose",filename:Tt});for(const t of Object.values(It)){var e;null==(e=t.iframe)||e.remove()}It={},(()=>{H.log("removes all message listeners",{function:"sendMsg",filename:Ze});for(const e of Object.values(tt))null!=e&&e.listener&&e.listener&&Qe.removeEventListener("message",e.listener),null!=e&&e.signal&&e.signal.abort();tt={}})()},kt=St((function(e,t){var n;const o="global";if(null!=(n=It)&&null!=(n=n[o])&&n.isPresenting)throw new Error("getDirectLenders cannot be called while modal is presenting");return _t(Pt({modalId:o,type:"payments",config:e}),(function(){if(!It[o])return;It[o].isPresenting=!1;const{iframe:e}=It[o];return _t(mt({type:"payments",id:"global",configurationSessionId:t},e),(function(e){if("data"in e&&"status"in e.data)throw e.data.status;if("directLenders"in e){Lt=e.sessionId;for(const t of e.directLenders)It[t.id]={data:{lenderId:t.id,lenderName:t.name}};return e.directLenders}}))}))}));const Ut=()=>{H.log("disposing data",{function:"dispose",filename:"dispose.ts"}),Mt()},xt=e=>{var t,n;if(H.log("learn more pressed",{function:"openLink",filename:"openLink",sku:e,widgetData:null==(t=Re.widgets)?void 0:t[e]}),e&&null!=(n=Re.widgets)&&null!=(n=n[e])&&null!=(n=n.widget)&&n.widgetFinancingPageUrl){var o;const t=Re.widgets[e];J.open(null==(o=t.widget)?void 0:o.widgetFinancingPageUrl,"_blank")}};function jt(){}function Ft(e,t){return function(e,t,n){if(n)return t?t(e()):e();try{var o=Promise.resolve(e());return t?o.then(t):o}catch(i){return Promise.reject(i)}}(e,jt,t)}const $t=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(o){return Promise.reject(o)}}}((function(e){return Re.config=Object.assign({},Re.config,e),Ut(),Ft(We)}));const Xt=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(o){return Promise.reject(o)}}}((function(){var e,t,n,o;return H.log("getting direct lenders for merchant",{filename:"getDirectLenders.ts",function:"getDirectLenders"}),t=kt(Re.config,null==(e=Re.basePromotionModalData)?void 0:e.configurationSessionId),n=function(e){for(const t of e)Re.widgets[t.id]={promotion:{lender:{id:t.id,name:t.name}}};return e},o?n?n(t):t:(t&&t.then||(t=Promise.resolve(t)),n?t.then(n):t)}));const Wt="sdkInit";const Bt=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(o){return Promise.reject(o)}}}((function(e){if(Re.isInitialized)H.warn("initializing SDK while already initialized",{function:"init",filename:Wt,config:Re.config});else{var t,n;let o;if(Re.sdkInitializedPromise=new Promise((e=>{o=e})),H.browserSessionId=be.get,H.log("initializing SDK",{function:"init",filename:Wt,config:Re.config}),!e||"string"!=typeof e.apiKey||!e.apiKey)return H.error(e?"invalid api key received":"config was not provided",{function:"init",filename:Wt,printOriginalToConsole:!0,isSeverityWarn:!0});const i=Object.assign({},e,{browserSessionId:be.get,origin:null==(t=J.location)?void 0:t.origin});Re.config=i,Re.isInitialized=!0,ke(void 0,null==(n=Re.config.preferences)?void 0:n.language).then((()=>{null==o||o()})).catch((e=>{H.error("SDK failed to init widget with error",{function:"init",filename:Wt,error:e,errorMessage:e.message}),null==o||o()})),null==Re.config.onLoaded||Re.config.onLoaded()}return r?i?i(o):o:(o&&o.then||(o=Promise.resolve(o)),i?o.then(i):o);var o,i,r}));const zt=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(o){return Promise.reject(o)}}}((function(e){return t=Dt({payload:{type:"identification-collection",payload:e},config:Re.config,isCheckout:!1}),n=function(e){if(e.status)throw e.status;return e.token},o?n?n(t):t:(t&&t.then||(t=Promise.resolve(t)),n?t.then(n):t);var t,n,o})),Kt=["callback","onDataUpdate","onConfirm","onApprovalStatusChange","onModalOpen"];const Gt="paymentsPresent",Ht=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(o){return Promise.reject(o)}}}((function(e,t){var n,o;void 0===t&&(t={});const i=Date.now(),r=t&&"apply"===e&&"applicationId"in t&&void 0!==t.applicationId&&null!==t.applicationId;if("object"!=typeof t||Array.isArray(t))return void H.error("invalid opt received, opt must be an object",{function:"paymentsPresent",filename:Gt,printOriginalToConsole:!0,opt:t});if(r&&H.warn("applicationId cannot be sent in apply",{filename:Gt,function:"applyPresent",printOriginalToConsole:!0,isConsoleOnly:!0}),t&&"checkout"===e&&!t.isCheckout&&(t.isCheckout=!0),"apply"===e&&t&&(t.isCheckout||void 0===t.isCheckout)&&(t.isCheckout=!1),null!=(n=t.consumerDetails)&&n.mobilePhoneNumber&&(t.consumerDetails.mobilePhoneNumber=t.consumerDetails.mobilePhoneNumber.toString().replace(/\D/g,"")),!pe(t))return;var s,a;"checkout"===e&&(s=t.cartDetails)&&(s.taxAmount=+(+s.taxAmount).toFixed(2),s.shippingAmount=+(+s.shippingAmount).toFixed(2),s.totalAmount=+(+s.totalAmount).toFixed(2),null==(a=s.discounts)||a.forEach((e=>{e.amount=+(+e.amount).toFixed(2)})),s.items.forEach((e=>{var t,n;e.price=+(+e.price).toFixed(2),e.warranty&&(e.warranty.price=+(null==(t=+(null==(n=e.warranty)?void 0:n.price))?void 0:t.toFixed(2)))})));const{onComplete:l}=Re.config,c=t,{callback:d,onDataUpdate:u,onConfirm:f,onApprovalStatusChange:g,onModalOpen:p}=c,m=Ke(c,Kt),h=!!u,v=!!d||!!l,y=Object.assign({},m,{isUpdateCallBackProvided:h,isCallBackProvided:v},r&&{applicationId:void 0}),w={sendBrowserSessionStartedEvent:be.sendBrowserSessionStartedEvent,browserSessionIdTimestamp:be.timestamp,type:"payments",paymentsData:{opt:y},configurationSessionId:(null==(o=Re.basePromotionModalData)?void 0:o.configurationSessionId)||y.configurationSessionId,ttlStartTime:i};return b=Dt({config:Re.config,payload:w,isCheckout:"checkout"===e,merchantActions:{callback:d,onDataUpdate:u,onConfirm:f,onApprovalStatusChange:g,onModalOpen:p,onComplete:l}}),_=function(e){return be.sendBrowserSessionStartedEvent=!1,e},O?_?_(b):b:(b&&b.then||(b=Promise.resolve(b)),_?b.then(_):b);var b,_,O}));const Vt="present";const Yt=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(o){return Promise.reject(o)}}}((function(e,t){if(!Re.isInitialized)return xe("present",Vt);switch("object"==typeof t&&"correlationId"in t&&t.correlationId&&(H.correlationId=t.correlationId),H.log(`about to present ${e}`,{function:"present",filename:Vt,opt:t}),e){case"apply":case"checkout":return Ht(e,t);case"promotion":return n=Re.sdkInitializedPromise,o=function(){return(e=>{var t,n;const o=Date.now(),[i,r]=e.split("-lenderId-"),s=null==(t=Re.widgets[i])?void 0:t.promotion;if(!s)return H.error(`SKU: ${i} is not exist, are you sure this is the correct SKU?`,{function:"promotionPresent",filename:"promotionsPresent",printOriginalToConsole:!0});const a={selectedLenderId:r,type:"promotions",widget:{widgetData:Re.widgets[i].widget},configurationSessionId:null==(n=Re.basePromotionModalData)?void 0:n.configurationSessionId,ttlStartTime:o,promotionData:Object.assign({},Re.basePromotionModalData,{promotion:s})};return Dt({payload:a,config:Re.config,isCheckout:!1,merchantActions:{onComplete:Re.config.onComplete}})})(t)},i?o?o(n):n:(n&&n.then||(n=Promise.resolve(n)),o?n.then(o):n);case"eligibility":{const{lenderId:e,container:n,callback:o,cartDetails:i,preferences:r}=t;return!!ge(i,((e,t,n)=>{null==o||o(void 0,n)}))&&Rt({lenderId:e,container:n,cartDetails:i,callback:o,config:Re.config,preferences:r})}case"identification-collection":return zt(t);default:{const n={code:"CREATE_CHECKOUT_FAILED",message:`${e} type is not support`};return null!=t&&t.callback&&(null==t||null==t.callback||t.callback(void 0,void 0,n)),H.error(`${e} type is not support`,{filename:Vt,function:"present"}),{token:void 0,data:void 0,status:n}}}var n,o,i}));var Jt;const qt="sdk";function Qt(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(o){return Promise.reject(o)}}}const Zt=window;let en=!1,tn=!1,nn=!1;const on={cfg:Zt.caConfig||(null==(Jt=Zt.ChargeAfter)?void 0:Jt.cfg),get payments(){return{present:Yt}},get promotions(){return{present:e=>Yt("promotion","string"==typeof e?e:e.sku||e.lenderId),openLink:xt,update:We}},get apply(){return en||(H.warn('The property "apply" is deprecated please use property "payments" instead and use "present("apply", opt)"',{function:"apply",filename:qt,printOriginalToConsole:!0,isConsoleOnly:!0}),en=!0),{present:(e={})=>Yt("apply",Object.assign({},e,{isCheckout:!1}))}},get checkout(){return tn||(H.warn('The property "checkout" is deprecated please use property "payments" instead and use "present("checkout", opt)"',{function:"checkout",filename:qt,printOriginalToConsole:!0,isConsoleOnly:!0}),tn=!0),{present:e=>Yt("checkout",Object.assign({},e,{isCheckout:!0}))}},get promotionalWidget(){const e=this;nn||(H.warn('The property "promotionalWidget" is deprecated please use property "promotions" instead',{function:"promotional",filename:qt,printOriginalToConsole:!0,isConsoleOnly:!0}),nn=!0);const t=this.promotions;return Object.assign({},t,{update:(e,t)=>We(null==e?void 0:e.items,t),rebuild:function(){return function(e,t,n){if(n)return t?t(e()):e();try{var o=Promise.resolve(e());return t?o.then(t):o}catch(i){return Promise.reject(i)}}(We,(function(){var t;null==(t=e.cfg)||null==t.onLoaded||t.onLoaded()}))}})},get identification(){return{present:e=>Yt("identification-collection",e)}},getDirectLenders:Xt,get eligibility(){return{createWidget:Qt((function(e){return Yt("eligibility",e),o?n?n(t):t:(t&&t.then||(t=Promise.resolve(t)),n?t.then(n):t);var t,n,o}))}},get poweredByLogo(){return`${G.cdnUrl}/chargeafter/powered-by.svg`},get init(){return e=>(this.cfg=e,Bt(e))},get updateConfig(){return e=>(this.cfg=Object.assign({},this.cfg,e),$t(e))},get dispose(){return Ut}};var rn;const sn=window,an=on;let ln;var cn,dn,un;sn.ChargeAfter&&(null!=(cn=sn.ChargeAfter)&&cn.dispose&&(null==(dn=sn.ChargeAfter)||dn.dispose()),ln=null==(un=sn.ChargeAfter)?void 0:un.fraudDetection);const fn=sn.caConfig||(null==(rn=sn.ChargeAfter)?void 0:rn.cfg);an.fraudDetection=ln,sn.ChargeAfter=an,fn&&an.init(fn)})()})();
//# sourceMappingURL=chargeafter.min.js.map