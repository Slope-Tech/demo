$(document).ready(function(){try{registerPostalCodeLookupListener("postalCode","city","stateProvinceGeoId","citystate"),registerSplitFullNameListener("fullName","firstName","lastName"),registerCityStateSelectListener("citystate","city","stateProvinceGeoId"),createLoqateControl("address_form")}catch(e){console.log(e)}}),$(document).ready(function(){initializeOrderSearch(),$(".btn_common").click(function(){$("#profile-form").submit()}),$("#profile-form").validate({rules:{emailAddress:{email:!1,shEmail:!0},oldPassword:{minlength:5},newPassword:{minlength:5},newPasswordVerify:{equalTo:"#newPassword"}},messages:{newPasswordVerify:"The passwords you entered do not match."}}),$("#editEmail").on("click",function(){$("#emailUpdateContainer").show(),$("#updatePasswordContainer").hide(),$("#addEditNameFieldContainer").hide()}),$("#editPassword").on("click",function(){$("#emailUpdateContainer").hide(),$("#updatePasswordContainer").show(),$("#addEditNameFieldContainer").hide()}),$("#editFirstName").on("click",function(){$("#emailUpdateContainer").hide(),$("#updatePasswordContainer").hide(),$("#addEditNameFieldContainer").show()})});var toggleIcon={toggleTarget:function(){$(document).on("click",".toggleTarget",function(){})}};function triggerInvoicePopUp(e){$("#hasOrderInvoice_"+e).bPopup(BPOPUP_OPT_FIXED_NOSCROLL)}function viewReturnsFromOrder(e){$.ajax({url:"/sh/control/viewReturnDetailFromOrder"+("?orderId="+e),type:"post",success:function(e){$("#returnDetailsContent").html(e),$("#returnDetails").modal()},error:function(e){console.log(e)}})}function initializeOrderSearch(){function o(){var e="";$(".order-search-input-sm, .order-search-input-lg").each(function(){$(this).is(":visible")&&(e=$(this).val().trim().replace(/[^'"\/\w\d -]/g," ").replace(/(^|\s)(and|or)(?=($|\s))/gi," ").trim().replace(/\s+/g," "))}),""!=e?768<=findwidth()?analyticsTrackingCode("Account","Main (Large Screens)","Search - "+e,function(){window.location=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")+window.location.pathname+"?search_string="+e}):analyticsTrackingCode("Account","Main (Small Screens)","Search - "+e,function(){window.location=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")+window.location.pathname+"?search_string="+e}):($(".order-search-input-sm").val(""),$(".order-search-input-lg").val(""))}$(".order-search-btn").click(o),$(".order-search-input-sm").keyup(function(e){13==e.which&&o()}),$(".order-search-input-lg").keyup(function(e){13==e.which&&o()}),$(".order-search-input-sm").focus(function(){$(this).siblings(".input-group-addon").addClass("focused")}),$(".order-search-input-sm").blur(function(){""==$(this).val().trim()&&$(this).siblings(".input-group-addon").removeClass("focused")}),$(document).on("mousedown",".order-top-search .input-group-addon:visible",function(e){($(":focus").is(".order-search-input-sm")||$(this).hasClass("focused"))&&(e.preventDefault(),o())}),$(document).on("mousedown","#order-history-search-button",function(e){e.preventDefault(),o()})}function viewThisSavedCart(o){o=o.replace("viewThisSavedCart_",""),""==$("#dynamicCartContents_"+o).html().trim()&&(ModalOverlay.showWithLoader(),$.ajax({url:"/sh/control/showSavedCartDetail?cartId="+o,type:"get",success:function(e){$("#dynamicCartContents_"+o).html(e)},complete:function(){ModalOverlay.hide()},error:function(e){console.log(e)}}))}function agreeWithLeadComplianceSetTrue(){$("#agreeWithLeadCompliance").prop("checked",!0)}function showEachAgreementPopup(e,o,t){var a=o[e],r="";"lead-warning"==a.popupType?(popupEle=$("#lead-compliance-confirm-popup"),r="<div class='lead-compliance-agreement'>"+popupEle.find(".modal-body img")[0].outerHTML+"</div>"):"non-returnable"==a.popupType?popupEle=$("#nonreturnable-confirm-popup"):"certification-needed"==a.popupType?popupEle=$("#gastite-certification-confirm-popup"):"combustion-test"==a.popupType?popupEle=$("#combustion-test-confirm-popup"):"qualification-needed"==a.popupType&&(popupEle=$("#tracpipe-qualification-confirm-popup"));var n="<h4>SKU: "+a.skuList+"</h4>",i=popupEle.find(".modal-header h4").first().text(),s=popupEle.find(".modal-body .text")[0].outerHTML,l=popupEle.find(".checkbox-black label").first().text(),c=popupEle.find(".validate-err").first().text();a=e!=o.length-1?function(){$("#overlay-agree").on("hidden.bs.modal",function(){$("#overlay-agree").off("hidden.bs.modal"),showEachAgreementPopup(e+1,o,t)}),$("#overlay-agree").modal("hide")}:function(){$("#overlay-agree").modal("hide"),loadCart(t)},currentPopup=Popup.showAgreementPopup(i,r+n+s,l,c,"Cancel","Continue",a)}function loadSavedCart(e){var o=e.replace("loadSavedCart_",""),t=$("#leadPdtList_"+o).val(),a=$("#nrPdtList_"+o).val(),r=$("#certPdtList_"+o).val(),n=$("#qualifPdtList_"+o).val(),i=$("#testPdtList_"+o).val(),o=[];0<t.length&&o.push({skuList:t,popupType:"lead-warning"}),0<a.length&&o.push({skuList:a,popupType:"non-returnable"}),0<r.length&&o.push({skuList:r,popupType:"certification-needed"}),0<i.length&&o.push({skuList:i,popupType:"combustion-test"}),0<n.length&&o.push({skuList:n,popupType:"qualification-needed"}),0<o.length?showEachAgreementPopup(0,o,e):loadCart(e)}function loadCart(o){o=o.replace("loadSavedCart_",""),ModalOverlay.showWithLoader(),$.ajax({url:"/sh/control/loadSavedCart?cartId="+o,type:"get",success:function(e){triggerBloomreachATCEvent(o),window.location.href="/sh/control/viewCart"},error:function(e){console.log(e),ModalOverlay.hide(ModalOverlay.commonOverlayName)}})}function triggerBloomreachATCEvent(e){var o=[];$("#saved_cart_container_"+e+" #cartList_"+e+" #cart-items-item-view div.cart-items-list-group").each(function(){var e=$(this).find("div.desc div.product-meta div.desc-container div.sku-and-brand div.desc-sku strong").html();o.push(e)}),0<o.length&&"object"==typeof BrTrk&&o.forEach(function(e){e=e.replace(" ","_");BrTrk.getTracker().logEvent("cart","click-add",{prod_id:e,sku:e})})}function shareSavedCart(o){$("#email-cart-modal").modal("show"),$("#send-saved-cart-container").off("submit").on("submit",function(e){$("#email-cart-modal").modal("hide"),e.preventDefault(),sendSavedCartEmail(o)})}function sendSavedCartEmail(e){e=e.replace("shareSavedCart_","");var o=$("#recipient-email").val();0==validateEmail(o)?Popup.showInfoPopup("Invalid Email Address","Please enter a valid e-mail address (for example: yourname@example.com)."):sendCartEmail(e,o)}function validateEmail(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}function sendCartEmail(e,o){ModalOverlay.showWithLoader(),$.ajax({url:"/sh/control/sendSavedCartEmail?cartId="+e+"&emailAddress="+o,type:"post",timeout:4e3,error:function(e){console.log(e)},success:function(){Popup.showInfoPopup("<b>Share this Saved Cart</b>",'<div style="text-align: left; padding: 0 0 8px">  <b>Success!</b> <br>Your cart has been emailed to '+o)},complete:function(){ModalOverlay.hide(ModalOverlay.commonOverlayName)}})}function submitSaveAsQuote(e,o){ModalOverlay.showWithLoader(),$.ajax({url:"/sh/control/createQuoteFromSavedCart?cartId="+e+(o?"&quoteName="+o:""),type:"post",beforeSend:function(){ModalOverlay.showWithLoader(ModalOverlay.commonOverlayName)}}).done(function(e){e&&e.quoteId?window.location.href="/sh/control/quotes/~"+e.quoteId:Popup.showInfoPopup("Request Failed","Please try again later.")}).fail(function(e){console.log(e),Popup.showInfoPopup("Request Failed","Please try again later.")}).always(function(){ModalOverlay.hide(ModalOverlay.commonOverlayName)})}function deleteSavedCart(o){o=o.replace("deleteSavedCart_","");currentPopup=Popup.showConfirmPopup("Delete Saved Cart","Are you sure you want to delete the cart?","No","Yes",function(){var e;e=o,$.ajax({url:"/sh/control/deleteSavedCart?cartId="+e,type:"get",success:function(e){window.location.href="/sh/control/showSavedCarts"},error:function(e){console.log(e)}})})}function saveAsQuote(o){$("#create-quote-from-saved-cart-modal").modal("show"),$("#save-cart-as-quote-container").off("submit").on("submit",function(e){$("#create-quote-from-saved-cart-modal").modal("hide"),e.preventDefault(),o=o.replace("saveAsQuote_","");e=$("#quote-name").val();submitSaveAsQuote(o,e)})}function processEmailPreferenceResponse(e,o,t){if(e.addClass("resultMessage"),"success"==t){for(var a in o)$("#"+a).prop("checked",o[a]),o[a]?subscribedIdSet.add(a):subscribedIdSet.delete(a);e.removeClass("resultMessageError"),e.addClass("resultMessageSuccess"),e.html("Your preferences have been updated!")}else e.removeClass("resultMessageSuccess"),e.addClass("resultMessageError"),e.html("Error updating preferences!");$("html, body").scrollTop(0),e.fadeIn().delay(2e3).fadeOut(),ModalOverlay.hide(ModalOverlay.commonOverlayName)}$(document).ready(function(){$(document).on("click",".product_lead_disclaimer",function(){Popup.showInfoPopup("This Item is Non-Returnable","Our standard return policy does not apply to this special-order item. Once ordered, it cannot be returned or cancelled. Manufacturer's warranty still applies.")}),$("#trigger_how_to_save_cart_browse").length&&($("#trigger_how_to_save_cart_browse").popover({html:!0,trigger:"click",template:$("#overlay_how_to_save_cart_browse").html(),container:$("#trigger_how_to_save_cart_browse").parent()}),$(document).on("click",".close",function(e){$("#trigger_how_to_save_cart_browse").popover("hide")}),$(document).mouseup(function(e){var o=$(".save-cart-info");"trigger_how_to_save_cart_browse"==$(e.target).attr("id")||o.is(e.target)||0!=o.has(e.target).length||$("#trigger_how_to_save_cart_browse").popover("hide")})),setInventoryPopupControls()}),$(document).ready(function(){$(".email-type-checkbox").click(function(e){$("#unsubscribe").prop("checked")&&($("#subscribe").prop("checked",!0),$("#unsubscribe").prop("checked",!1))}),$("#newsletter_form").submit(function(e){ModalOverlay.show(ModalOverlay.commonOverlayName);var t=$("#resultMessage");e.preventDefault(),$.ajax({url:$("#newsletter_form").attr("action"),dataType:"text",data:$("#newsletter_form").serialize()}).done(function(e,o){processEmailPreferenceResponse(t,JSON.parse(e),o),ModalOverlay.hide(ModalOverlay.commonOverlayName)})})});